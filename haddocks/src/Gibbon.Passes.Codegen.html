<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-name-shadowing #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-type-defaults #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE ParallelListComp #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE QuasiQuotes        #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell    #-}</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="annot"><span class="hs-comment">-- | The final pass of the compiler: generate C code.</span></span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Gibbon.Passes.Codegen</span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenProg"><span class="hs-identifier">codegenProg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.Codegen.html#harvestStructTys"><span class="hs-identifier">harvestStructTys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.Codegen.html#makeName"><span class="hs-identifier">makeName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.Codegen.html#rewriteReturns"><span class="hs-identifier">rewriteReturns</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Bifunctor.html"><span class="hs-identifier">Data.Bifunctor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Bifunctor.html#first"><span class="hs-identifier">first</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Int.html"><span class="hs-identifier">Data.Int</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html"><span class="hs-identifier">Data.Loc</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.html"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Quote.C.html"><span class="hs-identifier">Language.C.Quote.C</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Quote.C.html#cdecl"><span class="hs-identifier">cdecl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Quote.C.html#cedecl"><span class="hs-identifier">cedecl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Quote.C.html#cexp"><span class="hs-identifier">cexp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Quote.C.html#cfun"><span class="hs-identifier">cfun</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Quote.C.html#cparam"><span class="hs-identifier">cparam</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Quote.C.html#csdecl"><span class="hs-identifier">csdecl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Quote.C.html#cstm"><span class="hs-identifier">cstm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Quote.C.html#cty"><span class="hs-identifier">cty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Quote.C.html"><span class="hs-identifier">Language.C.Quote.C</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html"><span class="hs-identifier">Language.C.Syntax</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Prelude.html"><span class="hs-identifier">Prelude</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#init"><span class="hs-identifier">init</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/mainland-pretty-0.7.1-995044b4e52316ade5a9e6d232c4eed1e12a18c31ae656f9813375a1750980fc/share/doc/html/src/Text.PrettyPrint.Mainland.html"><span class="hs-identifier">Text.PrettyPrint.Mainland</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/mainland-pretty-0.7.1-995044b4e52316ade5a9e6d232c4eed1e12a18c31ae656f9813375a1750980fc/share/doc/html/src/Text.PrettyPrint.Mainland.Class.html"><span class="hs-identifier">Text.PrettyPrint.Mainland.Class</span></a></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Common.html"><span class="hs-identifier">Gibbon.Common</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Gibbon.Language.html"><span class="hs-identifier">Gibbon.Language</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">GL</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.DynFlags.html"><span class="hs-identifier">Gibbon.DynFlags</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.L2.Syntax.html"><span class="hs-identifier">Gibbon.L2.Syntax</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Multiplicity"><span class="hs-identifier">Multiplicity</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.L4.Syntax.html"><span class="hs-identifier">Gibbon.L4.Syntax</span></a></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="annot"><span class="hs-comment">-- | Harvest all struct tys.  All product types used anywhere in the program.</span></span><span>
</span><span id="line-37"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#harvestStructTys"><span class="hs-identifier hs-type">harvestStructTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Syntax.html#Ty"><span class="hs-identifier hs-type">Ty</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-38"></span><span id="harvestStructTys"><span class="annot"><span class="annottext">harvestStructTys :: Prog -&gt; Set [Ty]
</span><a href="Gibbon.Passes.Codegen.html#harvestStructTys"><span class="hs-identifier hs-var hs-var">harvestStructTys</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span class="annot"><span class="annottext">InfoTable
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SymTable
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680950539"><span class="annot"><span class="annottext">[FunDecl]
</span><a href="#local-6989586621680950539"><span class="hs-identifier hs-var">funs</span></a></span></span><span> </span><span id="local-6989586621680950540"><span class="annot"><span class="annottext">Maybe MainExp
</span><a href="#local-6989586621680950540"><span class="hs-identifier hs-var">mtal</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><span class="annottext">[Ty] -&gt; Set [Ty] -&gt; Set [Ty]
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#delete"><span class="hs-identifier hs-var">S.delete</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Set [Ty] -&gt; Set [Ty]) -&gt; Set [Ty] -&gt; Set [Ty]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><span class="annottext">([Ty] -&gt; [Ty]) -&gt; Set [Ty] -&gt; Set [Ty]
forall b a. Ord b =&gt; (a -&gt; b) -&gt; Set a -&gt; Set b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#map"><span class="hs-identifier hs-var">S.map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680950543"><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950543"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Ty -&gt; Bool) -&gt; [Ty] -&gt; [Ty]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680950544"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950544"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950544"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty] -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950543"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Set [Ty] -&gt; Set [Ty]) -&gt; Set [Ty] -&gt; Set [Ty]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set [Ty] -&gt; Set [Ty] -&gt; Set [Ty]
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-identifier hs-var">S.union</span></a></span><span> </span><span class="annot"><span class="annottext">Set [Ty]
</span><a href="#local-6989586621680950548"><span class="hs-identifier hs-var">tys0</span></a></span><span> </span><span class="annot"><span class="annottext">Set [Ty]
</span><a href="#local-6989586621680950549"><span class="hs-identifier hs-var">tys1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-43"></span><span>  </span><span id="local-6989586621680950550"><span class="annot"><span class="annottext">tys00 :: [Ty]
</span><a href="#local-6989586621680950550"><span class="hs-identifier hs-var hs-var">tys00</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Tail -&gt; [Ty]) -&gt; [Tail] -&gt; [Ty]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">Tail -&gt; [Ty]
</span><a href="#local-6989586621680950552"><span class="hs-identifier hs-var">allTypes</span></a></span><span> </span><span class="annot"><span class="annottext">[Tail]
</span><a href="#local-6989586621680950553"><span class="hs-identifier hs-var">allTails</span></a></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><a href="#local-6989586621680950548"><span class="hs-identifier hs-type">tys0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Syntax.html#Ty"><span class="hs-identifier hs-type">Ty</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-46"></span><span>  </span><span id="local-6989586621680950548"><span class="annot"><span class="annottext">tys0 :: Set [Ty]
</span><a href="#local-6989586621680950548"><span class="hs-identifier hs-var hs-var">tys0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; Set [Ty]
</span><a href="#local-6989586621680950554"><span class="hs-identifier hs-var">findAllProds</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950550"><span class="hs-identifier hs-var">tys00</span></a></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><a href="#local-6989586621680950549"><span class="hs-identifier hs-type">tys1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Syntax.html#Ty"><span class="hs-identifier hs-type">Ty</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-comment">-- All types mentioned in function arguments and returns:</span><span>
</span><span id="line-50"></span><span>  </span><span id="local-6989586621680950549"><span class="annot"><span class="annottext">tys1 :: Set [Ty]
</span><a href="#local-6989586621680950549"><span class="hs-identifier hs-var hs-var">tys1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Ty]] -&gt; Set [Ty]
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">S.fromList</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950556"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680950557"><span class="annot"><span class="annottext">FunDecl
</span><a href="#local-6989586621680950557"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[FunDecl]
</span><a href="#local-6989586621680950539"><span class="hs-identifier hs-var">funs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680950556"><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950556"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FunDecl -&gt; [Ty]
</span><a href="#local-6989586621680950558"><span class="hs-identifier hs-var">funTys</span></a></span><span> </span><span class="annot"><span class="annottext">FunDecl
</span><a href="#local-6989586621680950557"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-comment">-- structs f = makeStructs $ S.toList $ harvestStructTys prg</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span>  </span><span class="annot"><a href="#local-6989586621680950558"><span class="hs-identifier hs-type">funTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#FunDecl"><span class="hs-identifier hs-type">FunDecl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Syntax.html#Ty"><span class="hs-identifier hs-type">Ty</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-54"></span><span>  </span><span id="local-6989586621680950558"><span class="annot"><span class="annottext">funTys :: FunDecl -&gt; [Ty]
</span><a href="#local-6989586621680950558"><span class="hs-identifier hs-var hs-var">funTys</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#FunDecl"><span class="hs-identifier hs-type">FunDecl</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680950560"><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680950560"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621680950561"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950561"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">Tail
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950561"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Var, Ty) -&gt; Ty) -&gt; [(Var, Ty)] -&gt; [Ty]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty) -&gt; Ty
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680950560"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span>  </span><span id="local-6989586621680950553"><span class="annot"><span class="annottext">allTails :: [Tail]
</span><a href="#local-6989586621680950553"><span class="hs-identifier hs-var hs-var">allTails</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe MainExp
</span><a href="#local-6989586621680950540"><span class="hs-identifier hs-var">mtal</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-57"></span><span>                </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#PrintExp"><span class="hs-identifier hs-type">PrintExp</span></a></span><span> </span><span id="local-6989586621680950564"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950564"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950564"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-58"></span><span>                </span><span class="annot"><span class="annottext">Maybe MainExp
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Tail] -&gt; [Tail] -&gt; [Tail]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-59"></span><span>             </span><span class="annot"><span class="annottext">(FunDecl -&gt; Tail) -&gt; [FunDecl] -&gt; [Tail]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">FunDecl -&gt; Tail
</span><a href="Gibbon.L4.Syntax.html#funBody"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="annot"><span class="annottext">[FunDecl]
</span><a href="#local-6989586621680950539"><span class="hs-identifier hs-var">funs</span></a></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-comment">-- We may have nested products; this finds everything:</span><span>
</span><span id="line-62"></span><span>  </span><span class="annot"><a href="#local-6989586621680950554"><span class="hs-identifier hs-type">findAllProds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Syntax.html#Ty"><span class="hs-identifier hs-type">Ty</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Syntax.html#Ty"><span class="hs-identifier hs-type">Ty</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-63"></span><span>  </span><span id="local-6989586621680950554"><span class="annot"><span class="annottext">findAllProds :: [Ty] -&gt; Set [Ty]
</span><a href="#local-6989586621680950554"><span class="hs-identifier hs-var hs-var">findAllProds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; Set [Ty]
</span><a href="#local-6989586621680950566"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-65"></span><span>      </span><span id="local-6989586621680950566"><span class="annot"><span class="annottext">go :: [Ty] -&gt; Set [Ty]
</span><a href="#local-6989586621680950566"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set [Ty]
forall a. Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">S.empty</span></a></span><span>
</span><span id="line-66"></span><span>      </span><span class="annot"><a href="#local-6989586621680950566"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680950577"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950577"><span class="hs-identifier hs-var">t</span></a></span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680950578"><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950578"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-67"></span><span>       </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950577"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-68"></span><span>         </span><span class="annot"><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; Set [Ty]
</span><a href="#local-6989586621680950566"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950578"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-69"></span><span>         </span><span class="annot"><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680950579"><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950579"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; Set [Ty] -&gt; Set [Ty]
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#insert"><span class="hs-identifier hs-var">S.insert</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950579"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">(Set [Ty] -&gt; Set [Ty]) -&gt; Set [Ty] -&gt; Set [Ty]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Set [Ty] -&gt; Set [Ty] -&gt; Set [Ty]
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-identifier hs-var">S.union</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty] -&gt; Set [Ty]
</span><a href="#local-6989586621680950566"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950579"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty] -&gt; Set [Ty]
</span><a href="#local-6989586621680950566"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950578"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>         </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VectorTy"><span class="hs-identifier hs-type">VectorTy</span></a></span><span> </span><span id="local-6989586621680950582"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950582"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; Set [Ty] -&gt; Set [Ty]
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#insert"><span class="hs-identifier hs-var">S.insert</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#VectorTy"><span class="hs-identifier hs-var">VectorTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950582"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Set [Ty] -&gt; Set [Ty]) -&gt; Set [Ty] -&gt; Set [Ty]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Set [Ty] -&gt; Set [Ty] -&gt; Set [Ty]
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-identifier hs-var">S.union</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty] -&gt; Set [Ty]
</span><a href="#local-6989586621680950566"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950582"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty] -&gt; Set [Ty]
</span><a href="#local-6989586621680950566"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950578"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>         </span><span class="annot"><a href="Gibbon.L4.Syntax.html#ListTy"><span class="hs-identifier hs-type">ListTy</span></a></span><span> </span><span id="local-6989586621680950584"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950584"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; Set [Ty] -&gt; Set [Ty]
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#insert"><span class="hs-identifier hs-var">S.insert</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ListTy"><span class="hs-identifier hs-var">ListTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950584"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Set [Ty] -&gt; Set [Ty]) -&gt; Set [Ty] -&gt; Set [Ty]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Set [Ty] -&gt; Set [Ty] -&gt; Set [Ty]
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-identifier hs-var">S.union</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty] -&gt; Set [Ty]
</span><a href="#local-6989586621680950566"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950584"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty] -&gt; Set [Ty]
</span><a href="#local-6989586621680950566"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950578"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>         </span><span class="annot"><a href="Gibbon.L4.Syntax.html#PDictTy"><span class="hs-identifier hs-type">PDictTy</span></a></span><span> </span><span id="local-6989586621680950586"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950586"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680950587"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950587"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; Set [Ty] -&gt; Set [Ty]
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#insert"><span class="hs-identifier hs-var">S.insert</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Ty -&gt; Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#PDictTy"><span class="hs-identifier hs-var">PDictTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950586"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950587"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Set [Ty] -&gt; Set [Ty]) -&gt; Set [Ty] -&gt; Set [Ty]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Set [Ty] -&gt; Set [Ty] -&gt; Set [Ty]
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-identifier hs-var">S.union</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty] -&gt; Set [Ty]
</span><a href="#local-6989586621680950566"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950586"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950587"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty] -&gt; Set [Ty]
</span><a href="#local-6989586621680950566"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950578"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>         </span><span class="annot"><span class="annottext">Ty
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; Set [Ty]
</span><a href="#local-6989586621680950566"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950578"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-comment">-- This finds all types that maybe grouped together as a ProdTy:</span><span>
</span><span id="line-76"></span><span>  </span><span class="annot"><a href="#local-6989586621680950552"><span class="hs-identifier hs-type">allTypes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Tail"><span class="hs-identifier hs-type">Tail</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Syntax.html#Ty"><span class="hs-identifier hs-type">Ty</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-77"></span><span>  </span><span id="local-6989586621680950552"><span class="annot"><span class="annottext">allTypes :: Tail -&gt; [Ty]
</span><a href="#local-6989586621680950552"><span class="hs-identifier hs-var hs-var">allTypes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tail -&gt; [Ty]
</span><a href="#local-6989586621680950588"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-78"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-79"></span><span>    </span><span id="local-6989586621680950588"><span class="annot"><span class="annottext">go :: Tail -&gt; [Ty]
</span><a href="#local-6989586621680950588"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680950593"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950593"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-80"></span><span>     </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950593"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-81"></span><span>       </span><span class="annot"><span class="annottext">Tail
</span><a href="Gibbon.L4.Syntax.html#EndOfMain"><span class="hs-identifier hs-var">EndOfMain</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-82"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#RetValsT"><span class="hs-identifier hs-type">RetValsT</span></a></span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-83"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#AssnValsT"><span class="hs-identifier hs-type">AssnValsT</span></a></span><span> </span><span id="local-6989586621680950597"><span class="annot"><span class="annottext">[(Var, Ty, Triv)]
</span><a href="#local-6989586621680950597"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621680950598"><span class="annot"><span class="annottext">Maybe Tail
</span><a href="#local-6989586621680950598"><span class="hs-identifier hs-var">bod_maybe</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-84"></span><span>         </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Tail
</span><a href="#local-6989586621680950598"><span class="hs-identifier hs-var">bod_maybe</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-85"></span><span>           </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680950599"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950599"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Var, Ty, Triv) -&gt; Ty) -&gt; [(Var, Ty, Triv)] -&gt; [Ty]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680950600"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950600"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Triv
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950600"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty, Triv)]
</span><a href="#local-6989586621680950597"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Tail -&gt; [Ty]
</span><a href="#local-6989586621680950588"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950599"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-86"></span><span>           </span><span class="annot"><span class="annottext">Maybe Tail
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Ty] -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Var, Ty, Triv) -&gt; Ty) -&gt; [(Var, Ty, Triv)] -&gt; [Ty]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680950601"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950601"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Triv
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950601"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty, Triv)]
</span><a href="#local-6989586621680950597"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-87"></span><span>       </span><span class="hs-comment">-- This creates a demand for a struct return, but it is covered</span><span>
</span><span id="line-88"></span><span>       </span><span class="hs-comment">-- by the fun signatures already:</span><span>
</span><span id="line-89"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetCallT"><span class="hs-identifier hs-type">LetCallT</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680950603"><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680950603"><span class="hs-identifier hs-var">binds</span></a></span></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><span class="hs-identifier">_</span></span><span>  </span><span id="local-6989586621680950604"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950604"><span class="hs-identifier hs-var">bod</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Var, Ty) -&gt; Ty) -&gt; [(Var, Ty)] -&gt; [Ty]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty) -&gt; Ty
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680950603"><span class="hs-identifier hs-var">binds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Tail -&gt; [Ty]
</span><a href="#local-6989586621680950588"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950604"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-90"></span><span>       </span><span class="hs-comment">-- INVARIANT: This does not create a struct:</span><span>
</span><span id="line-91"></span><span>       </span><span class="hs-comment">-- But just in case it does in the future, we add it:</span><span>
</span><span id="line-92"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetPrimCallT"><span class="hs-identifier hs-type">LetPrimCallT</span></a></span><span> </span><span id="local-6989586621680950606"><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680950606"><span class="hs-identifier hs-var">binds</span></a></span></span><span> </span><span id="local-6989586621680950607"><span class="annot"><span class="annottext">Prim
</span><a href="#local-6989586621680950607"><span class="hs-identifier hs-var">prm</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680950608"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950608"><span class="hs-identifier hs-var">bod</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-93"></span><span>         </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680950609"><span class="annot"><span class="annottext">rst :: [Ty]
</span><a href="#local-6989586621680950609"><span class="hs-identifier hs-var hs-var">rst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tail -&gt; [Ty]
</span><a href="#local-6989586621680950588"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950608"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-94"></span><span>         </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="#local-6989586621680950607"><span class="hs-identifier hs-var">prm</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-95"></span><span>           </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VAllocP"><span class="hs-identifier hs-type">VAllocP</span></a></span><span> </span><span id="local-6989586621680950611"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950611"><span class="hs-identifier hs-var">elty</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#VectorTy"><span class="hs-identifier hs-var">VectorTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950611"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950609"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-96"></span><span>           </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VFreeP"><span class="hs-identifier hs-type">VFreeP</span></a></span><span> </span><span id="local-6989586621680950613"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950613"><span class="hs-identifier hs-var">elty</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#VectorTy"><span class="hs-identifier hs-var">VectorTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950613"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950609"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-97"></span><span>           </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VFree2P"><span class="hs-identifier hs-type">VFree2P</span></a></span><span> </span><span id="local-6989586621680950615"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950615"><span class="hs-identifier hs-var">elty</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#VectorTy"><span class="hs-identifier hs-var">VectorTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950615"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950609"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-98"></span><span>           </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VLengthP"><span class="hs-identifier hs-type">VLengthP</span></a></span><span> </span><span id="local-6989586621680950617"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950617"><span class="hs-identifier hs-var">elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#VectorTy"><span class="hs-identifier hs-var">VectorTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950617"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950609"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-99"></span><span>           </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VNthP"><span class="hs-identifier hs-type">VNthP</span></a></span><span>   </span><span id="local-6989586621680950619"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950619"><span class="hs-identifier hs-var">elty</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#VectorTy"><span class="hs-identifier hs-var">VectorTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950619"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950609"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-100"></span><span>           </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VSliceP"><span class="hs-identifier hs-type">VSliceP</span></a></span><span> </span><span id="local-6989586621680950621"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950621"><span class="hs-identifier hs-var">elty</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#VectorTy"><span class="hs-identifier hs-var">VectorTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950621"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950609"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-101"></span><span>           </span><span class="annot"><a href="Gibbon.L4.Syntax.html#InplaceVUpdateP"><span class="hs-identifier hs-type">InplaceVUpdateP</span></a></span><span> </span><span id="local-6989586621680950623"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950623"><span class="hs-identifier hs-var">elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#VectorTy"><span class="hs-identifier hs-var">VectorTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950623"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950609"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-102"></span><span>           </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VConcatP"><span class="hs-identifier hs-type">VConcatP</span></a></span><span> </span><span id="local-6989586621680950625"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950625"><span class="hs-identifier hs-var">elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#VectorTy"><span class="hs-identifier hs-var">VectorTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950625"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950609"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-103"></span><span>           </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VSortP"><span class="hs-identifier hs-type">VSortP</span></a></span><span> </span><span id="local-6989586621680950627"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950627"><span class="hs-identifier hs-var">elty</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#VectorTy"><span class="hs-identifier hs-var">VectorTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950627"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950609"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-104"></span><span>           </span><span class="annot"><a href="Gibbon.L4.Syntax.html#InplaceVSortP"><span class="hs-identifier hs-type">InplaceVSortP</span></a></span><span> </span><span id="local-6989586621680950629"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950629"><span class="hs-identifier hs-var">_elty</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#voidTy"><span class="hs-identifier hs-var">voidTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950609"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-105"></span><span>           </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VMergeP"><span class="hs-identifier hs-type">VMergeP</span></a></span><span> </span><span id="local-6989586621680950632"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950632"><span class="hs-identifier hs-var">elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#VectorTy"><span class="hs-identifier hs-var">VectorTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950632"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950609"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-106"></span><span>           </span><span class="annot"><a href="Gibbon.L4.Syntax.html#LLAllocP"><span class="hs-identifier hs-type">LLAllocP</span></a></span><span> </span><span id="local-6989586621680950634"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950634"><span class="hs-identifier hs-var">elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ListTy"><span class="hs-identifier hs-var">ListTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950634"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950609"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-107"></span><span>           </span><span class="annot"><a href="Gibbon.L4.Syntax.html#LLIsEmptyP"><span class="hs-identifier hs-type">LLIsEmptyP</span></a></span><span> </span><span id="local-6989586621680950636"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950636"><span class="hs-identifier hs-var">elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ListTy"><span class="hs-identifier hs-var">ListTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950636"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950609"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-108"></span><span>           </span><span class="annot"><a href="Gibbon.L4.Syntax.html#LLConsP"><span class="hs-identifier hs-type">LLConsP</span></a></span><span> </span><span id="local-6989586621680950638"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950638"><span class="hs-identifier hs-var">elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ListTy"><span class="hs-identifier hs-var">ListTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950638"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950609"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-109"></span><span>           </span><span class="annot"><a href="Gibbon.L4.Syntax.html#LLHeadP"><span class="hs-identifier hs-type">LLHeadP</span></a></span><span> </span><span id="local-6989586621680950640"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950640"><span class="hs-identifier hs-var">elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ListTy"><span class="hs-identifier hs-var">ListTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950640"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950609"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-110"></span><span>           </span><span class="annot"><a href="Gibbon.L4.Syntax.html#LLTailP"><span class="hs-identifier hs-type">LLTailP</span></a></span><span> </span><span id="local-6989586621680950642"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950642"><span class="hs-identifier hs-var">elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ListTy"><span class="hs-identifier hs-var">ListTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950642"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950609"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-111"></span><span>           </span><span class="annot"><a href="Gibbon.L4.Syntax.html#LLFreeP"><span class="hs-identifier hs-type">LLFreeP</span></a></span><span> </span><span id="local-6989586621680950644"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950644"><span class="hs-identifier hs-var">elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ListTy"><span class="hs-identifier hs-var">ListTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950644"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950609"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-112"></span><span>           </span><span class="annot"><a href="Gibbon.L4.Syntax.html#LLFree2P"><span class="hs-identifier hs-type">LLFree2P</span></a></span><span> </span><span id="local-6989586621680950646"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950646"><span class="hs-identifier hs-var">elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ListTy"><span class="hs-identifier hs-var">ListTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950646"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950609"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-113"></span><span>           </span><span class="annot"><a href="Gibbon.L4.Syntax.html#LLCopyP"><span class="hs-identifier hs-type">LLCopyP</span></a></span><span> </span><span id="local-6989586621680950648"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950648"><span class="hs-identifier hs-var">elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ListTy"><span class="hs-identifier hs-var">ListTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950648"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950609"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-114"></span><span>           </span><span class="annot"><a href="Gibbon.L4.Syntax.html#PDictAllocP"><span class="hs-identifier hs-type">PDictAllocP</span></a></span><span> </span><span id="local-6989586621680950650"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950650"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680950651"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950651"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#PDictTy"><span class="hs-identifier hs-var">PDictTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950650"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950651"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950609"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-115"></span><span>           </span><span class="annot"><a href="Gibbon.L4.Syntax.html#PDictInsertP"><span class="hs-identifier hs-type">PDictInsertP</span></a></span><span> </span><span id="local-6989586621680950653"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950653"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680950654"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950654"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#PDictTy"><span class="hs-identifier hs-var">PDictTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950653"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950654"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950609"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-116"></span><span>           </span><span class="annot"><a href="Gibbon.L4.Syntax.html#PDictLookupP"><span class="hs-identifier hs-type">PDictLookupP</span></a></span><span> </span><span id="local-6989586621680950656"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950656"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680950657"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950657"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#PDictTy"><span class="hs-identifier hs-var">PDictTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950656"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950657"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950609"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-117"></span><span>           </span><span class="annot"><a href="Gibbon.L4.Syntax.html#PDictHasKeyP"><span class="hs-identifier hs-type">PDictHasKeyP</span></a></span><span> </span><span id="local-6989586621680950659"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950659"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680950660"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950660"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#PDictTy"><span class="hs-identifier hs-var">PDictTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950659"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950660"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950609"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-118"></span><span>           </span><span class="annot"><a href="Gibbon.L4.Syntax.html#PDictForkP"><span class="hs-identifier hs-type">PDictForkP</span></a></span><span> </span><span id="local-6989586621680950662"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950662"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680950663"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950663"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#PDictTy"><span class="hs-identifier hs-var">PDictTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950662"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950663"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950609"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-119"></span><span>           </span><span class="annot"><a href="Gibbon.L4.Syntax.html#PDictJoinP"><span class="hs-identifier hs-type">PDictJoinP</span></a></span><span> </span><span id="local-6989586621680950665"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950665"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680950666"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950666"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#PDictTy"><span class="hs-identifier hs-var">PDictTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950665"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950666"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950609"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-120"></span><span>           </span><span class="annot"><a href="Gibbon.L4.Syntax.html#ReadArrayFile"><span class="hs-identifier hs-type">ReadArrayFile</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (FilePath, Int)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680950668"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950668"><span class="hs-identifier hs-var">elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#VectorTy"><span class="hs-identifier hs-var">VectorTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950668"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950609"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-121"></span><span>           </span><span class="annot"><span class="annottext">Prim
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Var, Ty) -&gt; Ty) -&gt; [(Var, Ty)] -&gt; [Ty]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty) -&gt; Ty
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680950606"><span class="hs-identifier hs-var">binds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680950609"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-122"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetTrivT"><span class="hs-identifier hs-type">LetTrivT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680950670"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950670"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Triv
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680950671"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950671"><span class="hs-identifier hs-var">bod</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950670"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Tail -&gt; [Ty]
</span><a href="#local-6989586621680950588"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950671"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-123"></span><span>       </span><span class="hs-comment">-- This should not create a struct.  Again, we add it just for the heck of it:</span><span>
</span><span id="line-124"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetIfT"><span class="hs-identifier hs-type">LetIfT</span></a></span><span> </span><span id="local-6989586621680950673"><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680950673"><span class="hs-identifier hs-var">binds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Triv
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680950674"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950674"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680950675"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950675"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680950676"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950676"><span class="hs-identifier hs-var">bod</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Var, Ty) -&gt; Ty) -&gt; [(Var, Ty)] -&gt; [Ty]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty) -&gt; Ty
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680950673"><span class="hs-identifier hs-var">binds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Tail -&gt; [Ty]
</span><a href="#local-6989586621680950588"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950674"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; [Ty] -&gt; [Ty]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Tail -&gt; [Ty]
</span><a href="#local-6989586621680950588"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950675"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; [Ty] -&gt; [Ty]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Tail -&gt; [Ty]
</span><a href="#local-6989586621680950588"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950676"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-125"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetTimedT"><span class="hs-identifier hs-type">LetTimedT</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680950678"><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680950678"><span class="hs-identifier hs-var">binds</span></a></span></span><span> </span><span id="local-6989586621680950679"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950679"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span id="local-6989586621680950680"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950680"><span class="hs-identifier hs-var">bod</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Var, Ty) -&gt; Ty) -&gt; [(Var, Ty)] -&gt; [Ty]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty) -&gt; Ty
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680950678"><span class="hs-identifier hs-var">binds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Tail -&gt; [Ty]
</span><a href="#local-6989586621680950588"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950679"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; [Ty] -&gt; [Ty]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Tail -&gt; [Ty]
</span><a href="#local-6989586621680950588"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950680"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-126"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetArenaT"><span class="hs-identifier hs-type">LetArenaT</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680950682"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950682"><span class="hs-identifier hs-var">bod</span></a></span></span><span class="hs-special">)</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#ArenaTy"><span class="hs-identifier hs-var">ArenaTy</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Tail -&gt; [Ty]
</span><a href="#local-6989586621680950588"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950682"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span>       </span><span class="hs-comment">-- These are precisely for operating on structs:</span><span>
</span><span id="line-129"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetUnpackT"><span class="hs-identifier hs-type">LetUnpackT</span></a></span><span> </span><span id="local-6989586621680950685"><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680950685"><span class="hs-identifier hs-var">binds</span></a></span></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680950686"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950686"><span class="hs-identifier hs-var">bod</span></a></span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Var, Ty) -&gt; Ty) -&gt; [(Var, Ty)] -&gt; [Ty]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty) -&gt; Ty
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680950685"><span class="hs-identifier hs-var">binds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Tail -&gt; [Ty]
</span><a href="#local-6989586621680950588"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950686"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-130"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetAllocT"><span class="hs-identifier hs-type">LetAllocT</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680950688"><span class="annot"><span class="annottext">[(Ty, Triv)]
</span><a href="#local-6989586621680950688"><span class="hs-identifier hs-var">vals</span></a></span></span><span> </span><span id="local-6989586621680950689"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950689"><span class="hs-identifier hs-var">bod</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Ty, Triv) -&gt; Ty) -&gt; [(Ty, Triv)] -&gt; [Ty]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Ty, Triv) -&gt; Ty
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[(Ty, Triv)]
</span><a href="#local-6989586621680950688"><span class="hs-identifier hs-var">vals</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; [Ty] -&gt; [Ty]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Tail -&gt; [Ty]
</span><a href="#local-6989586621680950588"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950689"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-131"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetAvailT"><span class="hs-identifier hs-type">LetAvailT</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680950692"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950692"><span class="hs-identifier hs-var">bod</span></a></span></span><span class="hs-special">)</span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Tail -&gt; [Ty]
</span><a href="#local-6989586621680950588"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950692"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#IfT"><span class="hs-identifier hs-type">IfT</span></a></span><span> </span><span class="annot"><span class="annottext">Triv
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680950694"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950694"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680950695"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950695"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Tail -&gt; [Ty]
</span><a href="#local-6989586621680950588"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950694"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; [Ty] -&gt; [Ty]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Tail -&gt; [Ty]
</span><a href="#local-6989586621680950588"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950695"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-134"></span><span>       </span><span class="annot"><a href="Gibbon.L4.Syntax.html#ErrT"><span class="hs-identifier hs-type">ErrT</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-135"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#Switch"><span class="hs-identifier hs-type">Switch</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Triv
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#IntAlts"><span class="hs-identifier hs-type">IntAlts</span></a></span><span> </span><span id="local-6989586621680950699"><span class="annot"><span class="annottext">[(Int64, Tail)]
</span><a href="#local-6989586621680950699"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680950700"><span class="annot"><span class="annottext">Maybe Tail
</span><a href="#local-6989586621680950700"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((Int64, Tail) -&gt; [Ty]) -&gt; [(Int64, Tail)] -&gt; [Ty]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tail -&gt; [Ty]
</span><a href="#local-6989586621680950588"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(Tail -&gt; [Ty]) -&gt; ((Int64, Tail) -&gt; Tail) -&gt; (Int64, Tail) -&gt; [Ty]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Int64, Tail) -&gt; Tail
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Int64, Tail)]
</span><a href="#local-6989586621680950699"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; [Ty] -&gt; [Ty]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">(Tail -&gt; [Ty]) -&gt; [Tail] -&gt; [Ty]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">Tail -&gt; [Ty]
</span><a href="#local-6989586621680950588"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Tail -&gt; [Tail]
forall a. Maybe a -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Maybe.html#maybeToList"><span class="hs-identifier hs-var">maybeToList</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Tail
</span><a href="#local-6989586621680950700"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#Switch"><span class="hs-identifier hs-type">Switch</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Triv
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#TagAlts"><span class="hs-identifier hs-type">TagAlts</span></a></span><span> </span><span id="local-6989586621680950704"><span class="annot"><span class="annottext">[(Tag, Tail)]
</span><a href="#local-6989586621680950704"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680950705"><span class="annot"><span class="annottext">Maybe Tail
</span><a href="#local-6989586621680950705"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((Tag, Tail) -&gt; [Ty]) -&gt; [(Tag, Tail)] -&gt; [Ty]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tail -&gt; [Ty]
</span><a href="#local-6989586621680950588"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">(Tail -&gt; [Ty]) -&gt; ((Tag, Tail) -&gt; Tail) -&gt; (Tag, Tail) -&gt; [Ty]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Tag, Tail) -&gt; Tail
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Tag, Tail)]
</span><a href="#local-6989586621680950704"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; [Ty] -&gt; [Ty]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">(Tail -&gt; [Ty]) -&gt; [Tail] -&gt; [Ty]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">Tail -&gt; [Ty]
</span><a href="#local-6989586621680950588"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Tail -&gt; [Tail]
forall a. Maybe a -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Maybe.html#maybeToList"><span class="hs-identifier hs-var">maybeToList</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Tail
</span><a href="#local-6989586621680950705"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#TailCall"><span class="hs-identifier hs-type">TailCall</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-138"></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#Goto"><span class="hs-identifier hs-type">Goto</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#sortFns"><span class="hs-identifier hs-type">sortFns</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>
</span><span id="line-141"></span><span id="sortFns"><span class="annot"><span class="annottext">sortFns :: Prog -&gt; Set Var
</span><a href="Gibbon.Passes.Codegen.html#sortFns"><span class="hs-identifier hs-var hs-var">sortFns</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span class="annot"><span class="annottext">InfoTable
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SymTable
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680950710"><span class="annot"><span class="annottext">[FunDecl]
</span><a href="#local-6989586621680950710"><span class="hs-identifier hs-var">funs</span></a></span></span><span> </span><span id="local-6989586621680950711"><span class="annot"><span class="annottext">Maybe MainExp
</span><a href="#local-6989586621680950711"><span class="hs-identifier hs-var">mtal</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Set Var -&gt; Tail -&gt; Set Var) -&gt; Set Var -&gt; [Tail] -&gt; Set Var
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">foldl</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; Tail -&gt; Set Var
</span><a href="#local-6989586621680950713"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
forall a. Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">S.empty</span></a></span><span> </span><span class="annot"><span class="annottext">[Tail]
</span><a href="#local-6989586621680950714"><span class="hs-identifier hs-var">allTails</span></a></span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-143"></span><span>    </span><span id="local-6989586621680950714"><span class="annot"><span class="annottext">allTails :: [Tail]
</span><a href="#local-6989586621680950714"><span class="hs-identifier hs-var hs-var">allTails</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe MainExp
</span><a href="#local-6989586621680950711"><span class="hs-identifier hs-var">mtal</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-144"></span><span>                </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#PrintExp"><span class="hs-identifier hs-type">PrintExp</span></a></span><span> </span><span id="local-6989586621680950715"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950715"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950715"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-145"></span><span>                </span><span class="annot"><span class="annottext">Maybe MainExp
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Tail] -&gt; [Tail] -&gt; [Tail]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-146"></span><span>             </span><span class="annot"><span class="annottext">(FunDecl -&gt; Tail) -&gt; [FunDecl] -&gt; [Tail]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">FunDecl -&gt; Tail
</span><a href="Gibbon.L4.Syntax.html#funBody"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="annot"><span class="annottext">[FunDecl]
</span><a href="#local-6989586621680950710"><span class="hs-identifier hs-var">funs</span></a></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span>    </span><span id="local-6989586621680950713"><span class="annot"><span class="annottext">go :: Set Var -&gt; Tail -&gt; Set Var
</span><a href="#local-6989586621680950713"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680950721"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950721"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621680950722"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950722"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-149"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950722"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-150"></span><span>        </span><span class="annot"><span class="annottext">Tail
</span><a href="Gibbon.L4.Syntax.html#EndOfMain"><span class="hs-identifier hs-var">EndOfMain</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950721"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-151"></span><span>        </span><span class="annot"><a href="Gibbon.L4.Syntax.html#RetValsT"><span class="hs-identifier hs-type">RetValsT</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950721"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-152"></span><span>        </span><span class="annot"><a href="Gibbon.L4.Syntax.html#AssnValsT"><span class="hs-identifier hs-type">AssnValsT</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty, Triv)]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680950723"><span class="annot"><span class="annottext">Maybe Tail
</span><a href="#local-6989586621680950723"><span class="hs-identifier hs-var">mb_bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Tail
</span><a href="#local-6989586621680950723"><span class="hs-identifier hs-var">mb_bod</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-153"></span><span>                                </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680950724"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950724"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; Tail -&gt; Set Var
</span><a href="#local-6989586621680950713"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950721"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950724"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-154"></span><span>                                </span><span class="annot"><span class="annottext">Maybe Tail
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950721"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-155"></span><span>        </span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetCallT"><span class="hs-identifier hs-type">LetCallT</span></a></span><span class="hs-special">{</span><span id="local-6989586621680950725"><span class="annot"><span class="annottext">Tail
bod :: Tail
bod :: Tail -&gt; Tail
</span><a href="#local-6989586621680950725"><span class="hs-identifier hs-var hs-var">bod</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; Tail -&gt; Set Var
</span><a href="#local-6989586621680950713"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950721"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950725"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-156"></span><span>        </span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetPrimCallT"><span class="hs-identifier hs-type">LetPrimCallT</span></a></span><span class="hs-special">{</span><span id="local-6989586621680950727"><span class="annot"><span class="annottext">Prim
prim :: Prim
prim :: Tail -&gt; Prim
</span><a href="#local-6989586621680950727"><span class="hs-keyword hs-var hs-var">prim</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680950729"><span class="annot"><span class="annottext">Tail
bod :: Tail -&gt; Tail
bod :: Tail
</span><a href="Gibbon.L4.Syntax.html#bod"><span class="hs-identifier hs-var hs-var">bod</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680950730"><span class="annot"><span class="annottext">[Triv]
rands :: [Triv]
rands :: Tail -&gt; [Triv]
</span><a href="#local-6989586621680950730"><span class="hs-identifier hs-var hs-var">rands</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-157"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="#local-6989586621680950727"><span class="hs-keyword hs-var">prim</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-158"></span><span>            </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VSortP"><span class="hs-identifier hs-type">VSortP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-159"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Triv
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680950733"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680950733"><span class="hs-identifier hs-var">fp</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680950730"><span class="hs-identifier hs-var">rands</span></a></span><span>
</span><span id="line-160"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; Tail -&gt; Set Var
</span><a href="#local-6989586621680950713"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Set Var -&gt; Set Var
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#insert"><span class="hs-identifier hs-var">S.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680950733"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950721"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950729"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-161"></span><span>            </span><span class="annot"><a href="Gibbon.L4.Syntax.html#InplaceVSortP"><span class="hs-identifier hs-type">InplaceVSortP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-162"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Triv
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680950734"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680950734"><span class="hs-identifier hs-var">fp</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680950730"><span class="hs-identifier hs-var">rands</span></a></span><span>
</span><span id="line-163"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; Tail -&gt; Set Var
</span><a href="#local-6989586621680950713"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Set Var -&gt; Set Var
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#insert"><span class="hs-identifier hs-var">S.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680950734"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950721"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950729"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-164"></span><span>            </span><span class="annot"><span class="annottext">Prim
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; Tail -&gt; Set Var
</span><a href="#local-6989586621680950713"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950721"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950729"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-165"></span><span>        </span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetTrivT"><span class="hs-identifier hs-type">LetTrivT</span></a></span><span class="hs-special">{</span><span id="local-6989586621680950735"><span class="annot"><span class="annottext">Tail
bod :: Tail -&gt; Tail
bod :: Tail
</span><a href="Gibbon.L4.Syntax.html#bod"><span class="hs-identifier hs-var hs-var">bod</span></a></span></span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; Tail -&gt; Set Var
</span><a href="#local-6989586621680950713"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950721"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950735"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-166"></span><span>        </span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetIfT"><span class="hs-identifier hs-type">LetIfT</span></a></span><span class="hs-special">{</span><span id="local-6989586621680950736"><span class="annot"><span class="annottext">(Triv, Tail, Tail)
ife :: (Triv, Tail, Tail)
ife :: Tail -&gt; (Triv, Tail, Tail)
</span><a href="#local-6989586621680950736"><span class="hs-identifier hs-var hs-var">ife</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680950738"><span class="annot"><span class="annottext">Tail
bod :: Tail -&gt; Tail
bod :: Tail
</span><a href="Gibbon.L4.Syntax.html#bod"><span class="hs-identifier hs-var hs-var">bod</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-167"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Triv
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680950739"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950739"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680950740"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950740"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Triv, Tail, Tail)
</span><a href="#local-6989586621680950736"><span class="hs-identifier hs-var">ife</span></a></span><span>
</span><span id="line-168"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; Tail -&gt; Set Var
</span><a href="#local-6989586621680950713"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Var -&gt; Tail -&gt; Set Var
</span><a href="#local-6989586621680950713"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Var -&gt; Tail -&gt; Set Var
</span><a href="#local-6989586621680950713"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950721"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950739"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950740"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950738"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-169"></span><span>        </span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetUnpackT"><span class="hs-identifier hs-type">LetUnpackT</span></a></span><span class="hs-special">{</span><span id="local-6989586621680950741"><span class="annot"><span class="annottext">Tail
bod :: Tail -&gt; Tail
bod :: Tail
</span><a href="Gibbon.L4.Syntax.html#bod"><span class="hs-identifier hs-var hs-var">bod</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; Tail -&gt; Set Var
</span><a href="#local-6989586621680950713"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950721"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950741"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-170"></span><span>        </span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetAllocT"><span class="hs-identifier hs-type">LetAllocT</span></a></span><span class="hs-special">{</span><span id="local-6989586621680950742"><span class="annot"><span class="annottext">Tail
bod :: Tail -&gt; Tail
bod :: Tail
</span><a href="Gibbon.L4.Syntax.html#bod"><span class="hs-identifier hs-var hs-var">bod</span></a></span></span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; Tail -&gt; Set Var
</span><a href="#local-6989586621680950713"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950721"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950742"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-171"></span><span>        </span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetAvailT"><span class="hs-identifier hs-type">LetAvailT</span></a></span><span class="hs-special">{</span><span id="local-6989586621680950743"><span class="annot"><span class="annottext">Tail
bod :: Tail -&gt; Tail
bod :: Tail
</span><a href="Gibbon.L4.Syntax.html#bod"><span class="hs-identifier hs-var hs-var">bod</span></a></span></span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; Tail -&gt; Set Var
</span><a href="#local-6989586621680950713"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950721"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950743"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-172"></span><span>        </span><span class="annot"><a href="Gibbon.L4.Syntax.html#IfT"><span class="hs-identifier hs-type">IfT</span></a></span><span class="hs-special">{</span><span id="local-6989586621680950744"><span class="annot"><span class="annottext">Tail
con :: Tail
con :: Tail -&gt; Tail
</span><a href="#local-6989586621680950744"><span class="hs-identifier hs-var hs-var">con</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680950746"><span class="annot"><span class="annottext">Tail
els :: Tail
els :: Tail -&gt; Tail
</span><a href="#local-6989586621680950746"><span class="hs-identifier hs-var hs-var">els</span></a></span></span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; Tail -&gt; Set Var
</span><a href="#local-6989586621680950713"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Var -&gt; Tail -&gt; Set Var
</span><a href="#local-6989586621680950713"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950721"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950744"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950746"><span class="hs-identifier hs-var">els</span></a></span><span>
</span><span id="line-173"></span><span>        </span><span class="annot"><a href="Gibbon.L4.Syntax.html#ErrT"><span class="hs-identifier hs-type">ErrT</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950721"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-174"></span><span>        </span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetTimedT"><span class="hs-identifier hs-type">LetTimedT</span></a></span><span class="hs-special">{</span><span id="local-6989586621680950748"><span class="annot"><span class="annottext">Tail
timed :: Tail
timed :: Tail -&gt; Tail
</span><a href="#local-6989586621680950748"><span class="hs-identifier hs-var hs-var">timed</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680950750"><span class="annot"><span class="annottext">Tail
bod :: Tail -&gt; Tail
bod :: Tail
</span><a href="Gibbon.L4.Syntax.html#bod"><span class="hs-identifier hs-var hs-var">bod</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; Tail -&gt; Set Var
</span><a href="#local-6989586621680950713"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Var -&gt; Tail -&gt; Set Var
</span><a href="#local-6989586621680950713"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950721"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950748"><span class="hs-identifier hs-var">timed</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950750"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-175"></span><span>        </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Switch"><span class="hs-identifier hs-type">Switch</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Triv
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680950751"><span class="annot"><span class="annottext">Alts
</span><a href="#local-6989586621680950751"><span class="hs-identifier hs-var">alts</span></a></span></span><span> </span><span id="local-6989586621680950752"><span class="annot"><span class="annottext">Maybe Tail
</span><a href="#local-6989586621680950752"><span class="hs-identifier hs-var">mb_tl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-176"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680950753"><span class="annot"><span class="annottext">acc1 :: Set Var
</span><a href="#local-6989586621680950753"><span class="hs-identifier hs-var hs-var">acc1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Tail
</span><a href="#local-6989586621680950752"><span class="hs-identifier hs-var">mb_tl</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-177"></span><span>                       </span><span class="annot"><span class="annottext">Maybe Tail
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950721"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-178"></span><span>                       </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680950754"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950754"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; Tail -&gt; Set Var
</span><a href="#local-6989586621680950713"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950721"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950754"><span class="hs-identifier hs-var">tl</span></a></span><span>
</span><span id="line-179"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Alts
</span><a href="#local-6989586621680950751"><span class="hs-identifier hs-var">alts</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-180"></span><span>               </span><span class="annot"><a href="Gibbon.L4.Syntax.html#TagAlts"><span class="hs-identifier hs-type">TagAlts</span></a></span><span> </span><span id="local-6989586621680950755"><span class="annot"><span class="annottext">[(Tag, Tail)]
</span><a href="#local-6989586621680950755"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((Tag, Tail) -&gt; Set Var -&gt; Set Var)
-&gt; Set Var -&gt; [(Tag, Tail)] -&gt; Set Var
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tag
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680950757"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950757"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680950758"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950758"><span class="hs-identifier hs-var">ac</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; Tail -&gt; Set Var
</span><a href="#local-6989586621680950713"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950758"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950757"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950753"><span class="hs-identifier hs-var">acc1</span></a></span><span> </span><span class="annot"><span class="annottext">[(Tag, Tail)]
</span><a href="#local-6989586621680950755"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-181"></span><span>               </span><span class="annot"><a href="Gibbon.L4.Syntax.html#IntAlts"><span class="hs-identifier hs-type">IntAlts</span></a></span><span> </span><span id="local-6989586621680950759"><span class="annot"><span class="annottext">[(Int64, Tail)]
</span><a href="#local-6989586621680950759"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((Int64, Tail) -&gt; Set Var -&gt; Set Var)
-&gt; Set Var -&gt; [(Int64, Tail)] -&gt; Set Var
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680950760"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950760"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680950761"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950761"><span class="hs-identifier hs-var">ac</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; Tail -&gt; Set Var
</span><a href="#local-6989586621680950713"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950761"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950760"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950753"><span class="hs-identifier hs-var">acc1</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int64, Tail)]
</span><a href="#local-6989586621680950759"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-182"></span><span>        </span><span class="annot"><a href="Gibbon.L4.Syntax.html#TailCall"><span class="hs-identifier hs-type">TailCall</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950721"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-183"></span><span>        </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Goto"><span class="hs-identifier hs-type">Goto</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950721"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-184"></span><span>        </span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetArenaT"><span class="hs-identifier hs-type">LetArenaT</span></a></span><span class="hs-special">{</span><span id="local-6989586621680950762"><span class="annot"><span class="annottext">Tail
bod :: Tail -&gt; Tail
bod :: Tail
</span><a href="Gibbon.L4.Syntax.html#bod"><span class="hs-identifier hs-var hs-var">bod</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; Tail -&gt; Set Var
</span><a href="#local-6989586621680950713"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950721"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950762"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-187"></span><span class="annot"><span class="hs-comment">-- * C codegen</span></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-comment">-- | Compile a program to C code that has the side effect of the</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- &quot;gibbon_main&quot; expression in that program.</span><span>
</span><span id="line-191"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenProg"><span class="hs-identifier hs-type">codegenProg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-192"></span><span id="codegenProg"><span class="annot"><span class="annottext">codegenProg :: Config -&gt; Prog -&gt; IO FilePath
</span><a href="Gibbon.Passes.Codegen.html#codegenProg"><span class="hs-identifier hs-var hs-var">codegenProg</span></a></span></span><span> </span><span id="local-6989586621680950841"><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680950841"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621680950842"><span class="annot"><span class="annottext">prg :: Prog
</span><a href="#local-6989586621680950842"><span class="hs-identifier hs-var">prg</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span id="local-6989586621680950843"><span class="annot"><span class="annottext">InfoTable
</span><a href="#local-6989586621680950843"><span class="hs-identifier hs-var">info_tbl</span></a></span></span><span> </span><span id="local-6989586621680950844"><span class="annot"><span class="annottext">SymTable
</span><a href="#local-6989586621680950844"><span class="hs-identifier hs-var">sym_tbl</span></a></span></span><span> </span><span id="local-6989586621680950845"><span class="annot"><span class="annottext">[FunDecl]
</span><a href="#local-6989586621680950845"><span class="hs-identifier hs-var">funs</span></a></span></span><span> </span><span id="local-6989586621680950846"><span class="annot"><span class="annottext">Maybe MainExp
</span><a href="#local-6989586621680950846"><span class="hs-identifier hs-var">mtal</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-193"></span><span>      </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680950847"><span class="hs-identifier hs-var">hashIncludes</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Doc -&gt; FilePath
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/mainland-pretty-0.7.1-995044b4e52316ade5a9e6d232c4eed1e12a18c31ae656f9813375a1750980fc/share/doc/html/src/Text.PrettyPrint.Mainland.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">80</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc] -&gt; Doc
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/mainland-pretty-0.7.1-995044b4e52316ade5a9e6d232c4eed1e12a18c31ae656f9813375a1750980fc/share/doc/html/src/Text.PrettyPrint.Mainland.html#stack"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Definition -&gt; Doc) -&gt; [Definition] -&gt; [Doc]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Definition -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/mainland-pretty-0.7.1-995044b4e52316ade5a9e6d232c4eed1e12a18c31ae656f9813375a1750980fc/share/doc/html/src/Text.PrettyPrint.Mainland.Class.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">[Definition]
</span><a href="#local-6989586621680950851"><span class="hs-identifier hs-var">defs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-195"></span><span>      </span><span id="local-6989586621680950852"><span class="annot"><span class="annottext">init_fun_env :: Map Var ([Ty], Ty)
</span><a href="#local-6989586621680950852"><span class="hs-identifier hs-var hs-var">init_fun_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FunDecl -&gt; Map Var ([Ty], Ty) -&gt; Map Var ([Ty], Ty))
-&gt; Map Var ([Ty], Ty) -&gt; [FunDecl] -&gt; Map Var ([Ty], Ty)
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680950853"><span class="annot"><span class="annottext">FunDecl
</span><a href="#local-6989586621680950853"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621680950854"><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680950854"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; ([Ty], Ty) -&gt; Map Var ([Ty], Ty) -&gt; Map Var ([Ty], Ty)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunDecl -&gt; Var
</span><a href="Gibbon.L4.Syntax.html#funName"><span class="hs-identifier hs-var">funName</span></a></span><span> </span><span class="annot"><span class="annottext">FunDecl
</span><a href="#local-6989586621680950853"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Var, Ty) -&gt; Ty) -&gt; [(Var, Ty)] -&gt; [Ty]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty) -&gt; Ty
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunDecl -&gt; [(Var, Ty)]
</span><a href="Gibbon.L4.Syntax.html#funArgs"><span class="hs-identifier hs-var">funArgs</span></a></span><span> </span><span class="annot"><span class="annottext">FunDecl
</span><a href="#local-6989586621680950853"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FunDecl -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#funRetTy"><span class="hs-identifier hs-var">funRetTy</span></a></span><span> </span><span class="annot"><span class="annottext">FunDecl
</span><a href="#local-6989586621680950853"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680950854"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span> </span><span class="annot"><span class="annottext">[FunDecl]
</span><a href="#local-6989586621680950845"><span class="hs-identifier hs-var">funs</span></a></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span>      </span><span id="local-6989586621680950860"><span class="annot"><span class="annottext">sort_fns :: Set Var
</span><a href="#local-6989586621680950860"><span class="hs-identifier hs-var hs-var">sort_fns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Set Var
</span><a href="Gibbon.Passes.Codegen.html#sortFns"><span class="hs-identifier hs-var">sortFns</span></a></span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621680950842"><span class="hs-identifier hs-var">prg</span></a></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span>      </span><span id="local-6989586621680950851"><span class="annot"><span class="annottext">defs :: [Definition]
</span><a href="#local-6989586621680950851"><span class="hs-identifier hs-var hs-var">defs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Definition], Int) -&gt; [Definition]
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(([Definition], Int) -&gt; [Definition])
-&gt; ([Definition], Int) -&gt; [Definition]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Config -&gt; Int -&gt; PassM [Definition] -&gt; ([Definition], Int)
forall a. Config -&gt; Int -&gt; PassM a -&gt; (a, Int)
</span><a href="Gibbon.Common.html#runPassM"><span class="hs-identifier hs-var">runPassM</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680950841"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(PassM [Definition] -&gt; ([Definition], Int))
-&gt; PassM [Definition] -&gt; ([Definition], Int)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-200"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621680950862"><span class="annot"><span class="annottext">[Definition]
</span><a href="#local-6989586621680950862"><span class="hs-identifier hs-var">prots</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680950863"><span class="annot"><span class="annottext">[Definition]
</span><a href="#local-6989586621680950863"><span class="hs-identifier hs-var">funs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Definition, Definition)] -&gt; ([Definition], [Definition])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">([(Definition, Definition)] -&gt; ([Definition], [Definition]))
-&gt; ([[(Definition, Definition)]] -&gt; [(Definition, Definition)])
-&gt; [[(Definition, Definition)]]
-&gt; ([Definition], [Definition])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[[(Definition, Definition)]] -&gt; [(Definition, Definition)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([[(Definition, Definition)]] -&gt; ([Definition], [Definition]))
-&gt; PassM [[(Definition, Definition)]]
-&gt; PassM ([Definition], [Definition])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(FunDecl -&gt; PassM [(Definition, Definition)])
-&gt; [FunDecl] -&gt; PassM [[(Definition, Definition)]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">FunDecl -&gt; PassM [(Definition, Definition)]
</span><a href="#local-6989586621680950868"><span class="hs-identifier hs-var">codegenFun</span></a></span><span> </span><span class="annot"><span class="annottext">[FunDecl]
</span><a href="#local-6989586621680950845"><span class="hs-identifier hs-var">funs</span></a></span><span>
</span><span id="line-201"></span><span>        </span><span id="local-6989586621680950869"><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621680950869"><span class="hs-identifier hs-var">main_expr'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PassM Definition
</span><a href="#local-6989586621680950870"><span class="hs-identifier hs-var">main_expr</span></a></span><span>
</span><span id="line-202"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680950871"><span class="annot"><span class="annottext">struct_tys :: [[Ty]]
</span><a href="#local-6989586621680950871"><span class="hs-identifier hs-var hs-var">struct_tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Ty]] -&gt; [[Ty]]
</span><a href="Gibbon.Passes.Codegen.html#uniqueDicts"><span class="hs-identifier hs-var">uniqueDicts</span></a></span><span> </span><span class="annot"><span class="annottext">([[Ty]] -&gt; [[Ty]]) -&gt; [[Ty]] -&gt; [[Ty]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Set [Ty] -&gt; [[Ty]]
forall a. Set a -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#toList"><span class="hs-identifier hs-var">S.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(Set [Ty] -&gt; [[Ty]]) -&gt; Set [Ty] -&gt; [[Ty]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Prog -&gt; Set [Ty]
</span><a href="Gibbon.Passes.Codegen.html#harvestStructTys"><span class="hs-identifier hs-var">harvestStructTys</span></a></span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621680950842"><span class="hs-identifier hs-var">prg</span></a></span><span>
</span><span id="line-203"></span><span>        </span><span class="annot"><span class="annottext">[Definition] -&gt; PassM [Definition]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Definition] -&gt; [Definition]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.OldList.html#nub"><span class="hs-identifier hs-var">L.nub</span></a></span><span> </span><span class="annot"><span class="annottext">([Definition] -&gt; [Definition]) -&gt; [Definition] -&gt; [Definition]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[[Ty]] -&gt; [Definition]
</span><a href="Gibbon.Passes.Codegen.html#makeStructs"><span class="hs-identifier hs-var">makeStructs</span></a></span><span> </span><span class="annot"><span class="annottext">[[Ty]]
</span><a href="#local-6989586621680950871"><span class="hs-identifier hs-var">struct_tys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Definition] -&gt; [Definition] -&gt; [Definition]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Definition]
</span><a href="#local-6989586621680950862"><span class="hs-identifier hs-var">prots</span></a></span><span> </span><span class="annot"><span class="annottext">[Definition] -&gt; [Definition] -&gt; [Definition]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-204"></span><span>                </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621680950876"><span class="hs-identifier hs-var">gibTypesEnum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InfoTable -&gt; Definition
</span><a href="Gibbon.Passes.Codegen.html#initInfoTable"><span class="hs-identifier hs-var">initInfoTable</span></a></span><span> </span><span class="annot"><span class="annottext">InfoTable
</span><a href="#local-6989586621680950843"><span class="hs-identifier hs-var">info_tbl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SymTable -&gt; Definition
</span><a href="Gibbon.Passes.Codegen.html#initSymTable"><span class="hs-identifier hs-var">initSymTable</span></a></span><span> </span><span class="annot"><span class="annottext">SymTable
</span><a href="#local-6989586621680950844"><span class="hs-identifier hs-var">sym_tbl</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Definition] -&gt; [Definition] -&gt; [Definition]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-205"></span><span>                </span><span class="annot"><span class="annottext">[Definition]
</span><a href="#local-6989586621680950863"><span class="hs-identifier hs-var">funs'</span></a></span><span> </span><span class="annot"><span class="annottext">[Definition] -&gt; [Definition] -&gt; [Definition]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621680950869"><span class="hs-identifier hs-var">main_expr'</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span>      </span><span class="annot"><a href="#local-6989586621680950870"><span class="hs-identifier hs-type">main_expr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Definition"><span class="hs-identifier hs-type">C.Definition</span></a></span><span>
</span><span id="line-208"></span><span>      </span><span id="local-6989586621680950870"><span class="annot"><span class="annottext">main_expr :: PassM Definition
</span><a href="#local-6989586621680950870"><span class="hs-identifier hs-var hs-var">main_expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-209"></span><span>        </span><span id="local-6989586621680950879"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680950879"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PassM DynFlags
forall (m :: * -&gt; *). MonadReader Config m =&gt; m DynFlags
</span><a href="Gibbon.Common.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-210"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680950881"><span class="annot"><span class="annottext">pointer :: Bool
</span><a href="#local-6989586621680950881"><span class="hs-identifier hs-var hs-var">pointer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_Pointer"><span class="hs-identifier hs-var">Opt_Pointer</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680950879"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-211"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680950884"><span class="annot"><span class="annottext">gen_gc :: Bool
</span><a href="#local-6989586621680950884"><span class="hs-identifier hs-var hs-var">gen_gc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_GenGc"><span class="hs-identifier hs-var">Opt_GenGc</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680950879"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-212"></span><span>        </span><span id="local-6989586621680950886"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680950886"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe MainExp
</span><a href="#local-6989586621680950846"><span class="hs-identifier hs-var">mtal</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-213"></span><span>               </span><span class="hs-comment">-- [2019.06.13]: CSK, Why is codegenTail always called with IntTy?</span><span>
</span><span id="line-214"></span><span>               </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#PrintExp"><span class="hs-identifier hs-type">PrintExp</span></a></span><span> </span><span id="local-6989586621680950887"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950887"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680950852"><span class="hs-identifier hs-var">init_fun_env</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950860"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950887"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#IntTy"><span class="hs-identifier hs-var">IntTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-215"></span><span>               </span><span class="annot"><span class="annottext">Maybe MainExp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-216"></span><span>        </span><span id="local-6989586621680950890"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680950890"><span class="hs-identifier hs-var">ret_init</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;init&quot;</span></span><span>
</span><span id="line-217"></span><span>        </span><span id="local-6989586621680950892"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680950892"><span class="hs-identifier hs-var">ret_exit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;exit&quot;</span></span><span>
</span><span id="line-218"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680950893"><span class="annot"><span class="annottext">init_gib :: [BlockItem]
</span><a href="#local-6989586621680950893"><span class="hs-identifier hs-var hs-var">init_gib</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680950881"><span class="hs-identifier hs-var">pointer</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| GC_INIT(); |]</span></span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-219"></span><span>                       </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| int $id:ret_init = gib_init(argc, argv); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-220"></span><span>            </span><span id="local-6989586621680950910"><span class="annot"><span class="annottext">exit_gib :: [BlockItem]
</span><a href="#local-6989586621680950910"><span class="hs-identifier hs-var hs-var">exit_gib</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| int $id:ret_exit = gib_exit(); |]</span></span><span>
</span><span id="line-221"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| return $id:ret_exit; |]</span></span><span>
</span><span id="line-222"></span><span>                       </span><span class="hs-special">]</span><span>
</span><span id="line-223"></span><span>            </span><span id="local-6989586621680950912"><span class="annot"><span class="annottext">init_info_table :: [BlockItem]
</span><a href="#local-6989586621680950912"><span class="hs-identifier hs-var hs-var">init_info_table</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| info_table_initialize(); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-224"></span><span>            </span><span id="local-6989586621680950913"><span class="annot"><span class="annottext">init_symbol_table :: [BlockItem]
</span><a href="#local-6989586621680950913"><span class="hs-identifier hs-var hs-var">init_symbol_table</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| symbol_table_initialize(); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-225"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680950914"><span class="annot"><span class="annottext">bod :: [BlockItem]
</span><a href="#local-6989586621680950914"><span class="hs-identifier hs-var hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680950893"><span class="hs-identifier hs-var">init_gib</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680950912"><span class="hs-identifier hs-var">init_info_table</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680950913"><span class="hs-identifier hs-var">init_symbol_table</span></a></span><span>
</span><span id="line-226"></span><span>                  </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680950884"><span class="hs-identifier hs-var">gen_gc</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#ssDecls"><span class="hs-identifier hs-var">ssDecls</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>                  </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680950886"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680950910"><span class="hs-identifier hs-var">exit_gib</span></a></span><span>
</span><span id="line-228"></span><span>        </span><span class="annot"><span class="annottext">Definition -&gt; PassM Definition
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Definition -&gt; PassM Definition) -&gt; Definition -&gt; PassM Definition
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Func -&gt; SrcLoc -&gt; Definition
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#FuncDef"><span class="hs-identifier hs-var">C.FuncDef</span></a></span><span> </span><span class="annot"><span class="">[cfun| int main(int argc, char **argv) { $items:bod } |]</span></span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span>      </span><span class="annot"><a href="#local-6989586621680950923"><span class="hs-identifier hs-type">codegenFun'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#FunDecl"><span class="hs-identifier hs-type">FunDecl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Func"><span class="hs-identifier hs-type">C.Func</span></a></span><span>
</span><span id="line-231"></span><span>      </span><span id="local-6989586621680950923"><span class="annot"><span class="annottext">codegenFun' :: FunDecl -&gt; PassM Func
</span><a href="#local-6989586621680950923"><span class="hs-identifier hs-var hs-var">codegenFun'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#FunDecl"><span class="hs-identifier hs-type">FunDecl</span></a></span><span> </span><span id="local-6989586621680950924"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680950924"><span class="hs-identifier hs-var">nam</span></a></span></span><span> </span><span id="local-6989586621680950925"><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680950925"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621680950926"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950926"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680950927"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950927"><span class="hs-identifier hs-var">tal</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-232"></span><span>          </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680950928"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680950928"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PassM DynFlags
forall (m :: * -&gt; *). MonadReader Config m =&gt; m DynFlags
</span><a href="Gibbon.Common.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-233"></span><span>             </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680950929"><span class="annot"><span class="annottext">gen_gc :: Bool
</span><a href="#local-6989586621680950929"><span class="hs-identifier hs-var hs-var">gen_gc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_GenGc"><span class="hs-identifier hs-var">Opt_GenGc</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680950928"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-234"></span><span>             </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680950930"><span class="annot"><span class="annottext">retTy :: Type
</span><a href="#local-6989586621680950930"><span class="hs-identifier hs-var hs-var">retTy</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Type
</span><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950926"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-235"></span><span>                 </span><span id="local-6989586621680950932"><span class="annot"><span class="annottext">params :: [Param]
</span><a href="#local-6989586621680950932"><span class="hs-identifier hs-var hs-var">params</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Var, Ty) -&gt; Param) -&gt; [(Var, Ty)] -&gt; [Param]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680950933"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680950933"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680950934"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950934"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="">[cparam| $ty:(codegenTy t) $id:v |]</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680950925"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-236"></span><span>                 </span><span id="local-6989586621680950941"><span class="annot"><span class="annottext">init_venv :: VEnv
</span><a href="#local-6989586621680950941"><span class="hs-identifier hs-var hs-var">init_venv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)] -&gt; VEnv
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680950925"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-237"></span><span>             </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680950943"><span class="annot"><span class="annottext">nam' :: Var
</span><a href="#local-6989586621680950943"><span class="hs-identifier hs-var hs-var">nam'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Set Var -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#member"><span class="hs-identifier hs-var">S.member</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680950924"><span class="hs-identifier hs-var">nam</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950860"><span class="hs-identifier hs-var">sort_fns</span></a></span><span>
</span><span id="line-238"></span><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Var
</span><a href="Gibbon.Common.html#varAppend"><span class="hs-identifier hs-var">varAppend</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680950924"><span class="hs-identifier hs-var">nam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;_original&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680950924"><span class="hs-identifier hs-var">nam</span></a></span><span>
</span><span id="line-240"></span><span>             </span><span id="local-6989586621680950947"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680950947"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680950941"><span class="hs-identifier hs-var">init_venv</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680950852"><span class="hs-identifier hs-var">init_fun_env</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950860"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950927"><span class="hs-identifier hs-var">tal</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950926"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-241"></span><span>             </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680950948"><span class="annot"><span class="annottext">body' :: [BlockItem]
</span><a href="#local-6989586621680950948"><span class="hs-identifier hs-var hs-var">body'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680950929"><span class="hs-identifier hs-var">gen_gc</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#ssDecls"><span class="hs-identifier hs-var">ssDecls</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680950947"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-242"></span><span>             </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680950949"><span class="annot"><span class="annottext">fun :: Func
</span><a href="#local-6989586621680950949"><span class="hs-identifier hs-var hs-var">fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cfun| $ty:retTy $id:nam' ($params:params) {
                              $items:body'
                              } |]</span></span><span>
</span><span id="line-245"></span><span>             </span><span class="annot"><span class="annottext">Func -&gt; PassM Func
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Func
</span><a href="#local-6989586621680950949"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span>      </span><span class="hs-comment">-- C's qsort expects a sort function to be of type, (void*  a, void* b) : int.</span><span>
</span><span id="line-248"></span><span>      </span><span class="hs-comment">-- But there's no way for a user to write a function of this type. So we generate</span><span>
</span><span id="line-249"></span><span>      </span><span class="hs-comment">-- the function that the user wrote with a different_name, and then codegenSortFn</span><span>
</span><span id="line-250"></span><span>      </span><span class="hs-comment">-- generates the actual sort function; which reads the values from these void*</span><span>
</span><span id="line-251"></span><span>      </span><span class="hs-comment">-- pointers and calls the user written one after that.</span><span>
</span><span id="line-252"></span><span>      </span><span class="annot"><a href="#local-6989586621680950955"><span class="hs-identifier hs-type">codegenSortFn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#FunDecl"><span class="hs-identifier hs-type">FunDecl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Func"><span class="hs-identifier hs-type">C.Func</span></a></span><span>
</span><span id="line-253"></span><span>      </span><span id="local-6989586621680950955"><span class="annot"><span class="annottext">codegenSortFn :: FunDecl -&gt; PassM Func
</span><a href="#local-6989586621680950955"><span class="hs-identifier hs-var hs-var">codegenSortFn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#FunDecl"><span class="hs-identifier hs-type">FunDecl</span></a></span><span> </span><span id="local-6989586621680950956"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680950956"><span class="hs-identifier hs-var">nam</span></a></span></span><span> </span><span id="local-6989586621680950957"><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680950957"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621680950958"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950958"><span class="hs-identifier hs-var">_ty</span></a></span></span><span> </span><span id="local-6989586621680950959"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680950959"><span class="hs-identifier hs-var">_tal</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-254"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680950960"><span class="annot"><span class="annottext">nam' :: Var
</span><a href="#local-6989586621680950960"><span class="hs-identifier hs-var hs-var">nam'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Var
</span><a href="Gibbon.Common.html#varAppend"><span class="hs-identifier hs-var">varAppend</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680950956"><span class="hs-identifier hs-var">nam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;_original&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>            </span><span class="hs-special">(</span><span class="hs-special">[</span><span id="local-6989586621680950961"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680950961"><span class="hs-identifier hs-var">v0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680950962"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680950962"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span id="local-6989586621680950963"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950963"><span class="hs-identifier hs-var">ty0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680950964"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680950964"><span class="hs-identifier hs-var">ty1</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)] -&gt; ([Var], [Ty])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680950957"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-256"></span><span>            </span><span id="local-6989586621680950965"><span class="annot"><span class="annottext">params :: [Param]
</span><a href="#local-6989586621680950965"><span class="hs-identifier hs-var hs-var">params</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; Param) -&gt; [Var] -&gt; [Param]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680950966"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680950966"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="">[cparam| const void* $id:v |]</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680950961"><span class="hs-identifier hs-var">v0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680950962"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-257"></span><span>        </span><span id="local-6989586621680950969"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680950969"><span class="hs-identifier hs-var">tmpa</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;fst&quot;</span></span><span>
</span><span id="line-258"></span><span>        </span><span id="local-6989586621680950970"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680950970"><span class="hs-identifier hs-var">tmpb</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;snd&quot;</span></span><span>
</span><span id="line-259"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680950971"><span class="annot"><span class="annottext">bod :: [BlockItem]
</span><a href="#local-6989586621680950971"><span class="hs-identifier hs-var hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy ty0) $id:tmpa = *($ty:(codegenTy ty0) *) $id:v0; |]</span></span><span>
</span><span id="line-260"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy ty1) $id:tmpb = *($ty:(codegenTy ty1) *) $id:v1; |]</span></span><span>
</span><span id="line-261"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span>  </span><span class="annot"><span class="">[cstm| return $id:nam'($id:tmpa, $id:tmpb);|]</span></span><span>
</span><span id="line-262"></span><span>                  </span><span class="hs-special">]</span><span>
</span><span id="line-263"></span><span>            </span><span id="local-6989586621680950995"><span class="annot"><span class="annottext">fun :: Func
</span><a href="#local-6989586621680950995"><span class="hs-identifier hs-var hs-var">fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cfun| int $id:nam ($params:params) {
                          $items:bod
                       } |]</span></span><span>
</span><span id="line-266"></span><span>        </span><span class="annot"><span class="annottext">Func -&gt; PassM Func
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Func
</span><a href="#local-6989586621680950995"><span class="hs-identifier hs-var">fun</span></a></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span>      </span><span class="annot"><a href="#local-6989586621680950996"><span class="hs-identifier hs-type">makeProt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Func"><span class="hs-identifier hs-type">C.Func</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#InitGroup"><span class="hs-identifier hs-type">C.InitGroup</span></a></span><span>
</span><span id="line-269"></span><span>      </span><span id="local-6989586621680950996"><span class="annot"><span class="annottext">makeProt :: Func -&gt; Bool -&gt; PassM InitGroup
</span><a href="#local-6989586621680950996"><span class="hs-identifier hs-var hs-var">makeProt</span></a></span></span><span> </span><span id="local-6989586621680950997"><span class="annot"><span class="annottext">Func
</span><a href="#local-6989586621680950997"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621680950998"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680950998"><span class="hs-identifier hs-var">_ispure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-270"></span><span>        </span><span id="local-6989586621680950999"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680950999"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PassM DynFlags
forall (m :: * -&gt; *). MonadReader Config m =&gt; m DynFlags
</span><a href="Gibbon.Common.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-271"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680951000"><span class="annot"><span class="annottext">prot :: InitGroup
</span><a href="#local-6989586621680951000"><span class="hs-identifier hs-var">prot</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#InitGroup"><span class="hs-identifier hs-type">C.InitGroup</span></a></span><span> </span><span id="local-6989586621680951001"><span class="annot"><span class="annottext">DeclSpec
</span><a href="#local-6989586621680951001"><span class="hs-identifier hs-var">_decl_spec</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Attr]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680951002"><span class="annot"><span class="annottext">[Init]
</span><a href="#local-6989586621680951002"><span class="hs-identifier hs-var">_inits</span></a></span></span><span> </span><span id="local-6989586621680951003"><span class="annot"><span class="annottext">SrcLoc
</span><a href="#local-6989586621680951003"><span class="hs-identifier hs-var">_lc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Func -&gt; InitGroup
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#funcProto"><span class="hs-identifier hs-var">C.funcProto</span></a></span><span> </span><span class="annot"><span class="annottext">Func
</span><a href="#local-6989586621680950997"><span class="hs-identifier hs-var">fn</span></a></span><span>
</span><span id="line-272"></span><span>            </span><span id="local-6989586621680951007"><span class="annot"><span class="annottext">_purattr :: Attr
</span><a href="#local-6989586621680951007"><span class="hs-identifier hs-var hs-var">_purattr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; [Exp] -&gt; SrcLoc -&gt; Attr
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Attr"><span class="hs-identifier hs-var">C.Attr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; SrcLoc -&gt; Id
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Id"><span class="hs-identifier hs-var">C.Id</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;pure&quot;</span></span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span>
</span><span id="line-273"></span><span>            </span><span class="hs-comment">-- Only add pure annotations if compiling in pointer mode, and if the</span><span>
</span><span id="line-274"></span><span>            </span><span class="hs-comment">-- --no-pure-annot flag is not passed.</span><span>
</span><span id="line-275"></span><span>            </span><span id="local-6989586621680951009"><span class="annot"><span class="annottext">_pureAnnotOk :: Bool
</span><a href="#local-6989586621680951009"><span class="hs-identifier hs-var hs-var">_pureAnnotOk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_No_PureAnnot"><span class="hs-identifier hs-var">Opt_No_PureAnnot</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680950999"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_Packed"><span class="hs-identifier hs-var">Opt_Packed</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680950999"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>        </span><span class="hs-comment">-- if ispure &amp;&amp; pureAnnotOk</span><span>
</span><span id="line-277"></span><span>        </span><span class="hs-comment">-- then return $ C.InitGroup decl_spec [purattr] inits lc</span><span>
</span><span id="line-278"></span><span>        </span><span class="hs-comment">-- else return prot</span><span>
</span><span id="line-279"></span><span>        </span><span class="annot"><span class="annottext">InitGroup -&gt; PassM InitGroup
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">InitGroup
</span><a href="#local-6989586621680951000"><span class="hs-identifier hs-var">prot</span></a></span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span>      </span><span class="annot"><a href="#local-6989586621680950868"><span class="hs-identifier hs-type">codegenFun</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#FunDecl"><span class="hs-identifier hs-type">FunDecl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Definition"><span class="hs-identifier hs-type">C.Definition</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Definition"><span class="hs-identifier hs-type">C.Definition</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-282"></span><span>      </span><span id="local-6989586621680950868"><span class="annot"><span class="annottext">codegenFun :: FunDecl -&gt; PassM [(Definition, Definition)]
</span><a href="#local-6989586621680950868"><span class="hs-identifier hs-var hs-var">codegenFun</span></a></span></span><span> </span><span id="local-6989586621680951014"><span class="annot"><span class="annottext">fd :: FunDecl
</span><a href="#local-6989586621680951014"><span class="hs-identifier hs-var">fd</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.L4.Syntax.html#FunDecl"><span class="hs-identifier hs-type">FunDecl</span></a></span><span class="hs-special">{</span><span id="local-6989586621680951015"><span class="annot"><span class="annottext">Var
funName :: FunDecl -&gt; Var
funName :: Var
</span><a href="Gibbon.L4.Syntax.html#funName"><span class="hs-identifier hs-var hs-var">funName</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-283"></span><span>          </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680951016"><span class="annot"><span class="annottext">Func
</span><a href="#local-6989586621680951016"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FunDecl -&gt; PassM Func
</span><a href="#local-6989586621680950923"><span class="hs-identifier hs-var">codegenFun'</span></a></span><span> </span><span class="annot"><span class="annottext">FunDecl
</span><a href="#local-6989586621680951014"><span class="hs-identifier hs-var">fd</span></a></span><span>
</span><span id="line-284"></span><span>             </span><span id="local-6989586621680951017"><span class="annot"><span class="annottext">InitGroup
</span><a href="#local-6989586621680951017"><span class="hs-identifier hs-var">prot</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Func -&gt; Bool -&gt; PassM InitGroup
</span><a href="#local-6989586621680950996"><span class="hs-identifier hs-var">makeProt</span></a></span><span> </span><span class="annot"><span class="annottext">Func
</span><a href="#local-6989586621680951016"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunDecl -&gt; Bool
</span><a href="Gibbon.L4.Syntax.html#isPure"><span class="hs-identifier hs-var">isPure</span></a></span><span> </span><span class="annot"><span class="annottext">FunDecl
</span><a href="#local-6989586621680951014"><span class="hs-identifier hs-var">fd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>             </span><span id="local-6989586621680951019"><span class="annot"><span class="annottext">[(Definition, Definition)]
</span><a href="#local-6989586621680951019"><span class="hs-identifier hs-var">sort_fn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Set Var -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#member"><span class="hs-identifier hs-var">S.member</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680951015"><span class="hs-identifier hs-var">funName</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680950860"><span class="hs-identifier hs-var">sort_fns</span></a></span><span>
</span><span id="line-286"></span><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-287"></span><span>                          </span><span id="local-6989586621680951020"><span class="annot"><span class="annottext">Func
</span><a href="#local-6989586621680951020"><span class="hs-identifier hs-var">fun'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FunDecl -&gt; PassM Func
</span><a href="#local-6989586621680950955"><span class="hs-identifier hs-var">codegenSortFn</span></a></span><span> </span><span class="annot"><span class="annottext">FunDecl
</span><a href="#local-6989586621680951014"><span class="hs-identifier hs-var">fd</span></a></span><span>
</span><span id="line-288"></span><span>                          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680951021"><span class="annot"><span class="annottext">prot :: InitGroup
</span><a href="#local-6989586621680951021"><span class="hs-identifier hs-var hs-var">prot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Func -&gt; InitGroup
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#funcProto"><span class="hs-identifier hs-var">C.funcProto</span></a></span><span> </span><span class="annot"><span class="annottext">Func
</span><a href="#local-6989586621680951020"><span class="hs-identifier hs-var">fun'</span></a></span><span>
</span><span id="line-289"></span><span>                          </span><span class="annot"><span class="annottext">[(Definition, Definition)] -&gt; PassM [(Definition, Definition)]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">InitGroup -&gt; SrcLoc -&gt; Definition
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#DecDef"><span class="hs-identifier hs-var">C.DecDef</span></a></span><span> </span><span class="annot"><span class="annottext">InitGroup
</span><a href="#local-6989586621680951021"><span class="hs-identifier hs-var">prot</span></a></span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Func -&gt; SrcLoc -&gt; Definition
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#FuncDef"><span class="hs-identifier hs-var">C.FuncDef</span></a></span><span> </span><span class="annot"><span class="annottext">Func
</span><a href="#local-6989586621680951020"><span class="hs-identifier hs-var">fun'</span></a></span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-290"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[(Definition, Definition)] -&gt; PassM [(Definition, Definition)]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-291"></span><span>             </span><span class="annot"><span class="annottext">[(Definition, Definition)] -&gt; PassM [(Definition, Definition)]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([(Definition, Definition)] -&gt; PassM [(Definition, Definition)])
-&gt; [(Definition, Definition)] -&gt; PassM [(Definition, Definition)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">InitGroup -&gt; SrcLoc -&gt; Definition
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#DecDef"><span class="hs-identifier hs-var">C.DecDef</span></a></span><span> </span><span class="annot"><span class="annottext">InitGroup
</span><a href="#local-6989586621680951017"><span class="hs-identifier hs-var">prot</span></a></span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Func -&gt; SrcLoc -&gt; Definition
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#FuncDef"><span class="hs-identifier hs-var">C.FuncDef</span></a></span><span> </span><span class="annot"><span class="annottext">Func
</span><a href="#local-6989586621680951016"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(Definition, Definition)]
-&gt; [(Definition, Definition)] -&gt; [(Definition, Definition)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[(Definition, Definition)]
</span><a href="#local-6989586621680951019"><span class="hs-identifier hs-var">sort_fn</span></a></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span>      </span><span id="local-6989586621680950876"><span class="annot"><span class="annottext">gibTypesEnum :: Definition
</span><a href="#local-6989586621680950876"><span class="hs-identifier hs-var hs-var">gibTypesEnum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-294"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680951028"><span class="annot"><span class="annottext">go :: FilePath -&gt; CEnum
</span><a href="#local-6989586621680951028"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680951029"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680951029"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; Maybe Exp -&gt; SrcLoc -&gt; CEnum
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#CEnum"><span class="hs-identifier hs-var">C.CEnum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; SrcLoc -&gt; Id
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Id"><span class="hs-identifier hs-var">C.Id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680951029"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;_T&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Exp
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span>
</span><span id="line-295"></span><span>            </span><span id="local-6989586621680951031"><span class="annot"><span class="annottext">decls :: [CEnum]
</span><a href="#local-6989586621680951031"><span class="hs-identifier hs-var hs-var">decls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; CEnum) -&gt; [FilePath] -&gt; [CEnum]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; CEnum
</span><a href="#local-6989586621680951028"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FilePath]
</span><a href="Gibbon.Passes.Codegen.html#builtinFieldTys"><span class="hs-identifier hs-var">builtinFieldTys</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">InfoTable -&gt; [FilePath]
forall k a. Map k a -&gt; [k]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#keys"><span class="hs-identifier hs-var">M.keys</span></a></span><span> </span><span class="annot"><span class="annottext">InfoTable
</span><a href="#local-6989586621680950843"><span class="hs-identifier hs-var">info_tbl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="">[cedecl| typedef enum { $enums:decls } GibDatatype; |]</span></span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span>      </span><span id="local-6989586621680950847"><span class="annot"><span class="annottext">hashIncludes :: FilePath
</span><a href="#local-6989586621680950847"><span class="hs-identifier hs-var hs-var">hashIncludes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-299"></span><span>        </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;/* Gibbon program. */\n\n\
        \#include \&quot;gibbon_rts.h\&quot;\n\n\
        \#include &lt;assert.h&gt;\n\
        \#include &lt;stdio.h&gt;\n\
        \#include &lt;stdlib.h&gt;\n\
        \#include &lt;stdint.h&gt;\n\
        \#include &lt;inttypes.h&gt;\n\
        \#include &lt;math.h&gt;\n\
        \#include &lt;stdbool.h&gt;\n\
        \#include &lt;string.h&gt;\n\
        \#include &lt;time.h&gt;\n\
        \#include &lt;alloca.h&gt;\n\
        \#include &lt;sys/mman.h&gt;\n\
        \#include &lt;sys/resource.h&gt;\n\
        \#include &lt;sys/stat.h&gt;\n\
        \#include &lt;unistd.h&gt;\n\
        \#include &lt;fcntl.h&gt;\n\
        \#include &lt;stdarg.h&gt;\n\
        \#include &lt;errno.h&gt;\n\
        \#include &lt;uthash.h&gt;\n\n\
        \#ifdef _WIN64\n\
        \#include &lt;windows.h&gt;\n\
        \#endif\n\n\
        \#ifdef _GIBBON_POINTER\n\
        \#include &lt;gc.h&gt;\n\
        \#endif\n\n\
        \#ifdef _GIBBON_PARALLEL\n\
        \#include &lt;cilk/cilk.h&gt;\n\
        \#include &lt;cilk/cilk_api.h&gt;\n\
        \#endif\n\n\
        \/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\
        \ * Program starts here\n\
        \ * ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\
        \ */\n\n&quot;</span></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#builtinFieldTys"><span class="hs-identifier hs-type">builtinFieldTys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-336"></span><span id="builtinFieldTys"><span class="annot"><span class="annottext">builtinFieldTys :: [FilePath]
</span><a href="Gibbon.Passes.Codegen.html#builtinFieldTys"><span class="hs-identifier hs-var hs-var">builtinFieldTys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-337"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GibInt&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GibFloat&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GibSym&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GibBool&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GibVector&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GibList&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GibCursor&quot;</span></span><span>
</span><span id="line-338"></span><span>    </span><span class="hs-comment">-- , &quot;GibPackedTag&quot;, &quot;GibBoxedTag&quot;, &quot;GibPtr&quot;, &quot;GibSymDict&quot;, &quot;GibSymSet&quot;</span><span>
</span><span id="line-339"></span><span>    </span><span class="hs-comment">-- , &quot;GibSymHash&quot;, &quot;GibIntHash&quot;</span><span>
</span><span id="line-340"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#initSymTable"><span class="hs-identifier hs-type">initSymTable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#SymTable"><span class="hs-identifier hs-type">SymTable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Definition"><span class="hs-identifier hs-type">C.Definition</span></a></span><span>
</span><span id="line-343"></span><span id="initSymTable"><span class="annot"><span class="annottext">initSymTable :: SymTable -&gt; Definition
</span><a href="Gibbon.Passes.Codegen.html#initSymTable"><span class="hs-identifier hs-var hs-var">initSymTable</span></a></span></span><span> </span><span id="local-6989586621680951063"><span class="annot"><span class="annottext">SymTable
</span><a href="#local-6989586621680951063"><span class="hs-identifier hs-var">sym_tbl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-344"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680951064"><span class="annot"><span class="annottext">body :: [BlockItem]
</span><a href="#local-6989586621680951064"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">((Word16, FilePath) -&gt; BlockItem)
-&gt; [(Word16, FilePath)] -&gt; [BlockItem]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span>
</span><span id="line-345"></span><span>          </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680951065"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621680951065"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680951066"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680951066"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680951066"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-346"></span><span>                       </span><span class="hs-comment">-- Special symbols that get handled differently</span><span>
</span><span id="line-347"></span><span>                       </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;NEWLINE&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| gib_set_newline($k); |]</span></span><span>
</span><span id="line-348"></span><span>                       </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;COMMA&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| set_comma($k); |]</span></span><span>
</span><span id="line-349"></span><span>                       </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;SPACE&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| gib_set_space($k); |]</span></span><span>
</span><span id="line-350"></span><span>                       </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;LEFTPAREN&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| gib_set_leftparen($k); |]</span></span><span>
</span><span id="line-351"></span><span>                       </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;RIGHTPAREN&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| gib_set_rightparen($k); |]</span></span><span>
</span><span id="line-352"></span><span>                       </span><span class="hs-comment">-- Normal symbols just get added to the table</span><span>
</span><span id="line-353"></span><span>                       </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| gib_add_symbol($k, $v); |]</span></span><span>
</span><span id="line-354"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SymTable -&gt; [(Word16, FilePath)]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#toList"><span class="hs-identifier hs-var">M.toList</span></a></span><span> </span><span class="annot"><span class="annottext">SymTable
</span><a href="#local-6989586621680951063"><span class="hs-identifier hs-var">sym_tbl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>        </span><span id="local-6989586621680951069"><span class="annot"><span class="annottext">fun :: Func
</span><a href="#local-6989586621680951069"><span class="hs-identifier hs-var hs-var">fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cfun| void symbol_table_initialize(void) { $items:body } |]</span></span><span>
</span><span id="line-357"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Func -&gt; SrcLoc -&gt; Definition
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#FuncDef"><span class="hs-identifier hs-var">C.FuncDef</span></a></span><span> </span><span class="annot"><span class="annottext">Func
</span><a href="#local-6989586621680951069"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#initInfoTable"><span class="hs-identifier hs-type">initInfoTable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#InfoTable"><span class="hs-identifier hs-type">InfoTable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Definition"><span class="hs-identifier hs-type">C.Definition</span></a></span><span>
</span><span id="line-361"></span><span id="initInfoTable"><span class="annot"><span class="annottext">initInfoTable :: InfoTable -&gt; Definition
</span><a href="Gibbon.Passes.Codegen.html#initInfoTable"><span class="hs-identifier hs-var hs-var">initInfoTable</span></a></span></span><span> </span><span id="local-6989586621680951141"><span class="annot"><span class="annottext">InfoTable
</span><a href="#local-6989586621680951141"><span class="hs-identifier hs-var">info_tbl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-362"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680951142"><span class="annot"><span class="annottext">info_table_len :: Int
</span><a href="#local-6989586621680951142"><span class="hs-identifier hs-var hs-var">info_table_len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InfoTable -&gt; Int
forall a. Map FilePath a -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">InfoTable
</span><a href="#local-6989586621680951141"><span class="hs-identifier hs-var">info_tbl</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="Gibbon.Passes.Codegen.html#builtinFieldTys"><span class="hs-identifier hs-var">builtinFieldTys</span></a></span><span>
</span><span id="line-363"></span><span>        </span><span id="local-6989586621680951145"><span class="annot"><span class="annottext">body :: [BlockItem]
</span><a href="#local-6989586621680951145"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| int error = gib_info_table_initialize($int:info_table_len); |]</span></span><span>
</span><span id="line-364"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| if (error &lt; 0) { fprintf(stderr, &quot;Couldn't initialize info table, errorno=%d&quot;, error); exit(1); } |]</span></span><span>
</span><span id="line-365"></span><span>                </span><span class="hs-special">]</span><span>  </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-366"></span><span>                </span><span class="hs-comment">-- insert_scalar_info ++</span><span>
</span><span id="line-367"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| typename GibDatatype field_tys[$int:max_fields]; |]</span></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680951159"><span class="hs-identifier hs-var">insert_dcon_info</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-368"></span><span>                </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| gib_info_table_finalize(); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-369"></span><span>        </span><span id="local-6989586621680951160"><span class="annot"><span class="annottext">fun :: Func
</span><a href="#local-6989586621680951160"><span class="hs-identifier hs-var hs-var">fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cfun| void info_table_initialize(void) { $items:body } |]</span></span><span>
</span><span id="line-370"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Func -&gt; SrcLoc -&gt; Definition
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#FuncDef"><span class="hs-identifier hs-var">C.FuncDef</span></a></span><span> </span><span class="annot"><span class="annottext">Func
</span><a href="#local-6989586621680951160"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span>
</span><span id="line-371"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-372"></span><span>    </span><span id="local-6989586621680951155"><span class="annot"><span class="annottext">max_fields :: Int
</span><a href="#local-6989586621680951155"><span class="hs-identifier hs-var hs-var">max_fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Map FilePath DataConInfo -&gt; Int -&gt; Int) -&gt; Int -&gt; InfoTable -&gt; Int
forall a b k. (a -&gt; b -&gt; b) -&gt; b -&gt; Map k a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#foldr"><span class="hs-identifier hs-var">M.foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680951162"><span class="annot"><span class="annottext">Map FilePath DataConInfo
</span><a href="#local-6989586621680951162"><span class="hs-identifier hs-var">tyc_info</span></a></span></span><span> </span><span id="local-6989586621680951163"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680951163"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-373"></span><span>                              </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#max"><span class="hs-identifier hs-var">max</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680951163"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-374"></span><span>                                  </span><span class="annot"><span class="annottext">(FilePath -&gt; DataConInfo -&gt; Int -&gt; Int)
-&gt; Int -&gt; Map FilePath DataConInfo -&gt; Int
forall k a b. (k -&gt; a -&gt; b -&gt; b) -&gt; b -&gt; Map k a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#foldrWithKey"><span class="hs-identifier hs-var">M.foldrWithKey</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680951166"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680951166"><span class="hs-identifier hs-var">dcon</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#DataConInfo"><span class="hs-identifier hs-type">DataConInfo</span></a></span><span class="hs-special">{</span><span id="local-6989586621680951168"><span class="annot"><span class="annottext">Int
num_scalars :: Int
num_scalars :: DataConInfo -&gt; Int
</span><a href="#local-6989586621680951168"><span class="hs-identifier hs-var hs-var">num_scalars</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680951170"><span class="annot"><span class="annottext">Int
num_packed :: Int
num_packed :: DataConInfo -&gt; Int
</span><a href="#local-6989586621680951170"><span class="hs-identifier hs-var hs-var">num_packed</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621680951172"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680951172"><span class="hs-identifier hs-var">acc2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-375"></span><span>                                                      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
</span><a href="Gibbon.Language.Constants.html#isIndirectionTag"><span class="hs-identifier hs-var">GL.isIndirectionTag</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680951166"><span class="hs-identifier hs-var">dcon</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680951172"><span class="hs-identifier hs-var">acc2</span></a></span><span> </span><span class="hs-keyword">else</span><span>
</span><span id="line-376"></span><span>                                                          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680951168"><span class="hs-identifier hs-var">num_scalars</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680951170"><span class="hs-identifier hs-var">num_packed</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#max"><span class="hs-operator hs-var">`max`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680951172"><span class="hs-identifier hs-var">acc2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>                                                 </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-378"></span><span>                                                 </span><span class="annot"><span class="annottext">Map FilePath DataConInfo
</span><a href="#local-6989586621680951162"><span class="hs-identifier hs-var">tyc_info</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>                         </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-380"></span><span>                         </span><span class="annot"><span class="annottext">InfoTable
</span><a href="#local-6989586621680951141"><span class="hs-identifier hs-var">info_tbl</span></a></span><span>
</span><span id="line-381"></span><span>    </span><span id="local-6989586621680951178"><span class="annot"><span class="annottext">_insert_scalar_info :: [BlockItem]
</span><a href="#local-6989586621680951178"><span class="hs-identifier hs-var hs-var">_insert_scalar_info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; BlockItem) -&gt; [FilePath] -&gt; [BlockItem]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680951179"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680951179"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680951180"><span class="annot"><span class="annottext">ty_t :: FilePath
</span><a href="#local-6989586621680951180"><span class="hs-identifier hs-var hs-var">ty_t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680951179"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;_T&quot;</span></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| gib_info_table_insert_scalar($id:ty_t, sizeof($id:ty)); |]</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="Gibbon.Passes.Codegen.html#builtinFieldTys"><span class="hs-identifier hs-var">builtinFieldTys</span></a></span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span>    </span><span id="local-6989586621680951159"><span class="annot"><span class="annottext">insert_dcon_info :: [BlockItem]
</span><a href="#local-6989586621680951159"><span class="hs-identifier hs-var hs-var">insert_dcon_info</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath
 -&gt; Map FilePath DataConInfo -&gt; [BlockItem] -&gt; [BlockItem])
-&gt; [BlockItem] -&gt; InfoTable -&gt; [BlockItem]
forall k a b. (k -&gt; a -&gt; b -&gt; b) -&gt; b -&gt; Map k a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#foldrWithKey"><span class="hs-identifier hs-var">M.foldrWithKey</span></a></span><span>
</span><span id="line-384"></span><span>                           </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680951182"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680951182"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span id="local-6989586621680951183"><span class="annot"><span class="annottext">Map FilePath DataConInfo
</span><a href="#local-6989586621680951183"><span class="hs-identifier hs-var">tyc_info</span></a></span></span><span> </span><span id="local-6989586621680951184"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680951184"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-385"></span><span>                                </span><span class="annot"><span class="annottext">(FilePath -&gt; DataConInfo -&gt; [BlockItem] -&gt; [BlockItem])
-&gt; [BlockItem] -&gt; Map FilePath DataConInfo -&gt; [BlockItem]
forall k a b. (k -&gt; a -&gt; b -&gt; b) -&gt; b -&gt; Map k a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#foldrWithKey"><span class="hs-identifier hs-var">M.foldrWithKey</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680951185"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680951185"><span class="hs-identifier hs-var">dcon</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#DataConInfo"><span class="hs-identifier hs-type">DataConInfo</span></a></span><span> </span><span id="local-6989586621680951186"><span class="annot"><span class="annottext">Tag
</span><a href="#local-6989586621680951186"><span class="hs-identifier hs-var">dcon_tag</span></a></span></span><span> </span><span id="local-6989586621680951187"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680951187"><span class="hs-identifier hs-var">scalar_bytes</span></a></span></span><span> </span><span id="local-6989586621680951188"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680951188"><span class="hs-identifier hs-var">num_shortcut</span></a></span></span><span> </span><span id="local-6989586621680951189"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680951189"><span class="hs-identifier hs-var">num_scalars</span></a></span></span><span> </span><span id="local-6989586621680951190"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680951190"><span class="hs-identifier hs-var">num_packed</span></a></span></span><span> </span><span id="local-6989586621680951191"><span class="annot"><span class="annottext">[Ty3]
</span><a href="#local-6989586621680951191"><span class="hs-identifier hs-var">field_tys</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680951192"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680951192"><span class="hs-identifier hs-var">acc2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-386"></span><span>                                                    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
</span><a href="Gibbon.Language.Constants.html#isIndirectionTag"><span class="hs-identifier hs-var">GL.isIndirectionTag</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680951185"><span class="hs-identifier hs-var">dcon</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680951192"><span class="hs-identifier hs-var">acc2</span></a></span><span> </span><span class="hs-keyword">else</span><span>
</span><span id="line-387"></span><span>                                                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680951193"><span class="annot"><span class="annottext">packed_field_tys :: [Ty3]
</span><a href="#local-6989586621680951193"><span class="hs-identifier hs-var hs-var">packed_field_tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Ty3 -&gt; Bool) -&gt; [Ty3] -&gt; [Ty3]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="annot"><span class="annottext">Ty3 -&gt; Bool
forall a. UrTy a -&gt; Bool
</span><a href="Gibbon.Language.html#isPackedTy"><span class="hs-identifier hs-var">GL.isPackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty3]
</span><a href="#local-6989586621680951191"><span class="hs-identifier hs-var">field_tys</span></a></span><span>
</span><span id="line-388"></span><span>                                                        </span><span id="local-6989586621680951195"><span class="annot"><span class="annottext">set_field_tys :: [BlockItem]
</span><a href="#local-6989586621680951195"><span class="hs-identifier hs-var hs-var">set_field_tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-389"></span><span>                                                            </span><span class="annot"><span class="annottext">((Ty3, Integer) -&gt; BlockItem) -&gt; [(Ty3, Integer)] -&gt; [BlockItem]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680951196"><span class="annot"><span class="annottext">Ty3
</span><a href="#local-6989586621680951196"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680951197"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680951197"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-390"></span><span>                                                                     </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680951198"><span class="annot"><span class="annottext">ty' :: FilePath
</span><a href="#local-6989586621680951198"><span class="hs-identifier hs-var hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty3
</span><a href="#local-6989586621680951196"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-391"></span><span>                                                                                    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-type">GL.PackedTy</span></a></span><span> </span><span id="local-6989586621680951200"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680951200"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680951200"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-392"></span><span>                                                                                    </span><span class="annot"><span class="annottext">Ty3
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; FilePath
</span><a href="Gibbon.Passes.Codegen.html#makeName%27"><span class="hs-identifier hs-var">makeName'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty3 -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#fromL3Ty"><span class="hs-identifier hs-var">fromL3Ty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty3
</span><a href="#local-6989586621680951196"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>                                                                               </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;_T&quot;</span></span><span>
</span><span id="line-394"></span><span>                                                                         </span><span id="local-6989586621680951203"><span class="annot"><span class="annottext">e :: Id
</span><a href="#local-6989586621680951203"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; SrcLoc -&gt; Id
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Id"><span class="hs-identifier hs-var">C.Id</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680951198"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>                                                                     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| field_tys[$int:i] = ($id:e); |]</span></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>                                                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty3] -&gt; [Integer] -&gt; [(Ty3, Integer)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty3]
</span><a href="#local-6989586621680951193"><span class="hs-identifier hs-var">packed_field_tys</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>                                                        </span><span id="local-6989586621680951207"><span class="annot"><span class="annottext">tycon' :: FilePath
</span><a href="#local-6989586621680951207"><span class="hs-identifier hs-var hs-var">tycon'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680951182"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;_T&quot;</span></span><span>
</span><span id="line-398"></span><span>                                                        </span><span id="local-6989586621680951208"><span class="annot"><span class="annottext">insert_into_tbl :: [BlockItem]
</span><a href="#local-6989586621680951208"><span class="hs-identifier hs-var hs-var">insert_into_tbl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| error = gib_info_table_insert_packed_dcon($id:tycon', $int:dcon_tag, $int:scalar_bytes, $int:num_shortcut, $int:num_scalars, $int:num_packed, field_tys, $int:num_packed); |]</span></span><span>
</span><span id="line-399"></span><span>                                                                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| if (error &lt; 0) { fprintf(stderr, &quot;Couldn't insert into info table, errorno=%d, tycon=%d, dcon=%d&quot;, error, $id:tycon', $int:dcon_tag); exit(1); } |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-400"></span><span>                                             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680951195"><span class="hs-identifier hs-var">set_field_tys</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680951208"><span class="hs-identifier hs-var">insert_into_tbl</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680951192"><span class="hs-identifier hs-var">acc2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>                                        </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680951184"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-402"></span><span>                                        </span><span class="annot"><span class="annottext">Map FilePath DataConInfo
</span><a href="#local-6989586621680951183"><span class="hs-identifier hs-var">tyc_info</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>                           </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-404"></span><span>                           </span><span class="annot"><span class="annottext">InfoTable
</span><a href="#local-6989586621680951141"><span class="hs-identifier hs-var">info_tbl</span></a></span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#makeStructs"><span class="hs-identifier hs-type">makeStructs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Syntax.html#Ty"><span class="hs-identifier hs-type">Ty</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Definition"><span class="hs-identifier hs-type">C.Definition</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-408"></span><span id="makeStructs"><span class="annot"><span class="annottext">makeStructs :: [[Ty]] -&gt; [Definition]
</span><a href="Gibbon.Passes.Codegen.html#makeStructs"><span class="hs-identifier hs-var hs-var">makeStructs</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-409"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#makeStructs"><span class="hs-identifier hs-var">makeStructs</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680951218"><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680951218"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621680951219"><span class="annot"><span class="annottext">[[Ty]]
</span><a href="#local-6989586621680951219"><span class="hs-identifier hs-var">ts'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-410"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680951220"><span class="annot"><span class="annottext">strName :: FilePath
</span><a href="#local-6989586621680951220"><span class="hs-identifier hs-var hs-var">strName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; FilePath
</span><a href="Gibbon.Passes.Codegen.html#makeName"><span class="hs-identifier hs-var">makeName</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680951218"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-411"></span><span>          </span><span id="local-6989586621680951221"><span class="annot"><span class="annottext">decls :: [FieldGroup]
</span><a href="#local-6989586621680951221"><span class="hs-identifier hs-var hs-var">decls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Ty -&gt; Int -&gt; FieldGroup) -&gt; [Ty] -&gt; [Int] -&gt; [FieldGroup]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680951223"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680951223"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621680951224"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680951224"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="">[csdecl| $ty:(codegenTy t) $id:(&quot;field&quot;++(show n)); |]</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680951218"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-412"></span><span>          </span><span id="local-6989586621680951232"><span class="annot"><span class="annottext">d :: Definition
</span><a href="#local-6989586621680951232"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cedecl| typedef struct $id:(strName ++ &quot;_struct&quot;) { $sdecls:decls } $id:strName; |]</span></span><span>
</span><span id="line-413"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Definition
</span><a href="#local-6989586621680951232"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Definition -&gt; [Definition] -&gt; [Definition]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[[Ty]] -&gt; [Definition]
</span><a href="Gibbon.Passes.Codegen.html#makeStructs"><span class="hs-identifier hs-var">makeStructs</span></a></span><span> </span><span class="annot"><span class="annottext">[[Ty]]
</span><a href="#local-6989586621680951219"><span class="hs-identifier hs-var">ts'</span></a></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#uniqueDicts"><span class="hs-identifier hs-type">uniqueDicts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Syntax.html#Ty"><span class="hs-identifier hs-type">Ty</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Syntax.html#Ty"><span class="hs-identifier hs-type">Ty</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-416"></span><span id="uniqueDicts"><span class="annot"><span class="annottext">uniqueDicts :: [[Ty]] -&gt; [[Ty]]
</span><a href="Gibbon.Passes.Codegen.html#uniqueDicts"><span class="hs-identifier hs-var hs-var">uniqueDicts</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-417"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#uniqueDicts"><span class="hs-identifier hs-var">uniqueDicts</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680951234"><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680951234"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621680951235"><span class="annot"><span class="annottext">[[Ty]]
</span><a href="#local-6989586621680951235"><span class="hs-identifier hs-var">ts'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Ty -&gt; Ty) -&gt; [Ty] -&gt; [Ty]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty
</span><a href="#local-6989586621680951236"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680951234"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; [[Ty]] -&gt; [[Ty]]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[[Ty]] -&gt; [[Ty]]
</span><a href="Gibbon.Passes.Codegen.html#uniqueDicts"><span class="hs-identifier hs-var">uniqueDicts</span></a></span><span> </span><span class="annot"><span class="annottext">[[Ty]]
</span><a href="#local-6989586621680951235"><span class="hs-identifier hs-var">ts'</span></a></span><span>
</span><span id="line-418"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680951236"><span class="annot"><span class="annottext">f :: Ty -&gt; Ty
</span><a href="#local-6989586621680951236"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#SymDictTy"><span class="hs-identifier hs-type">SymDictTy</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680951239"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680951239"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#SymDictTy"><span class="hs-identifier hs-var">SymDictTy</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;_&quot;</span></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680951239"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-419"></span><span>          </span><span class="annot"><a href="#local-6989586621680951236"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span id="local-6989586621680951240"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680951240"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680951240"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span class="annot"><span class="hs-comment">-- | Replace returns with assignments to a given set of destinations.</span></span><span>
</span><span id="line-422"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#rewriteReturns"><span class="hs-identifier hs-type">rewriteReturns</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Tail"><span class="hs-identifier hs-type">Tail</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Gibbon.L4.Syntax.html#Ty"><span class="hs-identifier hs-type">Ty</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Tail"><span class="hs-identifier hs-type">Tail</span></a></span><span>
</span><span id="line-423"></span><span id="rewriteReturns"><span class="annot"><span class="annottext">rewriteReturns :: Tail -&gt; [(Var, Ty)] -&gt; Tail
</span><a href="Gibbon.Passes.Codegen.html#rewriteReturns"><span class="hs-identifier hs-var hs-var">rewriteReturns</span></a></span></span><span> </span><span id="local-6989586621680951250"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951250"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621680951251"><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680951251"><span class="hs-identifier hs-var">bnds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-424"></span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680951252"><span class="annot"><span class="annottext">go :: Tail -&gt; Tail
</span><a href="#local-6989586621680951252"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680951253"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951253"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tail -&gt; [(Var, Ty)] -&gt; Tail
</span><a href="Gibbon.Passes.Codegen.html#rewriteReturns"><span class="hs-identifier hs-var">rewriteReturns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951253"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680951251"><span class="hs-identifier hs-var">bnds</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-425"></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951250"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-426"></span><span>   </span><span class="annot"><span class="annottext">Tail
</span><a href="Gibbon.L4.Syntax.html#EndOfMain"><span class="hs-identifier hs-var">EndOfMain</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951250"><span class="hs-identifier hs-var">tl</span></a></span><span>
</span><span id="line-427"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#RetValsT"><span class="hs-identifier hs-type">RetValsT</span></a></span><span> </span><span id="local-6989586621680951254"><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680951254"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty, Triv)] -&gt; Maybe Tail -&gt; Tail
</span><a href="Gibbon.L4.Syntax.html#AssnValsT"><span class="hs-identifier hs-var">AssnValsT</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680951255"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680951256"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680951257"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680951255"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680951255"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680951256"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680951256"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680951251"><span class="hs-identifier hs-var">bnds</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680951257"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680951257"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680951254"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe Tail
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-428"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#Goto"><span class="hs-identifier hs-type">Goto</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951250"><span class="hs-identifier hs-var">tl</span></a></span><span>
</span><span id="line-429"></span><span>
</span><span id="line-430"></span><span>   </span><span class="hs-comment">-- Here we've already rewritten the tail to assign values</span><span>
</span><span id="line-431"></span><span>   </span><span class="hs-comment">-- somewhere.. and now we want to REREWRITE it?</span><span>
</span><span id="line-432"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#AssnValsT"><span class="hs-identifier hs-type">AssnValsT</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty, Triv)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe Tail
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Tail
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span class="annot"><span class="annottext">(FilePath -&gt; Tail) -&gt; FilePath -&gt; Tail
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;rewriteReturns: Internal invariant broken:\n &quot;</span></span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">Tail -&gt; FilePath
forall a. Out a =&gt; a -&gt; FilePath
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951250"><span class="hs-identifier hs-var">tl</span></a></span><span>
</span><span id="line-433"></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621680951260"><span class="annot"><span class="annottext">e :: Tail
</span><a href="#local-6989586621680951260"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetCallT"><span class="hs-identifier hs-type">LetCallT</span></a></span><span class="hs-special">{</span><span id="local-6989586621680951261"><span class="annot"><span class="annottext">Tail
bod :: Tail -&gt; Tail
bod :: Tail
</span><a href="Gibbon.L4.Syntax.html#bod"><span class="hs-identifier hs-var hs-var">bod</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951260"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">bod :: Tail
</span><a href="Gibbon.L4.Syntax.html#bod"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tail -&gt; Tail
</span><a href="#local-6989586621680951252"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951261"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-434"></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621680951262"><span class="annot"><span class="annottext">e :: Tail
</span><a href="#local-6989586621680951262"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetPrimCallT"><span class="hs-identifier hs-type">LetPrimCallT</span></a></span><span class="hs-special">{</span><span id="local-6989586621680951263"><span class="annot"><span class="annottext">Tail
bod :: Tail -&gt; Tail
bod :: Tail
</span><a href="Gibbon.L4.Syntax.html#bod"><span class="hs-identifier hs-var hs-var">bod</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951262"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">bod :: Tail
</span><a href="Gibbon.L4.Syntax.html#bod"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tail -&gt; Tail
</span><a href="#local-6989586621680951252"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951263"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-435"></span><span>   </span><span class="hs-special">(</span><span id="local-6989586621680951264"><span class="annot"><span class="annottext">e :: Tail
</span><a href="#local-6989586621680951264"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetTrivT"><span class="hs-identifier hs-type">LetTrivT</span></a></span><span class="hs-special">{</span><span id="local-6989586621680951265"><span class="annot"><span class="annottext">Tail
bod :: Tail -&gt; Tail
bod :: Tail
</span><a href="Gibbon.L4.Syntax.html#bod"><span class="hs-identifier hs-var hs-var">bod</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951264"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">bod :: Tail
</span><a href="Gibbon.L4.Syntax.html#bod"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tail -&gt; Tail
</span><a href="#local-6989586621680951252"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951265"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-436"></span><span>   </span><span class="hs-comment">-- We don't recur on the &quot;tails&quot; under the if, because they're not</span><span>
</span><span id="line-437"></span><span>   </span><span class="hs-comment">-- tail with respect to our redex:</span><span>
</span><span id="line-438"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetIfT"><span class="hs-identifier hs-type">LetIfT</span></a></span><span> </span><span id="local-6989586621680951266"><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680951266"><span class="hs-identifier hs-var">bnd</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680951267"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680951267"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680951268"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951268"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680951269"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951269"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680951270"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951270"><span class="hs-identifier hs-var">bod</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)] -&gt; (Triv, Tail, Tail) -&gt; Tail -&gt; Tail
</span><a href="Gibbon.L4.Syntax.html#LetIfT"><span class="hs-identifier hs-var">LetIfT</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680951266"><span class="hs-identifier hs-var">bnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680951267"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951268"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951269"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tail -&gt; Tail
</span><a href="#local-6989586621680951252"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951270"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetTimedT"><span class="hs-identifier hs-type">LetTimedT</span></a></span><span> </span><span id="local-6989586621680951271"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680951271"><span class="hs-identifier hs-var">flg</span></a></span></span><span> </span><span id="local-6989586621680951272"><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680951272"><span class="hs-identifier hs-var">bnd</span></a></span></span><span> </span><span id="local-6989586621680951273"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951273"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span id="local-6989586621680951274"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951274"><span class="hs-identifier hs-var">bod</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [(Var, Ty)] -&gt; Tail -&gt; Tail -&gt; Tail
</span><a href="Gibbon.L4.Syntax.html#LetTimedT"><span class="hs-identifier hs-var">LetTimedT</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680951271"><span class="hs-identifier hs-var">flg</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680951272"><span class="hs-identifier hs-var">bnd</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951273"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tail -&gt; Tail
</span><a href="#local-6989586621680951252"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951274"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-440"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetArenaT"><span class="hs-identifier hs-type">LetArenaT</span></a></span><span> </span><span id="local-6989586621680951275"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680951275"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680951276"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951276"><span class="hs-identifier hs-var">bod</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Tail -&gt; Tail
</span><a href="Gibbon.L4.Syntax.html#LetArenaT"><span class="hs-identifier hs-var">LetArenaT</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680951275"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tail -&gt; Tail
</span><a href="#local-6989586621680951252"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951276"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-441"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetUnpackT"><span class="hs-identifier hs-type">LetUnpackT</span></a></span><span> </span><span id="local-6989586621680951277"><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680951277"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span id="local-6989586621680951278"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680951278"><span class="hs-identifier hs-var">scrt</span></a></span></span><span> </span><span id="local-6989586621680951279"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951279"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)] -&gt; Var -&gt; Tail -&gt; Tail
</span><a href="Gibbon.L4.Syntax.html#LetUnpackT"><span class="hs-identifier hs-var">LetUnpackT</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680951277"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680951278"><span class="hs-identifier hs-var">scrt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tail -&gt; Tail
</span><a href="#local-6989586621680951252"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951279"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-442"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetAllocT"><span class="hs-identifier hs-type">LetAllocT</span></a></span><span> </span><span id="local-6989586621680951280"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680951280"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621680951281"><span class="annot"><span class="annottext">[(Ty, Triv)]
</span><a href="#local-6989586621680951281"><span class="hs-identifier hs-var">vals</span></a></span></span><span> </span><span id="local-6989586621680951282"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951282"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [(Ty, Triv)] -&gt; Tail -&gt; Tail
</span><a href="Gibbon.L4.Syntax.html#LetAllocT"><span class="hs-identifier hs-var">LetAllocT</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680951280"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">[(Ty, Triv)]
</span><a href="#local-6989586621680951281"><span class="hs-identifier hs-var">vals</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tail -&gt; Tail
</span><a href="#local-6989586621680951252"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951282"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetAvailT"><span class="hs-identifier hs-type">LetAvailT</span></a></span><span> </span><span id="local-6989586621680951283"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680951283"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621680951284"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951284"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; Tail -&gt; Tail
</span><a href="Gibbon.L4.Syntax.html#LetAvailT"><span class="hs-identifier hs-var">LetAvailT</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680951283"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tail -&gt; Tail
</span><a href="#local-6989586621680951252"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951284"><span class="hs-identifier hs-var">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#IfT"><span class="hs-identifier hs-type">IfT</span></a></span><span> </span><span id="local-6989586621680951285"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680951285"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680951286"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951286"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680951287"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951287"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Triv -&gt; Tail -&gt; Tail -&gt; Tail
</span><a href="Gibbon.L4.Syntax.html#IfT"><span class="hs-identifier hs-var">IfT</span></a></span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680951285"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tail -&gt; Tail
</span><a href="#local-6989586621680951252"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951286"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tail -&gt; Tail
</span><a href="#local-6989586621680951252"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680951287"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#ErrT"><span class="hs-identifier hs-type">ErrT</span></a></span><span> </span><span id="local-6989586621680951288"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680951288"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Tail
</span><a href="Gibbon.L4.Syntax.html#ErrT"><span class="hs-identifier hs-var">ErrT</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680951288"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#Switch"><span class="hs-identifier hs-type">Switch</span></a></span><span> </span><span id="local-6989586621680951289"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680951289"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span id="local-6989586621680951290"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680951290"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621680951291"><span class="annot"><span class="annottext">Alts
</span><a href="#local-6989586621680951291"><span class="hs-identifier hs-var">alts</span></a></span></span><span> </span><span id="local-6989586621680951292"><span class="annot"><span class="annottext">Maybe Tail
</span><a href="#local-6989586621680951292"><span class="hs-identifier hs-var">def</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Triv -&gt; Alts -&gt; Maybe Tail -&gt; Tail
</span><a href="Gibbon.L4.Syntax.html#Switch"><span class="hs-identifier hs-var">Switch</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680951289"><span class="hs-identifier hs-var">lbl</span></a></span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680951290"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Tail -&gt; Tail) -&gt; Alts -&gt; Alts
</span><a href="#local-6989586621680951293"><span class="hs-identifier hs-var">mapAlts</span></a></span><span> </span><span class="annot"><span class="annottext">Tail -&gt; Tail
</span><a href="#local-6989586621680951252"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Alts
</span><a href="#local-6989586621680951291"><span class="hs-identifier hs-var">alts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Tail -&gt; Tail) -&gt; Maybe Tail -&gt; Maybe Tail
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Tail -&gt; Tail
</span><a href="#local-6989586621680951252"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Tail
</span><a href="#local-6989586621680951292"><span class="hs-identifier hs-var">def</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-447"></span><span>   </span><span class="hs-comment">-- Oops, this is not REALLY a tail call.  Hoist it and go under:</span><span>
</span><span id="line-448"></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#TailCall"><span class="hs-identifier hs-type">TailCall</span></a></span><span> </span><span id="local-6989586621680951294"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680951294"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680951295"><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680951295"><span class="hs-identifier hs-var">rnds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680951296"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680951296"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680951297"><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680951297"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)] -&gt; ([Var], [Ty])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680951251"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-449"></span><span>                            </span><span id="local-6989586621680951298"><span class="annot"><span class="annottext">vs' :: [Var]
</span><a href="#local-6989586621680951298"><span class="hs-identifier hs-var hs-var">vs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Var) -&gt; [FilePath] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Var) -&gt; (FilePath -&gt; FilePath) -&gt; FilePath -&gt; Var
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;hack&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var -&gt; FilePath) -&gt; [Var] -&gt; [FilePath]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; FilePath
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680951296"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- FIXME: Gensym</span><span>
</span><span id="line-450"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [(Var, Ty)] -&gt; Var -&gt; [Triv] -&gt; Tail -&gt; Tail
</span><a href="Gibbon.L4.Syntax.html#LetCallT"><span class="hs-identifier hs-var">LetCallT</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; [Ty] -&gt; [(Var, Ty)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680951298"><span class="hs-identifier hs-var">vs'</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680951297"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680951294"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680951295"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-451"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tail -&gt; [(Var, Ty)] -&gt; Tail
</span><a href="Gibbon.Passes.Codegen.html#rewriteReturns"><span class="hs-identifier hs-var">rewriteReturns</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Triv] -&gt; Tail
</span><a href="Gibbon.L4.Syntax.html#RetValsT"><span class="hs-identifier hs-var">RetValsT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var -&gt; Triv) -&gt; [Var] -&gt; [Triv]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Triv
</span><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-var">VarTriv</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680951298"><span class="hs-identifier hs-var">vs'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680951251"><span class="hs-identifier hs-var">bnds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-453"></span><span>   </span><span id="local-6989586621680951293"><span class="annot"><span class="annottext">mapAlts :: (Tail -&gt; Tail) -&gt; Alts -&gt; Alts
</span><a href="#local-6989586621680951293"><span class="hs-identifier hs-var hs-var">mapAlts</span></a></span></span><span> </span><span id="local-6989586621680951300"><span class="annot"><span class="annottext">Tail -&gt; Tail
</span><a href="#local-6989586621680951300"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#TagAlts"><span class="hs-identifier hs-type">TagAlts</span></a></span><span> </span><span id="local-6989586621680951301"><span class="annot"><span class="annottext">[(Tag, Tail)]
</span><a href="#local-6989586621680951301"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Tag, Tail)] -&gt; Alts
</span><a href="Gibbon.L4.Syntax.html#TagAlts"><span class="hs-identifier hs-var">TagAlts</span></a></span><span> </span><span class="annot"><span class="annottext">([(Tag, Tail)] -&gt; Alts) -&gt; [(Tag, Tail)] -&gt; Alts
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Tag] -&gt; [Tail] -&gt; [(Tag, Tail)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Tag, Tail) -&gt; Tag) -&gt; [(Tag, Tail)] -&gt; [Tag]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Tag, Tail) -&gt; Tag
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[(Tag, Tail)]
</span><a href="#local-6989586621680951301"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Tag, Tail) -&gt; Tail) -&gt; [(Tag, Tail)] -&gt; [Tail]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tail -&gt; Tail
</span><a href="#local-6989586621680951300"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Tail -&gt; Tail) -&gt; ((Tag, Tail) -&gt; Tail) -&gt; (Tag, Tail) -&gt; Tail
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Tag, Tail) -&gt; Tail
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Tag, Tail)]
</span><a href="#local-6989586621680951301"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-454"></span><span>   </span><span class="annot"><a href="#local-6989586621680951293"><span class="hs-identifier hs-var">mapAlts</span></a></span><span> </span><span id="local-6989586621680951302"><span class="annot"><span class="annottext">Tail -&gt; Tail
</span><a href="#local-6989586621680951302"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#IntAlts"><span class="hs-identifier hs-type">IntAlts</span></a></span><span> </span><span id="local-6989586621680951303"><span class="annot"><span class="annottext">[(Int64, Tail)]
</span><a href="#local-6989586621680951303"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Int64, Tail)] -&gt; Alts
</span><a href="Gibbon.L4.Syntax.html#IntAlts"><span class="hs-identifier hs-var">IntAlts</span></a></span><span> </span><span class="annot"><span class="annottext">([(Int64, Tail)] -&gt; Alts) -&gt; [(Int64, Tail)] -&gt; Alts
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Int64] -&gt; [Tail] -&gt; [(Int64, Tail)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Int64, Tail) -&gt; Int64) -&gt; [(Int64, Tail)] -&gt; [Int64]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Int64, Tail) -&gt; Int64
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int64, Tail)]
</span><a href="#local-6989586621680951303"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Int64, Tail) -&gt; Tail) -&gt; [(Int64, Tail)] -&gt; [Tail]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tail -&gt; Tail
</span><a href="#local-6989586621680951302"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Tail -&gt; Tail) -&gt; ((Int64, Tail) -&gt; Tail) -&gt; (Int64, Tail) -&gt; Tail
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Int64, Tail) -&gt; Tail
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Int64, Tail)]
</span><a href="#local-6989586621680951303"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span class="hs-comment">-- dummyLoc :: SrcLoc</span><span>
</span><span id="line-458"></span><span class="hs-comment">-- dummyLoc = (SrcLoc (Loc (Pos &quot;&quot; 0 0 0) (Pos &quot;&quot; 0 0 0)))</span><span>
</span><span id="line-459"></span><span>
</span><span id="line-460"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTriv"><span class="hs-identifier hs-type">codegenTriv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Passes.Codegen.html#VEnv"><span class="hs-identifier hs-type">VEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Triv"><span class="hs-identifier hs-type">Triv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Exp"><span class="hs-identifier hs-type">C.Exp</span></a></span><span>
</span><span id="line-461"></span><span id="codegenTriv"><span class="annot"><span class="annottext">codegenTriv :: VEnv -&gt; Triv -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#codegenTriv"><span class="hs-identifier hs-var hs-var">codegenTriv</span></a></span></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680951335"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680951335"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; SrcLoc -&gt; Exp
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Var"><span class="hs-identifier hs-var">C.Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; SrcLoc -&gt; Id
forall a. ToIdent a =&gt; a -&gt; SrcLoc -&gt; Id
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Quote.Base.html#toIdent"><span class="hs-identifier hs-var">C.toIdent</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680951335"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span>
</span><span id="line-462"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTriv"><span class="hs-identifier hs-var">codegenTriv</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#IntTriv"><span class="hs-identifier hs-type">IntTriv</span></a></span><span> </span><span id="local-6989586621680951337"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621680951337"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cexp| $int:i |]</span></span><span>
</span><span id="line-463"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTriv"><span class="hs-identifier hs-var">codegenTriv</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#CharTriv"><span class="hs-identifier hs-type">CharTriv</span></a></span><span> </span><span id="local-6989586621680951339"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680951339"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cexp| $char:i |]</span></span><span>
</span><span id="line-464"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTriv"><span class="hs-identifier hs-var">codegenTriv</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#FloatTriv"><span class="hs-identifier hs-type">FloatTriv</span></a></span><span> </span><span id="local-6989586621680951342"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680951342"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cexp| $double:i |]</span></span><span>
</span><span id="line-465"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTriv"><span class="hs-identifier hs-var">codegenTriv</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#BoolTriv"><span class="hs-identifier hs-type">BoolTriv</span></a></span><span> </span><span id="local-6989586621680951344"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680951344"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680951344"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-466"></span><span>                               </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="">[cexp| true |]</span></span><span>
</span><span id="line-467"></span><span>                               </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="">[cexp| false |]</span></span><span>
</span><span id="line-468"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTriv"><span class="hs-identifier hs-var">codegenTriv</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#SymTriv"><span class="hs-identifier hs-type">SymTriv</span></a></span><span> </span><span id="local-6989586621680951346"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621680951346"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cexp| $i |]</span></span><span>
</span><span id="line-469"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTriv"><span class="hs-identifier hs-var">codegenTriv</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#TagTriv"><span class="hs-identifier hs-type">TagTriv</span></a></span><span> </span><span id="local-6989586621680951348"><span class="annot"><span class="annottext">Tag
</span><a href="#local-6989586621680951348"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="#local-6989586621680951348"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Tag -&gt; Tag -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Tag
forall a. Num a =&gt; a
</span><a href="Gibbon.Language.Constants.html#indirectionAlt"><span class="hs-identifier hs-var">GL.indirectionAlt</span></a></span><span>
</span><span id="line-470"></span><span>                            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="">[cexp| GIB_INDIRECTION_TAG |]</span></span><span>
</span><span id="line-471"></span><span>                            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="#local-6989586621680951348"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Tag -&gt; Tag -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Tag
forall a. Num a =&gt; a
</span><a href="Gibbon.Language.Constants.html#redirectionAlt"><span class="hs-identifier hs-var">GL.redirectionAlt</span></a></span><span>
</span><span id="line-472"></span><span>                            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="">[cexp| GIB_REDIRECTION_TAG |]</span></span><span>
</span><span id="line-473"></span><span>                            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="">[cexp| $i |]</span></span><span>
</span><span id="line-474"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTriv"><span class="hs-identifier hs-var">codegenTriv</span></a></span><span> </span><span id="local-6989586621680951351"><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680951351"><span class="hs-identifier hs-var">venv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#ProdTriv"><span class="hs-identifier hs-type">ProdTriv</span></a></span><span> </span><span id="local-6989586621680951353"><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680951353"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-475"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680951354"><span class="annot"><span class="annottext">ty :: Type
</span><a href="#local-6989586621680951354"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Type
</span><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">(Ty -&gt; Type) -&gt; Ty -&gt; Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv -&gt; Triv -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#typeOfTriv"><span class="hs-identifier hs-var">typeOfTriv</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680951351"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Triv] -&gt; Triv
</span><a href="Gibbon.L4.Syntax.html#ProdTriv"><span class="hs-identifier hs-var">ProdTriv</span></a></span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680951353"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>      </span><span id="local-6989586621680951356"><span class="annot"><span class="annottext">args :: [(Maybe Designation, Initializer)]
</span><a href="#local-6989586621680951356"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Triv -&gt; (Maybe Designation, Initializer))
-&gt; [Triv] -&gt; [(Maybe Designation, Initializer)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680951357"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680951357"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Designation
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp -&gt; SrcLoc -&gt; Initializer
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#ExpInitializer"><span class="hs-identifier hs-var">C.ExpInitializer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VEnv -&gt; Triv -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#codegenTriv"><span class="hs-identifier hs-var">codegenTriv</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680951351"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680951357"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680951353"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-477"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="">[cexp| $(C.CompoundLit ty args noLoc) |]</span></span><span>
</span><span id="line-478"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTriv"><span class="hs-identifier hs-var">codegenTriv</span></a></span><span> </span><span id="local-6989586621680951359"><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680951359"><span class="hs-identifier hs-var">venv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#ProjTriv"><span class="hs-identifier hs-type">ProjTriv</span></a></span><span> </span><span id="local-6989586621680951361"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680951361"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680951362"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680951362"><span class="hs-identifier hs-var">trv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-479"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680951363"><span class="annot"><span class="annottext">field :: FilePath
</span><a href="#local-6989586621680951363"><span class="hs-identifier hs-var hs-var">field</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;field&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680951361"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-480"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="">[cexp| $(codegenTriv venv trv).$id:field |]</span></span><span>
</span><span id="line-481"></span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span class="hs-comment">-- Type environment</span><span>
</span><span id="line-484"></span><span class="hs-keyword">type</span><span> </span><span id="FEnv"><span class="annot"><a href="Gibbon.Passes.Codegen.html#FEnv"><span class="hs-identifier hs-var">FEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">M.Map</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Syntax.html#Ty"><span class="hs-identifier hs-type">Ty</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Ty"><span class="hs-identifier hs-type">Ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-485"></span><span class="hs-keyword">type</span><span> </span><span id="VEnv"><span class="annot"><a href="Gibbon.Passes.Codegen.html#VEnv"><span class="hs-identifier hs-var">VEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">M.Map</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Ty"><span class="hs-identifier hs-type">Ty</span></a></span><span>
</span><span id="line-486"></span><span class="hs-keyword">type</span><span> </span><span id="SyncDeps"><span class="annot"><a href="Gibbon.Passes.Codegen.html#SyncDeps"><span class="hs-identifier hs-var">SyncDeps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockItem"><span class="hs-identifier hs-type">C.BlockItem</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-487"></span><span>
</span><span id="line-488"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#writeShadowstack"><span class="hs-identifier hs-type">writeShadowstack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>
</span><span id="line-489"></span><span id="writeShadowstack"><span class="annot"><span class="annottext">writeShadowstack :: Var
</span><a href="Gibbon.Passes.Codegen.html#writeShadowstack"><span class="hs-identifier hs-var hs-var">writeShadowstack</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;wstack&quot;</span></span><span>
</span><span id="line-490"></span><span>
</span><span id="line-491"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#readShadowstack"><span class="hs-identifier hs-type">readShadowstack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>
</span><span id="line-492"></span><span id="readShadowstack"><span class="annot"><span class="annottext">readShadowstack :: Var
</span><a href="Gibbon.Passes.Codegen.html#readShadowstack"><span class="hs-identifier hs-var hs-var">readShadowstack</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;rstack&quot;</span></span><span>
</span><span id="line-493"></span><span>
</span><span id="line-494"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#shadowstackFrame"><span class="hs-identifier hs-type">shadowstackFrame</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>
</span><span id="line-495"></span><span id="shadowstackFrame"><span class="annot"><span class="annottext">shadowstackFrame :: Var
</span><a href="Gibbon.Passes.Codegen.html#shadowstackFrame"><span class="hs-identifier hs-var hs-var">shadowstackFrame</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;frame&quot;</span></span><span>
</span><span id="line-496"></span><span>
</span><span id="line-497"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#ssDecls"><span class="hs-identifier hs-type">ssDecls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockItem"><span class="hs-identifier hs-type">C.BlockItem</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-498"></span><span id="ssDecls"><span class="annot"><span class="annottext">ssDecls :: [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#ssDecls"><span class="hs-identifier hs-var hs-var">ssDecls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-499"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:stk_ty *$id:readShadowstack = DEFAULT_READ_SHADOWSTACK; |]</span></span><span>
</span><span id="line-500"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:stk_ty *$id:writeShadowstack = DEFAULT_WRITE_SHADOWSTACK; |]</span></span><span>
</span><span id="line-501"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:frame_ty *$id:shadowstackFrame; |]</span></span><span>
</span><span id="line-502"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-503"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-504"></span><span>    </span><span id="local-6989586621680951372"><span class="annot"><span class="annottext">stk_ty :: Type
</span><a href="#local-6989586621680951372"><span class="hs-identifier hs-var hs-var">stk_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty|typename GibShadowstack|]</span></span><span>
</span><span id="line-505"></span><span>    </span><span id="local-6989586621680951383"><span class="annot"><span class="annottext">frame_ty :: Type
</span><a href="#local-6989586621680951383"><span class="hs-identifier hs-var hs-var">frame_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty|typename GibShadowstackFrame|]</span></span><span>
</span><span id="line-506"></span><span>
</span><span id="line-507"></span><span class="annot"><span class="hs-comment">-- | The central codegen function.</span></span><span>
</span><span id="line-508"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-type">codegenTail</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Passes.Codegen.html#VEnv"><span class="hs-identifier hs-type">VEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.Codegen.html#FEnv"><span class="hs-identifier hs-type">FEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Tail"><span class="hs-identifier hs-type">Tail</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Ty"><span class="hs-identifier hs-type">Ty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.Codegen.html#SyncDeps"><span class="hs-identifier hs-type">SyncDeps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockItem"><span class="hs-identifier hs-type">C.BlockItem</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span id="codegenTail"><span class="annot"><span class="annottext">codegenTail :: VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var hs-var">codegenTail</span></a></span></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="Gibbon.L4.Syntax.html#EndOfMain"><span class="hs-identifier hs-var">EndOfMain</span></a></span><span> </span><span id="local-6989586621680952423"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952423"><span class="hs-identifier hs-var">_ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-511"></span><span class="hs-comment">-- Void type:</span><span>
</span><span id="line-512"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#RetValsT"><span class="hs-identifier hs-type">RetValsT</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span id="local-6989586621680952424"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952424"><span class="hs-identifier hs-var">_ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| return 0; |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-513"></span><span class="hs-comment">-- Single return:</span><span>
</span><span id="line-514"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span id="local-6989586621680952425"><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952425"><span class="hs-identifier hs-var">venv</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#RetValsT"><span class="hs-identifier hs-type">RetValsT</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621680952426"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952426"><span class="hs-identifier hs-var">tr</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span id="local-6989586621680952427"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952427"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-515"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952427"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-516"></span><span>      </span><span class="annot"><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621680952428"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952428"><span class="hs-identifier hs-var">_one</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-517"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680952429"><span class="annot"><span class="annottext">arg :: [(Maybe Designation, Initializer)]
</span><a href="#local-6989586621680952429"><span class="hs-identifier hs-var hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Designation
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp -&gt; SrcLoc -&gt; Initializer
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#ExpInitializer"><span class="hs-identifier hs-var">C.ExpInitializer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VEnv -&gt; Triv -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#codegenTriv"><span class="hs-identifier hs-var">codegenTriv</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952425"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952426"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-518"></span><span>              </span><span id="local-6989586621680952430"><span class="annot"><span class="annottext">ty' :: Type
</span><a href="#local-6989586621680952430"><span class="hs-identifier hs-var hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Type
</span><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952427"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-519"></span><span>          </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| return $(C.CompoundLit ty' arg noLoc); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-520"></span><span>      </span><span class="annot"><span class="annottext">Ty
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| return $(codegenTriv venv tr); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-521"></span><span class="hs-comment">-- Multiple return:</span><span>
</span><span id="line-522"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span id="local-6989586621680952431"><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952431"><span class="hs-identifier hs-var">venv</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#RetValsT"><span class="hs-identifier hs-type">RetValsT</span></a></span><span> </span><span id="local-6989586621680952432"><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952432"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680952433"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952433"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-523"></span><span>    </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| return $(C.CompoundLit ty' args noLoc); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-524"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680952434"><span class="annot"><span class="annottext">args :: [(Maybe Designation, Initializer)]
</span><a href="#local-6989586621680952434"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Triv -&gt; (Maybe Designation, Initializer))
-&gt; [Triv] -&gt; [(Maybe Designation, Initializer)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680952436"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952436"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Designation
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp -&gt; SrcLoc -&gt; Initializer
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#ExpInitializer"><span class="hs-identifier hs-var">C.ExpInitializer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VEnv -&gt; Triv -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#codegenTriv"><span class="hs-identifier hs-var">codegenTriv</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952431"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952436"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952432"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-525"></span><span>          </span><span id="local-6989586621680952435"><span class="annot"><span class="annottext">ty' :: Type
</span><a href="#local-6989586621680952435"><span class="hs-identifier hs-var hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Type
</span><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952433"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-526"></span><span>
</span><span id="line-527"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span id="local-6989586621680952437"><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952437"><span class="hs-identifier hs-var">venv</span></a></span></span><span> </span><span id="local-6989586621680952438"><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952438"><span class="hs-identifier hs-var">fenv</span></a></span></span><span> </span><span id="local-6989586621680952439"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952439"><span class="hs-identifier hs-var">sort_fns</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#AssnValsT"><span class="hs-identifier hs-type">AssnValsT</span></a></span><span> </span><span id="local-6989586621680952440"><span class="annot"><span class="annottext">[(Var, Ty, Triv)]
</span><a href="#local-6989586621680952440"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621680952441"><span class="annot"><span class="annottext">Maybe Tail
</span><a href="#local-6989586621680952441"><span class="hs-identifier hs-var">bod_maybe</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680952442"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952442"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680952443"><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952443"><span class="hs-identifier hs-var">sync_deps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-528"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Tail
</span><a href="#local-6989586621680952441"><span class="hs-identifier hs-var">bod_maybe</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-529"></span><span>      </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680952444"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952444"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-530"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680952445"><span class="annot"><span class="annottext">venv' :: VEnv
</span><a href="#local-6989586621680952445"><span class="hs-identifier hs-var hs-var">venv'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, Ty)] -&gt; VEnv
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(Var, Ty)] -&gt; VEnv) -&gt; [(Var, Ty)] -&gt; VEnv
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((Var, Ty, Triv) -&gt; (Var, Ty)) -&gt; [(Var, Ty, Triv)] -&gt; [(Var, Ty)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680952446"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952446"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952447"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952447"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Triv
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952446"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952447"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty, Triv)]
</span><a href="#local-6989586621680952440"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span>                    </span><span class="annot"><span class="annottext">VEnv -&gt; VEnv -&gt; VEnv
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952437"><span class="hs-identifier hs-var">venv</span></a></span><span>
</span><span id="line-532"></span><span>        </span><span id="local-6989586621680952449"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952449"><span class="hs-identifier hs-var">bod'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952445"><span class="hs-identifier hs-var">venv'</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952438"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952439"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952444"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952442"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952443"><span class="hs-identifier hs-var">sync_deps</span></a></span><span>
</span><span id="line-533"></span><span>        </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Var -&gt; Exp -&gt; BlockItem
forall v e. (ToIdent v, ToExp e) =&gt; Type -&gt; v -&gt; e -&gt; BlockItem
</span><a href="Gibbon.Passes.Codegen.html#mut"><span class="hs-identifier hs-var">mut</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty -&gt; Type
</span><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952451"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952452"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VEnv -&gt; Triv -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#codegenTriv"><span class="hs-identifier hs-var">codegenTriv</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952437"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952453"><span class="hs-identifier hs-var">triv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680952452"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952452"><span class="hs-identifier hs-var">vr</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952451"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952451"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952453"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952453"><span class="hs-identifier hs-var">triv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty, Triv)]
</span><a href="#local-6989586621680952440"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952449"><span class="hs-identifier hs-var">bod'</span></a></span><span>
</span><span id="line-534"></span><span>      </span><span class="annot"><span class="annottext">Maybe Tail
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-535"></span><span>        </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Var -&gt; Exp -&gt; BlockItem
forall v e. (ToIdent v, ToExp e) =&gt; Type -&gt; v -&gt; e -&gt; BlockItem
</span><a href="Gibbon.Passes.Codegen.html#mut"><span class="hs-identifier hs-var">mut</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty -&gt; Type
</span><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952454"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952455"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VEnv -&gt; Triv -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#codegenTriv"><span class="hs-identifier hs-var">codegenTriv</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952437"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952456"><span class="hs-identifier hs-var">triv</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680952455"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952455"><span class="hs-identifier hs-var">vr</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952454"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952454"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952456"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952456"><span class="hs-identifier hs-var">triv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty, Triv)]
</span><a href="#local-6989586621680952440"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-536"></span><span>
</span><span id="line-537"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span id="local-6989586621680952457"><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952457"><span class="hs-identifier hs-var">venv</span></a></span></span><span> </span><span id="local-6989586621680952458"><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952458"><span class="hs-identifier hs-var">fenv</span></a></span></span><span> </span><span id="local-6989586621680952459"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952459"><span class="hs-identifier hs-var">sort_fns</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#Switch"><span class="hs-identifier hs-type">Switch</span></a></span><span> </span><span id="local-6989586621680952460"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952460"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span id="local-6989586621680952461"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952461"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621680952462"><span class="annot"><span class="annottext">Alts
</span><a href="#local-6989586621680952462"><span class="hs-identifier hs-var">alts</span></a></span></span><span> </span><span id="local-6989586621680952463"><span class="annot"><span class="annottext">Maybe Tail
</span><a href="#local-6989586621680952463"><span class="hs-identifier hs-var">def</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680952464"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952464"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680952465"><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952465"><span class="hs-identifier hs-var">sync_deps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-538"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Tail
</span><a href="#local-6989586621680952463"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-539"></span><span>      </span><span class="annot"><span class="annottext">Maybe Tail
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680952466"><span class="annot"><span class="annottext">Alts
</span><a href="#local-6989586621680952466"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952467"><span class="annot"><span class="annottext">Alts
</span><a href="#local-6989586621680952467"><span class="hs-identifier hs-var">lastone</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Alts -&gt; (Alts, Alts)
</span><a href="Gibbon.Passes.Codegen.html#splitAlts"><span class="hs-identifier hs-var">splitAlts</span></a></span><span> </span><span class="annot"><span class="annottext">Alts
</span><a href="#local-6989586621680952462"><span class="hs-identifier hs-var">alts</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-540"></span><span>                  </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Var
-&gt; Triv
-&gt; Alts
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#genSwitch"><span class="hs-identifier hs-var">genSwitch</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952457"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952458"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952459"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952460"><span class="hs-identifier hs-var">lbl</span></a></span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952461"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">Alts
</span><a href="#local-6989586621680952466"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Alts -&gt; Tail
</span><a href="Gibbon.Passes.Codegen.html#altTail"><span class="hs-identifier hs-var">altTail</span></a></span><span> </span><span class="annot"><span class="annottext">Alts
</span><a href="#local-6989586621680952467"><span class="hs-identifier hs-var">lastone</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952464"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952465"><span class="hs-identifier hs-var">sync_deps</span></a></span><span>
</span><span id="line-541"></span><span>      </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680952471"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952471"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Var
-&gt; Triv
-&gt; Alts
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#genSwitch"><span class="hs-identifier hs-var">genSwitch</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952457"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952458"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952459"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952460"><span class="hs-identifier hs-var">lbl</span></a></span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952461"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">Alts
</span><a href="#local-6989586621680952462"><span class="hs-identifier hs-var">alts</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952471"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952464"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952465"><span class="hs-identifier hs-var">sync_deps</span></a></span><span>
</span><span id="line-542"></span><span>
</span><span id="line-543"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span id="local-6989586621680952472"><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952472"><span class="hs-identifier hs-var">venv</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#TailCall"><span class="hs-identifier hs-type">TailCall</span></a></span><span> </span><span id="local-6989586621680952473"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952473"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680952474"><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952474"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680952475"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952475"><span class="hs-identifier hs-var">_ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-544"></span><span>    </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| return $( C.FnCall (cid v) (map (codegenTriv venv) ts) noLoc ); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-545"></span><span>
</span><span id="line-546"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span id="local-6989586621680952477"><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952477"><span class="hs-identifier hs-var">venv</span></a></span></span><span> </span><span id="local-6989586621680952478"><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952478"><span class="hs-identifier hs-var">fenv</span></a></span></span><span> </span><span id="local-6989586621680952479"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952479"><span class="hs-identifier hs-var">sort_fns</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#IfT"><span class="hs-identifier hs-type">IfT</span></a></span><span> </span><span id="local-6989586621680952480"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952480"><span class="hs-identifier hs-var">e0</span></a></span></span><span> </span><span id="local-6989586621680952481"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952481"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680952482"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952482"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680952483"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952483"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680952484"><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952484"><span class="hs-identifier hs-var">sync_deps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-547"></span><span>    </span><span id="local-6989586621680952485"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952485"><span class="hs-identifier hs-var">e1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952477"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952478"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952479"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952481"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952483"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952484"><span class="hs-identifier hs-var">sync_deps</span></a></span><span>
</span><span id="line-548"></span><span>    </span><span id="local-6989586621680952486"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952486"><span class="hs-identifier hs-var">e2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952477"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952478"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952479"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952482"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952483"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952484"><span class="hs-identifier hs-var">sync_deps</span></a></span><span>
</span><span id="line-549"></span><span>    </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| if ($(codegenTriv venv e0)) { $items:e1' } else { $items:e2' } |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-550"></span><span>
</span><span id="line-551"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#ErrT"><span class="hs-identifier hs-type">ErrT</span></a></span><span> </span><span id="local-6989586621680952487"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680952487"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680952488"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952488"><span class="hs-identifier hs-var">_ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| printf(&quot;%s\n&quot;, $s); |]</span></span><span>
</span><span id="line-552"></span><span>                                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| exit(1); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-553"></span><span>
</span><span id="line-554"></span><span>
</span><span id="line-555"></span><span class="hs-comment">-- We could eliminate these earlier</span><span>
</span><span id="line-556"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span id="local-6989586621680952489"><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952489"><span class="hs-identifier hs-var">venv</span></a></span></span><span> </span><span id="local-6989586621680952490"><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952490"><span class="hs-identifier hs-var">fenv</span></a></span></span><span> </span><span id="local-6989586621680952491"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952491"><span class="hs-identifier hs-var">sort_fns</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetTrivT"><span class="hs-identifier hs-type">LetTrivT</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680952492"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952492"><span class="hs-identifier hs-var">vr</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952493"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952493"><span class="hs-identifier hs-var">rty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952494"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952494"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680952495"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952495"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680952496"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952496"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680952497"><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952497"><span class="hs-identifier hs-var">sync_deps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-557"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680952498"><span class="annot"><span class="annottext">venv' :: VEnv
</span><a href="#local-6989586621680952498"><span class="hs-identifier hs-var hs-var">venv'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Ty -&gt; VEnv -&gt; VEnv
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952492"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952493"><span class="hs-identifier hs-var">rty</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952489"><span class="hs-identifier hs-var">venv</span></a></span><span>
</span><span id="line-558"></span><span>       </span><span id="local-6989586621680952499"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952499"><span class="hs-identifier hs-var">tal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952498"><span class="hs-identifier hs-var">venv'</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952490"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952491"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952495"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952496"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952497"><span class="hs-identifier hs-var">sync_deps</span></a></span><span>
</span><span id="line-559"></span><span>       </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy rty) $id:vr = ($ty:(codegenTy rty)) $(codegenTriv venv rhs); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-560"></span><span>                </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952499"><span class="hs-identifier hs-var">tal</span></a></span><span>
</span><span id="line-561"></span><span>
</span><span id="line-562"></span><span class="hs-comment">-- TODO: extend rts with arena primitives, and invoke them here</span><span>
</span><span id="line-563"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span id="local-6989586621680952505"><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952505"><span class="hs-identifier hs-var">venv</span></a></span></span><span> </span><span id="local-6989586621680952506"><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952506"><span class="hs-identifier hs-var">fenv</span></a></span></span><span> </span><span id="local-6989586621680952507"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952507"><span class="hs-identifier hs-var">sort_fns</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetArenaT"><span class="hs-identifier hs-type">LetArenaT</span></a></span><span> </span><span id="local-6989586621680952508"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952508"><span class="hs-identifier hs-var">vr</span></a></span></span><span> </span><span id="local-6989586621680952509"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952509"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680952510"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952510"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680952511"><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952511"><span class="hs-identifier hs-var">sync_deps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-564"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680952512"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952512"><span class="hs-identifier hs-var">tal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952505"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952506"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952507"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952509"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952510"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952511"><span class="hs-identifier hs-var">sync_deps</span></a></span><span>
</span><span id="line-565"></span><span>       </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy ArenaTy) $id:vr = gib_alloc_arena();|]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-566"></span><span>              </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952512"><span class="hs-identifier hs-var">tal</span></a></span><span>
</span><span id="line-567"></span><span>
</span><span id="line-568"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span id="local-6989586621680952518"><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952518"><span class="hs-identifier hs-var">venv</span></a></span></span><span> </span><span id="local-6989586621680952519"><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952519"><span class="hs-identifier hs-var">fenv</span></a></span></span><span> </span><span id="local-6989586621680952520"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952520"><span class="hs-identifier hs-var">sort_fns</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetAllocT"><span class="hs-identifier hs-type">LetAllocT</span></a></span><span> </span><span id="local-6989586621680952521"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952521"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span id="local-6989586621680952522"><span class="annot"><span class="annottext">[(Ty, Triv)]
</span><a href="#local-6989586621680952522"><span class="hs-identifier hs-var">vals</span></a></span></span><span> </span><span id="local-6989586621680952523"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952523"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680952524"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952524"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680952525"><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952525"><span class="hs-identifier hs-var">sync_deps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-569"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680952526"><span class="annot"><span class="annottext">structTy :: Type
</span><a href="#local-6989586621680952526"><span class="hs-identifier hs-var hs-var">structTy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Type
</span><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty] -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Ty, Triv) -&gt; Ty) -&gt; [(Ty, Triv)] -&gt; [Ty]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Ty, Triv) -&gt; Ty
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[(Ty, Triv)]
</span><a href="#local-6989586621680952522"><span class="hs-identifier hs-var">vals</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-570"></span><span>           </span><span id="local-6989586621680952527"><span class="annot"><span class="annottext">size :: Exp
</span><a href="#local-6989586621680952527"><span class="hs-identifier hs-var hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cexp| sizeof($ty:structTy) |]</span></span><span>
</span><span id="line-571"></span><span>           </span><span id="local-6989586621680952529"><span class="annot"><span class="annottext">venv' :: VEnv
</span><a href="#local-6989586621680952529"><span class="hs-identifier hs-var hs-var">venv'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Ty -&gt; VEnv -&gt; VEnv
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952521"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952518"><span class="hs-identifier hs-var">venv</span></a></span><span>
</span><span id="line-572"></span><span>       </span><span id="local-6989586621680952531"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952531"><span class="hs-identifier hs-var">tal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952529"><span class="hs-identifier hs-var">venv'</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952519"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952520"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952523"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952524"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952525"><span class="hs-identifier hs-var">sync_deps</span></a></span><span>
</span><span id="line-573"></span><span>       </span><span id="local-6989586621680952532"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680952532"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PassM DynFlags
forall (m :: * -&gt; *). MonadReader Config m =&gt; m DynFlags
</span><a href="Gibbon.Common.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-574"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680952533"><span class="annot"><span class="annottext">alloc :: BlockItem
</span><a href="#local-6989586621680952533"><span class="hs-identifier hs-var hs-var">alloc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_CountParRegions"><span class="hs-identifier hs-var">Opt_CountParRegions</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680952532"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_CountAllRegions"><span class="hs-identifier hs-var">Opt_CountAllRegions</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680952532"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-575"></span><span>                   </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Var -&gt; Exp -&gt; BlockItem
forall v e. (ToIdent v, ToExp e) =&gt; Type -&gt; v -&gt; e -&gt; BlockItem
</span><a href="Gibbon.Passes.Codegen.html#assn"><span class="hs-identifier hs-var">assn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty -&gt; Type
</span><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#PtrTy"><span class="hs-identifier hs-var">PtrTy</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952521"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="">[cexp| gib_alloc_counted_struct( $size ) |]</span></span><span>
</span><span id="line-576"></span><span>                   </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Var -&gt; Exp -&gt; BlockItem
forall v e. (ToIdent v, ToExp e) =&gt; Type -&gt; v -&gt; e -&gt; BlockItem
</span><a href="Gibbon.Passes.Codegen.html#assn"><span class="hs-identifier hs-var">assn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty -&gt; Type
</span><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#PtrTy"><span class="hs-identifier hs-var">PtrTy</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952521"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="annot"><span class="">[cexp| gib_alloc( $size ) |]</span></span><span>
</span><span id="line-577"></span><span>       </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-578"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BlockItem
</span><a href="#local-6989586621680952533"><span class="hs-identifier hs-var">alloc</span></a></span><span> </span><span class="annot"><span class="annottext">BlockItem -&gt; [BlockItem] -&gt; [BlockItem]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span>
</span><span id="line-579"></span><span>               </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| (($ty:structTy *)  $id:lhs)-&gt;$id:fld = $(codegenTriv venv trv); |]</span></span><span>
</span><span id="line-580"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680952546"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680952546"><span class="hs-identifier hs-var">ix</span></a></span></span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621680952547"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952547"><span class="hs-identifier hs-var">_ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952538"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952538"><span class="hs-identifier hs-var">trv</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; [(Ty, Triv)] -&gt; [(Int, (Ty, Triv))]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(Ty, Triv)]
</span><a href="#local-6989586621680952522"><span class="hs-identifier hs-var">vals</span></a></span><span>
</span><span id="line-581"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680952539"><span class="annot"><span class="annottext">fld :: FilePath
</span><a href="#local-6989586621680952539"><span class="hs-identifier hs-var hs-var">fld</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;field&quot;</span></span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">Int -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680952546"><span class="hs-identifier hs-var">ix</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-582"></span><span>                 </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952531"><span class="hs-identifier hs-var">tal</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-583"></span><span>
</span><span id="line-584"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span id="local-6989586621680952548"><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952548"><span class="hs-identifier hs-var">venv</span></a></span></span><span> </span><span id="local-6989586621680952549"><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952549"><span class="hs-identifier hs-var">fenv</span></a></span></span><span> </span><span id="local-6989586621680952550"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952550"><span class="hs-identifier hs-var">sort_fns</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetAvailT"><span class="hs-identifier hs-type">LetAvailT</span></a></span><span> </span><span id="local-6989586621680952551"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680952551"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621680952552"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952552"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680952553"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952553"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680952554"><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952554"><span class="hs-identifier hs-var">sync_deps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-585"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680952555"><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952555"><span class="hs-identifier hs-var">avail</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680952556"><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952556"><span class="hs-identifier hs-var">sync_deps'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Var, BlockItem) -&gt; Bool) -&gt; SyncDeps -&gt; (SyncDeps, SyncDeps)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.OldList.html#partition"><span class="hs-identifier hs-var">L.partition</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680952558"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952558"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">BlockItem
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#elem"><span class="hs-identifier hs-var">elem</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952558"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680952551"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952554"><span class="hs-identifier hs-var">sync_deps</span></a></span><span>
</span><span id="line-586"></span><span>       </span><span id="local-6989586621680952560"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952560"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952548"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952549"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952550"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952552"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952553"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952556"><span class="hs-identifier hs-var">sync_deps'</span></a></span><span>
</span><span id="line-587"></span><span>       </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Var, BlockItem) -&gt; BlockItem) -&gt; SyncDeps -&gt; [BlockItem]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, BlockItem) -&gt; BlockItem
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952555"><span class="hs-identifier hs-var">avail</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952560"><span class="hs-identifier hs-var">tl</span></a></span><span>
</span><span id="line-588"></span><span>
</span><span id="line-589"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span id="local-6989586621680952561"><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952561"><span class="hs-identifier hs-var">venv</span></a></span></span><span> </span><span id="local-6989586621680952562"><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952562"><span class="hs-identifier hs-var">fenv</span></a></span></span><span> </span><span id="local-6989586621680952563"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952563"><span class="hs-identifier hs-var">sort_fns</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetUnpackT"><span class="hs-identifier hs-type">LetUnpackT</span></a></span><span> </span><span id="local-6989586621680952564"><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952564"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span id="local-6989586621680952565"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952565"><span class="hs-identifier hs-var">scrt</span></a></span></span><span> </span><span id="local-6989586621680952566"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952566"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680952567"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952567"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680952568"><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952568"><span class="hs-identifier hs-var">sync_deps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-590"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621680952569"><span class="hs-identifier hs-type">mkFld</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Id"><span class="hs-identifier hs-type">C.Id</span></a></span><span>
</span><span id="line-591"></span><span>           </span><span id="local-6989586621680952569"><span class="annot"><span class="annottext">mkFld :: Int -&gt; Id
</span><a href="#local-6989586621680952569"><span class="hs-identifier hs-var hs-var">mkFld</span></a></span></span><span> </span><span id="local-6989586621680952570"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680952570"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; SrcLoc -&gt; Id
forall a. ToIdent a =&gt; a -&gt; SrcLoc -&gt; Id
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Quote.Base.html#toIdent"><span class="hs-identifier hs-var">C.toIdent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;field&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680952570"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span>
</span><span id="line-592"></span><span>
</span><span id="line-593"></span><span>           </span><span id="local-6989586621680952571"><span class="annot"><span class="annottext">fldTys :: [Ty]
</span><a href="#local-6989586621680952571"><span class="hs-identifier hs-var hs-var">fldTys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Var, Ty) -&gt; Ty) -&gt; [(Var, Ty)] -&gt; [Ty]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty) -&gt; Ty
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952564"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-594"></span><span>           </span><span id="local-6989586621680952572"><span class="annot"><span class="annottext">struct_ty :: Type
</span><a href="#local-6989586621680952572"><span class="hs-identifier hs-var hs-var">struct_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Type
</span><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty] -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680952571"><span class="hs-identifier hs-var">fldTys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span>           </span><span id="local-6989586621680952573"><span class="annot"><span class="annottext">mk_bind :: Int -&gt; (Var, Ty) -&gt; InitGroup
</span><a href="#local-6989586621680952573"><span class="hs-identifier hs-var hs-var">mk_bind</span></a></span></span><span> </span><span id="local-6989586621680952574"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680952574"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680952575"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952575"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680952576"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952576"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cdecl|
             $ty:(codegenTy t) $id:v = ( ( $ty:struct_ty * ) $exp:(cid scrt) )-&gt;$id:(mkFld i);
           |]</span></span><span>
</span><span id="line-599"></span><span>
</span><span id="line-600"></span><span>           </span><span id="local-6989586621680952587"><span class="annot"><span class="annottext">binds :: [InitGroup]
</span><a href="#local-6989586621680952587"><span class="hs-identifier hs-var hs-var">binds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; (Var, Ty) -&gt; InitGroup)
-&gt; [Int] -&gt; [(Var, Ty)] -&gt; [InitGroup]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Var, Ty) -&gt; InitGroup
</span><a href="#local-6989586621680952573"><span class="hs-identifier hs-var">mk_bind</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952564"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-601"></span><span>           </span><span id="local-6989586621680952588"><span class="annot"><span class="annottext">venv' :: VEnv
</span><a href="#local-6989586621680952588"><span class="hs-identifier hs-var hs-var">venv'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, Ty)] -&gt; VEnv
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952564"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VEnv -&gt; VEnv -&gt; VEnv
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952561"><span class="hs-identifier hs-var">venv</span></a></span><span>
</span><span id="line-602"></span><span>
</span><span id="line-603"></span><span>       </span><span id="local-6989586621680952589"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952589"><span class="hs-identifier hs-var">body'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952588"><span class="hs-identifier hs-var">venv'</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952562"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952563"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952566"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952567"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952568"><span class="hs-identifier hs-var">sync_deps</span></a></span><span>
</span><span id="line-604"></span><span>       </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(InitGroup -&gt; BlockItem) -&gt; [InitGroup] -&gt; [BlockItem]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="annottext">[InitGroup]
</span><a href="#local-6989586621680952587"><span class="hs-identifier hs-var">binds</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952589"><span class="hs-identifier hs-var">body'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-605"></span><span>
</span><span id="line-606"></span><span class="hs-comment">-- Here we unzip the tuple into assignments to local variables.</span><span>
</span><span id="line-607"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span id="local-6989586621680952590"><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952590"><span class="hs-identifier hs-var">venv</span></a></span></span><span> </span><span id="local-6989586621680952591"><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952591"><span class="hs-identifier hs-var">fenv</span></a></span></span><span> </span><span id="local-6989586621680952592"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952592"><span class="hs-identifier hs-var">sort_fns</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetIfT"><span class="hs-identifier hs-type">LetIfT</span></a></span><span> </span><span id="local-6989586621680952593"><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952593"><span class="hs-identifier hs-var">bnds</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680952594"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952594"><span class="hs-identifier hs-var">e0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952595"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952595"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952596"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952596"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680952597"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952597"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680952598"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952598"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680952599"><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952599"><span class="hs-identifier hs-var">sync_deps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-608"></span><span>
</span><span id="line-609"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680952600"><span class="annot"><span class="annottext">decls :: [BlockItem]
</span><a href="#local-6989586621680952600"><span class="hs-identifier hs-var hs-var">decls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy ty0) $id:vr0; |]</span></span><span>
</span><span id="line-610"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680952601"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952601"><span class="hs-identifier hs-var">vr0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952602"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952602"><span class="hs-identifier hs-var">ty0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952593"><span class="hs-identifier hs-var">bnds</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-611"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680952608"><span class="annot"><span class="annottext">e1' :: Tail
</span><a href="#local-6989586621680952608"><span class="hs-identifier hs-var hs-var">e1'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tail -&gt; [(Var, Ty)] -&gt; Tail
</span><a href="Gibbon.Passes.Codegen.html#rewriteReturns"><span class="hs-identifier hs-var">rewriteReturns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952595"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952593"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-612"></span><span>           </span><span id="local-6989586621680952609"><span class="annot"><span class="annottext">e2' :: Tail
</span><a href="#local-6989586621680952609"><span class="hs-identifier hs-var hs-var">e2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tail -&gt; [(Var, Ty)] -&gt; Tail
</span><a href="Gibbon.Passes.Codegen.html#rewriteReturns"><span class="hs-identifier hs-var">rewriteReturns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952596"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952593"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-613"></span><span>
</span><span id="line-614"></span><span>           </span><span id="local-6989586621680952610"><span class="annot"><span class="annottext">venv' :: VEnv
</span><a href="#local-6989586621680952610"><span class="hs-identifier hs-var hs-var">venv'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, Ty)] -&gt; VEnv
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952593"><span class="hs-identifier hs-var">bnds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VEnv -&gt; VEnv -&gt; VEnv
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952590"><span class="hs-identifier hs-var">venv</span></a></span><span>
</span><span id="line-615"></span><span>
</span><span id="line-616"></span><span>       </span><span id="local-6989586621680952611"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952611"><span class="hs-identifier hs-var">e1''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952610"><span class="hs-identifier hs-var">venv'</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952591"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952592"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952608"><span class="hs-identifier hs-var">e1'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952598"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952599"><span class="hs-identifier hs-var">sync_deps</span></a></span><span>
</span><span id="line-617"></span><span>       </span><span id="local-6989586621680952612"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952612"><span class="hs-identifier hs-var">e2''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952610"><span class="hs-identifier hs-var">venv'</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952591"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952592"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952609"><span class="hs-identifier hs-var">e2'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952598"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952599"><span class="hs-identifier hs-var">sync_deps</span></a></span><span>
</span><span id="line-618"></span><span>       </span><span class="hs-comment">-- Int 1 is Boolean true:</span><span>
</span><span id="line-619"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680952613"><span class="annot"><span class="annottext">ifbod :: [BlockItem]
</span><a href="#local-6989586621680952613"><span class="hs-identifier hs-var hs-var">ifbod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| if ($(codegenTriv venv e0)) { $items:e1'' } else { $items:e2'' } |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-620"></span><span>       </span><span id="local-6989586621680952614"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952614"><span class="hs-identifier hs-var">tal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952610"><span class="hs-identifier hs-var">venv'</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952591"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952592"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952597"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952598"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952599"><span class="hs-identifier hs-var">sync_deps</span></a></span><span>
</span><span id="line-621"></span><span>       </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952600"><span class="hs-identifier hs-var">decls</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952613"><span class="hs-identifier hs-var">ifbod</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952614"><span class="hs-identifier hs-var">tal</span></a></span><span>
</span><span id="line-622"></span><span>
</span><span id="line-623"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span id="local-6989586621680952615"><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952615"><span class="hs-identifier hs-var">venv</span></a></span></span><span> </span><span id="local-6989586621680952616"><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952616"><span class="hs-identifier hs-var">fenv</span></a></span></span><span> </span><span id="local-6989586621680952617"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952617"><span class="hs-identifier hs-var">sort_fns</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetTimedT"><span class="hs-identifier hs-type">LetTimedT</span></a></span><span> </span><span id="local-6989586621680952618"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680952618"><span class="hs-identifier hs-var">flg</span></a></span></span><span> </span><span id="local-6989586621680952619"><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952619"><span class="hs-identifier hs-var">bnds</span></a></span></span><span> </span><span id="local-6989586621680952620"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952620"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span id="local-6989586621680952621"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952621"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680952622"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952622"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680952623"><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952623"><span class="hs-identifier hs-var">sync_deps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-624"></span><span>
</span><span id="line-625"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680952624"><span class="annot"><span class="annottext">decls :: [BlockItem]
</span><a href="#local-6989586621680952624"><span class="hs-identifier hs-var hs-var">decls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy ty0) $id:vr0; |]</span></span><span>
</span><span id="line-626"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680952625"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952625"><span class="hs-identifier hs-var">vr0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952626"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952626"><span class="hs-identifier hs-var">ty0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952619"><span class="hs-identifier hs-var">bnds</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-627"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680952632"><span class="annot"><span class="annottext">rhs' :: Tail
</span><a href="#local-6989586621680952632"><span class="hs-identifier hs-var hs-var">rhs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tail -&gt; [(Var, Ty)] -&gt; Tail
</span><a href="Gibbon.Passes.Codegen.html#rewriteReturns"><span class="hs-identifier hs-var">rewriteReturns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952620"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952619"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-628"></span><span>       </span><span id="local-6989586621680952633"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952633"><span class="hs-identifier hs-var">rhs''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952615"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952616"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952617"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952632"><span class="hs-identifier hs-var">rhs'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952622"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952623"><span class="hs-identifier hs-var">sync_deps</span></a></span><span>
</span><span id="line-629"></span><span>       </span><span id="local-6989586621680952634"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952634"><span class="hs-identifier hs-var">itertime</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;itertime&quot;</span></span><span>
</span><span id="line-630"></span><span>       </span><span id="local-6989586621680952635"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952635"><span class="hs-identifier hs-var">batchtime</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;batchtime&quot;</span></span><span>
</span><span id="line-631"></span><span>       </span><span id="local-6989586621680952636"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952636"><span class="hs-identifier hs-var">selftimed</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;selftimed&quot;</span></span><span>
</span><span id="line-632"></span><span>       </span><span id="local-6989586621680952637"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952637"><span class="hs-identifier hs-var">times</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;times&quot;</span></span><span>
</span><span id="line-633"></span><span>       </span><span id="local-6989586621680952638"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952638"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;tmp&quot;</span></span><span>
</span><span id="line-634"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680952639"><span class="annot"><span class="annottext">ident :: Var
</span><a href="#local-6989586621680952639"><span class="hs-identifier hs-var hs-var">ident</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952619"><span class="hs-identifier hs-var">bnds</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-635"></span><span>                     </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621680952640"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952640"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952640"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-636"></span><span>                     </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-637"></span><span>           </span><span id="local-6989586621680952641"><span class="annot"><span class="annottext">begn :: FilePath
</span><a href="#local-6989586621680952641"><span class="hs-identifier hs-var hs-var">begn</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;begin_&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; FilePath
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952639"><span class="hs-identifier hs-var">ident</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-638"></span><span>           </span><span id="local-6989586621680952642"><span class="annot"><span class="annottext">end :: FilePath
</span><a href="#local-6989586621680952642"><span class="hs-identifier hs-var hs-var">end</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;end_&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; FilePath
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952639"><span class="hs-identifier hs-var">ident</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-639"></span><span>           </span><span id="local-6989586621680952643"><span class="annot"><span class="annottext">iters :: FilePath
</span><a href="#local-6989586621680952643"><span class="hs-identifier hs-var hs-var">iters</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;iters_&quot;</span></span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; FilePath
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952639"><span class="hs-identifier hs-var">ident</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span>           </span><span id="local-6989586621680952644"><span class="annot"><span class="annottext">vec_ty :: Type
</span><a href="#local-6989586621680952644"><span class="hs-identifier hs-var hs-var">vec_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Type
</span><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#VectorTy"><span class="hs-identifier hs-var">VectorTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#FloatTy"><span class="hs-identifier hs-var">FloatTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-641"></span><span>
</span><span id="line-642"></span><span>           </span><span id="local-6989586621680952646"><span class="annot"><span class="annottext">timebod :: [BlockItem]
</span><a href="#local-6989586621680952646"><span class="hs-identifier hs-var hs-var">timebod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:vec_ty ($id:times) = gib_vector_alloc(gib_get_iters_param(), sizeof(double)); |]</span></span><span>
</span><span id="line-643"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| struct timespec $id:begn; |]</span></span><span>
</span><span id="line-644"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| struct timespec $id:end; |]</span></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-645"></span><span>
</span><span id="line-646"></span><span>                     </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680952618"><span class="hs-identifier hs-var">flg</span></a></span><span>
</span><span id="line-647"></span><span>                         </span><span class="hs-comment">-- Save and restore EXCEPT on the last iteration.  This &quot;cancels out&quot; the effect of intermediate allocations.</span><span>
</span><span id="line-648"></span><span>                      </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680952653"><span class="annot"><span class="annottext">body :: [BlockItem]
</span><a href="#local-6989586621680952653"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| if ( $id:iters != gib_get_iters_param()-1) {
                                                         gib_list_bumpalloc_save_state();
                                                         gib_ptr_bumpalloc_save_state();
                                                         } |]</span></span><span>
</span><span id="line-652"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| clock_gettime(CLOCK_MONOTONIC_RAW, &amp; $id:begn );  |]</span></span><span>
</span><span id="line-653"></span><span>                                       </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-654"></span><span>                                       </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952633"><span class="hs-identifier hs-var">rhs''</span></a></span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-655"></span><span>                                       </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| clock_gettime(CLOCK_MONOTONIC_RAW, &amp;$(cid (toVar end))); |]</span></span><span>
</span><span id="line-656"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| if ( $id:iters != gib_get_iters_param()-1) {
                                                         gib_list_bumpalloc_restore_state();
                                                         gib_ptr_bumpalloc_restore_state();
                                                         } |]</span></span><span>
</span><span id="line-660"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| double $id:itertime = gib_difftimespecs(&amp;$(cid (toVar begn)), &amp;$(cid (toVar end))); |]</span></span><span>
</span><span id="line-661"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| printf(&quot;itertime: %lf\n&quot;, $id:itertime); |]</span></span><span>
</span><span id="line-662"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| gib_vector_inplace_update($id:times, $id:iters, &amp;($id:itertime)); |]</span></span><span>
</span><span id="line-663"></span><span>                                       </span><span class="hs-special">]</span><span>
</span><span id="line-664"></span><span>                            </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| for (long long $id:iters = 0; $id:iters &lt; gib_get_iters_param(); $id:iters ++) { $items:body } |]</span></span><span>
</span><span id="line-665"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| gib_vector_inplace_sort($id:times, gib_compare_doubles); |]</span></span><span>
</span><span id="line-666"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| double *$id:tmp = (double*) gib_vector_nth($id:times, (gib_get_iters_param() / 2)); |]</span></span><span>
</span><span id="line-667"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| double $id:selftimed = *($id:tmp); |]</span></span><span>
</span><span id="line-668"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| double $id:batchtime = gib_sum_timing_array($id:times); |]</span></span><span>
</span><span id="line-669"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| gib_print_timing_array($id:times); |]</span></span><span>
</span><span id="line-670"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| gib_vector_free($id:times); |]</span></span><span>
</span><span id="line-671"></span><span>                               </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-672"></span><span>
</span><span id="line-673"></span><span>                         </span><span class="hs-comment">-- else</span><span>
</span><span id="line-674"></span><span>                      </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| clock_gettime(CLOCK_MONOTONIC_RAW, &amp; $id:begn );  |]</span></span><span>
</span><span id="line-675"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| { $items:rhs'' } |]</span></span><span>
</span><span id="line-676"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| clock_gettime(CLOCK_MONOTONIC_RAW, &amp;$(cid (toVar end))); |]</span></span><span>
</span><span id="line-677"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| double $id:selftimed = gib_difftimespecs(&amp;$(cid (toVar begn)), &amp;$(cid (toVar end))); |]</span></span><span>
</span><span id="line-678"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| gib_vector_free($id:times); |]</span></span><span>
</span><span id="line-679"></span><span>                           </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-680"></span><span>           </span><span id="local-6989586621680952661"><span class="annot"><span class="annottext">withPrnt :: [BlockItem]
</span><a href="#local-6989586621680952661"><span class="hs-identifier hs-var hs-var">withPrnt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952646"><span class="hs-identifier hs-var">timebod</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-681"></span><span>                      </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680952618"><span class="hs-identifier hs-var">flg</span></a></span><span>
</span><span id="line-682"></span><span>                       </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| printf(&quot;ITERS: %ld\n&quot;, gib_get_iters_param()); |]</span></span><span>
</span><span id="line-683"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| printf(&quot;SIZE: %ld\n&quot;, gib_get_size_param()); |]</span></span><span>
</span><span id="line-684"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| printf(&quot;BATCHTIME: %e\n&quot;, $id:batchtime); |]</span></span><span>
</span><span id="line-685"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| printf(&quot;SELFTIMED: %e\n&quot;, $id:selftimed); |]</span></span><span>
</span><span id="line-686"></span><span>                            </span><span class="hs-special">]</span><span>
</span><span id="line-687"></span><span>                       </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| printf(&quot;SIZE: %ld\n&quot;, gib_get_size_param()); |]</span></span><span>
</span><span id="line-688"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| printf(&quot;SELFTIMED: %e\n&quot;, gib_difftimespecs(&amp;$(cid (toVar begn)), &amp;$(cid (toVar end)))); |]</span></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-689"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680952662"><span class="annot"><span class="annottext">venv' :: VEnv
</span><a href="#local-6989586621680952662"><span class="hs-identifier hs-var hs-var">venv'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, Ty)] -&gt; VEnv
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952619"><span class="hs-identifier hs-var">bnds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VEnv -&gt; VEnv -&gt; VEnv
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952615"><span class="hs-identifier hs-var">venv</span></a></span><span>
</span><span id="line-690"></span><span>       </span><span id="local-6989586621680952663"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952663"><span class="hs-identifier hs-var">tal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952662"><span class="hs-identifier hs-var">venv'</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952616"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952617"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952621"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952622"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952623"><span class="hs-identifier hs-var">sync_deps</span></a></span><span>
</span><span id="line-691"></span><span>       </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952624"><span class="hs-identifier hs-var">decls</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952661"><span class="hs-identifier hs-var">withPrnt</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952663"><span class="hs-identifier hs-var">tal</span></a></span><span>
</span><span id="line-692"></span><span>
</span><span id="line-693"></span><span>
</span><span id="line-694"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span id="local-6989586621680952664"><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952664"><span class="hs-identifier hs-var">venv</span></a></span></span><span> </span><span id="local-6989586621680952665"><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952665"><span class="hs-identifier hs-var">fenv</span></a></span></span><span> </span><span id="local-6989586621680952666"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952666"><span class="hs-identifier hs-var">sort_fns</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetCallT"><span class="hs-identifier hs-type">LetCallT</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span id="local-6989586621680952667"><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952667"><span class="hs-identifier hs-var">bnds</span></a></span></span><span> </span><span id="local-6989586621680952668"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952668"><span class="hs-identifier hs-var">ratr</span></a></span></span><span> </span><span id="local-6989586621680952669"><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952669"><span class="hs-identifier hs-var">rnds</span></a></span></span><span> </span><span id="local-6989586621680952670"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952670"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680952671"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952671"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680952672"><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952672"><span class="hs-identifier hs-var">sync_deps</span></a></span></span><span>
</span><span id="line-695"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952667"><span class="hs-identifier hs-var">bnds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680952673"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952673"><span class="hs-identifier hs-var">tal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952664"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952665"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952666"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952670"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952671"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952672"><span class="hs-identifier hs-var">sync_deps</span></a></span><span>
</span><span id="line-696"></span><span>                      </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp -&gt; BlockItem
</span><a href="Gibbon.Passes.Codegen.html#toStmt"><span class="hs-identifier hs-var">toStmt</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680952675"><span class="hs-identifier hs-var">fnexp</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952673"><span class="hs-identifier hs-var">tal</span></a></span><span>
</span><span id="line-697"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span id="local-6989586621680952676"><span class="annot"><span class="annottext">(Var, Ty)
</span><a href="#local-6989586621680952676"><span class="hs-identifier hs-var">bnd</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952667"><span class="hs-identifier hs-var">bnds</span></a></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680952677"><span class="annot"><span class="annottext">fn_ret_ty :: Ty
</span><a href="#local-6989586621680952677"><span class="hs-identifier hs-var hs-var">fn_ret_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Ty], Ty) -&gt; Ty
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952665"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty) -&gt; Var -&gt; ([Ty], Ty)
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#%21"><span class="hs-operator hs-var">M.!</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952668"><span class="hs-identifier hs-var">ratr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-698"></span><span>                           </span><span id="local-6989586621680952679"><span class="annot"><span class="annottext">venv' :: VEnv
</span><a href="#local-6989586621680952679"><span class="hs-identifier hs-var hs-var">venv'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, Ty)] -&gt; VEnv
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952667"><span class="hs-identifier hs-var">bnds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VEnv -&gt; VEnv -&gt; VEnv
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952664"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-699"></span><span>                       </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952677"><span class="hs-identifier hs-var">fn_ret_ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-700"></span><span>                         </span><span class="hs-comment">-- Copied from the otherwise case below.</span><span>
</span><span id="line-701"></span><span>                         </span><span class="annot"><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621680952680"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952680"><span class="hs-identifier hs-var">_one</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-702"></span><span>                           </span><span id="local-6989586621680952681"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952681"><span class="hs-identifier hs-var">nam</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">(Var -&gt; PassM Var) -&gt; Var -&gt; PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;tmp_struct&quot;</span></span><span>
</span><span id="line-703"></span><span>                           </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680952682"><span class="annot"><span class="annottext">bind :: (Var, Ty) -&gt; FilePath -&gt; BlockItem
</span><a href="#local-6989586621680952682"><span class="hs-identifier hs-var hs-var">bind</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680952683"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952683"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952684"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952684"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680952685"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680952685"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Var -&gt; Exp -&gt; BlockItem
forall v e. (ToIdent v, ToExp e) =&gt; Type -&gt; v -&gt; e -&gt; BlockItem
</span><a href="Gibbon.Passes.Codegen.html#assn"><span class="hs-identifier hs-var">assn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty -&gt; Type
</span><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952684"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952683"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Id -&gt; SrcLoc -&gt; Exp
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Member"><span class="hs-identifier hs-var">C.Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#cid"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952681"><span class="hs-identifier hs-var">nam</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; SrcLoc -&gt; Id
forall a. ToIdent a =&gt; a -&gt; SrcLoc -&gt; Id
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Quote.Base.html#toIdent"><span class="hs-identifier hs-var">C.toIdent</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680952685"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-704"></span><span>                               </span><span id="local-6989586621680952686"><span class="annot"><span class="annottext">fields :: [FilePath]
</span><a href="#local-6989586621680952686"><span class="hs-identifier hs-var hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; FilePath) -&gt; [Int] -&gt; [FilePath]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680952687"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680952687"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;field&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680952687"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952667"><span class="hs-identifier hs-var">bnds</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-705"></span><span>                               </span><span id="local-6989586621680952688"><span class="annot"><span class="annottext">ty0 :: Ty
</span><a href="#local-6989586621680952688"><span class="hs-identifier hs-var hs-var">ty0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="annot"><span class="annottext">([Ty] -&gt; Ty) -&gt; [Ty] -&gt; Ty
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((Var, Ty) -&gt; Ty) -&gt; [(Var, Ty)] -&gt; [Ty]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty) -&gt; Ty
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952667"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-706"></span><span>                               </span><span id="local-6989586621680952689"><span class="annot"><span class="annottext">init :: [BlockItem]
</span><a href="#local-6989586621680952689"><span class="hs-identifier hs-var hs-var">init</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy ty0) $id:nam = $(fnexp); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-707"></span><span>                           </span><span id="local-6989586621680952695"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952695"><span class="hs-identifier hs-var">tal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952679"><span class="hs-identifier hs-var">venv'</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952665"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952666"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952670"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952671"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952672"><span class="hs-identifier hs-var">sync_deps</span></a></span><span>
</span><span id="line-708"></span><span>                           </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952689"><span class="hs-identifier hs-var">init</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">((Var, Ty) -&gt; FilePath -&gt; BlockItem)
-&gt; [(Var, Ty)] -&gt; [FilePath] -&gt; [BlockItem]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty) -&gt; FilePath -&gt; BlockItem
</span><a href="#local-6989586621680952682"><span class="hs-identifier hs-var">bind</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952667"><span class="hs-identifier hs-var">bnds</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621680952686"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952695"><span class="hs-identifier hs-var">tal</span></a></span><span>
</span><span id="line-709"></span><span>                         </span><span class="annot"><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-710"></span><span>                           </span><span class="hs-comment">-- nam &lt;- gensym &quot;tmp&quot;</span><span>
</span><span id="line-711"></span><span>                           </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680952696"><span class="annot"><span class="annottext">init :: [BlockItem]
</span><a href="#local-6989586621680952696"><span class="hs-identifier hs-var hs-var">init</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy fn_ret_ty) $id:(fst bnd) = $(fnexp); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-712"></span><span>                           </span><span id="local-6989586621680952702"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952702"><span class="hs-identifier hs-var">tal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952679"><span class="hs-identifier hs-var">venv'</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952665"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952666"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952670"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952671"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952672"><span class="hs-identifier hs-var">sync_deps</span></a></span><span>
</span><span id="line-713"></span><span>                           </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952696"><span class="hs-identifier hs-var">init</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952702"><span class="hs-identifier hs-var">tal</span></a></span><span>
</span><span id="line-714"></span><span>                         </span><span class="annot"><span class="annottext">Ty
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-715"></span><span>                           </span><span id="local-6989586621680952703"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952703"><span class="hs-identifier hs-var">tal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952679"><span class="hs-identifier hs-var">venv'</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952665"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952666"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952670"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952671"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952672"><span class="hs-identifier hs-var">sync_deps</span></a></span><span>
</span><span id="line-716"></span><span>                           </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680952704"><span class="annot"><span class="annottext">call :: BlockItem
</span><a href="#local-6989586621680952704"><span class="hs-identifier hs-var hs-var">call</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Var -&gt; Exp -&gt; BlockItem
forall v e. (ToIdent v, ToExp e) =&gt; Type -&gt; v -&gt; e -&gt; BlockItem
</span><a href="Gibbon.Passes.Codegen.html#assn"><span class="hs-identifier hs-var">assn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty -&gt; Type
</span><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, Ty) -&gt; Ty
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty)
</span><a href="#local-6989586621680952676"><span class="hs-identifier hs-var">bnd</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, Ty) -&gt; Var
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty)
</span><a href="#local-6989586621680952676"><span class="hs-identifier hs-var">bnd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680952675"><span class="hs-identifier hs-var">fnexp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-717"></span><span>                           </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">BlockItem
</span><a href="#local-6989586621680952704"><span class="hs-identifier hs-var">call</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952703"><span class="hs-identifier hs-var">tal</span></a></span><span>
</span><span id="line-718"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-719"></span><span>       </span><span id="local-6989586621680952705"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952705"><span class="hs-identifier hs-var">nam</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">(Var -&gt; PassM Var) -&gt; Var -&gt; PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;tmp_struct&quot;</span></span><span>
</span><span id="line-720"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680952706"><span class="annot"><span class="annottext">bind :: (Var, Ty) -&gt; FilePath -&gt; BlockItem
</span><a href="#local-6989586621680952706"><span class="hs-identifier hs-var hs-var">bind</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680952707"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952707"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952708"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952708"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680952709"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680952709"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Var -&gt; Exp -&gt; BlockItem
forall v e. (ToIdent v, ToExp e) =&gt; Type -&gt; v -&gt; e -&gt; BlockItem
</span><a href="Gibbon.Passes.Codegen.html#assn"><span class="hs-identifier hs-var">assn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty -&gt; Type
</span><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952708"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952707"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Id -&gt; SrcLoc -&gt; Exp
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Member"><span class="hs-identifier hs-var">C.Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#cid"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952705"><span class="hs-identifier hs-var">nam</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; SrcLoc -&gt; Id
forall a. ToIdent a =&gt; a -&gt; SrcLoc -&gt; Id
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Quote.Base.html#toIdent"><span class="hs-identifier hs-var">C.toIdent</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680952709"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-721"></span><span>           </span><span id="local-6989586621680952710"><span class="annot"><span class="annottext">fields :: [FilePath]
</span><a href="#local-6989586621680952710"><span class="hs-identifier hs-var hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; FilePath) -&gt; [Int] -&gt; [FilePath]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680952711"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680952711"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;field&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680952711"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952667"><span class="hs-identifier hs-var">bnds</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-722"></span><span>           </span><span id="local-6989586621680952712"><span class="annot"><span class="annottext">ty0 :: Ty
</span><a href="#local-6989586621680952712"><span class="hs-identifier hs-var hs-var">ty0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="annot"><span class="annottext">([Ty] -&gt; Ty) -&gt; [Ty] -&gt; Ty
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((Var, Ty) -&gt; Ty) -&gt; [(Var, Ty)] -&gt; [Ty]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty) -&gt; Ty
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952667"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-723"></span><span>           </span><span id="local-6989586621680952713"><span class="annot"><span class="annottext">init :: [BlockItem]
</span><a href="#local-6989586621680952713"><span class="hs-identifier hs-var hs-var">init</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy ty0) $id:nam = $(fnexp); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-724"></span><span>           </span><span id="local-6989586621680952719"><span class="annot"><span class="annottext">venv' :: VEnv
</span><a href="#local-6989586621680952719"><span class="hs-identifier hs-var hs-var">venv'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, Ty)] -&gt; VEnv
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952667"><span class="hs-identifier hs-var">bnds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VEnv -&gt; VEnv -&gt; VEnv
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952664"><span class="hs-identifier hs-var">venv</span></a></span><span>
</span><span id="line-725"></span><span>       </span><span id="local-6989586621680952720"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952720"><span class="hs-identifier hs-var">tal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952719"><span class="hs-identifier hs-var">venv'</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952665"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952666"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952670"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952671"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952672"><span class="hs-identifier hs-var">sync_deps</span></a></span><span>
</span><span id="line-726"></span><span>       </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952713"><span class="hs-identifier hs-var">init</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">((Var, Ty) -&gt; FilePath -&gt; BlockItem)
-&gt; [(Var, Ty)] -&gt; [FilePath] -&gt; [BlockItem]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty) -&gt; FilePath -&gt; BlockItem
</span><a href="#local-6989586621680952706"><span class="hs-identifier hs-var">bind</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952667"><span class="hs-identifier hs-var">bnds</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621680952710"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952720"><span class="hs-identifier hs-var">tal</span></a></span><span>
</span><span id="line-727"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-728"></span><span>    </span><span id="local-6989586621680952721"><span class="annot"><span class="annottext">fncall :: Exp
</span><a href="#local-6989586621680952721"><span class="hs-identifier hs-var hs-var">fncall</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-729"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680952722"><span class="annot"><span class="annottext">rnds' :: [Exp]
</span><a href="#local-6989586621680952722"><span class="hs-identifier hs-var hs-var">rnds'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Triv -&gt; Exp) -&gt; [Triv] -&gt; [Exp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VEnv -&gt; Triv -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#codegenTriv"><span class="hs-identifier hs-var">codegenTriv</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952664"><span class="hs-identifier hs-var">venv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952669"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-730"></span><span>          </span><span id="local-6989586621680952723"><span class="annot"><span class="annottext">rnds'' :: [Exp]
</span><a href="#local-6989586621680952723"><span class="hs-identifier hs-var hs-var">rnds''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Set Var -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#member"><span class="hs-identifier hs-var">S.member</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952668"><span class="hs-identifier hs-var">ratr</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952666"><span class="hs-identifier hs-var">sort_fns</span></a></span><span>
</span><span id="line-731"></span><span>                   </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp) -&gt; [Exp] -&gt; [Exp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680952724"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680952724"><span class="hs-identifier hs-var">rnd</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="">[cexp| &amp;$rnd|]</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621680952722"><span class="hs-identifier hs-var">rnds'</span></a></span><span>
</span><span id="line-732"></span><span>                   </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621680952722"><span class="hs-identifier hs-var">rnds'</span></a></span><span>
</span><span id="line-733"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Exp] -&gt; SrcLoc -&gt; Exp
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#FnCall"><span class="hs-identifier hs-var">C.FnCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#cid"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952668"><span class="hs-identifier hs-var">ratr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621680952723"><span class="hs-identifier hs-var">rnds''</span></a></span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span>
</span><span id="line-734"></span><span>    </span><span id="local-6989586621680952675"><span class="annot"><span class="annottext">fnexp :: Exp
</span><a href="#local-6989586621680952675"><span class="hs-identifier hs-var hs-var">fnexp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; SrcLoc -&gt; Exp
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#EscExp"><span class="hs-identifier hs-var">C.EscExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc -&gt; FilePath
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/mainland-pretty-0.7.1-995044b4e52316ade5a9e6d232c4eed1e12a18c31ae656f9813375a1750980fc/share/doc/html/src/Text.PrettyPrint.Mainland.html#prettyCompact"><span class="hs-identifier hs-var">prettyCompact</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/mainland-pretty-0.7.1-995044b4e52316ade5a9e6d232c4eed1e12a18c31ae656f9813375a1750980fc/share/doc/html/src/Text.PrettyPrint.Mainland.html#space"><span class="hs-identifier hs-var">space</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/mainland-pretty-0.7.1-995044b4e52316ade5a9e6d232c4eed1e12a18c31ae656f9813375a1750980fc/share/doc/html/src/Text.PrettyPrint.Mainland.Class.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680952721"><span class="hs-identifier hs-var">fncall</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span>
</span><span id="line-735"></span><span>
</span><span id="line-736"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span id="local-6989586621680952728"><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952728"><span class="hs-identifier hs-var">venv</span></a></span></span><span> </span><span id="local-6989586621680952729"><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952729"><span class="hs-identifier hs-var">fenv</span></a></span></span><span> </span><span id="local-6989586621680952730"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952730"><span class="hs-identifier hs-var">sort_fns</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetCallT"><span class="hs-identifier hs-type">LetCallT</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span id="local-6989586621680952731"><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952731"><span class="hs-identifier hs-var">bnds</span></a></span></span><span> </span><span id="local-6989586621680952732"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952732"><span class="hs-identifier hs-var">ratr</span></a></span></span><span> </span><span id="local-6989586621680952733"><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952733"><span class="hs-identifier hs-var">rnds</span></a></span></span><span> </span><span id="local-6989586621680952734"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952734"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680952735"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952735"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680952736"><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952736"><span class="hs-identifier hs-var">sync_deps</span></a></span></span><span>
</span><span id="line-737"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952731"><span class="hs-identifier hs-var">bnds</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680952737"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952737"><span class="hs-identifier hs-var">tal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952728"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952729"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952730"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952734"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952735"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952736"><span class="hs-identifier hs-var">sync_deps</span></a></span><span>
</span><span id="line-738"></span><span>                      </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp -&gt; BlockItem
</span><a href="Gibbon.Passes.Codegen.html#toStmt"><span class="hs-identifier hs-var">toStmt</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680952738"><span class="hs-identifier hs-var">spawnexp</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952737"><span class="hs-identifier hs-var">tal</span></a></span><span>
</span><span id="line-739"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span id="local-6989586621680952739"><span class="annot"><span class="annottext">(Var, Ty)
</span><a href="#local-6989586621680952739"><span class="hs-identifier hs-var">bnd</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952731"><span class="hs-identifier hs-var">bnds</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680952740"><span class="annot"><span class="annottext">fn_ret_ty :: Ty
</span><a href="#local-6989586621680952740"><span class="hs-identifier hs-var hs-var">fn_ret_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Ty], Ty) -&gt; Ty
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952729"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty) -&gt; Var -&gt; ([Ty], Ty)
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#%21"><span class="hs-operator hs-var">M.!</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952732"><span class="hs-identifier hs-var">ratr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-740"></span><span>                           </span><span id="local-6989586621680952741"><span class="annot"><span class="annottext">venv' :: VEnv
</span><a href="#local-6989586621680952741"><span class="hs-identifier hs-var hs-var">venv'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, Ty)] -&gt; VEnv
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952731"><span class="hs-identifier hs-var">bnds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VEnv -&gt; VEnv -&gt; VEnv
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952728"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-741"></span><span>                       </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952740"><span class="hs-identifier hs-var">fn_ret_ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-742"></span><span>                         </span><span class="hs-comment">-- Copied from the otherwise case below.</span><span>
</span><span id="line-743"></span><span>                         </span><span class="annot"><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621680952742"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952742"><span class="hs-identifier hs-var">_one</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-744"></span><span>                           </span><span id="local-6989586621680952743"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952743"><span class="hs-identifier hs-var">nam</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">(Var -&gt; PassM Var) -&gt; Var -&gt; PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;tmp_struct&quot;</span></span><span>
</span><span id="line-745"></span><span>                           </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680952744"><span class="annot"><span class="annottext">bind :: (Var, Ty) -&gt; FilePath -&gt; (Var, BlockItem)
</span><a href="#local-6989586621680952744"><span class="hs-identifier hs-var hs-var">bind</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680952745"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952745"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952746"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952746"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680952747"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680952747"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952745"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Var -&gt; Exp -&gt; BlockItem
forall v e. (ToIdent v, ToExp e) =&gt; Type -&gt; v -&gt; e -&gt; BlockItem
</span><a href="Gibbon.Passes.Codegen.html#assn"><span class="hs-identifier hs-var">assn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty -&gt; Type
</span><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952746"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952745"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Id -&gt; SrcLoc -&gt; Exp
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Member"><span class="hs-identifier hs-var">C.Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#cid"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952743"><span class="hs-identifier hs-var">nam</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; SrcLoc -&gt; Id
forall a. ToIdent a =&gt; a -&gt; SrcLoc -&gt; Id
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Quote.Base.html#toIdent"><span class="hs-identifier hs-var">C.toIdent</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680952747"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-746"></span><span>                               </span><span id="local-6989586621680952748"><span class="annot"><span class="annottext">fields :: [FilePath]
</span><a href="#local-6989586621680952748"><span class="hs-identifier hs-var hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; FilePath) -&gt; [Int] -&gt; [FilePath]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680952749"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680952749"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;field&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680952749"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952731"><span class="hs-identifier hs-var">bnds</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-747"></span><span>                               </span><span id="local-6989586621680952750"><span class="annot"><span class="annottext">ty0 :: Ty
</span><a href="#local-6989586621680952750"><span class="hs-identifier hs-var hs-var">ty0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="annot"><span class="annottext">([Ty] -&gt; Ty) -&gt; [Ty] -&gt; Ty
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((Var, Ty) -&gt; Ty) -&gt; [(Var, Ty)] -&gt; [Ty]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty) -&gt; Ty
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952731"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-748"></span><span>                               </span><span id="local-6989586621680952751"><span class="annot"><span class="annottext">init :: [BlockItem]
</span><a href="#local-6989586621680952751"><span class="hs-identifier hs-var hs-var">init</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy ty0) $id:nam = $(spawnexp); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-749"></span><span>                               </span><span id="local-6989586621680952757"><span class="annot"><span class="annottext">bind_after_sync :: SyncDeps
</span><a href="#local-6989586621680952757"><span class="hs-identifier hs-var hs-var">bind_after_sync</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Var, Ty) -&gt; FilePath -&gt; (Var, BlockItem))
-&gt; [(Var, Ty)] -&gt; [FilePath] -&gt; SyncDeps
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty) -&gt; FilePath -&gt; (Var, BlockItem)
</span><a href="#local-6989586621680952744"><span class="hs-identifier hs-var">bind</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952731"><span class="hs-identifier hs-var">bnds</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621680952748"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-750"></span><span>                           </span><span id="local-6989586621680952758"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952758"><span class="hs-identifier hs-var">tal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952741"><span class="hs-identifier hs-var">venv'</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952729"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952730"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952734"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952735"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952736"><span class="hs-identifier hs-var">sync_deps</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps -&gt; SyncDeps -&gt; SyncDeps
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952757"><span class="hs-identifier hs-var">bind_after_sync</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-751"></span><span>                           </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952751"><span class="hs-identifier hs-var">init</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952758"><span class="hs-identifier hs-var">tal</span></a></span><span>
</span><span id="line-752"></span><span>                         </span><span class="annot"><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; PassM [BlockItem]
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; PassM [BlockItem]) -&gt; FilePath -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;codegenTail: LetCallT&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; FilePath
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952732"><span class="hs-identifier hs-var">ratr</span></a></span><span>
</span><span id="line-753"></span><span>                         </span><span class="annot"><span class="annottext">Ty
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-754"></span><span>                           </span><span id="local-6989586621680952759"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952759"><span class="hs-identifier hs-var">tal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952741"><span class="hs-identifier hs-var">venv'</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952729"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952730"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952734"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952735"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952736"><span class="hs-identifier hs-var">sync_deps</span></a></span><span>
</span><span id="line-755"></span><span>                           </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680952760"><span class="annot"><span class="annottext">call :: BlockItem
</span><a href="#local-6989586621680952760"><span class="hs-identifier hs-var hs-var">call</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Var -&gt; Exp -&gt; BlockItem
forall v e. (ToIdent v, ToExp e) =&gt; Type -&gt; v -&gt; e -&gt; BlockItem
</span><a href="Gibbon.Passes.Codegen.html#assn"><span class="hs-identifier hs-var">assn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty -&gt; Type
</span><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, Ty) -&gt; Ty
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty)
</span><a href="#local-6989586621680952739"><span class="hs-identifier hs-var">bnd</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, Ty) -&gt; Var
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty)
</span><a href="#local-6989586621680952739"><span class="hs-identifier hs-var">bnd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680952738"><span class="hs-identifier hs-var">spawnexp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-756"></span><span>                           </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">BlockItem
</span><a href="#local-6989586621680952760"><span class="hs-identifier hs-var">call</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952759"><span class="hs-identifier hs-var">tal</span></a></span><span>
</span><span id="line-757"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-758"></span><span>       </span><span id="local-6989586621680952761"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952761"><span class="hs-identifier hs-var">nam</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">(Var -&gt; PassM Var) -&gt; Var -&gt; PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;tmp_struct&quot;</span></span><span>
</span><span id="line-759"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680952762"><span class="annot"><span class="annottext">bind :: (Var, Ty) -&gt; FilePath -&gt; (Var, BlockItem)
</span><a href="#local-6989586621680952762"><span class="hs-identifier hs-var hs-var">bind</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680952763"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952763"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952764"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952764"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680952765"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680952765"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952763"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Var -&gt; Exp -&gt; BlockItem
forall v e. (ToIdent v, ToExp e) =&gt; Type -&gt; v -&gt; e -&gt; BlockItem
</span><a href="Gibbon.Passes.Codegen.html#assn"><span class="hs-identifier hs-var">assn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty -&gt; Type
</span><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952764"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952763"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Id -&gt; SrcLoc -&gt; Exp
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Member"><span class="hs-identifier hs-var">C.Member</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#cid"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952761"><span class="hs-identifier hs-var">nam</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; SrcLoc -&gt; Id
forall a. ToIdent a =&gt; a -&gt; SrcLoc -&gt; Id
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Quote.Base.html#toIdent"><span class="hs-identifier hs-var">C.toIdent</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680952765"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-760"></span><span>           </span><span id="local-6989586621680952766"><span class="annot"><span class="annottext">fields :: [FilePath]
</span><a href="#local-6989586621680952766"><span class="hs-identifier hs-var hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; FilePath) -&gt; [Int] -&gt; [FilePath]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680952767"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680952767"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;field&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680952767"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952731"><span class="hs-identifier hs-var">bnds</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-761"></span><span>           </span><span id="local-6989586621680952768"><span class="annot"><span class="annottext">ty0 :: Ty
</span><a href="#local-6989586621680952768"><span class="hs-identifier hs-var hs-var">ty0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="annot"><span class="annottext">([Ty] -&gt; Ty) -&gt; [Ty] -&gt; Ty
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((Var, Ty) -&gt; Ty) -&gt; [(Var, Ty)] -&gt; [Ty]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty) -&gt; Ty
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952731"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-762"></span><span>           </span><span id="local-6989586621680952769"><span class="annot"><span class="annottext">init :: [BlockItem]
</span><a href="#local-6989586621680952769"><span class="hs-identifier hs-var hs-var">init</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy ty0) $id:nam = $(spawnexp); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-763"></span><span>
</span><span id="line-764"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680952775"><span class="annot"><span class="annottext">bind_after_sync :: SyncDeps
</span><a href="#local-6989586621680952775"><span class="hs-identifier hs-var hs-var">bind_after_sync</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Var, Ty) -&gt; FilePath -&gt; (Var, BlockItem))
-&gt; [(Var, Ty)] -&gt; [FilePath] -&gt; SyncDeps
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty) -&gt; FilePath -&gt; (Var, BlockItem)
</span><a href="#local-6989586621680952762"><span class="hs-identifier hs-var">bind</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952731"><span class="hs-identifier hs-var">bnds</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621680952766"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-765"></span><span>           </span><span id="local-6989586621680952776"><span class="annot"><span class="annottext">venv' :: VEnv
</span><a href="#local-6989586621680952776"><span class="hs-identifier hs-var hs-var">venv'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, Ty)] -&gt; VEnv
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952731"><span class="hs-identifier hs-var">bnds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VEnv -&gt; VEnv -&gt; VEnv
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952728"><span class="hs-identifier hs-var">venv</span></a></span><span>
</span><span id="line-766"></span><span>       </span><span id="local-6989586621680952777"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952777"><span class="hs-identifier hs-var">tal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952776"><span class="hs-identifier hs-var">venv'</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952729"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952730"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952734"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952735"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952736"><span class="hs-identifier hs-var">sync_deps</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps -&gt; SyncDeps -&gt; SyncDeps
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952775"><span class="hs-identifier hs-var">bind_after_sync</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-767"></span><span>       </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952769"><span class="hs-identifier hs-var">init</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>  </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952777"><span class="hs-identifier hs-var">tal</span></a></span><span>
</span><span id="line-768"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-769"></span><span>    </span><span id="local-6989586621680952778"><span class="annot"><span class="annottext">fncall :: Exp
</span><a href="#local-6989586621680952778"><span class="hs-identifier hs-var hs-var">fncall</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Exp] -&gt; SrcLoc -&gt; Exp
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#FnCall"><span class="hs-identifier hs-var">C.FnCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#cid"><span class="hs-identifier hs-var">cid</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952732"><span class="hs-identifier hs-var">ratr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Triv -&gt; Exp) -&gt; [Triv] -&gt; [Exp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VEnv -&gt; Triv -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#codegenTriv"><span class="hs-identifier hs-var">codegenTriv</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952728"><span class="hs-identifier hs-var">venv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952733"><span class="hs-identifier hs-var">rnds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span>
</span><span id="line-770"></span><span>    </span><span id="local-6989586621680952738"><span class="annot"><span class="annottext">spawnexp :: Exp
</span><a href="#local-6989586621680952738"><span class="hs-identifier hs-var hs-var">spawnexp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; SrcLoc -&gt; Exp
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#EscExp"><span class="hs-identifier hs-var">C.EscExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc -&gt; FilePath
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/mainland-pretty-0.7.1-995044b4e52316ade5a9e6d232c4eed1e12a18c31ae656f9813375a1750980fc/share/doc/html/src/Text.PrettyPrint.Mainland.html#prettyCompact"><span class="hs-identifier hs-var">prettyCompact</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Doc
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/mainland-pretty-0.7.1-995044b4e52316ade5a9e6d232c4eed1e12a18c31ae656f9813375a1750980fc/share/doc/html/src/Text.PrettyPrint.Mainland.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;cilk_spawn&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/mainland-pretty-0.7.1-995044b4e52316ade5a9e6d232c4eed1e12a18c31ae656f9813375a1750980fc/share/doc/html/src/Text.PrettyPrint.Mainland.html#space"><span class="hs-identifier hs-var">space</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; Doc -&gt; Doc
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/mainland-pretty-0.7.1-995044b4e52316ade5a9e6d232c4eed1e12a18c31ae656f9813375a1750980fc/share/doc/html/src/Text.PrettyPrint.Mainland.Class.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680952778"><span class="hs-identifier hs-var">fncall</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span>
</span><span id="line-771"></span><span>    </span><span id="local-6989586621680952780"><span class="annot"><span class="annottext">_seqexp :: Exp
</span><a href="#local-6989586621680952780"><span class="hs-identifier hs-var hs-var">_seqexp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; SrcLoc -&gt; Exp
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#EscExp"><span class="hs-identifier hs-var">C.EscExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc -&gt; FilePath
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/mainland-pretty-0.7.1-995044b4e52316ade5a9e6d232c4eed1e12a18c31ae656f9813375a1750980fc/share/doc/html/src/Text.PrettyPrint.Mainland.html#prettyCompact"><span class="hs-identifier hs-var">prettyCompact</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Doc
forall a. Pretty a =&gt; a -&gt; Doc
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/mainland-pretty-0.7.1-995044b4e52316ade5a9e6d232c4eed1e12a18c31ae656f9813375a1750980fc/share/doc/html/src/Text.PrettyPrint.Mainland.Class.html#ppr"><span class="hs-identifier hs-var">ppr</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680952778"><span class="hs-identifier hs-var">fncall</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span>
</span><span id="line-772"></span><span>
</span><span id="line-773"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span id="local-6989586621680952781"><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952781"><span class="hs-identifier hs-var">venv</span></a></span></span><span> </span><span id="local-6989586621680952782"><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952782"><span class="hs-identifier hs-var">fenv</span></a></span></span><span> </span><span id="local-6989586621680952783"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952783"><span class="hs-identifier hs-var">sort_fns</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetPrimCallT"><span class="hs-identifier hs-type">LetPrimCallT</span></a></span><span> </span><span id="local-6989586621680952784"><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span></span><span> </span><span id="local-6989586621680952785"><span class="annot"><span class="annottext">Prim
</span><a href="#local-6989586621680952785"><span class="hs-identifier hs-var">prm</span></a></span></span><span> </span><span id="local-6989586621680952786"><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span></span><span> </span><span id="local-6989586621680952787"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952787"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680952788"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952788"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680952789"><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952789"><span class="hs-identifier hs-var">sync_deps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-774"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680952790"><span class="annot"><span class="annottext">venv' :: VEnv
</span><a href="#local-6989586621680952790"><span class="hs-identifier hs-var hs-var">venv'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, Ty)] -&gt; VEnv
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">VEnv -&gt; VEnv -&gt; VEnv
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952781"><span class="hs-identifier hs-var">venv</span></a></span><span>
</span><span id="line-775"></span><span>       </span><span id="local-6989586621680952791"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952791"><span class="hs-identifier hs-var">bod'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="#local-6989586621680952785"><span class="hs-identifier hs-var">prm</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-776"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#ParSync"><span class="hs-identifier hs-var">ParSync</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952790"><span class="hs-identifier hs-var">venv'</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952782"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952783"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952787"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952788"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-777"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952790"><span class="hs-identifier hs-var">venv'</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952782"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952783"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680952787"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952788"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952789"><span class="hs-identifier hs-var">sync_deps</span></a></span><span>
</span><span id="line-778"></span><span>       </span><span id="local-6989586621680952793"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680952793"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PassM DynFlags
forall (m :: * -&gt; *). MonadReader Config m =&gt; m DynFlags
</span><a href="Gibbon.Common.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-779"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680952794"><span class="annot"><span class="annottext">isPacked :: Bool
</span><a href="#local-6989586621680952794"><span class="hs-identifier hs-var hs-var">isPacked</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_Packed"><span class="hs-identifier hs-var">Opt_Packed</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680952793"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-780"></span><span>           </span><span id="local-6989586621680952795"><span class="annot"><span class="annottext">noGC :: Bool
</span><a href="#local-6989586621680952795"><span class="hs-identifier hs-var hs-var">noGC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_DisableGC"><span class="hs-identifier hs-var">Opt_DisableGC</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680952793"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-781"></span><span>           </span><span id="local-6989586621680952797"><span class="annot"><span class="annottext">genGC :: Bool
</span><a href="#local-6989586621680952797"><span class="hs-identifier hs-var hs-var">genGC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_GenGc"><span class="hs-identifier hs-var">Opt_GenGc</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680952793"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-782"></span><span>
</span><span id="line-783"></span><span>       </span><span id="local-6989586621680952798"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952798"><span class="hs-identifier hs-var">pre</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="#local-6989586621680952785"><span class="hs-identifier hs-var">prm</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-784"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#AddP"><span class="hs-identifier hs-var">AddP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680952800"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952800"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952801"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952801"><span class="hs-identifier hs-var">outT</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-785"></span><span>                             </span><span class="hs-special">[</span><span id="local-6989586621680952802"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952802"><span class="hs-identifier hs-var">pleft</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952803"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952803"><span class="hs-identifier hs-var">pright</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-786"></span><span>                         </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy outT) $id:outV = $(codegenTriv venv pleft) + $(codegenTriv venv pright); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-787"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#SubP"><span class="hs-identifier hs-var">SubP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680952811"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952811"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952812"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952812"><span class="hs-identifier hs-var">outT</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)] -&gt; (Var, Ty)
forall a. HasCallStack =&gt; [a] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-788"></span><span>                             </span><span class="hs-special">[</span><span id="local-6989586621680952814"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952814"><span class="hs-identifier hs-var">pleft</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952815"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952815"><span class="hs-identifier hs-var">pright</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-789"></span><span>                         </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy outT) $id:outV = $(codegenTriv venv pleft) - $(codegenTriv venv pright); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-790"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#MulP"><span class="hs-identifier hs-var">MulP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680952822"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952822"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952823"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952823"><span class="hs-identifier hs-var">outT</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-791"></span><span>                             </span><span class="hs-special">[</span><span id="local-6989586621680952824"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952824"><span class="hs-identifier hs-var">pleft</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952825"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952825"><span class="hs-identifier hs-var">pright</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-792"></span><span>                         </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy outT) $id:outV = $(codegenTriv venv pleft) * $(codegenTriv venv pright); |]</span></span><span class="hs-special">]</span><span>
</span><span id="line-793"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#DivP"><span class="hs-identifier hs-var">DivP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680952833"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952833"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952834"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952834"><span class="hs-identifier hs-var">outT</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-794"></span><span>                             </span><span class="hs-special">[</span><span id="local-6989586621680952835"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952835"><span class="hs-identifier hs-var">pleft</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952836"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952836"><span class="hs-identifier hs-var">pright</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-795"></span><span>                         </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy outT) $id:outV = $(codegenTriv venv pleft) / $(codegenTriv venv pright); |]</span></span><span class="hs-special">]</span><span>
</span><span id="line-796"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#ModP"><span class="hs-identifier hs-var">ModP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680952843"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952843"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952844"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952844"><span class="hs-identifier hs-var">outT</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-797"></span><span>                             </span><span class="hs-special">[</span><span id="local-6989586621680952845"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952845"><span class="hs-identifier hs-var">pleft</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952846"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952846"><span class="hs-identifier hs-var">pright</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-798"></span><span>                         </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy outT) $id:outV = $(codegenTriv venv pleft) % $(codegenTriv venv pright); |]</span></span><span class="hs-special">]</span><span>
</span><span id="line-799"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#ExpP"><span class="hs-identifier hs-var">ExpP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680952854"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952854"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952855"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952855"><span class="hs-identifier hs-var">outT</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-800"></span><span>                             </span><span class="hs-special">[</span><span id="local-6989586621680952856"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952856"><span class="hs-identifier hs-var">pleft</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952857"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952857"><span class="hs-identifier hs-var">pright</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-801"></span><span>                         </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy outT) $id:outV = gib_expll($(codegenTriv venv pleft), $(codegenTriv venv pright)); |]</span></span><span class="hs-special">]</span><span>
</span><span id="line-802"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#RandP"><span class="hs-identifier hs-var">RandP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680952864"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952864"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952865"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952865"><span class="hs-identifier hs-var">outT</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-803"></span><span>                          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy outT) $id:outV = rand(); |]</span></span><span class="hs-special">]</span><span>
</span><span id="line-804"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#FRandP"><span class="hs-identifier hs-var">FRandP</span></a></span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680952872"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952872"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952873"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952873"><span class="hs-identifier hs-var">outT</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-805"></span><span>                              </span><span id="local-6989586621680952874"><span class="annot"><span class="annottext">fty :: Type
</span><a href="#local-6989586621680952874"><span class="hs-identifier hs-var hs-var">fty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Type
</span><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#FloatTy"><span class="hs-identifier hs-var">FloatTy</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-806"></span><span>                          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy outT) $id:outV = ($ty:fty) rand() / ($ty:fty) (RAND_MAX); |]</span></span><span class="hs-special">]</span><span>
</span><span id="line-807"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#FSqrtP"><span class="hs-identifier hs-var">FSqrtP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680952881"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952881"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952882"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952882"><span class="hs-identifier hs-var">outT</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-808"></span><span>                               </span><span class="hs-special">[</span><span id="local-6989586621680952883"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952883"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-809"></span><span>                           </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy outT) $id:outV = sqrt($(codegenTriv venv arg)) ; |]</span></span><span class="hs-special">]</span><span>
</span><span id="line-810"></span><span>
</span><span id="line-811"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#FTanP"><span class="hs-identifier hs-var">FTanP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680952890"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952890"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952891"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952891"><span class="hs-identifier hs-var">outT</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-812"></span><span>                              </span><span class="hs-special">[</span><span id="local-6989586621680952892"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952892"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-813"></span><span>                           </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy outT) $id:outV = tan($(codegenTriv venv arg)) ; |]</span></span><span class="hs-special">]</span><span>
</span><span id="line-814"></span><span>
</span><span id="line-815"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#FloatToIntP"><span class="hs-identifier hs-var">FloatToIntP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680952899"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952899"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952900"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952900"><span class="hs-identifier hs-var">outT</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-816"></span><span>                                    </span><span class="hs-special">[</span><span id="local-6989586621680952901"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952901"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-817"></span><span>                                    </span><span id="local-6989586621680952902"><span class="annot"><span class="annottext">ity :: Type
</span><a href="#local-6989586621680952902"><span class="hs-identifier hs-var hs-var">ity</span></a></span></span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Type
</span><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#IntTy"><span class="hs-identifier hs-var">IntTy</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-818"></span><span>                                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy outT) $id:outV = ($ty:ity) ($(codegenTriv venv arg)) ; |]</span></span><span class="hs-special">]</span><span>
</span><span id="line-819"></span><span>
</span><span id="line-820"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#IntToFloatP"><span class="hs-identifier hs-var">IntToFloatP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680952909"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952909"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952910"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952910"><span class="hs-identifier hs-var">outT</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-821"></span><span>                                    </span><span class="hs-special">[</span><span id="local-6989586621680952911"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952911"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-822"></span><span>                                    </span><span id="local-6989586621680952912"><span class="annot"><span class="annottext">fty :: Type
</span><a href="#local-6989586621680952912"><span class="hs-identifier hs-var hs-var">fty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Type
</span><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#FloatTy"><span class="hs-identifier hs-var">FloatTy</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-823"></span><span>                                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy outT) $id:outV = ($ty:fty) ($(codegenTriv venv arg)) ; |]</span></span><span class="hs-special">]</span><span>
</span><span id="line-824"></span><span>
</span><span id="line-825"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#EqP"><span class="hs-identifier hs-var">EqP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680952919"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952919"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952920"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952920"><span class="hs-identifier hs-var">outT</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-826"></span><span>                            </span><span class="hs-special">[</span><span id="local-6989586621680952921"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952921"><span class="hs-identifier hs-var">pleft</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952922"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952922"><span class="hs-identifier hs-var">pright</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-827"></span><span>                        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy outT) $id:outV = ($(codegenTriv venv pleft) == $(codegenTriv venv pright)); |]</span></span><span class="hs-special">]</span><span>
</span><span id="line-828"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#LtP"><span class="hs-identifier hs-var">LtP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680952930"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952930"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952931"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952931"><span class="hs-identifier hs-var">outT</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-829"></span><span>                            </span><span class="hs-special">[</span><span id="local-6989586621680952932"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952932"><span class="hs-identifier hs-var">pleft</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952933"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952933"><span class="hs-identifier hs-var">pright</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-830"></span><span>                        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy outT) $id:outV = ($(codegenTriv venv pleft) &lt; $(codegenTriv venv pright)); |]</span></span><span class="hs-special">]</span><span>
</span><span id="line-831"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#GtP"><span class="hs-identifier hs-var">GtP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680952940"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952940"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952941"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952941"><span class="hs-identifier hs-var">outT</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-832"></span><span>                            </span><span class="hs-special">[</span><span id="local-6989586621680952942"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952942"><span class="hs-identifier hs-var">pleft</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952943"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952943"><span class="hs-identifier hs-var">pright</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-833"></span><span>                        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy outT) $id:outV = ($(codegenTriv venv pleft) &gt; $(codegenTriv venv pright)); |]</span></span><span class="hs-special">]</span><span>
</span><span id="line-834"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#LtEqP"><span class="hs-identifier hs-var">LtEqP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680952951"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952951"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952952"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952952"><span class="hs-identifier hs-var">outT</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-835"></span><span>                              </span><span class="hs-special">[</span><span id="local-6989586621680952953"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952953"><span class="hs-identifier hs-var">pleft</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952954"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952954"><span class="hs-identifier hs-var">pright</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-836"></span><span>                          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy outT) $id:outV = ($(codegenTriv venv pleft) &lt;= $(codegenTriv venv pright)); |]</span></span><span class="hs-special">]</span><span>
</span><span id="line-837"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#GtEqP"><span class="hs-identifier hs-var">GtEqP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680952962"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952962"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952963"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952963"><span class="hs-identifier hs-var">outT</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-838"></span><span>                              </span><span class="hs-special">[</span><span id="local-6989586621680952964"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952964"><span class="hs-identifier hs-var">pleft</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952965"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952965"><span class="hs-identifier hs-var">pright</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-839"></span><span>                          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy outT) $id:outV = ($(codegenTriv venv pleft) &gt;= $(codegenTriv venv pright)); |]</span></span><span class="hs-special">]</span><span>
</span><span id="line-840"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#OrP"><span class="hs-identifier hs-var">OrP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680952973"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952973"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952974"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952974"><span class="hs-identifier hs-var">outT</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-841"></span><span>                            </span><span class="hs-special">[</span><span id="local-6989586621680952975"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952975"><span class="hs-identifier hs-var">pleft</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952976"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952976"><span class="hs-identifier hs-var">pright</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-842"></span><span>                        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy outT) $id:outV = ($(codegenTriv venv pleft) || $(codegenTriv venv pright)); |]</span></span><span class="hs-special">]</span><span>
</span><span id="line-843"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#AndP"><span class="hs-identifier hs-var">AndP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680952984"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952984"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952985"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952985"><span class="hs-identifier hs-var">outT</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-844"></span><span>                             </span><span class="hs-special">[</span><span id="local-6989586621680952986"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952986"><span class="hs-identifier hs-var">pleft</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952987"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952987"><span class="hs-identifier hs-var">pright</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-845"></span><span>                        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy outT) $id:outV = ($(codegenTriv venv pleft) &amp;&amp; $(codegenTriv venv pright)); |]</span></span><span class="hs-special">]</span><span>
</span><span id="line-846"></span><span>
</span><span id="line-847"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#EqSymP"><span class="hs-identifier hs-var">EqSymP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680952995"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680952995"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952996"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680952996"><span class="hs-identifier hs-var">outT</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-848"></span><span>                               </span><span class="hs-special">[</span><span id="local-6989586621680952997"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952997"><span class="hs-identifier hs-var">pleft</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680952998"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680952998"><span class="hs-identifier hs-var">pright</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-849"></span><span>                           </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy outT) $id:outV = $(codegenTriv venv pleft) == $(codegenTriv venv pright); |]</span></span><span class="hs-special">]</span><span>
</span><span id="line-850"></span><span>
</span><span id="line-851"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#EqBenchProgP"><span class="hs-identifier hs-type">EqBenchProgP</span></a></span><span> </span><span id="local-6989586621680953005"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680953005"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953006"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953006"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953007"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953007"><span class="hs-identifier hs-var">outT</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-852"></span><span>                                     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy outT) $id:outV = strcmp($str,gib_read_bench_prog_param()) == 0; |]</span></span><span class="hs-special">]</span><span>
</span><span id="line-853"></span><span>
</span><span id="line-854"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#DictInsertP"><span class="hs-identifier hs-type">DictInsertP</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953014"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953014"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953015"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953015"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-855"></span><span>                                      </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953016"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953016"><span class="hs-identifier hs-var">arena</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953017"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953017"><span class="hs-identifier hs-var">dict</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621680953018"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953018"><span class="hs-identifier hs-var">keyTriv</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953019"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953019"><span class="hs-identifier hs-var">valTriv</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-856"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy ty) $id:outV = gib_dict_insert_ptr($id:arena, $id:dict, $(codegenTriv venv keyTriv), $(codegenTriv venv valTriv)); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-857"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#DictLookupP"><span class="hs-identifier hs-type">DictLookupP</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953026"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953026"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953027"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953027"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-858"></span><span>                                      </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953028"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953028"><span class="hs-identifier hs-var">dict</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621680953029"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953029"><span class="hs-identifier hs-var">keyTriv</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-859"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy ty) $id:outV = gib_dict_lookup_ptr($id:dict, $(codegenTriv venv keyTriv)); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-860"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#DictEmptyP"><span class="hs-identifier hs-type">DictEmptyP</span></a></span><span> </span><span id="local-6989586621680953036"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953036"><span class="hs-identifier hs-var">_ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953037"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953037"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953038"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953038"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-861"></span><span>                                   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy ty) $id:outV = 0; |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-862"></span><span>                 </span><span class="hs-comment">-- DictHasKeyP PtrTy -&gt; let [(outV,IntTy)] = bnds</span><span>
</span><span id="line-863"></span><span>                 </span><span class="hs-comment">--                          [(VarTriv dict)] = rnds in pure</span><span>
</span><span id="line-864"></span><span>                 </span><span class="hs-comment">--    [ C.BlockDecl [cdecl| $ty:(codegenTy IntTy) $id:outV = dict_has_key_ptr($id:dict); |] ]</span><span>
</span><span id="line-865"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#DictHasKeyP"><span class="hs-identifier hs-type">DictHasKeyP</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; PassM [BlockItem]
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; PassM [BlockItem]) -&gt; FilePath -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;codegen: &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Prim -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="#local-6989586621680952785"><span class="hs-identifier hs-var">prm</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;unhandled.&quot;</span></span><span>
</span><span id="line-866"></span><span>
</span><span id="line-867"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#SymSetEmpty"><span class="hs-identifier hs-var">SymSetEmpty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953046"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953046"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953047"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953047"><span class="hs-identifier hs-var">outT</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-868"></span><span>                                </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy outT) $id:outV = gib_empty_set(); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-869"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#SymSetInsert"><span class="hs-identifier hs-var">SymSetInsert</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953054"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953054"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953055"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953055"><span class="hs-identifier hs-var">outT</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-870"></span><span>                                     </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953056"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953056"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621680953057"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953057"><span class="hs-identifier hs-var">valTriv</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-871"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy outT) $id:outV = gib_insert_set($id:set, $(codegenTriv venv valTriv)); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-872"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#SymSetContains"><span class="hs-identifier hs-var">SymSetContains</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953064"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953064"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953065"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953065"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-873"></span><span>                                       </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953066"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953066"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621680953067"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953067"><span class="hs-identifier hs-var">valTriv</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-874"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy ty) $id:outV = gib_contains_set($id:set, $(codegenTriv venv valTriv)); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-875"></span><span>
</span><span id="line-876"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#SymHashEmpty"><span class="hs-identifier hs-var">SymHashEmpty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953074"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953074"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953075"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953075"><span class="hs-identifier hs-var">outT</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-877"></span><span>                                 </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy outT) $id:outV = gib_empty_hash(); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-878"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#SymHashInsert"><span class="hs-identifier hs-var">SymHashInsert</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953082"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953082"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953083"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953083"><span class="hs-identifier hs-var">outT</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-879"></span><span>                                      </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953084"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953084"><span class="hs-identifier hs-var">hash</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621680953085"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953085"><span class="hs-identifier hs-var">keyTriv</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953086"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953086"><span class="hs-identifier hs-var">valTriv</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-880"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy outT) $id:outV = gib_insert_hash($id:hash, $(codegenTriv venv keyTriv), $(codegenTriv venv valTriv)); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-881"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#SymHashLookup"><span class="hs-identifier hs-var">SymHashLookup</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953093"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953093"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953094"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953094"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-882"></span><span>                                      </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953095"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953095"><span class="hs-identifier hs-var">hash</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621680953096"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953096"><span class="hs-identifier hs-var">keyTriv</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-883"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy ty) $id:outV = gib_lookup_hash($id:hash, $(codegenTriv venv keyTriv)); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-884"></span><span>
</span><span id="line-885"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#SymHashContains"><span class="hs-identifier hs-var">SymHashContains</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953103"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953103"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953104"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953104"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-886"></span><span>                                        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953105"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953105"><span class="hs-identifier hs-var">hash</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621680953106"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953106"><span class="hs-identifier hs-var">keyTriv</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-887"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy ty) $id:outV = gib_contains_hash($id:hash, $(codegenTriv venv keyTriv)); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-888"></span><span>
</span><span id="line-889"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#IntHashEmpty"><span class="hs-identifier hs-var">IntHashEmpty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953113"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953113"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953114"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953114"><span class="hs-identifier hs-var">outT</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-890"></span><span>                                 </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy outT) $id:outV = gib_empty_hash(); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-891"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#IntHashInsert"><span class="hs-identifier hs-var">IntHashInsert</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953121"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953121"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953122"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953122"><span class="hs-identifier hs-var">outT</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-892"></span><span>                                      </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953123"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953123"><span class="hs-identifier hs-var">hash</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621680953124"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953124"><span class="hs-identifier hs-var">keyTriv</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953125"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953125"><span class="hs-identifier hs-var">valTriv</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-893"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy outT) $id:outV = gib_insert_hash($id:hash, $(codegenTriv venv keyTriv), $(codegenTriv venv valTriv)); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-894"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#IntHashLookup"><span class="hs-identifier hs-var">IntHashLookup</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953132"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953132"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953133"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953133"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-895"></span><span>                                      </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953134"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953134"><span class="hs-identifier hs-var">hash</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621680953135"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953135"><span class="hs-identifier hs-var">keyTriv</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-896"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy ty) $id:outV = gib_lookup_hash($id:hash, $(codegenTriv venv keyTriv)); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-897"></span><span>
</span><span id="line-898"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#NewBuffer"><span class="hs-identifier hs-type">NewBuffer</span></a></span><span> </span><span id="local-6989586621680953142"><span class="annot"><span class="annottext">Multiplicity
</span><a href="#local-6989586621680953142"><span class="hs-identifier hs-var">mul</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-899"></span><span>                   </span><span id="local-6989586621680953143"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680953143"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PassM DynFlags
forall (m :: * -&gt; *). MonadReader Config m =&gt; m DynFlags
</span><a href="Gibbon.Common.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-900"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680953144"><span class="annot"><span class="annottext">countRegions :: Bool
</span><a href="#local-6989586621680953144"><span class="hs-identifier hs-var hs-var">countRegions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_CountAllRegions"><span class="hs-identifier hs-var">Opt_CountAllRegions</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680953143"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-901"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953145"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953145"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621680953146"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953146"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621680953147"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953147"><span class="hs-identifier hs-var">endV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-902"></span><span>                       </span><span id="local-6989586621680953148"><span class="annot"><span class="annottext">bufsize :: Exp
</span><a href="#local-6989586621680953148"><span class="hs-identifier hs-var hs-var">bufsize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Multiplicity -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#codegenMultiplicity"><span class="hs-identifier hs-var">codegenMultiplicity</span></a></span><span> </span><span class="annot"><span class="annottext">Multiplicity
</span><a href="#local-6989586621680953142"><span class="hs-identifier hs-var">mul</span></a></span><span>
</span><span id="line-903"></span><span>                   </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680953144"><span class="hs-identifier hs-var">countRegions</span></a></span><span>
</span><span id="line-904"></span><span>                   </span><span class="hs-keyword">then</span><span>
</span><span id="line-905"></span><span>                     </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-906"></span><span>                       </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy RegionTy)* $id:reg = gib_alloc_counted_region($exp:bufsize); |]</span></span><span>
</span><span id="line-907"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) $id:outV = $id:reg-&gt;start; |]</span></span><span>
</span><span id="line-908"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) $id:endV = $id:reg-&gt;end; |]</span></span><span>
</span><span id="line-909"></span><span>                       </span><span class="hs-special">]</span><span>
</span><span id="line-910"></span><span>                   </span><span class="hs-keyword">else</span><span>
</span><span id="line-911"></span><span>                     </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-912"></span><span>                       </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680952797"><span class="hs-identifier hs-var">genGC</span></a></span><span>
</span><span id="line-913"></span><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy RegionTy) $id:reg = gib_alloc_region($exp:bufsize); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-914"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy RegionTy) $id:reg = gib_alloc_region_on_heap($exp:bufsize); |]</span></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-915"></span><span>                          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) $id:outV = $id:reg.start; |]</span></span><span>
</span><span id="line-916"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) $id:endV = $id:reg.end; |]</span></span><span>
</span><span id="line-917"></span><span>                          </span><span class="hs-special">]</span><span>
</span><span id="line-918"></span><span>
</span><span id="line-919"></span><span>
</span><span id="line-920"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#NewParBuffer"><span class="hs-identifier hs-type">NewParBuffer</span></a></span><span> </span><span id="local-6989586621680953187"><span class="annot"><span class="annottext">Multiplicity
</span><a href="#local-6989586621680953187"><span class="hs-identifier hs-var">mul</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-921"></span><span>                   </span><span id="local-6989586621680953188"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680953188"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PassM DynFlags
forall (m :: * -&gt; *). MonadReader Config m =&gt; m DynFlags
</span><a href="Gibbon.Common.html#getDynFlags"><span class="hs-identifier hs-var">getDynFlags</span></a></span><span>
</span><span id="line-922"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680953189"><span class="annot"><span class="annottext">countRegions :: Bool
</span><a href="#local-6989586621680953189"><span class="hs-identifier hs-var hs-var">countRegions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_CountParRegions"><span class="hs-identifier hs-var">Opt_CountParRegions</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680953188"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-923"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953190"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953190"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621680953191"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953191"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621680953192"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953192"><span class="hs-identifier hs-var">endV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-924"></span><span>                       </span><span id="local-6989586621680953193"><span class="annot"><span class="annottext">bufsize :: Exp
</span><a href="#local-6989586621680953193"><span class="hs-identifier hs-var hs-var">bufsize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Multiplicity -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#codegenMultiplicity"><span class="hs-identifier hs-var">codegenMultiplicity</span></a></span><span> </span><span class="annot"><span class="annottext">Multiplicity
</span><a href="#local-6989586621680953187"><span class="hs-identifier hs-var">mul</span></a></span><span>
</span><span id="line-925"></span><span>                   </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680953189"><span class="hs-identifier hs-var">countRegions</span></a></span><span>
</span><span id="line-926"></span><span>                   </span><span class="hs-keyword">then</span><span>
</span><span id="line-927"></span><span>                     </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-928"></span><span>                       </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy RegionTy)* $id:reg = gib_alloc_counted_region($exp:bufsize); |]</span></span><span>
</span><span id="line-929"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) $id:outV = $id:reg-&gt;start; |]</span></span><span>
</span><span id="line-930"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) $id:endV = $id:reg-&gt;end; |]</span></span><span>
</span><span id="line-931"></span><span>                       </span><span class="hs-special">]</span><span>
</span><span id="line-932"></span><span>                   </span><span class="hs-keyword">else</span><span>
</span><span id="line-933"></span><span>                     </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-934"></span><span>                       </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680952797"><span class="hs-identifier hs-var">genGC</span></a></span><span>
</span><span id="line-935"></span><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy RegionTy) $id:reg = gib_alloc_region($exp:bufsize); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-936"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy RegionTy) $id:reg = gib_alloc_region_on_heap($exp:bufsize); |]</span></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-937"></span><span>                          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) $id:outV = $id:reg.start; |]</span></span><span>
</span><span id="line-938"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) $id:endV = $id:reg.end; |]</span></span><span>
</span><span id="line-939"></span><span>                          </span><span class="hs-special">]</span><span>
</span><span id="line-940"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#ScopedBuffer"><span class="hs-identifier hs-type">ScopedBuffer</span></a></span><span> </span><span id="local-6989586621680953230"><span class="annot"><span class="annottext">Multiplicity
</span><a href="#local-6989586621680953230"><span class="hs-identifier hs-var">mul</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953231"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953231"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-941"></span><span>                                         </span><span id="local-6989586621680953232"><span class="annot"><span class="annottext">bufsize :: Exp
</span><a href="#local-6989586621680953232"><span class="hs-identifier hs-var hs-var">bufsize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Multiplicity -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#codegenMultiplicity"><span class="hs-identifier hs-var">codegenMultiplicity</span></a></span><span> </span><span class="annot"><span class="annottext">Multiplicity
</span><a href="#local-6989586621680953230"><span class="hs-identifier hs-var">mul</span></a></span><span>
</span><span id="line-942"></span><span>                                     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-943"></span><span>                             </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) $id:outV = ( $ty:(codegenTy CursorTy) ) gib_scoped_alloc($exp:bufsize); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-944"></span><span>
</span><span id="line-945"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#ScopedParBuffer"><span class="hs-identifier hs-type">ScopedParBuffer</span></a></span><span> </span><span id="local-6989586621680953239"><span class="annot"><span class="annottext">Multiplicity
</span><a href="#local-6989586621680953239"><span class="hs-identifier hs-var">mul</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953240"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953240"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-946"></span><span>                                            </span><span id="local-6989586621680953241"><span class="annot"><span class="annottext">bufsize :: Exp
</span><a href="#local-6989586621680953241"><span class="hs-identifier hs-var hs-var">bufsize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Multiplicity -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#codegenMultiplicity"><span class="hs-identifier hs-var">codegenMultiplicity</span></a></span><span> </span><span class="annot"><span class="annottext">Multiplicity
</span><a href="#local-6989586621680953239"><span class="hs-identifier hs-var">mul</span></a></span><span>
</span><span id="line-947"></span><span>                                        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-948"></span><span>                             </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) $id:outV = ( $ty:(codegenTy CursorTy) ) gib_scoped_alloc($exp:bufsize); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-949"></span><span>
</span><span id="line-950"></span><span>                 </span><span class="hs-comment">-- generated during newbuffer.</span><span>
</span><span id="line-951"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#EndOfBuffer"><span class="hs-identifier hs-type">EndOfBuffer</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-952"></span><span>
</span><span id="line-953"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#FreeBuffer"><span class="hs-identifier hs-var">FreeBuffer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680952795"><span class="hs-identifier hs-var">noGC</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680952797"><span class="hs-identifier hs-var">genGC</span></a></span><span>
</span><span id="line-954"></span><span>                               </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-955"></span><span>                               </span><span class="hs-keyword">else</span><span>
</span><span id="line-956"></span><span>                                 </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953249"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953249"><span class="hs-identifier hs-var">_reg</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953250"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953250"><span class="hs-identifier hs-var">_rcur</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953251"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953251"><span class="hs-identifier hs-var">endr_cur</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-957"></span><span>                                 </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-958"></span><span>                                 </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| gib_free_region($id:endr_cur); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-959"></span><span>
</span><span id="line-960"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#WriteTag"><span class="hs-identifier hs-var">WriteTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953253"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953253"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-961"></span><span>                                 </span><span class="hs-special">[</span><span id="local-6989586621680953254"><span class="annot"><span class="annottext">t :: Triv
</span><a href="#local-6989586621680953254"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#TagTriv"><span class="hs-identifier hs-type">TagTriv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953255"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953255"><span class="hs-identifier hs-var">cur</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-962"></span><span>                             </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| *($ty:(codegenTy TagTyPacked) *) ($id:cur) = $(codegenTriv venv t); |]</span></span><span>
</span><span id="line-963"></span><span>                             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) $id:outV = $id:cur + 1; |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-964"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#ReadTag"><span class="hs-identifier hs-var">ReadTag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953268"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953268"><span class="hs-identifier hs-var">tagV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#TagTyPacked"><span class="hs-identifier hs-var">TagTyPacked</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621680953269"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953269"><span class="hs-identifier hs-var">curV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-965"></span><span>                                </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953270"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953270"><span class="hs-identifier hs-var">cur</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-966"></span><span>                            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy TagTyPacked) $id:tagV = *($ty:(codegenTy TagTyPacked) *) ($id:cur); |]</span></span><span>
</span><span id="line-967"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) $id:curV = $id:cur + 1; |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-968"></span><span>
</span><span id="line-969"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#WriteScalar"><span class="hs-identifier hs-type">WriteScalar</span></a></span><span> </span><span id="local-6989586621680953287"><span class="annot"><span class="annottext">Scalar
</span><a href="#local-6989586621680953287"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953288"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953288"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-970"></span><span>                                      </span><span class="hs-special">[</span><span id="local-6989586621680953289"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953289"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953290"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953290"><span class="hs-identifier hs-var">cur</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-971"></span><span>                                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| *( $ty:(codegenTy (scalarToTy s))  *)($id:cur) = $(codegenTriv venv val); |]</span></span><span>
</span><span id="line-972"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) $id:outV = ($id:cur) + sizeof( $ty:(codegenTy (scalarToTy s)) ); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-973"></span><span>
</span><span id="line-974"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#ReadScalar"><span class="hs-identifier hs-type">ReadScalar</span></a></span><span> </span><span id="local-6989586621680953303"><span class="annot"><span class="annottext">Scalar
</span><a href="#local-6989586621680953303"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953304"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953304"><span class="hs-identifier hs-var">valV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953305"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953305"><span class="hs-identifier hs-var">valTy</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621680953306"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953306"><span class="hs-identifier hs-var">curV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-975"></span><span>                                     </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953307"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953307"><span class="hs-identifier hs-var">cur</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-976"></span><span>                                     </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy valTy) $id:valV = *( $ty:(codegenTy valTy) *)($id:cur); |]</span></span><span>
</span><span id="line-977"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) $id:curV = ($id:cur) + sizeof( $ty:(codegenTy (scalarToTy s))); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-978"></span><span>
</span><span id="line-979"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#TagCursor"><span class="hs-identifier hs-var">TagCursor</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953324"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953324"><span class="hs-identifier hs-var">taggedV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-980"></span><span>                                   </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953325"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953325"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953326"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953326"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-981"></span><span>                                   </span><span id="local-6989586621680953327"><span class="annot"><span class="annottext">tag_t :: Type
</span><a href="#local-6989586621680953327"><span class="hs-identifier hs-var hs-var">tag_t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty| typename uint16_t |]</span></span><span>
</span><span id="line-982"></span><span>                                   </span><span id="local-6989586621680953328"><span class="annot"><span class="annottext">tagged_ptr_t :: Type
</span><a href="#local-6989586621680953328"><span class="hs-identifier hs-var hs-var">tagged_ptr_t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty| typename uintptr_t |]</span></span><span>
</span><span id="line-983"></span><span>                               </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680953329"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953329"><span class="hs-identifier hs-var">offset</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;offset&quot;</span></span><span>
</span><span id="line-984"></span><span>                                     </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-985"></span><span>                                       </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:tag_t $id:offset = $id:b - $id:a; |]</span></span><span>
</span><span id="line-986"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:tagged_ptr_t $id:taggedV = GIB_STORE_TAG($id:a, $id:offset); |]</span></span><span>
</span><span id="line-987"></span><span>                                       </span><span class="hs-special">]</span><span>
</span><span id="line-988"></span><span>
</span><span id="line-989"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#ReadTaggedCursor"><span class="hs-identifier hs-var">ReadTaggedCursor</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-990"></span><span>                               </span><span id="local-6989586621680953341"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953341"><span class="hs-identifier hs-var">tagged</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;tagged_tmpcur&quot;</span></span><span>
</span><span id="line-991"></span><span>                               </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953342"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953342"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621680953343"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953343"><span class="hs-identifier hs-var">afternext</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621680953344"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953344"><span class="hs-identifier hs-var">tag</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#IntTy"><span class="hs-identifier hs-var">IntTy</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-992"></span><span>                                   </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953345"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953345"><span class="hs-identifier hs-var">cur</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-993"></span><span>                                   </span><span id="local-6989586621680953346"><span class="annot"><span class="annottext">tagged_t :: Type
</span><a href="#local-6989586621680953346"><span class="hs-identifier hs-var hs-var">tagged_t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty| typename uintptr_t |]</span></span><span>
</span><span id="line-994"></span><span>                                   </span><span id="local-6989586621680953347"><span class="annot"><span class="annottext">tag_t :: Type
</span><a href="#local-6989586621680953347"><span class="hs-identifier hs-var hs-var">tag_t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty| typename uint16_t |]</span></span><span>
</span><span id="line-995"></span><span>                               </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-996"></span><span>                                 </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:tagged_t $id:tagged = *($ty:tagged_t *) ($id:cur); |]</span></span><span>
</span><span id="line-997"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) $id:next = GIB_UNTAG($id:tagged); |]</span></span><span>
</span><span id="line-998"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) $id:afternext = ($id:cur) + 8; |]</span></span><span>
</span><span id="line-999"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:tag_t $id:tag = GIB_GET_TAG($id:tagged); |]</span></span><span>
</span><span id="line-1000"></span><span>                                 </span><span class="hs-special">]</span><span>
</span><span id="line-1001"></span><span>
</span><span id="line-1002"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#WriteTaggedCursor"><span class="hs-identifier hs-var">WriteTaggedCursor</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1003"></span><span>                                </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953374"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953374"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1004"></span><span>                                    </span><span class="hs-special">[</span><span id="local-6989586621680953375"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953375"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953376"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953376"><span class="hs-identifier hs-var">cur</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-1005"></span><span>                                    </span><span id="local-6989586621680953377"><span class="annot"><span class="annottext">tagged_t :: Type
</span><a href="#local-6989586621680953377"><span class="hs-identifier hs-var hs-var">tagged_t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty| typename uintptr_t |]</span></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-1006"></span><span>                                 </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| *( $ty:tagged_t  *)($id:cur) = ($ty:tagged_t) $(codegenTriv venv val); |]</span></span><span>
</span><span id="line-1007"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) $id:outV = ($id:cur) + 8; |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1008"></span><span>
</span><span id="line-1009"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#ReadCursor"><span class="hs-identifier hs-var">ReadCursor</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953389"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953389"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621680953390"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953390"><span class="hs-identifier hs-var">afternext</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1010"></span><span>                                   </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953391"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953391"><span class="hs-identifier hs-var">cur</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-1011"></span><span>                               </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) $id:next = *($ty:(codegenTy CursorTy) *) ($id:cur); |]</span></span><span>
</span><span id="line-1012"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) $id:afternext = ($id:cur) + 8; |]</span></span><span>
</span><span id="line-1013"></span><span>                               </span><span class="hs-special">]</span><span>
</span><span id="line-1014"></span><span>
</span><span id="line-1015"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#WriteCursor"><span class="hs-identifier hs-var">WriteCursor</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953408"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953408"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1016"></span><span>                                    </span><span class="hs-special">[</span><span id="local-6989586621680953409"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953409"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953410"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953410"><span class="hs-identifier hs-var">cur</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-1017"></span><span>                                 </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| *( $ty:(codegenTy CursorTy)  *)($id:cur) = $(codegenTriv venv val); |]</span></span><span>
</span><span id="line-1018"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) $id:outV = ($id:cur) + 8; |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1019"></span><span>
</span><span id="line-1020"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#WriteList"><span class="hs-identifier hs-var">WriteList</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953422"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953422"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1021"></span><span>                                     </span><span class="hs-special">[</span><span id="local-6989586621680953423"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953423"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953424"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953424"><span class="hs-identifier hs-var">cur</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-1022"></span><span>                                     </span><span id="local-6989586621680953425"><span class="annot"><span class="annottext">ls_ty :: Ty
</span><a href="#local-6989586621680953425"><span class="hs-identifier hs-var hs-var">ls_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ListTy"><span class="hs-identifier hs-var">ListTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty] -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-1023"></span><span>                                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| *( $ty:(codegenTy ls_ty)  *)($id:cur) = $(codegenTriv venv val); |]</span></span><span>
</span><span id="line-1024"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) $id:outV = ($id:cur) + sizeof( $ty:(codegenTy ls_ty) ); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1025"></span><span>
</span><span id="line-1026"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#ReadList"><span class="hs-identifier hs-var">ReadList</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953437"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953437"><span class="hs-identifier hs-var">valV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953438"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953438"><span class="hs-identifier hs-var">valTy</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621680953439"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953439"><span class="hs-identifier hs-var">curV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1027"></span><span>                                     </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953440"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953440"><span class="hs-identifier hs-var">cur</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-1028"></span><span>                                     </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy valTy) $id:valV = *( $ty:(codegenTy valTy) *)($id:cur); |]</span></span><span>
</span><span id="line-1029"></span><span>                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) $id:curV = ($id:cur) + sizeof( $ty:(codegenTy valTy)); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1030"></span><span>
</span><span id="line-1031"></span><span>
</span><span id="line-1032"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#WriteVector"><span class="hs-identifier hs-var">WriteVector</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953457"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953457"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1033"></span><span>                                       </span><span class="hs-special">[</span><span id="local-6989586621680953458"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953458"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953459"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953459"><span class="hs-identifier hs-var">cur</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-1034"></span><span>                                       </span><span id="local-6989586621680953460"><span class="annot"><span class="annottext">ls_ty :: Ty
</span><a href="#local-6989586621680953460"><span class="hs-identifier hs-var hs-var">ls_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#VectorTy"><span class="hs-identifier hs-var">VectorTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty] -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-1035"></span><span>                                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| *( $ty:(codegenTy ls_ty)  *)($id:cur) = $(codegenTriv venv val); |]</span></span><span>
</span><span id="line-1036"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) $id:outV = ($id:cur) + sizeof( $ty:(codegenTy ls_ty) ); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1037"></span><span>
</span><span id="line-1038"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#ReadVector"><span class="hs-identifier hs-var">ReadVector</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953472"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953472"><span class="hs-identifier hs-var">valV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953473"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953473"><span class="hs-identifier hs-var">valTy</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621680953474"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953474"><span class="hs-identifier hs-var">curV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1039"></span><span>                                       </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953475"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953475"><span class="hs-identifier hs-var">cur</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-1040"></span><span>                                       </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy valTy) $id:valV = *( $ty:(codegenTy valTy) *)($id:cur); |]</span></span><span>
</span><span id="line-1041"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) $id:curV = ($id:cur) + sizeof( $ty:(codegenTy valTy)); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1042"></span><span>
</span><span id="line-1043"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#IndirectionBarrier"><span class="hs-identifier hs-type">IndirectionBarrier</span></a></span><span> </span><span id="local-6989586621680953492"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680953492"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1044"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953493"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953493"><span class="hs-identifier hs-var">from_loc</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953494"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953494"><span class="hs-identifier hs-var">end_from_reg</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1045"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953495"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953495"><span class="hs-identifier hs-var">to_loc</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953496"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953496"><span class="hs-identifier hs-var">end_to_reg</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-1046"></span><span>                       </span><span id="local-6989586621680953497"><span class="annot"><span class="annottext">tycon_t :: Id
</span><a href="#local-6989586621680953497"><span class="hs-identifier hs-var hs-var">tycon_t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; SrcLoc -&gt; Id
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Id"><span class="hs-identifier hs-var">C.Id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680953492"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;_T&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1047"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| gib_indirection_barrier($id:from_loc, $id:end_from_reg, $id:to_loc, $id:end_to_reg, $id:tycon_t); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1048"></span><span>
</span><span id="line-1049"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#BoundsCheck"><span class="hs-identifier hs-var">BoundsCheck</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1050"></span><span>                   </span><span id="local-6989586621680953499"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953499"><span class="hs-identifier hs-var">_new_chunk</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;new_chunk&quot;</span></span><span>
</span><span id="line-1051"></span><span>                   </span><span id="local-6989586621680953500"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953500"><span class="hs-identifier hs-var">_chunk_start</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;chunk_start&quot;</span></span><span>
</span><span id="line-1052"></span><span>                   </span><span id="local-6989586621680953501"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953501"><span class="hs-identifier hs-var">_chunk_end</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;chunk_end&quot;</span></span><span>
</span><span id="line-1053"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#IntTriv"><span class="hs-identifier hs-type">IntTriv</span></a></span><span> </span><span id="local-6989586621680953502"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621680953502"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953503"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953503"><span class="hs-identifier hs-var">bound</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953504"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953504"><span class="hs-identifier hs-var">cur</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-1054"></span><span>                       </span><span class="hs-comment">{-
                       bck = [ C.BlockDecl [cdecl| $ty:(codegenTy ChunkTy) $id:new_chunk = gib_grow_region($id:bound); |]
                             , C.BlockDecl [cdecl| $ty:(codegenTy CursorTy) $id:chunk_start = $id:new_chunk.start; |]
                             , C.BlockDecl [cdecl| $ty:(codegenTy CursorTy) $id:chunk_end = $id:new_chunk.end; |]
                             , C.BlockStm  [cstm|  $id:bound = $id:chunk_end; |]
                             , C.BlockStm  [cstm|  *($ty:(codegenTy TagTyPacked) *) ($id:cur) = GIB_REDIRECTION_TAG; |]
                             , C.BlockDecl [cdecl| $ty:(codegenTy CursorTy) redir =  $id:cur + 1; |]
                             , C.BlockStm  [cstm|  *($ty:(codegenTy CursorTy) *) redir = $id:chunk_start; |]
                             , C.BlockStm  [cstm|  $id:cur = $id:chunk_start; |]
                             ]
                   return [ C.BlockStm [cstm| if (($id:cur + $int:i) &gt; $id:bound) { $items:bck }  |] ]
                        -}</span><span>
</span><span id="line-1066"></span><span>                       </span><span id="local-6989586621680953505"><span class="annot"><span class="annottext">bck :: [BlockItem]
</span><a href="#local-6989586621680953505"><span class="hs-identifier hs-var hs-var">bck</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span>  </span><span class="annot"><span class="">[cstm|  gib_grow_region(&amp; $id:cur, &amp; $id:bound); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1067"></span><span>                   </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| if (($id:cur + $int:i) &gt; $id:bound) { $items:bck }  |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1068"></span><span>
</span><span id="line-1069"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#SizeOfPacked"><span class="hs-identifier hs-var">SizeOfPacked</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953507"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953507"><span class="hs-identifier hs-var">sizeV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#IntTy"><span class="hs-identifier hs-var">IntTy</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1070"></span><span>                                     </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953508"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953508"><span class="hs-identifier hs-var">startV</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953509"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953509"><span class="hs-identifier hs-var">endV</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-1071"></span><span>                                 </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-1072"></span><span>                                   </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy IntTy) $id:sizeV = ($ty:(codegenTy IntTy)) $id:endV - $id:startV; |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1073"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#SizeOfScalar"><span class="hs-identifier hs-var">SizeOfScalar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953516"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953516"><span class="hs-identifier hs-var">sizeV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#IntTy"><span class="hs-identifier hs-var">IntTy</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1074"></span><span>                                     </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953517"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953517"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-1075"></span><span>                                 </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-1076"></span><span>                                   </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy IntTy) $id:sizeV = ($ty:(codegenTy IntTy)) sizeof($id:w); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1077"></span><span>
</span><span id="line-1078"></span><span>
</span><span id="line-1079"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#GetFirstWord"><span class="hs-identifier hs-var">GetFirstWord</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1080"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span id="local-6989586621680953524"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953524"><span class="hs-identifier hs-var">ptr</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-1081"></span><span>                  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1082"></span><span>                    </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953525"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953525"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953526"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953526"><span class="hs-identifier hs-var">outTy</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-1083"></span><span>                     </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl|
                            $ty:(codegenTy outTy) $id:outV =
                              * (( $ty:(codegenTy outTy) *) $(codegenTriv venv ptr));
                          |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1087"></span><span>                    </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; PassM [BlockItem]
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; PassM [BlockItem]) -&gt; FilePath -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;wrong number of return bindings from GetFirstWord: &quot;</span></span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">[(Var, Ty)] -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1088"></span><span>
</span><span id="line-1089"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#SizeParam"><span class="hs-identifier hs-var">SizeParam</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953538"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953538"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#IntTy"><span class="hs-identifier hs-var">IntTy</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-1090"></span><span>                      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy IntTy) $id:outV = gib_get_size_param(); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1091"></span><span>
</span><span id="line-1092"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#PrintInt"><span class="hs-identifier hs-var">PrintInt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1093"></span><span>                     </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span id="local-6989586621680953545"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953545"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-1094"></span><span>                     </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1095"></span><span>                       </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953546"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953546"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953547"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953547"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy ty) $id:outV = printf(&quot;%ld&quot;, $(codegenTriv venv arg)); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1096"></span><span>                       </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| printf(&quot;%ld&quot;, $(codegenTriv venv arg)); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1097"></span><span>                       </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; PassM [BlockItem]
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; PassM [BlockItem]) -&gt; FilePath -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;wrong number of return bindings from PrintInt: &quot;</span></span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">[(Var, Ty)] -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1098"></span><span>
</span><span id="line-1099"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#PrintChar"><span class="hs-identifier hs-var">PrintChar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1100"></span><span>                     </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span id="local-6989586621680953554"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953554"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-1101"></span><span>                     </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1102"></span><span>                       </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953555"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953555"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953556"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953556"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy ty) $id:outV = printf(&quot;%c&quot;, $(codegenTriv venv arg)); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1103"></span><span>                       </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| printf(&quot;%c&quot;, $(codegenTriv venv arg)); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1104"></span><span>                       </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; PassM [BlockItem]
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; PassM [BlockItem]) -&gt; FilePath -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;wrong number of return bindings from PrintInt: &quot;</span></span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">[(Var, Ty)] -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1105"></span><span>
</span><span id="line-1106"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#PrintFloat"><span class="hs-identifier hs-var">PrintFloat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1107"></span><span>                     </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span id="local-6989586621680953563"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953563"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-1108"></span><span>                     </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1109"></span><span>                       </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953564"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953564"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953565"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953565"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy ty) $id:outV = printf(&quot;%.2f&quot;, $(codegenTriv venv arg)); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1110"></span><span>                       </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| printf(&quot;%.2f&quot;, $(codegenTriv venv arg)); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1111"></span><span>                       </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; PassM [BlockItem]
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; PassM [BlockItem]) -&gt; FilePath -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;wrong number of return bindings from PrintInt: &quot;</span></span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">[(Var, Ty)] -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1112"></span><span>
</span><span id="line-1113"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#PrintBool"><span class="hs-identifier hs-var">PrintBool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1114"></span><span>                     </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span id="local-6989586621680953572"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953572"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-1115"></span><span>                     </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1116"></span><span>                       </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953573"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953573"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953574"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953574"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy ty) $id:outV = printf(&quot;%d&quot;, $(codegenTriv venv arg)); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1117"></span><span>                       </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| printf(&quot;%d&quot;, $(codegenTriv venv arg)); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1118"></span><span>                       </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; PassM [BlockItem]
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; PassM [BlockItem]) -&gt; FilePath -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;wrong number of return bindings from PrintInt: &quot;</span></span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">[(Var, Ty)] -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1119"></span><span>
</span><span id="line-1120"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#PrintSym"><span class="hs-identifier hs-var">PrintSym</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1121"></span><span>                     </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span id="local-6989586621680953581"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953581"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-1122"></span><span>                     </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1123"></span><span>                       </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953582"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953582"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953583"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953583"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy ty) $id:outV = gib_print_symbol($(codegenTriv venv arg)); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1124"></span><span>                       </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| gib_print_symbol($(codegenTriv venv arg)); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1125"></span><span>                       </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; PassM [BlockItem]
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; PassM [BlockItem]) -&gt; FilePath -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;wrong number of return bindings from PrintSym: &quot;</span></span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">[(Var, Ty)] -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1126"></span><span>
</span><span id="line-1127"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#PrintString"><span class="hs-identifier hs-type">PrintString</span></a></span><span> </span><span id="local-6989586621680953590"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680953590"><span class="hs-identifier hs-var">str</span></a></span></span><span>
</span><span id="line-1128"></span><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| printf( $string:str ); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1129"></span><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; PassM [BlockItem]
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span class="annot"><span class="annottext">(FilePath -&gt; PassM [BlockItem]) -&gt; FilePath -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;wrong number of args/return values expected from PrintString prim: &quot;</span></span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">([Triv], [(Var, Ty)]) -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1130"></span><span>
</span><span id="line-1131"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#WritePackedFile"><span class="hs-identifier hs-type">WritePackedFile</span></a></span><span> </span><span id="local-6989586621680953592"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680953592"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621680953593"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680953593"><span class="hs-identifier hs-var">tyc</span></a></span></span><span>
</span><span id="line-1132"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span id="local-6989586621680953594"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953594"><span class="hs-identifier hs-var">inV</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1133"></span><span>                        </span><span class="hs-comment">-- Inputs to the copy function.</span><span>
</span><span id="line-1134"></span><span>                        </span><span id="local-6989586621680953595"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953595"><span class="hs-identifier hs-var">outreg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;outreg&quot;</span></span><span>
</span><span id="line-1135"></span><span>                        </span><span id="local-6989586621680953596"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953596"><span class="hs-identifier hs-var">start_outreg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;start_outreg&quot;</span></span><span>
</span><span id="line-1136"></span><span>                        </span><span id="local-6989586621680953597"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953597"><span class="hs-identifier hs-var">end_outreg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;end_outreg&quot;</span></span><span>
</span><span id="line-1137"></span><span>                        </span><span id="local-6989586621680953598"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953598"><span class="hs-identifier hs-var">end_inreg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;end_inreg&quot;</span></span><span>
</span><span id="line-1138"></span><span>                        </span><span class="hs-comment">-- Output from the copy function.</span><span>
</span><span id="line-1139"></span><span>                        </span><span id="local-6989586621680953599"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953599"><span class="hs-identifier hs-var">end_outreg2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;end_outreg2&quot;</span></span><span>
</span><span id="line-1140"></span><span>                        </span><span id="local-6989586621680953600"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953600"><span class="hs-identifier hs-var">end_inreg2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;end_inreg2&quot;</span></span><span>
</span><span id="line-1141"></span><span>                        </span><span id="local-6989586621680953601"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953601"><span class="hs-identifier hs-var">copy_start</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;copy_start&quot;</span></span><span>
</span><span id="line-1142"></span><span>                        </span><span id="local-6989586621680953602"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953602"><span class="hs-identifier hs-var">copy_end</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;copy_end&quot;</span></span><span>
</span><span id="line-1143"></span><span>                        </span><span id="local-6989586621680953603"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953603"><span class="hs-identifier hs-var">copy_size</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;copy_size&quot;</span></span><span>
</span><span id="line-1144"></span><span>                        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680953604"><span class="annot"><span class="annottext">rnds2 :: [Triv]
</span><a href="#local-6989586621680953604"><span class="hs-identifier hs-var hs-var">rnds2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Triv
</span><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-var">VarTriv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953598"><span class="hs-identifier hs-var">end_inreg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Triv
</span><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-var">VarTriv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953597"><span class="hs-identifier hs-var">end_outreg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Triv
</span><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-var">VarTriv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953596"><span class="hs-identifier hs-var">start_outreg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953594"><span class="hs-identifier hs-var">inV</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1145"></span><span>                            </span><span id="local-6989586621680953605"><span class="annot"><span class="annottext">bnds2 :: [(Var, Ty)]
</span><a href="#local-6989586621680953605"><span class="hs-identifier hs-var hs-var">bnds2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953599"><span class="hs-identifier hs-var">end_outreg2</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953600"><span class="hs-identifier hs-var">end_inreg2</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953601"><span class="hs-identifier hs-var">copy_start</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953602"><span class="hs-identifier hs-var">copy_end</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1146"></span><span>                        </span><span id="local-6989586621680953606"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680953606"><span class="hs-identifier hs-var">call_copyfn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952781"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952782"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952783"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; [(Var, Ty)] -&gt; Var -&gt; [Triv] -&gt; Tail -&gt; Tail
</span><a href="Gibbon.L4.Syntax.html#LetCallT"><span class="hs-identifier hs-var">LetCallT</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680953605"><span class="hs-identifier hs-var">bnds2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Var
</span><a href="Gibbon.Language.Constants.html#mkCopySansPtrsFunName"><span class="hs-identifier hs-var">GL.mkCopySansPtrsFunName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680953593"><span class="hs-identifier hs-var">tyc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680953604"><span class="hs-identifier hs-var">rnds2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, Ty, Triv)] -&gt; Maybe Tail -&gt; Tail
</span><a href="Gibbon.L4.Syntax.html#AssnValsT"><span class="hs-identifier hs-var">AssnValsT</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe Tail
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty] -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952789"><span class="hs-identifier hs-var">sync_deps</span></a></span><span>
</span><span id="line-1147"></span><span>                        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680953608"><span class="annot"><span class="annottext">tyfile :: Type
</span><a href="#local-6989586621680953608"><span class="hs-identifier hs-var hs-var">tyfile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty| typename FILE |]</span></span><span>
</span><span id="line-1148"></span><span>                            </span><span id="local-6989586621680953609"><span class="annot"><span class="annottext">tysize :: Type
</span><a href="#local-6989586621680953609"><span class="hs-identifier hs-var hs-var">tysize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty| typename size_t |]</span></span><span>
</span><span id="line-1149"></span><span>                        </span><span id="local-6989586621680953610"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953610"><span class="hs-identifier hs-var">out_hdl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;out_hdl&quot;</span></span><span>
</span><span id="line-1150"></span><span>                        </span><span id="local-6989586621680953611"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953611"><span class="hs-identifier hs-var">wrote</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;wrote&quot;</span></span><span>
</span><span id="line-1151"></span><span>                        </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1152"></span><span>                           </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680952797"><span class="hs-identifier hs-var">genGC</span></a></span><span>
</span><span id="line-1153"></span><span>                            </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy RegionTy) $id:outreg = gib_alloc_region_on_heap(gib_get_biginf_init_chunk_size()); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1154"></span><span>                            </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy RegionTy) $id:outreg = gib_alloc_region_on_heap(gib_get_biginf_init_chunk_size()); |]</span></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-1155"></span><span>                               </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) $id:start_outreg = $id:outreg.start; |]</span></span><span>
</span><span id="line-1156"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) $id:end_outreg = $id:outreg.end; |]</span></span><span>
</span><span id="line-1157"></span><span>                                 </span><span class="hs-comment">-- This would ideally be the *end* of the input region corresponding to inV</span><span>
</span><span id="line-1158"></span><span>                                 </span><span class="hs-comment">-- but we have don't have at hand here. Passing in NULL is okay because this pointer</span><span>
</span><span id="line-1159"></span><span>                                 </span><span class="hs-comment">-- is unused in the copy function.</span><span>
</span><span id="line-1160"></span><span>                                 </span><span class="hs-comment">-- To get the actual end of the input region, we'll have to encode WritePackedFile as an</span><span>
</span><span id="line-1161"></span><span>                                 </span><span class="hs-comment">-- expression (instead of a PrimAppE), and add the appropriate code in ThreadRegions.hs.</span><span>
</span><span id="line-1162"></span><span>                                 </span><span class="hs-comment">-- Sticking with the hacky and less invasive approach for now.</span><span>
</span><span id="line-1163"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) $id:end_inreg = NULL; |]</span></span><span>
</span><span id="line-1164"></span><span>                               </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680953606"><span class="hs-identifier hs-var">call_copyfn</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-1165"></span><span>                               </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:tyfile *$id:out_hdl = fopen($string:fp, &quot;wb&quot;); |]</span></span><span>
</span><span id="line-1166"></span><span>                               </span><span class="hs-comment">-- , _todo</span><span>
</span><span id="line-1167"></span><span>                               </span><span class="hs-comment">-- , _todo</span><span>
</span><span id="line-1168"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:tysize $id:copy_size = ($ty:(codegenTy IntTy)) ($id:copy_end - $id:copy_start); |]</span></span><span>
</span><span id="line-1169"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:tysize $id:wrote = fwrite($id:copy_start, $id:copy_size, 1, $id:out_hdl); |]</span></span><span>
</span><span id="line-1170"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| fclose($id:out_hdl); |]</span></span><span>
</span><span id="line-1171"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| printf(&quot;Wrote: %s\n&quot;, $string:fp); |]</span></span><span>
</span><span id="line-1172"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| gib_free_region($id:end_outreg); |]</span></span><span>
</span><span id="line-1173"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| free($id:outreg); |]</span></span><span>
</span><span id="line-1174"></span><span>                               </span><span class="hs-special">]</span><span>
</span><span id="line-1175"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; PassM [BlockItem]
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; PassM [BlockItem]) -&gt; FilePath -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;WritePackedFile, wrong arguments &quot;</span></span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">[Triv] -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;, or expected bindings &quot;</span></span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">[(Var, Ty)] -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1176"></span><span>
</span><span id="line-1177"></span><span>                 </span><span class="hs-comment">-- FINISHME: Codegen here depends on whether we are in --packed mode or not.</span><span>
</span><span id="line-1178"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#ReadPackedFile"><span class="hs-identifier hs-type">ReadPackedFile</span></a></span><span> </span><span id="local-6989586621680953653"><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621680953653"><span class="hs-identifier hs-var">mfile</span></a></span></span><span> </span><span id="local-6989586621680953654"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680953654"><span class="hs-identifier hs-var">tyc</span></a></span></span><span>
</span><span id="line-1179"></span><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953655"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953655"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953656"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953656"><span class="hs-identifier hs-var">_outT</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1180"></span><span>                             </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680953657"><span class="annot"><span class="annottext">filename :: Exp
</span><a href="#local-6989586621680953657"><span class="hs-identifier hs-var hs-var">filename</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="#local-6989586621680953653"><span class="hs-identifier hs-var">mfile</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1181"></span><span>                                              </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680953658"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680953658"><span class="hs-identifier hs-var">f</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="">[cexp| $string:f |]</span></span><span> </span><span class="hs-comment">-- Fixed at compile time.</span><span>
</span><span id="line-1182"></span><span>                                              </span><span class="annot"><span class="annottext">Maybe FilePath
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="">[cexp| gib_read_benchfile_param() |]</span></span><span> </span><span class="hs-comment">-- Will be set by command line arg.</span><span>
</span><span id="line-1183"></span><span>                                 </span><span id="local-6989586621680953659"><span class="annot"><span class="annottext">unpackName :: Var
</span><a href="#local-6989586621680953659"><span class="hs-identifier hs-var hs-var">unpackName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Var
</span><a href="Gibbon.Language.Constants.html#mkUnpackerName"><span class="hs-identifier hs-var">GL.mkUnpackerName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680953654"><span class="hs-identifier hs-var">tyc</span></a></span><span>
</span><span id="line-1184"></span><span>                                 </span><span id="local-6989586621680953661"><span class="annot"><span class="annottext">unpackcall :: Tail
</span><a href="#local-6989586621680953661"><span class="hs-identifier hs-var hs-var">unpackcall</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; [(Var, Ty)] -&gt; Var -&gt; [Triv] -&gt; Tail -&gt; Tail
</span><a href="Gibbon.L4.Syntax.html#LetCallT"><span class="hs-identifier hs-var">LetCallT</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953655"><span class="hs-identifier hs-var">outV</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#PtrTy"><span class="hs-identifier hs-var">PtrTy</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;junk&quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1185"></span><span>                                                    </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953659"><span class="hs-identifier hs-var">unpackName</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Triv
</span><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-var">VarTriv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;ptr&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, Ty, Triv)] -&gt; Maybe Tail -&gt; Tail
</span><a href="Gibbon.L4.Syntax.html#AssnValsT"><span class="hs-identifier hs-var">AssnValsT</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe Tail
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1186"></span><span>
</span><span id="line-1187"></span><span>                                 </span><span id="local-6989586621680953662"><span class="annot"><span class="annottext">mmap_size :: Var
</span><a href="#local-6989586621680953662"><span class="hs-identifier hs-var hs-var">mmap_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Var
</span><a href="Gibbon.Common.html#varAppend"><span class="hs-identifier hs-var">varAppend</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953655"><span class="hs-identifier hs-var">outV</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;_size&quot;</span></span><span>
</span><span id="line-1188"></span><span>
</span><span id="line-1189"></span><span>                                 </span><span id="local-6989586621680953663"><span class="annot"><span class="annottext">mmapCode :: [BlockItem]
</span><a href="#local-6989586621680953663"><span class="hs-identifier hs-var hs-var">mmapCode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1190"></span><span>                                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span class="annot"><span class="">[cdecl| int fd = open( $filename, O_RDONLY); |]</span></span><span>
</span><span id="line-1191"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span class="annot"><span class="">[cstm| { if(fd == -1) { fprintf(stderr,&quot;fopen failed\n&quot;); abort(); }} |]</span></span><span>
</span><span id="line-1192"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span class="annot"><span class="">[cdecl| struct stat st; |]</span></span><span>
</span><span id="line-1193"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span>  </span><span class="annot"><span class="">[cstm| fstat(fd, &amp;st); |]</span></span><span>
</span><span id="line-1194"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy IntTy) $id:mmap_size = st.st_size;|]</span></span><span>
</span><span id="line-1195"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) ptr = ($ty:(codegenTy CursorTy)) mmap(0,st.st_size,PROT_READ,MAP_PRIVATE,fd,0); |]</span></span><span>
</span><span id="line-1196"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span class="annot"><span class="">[cstm| { if(ptr==MAP_FAILED) { fprintf(stderr,&quot;mmap failed\n&quot;); abort(); }} |]</span></span><span>
</span><span id="line-1197"></span><span>                                  </span><span class="hs-special">]</span><span>
</span><span id="line-1198"></span><span>                             </span><span id="local-6989586621680953675"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680953675"><span class="hs-identifier hs-var">docall</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680952794"><span class="hs-identifier hs-var">isPacked</span></a></span><span>
</span><span id="line-1199"></span><span>                                       </span><span class="hs-comment">-- In packed mode we eagerly FORCE the IO to happen before we start benchmarking:</span><span>
</span><span id="line-1200"></span><span>                                       </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| { int sum=0; for(int i=0; i &lt; st.st_size; i++) sum += ptr[i]; } |]</span></span><span>
</span><span id="line-1201"></span><span>                                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CursorTy) $id:outV = ptr; |]</span></span><span class="hs-special">]</span><span>
</span><span id="line-1202"></span><span>                                       </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952781"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680952782"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680952783"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680953661"><span class="hs-identifier hs-var">unpackcall</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#voidTy"><span class="hs-identifier hs-var">voidTy</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952789"><span class="hs-identifier hs-var">sync_deps</span></a></span><span>
</span><span id="line-1203"></span><span>                             </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680953663"><span class="hs-identifier hs-var">mmapCode</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680953675"><span class="hs-identifier hs-var">docall</span></a></span><span>
</span><span id="line-1204"></span><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; PassM [BlockItem]
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; PassM [BlockItem]) -&gt; FilePath -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;ReadPackedFile, wrong arguments &quot;</span></span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">[Triv] -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;, or expected bindings &quot;</span></span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">[(Var, Ty)] -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1205"></span><span>
</span><span id="line-1206"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#ReadArrayFile"><span class="hs-identifier hs-type">ReadArrayFile</span></a></span><span> </span><span id="local-6989586621680953682"><span class="annot"><span class="annottext">Maybe (FilePath, Int)
</span><a href="#local-6989586621680953682"><span class="hs-identifier hs-var">mfile</span></a></span></span><span> </span><span id="local-6989586621680953683"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953683"><span class="hs-identifier hs-var">ty</span></a></span></span><span>
</span><span id="line-1207"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953684"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953684"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953685"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953685"><span class="hs-identifier hs-var">_outT</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1208"></span><span>                           </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680953686"><span class="annot"><span class="annottext">parse_in_c :: Ty -&gt; FilePath
</span><a href="#local-6989586621680953686"><span class="hs-identifier hs-var hs-var">parse_in_c</span></a></span></span><span> </span><span id="local-6989586621680953687"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953687"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953687"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1209"></span><span>                                                </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#IntTy"><span class="hs-identifier hs-var">IntTy</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;%ld&quot;</span></span><span>
</span><span id="line-1210"></span><span>                                                </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#FloatTy"><span class="hs-identifier hs-var">FloatTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;%f&quot;</span></span><span>
</span><span id="line-1211"></span><span>                                                </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CharTy"><span class="hs-identifier hs-var">CharTy</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;%c&quot;</span></span><span>
</span><span id="line-1212"></span><span>                                                </span><span class="annot"><span class="annottext">Ty
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; FilePath -&gt; FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;ReadArrayFile: Lists of type &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; FilePath
forall a. Out a =&gt; a -&gt; FilePath
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953683"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot; not allowed.&quot;</span></span><span>
</span><span id="line-1213"></span><span>
</span><span id="line-1214"></span><span>                           </span><span id="local-6989586621680953689"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953689"><span class="hs-identifier hs-var">elem</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;arr_elem&quot;</span></span><span>
</span><span id="line-1215"></span><span>                           </span><span id="local-6989586621680953690"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953690"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;fp&quot;</span></span><span>
</span><span id="line-1216"></span><span>                           </span><span id="local-6989586621680953691"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953691"><span class="hs-identifier hs-var">line</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;line&quot;</span></span><span>
</span><span id="line-1217"></span><span>                           </span><span id="local-6989586621680953692"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953692"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;len&quot;</span></span><span>
</span><span id="line-1218"></span><span>                           </span><span id="local-6989586621680953693"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953693"><span class="hs-identifier hs-var">read</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;read&quot;</span></span><span>
</span><span id="line-1219"></span><span>                           </span><span id="local-6989586621680953694"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953694"><span class="hs-identifier hs-var">line_num</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;i&quot;</span></span><span>
</span><span id="line-1220"></span><span>
</span><span id="line-1221"></span><span>                           </span><span class="hs-special">(</span><span id="local-6989586621680953695"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680953695"><span class="hs-identifier hs-var">tmps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680953696"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621680953696"><span class="hs-identifier hs-var">tmps_parsers</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680953697"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680953697"><span class="hs-identifier hs-var">tmps_assns</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680953698"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680953698"><span class="hs-identifier hs-var">tmps_decls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-1222"></span><span>                                 </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953683"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1223"></span><span>                                     </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#IntTy"><span class="hs-identifier hs-var">IntTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1224"></span><span>                                       </span><span id="local-6989586621680953699"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953699"><span class="hs-identifier hs-var">one</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;tmp&quot;</span></span><span>
</span><span id="line-1225"></span><span>                                       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680953700"><span class="annot"><span class="annottext">assn :: BlockItem
</span><a href="#local-6989586621680953700"><span class="hs-identifier hs-var hs-var">assn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| $id:elem = $id:one ; |]</span></span><span>
</span><span id="line-1226"></span><span>                                       </span><span class="annot"><span class="annottext">([Var], [FilePath], [BlockItem], [BlockItem])
-&gt; PassM ([Var], [FilePath], [BlockItem], [BlockItem])
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953699"><span class="hs-identifier hs-var">one</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Ty -&gt; FilePath
</span><a href="#local-6989586621680953686"><span class="hs-identifier hs-var">parse_in_c</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953683"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">BlockItem
</span><a href="#local-6989586621680953700"><span class="hs-identifier hs-var">assn</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy IntTy) $id:one; |]</span></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1227"></span><span>                                     </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#FloatTy"><span class="hs-identifier hs-var">FloatTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1228"></span><span>                                       </span><span id="local-6989586621680953706"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953706"><span class="hs-identifier hs-var">one</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;tmp&quot;</span></span><span>
</span><span id="line-1229"></span><span>                                       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680953707"><span class="annot"><span class="annottext">assn :: BlockItem
</span><a href="#local-6989586621680953707"><span class="hs-identifier hs-var hs-var">assn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| $id:elem = $id:one ; |]</span></span><span>
</span><span id="line-1230"></span><span>                                       </span><span class="annot"><span class="annottext">([Var], [FilePath], [BlockItem], [BlockItem])
-&gt; PassM ([Var], [FilePath], [BlockItem], [BlockItem])
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953706"><span class="hs-identifier hs-var">one</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Ty -&gt; FilePath
</span><a href="#local-6989586621680953686"><span class="hs-identifier hs-var">parse_in_c</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953683"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">BlockItem
</span><a href="#local-6989586621680953707"><span class="hs-identifier hs-var">assn</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy FloatTy) $id:one; |]</span></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1231"></span><span>                                     </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CharTy"><span class="hs-identifier hs-var">CharTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1232"></span><span>                                       </span><span id="local-6989586621680953713"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953713"><span class="hs-identifier hs-var">one</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;tmp&quot;</span></span><span>
</span><span id="line-1233"></span><span>                                       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680953714"><span class="annot"><span class="annottext">assn :: BlockItem
</span><a href="#local-6989586621680953714"><span class="hs-identifier hs-var hs-var">assn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| $id:elem = $id:one ; |]</span></span><span>
</span><span id="line-1234"></span><span>                                       </span><span class="annot"><span class="annottext">([Var], [FilePath], [BlockItem], [BlockItem])
-&gt; PassM ([Var], [FilePath], [BlockItem], [BlockItem])
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953713"><span class="hs-identifier hs-var">one</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Ty -&gt; FilePath
</span><a href="#local-6989586621680953686"><span class="hs-identifier hs-var">parse_in_c</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953683"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">BlockItem
</span><a href="#local-6989586621680953714"><span class="hs-identifier hs-var">assn</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CharTy) $id:one; |]</span></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1235"></span><span>                                     </span><span class="annot"><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680953720"><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680953720"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1236"></span><span>                                       </span><span id="local-6989586621680953721"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680953721"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Ty -&gt; PassM Var) -&gt; [Ty] -&gt; PassM [Var]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Ty
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;tmp&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680953720"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1237"></span><span>                                       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680953722"><span class="annot"><span class="annottext">decls :: [BlockItem]
</span><a href="#local-6989586621680953722"><span class="hs-identifier hs-var hs-var">decls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Var, Ty) -&gt; BlockItem) -&gt; [(Var, Ty)] -&gt; [BlockItem]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680953723"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953723"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680953724"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953724"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy t) $id:name; |]</span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; [Ty] -&gt; [(Var, Ty)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680953721"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680953720"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1238"></span><span>                                           </span><span id="local-6989586621680953730"><span class="annot"><span class="annottext">parsers :: [FilePath]
</span><a href="#local-6989586621680953730"><span class="hs-identifier hs-var hs-var">parsers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Ty -&gt; FilePath) -&gt; [Ty] -&gt; [FilePath]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; FilePath
</span><a href="#local-6989586621680953686"><span class="hs-identifier hs-var">parse_in_c</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680953720"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1239"></span><span>                                           </span><span id="local-6989586621680953731"><span class="annot"><span class="annottext">assns :: [BlockItem]
</span><a href="#local-6989586621680953731"><span class="hs-identifier hs-var hs-var">assns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Var, Integer) -&gt; BlockItem) -&gt; [(Var, Integer)] -&gt; [BlockItem]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680953732"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953732"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680953733"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680953733"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1240"></span><span>                                                           </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680953734"><span class="annot"><span class="annottext">field :: FilePath
</span><a href="#local-6989586621680953734"><span class="hs-identifier hs-var hs-var">field</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;field&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680953733"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1241"></span><span>                                                           </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| $id:elem.$id:field = $id:v; |]</span></span><span class="hs-special">)</span><span>
</span><span id="line-1242"></span><span>                                                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; [Integer] -&gt; [(Var, Integer)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680953721"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1243"></span><span>                                       </span><span class="annot"><span class="annottext">([Var], [FilePath], [BlockItem], [BlockItem])
-&gt; PassM ([Var], [FilePath], [BlockItem], [BlockItem])
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680953721"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621680953730"><span class="hs-identifier hs-var">parsers</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680953731"><span class="hs-identifier hs-var">assns</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680953722"><span class="hs-identifier hs-var">decls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1244"></span><span>                                     </span><span class="annot"><span class="annottext">Ty
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; PassM ([Var], [FilePath], [BlockItem], [BlockItem])
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; PassM ([Var], [FilePath], [BlockItem], [BlockItem]))
-&gt; FilePath -&gt; PassM ([Var], [FilePath], [BlockItem], [BlockItem])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;ReadArrayFile: Lists of type &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; FilePath
forall a. Out a =&gt; a -&gt; FilePath
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953683"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot; not allowed.&quot;</span></span><span>
</span><span id="line-1245"></span><span>
</span><span id="line-1246"></span><span>                           </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680953735"><span class="annot"><span class="annottext">scanf_vars :: [Exp]
</span><a href="#local-6989586621680953735"><span class="hs-identifier hs-var hs-var">scanf_vars</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; Exp) -&gt; [Var] -&gt; [Exp]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680953736"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953736"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="">[cexp| &amp;($id:v) |]</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680953695"><span class="hs-identifier hs-var">tmps</span></a></span><span>
</span><span id="line-1247"></span><span>                               </span><span id="local-6989586621680953737"><span class="annot"><span class="annottext">scanf_line :: Exp
</span><a href="#local-6989586621680953737"><span class="hs-identifier hs-var hs-var">scanf_line</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cexp| $id:line |]</span></span><span>
</span><span id="line-1248"></span><span>                               </span><span id="local-6989586621680953738"><span class="annot"><span class="annottext">scanf_format :: Exp
</span><a href="#local-6989586621680953738"><span class="hs-identifier hs-var hs-var">scanf_format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cexp| $string:(L.intercalate &quot; &quot; tmps_parsers) |]</span></span><span>
</span><span id="line-1249"></span><span>                               </span><span id="local-6989586621680953742"><span class="annot"><span class="annottext">scanf_rator :: Exp
</span><a href="#local-6989586621680953742"><span class="hs-identifier hs-var hs-var">scanf_rator</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; SrcLoc -&gt; Exp
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Var"><span class="hs-identifier hs-var">C.Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; SrcLoc -&gt; Id
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Id"><span class="hs-identifier hs-var">C.Id</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;sscanf&quot;</span></span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span>
</span><span id="line-1250"></span><span>                               </span><span id="local-6989586621680953743"><span class="annot"><span class="annottext">scanf :: Exp
</span><a href="#local-6989586621680953743"><span class="hs-identifier hs-var hs-var">scanf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Exp] -&gt; SrcLoc -&gt; Exp
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#FnCall"><span class="hs-identifier hs-var">C.FnCall</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680953742"><span class="hs-identifier hs-var">scanf_rator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680953737"><span class="hs-identifier hs-var">scanf_line</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Exp] -&gt; [Exp]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680953738"><span class="hs-identifier hs-var">scanf_format</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; [Exp] -&gt; [Exp]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp]
</span><a href="#local-6989586621680953735"><span class="hs-identifier hs-var">scanf_vars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span>
</span><span id="line-1251"></span><span>
</span><span id="line-1252"></span><span>                           </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680953744"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680953744"><span class="hs-identifier hs-var">filename</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680953745"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680953745"><span class="hs-identifier hs-var">filelength</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (FilePath, Int)
</span><a href="#local-6989586621680953682"><span class="hs-identifier hs-var">mfile</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1253"></span><span>                                            </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680953746"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680953746"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680953747"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680953747"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="">[cexp| $string:f |]</span></span><span>
</span><span id="line-1254"></span><span>                                                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="">[cexp| $int:i |]</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Fixed at compile time.</span><span>
</span><span id="line-1255"></span><span>                                            </span><span class="annot"><span class="annottext">Maybe (FilePath, Int)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="">[cexp| gib_read_arrayfile_param() |]</span></span><span>
</span><span id="line-1256"></span><span>                                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="">[cexp| gib_read_arrayfile_length_param() |]</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Will be set by command line arg.</span><span>
</span><span id="line-1257"></span><span>
</span><span id="line-1258"></span><span>                           </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1259"></span><span>                                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy (VectorTy ty)) ($id:outV) = gib_vector_alloc($filelength, sizeof($ty:(codegenTy ty))); |]</span></span><span>
</span><span id="line-1260"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy ty) $id:elem; |]</span></span><span>
</span><span id="line-1261"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span>  </span><span class="annot"><span class="">[cstm| FILE *($id:fp); |]</span></span><span>
</span><span id="line-1262"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| char *($id:line) = NULL; |]</span></span><span>
</span><span id="line-1263"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| size_t ($id:len); |]</span></span><span>
</span><span id="line-1264"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| $id:len = 0; |]</span></span><span>
</span><span id="line-1265"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| ssize_t ($id:read); |]</span></span><span>
</span><span id="line-1266"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| $id:fp = fopen( $filename, &quot;r&quot;); |]</span></span><span>
</span><span id="line-1267"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| { if($id:fp == NULL) { fprintf(stderr,&quot;fopen failed\n&quot;); abort(); }} |]</span></span><span>
</span><span id="line-1268"></span><span>                                  </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680953698"><span class="hs-identifier hs-var">tmps_decls</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-1269"></span><span>                                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy IntTy) $id:line_num = 0; |]</span></span><span>
</span><span id="line-1270"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| while(($id:read = getline(&amp;($id:line), &amp;($id:len), $id:fp)) != -1) {
                                                      int xxxx = $scanf;
                                                      $items:tmps_assns
                                                      gib_vector_inplace_update($id:outV, $id:line_num, &amp;($id:elem));
                                                      $id:line_num++;
                                                    } |]</span></span><span>
</span><span id="line-1276"></span><span>                                  </span><span class="hs-special">]</span><span>
</span><span id="line-1277"></span><span>
</span><span id="line-1278"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; PassM [BlockItem]
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; PassM [BlockItem]) -&gt; FilePath -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;ReadPackedFile, wrong arguments &quot;</span></span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">[Triv] -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;, or expected bindings &quot;</span></span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">[(Var, Ty)] -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1279"></span><span>
</span><span id="line-1280"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#MMapFileSize"><span class="hs-identifier hs-type">MMapFileSize</span></a></span><span> </span><span id="local-6989586621680953765"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953765"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1281"></span><span>                       </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953766"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953766"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#IntTy"><span class="hs-identifier hs-var">IntTy</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1282"></span><span>                           </span><span class="hs-comment">-- Must match with mmap_size set by ReadPackedFile</span><span>
</span><span id="line-1283"></span><span>                           </span><span id="local-6989586621680953767"><span class="annot"><span class="annottext">mmap_size :: Var
</span><a href="#local-6989586621680953767"><span class="hs-identifier hs-var hs-var">mmap_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Var
</span><a href="Gibbon.Common.html#varAppend"><span class="hs-identifier hs-var">varAppend</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953765"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;_size&quot;</span></span><span>
</span><span id="line-1284"></span><span>                       </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span class="annot"><span class="">[cdecl| $ty:(codegenTy IntTy) $id:outV = $id:mmap_size; |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1285"></span><span>
</span><span id="line-1286"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#ParSync"><span class="hs-identifier hs-var">ParSync</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1287"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680953773"><span class="annot"><span class="annottext">e :: Exp
</span><a href="#local-6989586621680953773"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cexp| cilk_sync |]</span></span><span>
</span><span id="line-1288"></span><span>                    </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| $exp:e; |]</span></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Var, BlockItem) -&gt; BlockItem) -&gt; SyncDeps -&gt; [BlockItem]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, BlockItem) -&gt; BlockItem
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680952789"><span class="hs-identifier hs-var">sync_deps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1289"></span><span>
</span><span id="line-1290"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#GetCilkWorkerNum"><span class="hs-identifier hs-var">GetCilkWorkerNum</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1291"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953775"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953775"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#IntTy"><span class="hs-identifier hs-var">IntTy</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1292"></span><span>                   </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| int $id:outV = __cilkrts_get_worker_number(); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1293"></span><span>
</span><span id="line-1294"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#IsBig"><span class="hs-identifier hs-var">IsBig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1295"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953777"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953777"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#BoolTy"><span class="hs-identifier hs-var">BoolTy</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1296"></span><span>                       </span><span class="hs-comment">-- [i,arg] = rnds</span><span>
</span><span id="line-1297"></span><span>                       </span><span class="hs-comment">-- e = [cexp| gib_is_big($(codegenTriv venv i), $(codegenTriv venv arg)) |]</span><span>
</span><span id="line-1298"></span><span>                       </span><span id="local-6989586621680953779"><span class="annot"><span class="annottext">e :: Exp
</span><a href="#local-6989586621680953779"><span class="hs-identifier hs-var hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cexp| false |]</span></span><span>
</span><span id="line-1299"></span><span>                   </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy BoolTy) $id:outV = $exp:e; |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1300"></span><span>
</span><span id="line-1301"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#Gensym"><span class="hs-identifier hs-var">Gensym</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1302"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953786"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953786"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#SymTy"><span class="hs-identifier hs-var">SymTy</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1303"></span><span>                   </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy SymTy) $id:outV = gib_gensym(); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1304"></span><span>
</span><span id="line-1305"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#FreeSymTable"><span class="hs-identifier hs-var">FreeSymTable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| gib_free_symtable(); |]</span></span><span class="hs-special">]</span><span>
</span><span id="line-1306"></span><span>
</span><span id="line-1307"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VAllocP"><span class="hs-identifier hs-type">VAllocP</span></a></span><span> </span><span id="local-6989586621680953794"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953794"><span class="hs-identifier hs-var">elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1308"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680953795"><span class="annot"><span class="annottext">ty1 :: Type
</span><a href="#local-6989586621680953795"><span class="hs-identifier hs-var hs-var">ty1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Type
</span><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#VectorTy"><span class="hs-identifier hs-var">VectorTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953794"><span class="hs-identifier hs-var">elty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1309"></span><span>                       </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953796"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953796"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1310"></span><span>                       </span><span class="hs-special">[</span><span id="local-6989586621680953797"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953797"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-1311"></span><span>                       </span><span id="local-6989586621680953798"><span class="annot"><span class="annottext">i' :: Exp
</span><a href="#local-6989586621680953798"><span class="hs-identifier hs-var hs-var">i'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VEnv -&gt; Triv -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#codegenTriv"><span class="hs-identifier hs-var">codegenTriv</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952781"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953797"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1312"></span><span>                   </span><span id="local-6989586621680953799"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953799"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;tmp&quot;</span></span><span>
</span><span id="line-1313"></span><span>                   </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy IntTy) $id:tmp = sizeof( $ty:(codegenTy elty)); |]</span></span><span>
</span><span id="line-1314"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:ty1 $id:outV = gib_vector_alloc($exp:i', $id:tmp); |]</span></span><span>
</span><span id="line-1315"></span><span>                          </span><span class="hs-special">]</span><span>
</span><span id="line-1316"></span><span>
</span><span id="line-1317"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VFreeP"><span class="hs-identifier hs-type">VFreeP</span></a></span><span> </span><span id="local-6989586621680953810"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953810"><span class="hs-identifier hs-var">_elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1318"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span id="local-6989586621680953811"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953811"><span class="hs-identifier hs-var">vec</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-1319"></span><span>                   </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| gib_vector_free($(codegenTriv venv vec)); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1320"></span><span>
</span><span id="line-1321"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VFree2P"><span class="hs-identifier hs-type">VFree2P</span></a></span><span> </span><span id="local-6989586621680953812"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953812"><span class="hs-identifier hs-var">_elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1322"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span id="local-6989586621680953813"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953813"><span class="hs-identifier hs-var">vec</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-1323"></span><span>                   </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| free($(codegenTriv venv vec)); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1324"></span><span>
</span><span id="line-1325"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VNthP"><span class="hs-identifier hs-type">VNthP</span></a></span><span> </span><span id="local-6989586621680953814"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953814"><span class="hs-identifier hs-var">elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1326"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680953815"><span class="annot"><span class="annottext">ty1 :: Type
</span><a href="#local-6989586621680953815"><span class="hs-identifier hs-var hs-var">ty1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Type
</span><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953814"><span class="hs-identifier hs-var">elty</span></a></span><span>
</span><span id="line-1327"></span><span>                       </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953816"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953816"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1328"></span><span>                       </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953817"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953817"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680953818"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953818"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-1329"></span><span>                       </span><span id="local-6989586621680953819"><span class="annot"><span class="annottext">i' :: Exp
</span><a href="#local-6989586621680953819"><span class="hs-identifier hs-var hs-var">i'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VEnv -&gt; Triv -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#codegenTriv"><span class="hs-identifier hs-var">codegenTriv</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952781"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953818"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1330"></span><span>                   </span><span id="local-6989586621680953820"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953820"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;tmp&quot;</span></span><span>
</span><span id="line-1331"></span><span>                   </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:ty1 *($id:tmp); |]</span></span><span>
</span><span id="line-1332"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span>  </span><span class="annot"><span class="">[cstm| $id:tmp = ($ty:ty1 *) gib_vector_nth($id:ls,$exp:i'); |]</span></span><span>
</span><span id="line-1333"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:ty1 $id:outV = *($id:tmp); |]</span></span><span>
</span><span id="line-1334"></span><span>                          </span><span class="hs-special">]</span><span>
</span><span id="line-1335"></span><span>
</span><span id="line-1336"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VLengthP"><span class="hs-identifier hs-type">VLengthP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1337"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953836"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953836"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#IntTy"><span class="hs-identifier hs-var">IntTy</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1338"></span><span>                       </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953837"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953837"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-1339"></span><span>                   </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy IntTy) $id:v = gib_vector_length($id:ls); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1340"></span><span>
</span><span id="line-1341"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#InplaceVUpdateP"><span class="hs-identifier hs-type">InplaceVUpdateP</span></a></span><span> </span><span id="local-6989586621680953843"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953843"><span class="hs-identifier hs-var">elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1342"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953844"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953844"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1343"></span><span>                       </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953845"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953845"><span class="hs-identifier hs-var">old_ls</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680953846"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953846"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680953847"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953847"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-1344"></span><span>                       </span><span id="local-6989586621680953848"><span class="annot"><span class="annottext">i' :: Exp
</span><a href="#local-6989586621680953848"><span class="hs-identifier hs-var hs-var">i'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VEnv -&gt; Triv -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#codegenTriv"><span class="hs-identifier hs-var">codegenTriv</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952781"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953846"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1345"></span><span>                       </span><span id="local-6989586621680953849"><span class="annot"><span class="annottext">xexp :: Exp
</span><a href="#local-6989586621680953849"><span class="hs-identifier hs-var hs-var">xexp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cexp| $exp:(codegenTriv venv x) |]</span></span><span>
</span><span id="line-1346"></span><span>                   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953847"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1347"></span><span>                     </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1348"></span><span>                        </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy (VectorTy elty)) $id:outV = gib_vector_inplace_update($id:old_ls, $exp:i', &amp;$exp:xexp); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1349"></span><span>                     </span><span class="annot"><a href="Gibbon.L4.Syntax.html#ProdTriv"><span class="hs-identifier hs-type">ProdTriv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1350"></span><span>                        </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy (VectorTy elty)) $id:outV = gib_vector_inplace_update($id:old_ls, $exp:i', &amp;$exp:xexp); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1351"></span><span>                     </span><span class="annot"><a href="Gibbon.L4.Syntax.html#IntTriv"><span class="hs-identifier hs-type">IntTriv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1352"></span><span>                        </span><span id="local-6989586621680953860"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953860"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;tmp&quot;</span></span><span>
</span><span id="line-1353"></span><span>                        </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy IntTy) $id:tmp = $exp:xexp; |]</span></span><span>
</span><span id="line-1354"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy (VectorTy elty)) $id:outV = gib_vector_inplace_update($id:old_ls, $exp:i', &amp;$id:tmp); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1355"></span><span>                     </span><span class="annot"><a href="Gibbon.L4.Syntax.html#CharTriv"><span class="hs-identifier hs-type">CharTriv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1356"></span><span>                        </span><span id="local-6989586621680953871"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953871"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;tmp&quot;</span></span><span>
</span><span id="line-1357"></span><span>                        </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy CharTy) $id:tmp = $exp:xexp; |]</span></span><span>
</span><span id="line-1358"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy (VectorTy elty)) $id:outV = gib_vector_inplace_update($id:old_ls, $exp:i', &amp;$id:tmp); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1359"></span><span>                     </span><span class="annot"><a href="Gibbon.L4.Syntax.html#FloatTriv"><span class="hs-identifier hs-type">FloatTriv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1360"></span><span>                        </span><span id="local-6989586621680953882"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953882"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;tmp&quot;</span></span><span>
</span><span id="line-1361"></span><span>                        </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy FloatTy) $id:tmp = $exp:xexp; |]</span></span><span>
</span><span id="line-1362"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy (VectorTy elty)) $id:outV = gib_vector_inplace_update($id:old_ls, $exp:i', &amp;$id:tmp); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1363"></span><span>                     </span><span class="annot"><span class="annottext">Triv
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; PassM [BlockItem]
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; PassM [BlockItem]) -&gt; FilePath -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;codegen: InplaceVUpdateP: &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Triv -&gt; FilePath
forall a. Out a =&gt; a -&gt; FilePath
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953847"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1364"></span><span>
</span><span id="line-1365"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VConcatP"><span class="hs-identifier hs-type">VConcatP</span></a></span><span> </span><span id="local-6989586621680953893"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953893"><span class="hs-identifier hs-var">elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1366"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953894"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953894"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1367"></span><span>                       </span><span class="hs-special">[</span><span id="local-6989586621680953895"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953895"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-1368"></span><span>                   </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy (VectorTy elty)) $id:outV = gib_vector_concat($exp:(codegenTriv venv ls)); |]</span></span><span>
</span><span id="line-1369"></span><span>                          </span><span class="hs-special">]</span><span>
</span><span id="line-1370"></span><span>
</span><span id="line-1371"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VSortP"><span class="hs-identifier hs-type">VSortP</span></a></span><span> </span><span id="local-6989586621680953901"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953901"><span class="hs-identifier hs-var">elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1372"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953902"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953902"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1373"></span><span>                       </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953903"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953903"><span class="hs-identifier hs-var">old_ls</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953904"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953904"><span class="hs-identifier hs-var">sort_fn</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-1374"></span><span>                   </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy (VectorTy elty)) $id:outV = gib_vector_sort($id:old_ls, $id:sort_fn); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1375"></span><span>
</span><span id="line-1376"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#InplaceVSortP"><span class="hs-identifier hs-type">InplaceVSortP</span></a></span><span> </span><span id="local-6989586621680953910"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953910"><span class="hs-identifier hs-var">elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1377"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953911"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953911"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1378"></span><span>                       </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953912"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953912"><span class="hs-identifier hs-var">old_ls</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953913"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953913"><span class="hs-identifier hs-var">sort_fn</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-1379"></span><span>                   </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy (VectorTy elty)) $id:outV = gib_vector_inplace_sort($id:old_ls, $id:sort_fn); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1380"></span><span>
</span><span id="line-1381"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VSliceP"><span class="hs-identifier hs-type">VSliceP</span></a></span><span> </span><span id="local-6989586621680953919"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953919"><span class="hs-identifier hs-var">elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1382"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953920"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953920"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1383"></span><span>                       </span><span class="hs-special">[</span><span id="local-6989586621680953921"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953921"><span class="hs-identifier hs-var">from</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680953922"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953922"><span class="hs-identifier hs-var">to</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953923"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953923"><span class="hs-identifier hs-var">old_ls</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-1384"></span><span>                       </span><span id="local-6989586621680953924"><span class="annot"><span class="annottext">from' :: Exp
</span><a href="#local-6989586621680953924"><span class="hs-identifier hs-var hs-var">from'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VEnv -&gt; Triv -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#codegenTriv"><span class="hs-identifier hs-var">codegenTriv</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952781"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953921"><span class="hs-identifier hs-var">from</span></a></span><span>
</span><span id="line-1385"></span><span>                       </span><span id="local-6989586621680953925"><span class="annot"><span class="annottext">to' :: Exp
</span><a href="#local-6989586621680953925"><span class="hs-identifier hs-var hs-var">to'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VEnv -&gt; Triv -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#codegenTriv"><span class="hs-identifier hs-var">codegenTriv</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952781"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953922"><span class="hs-identifier hs-var">to</span></a></span><span>
</span><span id="line-1386"></span><span>                   </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy (VectorTy elty)) $id:outV = gib_vector_slice($exp:from', $exp:to', $id:old_ls); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1387"></span><span>
</span><span id="line-1388"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VMergeP"><span class="hs-identifier hs-type">VMergeP</span></a></span><span> </span><span id="local-6989586621680953931"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953931"><span class="hs-identifier hs-var">elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1389"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953932"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953932"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1390"></span><span>                       </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953933"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953933"><span class="hs-identifier hs-var">ls1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953934"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953934"><span class="hs-identifier hs-var">ls2</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-1391"></span><span>                   </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy (VectorTy elty)) $id:outV = gib_vector_merge($id:ls1, $id:ls2); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1392"></span><span>
</span><span id="line-1393"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#PDictAllocP"><span class="hs-identifier hs-type">PDictAllocP</span></a></span><span> </span><span id="local-6989586621680953940"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953940"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span id="local-6989586621680953941"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953941"><span class="hs-identifier hs-var">_v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1394"></span><span>                                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| printf(&quot;PDictAllocP todo\n&quot;); |]</span></span><span>
</span><span id="line-1395"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| exit(1); |]</span></span><span>
</span><span id="line-1396"></span><span>                                  </span><span class="hs-special">]</span><span>
</span><span id="line-1397"></span><span>
</span><span id="line-1398"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#PDictInsertP"><span class="hs-identifier hs-type">PDictInsertP</span></a></span><span> </span><span id="local-6989586621680953942"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953942"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span id="local-6989586621680953943"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953943"><span class="hs-identifier hs-var">_v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span>
</span><span id="line-1399"></span><span>                                   </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| printf(&quot;PDictInsertP todo\n&quot;); |]</span></span><span>
</span><span id="line-1400"></span><span>                                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| exit(1); |]</span></span><span>
</span><span id="line-1401"></span><span>                                   </span><span class="hs-special">]</span><span>
</span><span id="line-1402"></span><span>
</span><span id="line-1403"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#PDictLookupP"><span class="hs-identifier hs-type">PDictLookupP</span></a></span><span> </span><span id="local-6989586621680953944"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953944"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span id="local-6989586621680953945"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953945"><span class="hs-identifier hs-var">_v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span>
</span><span id="line-1404"></span><span>                                   </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| printf(&quot;PDictLookupP todo\n&quot;); |]</span></span><span>
</span><span id="line-1405"></span><span>                                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| exit(1); |]</span></span><span>
</span><span id="line-1406"></span><span>                                   </span><span class="hs-special">]</span><span>
</span><span id="line-1407"></span><span>
</span><span id="line-1408"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#PDictHasKeyP"><span class="hs-identifier hs-type">PDictHasKeyP</span></a></span><span> </span><span id="local-6989586621680953946"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953946"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span id="local-6989586621680953947"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953947"><span class="hs-identifier hs-var">_v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span>
</span><span id="line-1409"></span><span>                                   </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| printf(&quot;PDictHasKeyP todo\n&quot;); |]</span></span><span>
</span><span id="line-1410"></span><span>                                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| exit(1); |]</span></span><span>
</span><span id="line-1411"></span><span>                                   </span><span class="hs-special">]</span><span>
</span><span id="line-1412"></span><span>
</span><span id="line-1413"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#PDictForkP"><span class="hs-identifier hs-type">PDictForkP</span></a></span><span> </span><span id="local-6989586621680953948"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953948"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span id="local-6989586621680953949"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953949"><span class="hs-identifier hs-var">_v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span>
</span><span id="line-1414"></span><span>                                 </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| printf(&quot;PDictForkP todo\n&quot;); |]</span></span><span>
</span><span id="line-1415"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| exit(1); |]</span></span><span>
</span><span id="line-1416"></span><span>                                 </span><span class="hs-special">]</span><span>
</span><span id="line-1417"></span><span>
</span><span id="line-1418"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#PDictJoinP"><span class="hs-identifier hs-type">PDictJoinP</span></a></span><span> </span><span id="local-6989586621680953950"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953950"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span id="local-6989586621680953951"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953951"><span class="hs-identifier hs-var">_v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span>
</span><span id="line-1419"></span><span>                                 </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| printf(&quot;PDictJoinP todo\n&quot;); |]</span></span><span>
</span><span id="line-1420"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| exit(1); |]</span></span><span>
</span><span id="line-1421"></span><span>                                 </span><span class="hs-special">]</span><span>
</span><span id="line-1422"></span><span>
</span><span id="line-1423"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#LLAllocP"><span class="hs-identifier hs-type">LLAllocP</span></a></span><span> </span><span id="local-6989586621680953952"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953952"><span class="hs-identifier hs-var">elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1424"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680953953"><span class="annot"><span class="annottext">ty1 :: Type
</span><a href="#local-6989586621680953953"><span class="hs-identifier hs-var hs-var">ty1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Type
</span><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty -&gt; Ty
</span><a href="Gibbon.L4.Syntax.html#ListTy"><span class="hs-identifier hs-var">ListTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953952"><span class="hs-identifier hs-var">elty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1425"></span><span>                       </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953954"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953954"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1426"></span><span>                   </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:ty1 $id:outV = gib_list_alloc(sizeof( $ty:(codegenTy elty))); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1427"></span><span>
</span><span id="line-1428"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#LLIsEmptyP"><span class="hs-identifier hs-type">LLIsEmptyP</span></a></span><span> </span><span id="local-6989586621680953960"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953960"><span class="hs-identifier hs-var">_elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1429"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953961"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953961"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680953962"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953962"><span class="hs-identifier hs-var">outTy</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1430"></span><span>                       </span><span class="hs-special">[</span><span id="local-6989586621680953963"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953963"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-1431"></span><span>                       </span><span id="local-6989586621680953964"><span class="annot"><span class="annottext">ls' :: Exp
</span><a href="#local-6989586621680953964"><span class="hs-identifier hs-var hs-var">ls'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VEnv -&gt; Triv -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#codegenTriv"><span class="hs-identifier hs-var">codegenTriv</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952781"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953963"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1432"></span><span>                       </span><span id="local-6989586621680953965"><span class="annot"><span class="annottext">outTy' :: Type
</span><a href="#local-6989586621680953965"><span class="hs-identifier hs-var hs-var">outTy'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Type
</span><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953962"><span class="hs-identifier hs-var">outTy</span></a></span><span>
</span><span id="line-1433"></span><span>                   </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:outTy' $id:outV = gib_list_is_empty($exp:ls'); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1434"></span><span>
</span><span id="line-1435"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#LLConsP"><span class="hs-identifier hs-type">LLConsP</span></a></span><span> </span><span id="local-6989586621680953971"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680953971"><span class="hs-identifier hs-var">elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1436"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680953972"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953972"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1437"></span><span>                       </span><span class="hs-special">[</span><span id="local-6989586621680953973"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953973"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680953974"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953974"><span class="hs-identifier hs-var">old_ls</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-1438"></span><span>                       </span><span id="local-6989586621680953975"><span class="annot"><span class="annottext">xexp :: Exp
</span><a href="#local-6989586621680953975"><span class="hs-identifier hs-var hs-var">xexp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cexp| $exp:(codegenTriv venv x) |]</span></span><span>
</span><span id="line-1439"></span><span>                   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953973"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1440"></span><span>                     </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1441"></span><span>                        </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy (ListTy elty)) $id:outV = gib_list_cons(&amp;$exp:xexp, $id:old_ls); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1442"></span><span>                     </span><span class="annot"><a href="Gibbon.L4.Syntax.html#ProdTriv"><span class="hs-identifier hs-type">ProdTriv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1443"></span><span>                        </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy (ListTy elty)) $id:outV = gib_list_cons(&amp;$exp:xexp, $id:old_ls); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1444"></span><span>                     </span><span class="annot"><a href="Gibbon.L4.Syntax.html#IntTriv"><span class="hs-identifier hs-type">IntTriv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1445"></span><span>                        </span><span id="local-6989586621680953986"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953986"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;tmp&quot;</span></span><span>
</span><span id="line-1446"></span><span>                        </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy IntTy) $id:tmp = $exp:xexp; |]</span></span><span>
</span><span id="line-1447"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy (ListTy elty)) $id:outV = gib_list_cons(&amp;$id:tmp, $id:old_ls); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1448"></span><span>                     </span><span class="annot"><a href="Gibbon.L4.Syntax.html#FloatTriv"><span class="hs-identifier hs-type">FloatTriv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1449"></span><span>                        </span><span id="local-6989586621680953997"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680953997"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;tmp&quot;</span></span><span>
</span><span id="line-1450"></span><span>                        </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy FloatTy) $id:tmp = $exp:xexp; |]</span></span><span>
</span><span id="line-1451"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy (ListTy elty)) $id:outV = gib_list_cons(&amp;$id:tmp, $id:old_ls); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1452"></span><span>                     </span><span class="annot"><a href="Gibbon.L4.Syntax.html#SymTriv"><span class="hs-identifier hs-type">SymTriv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1453"></span><span>                        </span><span id="local-6989586621680954008"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680954008"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;tmp&quot;</span></span><span>
</span><span id="line-1454"></span><span>                        </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy IntTy) $id:tmp = $exp:xexp; |]</span></span><span>
</span><span id="line-1455"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy (ListTy elty)) $id:outV = gib_list_cons(&amp;$id:tmp, $id:old_ls); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1456"></span><span>                     </span><span class="annot"><span class="annottext">Triv
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; PassM [BlockItem]
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; PassM [BlockItem]) -&gt; FilePath -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;codegen: LLConsP: &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Triv -&gt; FilePath
forall a. Out a =&gt; a -&gt; FilePath
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680953973"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1457"></span><span>
</span><span id="line-1458"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#LLHeadP"><span class="hs-identifier hs-type">LLHeadP</span></a></span><span> </span><span id="local-6989586621680954019"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680954019"><span class="hs-identifier hs-var">_elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1459"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680954020"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680954020"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680954021"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680954021"><span class="hs-identifier hs-var">outTy</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1460"></span><span>                       </span><span class="hs-special">[</span><span id="local-6989586621680954022"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680954022"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-1461"></span><span>                       </span><span id="local-6989586621680954023"><span class="annot"><span class="annottext">ls' :: Exp
</span><a href="#local-6989586621680954023"><span class="hs-identifier hs-var hs-var">ls'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VEnv -&gt; Triv -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#codegenTriv"><span class="hs-identifier hs-var">codegenTriv</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952781"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680954022"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1462"></span><span>                       </span><span id="local-6989586621680954024"><span class="annot"><span class="annottext">outTy' :: Type
</span><a href="#local-6989586621680954024"><span class="hs-identifier hs-var hs-var">outTy'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Type
</span><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680954021"><span class="hs-identifier hs-var">outTy</span></a></span><span>
</span><span id="line-1463"></span><span>                   </span><span id="local-6989586621680954025"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680954025"><span class="hs-identifier hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;tmp&quot;</span></span><span>
</span><span id="line-1464"></span><span>                   </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:outTy' *($id:tmp); |]</span></span><span>
</span><span id="line-1465"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span>  </span><span class="annot"><span class="">[cstm| $id:tmp = ($ty:outTy' *) gib_list_head($exp:ls'); |]</span></span><span>
</span><span id="line-1466"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:outTy' $id:outV = *($id:tmp); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1467"></span><span>
</span><span id="line-1468"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#LLTailP"><span class="hs-identifier hs-type">LLTailP</span></a></span><span> </span><span id="local-6989586621680954041"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680954041"><span class="hs-identifier hs-var">_elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1469"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680954042"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680954042"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680954043"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680954043"><span class="hs-identifier hs-var">outTy</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1470"></span><span>                      </span><span class="hs-special">[</span><span id="local-6989586621680954044"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680954044"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-1471"></span><span>                      </span><span id="local-6989586621680954045"><span class="annot"><span class="annottext">ls' :: Exp
</span><a href="#local-6989586621680954045"><span class="hs-identifier hs-var hs-var">ls'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VEnv -&gt; Triv -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#codegenTriv"><span class="hs-identifier hs-var">codegenTriv</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952781"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680954044"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1472"></span><span>                      </span><span id="local-6989586621680954046"><span class="annot"><span class="annottext">outTy' :: Type
</span><a href="#local-6989586621680954046"><span class="hs-identifier hs-var hs-var">outTy'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Type
</span><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680954043"><span class="hs-identifier hs-var">outTy</span></a></span><span>
</span><span id="line-1473"></span><span>                  </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:outTy' $id:outV = gib_list_tail($exp:ls'); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1474"></span><span>
</span><span id="line-1475"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#LLFreeP"><span class="hs-identifier hs-type">LLFreeP</span></a></span><span> </span><span id="local-6989586621680954052"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680954052"><span class="hs-identifier hs-var">_elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1476"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span id="local-6989586621680954053"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680954053"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-1477"></span><span>                      </span><span id="local-6989586621680954054"><span class="annot"><span class="annottext">ls' :: Exp
</span><a href="#local-6989586621680954054"><span class="hs-identifier hs-var hs-var">ls'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VEnv -&gt; Triv -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#codegenTriv"><span class="hs-identifier hs-var">codegenTriv</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952781"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680954053"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1478"></span><span>                  </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| gib_list_free($exp:ls'); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1479"></span><span>
</span><span id="line-1480"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#LLFree2P"><span class="hs-identifier hs-type">LLFree2P</span></a></span><span> </span><span id="local-6989586621680954055"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680954055"><span class="hs-identifier hs-var">_elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1481"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span id="local-6989586621680954056"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680954056"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-1482"></span><span>                      </span><span id="local-6989586621680954057"><span class="annot"><span class="annottext">ls' :: Exp
</span><a href="#local-6989586621680954057"><span class="hs-identifier hs-var hs-var">ls'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VEnv -&gt; Triv -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#codegenTriv"><span class="hs-identifier hs-var">codegenTriv</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952781"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680954056"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1483"></span><span>                  </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| free($exp:ls'); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1484"></span><span>
</span><span id="line-1485"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#LLCopyP"><span class="hs-identifier hs-type">LLCopyP</span></a></span><span> </span><span id="local-6989586621680954058"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680954058"><span class="hs-identifier hs-var">_elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1486"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680954059"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680954059"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680954060"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680954060"><span class="hs-identifier hs-var">outTy</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1487"></span><span>                      </span><span class="hs-special">[</span><span id="local-6989586621680954061"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680954061"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-1488"></span><span>                      </span><span id="local-6989586621680954062"><span class="annot"><span class="annottext">ls' :: Exp
</span><a href="#local-6989586621680954062"><span class="hs-identifier hs-var hs-var">ls'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VEnv -&gt; Triv -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#codegenTriv"><span class="hs-identifier hs-var">codegenTriv</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680952781"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680954061"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1489"></span><span>                      </span><span id="local-6989586621680954063"><span class="annot"><span class="annottext">outTy' :: Type
</span><a href="#local-6989586621680954063"><span class="hs-identifier hs-var hs-var">outTy'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ty -&gt; Type
</span><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680954060"><span class="hs-identifier hs-var">outTy</span></a></span><span>
</span><span id="line-1490"></span><span>                  </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:outTy' $id:outV = gib_list_copy($exp:ls'); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1491"></span><span>
</span><span id="line-1492"></span><span>
</span><span id="line-1493"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#GetNumProcessors"><span class="hs-identifier hs-var">GetNumProcessors</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1494"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621680954070"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680954070"><span class="hs-identifier hs-var">outV</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680954071"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680954071"><span class="hs-identifier hs-var">outTy</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680952784"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1495"></span><span>                   </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:(codegenTy outTy) $id:outV = gib_get_num_processors(); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1496"></span><span>
</span><span id="line-1497"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#PrintRegionCount"><span class="hs-identifier hs-var">PrintRegionCount</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| gib_print_global_region_count(); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1498"></span><span>
</span><span id="line-1499"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#SSPush"><span class="hs-identifier hs-type">SSPush</span></a></span><span> </span><span id="local-6989586621680954079"><span class="annot"><span class="annottext">SSModality
</span><a href="#local-6989586621680954079"><span class="hs-identifier hs-var">stk</span></a></span></span><span> </span><span id="local-6989586621680954080"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680954080"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1500"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680954081"><span class="annot"><span class="annottext">tycon_t :: Id
</span><a href="#local-6989586621680954081"><span class="hs-identifier hs-var hs-var">tycon_t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; SrcLoc -&gt; Id
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Id"><span class="hs-identifier hs-var">C.Id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680954080"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;_T&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1501"></span><span>                       </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680954082"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680954082"><span class="hs-identifier hs-var">loc</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680954083"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680954083"><span class="hs-identifier hs-var">endloc</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-1502"></span><span>                   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SSModality
</span><a href="#local-6989586621680954079"><span class="hs-identifier hs-var">stk</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1503"></span><span>                     </span><span class="annot"><span class="annottext">SSModality
</span><a href="Gibbon.Common.html#Write"><span class="hs-identifier hs-var">Write</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1504"></span><span>                       </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| gib_shadowstack_push($id:writeShadowstack, $id:loc, $id:endloc, Stk, $id:tycon_t); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1505"></span><span>                     </span><span class="annot"><span class="annottext">SSModality
</span><a href="Gibbon.Common.html#Read"><span class="hs-identifier hs-var">Read</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1506"></span><span>                       </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| gib_shadowstack_push($id:readShadowstack, $id:loc, $id:endloc, Stk, $id:tycon_t); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1507"></span><span>
</span><span id="line-1508"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#SSPop"><span class="hs-identifier hs-type">SSPop</span></a></span><span> </span><span id="local-6989586621680954087"><span class="annot"><span class="annottext">SSModality
</span><a href="#local-6989586621680954087"><span class="hs-identifier hs-var">stk</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1509"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680954088"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680954088"><span class="hs-identifier hs-var">loc</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680954089"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680954089"><span class="hs-identifier hs-var">endloc</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-1510"></span><span>                   </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1511"></span><span>                     </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SSModality
</span><a href="#local-6989586621680954087"><span class="hs-identifier hs-var">stk</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1512"></span><span>                        </span><span class="annot"><span class="annottext">SSModality
</span><a href="Gibbon.Common.html#Write"><span class="hs-identifier hs-var">Write</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| $id:shadowstackFrame = gib_shadowstack_pop($id:writeShadowstack); |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1513"></span><span>                        </span><span class="annot"><span class="annottext">SSModality
</span><a href="Gibbon.Common.html#Read"><span class="hs-identifier hs-var">Read</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| $id:shadowstackFrame = gib_shadowstack_pop($id:readShadowstack); |]</span></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-1514"></span><span>                     </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| $id:loc = $id:shadowstackFrame-&gt;ptr; |]</span></span><span>
</span><span id="line-1515"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| $id:endloc = $id:shadowstackFrame-&gt;endptr; |]</span></span><span class="hs-special">]</span><span>
</span><span id="line-1516"></span><span>
</span><span id="line-1517"></span><span>                 </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#Assert"><span class="hs-identifier hs-var">Assert</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1518"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680954091"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680954091"><span class="hs-identifier hs-var">_chk</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680952786"><span class="hs-identifier hs-var">rnds</span></a></span><span>
</span><span id="line-1519"></span><span>                       </span><span id="local-6989586621680954093"><span class="annot"><span class="annottext">ifdef :: FilePath
</span><a href="#local-6989586621680954093"><span class="hs-identifier hs-var hs-var">ifdef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;#ifdef _GIBBON_DEBUG&quot;</span></span><span>
</span><span id="line-1520"></span><span>                       </span><span id="local-6989586621680954095"><span class="annot"><span class="annottext">endif :: FilePath
</span><a href="#local-6989586621680954095"><span class="hs-identifier hs-var hs-var">endif</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;#endif&quot;</span></span><span>
</span><span id="line-1521"></span><span>                   </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| $escstm:ifdef |]</span></span><span>
</span><span id="line-1522"></span><span>                          </span><span class="hs-comment">-- , C.BlockStm [cstm| assert($id:chk); |]</span><span>
</span><span id="line-1523"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| $escstm:endif |]</span></span><span>
</span><span id="line-1524"></span><span>                          </span><span class="hs-special">]</span><span>
</span><span id="line-1525"></span><span>
</span><span id="line-1526"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#BumpArenaRefCount"><span class="hs-identifier hs-type">BumpArenaRefCount</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; PassM [BlockItem]
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;codegen: BumpArenaRefCount not handled.&quot;</span></span><span>
</span><span id="line-1527"></span><span>                 </span><span class="annot"><a href="Gibbon.L4.Syntax.html#ReadInt"><span class="hs-identifier hs-type">ReadInt</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; PassM [BlockItem]
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;codegen: ReadInt not handled.&quot;</span></span><span>
</span><span id="line-1528"></span><span>
</span><span id="line-1529"></span><span>       </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952798"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680952791"><span class="hs-identifier hs-var">bod'</span></a></span><span>
</span><span id="line-1530"></span><span>
</span><span id="line-1531"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#Goto"><span class="hs-identifier hs-type">Goto</span></a></span><span> </span><span id="local-6989586621680954099"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680954099"><span class="hs-identifier hs-var">lbl</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680954100"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680954100"><span class="hs-identifier hs-var">_ty</span></a></span></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1532"></span><span>  </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| goto $id:lbl; |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1533"></span><span>
</span><span id="line-1534"></span><span class="hs-comment">-- | The sizes for all mulitplicities are defined as globals in the RTS.</span><span>
</span><span id="line-1535"></span><span class="hs-comment">-- Note: Must be consistent with the names in RTS!</span><span>
</span><span id="line-1536"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenMultiplicity"><span class="hs-identifier hs-type">codegenMultiplicity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Multiplicity"><span class="hs-identifier hs-type">Multiplicity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Exp"><span class="hs-identifier hs-type">C.Exp</span></a></span><span>
</span><span id="line-1537"></span><span id="codegenMultiplicity"><span class="annot"><span class="annottext">codegenMultiplicity :: Multiplicity -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#codegenMultiplicity"><span class="hs-identifier hs-var hs-var">codegenMultiplicity</span></a></span></span><span> </span><span id="local-6989586621680954107"><span class="annot"><span class="annottext">Multiplicity
</span><a href="#local-6989586621680954107"><span class="hs-identifier hs-var">mul</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1538"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Multiplicity
</span><a href="#local-6989586621680954107"><span class="hs-identifier hs-var">mul</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1539"></span><span>    </span><span class="annot"><span class="annottext">Multiplicity
</span><a href="Gibbon.L2.Syntax.html#BigInfinite"><span class="hs-identifier hs-var">BigInfinite</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="">[cexp| gib_get_biginf_init_chunk_size() |]</span></span><span>
</span><span id="line-1540"></span><span>    </span><span class="annot"><span class="annottext">Multiplicity
</span><a href="Gibbon.L2.Syntax.html#Infinite"><span class="hs-identifier hs-var">Infinite</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="">[cexp| gib_get_inf_init_chunk_size() |]</span></span><span>
</span><span id="line-1541"></span><span>    </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Bounded"><span class="hs-identifier hs-type">Bounded</span></a></span><span> </span><span id="local-6989586621680954111"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680954111"><span class="hs-identifier hs-var">i</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1542"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680954112"><span class="annot"><span class="annottext">rounded :: Int
</span><a href="#local-6989586621680954112"><span class="hs-identifier hs-var hs-var">rounded</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680954111"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">18</span></span><span>
</span><span id="line-1543"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="">[cexp| $int:rounded |]</span></span><span>
</span><span id="line-1544"></span><span>
</span><span id="line-1545"></span><span class="hs-comment">-- | Round up a number to a power of 2.</span><span>
</span><span id="line-1546"></span><span class="hs-comment">--</span><span>
</span><span id="line-1547"></span><span class="hs-comment">-- Copied from https://stackoverflow.com/a/466256.</span><span>
</span><span id="line-1548"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#roundUp"><span class="hs-identifier hs-type">roundUp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-1549"></span><span id="roundUp"><span class="annot"><span class="annottext">roundUp :: Int -&gt; Int
</span><a href="Gibbon.Passes.Codegen.html#roundUp"><span class="hs-identifier hs-var hs-var">roundUp</span></a></span></span><span> </span><span id="local-6989586621680954154"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680954154"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Int
forall b. Integral b =&gt; Double -&gt; b
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Real.html#ceiling"><span class="hs-identifier hs-var">ceiling</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Integer -&gt; Double
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Real.html#%5E"><span class="hs-operator hs-var">^</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Integer
forall b. Integral b =&gt; Double -&gt; b
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Real.html#ceiling"><span class="hs-identifier hs-var">ceiling</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Float.html#log"><span class="hs-identifier hs-var">log</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680954154"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Real.html#%2F"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Float.html#log"><span class="hs-identifier hs-var">log</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1550"></span><span>
</span><span id="line-1551"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#splitAlts"><span class="hs-identifier hs-type">splitAlts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Alts"><span class="hs-identifier hs-type">Alts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#Alts"><span class="hs-identifier hs-type">Alts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Alts"><span class="hs-identifier hs-type">Alts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1552"></span><span id="splitAlts"><span class="annot"><span class="annottext">splitAlts :: Alts -&gt; (Alts, Alts)
</span><a href="Gibbon.Passes.Codegen.html#splitAlts"><span class="hs-identifier hs-var hs-var">splitAlts</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#TagAlts"><span class="hs-identifier hs-type">TagAlts</span></a></span><span> </span><span id="local-6989586621680954167"><span class="annot"><span class="annottext">[(Tag, Tail)]
</span><a href="#local-6989586621680954167"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Tag, Tail)] -&gt; Alts
</span><a href="Gibbon.L4.Syntax.html#TagAlts"><span class="hs-identifier hs-var">TagAlts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Tag, Tail)] -&gt; [(Tag, Tail)]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#init"><span class="hs-identifier hs-var">L.init</span></a></span><span> </span><span class="annot"><span class="annottext">[(Tag, Tail)]
</span><a href="#local-6989586621680954167"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Tag, Tail)] -&gt; Alts
</span><a href="Gibbon.L4.Syntax.html#TagAlts"><span class="hs-identifier hs-var">TagAlts</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[(Tag, Tail)] -&gt; (Tag, Tail)
forall a. HasCallStack =&gt; [a] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#last"><span class="hs-identifier hs-var">last</span></a></span><span> </span><span class="annot"><span class="annottext">[(Tag, Tail)]
</span><a href="#local-6989586621680954167"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1553"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#splitAlts"><span class="hs-identifier hs-var">splitAlts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#IntAlts"><span class="hs-identifier hs-type">IntAlts</span></a></span><span> </span><span id="local-6989586621680954169"><span class="annot"><span class="annottext">[(Int64, Tail)]
</span><a href="#local-6989586621680954169"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Int64, Tail)] -&gt; Alts
</span><a href="Gibbon.L4.Syntax.html#IntAlts"><span class="hs-identifier hs-var">IntAlts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Int64, Tail)] -&gt; [(Int64, Tail)]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#init"><span class="hs-identifier hs-var">L.init</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int64, Tail)]
</span><a href="#local-6989586621680954169"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Int64, Tail)] -&gt; Alts
</span><a href="Gibbon.L4.Syntax.html#IntAlts"><span class="hs-identifier hs-var">IntAlts</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[(Int64, Tail)] -&gt; (Int64, Tail)
forall a. HasCallStack =&gt; [a] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#last"><span class="hs-identifier hs-var">last</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int64, Tail)]
</span><a href="#local-6989586621680954169"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1554"></span><span>
</span><span id="line-1555"></span><span class="annot"><span class="hs-comment">-- | Take a &quot;singleton&quot; Alts and extract the Tail.</span></span><span>
</span><span id="line-1556"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#altTail"><span class="hs-identifier hs-type">altTail</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Alts"><span class="hs-identifier hs-type">Alts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Tail"><span class="hs-identifier hs-type">Tail</span></a></span><span>
</span><span id="line-1557"></span><span id="altTail"><span class="annot"><span class="annottext">altTail :: Alts -&gt; Tail
</span><a href="Gibbon.Passes.Codegen.html#altTail"><span class="hs-identifier hs-var hs-var">altTail</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#TagAlts"><span class="hs-identifier hs-type">TagAlts</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tag
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680954176"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680954176"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680954176"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1558"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#altTail"><span class="hs-identifier hs-var">altTail</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#IntAlts"><span class="hs-identifier hs-type">IntAlts</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680954177"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680954177"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680954177"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1559"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#altTail"><span class="hs-identifier hs-var">altTail</span></a></span><span> </span><span id="local-6989586621680954178"><span class="annot"><span class="annottext">Alts
</span><a href="#local-6989586621680954178"><span class="hs-identifier hs-var">oth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Tail
forall a. HasCallStack =&gt; FilePath -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Tail) -&gt; FilePath -&gt; Tail
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;altTail expected a 'singleton' Alts, got: &quot;</span></span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Alts -&gt; FilePath
forall a. Out a =&gt; Int -&gt; a -&gt; FilePath
</span><a href="Gibbon.Common.html#abbrv"><span class="hs-identifier hs-var">abbrv</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">80</span></span><span> </span><span class="annot"><span class="annottext">Alts
</span><a href="#local-6989586621680954178"><span class="hs-identifier hs-var">oth</span></a></span><span>
</span><span id="line-1560"></span><span>
</span><span id="line-1561"></span><span>
</span><span id="line-1562"></span><span class="hs-comment">-- Helper for lhs of a case</span><span>
</span><span id="line-1563"></span><span id="local-6989586621680950499"><span class="annot"><a href="Gibbon.Passes.Codegen.html#mk_tag_lhs"><span class="hs-identifier hs-type">mk_tag_lhs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Real.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950499"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950499"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680950499"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Exp"><span class="hs-identifier hs-type">C.Exp</span></a></span></span><span>
</span><span id="line-1564"></span><span id="mk_tag_lhs"><span class="annot"><span class="annottext">mk_tag_lhs :: forall a. (Integral a, Show a) =&gt; a -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#mk_tag_lhs"><span class="hs-identifier hs-var hs-var">mk_tag_lhs</span></a></span></span><span> </span><span id="local-6989586621680954204"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680954204"><span class="hs-identifier hs-var">lhs</span></a></span></span><span>
</span><span id="line-1565"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
forall a. Num a =&gt; a
</span><a href="Gibbon.Language.Constants.html#indirectionAlt"><span class="hs-identifier hs-var">GL.indirectionAlt</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680954204"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; SrcLoc -&gt; Exp
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Var"><span class="hs-identifier hs-var">C.Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; SrcLoc -&gt; Id
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Id"><span class="hs-identifier hs-var">C.Id</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GIB_INDIRECTION_TAG&quot;</span></span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span>
</span><span id="line-1566"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
forall a. Num a =&gt; a
</span><a href="Gibbon.Language.Constants.html#redirectionAlt"><span class="hs-identifier hs-var">GL.redirectionAlt</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680954204"><span class="hs-identifier hs-var">lhs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; SrcLoc -&gt; Exp
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Var"><span class="hs-identifier hs-var">C.Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; SrcLoc -&gt; Id
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Id"><span class="hs-identifier hs-var">C.Id</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GIB_REDIRECTION_TAG&quot;</span></span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span>
</span><span id="line-1567"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Const -&gt; SrcLoc -&gt; Exp
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Const"><span class="hs-identifier hs-var">C.Const</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Signed -&gt; Integer -&gt; SrcLoc -&gt; Const
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#IntConst"><span class="hs-identifier hs-var">C.IntConst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680954204"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Signed
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Unsigned"><span class="hs-identifier hs-var">C.Unsigned</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680954204"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span>
</span><span id="line-1568"></span><span>
</span><span id="line-1569"></span><span id="local-6989586621680954206"><span class="annot"><a href="Gibbon.Passes.Codegen.html#mk_int_lhs"><span class="hs-identifier hs-type">mk_int_lhs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Real.html#Integral"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680954206"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680954206"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680954206"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Exp"><span class="hs-identifier hs-type">C.Exp</span></a></span></span><span>
</span><span id="line-1570"></span><span id="mk_int_lhs"><span class="annot"><span class="annottext">mk_int_lhs :: forall a. (Integral a, Show a) =&gt; a -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#mk_int_lhs"><span class="hs-identifier hs-var hs-var">mk_int_lhs</span></a></span></span><span> </span><span id="local-6989586621680954215"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680954215"><span class="hs-identifier hs-var">lhs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Const -&gt; SrcLoc -&gt; Exp
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Const"><span class="hs-identifier hs-var">C.Const</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Signed -&gt; Integer -&gt; SrcLoc -&gt; Const
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#IntConst"><span class="hs-identifier hs-var">C.IntConst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; FilePath
forall a. Show a =&gt; a -&gt; FilePath
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680954215"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Signed
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Signed"><span class="hs-identifier hs-var">C.Signed</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680954215"><span class="hs-identifier hs-var">lhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span>
</span><span id="line-1571"></span><span>
</span><span id="line-1572"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#normalizeAlts"><span class="hs-identifier hs-type">normalizeAlts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Alts"><span class="hs-identifier hs-type">Alts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Exp"><span class="hs-identifier hs-type">C.Exp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Tail"><span class="hs-identifier hs-type">Tail</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1573"></span><span id="normalizeAlts"><span class="annot"><span class="annottext">normalizeAlts :: Alts -&gt; [(Exp, Tail)]
</span><a href="Gibbon.Passes.Codegen.html#normalizeAlts"><span class="hs-identifier hs-var hs-var">normalizeAlts</span></a></span></span><span> </span><span id="local-6989586621680954224"><span class="annot"><span class="annottext">Alts
</span><a href="#local-6989586621680954224"><span class="hs-identifier hs-var">alts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1574"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Alts
</span><a href="#local-6989586621680954224"><span class="hs-identifier hs-var">alts</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1575"></span><span>      </span><span class="annot"><a href="Gibbon.L4.Syntax.html#TagAlts"><span class="hs-identifier hs-type">TagAlts</span></a></span><span> </span><span id="local-6989586621680954225"><span class="annot"><span class="annottext">[(Tag, Tail)]
</span><a href="#local-6989586621680954225"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((Tag, Tail) -&gt; (Exp, Tail)) -&gt; [(Tag, Tail)] -&gt; [(Exp, Tail)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Tag -&gt; Exp) -&gt; (Tag, Tail) -&gt; (Exp, Tail)
forall a b c. (a -&gt; b) -&gt; (a, c) -&gt; (b, c)
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Bifunctor.html#first"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">Tag -&gt; Exp
forall a. (Integral a, Show a) =&gt; a -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#mk_tag_lhs"><span class="hs-identifier hs-var">mk_tag_lhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Tag, Tail)]
</span><a href="#local-6989586621680954225"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-1576"></span><span>      </span><span class="annot"><a href="Gibbon.L4.Syntax.html#IntAlts"><span class="hs-identifier hs-type">IntAlts</span></a></span><span> </span><span id="local-6989586621680954226"><span class="annot"><span class="annottext">[(Int64, Tail)]
</span><a href="#local-6989586621680954226"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((Int64, Tail) -&gt; (Exp, Tail)) -&gt; [(Int64, Tail)] -&gt; [(Exp, Tail)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int64 -&gt; Exp) -&gt; (Int64, Tail) -&gt; (Exp, Tail)
forall a b c. (a -&gt; b) -&gt; (a, c) -&gt; (b, c)
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Bifunctor.html#first"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Exp
forall a. (Integral a, Show a) =&gt; a -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#mk_int_lhs"><span class="hs-identifier hs-var">mk_int_lhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Int64, Tail)]
</span><a href="#local-6989586621680954226"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-1577"></span><span>
</span><span id="line-1578"></span><span class="annot"><span class="hs-comment">-- | Generate a proper switch expression instead.</span></span><span>
</span><span id="line-1579"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#genSwitch"><span class="hs-identifier hs-type">genSwitch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Passes.Codegen.html#VEnv"><span class="hs-identifier hs-type">VEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.Codegen.html#FEnv"><span class="hs-identifier hs-type">FEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Triv"><span class="hs-identifier hs-type">Triv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Alts"><span class="hs-identifier hs-type">Alts</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Tail"><span class="hs-identifier hs-type">Tail</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Ty"><span class="hs-identifier hs-type">Ty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.Codegen.html#SyncDeps"><span class="hs-identifier hs-type">SyncDeps</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockItem"><span class="hs-identifier hs-type">C.BlockItem</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1580"></span><span id="genSwitch"><span class="annot"><span class="annottext">genSwitch :: VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Var
-&gt; Triv
-&gt; Alts
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#genSwitch"><span class="hs-identifier hs-var hs-var">genSwitch</span></a></span></span><span> </span><span id="local-6989586621680954238"><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680954238"><span class="hs-identifier hs-var">venv</span></a></span></span><span> </span><span id="local-6989586621680954239"><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680954239"><span class="hs-identifier hs-var">fenv</span></a></span></span><span> </span><span id="local-6989586621680954240"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680954240"><span class="hs-identifier hs-var">sort_fns</span></a></span></span><span> </span><span id="local-6989586621680954241"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680954241"><span class="hs-identifier hs-var">lbl</span></a></span></span><span> </span><span id="local-6989586621680954242"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680954242"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621680954243"><span class="annot"><span class="annottext">Alts
</span><a href="#local-6989586621680954243"><span class="hs-identifier hs-var">alts</span></a></span></span><span> </span><span id="local-6989586621680954244"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680954244"><span class="hs-identifier hs-var">lastE</span></a></span></span><span> </span><span id="local-6989586621680954245"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680954245"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680954246"><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680954246"><span class="hs-identifier hs-var">sync_deps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1581"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621680954247"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Exp"><span class="hs-identifier hs-type">C.Exp</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Gibbon.L4.Syntax.html#Tail"><span class="hs-identifier hs-type">Tail</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Stm"><span class="hs-identifier hs-type">C.Stm</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1582"></span><span>           </span><span id="local-6989586621680954247"><span class="annot"><span class="annottext">go :: [(Exp, Tail)] -&gt; PassM [Stm]
</span><a href="#local-6989586621680954247"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680954248"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680954248"><span class="hs-identifier hs-var">tal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680954238"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680954239"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680954240"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680954244"><span class="hs-identifier hs-var">lastE</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680954245"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680954246"><span class="hs-identifier hs-var">sync_deps</span></a></span><span>
</span><span id="line-1583"></span><span>                      </span><span class="annot"><span class="annottext">[Stm] -&gt; PassM [Stm]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="">[cstm| default: $stm:(mkBlock tal) |]</span></span><span class="hs-special">]</span><span>
</span><span id="line-1584"></span><span>           </span><span class="annot"><a href="#local-6989586621680954247"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621680954251"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680954251"><span class="hs-identifier hs-var">ex</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680954252"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680954252"><span class="hs-identifier hs-var">tl</span></a></span></span><span class="hs-special">)</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680954253"><span class="annot"><span class="annottext">[(Exp, Tail)]
</span><a href="#local-6989586621680954253"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1585"></span><span>               </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680954254"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680954254"><span class="hs-identifier hs-var">tal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">VEnv
-&gt; Map Var ([Ty], Ty)
-&gt; Set Var
-&gt; Tail
-&gt; Ty
-&gt; SyncDeps
-&gt; PassM [BlockItem]
</span><a href="Gibbon.Passes.Codegen.html#codegenTail"><span class="hs-identifier hs-var">codegenTail</span></a></span><span> </span><span class="annot"><span class="annottext">VEnv
</span><a href="#local-6989586621680954238"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var ([Ty], Ty)
</span><a href="#local-6989586621680954239"><span class="hs-identifier hs-var">fenv</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680954240"><span class="hs-identifier hs-var">sort_fns</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680954252"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680954245"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">SyncDeps
</span><a href="#local-6989586621680954246"><span class="hs-identifier hs-var">sync_deps</span></a></span><span>
</span><span id="line-1586"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680954255"><span class="annot"><span class="annottext">tal2 :: [BlockItem]
</span><a href="#local-6989586621680954255"><span class="hs-identifier hs-var hs-var">tal2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680954254"><span class="hs-identifier hs-var">tal</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; [BlockItem] -&gt; [BlockItem]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| break; |]</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1587"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680954257"><span class="annot"><span class="annottext">this :: Stm
</span><a href="#local-6989586621680954257"><span class="hs-identifier hs-var hs-var">this</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cstm| case $exp:ex : $stm:(mkBlock tal2) |]</span></span><span>
</span><span id="line-1588"></span><span>                  </span><span id="local-6989586621680954259"><span class="annot"><span class="annottext">[Stm]
</span><a href="#local-6989586621680954259"><span class="hs-identifier hs-var">rst'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Exp, Tail)] -&gt; PassM [Stm]
</span><a href="#local-6989586621680954247"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[(Exp, Tail)]
</span><a href="#local-6989586621680954253"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-1589"></span><span>                  </span><span class="annot"><span class="annottext">[Stm] -&gt; PassM [Stm]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stm
</span><a href="#local-6989586621680954257"><span class="hs-identifier hs-var">this</span></a></span><span class="annot"><span class="annottext">Stm -&gt; [Stm] -&gt; [Stm]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[Stm]
</span><a href="#local-6989586621680954259"><span class="hs-identifier hs-var">rst'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1590"></span><span>       </span><span id="local-6989586621680954260"><span class="annot"><span class="annottext">[Stm]
</span><a href="#local-6989586621680954260"><span class="hs-identifier hs-var">alts'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Exp, Tail)] -&gt; PassM [Stm]
</span><a href="#local-6989586621680954247"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Alts -&gt; [(Exp, Tail)]
</span><a href="Gibbon.Passes.Codegen.html#normalizeAlts"><span class="hs-identifier hs-var">normalizeAlts</span></a></span><span> </span><span class="annot"><span class="annottext">Alts
</span><a href="#local-6989586621680954243"><span class="hs-identifier hs-var">alts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1591"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680954261"><span class="annot"><span class="annottext">body :: Stm
</span><a href="#local-6989586621680954261"><span class="hs-identifier hs-var hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; Stm
</span><a href="Gibbon.Passes.Codegen.html#mkBlock"><span class="hs-identifier hs-var">mkBlock</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="annottext">Stm
</span><a href="#local-6989586621680954262"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680954262"><span class="annot"><span class="annottext">Stm
</span><a href="#local-6989586621680954262"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Stm]
</span><a href="#local-6989586621680954260"><span class="hs-identifier hs-var">alts'</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1592"></span><span>       </span><span class="annot"><span class="annottext">[BlockItem] -&gt; PassM [BlockItem]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([BlockItem] -&gt; PassM [BlockItem])
-&gt; [BlockItem] -&gt; PassM [BlockItem]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| $id:lbl: ; |]</span></span><span>
</span><span id="line-1593"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| switch ( $exp:(codegenTriv venv tr) ) $stm:body |]</span></span><span class="hs-special">]</span><span>
</span><span id="line-1594"></span><span>
</span><span id="line-1595"></span><span class="hs-comment">-- | The identifier after typename refers to typedefs defined in rts.c</span><span>
</span><span id="line-1596"></span><span class="hs-comment">--</span><span>
</span><span id="line-1597"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-type">codegenTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Ty"><span class="hs-identifier hs-type">Ty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Type"><span class="hs-identifier hs-type">C.Type</span></a></span><span>
</span><span id="line-1598"></span><span id="codegenTy"><span class="annot"><span class="annottext">codegenTy :: Ty -&gt; Type
</span><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var hs-var">codegenTy</span></a></span></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#IntTy"><span class="hs-identifier hs-var">IntTy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty|typename GibInt|]</span></span><span>
</span><span id="line-1599"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CharTy"><span class="hs-identifier hs-var">CharTy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty|typename GibChar|]</span></span><span>
</span><span id="line-1600"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#FloatTy"><span class="hs-identifier hs-var">FloatTy</span></a></span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty|typename GibFloat|]</span></span><span>
</span><span id="line-1601"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#BoolTy"><span class="hs-identifier hs-var">BoolTy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty|typename GibBool|]</span></span><span>
</span><span id="line-1602"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#TagTyPacked"><span class="hs-identifier hs-var">TagTyPacked</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty|typename GibPackedTag|]</span></span><span>
</span><span id="line-1603"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#TagTyBoxed"><span class="hs-identifier hs-var">TagTyBoxed</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty|typename GibBoxedTag|]</span></span><span>
</span><span id="line-1604"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#SymTy"><span class="hs-identifier hs-var">SymTy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty|typename GibSym|]</span></span><span>
</span><span id="line-1605"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#PtrTy"><span class="hs-identifier hs-var">PtrTy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty|typename GibPtr|]</span></span><span> </span><span class="hs-comment">-- char* - Hack, this could be void* if we have enough casts. [2016.11.06]</span><span>
</span><span id="line-1606"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty|typename GibCursor|]</span></span><span>
</span><span id="line-1607"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#RegionTy"><span class="hs-identifier hs-var">RegionTy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty|typename GibChunk|]</span></span><span>
</span><span id="line-1608"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#ChunkTy"><span class="hs-identifier hs-var">ChunkTy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty|typename GibChunk|]</span></span><span>
</span><span id="line-1609"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty|unsigned char|]</span></span><span>
</span><span id="line-1610"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680954273"><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680954273"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DeclSpec -&gt; Decl -&gt; SrcLoc -&gt; Type
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Type"><span class="hs-identifier hs-var">C.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Storage] -&gt; [TypeQual] -&gt; TypeSpec -&gt; SrcLoc -&gt; DeclSpec
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#DeclSpec"><span class="hs-identifier hs-var">C.DeclSpec</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Id -&gt; [Id] -&gt; SrcLoc -&gt; TypeSpec
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Tnamed"><span class="hs-identifier hs-var">C.Tnamed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; SrcLoc -&gt; Id
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Id"><span class="hs-identifier hs-var">C.Id</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680954274"><span class="hs-identifier hs-var">nam</span></a></span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcLoc -&gt; Decl
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#DeclRoot"><span class="hs-identifier hs-var">C.DeclRoot</span></a></span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span>
</span><span id="line-1611"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680954274"><span class="annot"><span class="annottext">nam :: FilePath
</span><a href="#local-6989586621680954274"><span class="hs-identifier hs-var hs-var">nam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; FilePath
</span><a href="Gibbon.Passes.Codegen.html#makeName"><span class="hs-identifier hs-var">makeName</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680954273"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-1612"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#SymDictTy"><span class="hs-identifier hs-type">SymDictTy</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680954275"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680954275"><span class="hs-identifier hs-var">_t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty|typename GibSymDict|]</span></span><span>
</span><span id="line-1613"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#SymSetTy"><span class="hs-identifier hs-var">SymSetTy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty|typename GibSymSet*|]</span></span><span>
</span><span id="line-1614"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#SymHashTy"><span class="hs-identifier hs-var">SymHashTy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty|typename GibSymHash*|]</span></span><span>
</span><span id="line-1615"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#IntHashTy"><span class="hs-identifier hs-var">IntHashTy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty|typename GibIntHash*|]</span></span><span>
</span><span id="line-1616"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#ArenaTy"><span class="hs-identifier hs-var">ArenaTy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty|typename GibArena*|]</span></span><span>
</span><span id="line-1617"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VectorTy"><span class="hs-identifier hs-type">VectorTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty|typename GibVector* |]</span></span><span>
</span><span id="line-1618"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#ListTy"><span class="hs-identifier hs-type">ListTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty|typename GibList* |]</span></span><span>
</span><span id="line-1619"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenTy"><span class="hs-identifier hs-var">codegenTy</span></a></span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#PDictTy"><span class="hs-identifier hs-type">PDictTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[cty|typename GibPDict* |]</span></span><span>
</span><span id="line-1620"></span><span>
</span><span id="line-1621"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#makeName"><span class="hs-identifier hs-type">makeName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Syntax.html#Ty"><span class="hs-identifier hs-type">Ty</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-1622"></span><span id="makeName"><span class="annot"><span class="annottext">makeName :: [Ty] -&gt; FilePath
</span><a href="Gibbon.Passes.Codegen.html#makeName"><span class="hs-identifier hs-var hs-var">makeName</span></a></span></span><span> </span><span id="local-6989586621680954282"><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680954282"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Ty -&gt; FilePath) -&gt; [Ty] -&gt; FilePath
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; FilePath
</span><a href="Gibbon.Passes.Codegen.html#makeName%27"><span class="hs-identifier hs-var">makeName'</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680954282"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Prod&quot;</span></span><span>
</span><span id="line-1623"></span><span>
</span><span id="line-1624"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#makeName%27"><span class="hs-identifier hs-type">makeName'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Ty"><span class="hs-identifier hs-type">Ty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-1625"></span><span id="makeName%27"><span class="annot"><span class="annottext">makeName' :: Ty -&gt; FilePath
</span><a href="Gibbon.Passes.Codegen.html#makeName%27"><span class="hs-identifier hs-var hs-var">makeName'</span></a></span></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#IntTy"><span class="hs-identifier hs-var">IntTy</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GibInt&quot;</span></span><span>
</span><span id="line-1626"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#makeName%27"><span class="hs-identifier hs-var">makeName'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CharTy"><span class="hs-identifier hs-var">CharTy</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GibChar&quot;</span></span><span>
</span><span id="line-1627"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#makeName%27"><span class="hs-identifier hs-var">makeName'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#FloatTy"><span class="hs-identifier hs-var">FloatTy</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GibFloat&quot;</span></span><span>
</span><span id="line-1628"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#makeName%27"><span class="hs-identifier hs-var">makeName'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#SymTy"><span class="hs-identifier hs-var">SymTy</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GibSym&quot;</span></span><span>
</span><span id="line-1629"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#makeName%27"><span class="hs-identifier hs-var">makeName'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#BoolTy"><span class="hs-identifier hs-var">BoolTy</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GibBool&quot;</span></span><span>
</span><span id="line-1630"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#makeName%27"><span class="hs-identifier hs-var">makeName'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GibCursor&quot;</span></span><span>
</span><span id="line-1631"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#makeName%27"><span class="hs-identifier hs-var">makeName'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#TagTyPacked"><span class="hs-identifier hs-var">TagTyPacked</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GibPackedTag&quot;</span></span><span>
</span><span id="line-1632"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#makeName%27"><span class="hs-identifier hs-var">makeName'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#TagTyBoxed"><span class="hs-identifier hs-var">TagTyBoxed</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GibBoxedTag&quot;</span></span><span>
</span><span id="line-1633"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#makeName%27"><span class="hs-identifier hs-var">makeName'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#PtrTy"><span class="hs-identifier hs-var">PtrTy</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GibPtr&quot;</span></span><span>
</span><span id="line-1634"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#makeName%27"><span class="hs-identifier hs-var">makeName'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#SymDictTy"><span class="hs-identifier hs-type">SymDictTy</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680954286"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680954286"><span class="hs-identifier hs-var">_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GibSymDict&quot;</span></span><span>
</span><span id="line-1635"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#makeName%27"><span class="hs-identifier hs-var">makeName'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#RegionTy"><span class="hs-identifier hs-var">RegionTy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GibChunk&quot;</span></span><span>
</span><span id="line-1636"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#makeName%27"><span class="hs-identifier hs-var">makeName'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#ChunkTy"><span class="hs-identifier hs-var">ChunkTy</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GibChunk&quot;</span></span><span>
</span><span id="line-1637"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#makeName%27"><span class="hs-identifier hs-var">makeName'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#ArenaTy"><span class="hs-identifier hs-var">ArenaTy</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GibArena&quot;</span></span><span>
</span><span id="line-1638"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#makeName%27"><span class="hs-identifier hs-var">makeName'</span></a></span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#VectorTy"><span class="hs-identifier hs-type">VectorTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GibVector&quot;</span></span><span>
</span><span id="line-1639"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#makeName%27"><span class="hs-identifier hs-var">makeName'</span></a></span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#ListTy"><span class="hs-identifier hs-type">ListTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GibList&quot;</span></span><span>
</span><span id="line-1640"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#makeName%27"><span class="hs-identifier hs-var">makeName'</span></a></span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#PDictTy"><span class="hs-identifier hs-type">PDictTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;PDict&quot;</span></span><span>
</span><span id="line-1641"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#makeName%27"><span class="hs-identifier hs-var">makeName'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680954287"><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680954287"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;Prod&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">(Ty -&gt; FilePath) -&gt; [Ty] -&gt; FilePath
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; FilePath
</span><a href="Gibbon.Passes.Codegen.html#makeName%27"><span class="hs-identifier hs-var">makeName'</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680954287"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1642"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#makeName%27"><span class="hs-identifier hs-var">makeName'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#SymSetTy"><span class="hs-identifier hs-var">SymSetTy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GibSymSet&quot;</span></span><span>
</span><span id="line-1643"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#makeName%27"><span class="hs-identifier hs-var">makeName'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#SymHashTy"><span class="hs-identifier hs-var">SymHashTy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GibSymHash&quot;</span></span><span>
</span><span id="line-1644"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#makeName%27"><span class="hs-identifier hs-var">makeName'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#IntHashTy"><span class="hs-identifier hs-var">IntHashTy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;GibIntHash&quot;</span></span><span>
</span><span id="line-1645"></span><span>
</span><span id="line-1646"></span><span>
</span><span id="line-1647"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#makeIcdName"><span class="hs-identifier hs-type">makeIcdName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Ty"><span class="hs-identifier hs-type">Ty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1648"></span><span id="makeIcdName"><span class="annot"><span class="annottext">makeIcdName :: Ty -&gt; (FilePath, FilePath)
</span><a href="Gibbon.Passes.Codegen.html#makeIcdName"><span class="hs-identifier hs-var hs-var">makeIcdName</span></a></span></span><span> </span><span id="local-6989586621680954298"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680954298"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1649"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680954299"><span class="annot"><span class="annottext">ty_name :: FilePath
</span><a href="#local-6989586621680954299"><span class="hs-identifier hs-var hs-var">ty_name</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span>
</span><span id="line-1650"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680954298"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1651"></span><span>          </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#IntTy"><span class="hs-identifier hs-var">IntTy</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;IntTy&quot;</span></span><span>
</span><span id="line-1652"></span><span>          </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#FloatTy"><span class="hs-identifier hs-var">FloatTy</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;FloatTy&quot;</span></span><span>
</span><span id="line-1653"></span><span>          </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#BoolTy"><span class="hs-identifier hs-var">BoolTy</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;BoolTy&quot;</span></span><span>
</span><span id="line-1654"></span><span>          </span><span class="annot"><span class="annottext">Ty
</span><a href="Gibbon.L4.Syntax.html#SymTy"><span class="hs-identifier hs-var">SymTy</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;SymTy&quot;</span></span><span>
</span><span id="line-1655"></span><span>          </span><span class="annot"><a href="Gibbon.L4.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680954300"><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680954300"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Ty] -&gt; FilePath
</span><a href="Gibbon.Passes.Codegen.html#makeName"><span class="hs-identifier hs-var">makeName</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty]
</span><a href="#local-6989586621680954300"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1656"></span><span>          </span><span class="annot"><span class="annottext">Ty
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;codegenTail: Lists of type &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Ty -&gt; FilePath
forall a. Out a =&gt; a -&gt; FilePath
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680954298"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot; not allowed.&quot;</span></span><span>
</span><span id="line-1657"></span><span>      </span><span id="local-6989586621680954301"><span class="annot"><span class="annottext">icd_name :: FilePath
</span><a href="#local-6989586621680954301"><span class="hs-identifier hs-var hs-var">icd_name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680954299"><span class="hs-identifier hs-var">ty_name</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;_icd&quot;</span></span><span>
</span><span id="line-1658"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680954299"><span class="hs-identifier hs-var">ty_name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621680954301"><span class="hs-identifier hs-var">icd_name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1659"></span><span>
</span><span id="line-1660"></span><span>
</span><span id="line-1661"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#mkBlock"><span class="hs-identifier hs-type">mkBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockItem"><span class="hs-identifier hs-type">C.BlockItem</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Stm"><span class="hs-identifier hs-type">C.Stm</span></a></span><span>
</span><span id="line-1662"></span><span id="mkBlock"><span class="annot"><span class="annottext">mkBlock :: [BlockItem] -&gt; Stm
</span><a href="Gibbon.Passes.Codegen.html#mkBlock"><span class="hs-identifier hs-var hs-var">mkBlock</span></a></span></span><span> </span><span id="local-6989586621680954303"><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680954303"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[BlockItem] -&gt; SrcLoc -&gt; Stm
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Block"><span class="hs-identifier hs-var">C.Block</span></a></span><span> </span><span class="annot"><span class="annottext">[BlockItem]
</span><a href="#local-6989586621680954303"><span class="hs-identifier hs-var">ss</span></a></span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span>
</span><span id="line-1663"></span><span>
</span><span id="line-1664"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#cid"><span class="hs-identifier hs-type">cid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Exp"><span class="hs-identifier hs-type">C.Exp</span></a></span><span>
</span><span id="line-1665"></span><span id="cid"><span class="annot"><span class="annottext">cid :: Var -&gt; Exp
</span><a href="Gibbon.Passes.Codegen.html#cid"><span class="hs-identifier hs-var hs-var">cid</span></a></span></span><span> </span><span id="local-6989586621680954307"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680954307"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Id -&gt; SrcLoc -&gt; Exp
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Var"><span class="hs-identifier hs-var">C.Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; SrcLoc -&gt; Id
forall a. ToIdent a =&gt; a -&gt; SrcLoc -&gt; Id
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Quote.Base.html#toIdent"><span class="hs-identifier hs-var">C.toIdent</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680954307"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SrcLoc
forall a. IsLocation a =&gt; a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/srcloc-0.6.0.1-429a1d1af1fac7e927d5a2315ae059551b357960b259db2fc19bc3d7640ced0f/share/doc/html/src/Data.Loc.html#noLoc"><span class="hs-identifier hs-var">noLoc</span></a></span><span>
</span><span id="line-1666"></span><span>
</span><span id="line-1667"></span><span class="annot"><a href="Gibbon.Passes.Codegen.html#toStmt"><span class="hs-identifier hs-type">toStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Exp"><span class="hs-identifier hs-type">C.Exp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockItem"><span class="hs-identifier hs-type">C.BlockItem</span></a></span><span>
</span><span id="line-1668"></span><span id="toStmt"><span class="annot"><span class="annottext">toStmt :: Exp -&gt; BlockItem
</span><a href="Gibbon.Passes.Codegen.html#toStmt"><span class="hs-identifier hs-var hs-var">toStmt</span></a></span></span><span> </span><span id="local-6989586621680954309"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621680954309"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| $exp:x; |]</span></span><span>
</span><span id="line-1669"></span><span>
</span><span id="line-1670"></span><span class="annot"><span class="hs-comment">-- | Create a NEW lexical binding.</span></span><span>
</span><span id="line-1671"></span><span id="local-6989586621680954310"><span id="local-6989586621680954311"><span class="annot"><a href="Gibbon.Passes.Codegen.html#assn"><span class="hs-identifier hs-type">assn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Quote.Base.html#ToIdent"><span class="hs-identifier hs-type">C.ToIdent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680954310"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Quote.Base.html#ToExp"><span class="hs-identifier hs-type">C.ToExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680954311"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Type"><span class="hs-identifier hs-type">C.Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680954310"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680954311"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockItem"><span class="hs-identifier hs-type">C.BlockItem</span></a></span></span></span><span>
</span><span id="line-1672"></span><span id="assn"><span class="annot"><span class="annottext">assn :: forall v e. (ToIdent v, ToExp e) =&gt; Type -&gt; v -&gt; e -&gt; BlockItem
</span><a href="Gibbon.Passes.Codegen.html#assn"><span class="hs-identifier hs-var hs-var">assn</span></a></span></span><span> </span><span id="local-6989586621680954316"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680954316"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621680954317"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680954317"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621680954318"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680954318"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">InitGroup -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockDecl"><span class="hs-identifier hs-var">C.BlockDecl</span></a></span><span> </span><span class="annot"><span class="">[cdecl| $ty:t $id:x = $exp:y; |]</span></span><span>
</span><span id="line-1673"></span><span>
</span><span id="line-1674"></span><span class="annot"><span class="hs-comment">-- | Mutate an existing binding:</span></span><span>
</span><span id="line-1675"></span><span id="local-6989586621680950477"><span id="local-6989586621680950478"><span class="annot"><a href="Gibbon.Passes.Codegen.html#mut"><span class="hs-identifier hs-type">mut</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Quote.Base.html#ToIdent"><span class="hs-identifier hs-type">C.ToIdent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950477"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Quote.Base.html#ToExp"><span class="hs-identifier hs-type">C.ToExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680950478"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#Type"><span class="hs-identifier hs-type">C.Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680950477"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680950478"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockItem"><span class="hs-identifier hs-type">C.BlockItem</span></a></span></span></span><span>
</span><span id="line-1676"></span><span id="mut"><span class="annot"><span class="annottext">mut :: forall v e. (ToIdent v, ToExp e) =&gt; Type -&gt; v -&gt; e -&gt; BlockItem
</span><a href="Gibbon.Passes.Codegen.html#mut"><span class="hs-identifier hs-var hs-var">mut</span></a></span></span><span> </span><span id="local-6989586621680954328"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680954328"><span class="hs-identifier hs-var">_t</span></a></span></span><span> </span><span id="local-6989586621680954329"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621680954329"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621680954330"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680954330"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stm -&gt; BlockItem
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/language-c-quote-0.13.0.1-69f64301b208cf2dba05598c02fa0a3aace56ed77c8514f17afdbebcd187c4f6/share/doc/html/src/Language.C.Syntax.html#BlockStm"><span class="hs-identifier hs-var">C.BlockStm</span></a></span><span> </span><span class="annot"><span class="">[cstm| $id:x = $exp:y; |]</span></span><span>
</span><span id="line-1677"></span></pre></body></html>
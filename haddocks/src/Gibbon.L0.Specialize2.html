<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-comment">{- L0 Specializer (part 2):
~~~~~~~~~~~~~~~~~~~~~~~~~~~

Paulette worked on a specializer which lives in 'Gibbon.L0.Specialize'
and specializes functions on curried calls. Now we need a driver which
takes these different pieces, and puts them together in order to
transform a fully polymorphic L0 program, into a monomorphic L1 program.
This module is the first attempt to do that.

-}</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Gibbon.L0.Specialize2</span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Specialize2.html#bindLambdas"><span class="hs-identifier">bindLambdas</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#monomorphize"><span class="hs-identifier">monomorphize</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#specLambdas"><span class="hs-identifier">specLambdas</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#desugarL0"><span class="hs-identifier">desugarL0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#toL1"><span class="hs-identifier">toL1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#floatOutCase"><span class="hs-identifier">floatOutCase</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.html"><span class="hs-identifier">Control.Monad.State</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldlM"><span class="hs-identifier">foldlM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldrM"><span class="hs-identifier">foldrM</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.html"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Stack.html"><span class="hs-identifier">GHC.Stack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier">HasCallStack</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/GenericPretty-1.2.2-7277c36a966d41cd8e1371a7ee4c855b29a76e94dfe1d95510f68242766a5b82/share/doc/html/src/Text.PrettyPrint.GenericPretty.html"><span class="hs-identifier">Text.PrettyPrint.GenericPretty</span></a></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Common.html"><span class="hs-identifier">Gibbon.Common</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Pretty.html"><span class="hs-identifier">Gibbon.Pretty</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.L0.Syntax.html"><span class="hs-identifier">Gibbon.L0.Syntax</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.L0.Typecheck.html"><span class="hs-identifier">Gibbon.L0.Typecheck</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html"><span class="hs-identifier">Gibbon.L1.Syntax</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L1</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Bifunctor.html"><span class="hs-identifier">Data.Bifunctor</span></a></span><span>
</span><span id="line-34"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-comment">{-

Transforming L0 to L1
~~~~~~~~~~~~~~~~~~~~~

(A) Monomorphization
(B) Lambda lifting (via specialization)
(C) Convert to L1, which should be pretty straightforward at this point.



Monomorphization
~~~~~~~~~~~~~~~~

Things that can be polymorphic, and therefore should be monormorphized:
- top-level fn calls
- lamda functions
- datacons

Here's a rough plan:

(0) Walk over all datatypes and functions to collect obligations for
    polymorphic types which have been fully applied to monomorphic types in the
    source program. For example, in a function 'f :: Int -&gt; Maybe Int', we must
    replace 'Maybe Int' with an appropriate monomorphic alternative.


(1) Start with main: walk over it, and collect all monomorphization obligations:

        { [((fn_name, [tyapp]), newname)] , [((lam_name, [tyapp]), newname)] , [((tycon, [tyapp]), newname)] }

    i.e fn_name should be monomorphized at [tyapp], and it should be named newname.

    While collecting these obligations, just replace all polymorphic things with their
    corresponding new names.

(1.2) 'main' can transitively call a polymorphic function via a monomorphic one.
      To collect those obligations, we walk over all the monomorphic functions in
      the program as well.

(2) Start monormorphizing toplevel functions, and collect any new obligations
    that may be generated. Repeat (2) until there are no more obls.

(3) Create monomorphic versions of all datatypes.

(4) After we have all the monomorphic datatypes, we need to fix TYPEs in (Packed TYPE ..) to
    have the correct suffix. Actually, this could be done in 'collectMonoObls', but we do
    it in a separate pass for now.

(5) Delete all polymorphic fns and datatypes, which should all just be dead code now.

(6) Typecheck monomorphic L0 once more.

TODOs:

(*) Curried functions are not supported atm (not even by the typechecker):
    they're a bit tricky to get right as Gibbon functions can only accept 1 argument.
(*) Support minimal 'import's in 'Gibbon.HaskellFronted'.
(*) Anonymous lambdas


Lambda lifting
~~~~~~~~~~~~~~

Assume that the input program is monomorphic.

(a) Traverse all expressions in the program (main and functions), and
    float out all lambda definitions to the top-level.

(b) Collect all function references passed in as arguments to other functions.
    E.g.

        foo :: (A -&gt; B) -&gt; A -&gt; B
        main = ... (foo fn1 thing1) ... (foo fn2 thing2) ...

     =&gt; [ ((foo, [fn1]), foo_1), ((foo, [fn2]), foo_2), ... ]


(c) (foo fn1) and (foo fn2) would now be separate top-level first order functions:

        foo_1 :: A -&gt; B
        foo_1 thing = ... fn1 thing ...

        foo_2 :: A -&gt; B
        foo_2 thing = ... fn2 thing ...

    Create these functions, drop the lambdas from it's type, arguments etc.

-}</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-comment">-- Just a mechanical transformation ..</span><span>
</span><span id="line-127"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#toL1"><span class="hs-identifier hs-type">toL1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Prog0"><span class="hs-identifier hs-type">Prog0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Prog1"><span class="hs-identifier hs-type">L1.Prog1</span></a></span><span>
</span><span id="line-128"></span><span id="toL1"><span class="annot"><span class="annottext">toL1 :: Prog0 -&gt; Prog1
</span><a href="Gibbon.L0.Specialize2.html#toL1"><span class="hs-identifier hs-var hs-var">toL1</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span class="hs-special">{</span><span id="local-6989586621680986061"><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
ddefs :: DDefs (TyOf Exp0)
ddefs :: forall ex. Prog ex -&gt; DDefs (TyOf ex)
</span><a href="#local-6989586621680986061"><span class="hs-identifier hs-var hs-var">ddefs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680986063"><span class="annot"><span class="annottext">FunDefs Exp0
fundefs :: FunDefs Exp0
fundefs :: forall ex. Prog ex -&gt; FunDefs ex
</span><a href="#local-6989586621680986063"><span class="hs-identifier hs-var hs-var">fundefs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680986065"><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
mainExp :: Maybe (Exp0, TyOf Exp0)
mainExp :: forall ex. Prog ex -&gt; Maybe (ex, TyOf ex)
</span><a href="#local-6989586621680986065"><span class="hs-identifier hs-var hs-var">mainExp</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-129"></span><span>   </span><span class="annot"><span class="annottext">DDefs (TyOf Exp1)
-&gt; FunDefs Exp1 -&gt; Maybe (Exp1, TyOf Exp1) -&gt; Prog1
forall ex.
DDefs (TyOf ex) -&gt; FunDefs ex -&gt; Maybe (ex, TyOf ex) -&gt; Prog ex
</span><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-var">Prog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DDef0 -&gt; DDef1) -&gt; Map Var DDef0 -&gt; Map Var DDef1
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#map"><span class="hs-identifier hs-var">M.map</span></a></span><span> </span><span class="annot"><span class="annottext">DDef0 -&gt; DDef1
</span><a href="#local-6989586621680986068"><span class="hs-identifier hs-var">toL1DDef</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
Map Var DDef0
</span><a href="#local-6989586621680986061"><span class="hs-identifier hs-var">ddefs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FunDef0 -&gt; FunDef Exp1) -&gt; FunDefs Exp0 -&gt; FunDefs Exp1
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#map"><span class="hs-identifier hs-var">M.map</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef0 -&gt; FunDef Exp1
</span><a href="#local-6989586621680986069"><span class="hs-identifier hs-var">toL1FunDef</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680986063"><span class="hs-identifier hs-var">fundefs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp1, TyOf Exp1)
Maybe (Exp1, Ty1)
</span><a href="#local-6989586621680986070"><span class="hs-identifier hs-var">mainExp'</span></a></span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-131"></span><span>    </span><span id="local-6989586621680986070"><span class="annot"><span class="annottext">mainExp' :: Maybe (Exp1, Ty1)
</span><a href="#local-6989586621680986070"><span class="hs-identifier hs-var hs-var">mainExp'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
</span><a href="#local-6989586621680986065"><span class="hs-identifier hs-var">mainExp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-132"></span><span>                 </span><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp1, Ty1)
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-133"></span><span>                 </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680986071"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986071"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680986072"><span class="annot"><span class="annottext">TyOf Exp0
</span><a href="#local-6989586621680986072"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Exp1, Ty1) -&gt; Maybe (Exp1, Ty1)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; Exp1
</span><a href="#local-6989586621680986073"><span class="hs-identifier hs-var">toL1Exp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986071"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; Ty1
</span><a href="#local-6989586621680986074"><span class="hs-identifier hs-var">toL1Ty</span></a></span><span> </span><span class="annot"><span class="annottext">TyOf Exp0
Ty0
</span><a href="#local-6989586621680986072"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span>    </span><span class="annot"><a href="#local-6989586621680986068"><span class="hs-identifier hs-type">toL1DDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#DDef0"><span class="hs-identifier hs-type">DDef0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#DDef1"><span class="hs-identifier hs-type">L1.DDef1</span></a></span><span>
</span><span id="line-136"></span><span>    </span><span id="local-6989586621680986068"><span class="annot"><span class="annottext">toL1DDef :: DDef0 -&gt; DDef1
</span><a href="#local-6989586621680986068"><span class="hs-identifier hs-var hs-var">toL1DDef</span></a></span></span><span> </span><span id="local-6989586621680986075"><span class="annot"><span class="annottext">ddf :: DDef0
</span><a href="#local-6989586621680986075"><span class="hs-identifier hs-var">ddf</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Language.Syntax.html#DDef"><span class="hs-identifier hs-type">DDef</span></a></span><span class="hs-special">{</span><span id="local-6989586621680986077"><span class="annot"><span class="annottext">[([Char], [(IsBoxed, Ty0)])]
dataCons :: [([Char], [(IsBoxed, Ty0)])]
dataCons :: forall a. DDef a -&gt; [([Char], [(IsBoxed, a)])]
</span><a href="#local-6989586621680986077"><span class="hs-identifier hs-var hs-var">dataCons</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-137"></span><span>      </span><span class="annot"><span class="annottext">DDef0
</span><a href="#local-6989586621680986075"><span class="hs-identifier hs-var">ddf</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dataCons :: [([Char], [(IsBoxed, Ty1)])]
</span><a href="Gibbon.Language.Syntax.html#dataCons"><span class="hs-identifier hs-var">dataCons</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([Char], [(IsBoxed, Ty0)]) -&gt; ([Char], [(IsBoxed, Ty1)]))
-&gt; [([Char], [(IsBoxed, Ty0)])] -&gt; [([Char], [(IsBoxed, Ty1)])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680986079"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680986079"><span class="hs-identifier hs-var">dcon</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680986080"><span class="annot"><span class="annottext">[(IsBoxed, Ty0)]
</span><a href="#local-6989586621680986080"><span class="hs-identifier hs-var">btys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680986079"><span class="hs-identifier hs-var">dcon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">((IsBoxed, Ty0) -&gt; (IsBoxed, Ty1))
-&gt; [(IsBoxed, Ty0)] -&gt; [(IsBoxed, Ty1)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680986081"><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680986081"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680986082"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986082"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680986081"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; Ty1
</span><a href="#local-6989586621680986074"><span class="hs-identifier hs-var">toL1Ty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986082"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(IsBoxed, Ty0)]
</span><a href="#local-6989586621680986080"><span class="hs-identifier hs-var">btys</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[([Char], [(IsBoxed, Ty0)])]
</span><a href="#local-6989586621680986077"><span class="hs-identifier hs-var">dataCons</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span>    </span><span class="annot"><a href="#local-6989586621680986069"><span class="hs-identifier hs-type">toL1FunDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunDef0"><span class="hs-identifier hs-type">FunDef0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#FunDef1"><span class="hs-identifier hs-type">L1.FunDef1</span></a></span><span>
</span><span id="line-140"></span><span>    </span><span id="local-6989586621680986069"><span class="annot"><span class="annottext">toL1FunDef :: FunDef0 -&gt; FunDef Exp1
</span><a href="#local-6989586621680986069"><span class="hs-identifier hs-var hs-var">toL1FunDef</span></a></span></span><span> </span><span id="local-6989586621680986084"><span class="annot"><span class="annottext">fn :: FunDef0
</span><a href="#local-6989586621680986084"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span class="hs-special">{</span><span id="local-6989586621680986086"><span class="annot"><span class="annottext">ArrowTy (TyOf Exp0)
funTy :: ArrowTy (TyOf Exp0)
funTy :: forall ex. FunDef ex -&gt; ArrowTy (TyOf ex)
</span><a href="#local-6989586621680986086"><span class="hs-identifier hs-var hs-var">funTy</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680986088"><span class="annot"><span class="annottext">Exp0
funBody :: Exp0
funBody :: forall ex. FunDef ex -&gt; ex
</span><a href="#local-6989586621680986088"><span class="hs-identifier hs-var hs-var">funBody</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-141"></span><span>      </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680986084"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funTy :: ArrowTy (TyOf Exp1)
</span><a href="Gibbon.Language.Syntax.html#funTy"><span class="hs-identifier hs-var">funTy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArrowTy Ty0 -&gt; ArrowTy Ty1
</span><a href="#local-6989586621680986090"><span class="hs-identifier hs-var">toL1TyS</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy (TyOf Exp0)
ArrowTy Ty0
</span><a href="#local-6989586621680986086"><span class="hs-identifier hs-var">funTy</span></a></span><span>
</span><span id="line-142"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funBody :: Exp1
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp1
</span><a href="#local-6989586621680986073"><span class="hs-identifier hs-var">toL1Exp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986088"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span>    </span><span class="annot"><a href="#local-6989586621680986073"><span class="hs-identifier hs-type">toL1Exp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Exp1"><span class="hs-identifier hs-type">L1.Exp1</span></a></span><span>
</span><span id="line-145"></span><span>    </span><span id="local-6989586621680986073"><span class="annot"><span class="annottext">toL1Exp :: Exp0 -&gt; Exp1
</span><a href="#local-6989586621680986073"><span class="hs-identifier hs-var hs-var">toL1Exp</span></a></span></span><span> </span><span id="local-6989586621680986091"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986091"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-146"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986091"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-147"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span id="local-6989586621680986093"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986093"><span class="hs-identifier hs-var">v</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">L1.VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986093"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-148"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-type">LitE</span></a></span><span> </span><span id="local-6989586621680986095"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680986095"><span class="hs-identifier hs-var">n</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec. Int -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-var">L1.LitE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680986095"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-149"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CharE"><span class="hs-identifier hs-type">CharE</span></a></span><span> </span><span id="local-6989586621680986097"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680986097"><span class="hs-identifier hs-var">n</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec. Char -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CharE"><span class="hs-identifier hs-var">L1.CharE</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680986097"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-150"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-type">FloatE</span></a></span><span> </span><span id="local-6989586621680986099"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680986099"><span class="hs-identifier hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec. Double -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-var">L1.FloatE</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680986099"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-151"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-type">LitSymE</span></a></span><span> </span><span id="local-6989586621680986101"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986101"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-var">L1.LitSymE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986101"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-152"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span id="local-6989586621680986103"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986103"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621680986104"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680986104"><span class="hs-identifier hs-var">args</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [()] -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986103"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp1) -&gt; [Exp0] -&gt; [Exp1]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp1
</span><a href="#local-6989586621680986073"><span class="hs-identifier hs-var">toL1Exp</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680986104"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp1
forall {a}. [Char] -&gt; a
</span><a href="#local-6989586621680986105"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986091"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span id="local-6989586621680986108"><span class="annot"><span class="annottext">Prim Ty0
</span><a href="#local-6989586621680986108"><span class="hs-identifier hs-var">pr</span></a></span></span><span> </span><span id="local-6989586621680986109"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680986109"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-155"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Prim Ty0
</span><a href="#local-6989586621680986108"><span class="hs-identifier hs-var">pr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-156"></span><span>            </span><span class="hs-comment">-- This is always going to have a function reference which</span><span>
</span><span id="line-157"></span><span>            </span><span class="hs-comment">-- we cannot eliminate.</span><span>
</span><span id="line-158"></span><span>            </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VSortP"><span class="hs-identifier hs-type">VSortP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-159"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680986109"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-160"></span><span>                </span><span class="hs-special">[</span><span id="local-6989586621680986111"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986111"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunRefE"><span class="hs-identifier hs-type">FunRefE</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680986114"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986114"><span class="hs-identifier hs-var">fp</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-161"></span><span>                  </span><span class="annot"><span class="annottext">Prim Ty1 -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prim Ty0 -&gt; Prim Ty1
</span><a href="#local-6989586621680986115"><span class="hs-identifier hs-var">toL1Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0
</span><a href="#local-6989586621680986108"><span class="hs-identifier hs-var">pr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp0 -&gt; Exp1
</span><a href="#local-6989586621680986073"><span class="hs-identifier hs-var">toL1Exp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986111"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986114"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-162"></span><span>                </span><span class="hs-special">[</span><span id="local-6989586621680986116"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986116"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">Loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunRefE"><span class="hs-identifier hs-type">FunRefE</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680986118"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986118"><span class="hs-identifier hs-var">fp</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-163"></span><span>                  </span><span class="annot"><span class="annottext">Prim Ty1 -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prim Ty0 -&gt; Prim Ty1
</span><a href="#local-6989586621680986115"><span class="hs-identifier hs-var">toL1Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0
</span><a href="#local-6989586621680986108"><span class="hs-identifier hs-var">pr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp0 -&gt; Exp1
</span><a href="#local-6989586621680986073"><span class="hs-identifier hs-var">toL1Exp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986116"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986118"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-164"></span><span>                </span><span class="annot"><span class="annottext">[Exp0]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty1 -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prim Ty0 -&gt; Prim Ty1
</span><a href="#local-6989586621680986115"><span class="hs-identifier hs-var">toL1Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0
</span><a href="#local-6989586621680986108"><span class="hs-identifier hs-var">pr</span></a></span><span class="hs-special">)</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp1) -&gt; [Exp0] -&gt; [Exp1]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp1
</span><a href="#local-6989586621680986073"><span class="hs-identifier hs-var">toL1Exp</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680986109"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>            </span><span class="annot"><span class="annottext">Prim Ty0
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty1 -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prim Ty0 -&gt; Prim Ty1
</span><a href="#local-6989586621680986115"><span class="hs-identifier hs-var">toL1Prim</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0
</span><a href="#local-6989586621680986108"><span class="hs-identifier hs-var">pr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp1) -&gt; [Exp0] -&gt; [Exp1]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp1
</span><a href="#local-6989586621680986073"><span class="hs-identifier hs-var">toL1Exp</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680986109"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680986120"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986120"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span id="local-6989586621680986121"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986121"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680986122"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986122"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680986123"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986123"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Var, [()], Ty1, Exp1) -&gt; Exp1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986120"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; Ty1
</span><a href="#local-6989586621680986074"><span class="hs-identifier hs-var">toL1Ty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986121"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp1
</span><a href="#local-6989586621680986073"><span class="hs-identifier hs-var">toL1Exp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986122"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; Exp1
</span><a href="#local-6989586621680986073"><span class="hs-identifier hs-var">toL1Exp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986123"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp1
forall {a}. [Char] -&gt; a
</span><a href="#local-6989586621680986105"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986091"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-type">IfE</span></a></span><span> </span><span id="local-6989586621680986125"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986125"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680986126"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986126"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680986127"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986127"><span class="hs-identifier hs-var">c</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; Exp1 -&gt; Exp1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-var">IfE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; Exp1
</span><a href="#local-6989586621680986073"><span class="hs-identifier hs-var">toL1Exp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986125"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; Exp1
</span><a href="#local-6989586621680986073"><span class="hs-identifier hs-var">toL1Exp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986126"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; Exp1
</span><a href="#local-6989586621680986073"><span class="hs-identifier hs-var">toL1Exp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986127"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-type">MkProdE</span></a></span><span> </span><span id="local-6989586621680986129"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680986129"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
[PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-var">MkProdE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp1) -&gt; [Exp0] -&gt; [Exp1]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp1
</span><a href="#local-6989586621680986073"><span class="hs-identifier hs-var">toL1Exp</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680986129"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-type">ProjE</span></a></span><span> </span><span id="local-6989586621680986131"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680986131"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680986132"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986132"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Exp1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Int -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-var">ProjE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680986131"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; Exp1
</span><a href="#local-6989586621680986073"><span class="hs-identifier hs-var">toL1Exp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986132"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-type">CaseE</span></a></span><span> </span><span id="local-6989586621680986134"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986134"><span class="hs-identifier hs-var">scrt</span></a></span></span><span> </span><span id="local-6989586621680986135"><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680986135"><span class="hs-identifier hs-var">brs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; [([Char], [(Var, ())], Exp1)] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; [([Char], [(Var, loc)], PreExp ext loc dec)]
-&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-var">CaseE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; Exp1
</span><a href="#local-6989586621680986073"><span class="hs-identifier hs-var">toL1Exp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986134"><span class="hs-identifier hs-var">scrt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(([Char], [(Var, Ty0)], Exp0) -&gt; ([Char], [(Var, ())], Exp1))
-&gt; [([Char], [(Var, Ty0)], Exp0)] -&gt; [([Char], [(Var, ())], Exp1)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680986136"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680986136"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680986137"><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680986137"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680986138"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986138"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680986136"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-172"></span><span>                                                                  </span><span class="annot"><span class="annottext">((Var, Ty0) -&gt; (Var, ())) -&gt; [(Var, Ty0)] -&gt; [(Var, ())]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680986139"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986139"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986139"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680986137"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-173"></span><span>                                                                  </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp1
</span><a href="#local-6989586621680986073"><span class="hs-identifier hs-var">toL1Exp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986138"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>                                                    </span><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680986135"><span class="hs-identifier hs-var">brs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-type">DataConE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span id="local-6989586621680986142"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680986142"><span class="hs-identifier hs-var">dcon</span></a></span></span><span> </span><span id="local-6989586621680986143"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680986143"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; [Char] -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
loc -&gt; [Char] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-var">DataConE</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680986142"><span class="hs-identifier hs-var">dcon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp1) -&gt; [Exp0] -&gt; [Exp1]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp1
</span><a href="#local-6989586621680986073"><span class="hs-identifier hs-var">toL1Exp</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680986143"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-type">DataConE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp1
forall {a}. [Char] -&gt; a
</span><a href="#local-6989586621680986105"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986091"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-type">TimeIt</span></a></span><span> </span><span id="local-6989586621680986145"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986145"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680986146"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986146"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680986147"><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680986147"><span class="hs-identifier hs-var">b</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; Ty1 -&gt; IsBoxed -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec -&gt; dec -&gt; IsBoxed -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-var">TimeIt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; Exp1
</span><a href="#local-6989586621680986073"><span class="hs-identifier hs-var">toL1Exp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986145"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; Ty1
</span><a href="#local-6989586621680986074"><span class="hs-identifier hs-var">toL1Ty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986146"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680986147"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-178"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-type">SpawnE</span></a></span><span> </span><span id="local-6989586621680986149"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986149"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621680986150"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680986150"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [()] -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-var">SpawnE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986149"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp1) -&gt; [Exp0] -&gt; [Exp1]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp1
</span><a href="#local-6989586621680986073"><span class="hs-identifier hs-var">toL1Exp</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680986150"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-type">SpawnE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp1
forall {a}. [Char] -&gt; a
</span><a href="#local-6989586621680986105"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986091"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>        </span><span class="annot"><span class="annottext">Exp0
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec. PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span>
</span><span id="line-181"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-type">WithArenaE</span></a></span><span> </span><span id="local-6989586621680986153"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986153"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680986154"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986154"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-var">WithArenaE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986153"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; Exp1
</span><a href="#local-6989586621680986073"><span class="hs-identifier hs-var">toL1Exp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986154"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MapE"><span class="hs-identifier hs-type">MapE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp1
forall {a}. [Char] -&gt; a
</span><a href="#local-6989586621680986105"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986091"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FoldE"><span class="hs-identifier hs-type">FoldE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp1
forall {a}. [Char] -&gt; a
</span><a href="#local-6989586621680986105"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986091"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span id="local-6989586621680986157"><span class="annot"><span class="annottext">E0Ext Ty0 Ty0
</span><a href="#local-6989586621680986157"><span class="hs-identifier hs-var">ext</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-185"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0
</span><a href="#local-6989586621680986157"><span class="hs-identifier hs-var">ext</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-186"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#LambdaE"><span class="hs-identifier hs-type">LambdaE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp1
forall {a}. [Char] -&gt; a
</span><a href="#local-6989586621680986159"><span class="hs-identifier hs-var">err2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986091"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#PolyAppE"><span class="hs-identifier hs-type">PolyAppE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp1
forall {a}. [Char] -&gt; a
</span><a href="#local-6989586621680986159"><span class="hs-identifier hs-var">err2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986091"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunRefE"><span class="hs-identifier hs-type">FunRefE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp1
forall {a}. [Char] -&gt; a
</span><a href="#local-6989586621680986159"><span class="hs-identifier hs-var">err2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986091"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#BenchE"><span class="hs-identifier hs-type">BenchE</span></a></span><span> </span><span id="local-6989586621680986162"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986162"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621680986163"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986163"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span> </span><span id="local-6989586621680986164"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680986164"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621680986165"><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680986165"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-190"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986163"><span class="hs-identifier hs-var">tyapps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-191"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">E1Ext () Ty1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E1Ext () Ty1 -&gt; Exp1) -&gt; E1Ext () Ty1 -&gt; Exp1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [()] -&gt; [Exp1] -&gt; IsBoxed -&gt; E1Ext () Ty1
forall loc dec.
Var -&gt; [loc] -&gt; [PreExp E1Ext loc dec] -&gt; IsBoxed -&gt; E1Ext loc dec
</span><a href="Gibbon.L1.Syntax.html#BenchE"><span class="hs-identifier hs-var">L1.BenchE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986162"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp1) -&gt; [Exp0] -&gt; [Exp1]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp1
</span><a href="#local-6989586621680986073"><span class="hs-identifier hs-var">toL1Exp</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680986164"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680986165"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-192"></span><span>                </span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp1
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;toL1: Polymorphic 'bench' not supported yet.&quot;</span></span><span>
</span><span id="line-193"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#ParE0"><span class="hs-identifier hs-type">ParE0</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp1
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;toL1: ParE0&quot;</span></span><span>
</span><span id="line-194"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#PrintPacked"><span class="hs-identifier hs-type">PrintPacked</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp1
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;toL1: PrintPacked&quot;</span></span><span>
</span><span id="line-195"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#CopyPacked"><span class="hs-identifier hs-type">CopyPacked</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp1
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;toL1: CopyPacked&quot;</span></span><span>
</span><span id="line-196"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#TravPacked"><span class="hs-identifier hs-type">TravPacked</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp1
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;toL1: TravPacked&quot;</span></span><span>
</span><span id="line-197"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#LinearExt"><span class="hs-identifier hs-type">LinearExt</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp1
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Exp1) -&gt; [Char] -&gt; Exp1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;toL1: a linear types extension wasn't desugared: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986091"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-198"></span><span>            </span><span class="hs-comment">-- Erase srclocs while going to L1</span><span>
</span><span id="line-199"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">Loc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680986173"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986173"><span class="hs-identifier hs-var">e</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp1
</span><a href="#local-6989586621680986073"><span class="hs-identifier hs-var">toL1Exp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986173"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span>    </span><span class="annot"><a href="#local-6989586621680986115"><span class="hs-identifier hs-type">toL1Prim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Ty1"><span class="hs-identifier hs-type">L1.Ty1</span></a></span><span>
</span><span id="line-202"></span><span>    </span><span id="local-6989586621680986115"><span class="annot"><span class="annottext">toL1Prim :: Prim Ty0 -&gt; Prim Ty1
</span><a href="#local-6989586621680986115"><span class="hs-identifier hs-var hs-var">toL1Prim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; Ty1) -&gt; Prim Ty0 -&gt; Prim Ty1
forall a b. (a -&gt; b) -&gt; Prim a -&gt; Prim b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; Ty1
</span><a href="#local-6989586621680986074"><span class="hs-identifier hs-var">toL1Ty</span></a></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><a href="#local-6989586621680986074"><span class="hs-identifier hs-type">toL1Ty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Ty1"><span class="hs-identifier hs-type">L1.Ty1</span></a></span><span>
</span><span id="line-205"></span><span>    </span><span id="local-6989586621680986074"><span class="annot"><span class="annottext">toL1Ty :: Ty0 -&gt; Ty1
</span><a href="#local-6989586621680986074"><span class="hs-identifier hs-var hs-var">toL1Ty</span></a></span></span><span> </span><span id="local-6989586621680986174"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986174"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-206"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986174"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-207"></span><span>        </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#CharTy"><span class="hs-identifier hs-var">CharTy</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#CharTy"><span class="hs-identifier hs-var">L1.CharTy</span></a></span><span>
</span><span id="line-208"></span><span>        </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#IntTy"><span class="hs-identifier hs-var">IntTy</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#IntTy"><span class="hs-identifier hs-var">L1.IntTy</span></a></span><span>
</span><span id="line-209"></span><span>        </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#FloatTy"><span class="hs-identifier hs-var">FloatTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#FloatTy"><span class="hs-identifier hs-var">L1.FloatTy</span></a></span><span>
</span><span id="line-210"></span><span>        </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#SymTy0"><span class="hs-identifier hs-var">SymTy0</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#SymTy"><span class="hs-identifier hs-var">L1.SymTy</span></a></span><span>
</span><span id="line-211"></span><span>        </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#BoolTy"><span class="hs-identifier hs-var">BoolTy</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#BoolTy"><span class="hs-identifier hs-var">L1.BoolTy</span></a></span><span>
</span><span id="line-212"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Ty1
forall {a}. [Char] -&gt; a
</span><a href="#local-6989586621680986105"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986174"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#MetaTv"><span class="hs-identifier hs-type">MetaTv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Ty1
forall {a}. [Char] -&gt; a
</span><a href="#local-6989586621680986105"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986174"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680986187"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986187"><span class="hs-identifier hs-var">tys</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Ty1] -&gt; Ty1
forall loc. [UrTy loc] -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#ProdTy"><span class="hs-identifier hs-var">L1.ProdTy</span></a></span><span> </span><span class="annot"><span class="annottext">([Ty1] -&gt; Ty1) -&gt; [Ty1] -&gt; Ty1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; Ty1) -&gt; [Ty0] -&gt; [Ty1]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; Ty1
</span><a href="#local-6989586621680986074"><span class="hs-identifier hs-var">toL1Ty</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986187"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-215"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#SymDictTy"><span class="hs-identifier hs-type">SymDictTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680986190"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986190"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680986191"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986191"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Var -&gt; Ty1 -&gt; Ty1
forall loc. Maybe Var -&gt; Ty1 -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#SymDictTy"><span class="hs-identifier hs-var">L1.SymDictTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Maybe Var
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986190"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Ty1 -&gt; Ty1) -&gt; Ty1 -&gt; Ty1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; Ty1
</span><a href="#local-6989586621680986074"><span class="hs-identifier hs-var">toL1Ty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986191"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-216"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#SymDictTy"><span class="hs-identifier hs-type">SymDictTy</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Var
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span id="local-6989586621680986193"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986193"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Var -&gt; Ty1 -&gt; Ty1
forall loc. Maybe Var -&gt; Ty1 -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#SymDictTy"><span class="hs-identifier hs-var">L1.SymDictTy</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Var
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">(Ty1 -&gt; Ty1) -&gt; Ty1 -&gt; Ty1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; Ty1
</span><a href="#local-6989586621680986074"><span class="hs-identifier hs-var">toL1Ty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986193"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-217"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#PDictTy"><span class="hs-identifier hs-type">PDictTy</span></a></span><span> </span><span id="local-6989586621680986195"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986195"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680986196"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986196"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; Ty1 -&gt; Ty1
forall loc. UrTy loc -&gt; UrTy loc -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#PDictTy"><span class="hs-identifier hs-var">L1.PDictTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; Ty1
</span><a href="#local-6989586621680986074"><span class="hs-identifier hs-var">toL1Ty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986195"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; Ty1
</span><a href="#local-6989586621680986074"><span class="hs-identifier hs-var">toL1Ty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986196"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#ArrowTy"><span class="hs-identifier hs-type">ArrowTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Ty1
forall {a}. [Char] -&gt; a
</span><a href="#local-6989586621680986159"><span class="hs-identifier hs-var">err2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986174"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span id="local-6989586621680986200"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680986200"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span id="local-6989586621680986201"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986201"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986201"><span class="hs-identifier hs-var">tyapps</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; [Ty0] -&gt; IsBoxed
forall a. Eq a =&gt; a -&gt; a -&gt; IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; () -&gt; Ty1
forall loc. [Char] -&gt; loc -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-var">L1.PackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680986200"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>                              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Ty1
forall {a}. [Char] -&gt; a
</span><a href="#local-6989586621680986105"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986174"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>        </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#ArenaTy"><span class="hs-identifier hs-var">ArenaTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#ArenaTy"><span class="hs-identifier hs-var">L1.ArenaTy</span></a></span><span>
</span><span id="line-222"></span><span>        </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#SymSetTy"><span class="hs-identifier hs-var">SymSetTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#SymSetTy"><span class="hs-identifier hs-var">L1.SymSetTy</span></a></span><span>
</span><span id="line-223"></span><span>        </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#SymHashTy"><span class="hs-identifier hs-var">SymHashTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#SymHashTy"><span class="hs-identifier hs-var">L1.SymHashTy</span></a></span><span>
</span><span id="line-224"></span><span>        </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#IntHashTy"><span class="hs-identifier hs-var">IntHashTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#IntHashTy"><span class="hs-identifier hs-var">L1.IntHashTy</span></a></span><span>
</span><span id="line-225"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#VectorTy"><span class="hs-identifier hs-type">VectorTy</span></a></span><span> </span><span id="local-6989586621680986212"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986212"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; Ty1
forall loc. UrTy loc -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#VectorTy"><span class="hs-identifier hs-var">L1.VectorTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; Ty1
</span><a href="#local-6989586621680986074"><span class="hs-identifier hs-var">toL1Ty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986212"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#ListTy"><span class="hs-identifier hs-type">ListTy</span></a></span><span> </span><span id="local-6989586621680986215"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986215"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; Ty1
forall loc. UrTy loc -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#ListTy"><span class="hs-identifier hs-var">L1.ListTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; Ty1
</span><a href="#local-6989586621680986074"><span class="hs-identifier hs-var">toL1Ty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986215"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span>    </span><span class="annot"><a href="#local-6989586621680986090"><span class="hs-identifier hs-type">toL1TyS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ArrowTy"><span class="hs-identifier hs-type">ArrowTy</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ArrowTy"><span class="hs-identifier hs-type">ArrowTy</span></a></span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Ty1"><span class="hs-identifier hs-type">L1.Ty1</span></a></span><span>
</span><span id="line-229"></span><span>    </span><span id="local-6989586621680986090"><span class="annot"><span class="annottext">toL1TyS :: ArrowTy Ty0 -&gt; ArrowTy Ty1
</span><a href="#local-6989586621680986090"><span class="hs-identifier hs-var hs-var">toL1TyS</span></a></span></span><span> </span><span id="local-6989586621680986217"><span class="annot"><span class="annottext">t :: ArrowTy Ty0
</span><a href="#local-6989586621680986217"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#ForAll"><span class="hs-identifier hs-type">ForAll</span></a></span><span> </span><span id="local-6989586621680986219"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680986219"><span class="hs-identifier hs-var">tyvars</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#ArrowTy"><span class="hs-identifier hs-type">ArrowTy</span></a></span><span> </span><span id="local-6989586621680986220"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986220"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621680986221"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986221"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680986219"><span class="hs-identifier hs-var">tyvars</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; [TyVar] -&gt; IsBoxed
forall a. Eq a =&gt; a -&gt; a -&gt; IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Ty0 -&gt; Ty1) -&gt; [Ty0] -&gt; [Ty1]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; Ty1
</span><a href="#local-6989586621680986074"><span class="hs-identifier hs-var">toL1Ty</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986220"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; Ty1
</span><a href="#local-6989586621680986074"><span class="hs-identifier hs-var">toL1Ty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986221"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ([Ty1], Ty1)
forall {a}. [Char] -&gt; a
</span><a href="#local-6989586621680986105"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyScheme -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy Ty0
TyScheme
</span><a href="#local-6989586621680986217"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>    </span><span class="annot"><a href="#local-6989586621680986090"><span class="hs-identifier hs-var">toL1TyS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#ForAll"><span class="hs-identifier hs-type">ForAll</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680986222"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986222"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ArrowTy Ty1
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; ArrowTy Ty1) -&gt; [Char] -&gt; ArrowTy Ty1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;toL1: Not a function type: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986222"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span>    </span><span id="local-6989586621680986105"><span class="annot"><span class="annottext">err1 :: [Char] -&gt; a
</span><a href="#local-6989586621680986105"><span class="hs-identifier hs-var hs-var">err1</span></a></span></span><span> </span><span id="local-6989586621680986227"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680986227"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; a
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; a) -&gt; [Char] -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;toL1: Program was not fully monomorphized. Encountered: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680986227"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span>    </span><span id="local-6989586621680986159"><span class="annot"><span class="annottext">err2 :: [Char] -&gt; a
</span><a href="#local-6989586621680986159"><span class="hs-identifier hs-var hs-var">err2</span></a></span></span><span> </span><span id="local-6989586621680986232"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680986232"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; a
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; a) -&gt; [Char] -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;toL1: Could not lift all lambdas. Encountered: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680986232"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-comment">-- The monomorphization monad.</span><span>
</span><span id="line-241"></span><span class="hs-keyword">type</span><span> </span><span id="MonoM"><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoM"><span class="hs-identifier hs-var">MonoM</span></a></span></span><span> </span><span id="local-6989586621680986233"><span class="annot"><a href="#local-6989586621680986233"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoState"><span class="hs-identifier hs-type">MonoState</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680986233"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-keyword">data</span><span> </span><span id="MonoState"><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoState"><span class="hs-identifier hs-var">MonoState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MonoState"><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoState"><span class="hs-identifier hs-var">MonoState</span></a></span></span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="mono_funs_worklist"><span class="annot"><span class="annottext">MonoState -&gt; Map (Var, [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_funs_worklist"><span class="hs-identifier hs-var hs-var">mono_funs_worklist</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">M.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="mono_funs_done"><span class="annot"><span class="annottext">MonoState -&gt; Map (Var, [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_funs_done"><span class="hs-identifier hs-var hs-var">mono_funs_done</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">M.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="mono_lams"><span class="annot"><span class="annottext">MonoState -&gt; Map (Var, [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_lams"><span class="hs-identifier hs-var hs-var">mono_lams</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">M.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="mono_dcons"><span class="annot"><span class="annottext">MonoState -&gt; Map ([Char], [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_dcons"><span class="hs-identifier hs-var hs-var">mono_dcons</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">M.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-comment">-- suffix</span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-249"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680986241"><span id="local-6989586621680986254"><span id="local-6989586621680986258"><span class="annot"><span class="annottext">Int -&gt; MonoState -&gt; [Char] -&gt; [Char]
[MonoState] -&gt; [Char] -&gt; [Char]
MonoState -&gt; [Char]
(Int -&gt; MonoState -&gt; [Char] -&gt; [Char])
-&gt; (MonoState -&gt; [Char])
-&gt; ([MonoState] -&gt; [Char] -&gt; [Char])
-&gt; Show MonoState
forall a.
(Int -&gt; a -&gt; [Char] -&gt; [Char])
-&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; [Char] -&gt; [Char]) -&gt; Show a
$cshowsPrec :: Int -&gt; MonoState -&gt; [Char] -&gt; [Char]
showsPrec :: Int -&gt; MonoState -&gt; [Char] -&gt; [Char]
$cshow :: MonoState -&gt; [Char]
show :: MonoState -&gt; [Char]
$cshowList :: [MonoState] -&gt; [Char] -&gt; [Char]
showList :: [MonoState] -&gt; [Char] -&gt; [Char]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680986271"><span id="local-6989586621680986275"><span id="local-6989586621680986278"><span id="local-6989586621680986303"><span class="annot"><span class="annottext">ReadPrec [MonoState]
ReadPrec MonoState
Int -&gt; ReadS MonoState
ReadS [MonoState]
(Int -&gt; ReadS MonoState)
-&gt; ReadS [MonoState]
-&gt; ReadPrec MonoState
-&gt; ReadPrec [MonoState]
-&gt; Read MonoState
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
$creadsPrec :: Int -&gt; ReadS MonoState
readsPrec :: Int -&gt; ReadS MonoState
$creadList :: ReadS [MonoState]
readList :: ReadS [MonoState]
$creadPrec :: ReadPrec MonoState
readPrec :: ReadPrec MonoState
$creadListPrec :: ReadPrec [MonoState]
readListPrec :: ReadPrec [MonoState]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Read.html#Read"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></a></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680986329"><span id="local-6989586621680986340"><span id="local-6989586621680986350"><span id="local-6989586621680986354"><span id="local-6989586621680986357"><span id="local-6989586621680986360"><span id="local-6989586621680986363"><span class="annot"><span class="annottext">Eq MonoState
Eq MonoState
-&gt; (MonoState -&gt; MonoState -&gt; Ordering)
-&gt; (MonoState -&gt; MonoState -&gt; IsBoxed)
-&gt; (MonoState -&gt; MonoState -&gt; IsBoxed)
-&gt; (MonoState -&gt; MonoState -&gt; IsBoxed)
-&gt; (MonoState -&gt; MonoState -&gt; IsBoxed)
-&gt; (MonoState -&gt; MonoState -&gt; MonoState)
-&gt; (MonoState -&gt; MonoState -&gt; MonoState)
-&gt; Ord MonoState
MonoState -&gt; MonoState -&gt; IsBoxed
MonoState -&gt; MonoState -&gt; Ordering
MonoState -&gt; MonoState -&gt; MonoState
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; IsBoxed)
-&gt; (a -&gt; a -&gt; IsBoxed)
-&gt; (a -&gt; a -&gt; IsBoxed)
-&gt; (a -&gt; a -&gt; IsBoxed)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: MonoState -&gt; MonoState -&gt; Ordering
compare :: MonoState -&gt; MonoState -&gt; Ordering
$c&lt; :: MonoState -&gt; MonoState -&gt; IsBoxed
&lt; :: MonoState -&gt; MonoState -&gt; IsBoxed
$c&lt;= :: MonoState -&gt; MonoState -&gt; IsBoxed
&lt;= :: MonoState -&gt; MonoState -&gt; IsBoxed
$c&gt; :: MonoState -&gt; MonoState -&gt; IsBoxed
&gt; :: MonoState -&gt; MonoState -&gt; IsBoxed
$c&gt;= :: MonoState -&gt; MonoState -&gt; IsBoxed
&gt;= :: MonoState -&gt; MonoState -&gt; IsBoxed
$cmax :: MonoState -&gt; MonoState -&gt; MonoState
max :: MonoState -&gt; MonoState -&gt; MonoState
$cmin :: MonoState -&gt; MonoState -&gt; MonoState
min :: MonoState -&gt; MonoState -&gt; MonoState
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680986375"><span id="local-6989586621680986386"><span class="annot"><span class="annottext">MonoState -&gt; MonoState -&gt; IsBoxed
(MonoState -&gt; MonoState -&gt; IsBoxed)
-&gt; (MonoState -&gt; MonoState -&gt; IsBoxed) -&gt; Eq MonoState
forall a. (a -&gt; a -&gt; IsBoxed) -&gt; (a -&gt; a -&gt; IsBoxed) -&gt; Eq a
$c== :: MonoState -&gt; MonoState -&gt; IsBoxed
== :: MonoState -&gt; MonoState -&gt; IsBoxed
$c/= :: MonoState -&gt; MonoState -&gt; IsBoxed
/= :: MonoState -&gt; MonoState -&gt; IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680986397"><span id="local-6989586621680986399"><span class="annot"><span class="annottext">(forall x. MonoState -&gt; Rep MonoState x)
-&gt; (forall x. Rep MonoState x -&gt; MonoState) -&gt; Generic MonoState
forall x. Rep MonoState x -&gt; MonoState
forall x. MonoState -&gt; Rep MonoState x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. MonoState -&gt; Rep MonoState x
from :: forall x. MonoState -&gt; Rep MonoState x
$cto :: forall x. Rep MonoState x -&gt; MonoState
to :: forall x. Rep MonoState x -&gt; MonoState
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Generics.html#Generic"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680986403"><span id="local-6989586621680986410"><span id="local-6989586621680986416"><span class="annot"><span class="annottext">Int -&gt; MonoState -&gt; Doc
[MonoState] -&gt; Doc
MonoState -&gt; Doc
(Int -&gt; MonoState -&gt; Doc)
-&gt; (MonoState -&gt; Doc) -&gt; ([MonoState] -&gt; Doc) -&gt; Out MonoState
forall a. (Int -&gt; a -&gt; Doc) -&gt; (a -&gt; Doc) -&gt; ([a] -&gt; Doc) -&gt; Out a
$cdocPrec :: Int -&gt; MonoState -&gt; Doc
docPrec :: Int -&gt; MonoState -&gt; Doc
$cdoc :: MonoState -&gt; Doc
doc :: MonoState -&gt; Doc
$cdocList :: [MonoState] -&gt; Doc
docList :: [MonoState] -&gt; Doc
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/GenericPretty-1.2.2-7277c36a966d41cd8e1371a7ee4c855b29a76e94dfe1d95510f68242766a5b82/share/doc/html/src/Text.PrettyPrint.GenericPretty.html#Out"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Out</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#emptyMonoState"><span class="hs-identifier hs-type">emptyMonoState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoState"><span class="hs-identifier hs-type">MonoState</span></a></span><span>
</span><span id="line-252"></span><span id="emptyMonoState"><span class="annot"><span class="annottext">emptyMonoState :: MonoState
</span><a href="Gibbon.L0.Specialize2.html#emptyMonoState"><span class="hs-identifier hs-var hs-var">emptyMonoState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoState"><span class="hs-identifier hs-type">MonoState</span></a></span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mono_funs_worklist :: Map (Var, [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_funs_worklist"><span class="hs-identifier hs-var">mono_funs_worklist</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Var, [Ty0]) Var
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mono_funs_done :: Map (Var, [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_funs_done"><span class="hs-identifier hs-var">mono_funs_done</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Var, [Ty0]) Var
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mono_lams :: Map (Var, [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_lams"><span class="hs-identifier hs-var">mono_lams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Var, [Ty0]) Var
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mono_dcons :: Map ([Char], [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_dcons"><span class="hs-identifier hs-var">mono_dcons</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map ([Char], [Ty0]) Var
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#extendFuns"><span class="hs-identifier hs-type">extendFuns</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoState"><span class="hs-identifier hs-type">MonoState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoState"><span class="hs-identifier hs-type">MonoState</span></a></span><span>
</span><span id="line-257"></span><span id="extendFuns"><span class="annot"><span class="annottext">extendFuns :: (Var, [Ty0]) -&gt; Var -&gt; MonoState -&gt; MonoState
</span><a href="Gibbon.L0.Specialize2.html#extendFuns"><span class="hs-identifier hs-var hs-var">extendFuns</span></a></span></span><span> </span><span id="local-6989586621680986541"><span class="annot"><span class="annottext">(Var, [Ty0])
</span><a href="#local-6989586621680986541"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680986542"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986542"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680986543"><span class="annot"><span class="annottext">mono_st :: MonoState
</span><a href="#local-6989586621680986543"><span class="hs-identifier hs-var">mono_st</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoState"><span class="hs-identifier hs-type">MonoState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680986544"><span class="annot"><span class="annottext">Map (Var, [Ty0]) Var
mono_funs_worklist :: MonoState -&gt; Map (Var, [Ty0]) Var
mono_funs_worklist :: Map (Var, [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_funs_worklist"><span class="hs-identifier hs-var hs-var">mono_funs_worklist</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680986543"><span class="hs-identifier hs-var">mono_st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mono_funs_worklist :: Map (Var, [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_funs_worklist"><span class="hs-identifier hs-var">mono_funs_worklist</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0]) -&gt; Var -&gt; Map (Var, [Ty0]) Var -&gt; Map (Var, [Ty0]) Var
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0])
</span><a href="#local-6989586621680986541"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986542"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Var, [Ty0]) Var
</span><a href="#local-6989586621680986544"><span class="hs-identifier hs-var">mono_funs_worklist</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#extendLambdas"><span class="hs-identifier hs-type">extendLambdas</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoState"><span class="hs-identifier hs-type">MonoState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoState"><span class="hs-identifier hs-type">MonoState</span></a></span><span>
</span><span id="line-261"></span><span id="extendLambdas"><span class="annot"><span class="annottext">extendLambdas :: (Var, [Ty0]) -&gt; Var -&gt; MonoState -&gt; MonoState
</span><a href="Gibbon.L0.Specialize2.html#extendLambdas"><span class="hs-identifier hs-var hs-var">extendLambdas</span></a></span></span><span> </span><span id="local-6989586621680986551"><span class="annot"><span class="annottext">(Var, [Ty0])
</span><a href="#local-6989586621680986551"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680986552"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986552"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680986553"><span class="annot"><span class="annottext">mono_st :: MonoState
</span><a href="#local-6989586621680986553"><span class="hs-identifier hs-var">mono_st</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoState"><span class="hs-identifier hs-type">MonoState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680986554"><span class="annot"><span class="annottext">Map (Var, [Ty0]) Var
mono_lams :: MonoState -&gt; Map (Var, [Ty0]) Var
mono_lams :: Map (Var, [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_lams"><span class="hs-identifier hs-var hs-var">mono_lams</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-262"></span><span>  </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680986553"><span class="hs-identifier hs-var">mono_st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mono_lams :: Map (Var, [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_lams"><span class="hs-identifier hs-var">mono_lams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0]) -&gt; Var -&gt; Map (Var, [Ty0]) Var -&gt; Map (Var, [Ty0]) Var
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0])
</span><a href="#local-6989586621680986551"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986552"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Var, [Ty0]) Var
</span><a href="#local-6989586621680986554"><span class="hs-identifier hs-var">mono_lams</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#extendDatacons"><span class="hs-identifier hs-type">extendDatacons</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoState"><span class="hs-identifier hs-type">MonoState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoState"><span class="hs-identifier hs-type">MonoState</span></a></span><span>
</span><span id="line-265"></span><span id="extendDatacons"><span class="annot"><span class="annottext">extendDatacons :: ([Char], [Ty0]) -&gt; Var -&gt; MonoState -&gt; MonoState
</span><a href="Gibbon.L0.Specialize2.html#extendDatacons"><span class="hs-identifier hs-var hs-var">extendDatacons</span></a></span></span><span> </span><span id="local-6989586621680986561"><span class="annot"><span class="annottext">([Char], [Ty0])
</span><a href="#local-6989586621680986561"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680986562"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986562"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680986563"><span class="annot"><span class="annottext">mono_st :: MonoState
</span><a href="#local-6989586621680986563"><span class="hs-identifier hs-var">mono_st</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoState"><span class="hs-identifier hs-type">MonoState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680986564"><span class="annot"><span class="annottext">Map ([Char], [Ty0]) Var
mono_dcons :: MonoState -&gt; Map ([Char], [Ty0]) Var
mono_dcons :: Map ([Char], [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_dcons"><span class="hs-identifier hs-var hs-var">mono_dcons</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-266"></span><span>  </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680986563"><span class="hs-identifier hs-var">mono_st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mono_dcons :: Map ([Char], [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_dcons"><span class="hs-identifier hs-var">mono_dcons</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char], [Ty0])
-&gt; Var -&gt; Map ([Char], [Ty0]) Var -&gt; Map ([Char], [Ty0]) Var
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">([Char], [Ty0])
</span><a href="#local-6989586621680986561"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986562"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map ([Char], [Ty0]) Var
</span><a href="#local-6989586621680986564"><span class="hs-identifier hs-var">mono_dcons</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="hs-comment">-- We need this wrapper because of the way these maps are defined.</span><span>
</span><span id="line-269"></span><span class="hs-comment">--</span><span>
</span><span id="line-270"></span><span class="hs-comment">-- getLambdaObls id { mono_lams = [ ((id,[IntTy]), id1), ((id,[BoolTy]), id2) ] }</span><span>
</span><span id="line-271"></span><span class="hs-comment">--   = [ (id2, [IntTy]), (id2, [BoolTy]) ]</span><span>
</span><span id="line-272"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#getLambdaObls"><span class="hs-identifier hs-type">getLambdaObls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoState"><span class="hs-identifier hs-type">MonoState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">M.Map</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span id="getLambdaObls"><span class="annot"><span class="annottext">getLambdaObls :: Var -&gt; MonoState -&gt; Map Var [Ty0]
</span><a href="Gibbon.L0.Specialize2.html#getLambdaObls"><span class="hs-identifier hs-var hs-var">getLambdaObls</span></a></span></span><span> </span><span id="local-6989586621680986568"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986568"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoState"><span class="hs-identifier hs-type">MonoState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680986569"><span class="annot"><span class="annottext">Map (Var, [Ty0]) Var
mono_lams :: MonoState -&gt; Map (Var, [Ty0]) Var
mono_lams :: Map (Var, [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_lams"><span class="hs-identifier hs-var hs-var">mono_lams</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-274"></span><span>  </span><span class="annot"><span class="annottext">[(Var, [Ty0])] -&gt; Map Var [Ty0]
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(Var, [Ty0])] -&gt; Map Var [Ty0])
-&gt; [(Var, [Ty0])] -&gt; Map Var [Ty0]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(((Var, [Ty0]), Var) -&gt; (Var, [Ty0]))
-&gt; [((Var, [Ty0]), Var)] -&gt; [(Var, [Ty0])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680986571"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986571"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621680986572"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986572"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986572"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986571"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[((Var, [Ty0]), Var)]
</span><a href="#local-6989586621680986573"><span class="hs-identifier hs-var">f_mono_st</span></a></span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-276"></span><span>    </span><span id="local-6989586621680986573"><span class="annot"><span class="annottext">f_mono_st :: [((Var, [Ty0]), Var)]
</span><a href="#local-6989586621680986573"><span class="hs-identifier hs-var hs-var">f_mono_st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(((Var, [Ty0]), Var) -&gt; IsBoxed)
-&gt; [((Var, [Ty0]), Var)] -&gt; [((Var, [Ty0]), Var)]
forall a. (a -&gt; IsBoxed) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621680986574"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986574"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986574"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; IsBoxed
forall a. Eq a =&gt; a -&gt; a -&gt; IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986568"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (Var, [Ty0]) Var -&gt; [((Var, [Ty0]), Var)]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#toList"><span class="hs-identifier hs-var">M.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Var, [Ty0]) Var
</span><a href="#local-6989586621680986569"><span class="hs-identifier hs-var">mono_lams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#monomorphize"><span class="hs-identifier hs-type">monomorphize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Prog0"><span class="hs-identifier hs-type">Prog0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Prog0"><span class="hs-identifier hs-type">Prog0</span></a></span><span>
</span><span id="line-282"></span><span id="monomorphize"><span class="annot"><span class="annottext">monomorphize :: Prog0 -&gt; PassM Prog0
</span><a href="Gibbon.L0.Specialize2.html#monomorphize"><span class="hs-identifier hs-var hs-var">monomorphize</span></a></span></span><span> </span><span id="local-6989586621680986698"><span class="annot"><span class="annottext">p :: Prog0
</span><a href="#local-6989586621680986698"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span class="hs-special">{</span><span id="local-6989586621680986699"><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
ddefs :: forall ex. Prog ex -&gt; DDefs (TyOf ex)
ddefs :: DDefs (TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#ddefs"><span class="hs-identifier hs-var hs-var">ddefs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680986700"><span class="annot"><span class="annottext">FunDefs Exp0
fundefs :: forall ex. Prog ex -&gt; FunDefs ex
fundefs :: FunDefs Exp0
</span><a href="Gibbon.Language.Syntax.html#fundefs"><span class="hs-identifier hs-var hs-var">fundefs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680986701"><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
mainExp :: forall ex. Prog ex -&gt; Maybe (ex, TyOf ex)
mainExp :: Maybe (Exp0, TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#mainExp"><span class="hs-identifier hs-var hs-var">mainExp</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680986702"><span class="annot"><span class="annottext">env2 :: Env2 Ty0
</span><a href="#local-6989586621680986702"><span class="hs-identifier hs-var hs-var">env2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyEnv Ty0 -&gt; TyEnv (ArrowTy Ty0) -&gt; Env2 Ty0
forall a. TyEnv a -&gt; TyEnv (ArrowTy a) -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#Env2"><span class="hs-identifier hs-var">Env2</span></a></span><span> </span><span class="annot"><span class="annottext">TyEnv Ty0
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FunDef0 -&gt; TyScheme) -&gt; FunDefs Exp0 -&gt; Map Var TyScheme
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#map"><span class="hs-identifier hs-var">M.map</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef0 -&gt; ArrowTy (TyOf Exp0)
FunDef0 -&gt; TyScheme
forall ex. FunDef ex -&gt; ArrowTy (TyOf ex)
</span><a href="Gibbon.Language.Syntax.html#funTy"><span class="hs-identifier hs-var">funTy</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680986700"><span class="hs-identifier hs-var">fundefs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680986704"><span class="annot"><span class="annottext">mono_m :: StateT MonoState PassM Prog0
</span><a href="#local-6989586621680986704"><span class="hs-identifier hs-var hs-var">mono_m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-286"></span><span>        </span><span class="hs-comment">-- Step (0)</span><span>
</span><span id="line-287"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621680986705"><span class="annot"><span class="annottext">[DDef0]
</span><a href="#local-6989586621680986705"><span class="hs-identifier hs-var">ddfs0</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L0.Syntax.html#DDef0"><span class="hs-identifier hs-type">DDef0</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(DDef0 -&gt; StateT MonoState PassM DDef0)
-&gt; [DDef0] -&gt; StateT MonoState PassM [DDef0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; DDef0 -&gt; StateT MonoState PassM DDef0
</span><a href="#local-6989586621680986707"><span class="hs-identifier hs-var">monoOblsDDef</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
Map Var DDef0
</span><a href="#local-6989586621680986699"><span class="hs-identifier hs-var">ddefs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; [DDef0]
forall k a. Map k a -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#elems"><span class="hs-identifier hs-var">M.elems</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
Map Var DDef0
</span><a href="#local-6989586621680986699"><span class="hs-identifier hs-var">ddefs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680986709"><span class="annot"><span class="annottext">ddefs' :: Map Var DDef0
</span><a href="#local-6989586621680986709"><span class="hs-identifier hs-var hs-var">ddefs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, DDef0)] -&gt; Map Var DDef0
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(Var, DDef0)] -&gt; Map Var DDef0)
-&gt; [(Var, DDef0)] -&gt; Map Var DDef0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(DDef0 -&gt; (Var, DDef0)) -&gt; [DDef0] -&gt; [(Var, DDef0)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680986710"><span class="annot"><span class="annottext">DDef0
</span><a href="#local-6989586621680986710"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDef0 -&gt; Var
forall a. DDef a -&gt; Var
</span><a href="Gibbon.Language.Syntax.html#tyName"><span class="hs-identifier hs-var">tyName</span></a></span><span> </span><span class="annot"><span class="annottext">DDef0
</span><a href="#local-6989586621680986710"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">DDef0
</span><a href="#local-6989586621680986710"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DDef0]
</span><a href="#local-6989586621680986705"><span class="hs-identifier hs-var">ddfs0</span></a></span><span>
</span><span id="line-289"></span><span>        </span><span class="hs-comment">-- Step (1)</span><span>
</span><span id="line-290"></span><span>        </span><span id="local-6989586621680986712"><span class="annot"><span class="annottext">Maybe (Exp0, Ty0)
</span><a href="#local-6989586621680986712"><span class="hs-identifier hs-var">mainExp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-291"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
</span><a href="#local-6989586621680986701"><span class="hs-identifier hs-var">mainExp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-292"></span><span>            </span><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp0, Ty0) -&gt; StateT MonoState PassM (Maybe (Exp0, Ty0))
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Exp0, Ty0)
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-293"></span><span>            </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680986713"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986713"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680986714"><span class="annot"><span class="annottext">TyOf Exp0
</span><a href="#local-6989586621680986714"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-294"></span><span>              </span><span id="local-6989586621680986715"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986715"><span class="hs-identifier hs-var">mainExp'</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Set Var -&gt; Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#collectMonoObls"><span class="hs-identifier hs-var">collectMonoObls</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680986709"><span class="hs-identifier hs-var">ddefs'</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680986702"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680986717"><span class="hs-identifier hs-var">toplevel</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986713"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-295"></span><span>              </span><span id="local-6989586621680986718"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986718"><span class="hs-identifier hs-var">mainExp''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#monoLambdas"><span class="hs-identifier hs-var">monoLambdas</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986715"><span class="hs-identifier hs-var">mainExp'</span></a></span><span>
</span><span id="line-296"></span><span>              </span><span id="local-6989586621680986720"><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680986720"><span class="hs-identifier hs-var">mono_st</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT MonoState PassM MonoState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-297"></span><span>              </span><span class="annot"><span class="annottext">MonoState -&gt; StateT MonoState PassM ()
forall (m :: * -&gt; *). (Monad m, HasCallStack) =&gt; MonoState -&gt; m ()
</span><a href="Gibbon.L0.Specialize2.html#assertLambdasMonomorphized"><span class="hs-identifier hs-var">assertLambdasMonomorphized</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680986720"><span class="hs-identifier hs-var">mono_st</span></a></span><span>
</span><span id="line-298"></span><span>              </span><span class="annot"><span class="annottext">Maybe (Exp0, Ty0) -&gt; StateT MonoState PassM (Maybe (Exp0, Ty0))
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Exp0, Ty0) -&gt; StateT MonoState PassM (Maybe (Exp0, Ty0)))
-&gt; Maybe (Exp0, Ty0) -&gt; StateT MonoState PassM (Maybe (Exp0, Ty0))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0, Ty0) -&gt; Maybe (Exp0, Ty0)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986718"><span class="hs-identifier hs-var">mainExp''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyOf Exp0
Ty0
</span><a href="#local-6989586621680986714"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>        </span><span class="hs-comment">-- Step (1.2)</span><span>
</span><span id="line-300"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680986723"><span class="annot"><span class="annottext">mono_funs :: FunDefs Exp0
</span><a href="#local-6989586621680986723"><span class="hs-identifier hs-var hs-var">mono_funs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FunDef0 -&gt; IsBoxed) -&gt; FunDefs Exp0 -&gt; FunDefs Exp0
forall a k. (a -&gt; IsBoxed) -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#filter"><span class="hs-identifier hs-var">M.filter</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef0 -&gt; IsBoxed
</span><a href="Gibbon.L0.Specialize2.html#isMonoFun"><span class="hs-identifier hs-var">isMonoFun</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680986700"><span class="hs-identifier hs-var">fundefs</span></a></span><span>
</span><span id="line-301"></span><span>        </span><span id="local-6989586621680986726"><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680986726"><span class="hs-identifier hs-var">mono_funs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-302"></span><span>          </span><span class="annot"><span class="annottext">(FunDefs Exp0 -&gt; FunDef0 -&gt; StateT MonoState PassM (FunDefs Exp0))
-&gt; FunDefs Exp0
-&gt; [FunDef0]
-&gt; StateT MonoState PassM (FunDefs Exp0)
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldlM"><span class="hs-identifier hs-var">foldlM</span></a></span><span>
</span><span id="line-303"></span><span>            </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680986727"><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680986727"><span class="hs-identifier hs-var">funs</span></a></span></span><span> </span><span id="local-6989586621680986728"><span class="annot"><span class="annottext">fn :: FunDef0
</span><a href="#local-6989586621680986728"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span class="hs-special">{</span><span id="local-6989586621680986729"><span class="annot"><span class="annottext">[Var]
funArgs :: [Var]
funArgs :: forall ex. FunDef ex -&gt; [Var]
</span><a href="#local-6989586621680986729"><span class="hs-identifier hs-var hs-var">funArgs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680986731"><span class="annot"><span class="annottext">Var
funName :: Var
funName :: forall ex. FunDef ex -&gt; Var
</span><a href="#local-6989586621680986731"><span class="hs-identifier hs-var hs-var">funName</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680986733"><span class="annot"><span class="annottext">Exp0
funBody :: forall ex. FunDef ex -&gt; ex
funBody :: Exp0
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var hs-var">funBody</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680986734"><span class="annot"><span class="annottext">ArrowTy (TyOf Exp0)
funTy :: forall ex. FunDef ex -&gt; ArrowTy (TyOf ex)
funTy :: ArrowTy (TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#funTy"><span class="hs-identifier hs-var hs-var">funTy</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-304"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680986735"><span class="annot"><span class="annottext">env2' :: Env2 Ty0
</span><a href="#local-6989586621680986735"><span class="hs-identifier hs-var hs-var">env2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyEnv Ty0 -&gt; Env2 Ty0 -&gt; Env2 Ty0
forall a. Map Var a -&gt; Env2 a -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#extendsVEnv"><span class="hs-identifier hs-var">extendsVEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, Ty0)] -&gt; TyEnv Ty0
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(Var, Ty0)] -&gt; TyEnv Ty0) -&gt; [(Var, Ty0)] -&gt; TyEnv Ty0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Ty0] -&gt; [(Var, Ty0)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680986729"><span class="hs-identifier hs-var">funArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArrowTy Ty0 -&gt; [Ty0]
forall ty. FunctionTy ty =&gt; ArrowTy ty -&gt; [ty]
</span><a href="Gibbon.Language.Syntax.html#inTys"><span class="hs-identifier hs-var">inTys</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy (TyOf Exp0)
ArrowTy Ty0
</span><a href="#local-6989586621680986734"><span class="hs-identifier hs-var">funTy</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680986702"><span class="hs-identifier hs-var">env2</span></a></span><span>
</span><span id="line-305"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#ForAll"><span class="hs-identifier hs-type">ForAll</span></a></span><span> </span><span id="local-6989586621680986738"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680986738"><span class="hs-identifier hs-var">tyvars</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#ArrowTy"><span class="hs-identifier hs-type">ArrowTy</span></a></span><span> </span><span id="local-6989586621680986739"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986739"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621680986740"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986740"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArrowTy (TyOf Exp0)
</span><a href="#local-6989586621680986734"><span class="hs-identifier hs-var">funTy</span></a></span><span>
</span><span id="line-306"></span><span>                  </span><span id="local-6989586621680986741"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986741"><span class="hs-identifier hs-var">as'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; StateT MonoState PassM Ty0)
-&gt; [Ty0] -&gt; StateT MonoState PassM [Ty0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Ty0 -&gt; StateT MonoState PassM Ty0
</span><a href="Gibbon.L0.Specialize2.html#monoOblsTy"><span class="hs-identifier hs-var">monoOblsTy</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
Map Var DDef0
</span><a href="#local-6989586621680986699"><span class="hs-identifier hs-var">ddefs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986739"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-307"></span><span>                  </span><span id="local-6989586621680986743"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986743"><span class="hs-identifier hs-var">b'</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Ty0 -&gt; StateT MonoState PassM Ty0
</span><a href="Gibbon.L0.Specialize2.html#monoOblsTy"><span class="hs-identifier hs-var">monoOblsTy</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
Map Var DDef0
</span><a href="#local-6989586621680986699"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986740"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-308"></span><span>                  </span><span id="local-6989586621680986744"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986744"><span class="hs-identifier hs-var">funBody'</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Set Var -&gt; Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#collectMonoObls"><span class="hs-identifier hs-var">collectMonoObls</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680986709"><span class="hs-identifier hs-var">ddefs'</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680986735"><span class="hs-identifier hs-var">env2'</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680986717"><span class="hs-identifier hs-var">toplevel</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986733"><span class="hs-identifier hs-var">funBody</span></a></span><span>
</span><span id="line-309"></span><span>                  </span><span id="local-6989586621680986745"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986745"><span class="hs-identifier hs-var">funBody''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#monoLambdas"><span class="hs-identifier hs-var">monoLambdas</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986744"><span class="hs-identifier hs-var">funBody'</span></a></span><span>
</span><span id="line-310"></span><span>                  </span><span id="local-6989586621680986746"><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680986746"><span class="hs-identifier hs-var">mono_st</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT MonoState PassM MonoState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-311"></span><span>                  </span><span class="annot"><span class="annottext">MonoState -&gt; StateT MonoState PassM ()
forall (m :: * -&gt; *). (Monad m, HasCallStack) =&gt; MonoState -&gt; m ()
</span><a href="Gibbon.L0.Specialize2.html#assertLambdasMonomorphized"><span class="hs-identifier hs-var">assertLambdasMonomorphized</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680986746"><span class="hs-identifier hs-var">mono_st</span></a></span><span>
</span><span id="line-312"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680986747"><span class="annot"><span class="annottext">fn' :: FunDef0
</span><a href="#local-6989586621680986747"><span class="hs-identifier hs-var hs-var">fn'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680986728"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funBody :: Exp0
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986745"><span class="hs-identifier hs-var">funBody''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funTy :: ArrowTy (TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#funTy"><span class="hs-identifier hs-var">funTy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; Ty0 -&gt; TyScheme
</span><a href="Gibbon.L0.Syntax.html#ForAll"><span class="hs-identifier hs-var">ForAll</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680986738"><span class="hs-identifier hs-var">tyvars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ArrowTy"><span class="hs-identifier hs-var">ArrowTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986741"><span class="hs-identifier hs-var">as'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986743"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-313"></span><span>                  </span><span class="annot"><span class="annottext">FunDefs Exp0 -&gt; StateT MonoState PassM (FunDefs Exp0)
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(FunDefs Exp0 -&gt; StateT MonoState PassM (FunDefs Exp0))
-&gt; FunDefs Exp0 -&gt; StateT MonoState PassM (FunDefs Exp0)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; FunDef0 -&gt; FunDefs Exp0 -&gt; FunDefs Exp0
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986731"><span class="hs-identifier hs-var">funName</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680986747"><span class="hs-identifier hs-var">fn'</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680986727"><span class="hs-identifier hs-var">funs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>            </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680986723"><span class="hs-identifier hs-var">mono_funs</span></a></span><span>
</span><span id="line-315"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunDefs Exp0 -&gt; [FunDef0]
forall k a. Map k a -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#elems"><span class="hs-identifier hs-var">M.elems</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680986723"><span class="hs-identifier hs-var">mono_funs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680986748"><span class="annot"><span class="annottext">fundefs' :: FunDefs Exp0
</span><a href="#local-6989586621680986748"><span class="hs-identifier hs-var hs-var">fundefs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680986726"><span class="hs-identifier hs-var">mono_funs'</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0 -&gt; FunDefs Exp0 -&gt; FunDefs Exp0
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680986700"><span class="hs-identifier hs-var">fundefs</span></a></span><span>
</span><span id="line-317"></span><span>        </span><span class="hs-comment">-- Step (2)</span><span>
</span><span id="line-318"></span><span>        </span><span id="local-6989586621680986750"><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680986750"><span class="hs-identifier hs-var">fundefs''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0 -&gt; StateT MonoState PassM (FunDefs Exp0)
</span><a href="#local-6989586621680986751"><span class="hs-identifier hs-var">monoFunDefs</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680986748"><span class="hs-identifier hs-var">fundefs'</span></a></span><span>
</span><span id="line-319"></span><span>        </span><span class="hs-comment">-- N.B. Important to fetch the state before we run 'monoDDefs' which</span><span>
</span><span id="line-320"></span><span>        </span><span class="hs-comment">-- clears everything in 'mono_dcons'.</span><span>
</span><span id="line-321"></span><span>        </span><span id="local-6989586621680986752"><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680986752"><span class="hs-identifier hs-var">mono_st</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT MonoState PassM MonoState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-322"></span><span>        </span><span class="hs-comment">-- Step (3)</span><span>
</span><span id="line-323"></span><span>        </span><span id="local-6989586621680986753"><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680986753"><span class="hs-identifier hs-var">ddefs''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; MonoM (Map Var DDef0)
</span><a href="#local-6989586621680986754"><span class="hs-identifier hs-var">monoDDefs</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680986709"><span class="hs-identifier hs-var">ddefs'</span></a></span><span>
</span><span id="line-324"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680986755"><span class="annot"><span class="annottext">p3 :: Prog0
</span><a href="#local-6989586621680986755"><span class="hs-identifier hs-var hs-var">p3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680986698"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ddefs :: DDefs (TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#ddefs"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
Map Var DDef0
</span><a href="#local-6989586621680986753"><span class="hs-identifier hs-var">ddefs''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fundefs :: FunDefs Exp0
</span><a href="Gibbon.Language.Syntax.html#fundefs"><span class="hs-identifier hs-var">fundefs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680986750"><span class="hs-identifier hs-var">fundefs''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mainExp :: Maybe (Exp0, TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#mainExp"><span class="hs-identifier hs-var">mainExp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
Maybe (Exp0, Ty0)
</span><a href="#local-6989586621680986712"><span class="hs-identifier hs-var">mainExp'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-325"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680986756"><span class="annot"><span class="annottext">p3' :: Prog0
</span><a href="#local-6989586621680986756"><span class="hs-identifier hs-var hs-var">p3'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MonoState -&gt; Prog0 -&gt; Prog0
</span><a href="Gibbon.L0.Specialize2.html#updateTyCons"><span class="hs-identifier hs-var">updateTyCons</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680986752"><span class="hs-identifier hs-var">mono_st</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680986755"><span class="hs-identifier hs-var">p3</span></a></span><span>
</span><span id="line-326"></span><span>        </span><span class="hs-comment">-- Important; p3 is not type-checkable until updateTyCons runs.</span><span>
</span><span id="line-327"></span><span>        </span><span class="hs-comment">-- Step (4)</span><span>
</span><span id="line-328"></span><span>        </span><span class="annot"><span class="annottext">PassM Prog0 -&gt; StateT MonoState PassM Prog0
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT MonoState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Prog0 -&gt; StateT MonoState PassM Prog0)
-&gt; PassM Prog0 -&gt; StateT MonoState PassM Prog0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0 -&gt; PassM Prog0
</span><a href="Gibbon.L0.Typecheck.html#tcProg"><span class="hs-identifier hs-var">tcProg</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680986756"><span class="hs-identifier hs-var">p3'</span></a></span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621680986760"><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680986760"><span class="hs-identifier hs-var">p4</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">MonoState
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT MonoState PassM Prog0
-&gt; MonoState -&gt; PassM (Prog0, MonoState)
forall s (m :: * -&gt; *) a. StateT s m a -&gt; s -&gt; m (a, s)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#runStateT"><span class="hs-identifier hs-var">runStateT</span></a></span><span> </span><span class="annot"><span class="annottext">StateT MonoState PassM Prog0
</span><a href="#local-6989586621680986704"><span class="hs-identifier hs-var">mono_m</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="Gibbon.L0.Specialize2.html#emptyMonoState"><span class="hs-identifier hs-var">emptyMonoState</span></a></span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span>  </span><span class="hs-comment">-- Step (5)</span><span>
</span><span id="line-333"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680986762"><span class="annot"><span class="annottext">p5 :: Prog0
</span><a href="#local-6989586621680986762"><span class="hs-identifier hs-var hs-var">p5</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prog0 -&gt; Prog0
</span><a href="Gibbon.L0.Specialize2.html#purgePolyDDefs"><span class="hs-identifier hs-var">purgePolyDDefs</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680986760"><span class="hs-identifier hs-var">p4</span></a></span><span>
</span><span id="line-334"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680986764"><span class="annot"><span class="annottext">p5' :: Prog0
</span><a href="#local-6989586621680986764"><span class="hs-identifier hs-var hs-var">p5'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prog0 -&gt; Prog0
</span><a href="Gibbon.L0.Specialize2.html#purgePolyFuns"><span class="hs-identifier hs-var">purgePolyFuns</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680986762"><span class="hs-identifier hs-var">p5</span></a></span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="hs-comment">-- Step (6)</span><span>
</span><span id="line-337"></span><span>  </span><span class="annot"><span class="annottext">Prog0 -&gt; PassM Prog0
</span><a href="Gibbon.L0.Typecheck.html#tcProg"><span class="hs-identifier hs-var">tcProg</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680986764"><span class="hs-identifier hs-var">p5'</span></a></span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-339"></span><span>    </span><span id="local-6989586621680986717"><span class="annot"><span class="annottext">toplevel :: Set Var
</span><a href="#local-6989586621680986717"><span class="hs-identifier hs-var hs-var">toplevel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0 -&gt; Set Var
forall k a. Map k a -&gt; Set k
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#keysSet"><span class="hs-identifier hs-var">M.keysSet</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680986700"><span class="hs-identifier hs-var">fundefs</span></a></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span>    </span><span class="hs-comment">-- Create monomorphic versions of all polymorphic functions.</span><span>
</span><span id="line-342"></span><span>    </span><span class="annot"><a href="#local-6989586621680986751"><span class="hs-identifier hs-type">monoFunDefs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunDefs0"><span class="hs-identifier hs-type">FunDefs0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoM"><span class="hs-identifier hs-type">MonoM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunDefs0"><span class="hs-identifier hs-type">FunDefs0</span></a></span><span>
</span><span id="line-343"></span><span>    </span><span id="local-6989586621680986751"><span class="annot"><span class="annottext">monoFunDefs :: FunDefs Exp0 -&gt; StateT MonoState PassM (FunDefs Exp0)
</span><a href="#local-6989586621680986751"><span class="hs-identifier hs-var hs-var">monoFunDefs</span></a></span></span><span> </span><span id="local-6989586621680986768"><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680986768"><span class="hs-identifier hs-var">fundefs1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-344"></span><span>      </span><span id="local-6989586621680986769"><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680986769"><span class="hs-identifier hs-var">mono_st</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT MonoState PassM MonoState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-345"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Map (Var, [Ty0]) Var -&gt; IsBoxed
forall k a. Map k a -&gt; IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#null"><span class="hs-identifier hs-var">M.null</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MonoState -&gt; Map (Var, [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_funs_worklist"><span class="hs-identifier hs-var">mono_funs_worklist</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680986769"><span class="hs-identifier hs-var">mono_st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0 -&gt; StateT MonoState PassM (FunDefs Exp0)
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680986768"><span class="hs-identifier hs-var">fundefs1</span></a></span><span>
</span><span id="line-347"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-348"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621680986771"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986771"><span class="hs-identifier hs-var">fun_name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680986772"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986772"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621680986773"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986773"><span class="hs-identifier hs-var">new_fun_name</span></a></span></span><span class="hs-special">)</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680986774"><span class="annot"><span class="annottext">[((Var, [Ty0]), Var)]
</span><a href="#local-6989586621680986774"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Var, [Ty0]) Var -&gt; [((Var, [Ty0]), Var)]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#toList"><span class="hs-identifier hs-var">M.toList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MonoState -&gt; Map (Var, [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_funs_worklist"><span class="hs-identifier hs-var">mono_funs_worklist</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680986769"><span class="hs-identifier hs-var">mono_st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>            </span><span id="local-6989586621680986775"><span class="annot"><span class="annottext">fn :: FunDef0
</span><a href="#local-6989586621680986775"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span class="hs-special">{</span><span id="local-6989586621680986776"><span class="annot"><span class="annottext">[Var]
funArgs :: forall ex. FunDef ex -&gt; [Var]
funArgs :: [Var]
</span><a href="Gibbon.Language.Syntax.html#funArgs"><span class="hs-identifier hs-var hs-var">funArgs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680986777"><span class="annot"><span class="annottext">Var
funName :: forall ex. FunDef ex -&gt; Var
funName :: Var
</span><a href="Gibbon.Language.Syntax.html#funName"><span class="hs-identifier hs-var hs-var">funName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680986778"><span class="annot"><span class="annottext">Exp0
funBody :: forall ex. FunDef ex -&gt; ex
funBody :: Exp0
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var hs-var">funBody</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680986700"><span class="hs-identifier hs-var">fundefs</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0 -&gt; Var -&gt; FunDef0
forall a b.
(Ord a, Out a, Out b, Show a, HasCallStack) =&gt;
Map a b -&gt; a -&gt; b
</span><a href="Gibbon.Common.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986771"><span class="hs-identifier hs-var">fun_name</span></a></span><span>
</span><span id="line-350"></span><span>            </span><span id="local-6989586621680986780"><span class="annot"><span class="annottext">tyvars :: [TyVar]
</span><a href="#local-6989586621680986780"><span class="hs-identifier hs-var hs-var">tyvars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyScheme -&gt; [TyVar]
</span><a href="Gibbon.L0.Syntax.html#tyVarsFromScheme"><span class="hs-identifier hs-var">tyVarsFromScheme</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunDef0 -&gt; ArrowTy (TyOf Exp0)
forall ex. FunDef ex -&gt; ArrowTy (TyOf ex)
</span><a href="Gibbon.Language.Syntax.html#funTy"><span class="hs-identifier hs-var">funTy</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680986775"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>        </span><span class="annot"><span class="annottext">[Char] -&gt; [TyVar] -&gt; [Ty0] -&gt; StateT MonoState PassM ()
forall a b (m :: * -&gt; *).
(Out a, Out b, Monad m, HasCallStack) =&gt;
[Char] -&gt; [a] -&gt; [b] -&gt; m ()
</span><a href="Gibbon.L0.Specialize2.html#assertSameLength"><span class="hs-identifier hs-var">assertSameLength</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;While monormorphizing the function: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986777"><span class="hs-identifier hs-var">funName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680986780"><span class="hs-identifier hs-var">tyvars</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986772"><span class="hs-identifier hs-var">tyapps</span></a></span><span>
</span><span id="line-352"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680986783"><span class="annot"><span class="annottext">mp :: Map TyVar Ty0
</span><a href="#local-6989586621680986783"><span class="hs-identifier hs-var hs-var">mp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(TyVar, Ty0)] -&gt; Map TyVar Ty0
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(TyVar, Ty0)] -&gt; Map TyVar Ty0)
-&gt; [(TyVar, Ty0)] -&gt; Map TyVar Ty0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; [Ty0] -&gt; [(TyVar, Ty0)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680986780"><span class="hs-identifier hs-var">tyvars</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986772"><span class="hs-identifier hs-var">tyapps</span></a></span><span>
</span><span id="line-353"></span><span>            </span><span id="local-6989586621680986784"><span class="annot"><span class="annottext">funTy' :: TyScheme
</span><a href="#local-6989586621680986784"><span class="hs-identifier hs-var hs-var">funTy'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; Ty0 -&gt; TyScheme
</span><a href="Gibbon.L0.Syntax.html#ForAll"><span class="hs-identifier hs-var">ForAll</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TyVar Ty0 -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#substTyVar"><span class="hs-identifier hs-var">substTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Map TyVar Ty0
</span><a href="#local-6989586621680986783"><span class="hs-identifier hs-var">mp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyScheme -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#tyFromScheme"><span class="hs-identifier hs-var">tyFromScheme</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunDef0 -&gt; ArrowTy (TyOf Exp0)
forall ex. FunDef ex -&gt; ArrowTy (TyOf ex)
</span><a href="Gibbon.Language.Syntax.html#funTy"><span class="hs-identifier hs-var">funTy</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680986775"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>            </span><span id="local-6989586621680986787"><span class="annot"><span class="annottext">funBody' :: Exp0
</span><a href="#local-6989586621680986787"><span class="hs-identifier hs-var hs-var">funBody'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map TyVar Ty0 -&gt; Exp0 -&gt; Exp0
</span><a href="Gibbon.L0.Typecheck.html#substTyVarExp"><span class="hs-identifier hs-var">substTyVarExp</span></a></span><span> </span><span class="annot"><span class="annottext">Map TyVar Ty0
</span><a href="#local-6989586621680986783"><span class="hs-identifier hs-var">mp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986778"><span class="hs-identifier hs-var">funBody</span></a></span><span>
</span><span id="line-355"></span><span>            </span><span class="hs-comment">-- Move this obligation from todo to done.</span><span>
</span><span id="line-356"></span><span>            </span><span id="local-6989586621680986789"><span class="annot"><span class="annottext">mono_st' :: MonoState
</span><a href="#local-6989586621680986789"><span class="hs-identifier hs-var hs-var">mono_st'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680986769"><span class="hs-identifier hs-var">mono_st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mono_funs_done :: Map (Var, [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_funs_done"><span class="hs-identifier hs-var">mono_funs_done</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0]) -&gt; Var -&gt; Map (Var, [Ty0]) Var -&gt; Map (Var, [Ty0]) Var
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986771"><span class="hs-identifier hs-var">fun_name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986772"><span class="hs-identifier hs-var">tyapps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986773"><span class="hs-identifier hs-var">new_fun_name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MonoState -&gt; Map (Var, [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_funs_done"><span class="hs-identifier hs-var">mono_funs_done</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680986769"><span class="hs-identifier hs-var">mono_st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mono_funs_worklist :: Map (Var, [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_funs_worklist"><span class="hs-identifier hs-var">mono_funs_worklist</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[((Var, [Ty0]), Var)] -&gt; Map (Var, [Ty0]) Var
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[((Var, [Ty0]), Var)]
</span><a href="#local-6989586621680986774"><span class="hs-identifier hs-var">rst</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-358"></span><span>        </span><span class="annot"><span class="annottext">MonoState -&gt; StateT MonoState PassM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680986789"><span class="hs-identifier hs-var">mono_st'</span></a></span><span>
</span><span id="line-359"></span><span>        </span><span class="hs-comment">-- Collect any more obligations generated due to the monormorphization</span><span>
</span><span id="line-360"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680986791"><span class="annot"><span class="annottext">argEnv :: TyEnv Ty0
</span><a href="#local-6989586621680986791"><span class="hs-identifier hs-var hs-var">argEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)] -&gt; TyEnv Ty0
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(Var, Ty0)] -&gt; TyEnv Ty0) -&gt; [(Var, Ty0)] -&gt; TyEnv Ty0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Ty0] -&gt; [(Var, Ty0)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680986776"><span class="hs-identifier hs-var">funArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArrowTy Ty0 -&gt; [Ty0]
forall ty. FunctionTy ty =&gt; ArrowTy ty -&gt; [ty]
</span><a href="Gibbon.Language.Syntax.html#inTys"><span class="hs-identifier hs-var">inTys</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy Ty0
TyScheme
</span><a href="#local-6989586621680986784"><span class="hs-identifier hs-var">funTy'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680986792"><span class="annot"><span class="annottext">TyEnv Ty0
</span><a href="#local-6989586621680986792"><span class="hs-identifier hs-var">argFenv</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680986793"><span class="annot"><span class="annottext">TyEnv Ty0
</span><a href="#local-6989586621680986793"><span class="hs-identifier hs-var">argVenv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; IsBoxed) -&gt; TyEnv Ty0 -&gt; (TyEnv Ty0, TyEnv Ty0)
forall a k. (a -&gt; IsBoxed) -&gt; Map k a -&gt; (Map k a, Map k a)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#partition"><span class="hs-identifier hs-var">M.partition</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#ArrowTy"><span class="hs-identifier hs-type">ArrowTy</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyEnv Ty0
</span><a href="#local-6989586621680986791"><span class="hs-identifier hs-var">argEnv</span></a></span><span>
</span><span id="line-362"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680986795"><span class="annot"><span class="annottext">argFenv' :: Map Var TyScheme
</span><a href="#local-6989586621680986795"><span class="hs-identifier hs-var hs-var">argFenv'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; TyScheme) -&gt; TyEnv Ty0 -&gt; Map Var TyScheme
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#map"><span class="hs-identifier hs-var">M.map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar] -&gt; Ty0 -&gt; TyScheme
</span><a href="Gibbon.L0.Syntax.html#ForAll"><span class="hs-identifier hs-var">ForAll</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TyEnv Ty0
</span><a href="#local-6989586621680986792"><span class="hs-identifier hs-var">argFenv</span></a></span><span>
</span><span id="line-363"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680986796"><span class="annot"><span class="annottext">env21 :: Env2 Ty0
</span><a href="#local-6989586621680986796"><span class="hs-identifier hs-var hs-var">env21</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyEnv Ty0 -&gt; TyEnv (ArrowTy Ty0) -&gt; Env2 Ty0
forall a. TyEnv a -&gt; TyEnv (ArrowTy a) -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#Env2"><span class="hs-identifier hs-var">Env2</span></a></span><span> </span><span class="annot"><span class="annottext">TyEnv Ty0
</span><a href="#local-6989586621680986793"><span class="hs-identifier hs-var">argVenv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var TyScheme -&gt; Map Var TyScheme -&gt; Map Var TyScheme
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-identifier hs-var">M.union</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var TyScheme
</span><a href="#local-6989586621680986795"><span class="hs-identifier hs-var">argFenv'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FunDef0 -&gt; TyScheme) -&gt; FunDefs Exp0 -&gt; Map Var TyScheme
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#map"><span class="hs-identifier hs-var">M.map</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef0 -&gt; ArrowTy (TyOf Exp0)
FunDef0 -&gt; TyScheme
forall ex. FunDef ex -&gt; ArrowTy (TyOf ex)
</span><a href="Gibbon.Language.Syntax.html#funTy"><span class="hs-identifier hs-var">funTy</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680986768"><span class="hs-identifier hs-var">fundefs1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>        </span><span id="local-6989586621680986797"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986797"><span class="hs-identifier hs-var">funBody''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Set Var -&gt; Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#collectMonoObls"><span class="hs-identifier hs-var">collectMonoObls</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
Map Var DDef0
</span><a href="#local-6989586621680986699"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680986796"><span class="hs-identifier hs-var">env21</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680986717"><span class="hs-identifier hs-var">toplevel</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986787"><span class="hs-identifier hs-var">funBody'</span></a></span><span>
</span><span id="line-365"></span><span>        </span><span id="local-6989586621680986798"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986798"><span class="hs-identifier hs-var">funBody'''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#monoLambdas"><span class="hs-identifier hs-var">monoLambdas</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986797"><span class="hs-identifier hs-var">funBody''</span></a></span><span>
</span><span id="line-366"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680986799"><span class="annot"><span class="annottext">fn' :: FunDef0
</span><a href="#local-6989586621680986799"><span class="hs-identifier hs-var hs-var">fn'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680986775"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funName :: Var
</span><a href="Gibbon.Language.Syntax.html#funName"><span class="hs-identifier hs-var">funName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986773"><span class="hs-identifier hs-var">new_fun_name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funTy :: ArrowTy (TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#funTy"><span class="hs-identifier hs-var">funTy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArrowTy (TyOf Exp0)
TyScheme
</span><a href="#local-6989586621680986784"><span class="hs-identifier hs-var">funTy'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funBody :: Exp0
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680986798"><span class="hs-identifier hs-var">funBody'''</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-367"></span><span>        </span><span class="annot"><span class="annottext">FunDefs Exp0 -&gt; StateT MonoState PassM (FunDefs Exp0)
</span><a href="#local-6989586621680986751"><span class="hs-identifier hs-var">monoFunDefs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; FunDef0 -&gt; FunDefs Exp0 -&gt; FunDefs Exp0
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986773"><span class="hs-identifier hs-var">new_fun_name</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680986799"><span class="hs-identifier hs-var">fn'</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680986768"><span class="hs-identifier hs-var">fundefs1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span>    </span><span class="hs-comment">-- Create monomorphic versions of all polymorphic datatypes.</span><span>
</span><span id="line-370"></span><span>    </span><span class="annot"><a href="#local-6989586621680986754"><span class="hs-identifier hs-type">monoDDefs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#DDefs0"><span class="hs-identifier hs-type">DDefs0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoM"><span class="hs-identifier hs-type">MonoM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#DDefs0"><span class="hs-identifier hs-type">DDefs0</span></a></span><span>
</span><span id="line-371"></span><span>    </span><span id="local-6989586621680986754"><span class="annot"><span class="annottext">monoDDefs :: Map Var DDef0 -&gt; MonoM (Map Var DDef0)
</span><a href="#local-6989586621680986754"><span class="hs-identifier hs-var hs-var">monoDDefs</span></a></span></span><span> </span><span id="local-6989586621680986801"><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680986801"><span class="hs-identifier hs-var">ddefs1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-372"></span><span>      </span><span id="local-6989586621680986802"><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680986802"><span class="hs-identifier hs-var">mono_st</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT MonoState PassM MonoState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-373"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Map ([Char], [Ty0]) Var -&gt; IsBoxed
forall k a. Map k a -&gt; IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#null"><span class="hs-identifier hs-var">M.null</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MonoState -&gt; Map ([Char], [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_dcons"><span class="hs-identifier hs-var">mono_dcons</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680986802"><span class="hs-identifier hs-var">mono_st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; MonoM (Map Var DDef0)
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680986801"><span class="hs-identifier hs-var">ddefs1</span></a></span><span>
</span><span id="line-375"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-376"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621680986803"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680986803"><span class="hs-identifier hs-var">tycon</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680986804"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986804"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621680986805"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986805"><span class="hs-identifier hs-var">suffix</span></a></span></span><span class="hs-special">)</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680986806"><span class="annot"><span class="annottext">[(([Char], [Ty0]), Var)]
</span><a href="#local-6989586621680986806"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map ([Char], [Ty0]) Var -&gt; [(([Char], [Ty0]), Var)]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#toList"><span class="hs-identifier hs-var">M.toList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MonoState -&gt; Map ([Char], [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_dcons"><span class="hs-identifier hs-var">mono_dcons</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680986802"><span class="hs-identifier hs-var">mono_st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>            </span><span id="local-6989586621680986807"><span class="annot"><span class="annottext">ddf :: DDef0
</span><a href="#local-6989586621680986807"><span class="hs-identifier hs-var">ddf</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Language.Syntax.html#DDef"><span class="hs-identifier hs-type">DDef</span></a></span><span class="hs-special">{</span><span id="local-6989586621680986808"><span class="annot"><span class="annottext">Var
tyName :: forall a. DDef a -&gt; Var
tyName :: Var
</span><a href="Gibbon.Language.Syntax.html#tyName"><span class="hs-identifier hs-var hs-var">tyName</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680986809"><span class="annot"><span class="annottext">[TyVar]
tyArgs :: [TyVar]
tyArgs :: forall a. DDef a -&gt; [TyVar]
</span><a href="#local-6989586621680986809"><span class="hs-identifier hs-var hs-var">tyArgs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680986811"><span class="annot"><span class="annottext">[([Char], [(IsBoxed, Ty0)])]
dataCons :: forall a. DDef a -&gt; [([Char], [(IsBoxed, a)])]
dataCons :: [([Char], [(IsBoxed, Ty0)])]
</span><a href="Gibbon.Language.Syntax.html#dataCons"><span class="hs-identifier hs-var hs-var">dataCons</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; [Char] -&gt; DDef0
forall a. Out a =&gt; DDefs a -&gt; [Char] -&gt; DDef a
</span><a href="Gibbon.Language.Syntax.html#lookupDDef"><span class="hs-identifier hs-var">lookupDDef</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
Map Var DDef0
</span><a href="#local-6989586621680986699"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680986803"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-378"></span><span>        </span><span class="annot"><span class="annottext">[Char] -&gt; [TyVar] -&gt; [Ty0] -&gt; StateT MonoState PassM ()
forall a b (m :: * -&gt; *).
(Out a, Out b, Monad m, HasCallStack) =&gt;
[Char] -&gt; [a] -&gt; [b] -&gt; m ()
</span><a href="Gibbon.L0.Specialize2.html#assertSameLength"><span class="hs-identifier hs-var">assertSameLength</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;In the datacon: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986808"><span class="hs-identifier hs-var">tyName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680986809"><span class="hs-identifier hs-var">tyArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986804"><span class="hs-identifier hs-var">tyapps</span></a></span><span>
</span><span id="line-379"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680986813"><span class="annot"><span class="annottext">tyName' :: Var
</span><a href="#local-6989586621680986813"><span class="hs-identifier hs-var hs-var">tyName'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Var
</span><a href="Gibbon.Common.html#varAppend"><span class="hs-identifier hs-var">varAppend</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986808"><span class="hs-identifier hs-var">tyName</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986805"><span class="hs-identifier hs-var">suffix</span></a></span><span>
</span><span id="line-380"></span><span>            </span><span id="local-6989586621680986815"><span class="annot"><span class="annottext">dataCons' :: [([Char], [(IsBoxed, Ty0)])]
</span><a href="#local-6989586621680986815"><span class="hs-identifier hs-var hs-var">dataCons'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([Char], [(IsBoxed, Ty0)]) -&gt; ([Char], [(IsBoxed, Ty0)]))
-&gt; [([Char], [(IsBoxed, Ty0)])] -&gt; [([Char], [(IsBoxed, Ty0)])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span>
</span><span id="line-381"></span><span>                          </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680986816"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680986816"><span class="hs-identifier hs-var">dcon</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680986817"><span class="annot"><span class="annottext">[(IsBoxed, Ty0)]
</span><a href="#local-6989586621680986817"><span class="hs-identifier hs-var">vtys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-382"></span><span>                            </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680986818"><span class="annot"><span class="annottext">[IsBoxed]
</span><a href="#local-6989586621680986818"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680986819"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986819"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(IsBoxed, Ty0)] -&gt; ([IsBoxed], [Ty0])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">[(IsBoxed, Ty0)]
</span><a href="#local-6989586621680986817"><span class="hs-identifier hs-var">vtys</span></a></span><span>
</span><span id="line-383"></span><span>                                </span><span id="local-6989586621680986821"><span class="annot"><span class="annottext">sbst :: Map TyVar Ty0
</span><a href="#local-6989586621680986821"><span class="hs-identifier hs-var hs-var">sbst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(TyVar, Ty0)] -&gt; Map TyVar Ty0
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar] -&gt; [Ty0] -&gt; [(TyVar, Ty0)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680986809"><span class="hs-identifier hs-var">tyArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986804"><span class="hs-identifier hs-var">tyapps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>                                </span><span id="local-6989586621680986822"><span class="annot"><span class="annottext">tys' :: [Ty0]
</span><a href="#local-6989586621680986822"><span class="hs-identifier hs-var hs-var">tys'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; Ty0) -&gt; [Ty0] -&gt; [Ty0]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TyVar Ty0 -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#substTyVar"><span class="hs-identifier hs-var">substTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Map TyVar Ty0
</span><a href="#local-6989586621680986821"><span class="hs-identifier hs-var">sbst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986819"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-385"></span><span>                                </span><span id="local-6989586621680986823"><span class="annot"><span class="annottext">tys'' :: [Ty0]
</span><a href="#local-6989586621680986823"><span class="hs-identifier hs-var hs-var">tys''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; Ty0) -&gt; [Ty0] -&gt; [Ty0]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; MonoState -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Specialize2.html#updateTyConsTy"><span class="hs-identifier hs-var">updateTyConsTy</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680986801"><span class="hs-identifier hs-var">ddefs1</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680986802"><span class="hs-identifier hs-var">mono_st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986822"><span class="hs-identifier hs-var">tys'</span></a></span><span>
</span><span id="line-386"></span><span>                                </span><span id="local-6989586621680986825"><span class="annot"><span class="annottext">vtys' :: [(IsBoxed, Ty0)]
</span><a href="#local-6989586621680986825"><span class="hs-identifier hs-var hs-var">vtys'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[IsBoxed] -&gt; [Ty0] -&gt; [(IsBoxed, Ty0)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[IsBoxed]
</span><a href="#local-6989586621680986818"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986823"><span class="hs-identifier hs-var">tys''</span></a></span><span>
</span><span id="line-387"></span><span>                            </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680986816"><span class="hs-identifier hs-var">dcon</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Char]
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986805"><span class="hs-identifier hs-var">suffix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(IsBoxed, Ty0)]
</span><a href="#local-6989586621680986825"><span class="hs-identifier hs-var">vtys'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>                          </span><span class="annot"><span class="annottext">[([Char], [(IsBoxed, Ty0)])]
</span><a href="#local-6989586621680986811"><span class="hs-identifier hs-var">dataCons</span></a></span><span>
</span><span id="line-389"></span><span>            </span><span id="local-6989586621680986827"><span class="annot"><span class="annottext">ddefs1' :: Map Var DDef0
</span><a href="#local-6989586621680986827"><span class="hs-identifier hs-var hs-var">ddefs1'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; DDef0 -&gt; Map Var DDef0 -&gt; Map Var DDef0
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986813"><span class="hs-identifier hs-var">tyName'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDef0
</span><a href="#local-6989586621680986807"><span class="hs-identifier hs-var">ddf</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tyName :: Var
</span><a href="Gibbon.Language.Syntax.html#tyName"><span class="hs-identifier hs-var">tyName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986813"><span class="hs-identifier hs-var">tyName'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tyArgs :: [TyVar]
</span><a href="Gibbon.Language.Syntax.html#tyArgs"><span class="hs-identifier hs-var">tyArgs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">dataCons :: [([Char], [(IsBoxed, Ty0)])]
</span><a href="Gibbon.Language.Syntax.html#dataCons"><span class="hs-identifier hs-var">dataCons</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[([Char], [(IsBoxed, Ty0)])]
</span><a href="#local-6989586621680986815"><span class="hs-identifier hs-var">dataCons'</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680986801"><span class="hs-identifier hs-var">ddefs1</span></a></span><span>
</span><span id="line-390"></span><span>            </span><span id="local-6989586621680986828"><span class="annot"><span class="annottext">mono_st' :: MonoState
</span><a href="#local-6989586621680986828"><span class="hs-identifier hs-var hs-var">mono_st'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680986802"><span class="hs-identifier hs-var">mono_st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mono_dcons :: Map ([Char], [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_dcons"><span class="hs-identifier hs-var">mono_dcons</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(([Char], [Ty0]), Var)] -&gt; Map ([Char], [Ty0]) Var
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[(([Char], [Ty0]), Var)]
</span><a href="#local-6989586621680986806"><span class="hs-identifier hs-var">rst</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-391"></span><span>        </span><span class="annot"><span class="annottext">MonoState -&gt; StateT MonoState PassM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680986828"><span class="hs-identifier hs-var">mono_st'</span></a></span><span>
</span><span id="line-392"></span><span>        </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; MonoM (Map Var DDef0)
</span><a href="#local-6989586621680986754"><span class="hs-identifier hs-var">monoDDefs</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680986827"><span class="hs-identifier hs-var">ddefs1'</span></a></span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span>    </span><span class="hs-comment">-- See examples/T127. Bar is monomorphic, but uses a monomorphized-by-hand</span><span>
</span><span id="line-395"></span><span>    </span><span class="hs-comment">-- Foo. We must update Bar to use the correct Foo.</span><span>
</span><span id="line-396"></span><span>    </span><span class="annot"><a href="#local-6989586621680986707"><span class="hs-identifier hs-type">monoOblsDDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#DDefs0"><span class="hs-identifier hs-type">DDefs0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#DDef0"><span class="hs-identifier hs-type">DDef0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoM"><span class="hs-identifier hs-type">MonoM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#DDef0"><span class="hs-identifier hs-type">DDef0</span></a></span><span>
</span><span id="line-397"></span><span>    </span><span id="local-6989586621680986707"><span class="annot"><span class="annottext">monoOblsDDef :: Map Var DDef0 -&gt; DDef0 -&gt; StateT MonoState PassM DDef0
</span><a href="#local-6989586621680986707"><span class="hs-identifier hs-var hs-var">monoOblsDDef</span></a></span></span><span> </span><span id="local-6989586621680986829"><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680986829"><span class="hs-identifier hs-var">ddefs1</span></a></span></span><span> </span><span id="local-6989586621680986830"><span class="annot"><span class="annottext">d :: DDef0
</span><a href="#local-6989586621680986830"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Language.Syntax.html#DDef"><span class="hs-identifier hs-type">DDef</span></a></span><span class="hs-special">{</span><span id="local-6989586621680986831"><span class="annot"><span class="annottext">[([Char], [(IsBoxed, Ty0)])]
dataCons :: forall a. DDef a -&gt; [([Char], [(IsBoxed, a)])]
dataCons :: [([Char], [(IsBoxed, Ty0)])]
</span><a href="Gibbon.Language.Syntax.html#dataCons"><span class="hs-identifier hs-var hs-var">dataCons</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-398"></span><span>      </span><span id="local-6989586621680986832"><span class="annot"><span class="annottext">[([Char], [(IsBoxed, Ty0)])]
</span><a href="#local-6989586621680986832"><span class="hs-identifier hs-var">dataCons'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(([Char], [(IsBoxed, Ty0)])
 -&gt; StateT MonoState PassM ([Char], [(IsBoxed, Ty0)]))
-&gt; [([Char], [(IsBoxed, Ty0)])]
-&gt; StateT MonoState PassM [([Char], [(IsBoxed, Ty0)])]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680986833"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680986833"><span class="hs-identifier hs-var">dcon</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680986834"><span class="annot"><span class="annottext">[(IsBoxed, Ty0)]
</span><a href="#local-6989586621680986834"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680986833"><span class="hs-identifier hs-var">dcon</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(IsBoxed, Ty0)] -&gt; ([Char], [(IsBoxed, Ty0)]))
-&gt; StateT MonoState PassM [(IsBoxed, Ty0)]
-&gt; StateT MonoState PassM ([Char], [(IsBoxed, Ty0)])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">((IsBoxed, Ty0) -&gt; StateT MonoState PassM (IsBoxed, Ty0))
-&gt; [(IsBoxed, Ty0)] -&gt; StateT MonoState PassM [(IsBoxed, Ty0)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680986836"><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680986836"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680986837"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986837"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680986836"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; (IsBoxed, Ty0))
-&gt; StateT MonoState PassM Ty0
-&gt; StateT MonoState PassM (IsBoxed, Ty0)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Ty0 -&gt; StateT MonoState PassM Ty0
</span><a href="Gibbon.L0.Specialize2.html#monoOblsTy"><span class="hs-identifier hs-var">monoOblsTy</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680986829"><span class="hs-identifier hs-var">ddefs1</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986837"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(IsBoxed, Ty0)]
</span><a href="#local-6989586621680986834"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[([Char], [(IsBoxed, Ty0)])]
</span><a href="#local-6989586621680986831"><span class="hs-identifier hs-var">dataCons</span></a></span><span>
</span><span id="line-399"></span><span>      </span><span class="annot"><span class="annottext">DDef0 -&gt; StateT MonoState PassM DDef0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(DDef0 -&gt; StateT MonoState PassM DDef0)
-&gt; DDef0 -&gt; StateT MonoState PassM DDef0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DDef0
</span><a href="#local-6989586621680986830"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dataCons :: [([Char], [(IsBoxed, Ty0)])]
</span><a href="Gibbon.Language.Syntax.html#dataCons"><span class="hs-identifier hs-var">dataCons</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[([Char], [(IsBoxed, Ty0)])]
</span><a href="#local-6989586621680986832"><span class="hs-identifier hs-var">dataCons'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span class="hs-comment">-- After 'monoLambdas' runs, (mono_lams MonoState) must be empty</span><span>
</span><span id="line-403"></span><span id="local-6989586621680985802"><span class="annot"><a href="Gibbon.L0.Specialize2.html#assertLambdasMonomorphized"><span class="hs-identifier hs-type">assertLambdasMonomorphized</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680985802"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoState"><span class="hs-identifier hs-type">MonoState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680985802"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-404"></span><span id="assertLambdasMonomorphized"><span class="annot"><span class="annottext">assertLambdasMonomorphized :: forall (m :: * -&gt; *). (Monad m, HasCallStack) =&gt; MonoState -&gt; m ()
</span><a href="Gibbon.L0.Specialize2.html#assertLambdasMonomorphized"><span class="hs-identifier hs-var hs-var">assertLambdasMonomorphized</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoState"><span class="hs-identifier hs-type">MonoState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680986853"><span class="annot"><span class="annottext">Map (Var, [Ty0]) Var
mono_lams :: MonoState -&gt; Map (Var, [Ty0]) Var
mono_lams :: Map (Var, [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_lams"><span class="hs-identifier hs-var hs-var">mono_lams</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-405"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Map (Var, [Ty0]) Var -&gt; IsBoxed
forall k a. Map k a -&gt; IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#null"><span class="hs-identifier hs-var">M.null</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Var, [Ty0]) Var
</span><a href="#local-6989586621680986853"><span class="hs-identifier hs-var">mono_lams</span></a></span><span>
</span><span id="line-406"></span><span>  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; m ()
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; m ()) -&gt; [Char] -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Expected 0 lambda monormorphization obligations. Got &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Var, [Ty0]) Var -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Var, [Ty0]) Var
</span><a href="#local-6989586621680986853"><span class="hs-identifier hs-var">mono_lams</span></a></span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span id="local-6989586621680985829"><span id="local-6989586621680985830"><span id="local-6989586621680985831"><span class="annot"><a href="Gibbon.L0.Specialize2.html#assertSameLength"><span class="hs-identifier hs-type">assertSameLength</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/GenericPretty-1.2.2-7277c36a966d41cd8e1371a7ee4c855b29a76e94dfe1d95510f68242766a5b82/share/doc/html/src/Text.PrettyPrint.GenericPretty.html#Out"><span class="hs-identifier hs-type">Out</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680985829"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/GenericPretty-1.2.2-7277c36a966d41cd8e1371a7ee4c855b29a76e94dfe1d95510f68242766a5b82/share/doc/html/src/Text.PrettyPrint.GenericPretty.html#Out"><span class="hs-identifier hs-type">Out</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680985830"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680985831"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680985829"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680985830"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680985831"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-410"></span><span id="assertSameLength"><span class="annot"><span class="annottext">assertSameLength :: forall a b (m :: * -&gt; *).
(Out a, Out b, Monad m, HasCallStack) =&gt;
[Char] -&gt; [a] -&gt; [b] -&gt; m ()
</span><a href="Gibbon.L0.Specialize2.html#assertSameLength"><span class="hs-identifier hs-var hs-var">assertSameLength</span></a></span></span><span> </span><span id="local-6989586621680986872"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680986872"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621680986873"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680986873"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621680986874"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621680986874"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-411"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680986873"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; IsBoxed
forall a. Eq a =&gt; a -&gt; a -&gt; IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">[b] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621680986874"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-412"></span><span>  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; m ()
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; m ()) -&gt; [Char] -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;assertSameLength: Type applications &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[b] -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621680986874"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; incompatible with the type variables: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-413"></span><span>               </span><span class="annot"><span class="annottext">[a] -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680986873"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;.\n &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680986872"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-414"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#monoOblsTy"><span class="hs-identifier hs-type">monoOblsTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#DDefs0"><span class="hs-identifier hs-type">DDefs0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoM"><span class="hs-identifier hs-type">MonoM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span>
</span><span id="line-418"></span><span id="monoOblsTy"><span class="annot"><span class="annottext">monoOblsTy :: Map Var DDef0 -&gt; Ty0 -&gt; StateT MonoState PassM Ty0
</span><a href="Gibbon.L0.Specialize2.html#monoOblsTy"><span class="hs-identifier hs-var hs-var">monoOblsTy</span></a></span></span><span> </span><span id="local-6989586621680986935"><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680986935"><span class="hs-identifier hs-var">ddefs1</span></a></span></span><span> </span><span id="local-6989586621680986936"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986936"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-419"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986936"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-420"></span><span>    </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#CharTy"><span class="hs-identifier hs-var">CharTy</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; StateT MonoState PassM Ty0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986936"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-421"></span><span>    </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#IntTy"><span class="hs-identifier hs-var">IntTy</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; StateT MonoState PassM Ty0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986936"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-422"></span><span>    </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#FloatTy"><span class="hs-identifier hs-var">FloatTy</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; StateT MonoState PassM Ty0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986936"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-423"></span><span>    </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#SymTy0"><span class="hs-identifier hs-var">SymTy0</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; StateT MonoState PassM Ty0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986936"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-424"></span><span>    </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#BoolTy"><span class="hs-identifier hs-var">BoolTy</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; StateT MonoState PassM Ty0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986936"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-425"></span><span>    </span><span class="annot"><a href="Gibbon.L0.Syntax.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; StateT MonoState PassM Ty0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986936"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-426"></span><span>    </span><span class="annot"><a href="Gibbon.L0.Syntax.html#MetaTv"><span class="hs-identifier hs-type">MetaTv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; StateT MonoState PassM Ty0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986936"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-427"></span><span>    </span><span class="annot"><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680986937"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986937"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="annot"><span class="annottext">([Ty0] -&gt; Ty0)
-&gt; StateT MonoState PassM [Ty0] -&gt; StateT MonoState PassM Ty0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; StateT MonoState PassM Ty0)
-&gt; [Ty0] -&gt; StateT MonoState PassM [Ty0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Ty0 -&gt; StateT MonoState PassM Ty0
</span><a href="Gibbon.L0.Specialize2.html#monoOblsTy"><span class="hs-identifier hs-var">monoOblsTy</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680986935"><span class="hs-identifier hs-var">ddefs1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986937"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-428"></span><span>    </span><span class="annot"><a href="Gibbon.L0.Syntax.html#SymDictTy"><span class="hs-identifier hs-type">SymDictTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; StateT MonoState PassM Ty0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986936"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-429"></span><span>    </span><span class="annot"><a href="Gibbon.L0.Syntax.html#PDictTy"><span class="hs-identifier hs-type">PDictTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; StateT MonoState PassM Ty0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986936"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-430"></span><span>    </span><span class="annot"><a href="Gibbon.L0.Syntax.html#ArrowTy"><span class="hs-identifier hs-type">ArrowTy</span></a></span><span> </span><span id="local-6989586621680986938"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986938"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621680986939"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986939"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-431"></span><span>      </span><span id="local-6989586621680986940"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986940"><span class="hs-identifier hs-var">as'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; StateT MonoState PassM Ty0)
-&gt; [Ty0] -&gt; StateT MonoState PassM [Ty0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Ty0 -&gt; StateT MonoState PassM Ty0
</span><a href="Gibbon.L0.Specialize2.html#monoOblsTy"><span class="hs-identifier hs-var">monoOblsTy</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680986935"><span class="hs-identifier hs-var">ddefs1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986938"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-432"></span><span>      </span><span id="local-6989586621680986941"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986941"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Ty0 -&gt; StateT MonoState PassM Ty0
</span><a href="Gibbon.L0.Specialize2.html#monoOblsTy"><span class="hs-identifier hs-var">monoOblsTy</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680986935"><span class="hs-identifier hs-var">ddefs1</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986939"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-433"></span><span>      </span><span class="annot"><span class="annottext">Ty0 -&gt; StateT MonoState PassM Ty0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; StateT MonoState PassM Ty0)
-&gt; Ty0 -&gt; StateT MonoState PassM Ty0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ArrowTy"><span class="hs-identifier hs-var">ArrowTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986940"><span class="hs-identifier hs-var">as'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986941"><span class="hs-identifier hs-var">b'</span></a></span><span>
</span><span id="line-434"></span><span>    </span><span class="annot"><a href="Gibbon.L0.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span id="local-6989586621680986942"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680986942"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span id="local-6989586621680986943"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986943"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-435"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986943"><span class="hs-identifier hs-var">tyapps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-436"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; StateT MonoState PassM Ty0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986936"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-437"></span><span>        </span><span class="hs-comment">-- We're only looking for fully monomorphized datatypes here</span><span>
</span><span id="line-438"></span><span>        </span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; [TyVar]
</span><a href="Gibbon.L0.Syntax.html#tyVarsInTys"><span class="hs-identifier hs-var">tyVarsInTys</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986943"><span class="hs-identifier hs-var">tyapps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-439"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-440"></span><span>                  </span><span id="local-6989586621680986945"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986945"><span class="hs-identifier hs-var">tyapps'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; StateT MonoState PassM Ty0)
-&gt; [Ty0] -&gt; StateT MonoState PassM [Ty0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Ty0 -&gt; StateT MonoState PassM Ty0
</span><a href="Gibbon.L0.Specialize2.html#monoOblsTy"><span class="hs-identifier hs-var">monoOblsTy</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680986935"><span class="hs-identifier hs-var">ddefs1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986943"><span class="hs-identifier hs-var">tyapps</span></a></span><span>
</span><span id="line-441"></span><span>                  </span><span id="local-6989586621680986946"><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680986946"><span class="hs-identifier hs-var">mono_st</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT MonoState PassM MonoState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-442"></span><span>                  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">([Char], [Ty0]) -&gt; Map ([Char], [Ty0]) Var -&gt; Maybe Var
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680986942"><span class="hs-identifier hs-var">tycon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986945"><span class="hs-identifier hs-var">tyapps'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MonoState -&gt; Map ([Char], [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_dcons"><span class="hs-identifier hs-var">mono_dcons</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680986946"><span class="hs-identifier hs-var">mono_st</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-443"></span><span>                    </span><span class="annot"><span class="annottext">Maybe Var
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-444"></span><span>                      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DDef"><span class="hs-identifier hs-type">DDef</span></a></span><span class="hs-special">{</span><span id="local-6989586621680986948"><span class="annot"><span class="annottext">[TyVar]
tyArgs :: forall a. DDef a -&gt; [TyVar]
tyArgs :: [TyVar]
</span><a href="Gibbon.Language.Syntax.html#tyArgs"><span class="hs-identifier hs-var hs-var">tyArgs</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; [Char] -&gt; DDef0
forall a. Out a =&gt; DDefs a -&gt; [Char] -&gt; DDef a
</span><a href="Gibbon.Language.Syntax.html#lookupDDef"><span class="hs-identifier hs-var">lookupDDef</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680986935"><span class="hs-identifier hs-var">ddefs1</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680986942"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-445"></span><span>                      </span><span class="annot"><span class="annottext">[Char] -&gt; [TyVar] -&gt; [Ty0] -&gt; StateT MonoState PassM ()
forall a b (m :: * -&gt; *).
(Out a, Out b, Monad m, HasCallStack) =&gt;
[Char] -&gt; [a] -&gt; [b] -&gt; m ()
</span><a href="Gibbon.L0.Specialize2.html#assertSameLength"><span class="hs-identifier hs-var">assertSameLength</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;In the type: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986936"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680986948"><span class="hs-identifier hs-var">tyArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986945"><span class="hs-identifier hs-var">tyapps'</span></a></span><span>
</span><span id="line-446"></span><span>                      </span><span id="local-6989586621680986949"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986949"><span class="hs-identifier hs-var">suffix</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PassM Var -&gt; StateT MonoState PassM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT MonoState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Var -&gt; StateT MonoState PassM Var)
-&gt; PassM Var -&gt; StateT MonoState PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;_v&quot;</span></span><span>
</span><span id="line-447"></span><span>                      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680986951"><span class="annot"><span class="annottext">mono_st' :: MonoState
</span><a href="#local-6989586621680986951"><span class="hs-identifier hs-var hs-var">mono_st'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char], [Ty0]) -&gt; Var -&gt; MonoState -&gt; MonoState
</span><a href="Gibbon.L0.Specialize2.html#extendDatacons"><span class="hs-identifier hs-var">extendDatacons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680986942"><span class="hs-identifier hs-var">tycon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680986945"><span class="hs-identifier hs-var">tyapps'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986949"><span class="hs-identifier hs-var">suffix</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680986946"><span class="hs-identifier hs-var">mono_st</span></a></span><span>
</span><span id="line-448"></span><span>                          </span><span id="local-6989586621680986952"><span class="annot"><span class="annottext">tycon' :: [Char]
</span><a href="#local-6989586621680986952"><span class="hs-identifier hs-var hs-var">tycon'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680986942"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Char]
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986949"><span class="hs-identifier hs-var">suffix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span>                      </span><span class="annot"><span class="annottext">MonoState -&gt; StateT MonoState PassM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680986951"><span class="hs-identifier hs-var">mono_st'</span></a></span><span>
</span><span id="line-450"></span><span>                      </span><span class="annot"><span class="annottext">Ty0 -&gt; StateT MonoState PassM Ty0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; StateT MonoState PassM Ty0)
-&gt; Ty0 -&gt; StateT MonoState PassM Ty0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#PackedTy"><span class="hs-identifier hs-var">PackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680986952"><span class="hs-identifier hs-var">tycon'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-451"></span><span>                    </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680986953"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986953"><span class="hs-identifier hs-var">suffix</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; StateT MonoState PassM Ty0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; StateT MonoState PassM Ty0)
-&gt; Ty0 -&gt; StateT MonoState PassM Ty0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#PackedTy"><span class="hs-identifier hs-var">PackedTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680986942"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Char]
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680986953"><span class="hs-identifier hs-var">suffix</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-452"></span><span>                </span><span class="annot"><span class="annottext">[TyVar]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; StateT MonoState PassM Ty0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986936"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-453"></span><span>    </span><span class="annot"><a href="Gibbon.L0.Syntax.html#VectorTy"><span class="hs-identifier hs-type">VectorTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; StateT MonoState PassM Ty0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986936"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-454"></span><span>    </span><span class="annot"><a href="Gibbon.L0.Syntax.html#ListTy"><span class="hs-identifier hs-type">ListTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; StateT MonoState PassM Ty0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986936"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-455"></span><span>    </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#ArenaTy"><span class="hs-identifier hs-var">ArenaTy</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; StateT MonoState PassM Ty0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986936"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-456"></span><span>    </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#SymSetTy"><span class="hs-identifier hs-var">SymSetTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; StateT MonoState PassM Ty0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986936"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-457"></span><span>    </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#SymHashTy"><span class="hs-identifier hs-var">SymHashTy</span></a></span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; StateT MonoState PassM Ty0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986936"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-458"></span><span>    </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#IntHashTy"><span class="hs-identifier hs-var">IntHashTy</span></a></span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; StateT MonoState PassM Ty0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680986936"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-459"></span><span>
</span><span id="line-460"></span><span>
</span><span id="line-461"></span><span class="annot"><span class="hs-comment">-- | Collect monomorphization obligations.</span></span><span>
</span><span id="line-462"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#collectMonoObls"><span class="hs-identifier hs-type">collectMonoObls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#DDefs0"><span class="hs-identifier hs-type">DDefs0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Env2"><span class="hs-identifier hs-type">Env2</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoM"><span class="hs-identifier hs-type">MonoM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span>
</span><span id="line-463"></span><span id="collectMonoObls"><span class="annot"><span class="annottext">collectMonoObls :: Map Var DDef0 -&gt; Env2 Ty0 -&gt; Set Var -&gt; Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#collectMonoObls"><span class="hs-identifier hs-var hs-var">collectMonoObls</span></a></span></span><span> </span><span id="local-6989586621680987167"><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987167"><span class="hs-identifier hs-var">ddefs</span></a></span></span><span> </span><span id="local-6989586621680987168"><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680987168"><span class="hs-identifier hs-var">env2</span></a></span></span><span> </span><span id="local-6989586621680987169"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680987169"><span class="hs-identifier hs-var">toplevel</span></a></span></span><span> </span><span id="local-6989586621680987170"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987170"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-464"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987170"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-465"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span id="local-6989586621680987171"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987171"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621680987172"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987172"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-466"></span><span>      </span><span id="local-6989586621680987173"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987173"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; [Exp0] -&gt; StateT MonoState PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Set Var -&gt; Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#collectMonoObls"><span class="hs-identifier hs-var">collectMonoObls</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987167"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680987168"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680987169"><span class="hs-identifier hs-var">toplevel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987172"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-467"></span><span>      </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987171"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987173"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-468"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span id="local-6989586621680987174"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987174"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680987175"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987175"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span> </span><span id="local-6989586621680987176"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987176"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-469"></span><span>      </span><span id="local-6989586621680987177"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987177"><span class="hs-identifier hs-var">args'</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; [Exp0] -&gt; StateT MonoState PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Set Var -&gt; Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#collectMonoObls"><span class="hs-identifier hs-var">collectMonoObls</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987167"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680987168"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680987169"><span class="hs-identifier hs-var">toplevel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987176"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-470"></span><span>      </span><span id="local-6989586621680987178"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987178"><span class="hs-identifier hs-var">tyapps'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; StateT MonoState PassM Ty0)
-&gt; [Ty0] -&gt; StateT MonoState PassM [Ty0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Ty0 -&gt; StateT MonoState PassM Ty0
</span><a href="Gibbon.L0.Specialize2.html#monoOblsTy"><span class="hs-identifier hs-var">monoOblsTy</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987167"><span class="hs-identifier hs-var">ddefs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987175"><span class="hs-identifier hs-var">tyapps</span></a></span><span>
</span><span id="line-471"></span><span>      </span><span id="local-6989586621680987179"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987179"><span class="hs-identifier hs-var">f'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; StateT MonoState PassM Var
</span><a href="#local-6989586621680987180"><span class="hs-identifier hs-var">addFnObl</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987174"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987178"><span class="hs-identifier hs-var">tyapps'</span></a></span><span>
</span><span id="line-472"></span><span>      </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987179"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987177"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-473"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680987181"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987181"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621680987182"><span class="annot"><span class="annottext">ty :: Ty0
</span><a href="#local-6989586621680987182"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.L0.Syntax.html#ArrowTy"><span class="hs-identifier hs-type">ArrowTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span id="local-6989586621680987183"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987183"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680987184"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987184"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span class="hs-keyword">do</span><span>
</span><span id="line-474"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680987185"><span class="annot"><span class="annottext">env2' :: Env2 Ty0
</span><a href="#local-6989586621680987185"><span class="hs-identifier hs-var hs-var">env2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty0 -&gt; Env2 Ty0 -&gt; Env2 Ty0
forall a. Var -&gt; a -&gt; Env2 a -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987181"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987182"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680987168"><span class="hs-identifier hs-var">env2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987183"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-476"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#LambdaE"><span class="hs-identifier hs-type">LambdaE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-477"></span><span>          </span><span id="local-6989586621680987187"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987187"><span class="hs-identifier hs-var">rhs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="#local-6989586621680987188"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987183"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-478"></span><span>          </span><span id="local-6989586621680987189"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987189"><span class="hs-identifier hs-var">bod'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Set Var -&gt; Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#collectMonoObls"><span class="hs-identifier hs-var">collectMonoObls</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987167"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680987185"><span class="hs-identifier hs-var">env2'</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680987169"><span class="hs-identifier hs-var">toplevel</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987184"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-479"></span><span>          </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0) -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987181"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987182"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987187"><span class="hs-identifier hs-var">rhs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987189"><span class="hs-identifier hs-var">bod'</span></a></span><span>
</span><span id="line-480"></span><span>        </span><span class="annot"><span class="annottext">Exp0
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-481"></span><span>          </span><span class="hs-comment">-- Special case for lambda bindings passed in as function arguments:</span><span>
</span><span id="line-482"></span><span>          </span><span class="hs-comment">--</span><span>
</span><span id="line-483"></span><span>          </span><span class="hs-comment">-- 'v' is an ArrowTy, but not a lambda defn -- this let binding must</span><span>
</span><span id="line-484"></span><span>          </span><span class="hs-comment">-- be in a function body, and 'v' must be a lambda that's</span><span>
</span><span id="line-485"></span><span>          </span><span class="hs-comment">-- passed in as an argument. We don't want to monormorphize it here.</span><span>
</span><span id="line-486"></span><span>          </span><span class="hs-comment">-- It'll be handled when the the outer fn is processed.</span><span>
</span><span id="line-487"></span><span>          </span><span class="hs-comment">-- To ensure that (AppE v ...) stays the same, we add 'v' into</span><span>
</span><span id="line-488"></span><span>          </span><span class="hs-comment">-- mono_st s.t. it's new name would be same as it's old name.</span><span>
</span><span id="line-489"></span><span>          </span><span class="annot"><span class="annottext">(MonoState -&gt; ((), MonoState)) -&gt; StateT MonoState PassM ()
forall a. (MonoState -&gt; (a, MonoState)) -&gt; StateT MonoState PassM a
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; (a, s)) -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#state"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680987191"><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987191"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0]) -&gt; Var -&gt; MonoState -&gt; MonoState
</span><a href="Gibbon.L0.Specialize2.html#extendLambdas"><span class="hs-identifier hs-var">extendLambdas</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987181"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987181"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987191"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span>          </span><span id="local-6989586621680987192"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987192"><span class="hs-identifier hs-var">rhs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="#local-6989586621680987188"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987183"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-491"></span><span>          </span><span id="local-6989586621680987193"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987193"><span class="hs-identifier hs-var">bod'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Set Var -&gt; Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#collectMonoObls"><span class="hs-identifier hs-var">collectMonoObls</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987167"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680987185"><span class="hs-identifier hs-var">env2'</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680987169"><span class="hs-identifier hs-var">toplevel</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987184"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-492"></span><span>          </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0) -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987181"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987182"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987192"><span class="hs-identifier hs-var">rhs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987193"><span class="hs-identifier hs-var">bod'</span></a></span><span>
</span><span id="line-493"></span><span>
</span><span id="line-494"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680987194"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987194"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span id="local-6989586621680987195"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987195"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680987196"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987196"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680987197"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987197"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-495"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680987198"><span class="annot"><span class="annottext">env2' :: Env2 Ty0
</span><a href="#local-6989586621680987198"><span class="hs-identifier hs-var hs-var">env2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty0 -&gt; Env2 Ty0 -&gt; Env2 Ty0
forall a. Var -&gt; a -&gt; Env2 a -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987194"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987195"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680987168"><span class="hs-identifier hs-var">env2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span>      </span><span id="local-6989586621680987199"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987199"><span class="hs-identifier hs-var">rhs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="#local-6989586621680987188"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987196"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-497"></span><span>      </span><span id="local-6989586621680987200"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987200"><span class="hs-identifier hs-var">bod'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Set Var -&gt; Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#collectMonoObls"><span class="hs-identifier hs-var">collectMonoObls</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987167"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680987198"><span class="hs-identifier hs-var">env2'</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680987169"><span class="hs-identifier hs-var">toplevel</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987197"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-498"></span><span>      </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0) -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987194"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987195"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987199"><span class="hs-identifier hs-var">rhs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987200"><span class="hs-identifier hs-var">bod'</span></a></span><span>
</span><span id="line-499"></span><span>
</span><span id="line-500"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; MonoM Exp0
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; MonoM Exp0) -&gt; [Char] -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;collectMonoObls: Let not monomorphized: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987170"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-501"></span><span>
</span><span id="line-502"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-type">CaseE</span></a></span><span> </span><span id="local-6989586621680987201"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987201"><span class="hs-identifier hs-var">scrt</span></a></span></span><span> </span><span id="local-6989586621680987202"><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680987202"><span class="hs-identifier hs-var">brs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-503"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Exp0 -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#recoverType"><span class="hs-identifier hs-var">recoverType</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987167"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680987168"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987201"><span class="hs-identifier hs-var">scrt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-504"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span id="local-6989586621680987204"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987204"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span id="local-6989586621680987205"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987205"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-505"></span><span>          </span><span id="local-6989586621680987206"><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987206"><span class="hs-identifier hs-var">mono_st</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT MonoState PassM MonoState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-506"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680987207"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987207"><span class="hs-identifier hs-var">suffix</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680987208"><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987208"><span class="hs-identifier hs-var">mono_st''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-507"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987205"><span class="hs-identifier hs-var">tyapps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-508"></span><span>              </span><span class="hs-comment">-- It's a monomorphic datatype.</span><span>
</span><span id="line-509"></span><span>              </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Var, MonoState) -&gt; StateT MonoState PassM (Var, MonoState)
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987206"><span class="hs-identifier hs-var">mono_st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span>              </span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-511"></span><span>                </span><span id="local-6989586621680987209"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987209"><span class="hs-identifier hs-var">tyapps'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; StateT MonoState PassM Ty0)
-&gt; [Ty0] -&gt; StateT MonoState PassM [Ty0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Ty0 -&gt; StateT MonoState PassM Ty0
</span><a href="Gibbon.L0.Specialize2.html#monoOblsTy"><span class="hs-identifier hs-var">monoOblsTy</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987167"><span class="hs-identifier hs-var">ddefs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987205"><span class="hs-identifier hs-var">tyapps</span></a></span><span>
</span><span id="line-512"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">([Char], [Ty0]) -&gt; Map ([Char], [Ty0]) Var -&gt; Maybe Var
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987204"><span class="hs-identifier hs-var">tycon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987209"><span class="hs-identifier hs-var">tyapps'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MonoState -&gt; Map ([Char], [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_dcons"><span class="hs-identifier hs-var">mono_dcons</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987206"><span class="hs-identifier hs-var">mono_st</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-513"></span><span>                  </span><span class="annot"><span class="annottext">Maybe Var
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-514"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DDef"><span class="hs-identifier hs-type">DDef</span></a></span><span class="hs-special">{</span><span id="local-6989586621680987210"><span class="annot"><span class="annottext">[TyVar]
tyArgs :: forall a. DDef a -&gt; [TyVar]
tyArgs :: [TyVar]
</span><a href="Gibbon.Language.Syntax.html#tyArgs"><span class="hs-identifier hs-var hs-var">tyArgs</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; [Char] -&gt; DDef0
forall a. Out a =&gt; DDefs a -&gt; [Char] -&gt; DDef a
</span><a href="Gibbon.Language.Syntax.html#lookupDDef"><span class="hs-identifier hs-var">lookupDDef</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987167"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987204"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-515"></span><span>                    </span><span class="annot"><span class="annottext">[Char] -&gt; [TyVar] -&gt; [Ty0] -&gt; StateT MonoState PassM ()
forall a b (m :: * -&gt; *).
(Out a, Out b, Monad m, HasCallStack) =&gt;
[Char] -&gt; [a] -&gt; [b] -&gt; m ()
</span><a href="Gibbon.L0.Specialize2.html#assertSameLength"><span class="hs-identifier hs-var">assertSameLength</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;In the expression: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987170"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680987210"><span class="hs-identifier hs-var">tyArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987209"><span class="hs-identifier hs-var">tyapps'</span></a></span><span>
</span><span id="line-516"></span><span>                    </span><span id="local-6989586621680987211"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987211"><span class="hs-identifier hs-var">suffix</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PassM Var -&gt; StateT MonoState PassM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT MonoState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Var -&gt; StateT MonoState PassM Var)
-&gt; PassM Var -&gt; StateT MonoState PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;_v&quot;</span></span><span>
</span><span id="line-517"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680987212"><span class="annot"><span class="annottext">mono_st' :: MonoState
</span><a href="#local-6989586621680987212"><span class="hs-identifier hs-var hs-var">mono_st'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char], [Ty0]) -&gt; Var -&gt; MonoState -&gt; MonoState
</span><a href="Gibbon.L0.Specialize2.html#extendDatacons"><span class="hs-identifier hs-var">extendDatacons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987204"><span class="hs-identifier hs-var">tycon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987209"><span class="hs-identifier hs-var">tyapps'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987211"><span class="hs-identifier hs-var">suffix</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987206"><span class="hs-identifier hs-var">mono_st</span></a></span><span>
</span><span id="line-518"></span><span>                    </span><span class="annot"><span class="annottext">(Var, MonoState) -&gt; StateT MonoState PassM (Var, MonoState)
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987211"><span class="hs-identifier hs-var">suffix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987212"><span class="hs-identifier hs-var">mono_st'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-519"></span><span>                  </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680987213"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987213"><span class="hs-identifier hs-var">suffix</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Var, MonoState) -&gt; StateT MonoState PassM (Var, MonoState)
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987213"><span class="hs-identifier hs-var">suffix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987206"><span class="hs-identifier hs-var">mono_st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-520"></span><span>          </span><span class="annot"><span class="annottext">MonoState -&gt; StateT MonoState PassM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987208"><span class="hs-identifier hs-var">mono_st''</span></a></span><span>
</span><span id="line-521"></span><span>          </span><span id="local-6989586621680987214"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987214"><span class="hs-identifier hs-var">scrt'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="#local-6989586621680987188"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987201"><span class="hs-identifier hs-var">scrt</span></a></span><span>
</span><span id="line-522"></span><span>          </span><span id="local-6989586621680987215"><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680987215"><span class="hs-identifier hs-var">brs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-523"></span><span>            </span><span class="annot"><span class="annottext">([([Char], [(Var, Ty0)], Exp0)]
 -&gt; ([Char], [(Var, Ty0)], Exp0)
 -&gt; StateT MonoState PassM [([Char], [(Var, Ty0)], Exp0)])
-&gt; [([Char], [(Var, Ty0)], Exp0)]
-&gt; [([Char], [(Var, Ty0)], Exp0)]
-&gt; StateT MonoState PassM [([Char], [(Var, Ty0)], Exp0)]
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldlM"><span class="hs-identifier hs-var">foldlM</span></a></span><span>
</span><span id="line-524"></span><span>              </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680987216"><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680987216"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680987217"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987217"><span class="hs-identifier hs-var">dcon</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680987218"><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680987218"><span class="hs-identifier hs-var">vtys</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680987219"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987219"><span class="hs-identifier hs-var">bod</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-525"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680987220"><span class="annot"><span class="annottext">env2' :: Env2 Ty0
</span><a href="#local-6989586621680987220"><span class="hs-identifier hs-var hs-var">env2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyEnv Ty0 -&gt; Env2 Ty0 -&gt; Env2 Ty0
forall a. Map Var a -&gt; Env2 a -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#extendsVEnv"><span class="hs-identifier hs-var">extendsVEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, Ty0)] -&gt; TyEnv Ty0
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680987218"><span class="hs-identifier hs-var">vtys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680987168"><span class="hs-identifier hs-var">env2</span></a></span><span>
</span><span id="line-526"></span><span>                </span><span id="local-6989586621680987221"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987221"><span class="hs-identifier hs-var">bod'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Set Var -&gt; Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#collectMonoObls"><span class="hs-identifier hs-var">collectMonoObls</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987167"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680987220"><span class="hs-identifier hs-var">env2'</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680987169"><span class="hs-identifier hs-var">toplevel</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987219"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-527"></span><span>                </span><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
-&gt; StateT MonoState PassM [([Char], [(Var, Ty0)], Exp0)]
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">([([Char], [(Var, Ty0)], Exp0)]
 -&gt; StateT MonoState PassM [([Char], [(Var, Ty0)], Exp0)])
-&gt; [([Char], [(Var, Ty0)], Exp0)]
-&gt; StateT MonoState PassM [([Char], [(Var, Ty0)], Exp0)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680987216"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
-&gt; [([Char], [(Var, Ty0)], Exp0)] -&gt; [([Char], [(Var, Ty0)], Exp0)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987217"><span class="hs-identifier hs-var">dcon</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Char]
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987207"><span class="hs-identifier hs-var">suffix</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680987218"><span class="hs-identifier hs-var">vtys</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987221"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-528"></span><span>              </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680987202"><span class="hs-identifier hs-var">brs</span></a></span><span>
</span><span id="line-529"></span><span>          </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [([Char], [(Var, Ty0)], Exp0)] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; [([Char], [(Var, loc)], PreExp ext loc dec)]
-&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-var">CaseE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987214"><span class="hs-identifier hs-var">scrt'</span></a></span><span> </span><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680987215"><span class="hs-identifier hs-var">brs'</span></a></span><span>
</span><span id="line-530"></span><span>
</span><span id="line-531"></span><span>        </span><span id="local-6989586621680987222"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987222"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; MonoM Exp0
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; MonoM Exp0) -&gt; [Char] -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;collectMonoObls: Unexpected type for the scrutinee, &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987222"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-532"></span><span>                      </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;. In the expression: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987170"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-533"></span><span>
</span><span id="line-534"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-type">DataConE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680987223"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987223"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680987224"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987224"><span class="hs-identifier hs-var">dcon</span></a></span></span><span> </span><span id="local-6989586621680987225"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987225"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-535"></span><span>      </span><span id="local-6989586621680987226"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987226"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; [Exp0] -&gt; StateT MonoState PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Set Var -&gt; Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#collectMonoObls"><span class="hs-identifier hs-var">collectMonoObls</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987167"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680987168"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680987169"><span class="hs-identifier hs-var">toplevel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987225"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-536"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987223"><span class="hs-identifier hs-var">tyapps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-537"></span><span>        </span><span class="hs-comment">-- It's a monomorphic datatype.</span><span>
</span><span id="line-538"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; [Char] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
loc -&gt; [Char] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-var">DataConE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987224"><span class="hs-identifier hs-var">dcon</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987226"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-539"></span><span>        </span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-540"></span><span>          </span><span id="local-6989586621680987227"><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987227"><span class="hs-identifier hs-var">mono_st</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT MonoState PassM MonoState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-541"></span><span>          </span><span class="hs-comment">-- Collect datacon instances here.</span><span>
</span><span id="line-542"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680987228"><span class="annot"><span class="annottext">tycon :: [Char]
</span><a href="#local-6989586621680987228"><span class="hs-identifier hs-var hs-var">tycon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; [Char] -&gt; [Char]
forall a. Out a =&gt; DDefs a -&gt; [Char] -&gt; [Char]
</span><a href="Gibbon.Language.Syntax.html#getTyOfDataCon"><span class="hs-identifier hs-var">getTyOfDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987167"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987224"><span class="hs-identifier hs-var">dcon</span></a></span><span>
</span><span id="line-543"></span><span>          </span><span id="local-6989586621680987230"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987230"><span class="hs-identifier hs-var">tyapps'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; StateT MonoState PassM Ty0)
-&gt; [Ty0] -&gt; StateT MonoState PassM [Ty0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Ty0 -&gt; StateT MonoState PassM Ty0
</span><a href="Gibbon.L0.Specialize2.html#monoOblsTy"><span class="hs-identifier hs-var">monoOblsTy</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987167"><span class="hs-identifier hs-var">ddefs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987223"><span class="hs-identifier hs-var">tyapps</span></a></span><span>
</span><span id="line-544"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">([Char], [Ty0]) -&gt; Map ([Char], [Ty0]) Var -&gt; Maybe Var
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987228"><span class="hs-identifier hs-var">tycon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987230"><span class="hs-identifier hs-var">tyapps'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MonoState -&gt; Map ([Char], [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_dcons"><span class="hs-identifier hs-var">mono_dcons</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987227"><span class="hs-identifier hs-var">mono_st</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-545"></span><span>            </span><span class="annot"><span class="annottext">Maybe Var
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-546"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DDef"><span class="hs-identifier hs-type">DDef</span></a></span><span class="hs-special">{</span><span id="local-6989586621680987231"><span class="annot"><span class="annottext">[TyVar]
tyArgs :: forall a. DDef a -&gt; [TyVar]
tyArgs :: [TyVar]
</span><a href="Gibbon.Language.Syntax.html#tyArgs"><span class="hs-identifier hs-var hs-var">tyArgs</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; [Char] -&gt; DDef0
forall a. Out a =&gt; DDefs a -&gt; [Char] -&gt; DDef a
</span><a href="Gibbon.Language.Syntax.html#lookupDDef"><span class="hs-identifier hs-var">lookupDDef</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987167"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987228"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-547"></span><span>              </span><span class="annot"><span class="annottext">[Char] -&gt; [TyVar] -&gt; [Ty0] -&gt; StateT MonoState PassM ()
forall a b (m :: * -&gt; *).
(Out a, Out b, Monad m, HasCallStack) =&gt;
[Char] -&gt; [a] -&gt; [b] -&gt; m ()
</span><a href="Gibbon.L0.Specialize2.html#assertSameLength"><span class="hs-identifier hs-var">assertSameLength</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;In the expression: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987170"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680987231"><span class="hs-identifier hs-var">tyArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987230"><span class="hs-identifier hs-var">tyapps'</span></a></span><span>
</span><span id="line-548"></span><span>              </span><span id="local-6989586621680987232"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987232"><span class="hs-identifier hs-var">suffix</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PassM Var -&gt; StateT MonoState PassM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT MonoState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Var -&gt; StateT MonoState PassM Var)
-&gt; PassM Var -&gt; StateT MonoState PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;_v&quot;</span></span><span>
</span><span id="line-549"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680987233"><span class="annot"><span class="annottext">mono_st' :: MonoState
</span><a href="#local-6989586621680987233"><span class="hs-identifier hs-var hs-var">mono_st'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char], [Ty0]) -&gt; Var -&gt; MonoState -&gt; MonoState
</span><a href="Gibbon.L0.Specialize2.html#extendDatacons"><span class="hs-identifier hs-var">extendDatacons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987228"><span class="hs-identifier hs-var">tycon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987223"><span class="hs-identifier hs-var">tyapps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987232"><span class="hs-identifier hs-var">suffix</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987227"><span class="hs-identifier hs-var">mono_st</span></a></span><span>
</span><span id="line-550"></span><span>                  </span><span id="local-6989586621680987234"><span class="annot"><span class="annottext">dcon' :: [Char]
</span><a href="#local-6989586621680987234"><span class="hs-identifier hs-var hs-var">dcon'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987224"><span class="hs-identifier hs-var">dcon</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Char]
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987232"><span class="hs-identifier hs-var">suffix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-551"></span><span>              </span><span class="annot"><span class="annottext">MonoState -&gt; StateT MonoState PassM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987233"><span class="hs-identifier hs-var">mono_st'</span></a></span><span>
</span><span id="line-552"></span><span>              </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; [Char] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
loc -&gt; [Char] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-var">DataConE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987234"><span class="hs-identifier hs-var">dcon'</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987226"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-553"></span><span>            </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680987235"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987235"><span class="hs-identifier hs-var">suffix</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-554"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680987236"><span class="annot"><span class="annottext">dcon' :: [Char]
</span><a href="#local-6989586621680987236"><span class="hs-identifier hs-var hs-var">dcon'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987224"><span class="hs-identifier hs-var">dcon</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Char]
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987235"><span class="hs-identifier hs-var">suffix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-555"></span><span>              </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; [Char] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
loc -&gt; [Char] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-var">DataConE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987236"><span class="hs-identifier hs-var">dcon'</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987226"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-556"></span><span>
</span><span id="line-557"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-type">DataConE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; MonoM Exp0
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; MonoM Exp0) -&gt; [Char] -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;collectMonoObls: DataConE expected ProdTy tyapps, got &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987170"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-558"></span><span>
</span><span id="line-559"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span id="local-6989586621680987237"><span class="annot"><span class="annottext">Prim Ty0
</span><a href="#local-6989586621680987237"><span class="hs-identifier hs-var">pr</span></a></span></span><span> </span><span id="local-6989586621680987238"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987238"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-560"></span><span>      </span><span id="local-6989586621680987239"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987239"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; [Exp0] -&gt; StateT MonoState PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Set Var -&gt; Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#collectMonoObls"><span class="hs-identifier hs-var">collectMonoObls</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987167"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680987168"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680987169"><span class="hs-identifier hs-var">toplevel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987238"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-561"></span><span>      </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0 -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0
</span><a href="#local-6989586621680987237"><span class="hs-identifier hs-var">pr</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987239"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-562"></span><span>
</span><span id="line-563"></span><span>    </span><span class="hs-comment">-- Straightforward recursion</span><span>
</span><span id="line-564"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987170"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-565"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-type">LitE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987170"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-566"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CharE"><span class="hs-identifier hs-type">CharE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987170"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-567"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-type">FloatE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987170"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-568"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-type">LitSymE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987170"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-569"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-type">IfE</span></a></span><span> </span><span id="local-6989586621680987240"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987240"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680987241"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987241"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680987242"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987242"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-570"></span><span>      </span><span id="local-6989586621680987243"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987243"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="#local-6989586621680987188"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987240"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-571"></span><span>      </span><span id="local-6989586621680987244"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987244"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="#local-6989586621680987188"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987241"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-572"></span><span>      </span><span id="local-6989586621680987245"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987245"><span class="hs-identifier hs-var">c'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="#local-6989586621680987188"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987242"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-573"></span><span>      </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0 -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-var">IfE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987243"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987244"><span class="hs-identifier hs-var">b'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987245"><span class="hs-identifier hs-var">c'</span></a></span><span>
</span><span id="line-574"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-type">MkProdE</span></a></span><span> </span><span id="local-6989586621680987246"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987246"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-575"></span><span>      </span><span id="local-6989586621680987247"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987247"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; [Exp0] -&gt; StateT MonoState PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Set Var -&gt; Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#collectMonoObls"><span class="hs-identifier hs-var">collectMonoObls</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987167"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680987168"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680987169"><span class="hs-identifier hs-var">toplevel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987246"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-576"></span><span>      </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
[PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-var">MkProdE</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987247"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-577"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-type">ProjE</span></a></span><span> </span><span id="local-6989586621680987248"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680987248"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680987249"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987249"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-578"></span><span>      </span><span id="local-6989586621680987250"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987250"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="#local-6989586621680987188"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987249"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-579"></span><span>      </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Int -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-var">ProjE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680987248"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987250"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-580"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-type">TimeIt</span></a></span><span> </span><span id="local-6989586621680987251"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987251"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680987252"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987252"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680987253"><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680987253"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-581"></span><span>      </span><span id="local-6989586621680987254"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987254"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="#local-6989586621680987188"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987251"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-582"></span><span>      </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Ty0 -&gt; IsBoxed -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec -&gt; dec -&gt; IsBoxed -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-var">TimeIt</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987254"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987252"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680987253"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-583"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-type">WithArenaE</span></a></span><span> </span><span id="local-6989586621680987255"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987255"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680987256"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987256"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-584"></span><span>      </span><span id="local-6989586621680987257"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987257"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="#local-6989586621680987188"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987256"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-585"></span><span>      </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-var">WithArenaE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987255"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987257"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-586"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span id="local-6989586621680987258"><span class="annot"><span class="annottext">E0Ext Ty0 Ty0
</span><a href="#local-6989586621680987258"><span class="hs-identifier hs-var">ext</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-587"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0
</span><a href="#local-6989586621680987258"><span class="hs-identifier hs-var">ext</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-588"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#LambdaE"><span class="hs-identifier hs-type">LambdaE</span></a></span><span> </span><span id="local-6989586621680987259"><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680987259"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621680987260"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987260"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-589"></span><span>          </span><span id="local-6989586621680987261"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987261"><span class="hs-identifier hs-var">bod'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Set Var -&gt; Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#collectMonoObls"><span class="hs-identifier hs-var">collectMonoObls</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987167"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyEnv Ty0 -&gt; Env2 Ty0 -&gt; Env2 Ty0
forall a. Map Var a -&gt; Env2 a -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#extendsVEnv"><span class="hs-identifier hs-var">extendsVEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, Ty0)] -&gt; TyEnv Ty0
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680987259"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680987168"><span class="hs-identifier hs-var">env2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680987169"><span class="hs-identifier hs-var">toplevel</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987260"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-590"></span><span>          </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0) -&gt; E0Ext Ty0 Ty0 -&gt; Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)] -&gt; Exp0 -&gt; E0Ext Ty0 Ty0
forall loc dec.
[(Var, dec)] -&gt; PreExp E0Ext loc dec -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#LambdaE"><span class="hs-identifier hs-var">LambdaE</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680987259"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987261"><span class="hs-identifier hs-var">bod'</span></a></span><span>
</span><span id="line-591"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#PolyAppE"><span class="hs-identifier hs-type">PolyAppE</span></a></span><span> </span><span id="local-6989586621680987262"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987262"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621680987263"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987263"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-592"></span><span>          </span><span id="local-6989586621680987264"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987264"><span class="hs-identifier hs-var">op'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="#local-6989586621680987188"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987262"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-593"></span><span>          </span><span id="local-6989586621680987265"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987265"><span class="hs-identifier hs-var">arg'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="#local-6989586621680987188"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987263"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-594"></span><span>          </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0) -&gt; E0Ext Ty0 Ty0 -&gt; Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0 -&gt; E0Ext Ty0 Ty0
forall loc dec.
PreExp E0Ext loc dec -&gt; PreExp E0Ext loc dec -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#PolyAppE"><span class="hs-identifier hs-var">PolyAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987264"><span class="hs-identifier hs-var">op'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987265"><span class="hs-identifier hs-var">arg'</span></a></span><span>
</span><span id="line-595"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunRefE"><span class="hs-identifier hs-type">FunRefE</span></a></span><span> </span><span id="local-6989586621680987266"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987266"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span> </span><span id="local-6989586621680987267"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987267"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-596"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987266"><span class="hs-identifier hs-var">tyapps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-597"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0) -&gt; E0Ext Ty0 Ty0 -&gt; Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; Var -&gt; E0Ext Ty0 Ty0
forall loc dec. [loc] -&gt; Var -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#FunRefE"><span class="hs-identifier hs-var">FunRefE</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987267"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-598"></span><span>            </span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-599"></span><span>              </span><span id="local-6989586621680987268"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987268"><span class="hs-identifier hs-var">tyapps'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; StateT MonoState PassM Ty0)
-&gt; [Ty0] -&gt; StateT MonoState PassM [Ty0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Ty0 -&gt; StateT MonoState PassM Ty0
</span><a href="Gibbon.L0.Specialize2.html#monoOblsTy"><span class="hs-identifier hs-var">monoOblsTy</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987167"><span class="hs-identifier hs-var">ddefs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987266"><span class="hs-identifier hs-var">tyapps</span></a></span><span>
</span><span id="line-600"></span><span>              </span><span id="local-6989586621680987269"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987269"><span class="hs-identifier hs-var">f'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; StateT MonoState PassM Var
</span><a href="#local-6989586621680987180"><span class="hs-identifier hs-var">addFnObl</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987267"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987268"><span class="hs-identifier hs-var">tyapps'</span></a></span><span>
</span><span id="line-601"></span><span>              </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0) -&gt; E0Ext Ty0 Ty0 -&gt; Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; Var -&gt; E0Ext Ty0 Ty0
forall loc dec. [loc] -&gt; Var -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#FunRefE"><span class="hs-identifier hs-var">FunRefE</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987269"><span class="hs-identifier hs-var">f'</span></a></span><span>
</span><span id="line-602"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#BenchE"><span class="hs-identifier hs-type">BenchE</span></a></span><span> </span><span id="local-6989586621680987270"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987270"><span class="hs-identifier hs-var">_fn</span></a></span></span><span> </span><span id="local-6989586621680987271"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987271"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span> </span><span id="local-6989586621680987272"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987272"><span class="hs-identifier hs-var">_args</span></a></span></span><span> </span><span id="local-6989586621680987273"><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680987273"><span class="hs-identifier hs-var">_b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-603"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987271"><span class="hs-identifier hs-var">tyapps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-604"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987170"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-605"></span><span>            </span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; MonoM Exp0
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; MonoM Exp0) -&gt; [Char] -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;collectMonoObls: Polymorphic bench not supported yet. In: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987170"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-606"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#ParE0"><span class="hs-identifier hs-type">ParE0</span></a></span><span> </span><span id="local-6989586621680987274"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987274"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-607"></span><span>          </span><span id="local-6989586621680987275"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987275"><span class="hs-identifier hs-var">ls'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; [Exp0] -&gt; StateT MonoState PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Set Var -&gt; Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#collectMonoObls"><span class="hs-identifier hs-var">collectMonoObls</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987167"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680987168"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680987169"><span class="hs-identifier hs-var">toplevel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987274"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-608"></span><span>          </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0) -&gt; E0Ext Ty0 Ty0 -&gt; Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0] -&gt; E0Ext Ty0 Ty0
forall loc dec. [PreExp E0Ext loc dec] -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#ParE0"><span class="hs-identifier hs-var">ParE0</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987275"><span class="hs-identifier hs-var">ls'</span></a></span><span>
</span><span id="line-609"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#PrintPacked"><span class="hs-identifier hs-type">PrintPacked</span></a></span><span> </span><span id="local-6989586621680987276"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987276"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680987277"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987277"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-610"></span><span>          </span><span id="local-6989586621680987278"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987278"><span class="hs-identifier hs-var">arg'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Set Var -&gt; Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#collectMonoObls"><span class="hs-identifier hs-var">collectMonoObls</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987167"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680987168"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680987169"><span class="hs-identifier hs-var">toplevel</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987277"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-611"></span><span>          </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0) -&gt; E0Ext Ty0 Ty0 -&gt; Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; Exp0 -&gt; E0Ext Ty0 Ty0
forall loc dec. dec -&gt; PreExp E0Ext loc dec -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#PrintPacked"><span class="hs-identifier hs-var">PrintPacked</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987276"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987278"><span class="hs-identifier hs-var">arg'</span></a></span><span>
</span><span id="line-612"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#CopyPacked"><span class="hs-identifier hs-type">CopyPacked</span></a></span><span> </span><span id="local-6989586621680987279"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987279"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680987280"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987280"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-613"></span><span>          </span><span id="local-6989586621680987281"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987281"><span class="hs-identifier hs-var">arg'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Set Var -&gt; Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#collectMonoObls"><span class="hs-identifier hs-var">collectMonoObls</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987167"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680987168"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680987169"><span class="hs-identifier hs-var">toplevel</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987280"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-614"></span><span>          </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0) -&gt; E0Ext Ty0 Ty0 -&gt; Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; Exp0 -&gt; E0Ext Ty0 Ty0
forall loc dec. dec -&gt; PreExp E0Ext loc dec -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#CopyPacked"><span class="hs-identifier hs-var">CopyPacked</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987279"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987281"><span class="hs-identifier hs-var">arg'</span></a></span><span>
</span><span id="line-615"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#TravPacked"><span class="hs-identifier hs-type">TravPacked</span></a></span><span> </span><span id="local-6989586621680987282"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987282"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680987283"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987283"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-616"></span><span>          </span><span id="local-6989586621680987284"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987284"><span class="hs-identifier hs-var">arg'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Set Var -&gt; Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#collectMonoObls"><span class="hs-identifier hs-var">collectMonoObls</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987167"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680987168"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680987169"><span class="hs-identifier hs-var">toplevel</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987283"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-617"></span><span>          </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0) -&gt; E0Ext Ty0 Ty0 -&gt; Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; Exp0 -&gt; E0Ext Ty0 Ty0
forall loc dec. dec -&gt; PreExp E0Ext loc dec -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#TravPacked"><span class="hs-identifier hs-var">TravPacked</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987282"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987284"><span class="hs-identifier hs-var">arg'</span></a></span><span>
</span><span id="line-618"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621680987285"><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621680987285"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680987286"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987286"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-619"></span><span>          </span><span id="local-6989586621680987287"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987287"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="#local-6989586621680987188"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987286"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-620"></span><span>          </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0) -&gt; E0Ext Ty0 Ty0 -&gt; Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Loc -&gt; Exp0 -&gt; E0Ext Ty0 Ty0
forall loc dec. Loc -&gt; PreExp E0Ext loc dec -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621680987285"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987287"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-621"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#LinearExt"><span class="hs-identifier hs-type">LinearExt</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; MonoM Exp0
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; MonoM Exp0) -&gt; [Char] -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;collectMonoObls: a linear types extension wasn't desugared: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987170"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-622"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-type">SpawnE</span></a></span><span> </span><span id="local-6989586621680987288"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987288"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621680987289"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987289"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-623"></span><span>      </span><span id="local-6989586621680987290"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987290"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; [Exp0] -&gt; StateT MonoState PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Set Var -&gt; Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#collectMonoObls"><span class="hs-identifier hs-var">collectMonoObls</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987167"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680987168"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680987169"><span class="hs-identifier hs-var">toplevel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987289"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-624"></span><span>      </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-var">SpawnE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987288"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987290"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-625"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-type">SpawnE</span></a></span><span> </span><span id="local-6989586621680987291"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987291"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680987292"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987292"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span> </span><span id="local-6989586621680987293"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987293"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-626"></span><span>      </span><span id="local-6989586621680987294"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987294"><span class="hs-identifier hs-var">args'</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; [Exp0] -&gt; StateT MonoState PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Set Var -&gt; Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#collectMonoObls"><span class="hs-identifier hs-var">collectMonoObls</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987167"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680987168"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680987169"><span class="hs-identifier hs-var">toplevel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987293"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-627"></span><span>      </span><span id="local-6989586621680987295"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987295"><span class="hs-identifier hs-var">tyapps'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; StateT MonoState PassM Ty0)
-&gt; [Ty0] -&gt; StateT MonoState PassM [Ty0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Ty0 -&gt; StateT MonoState PassM Ty0
</span><a href="Gibbon.L0.Specialize2.html#monoOblsTy"><span class="hs-identifier hs-var">monoOblsTy</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987167"><span class="hs-identifier hs-var">ddefs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987292"><span class="hs-identifier hs-var">tyapps</span></a></span><span>
</span><span id="line-628"></span><span>      </span><span id="local-6989586621680987296"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987296"><span class="hs-identifier hs-var">f'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; StateT MonoState PassM Var
</span><a href="#local-6989586621680987180"><span class="hs-identifier hs-var">addFnObl</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987291"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987295"><span class="hs-identifier hs-var">tyapps'</span></a></span><span>
</span><span id="line-629"></span><span>      </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-var">SpawnE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987296"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987294"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-630"></span><span>    </span><span class="annot"><span class="annottext">Exp0
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span>
</span><span id="line-631"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MapE"><span class="hs-identifier hs-type">MapE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; MonoM Exp0
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; MonoM Exp0) -&gt; [Char] -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;collectMonoObls: TODO: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987170"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-632"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FoldE"><span class="hs-identifier hs-type">FoldE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; MonoM Exp0
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; MonoM Exp0) -&gt; [Char] -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;collectMonoObls: TODO: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987170"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-633"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-634"></span><span>    </span><span id="local-6989586621680987188"><span class="annot"><span class="annottext">go :: Exp0 -&gt; MonoM Exp0
</span><a href="#local-6989586621680987188"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Set Var -&gt; Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#collectMonoObls"><span class="hs-identifier hs-var">collectMonoObls</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987167"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680987168"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680987169"><span class="hs-identifier hs-var">toplevel</span></a></span><span>
</span><span id="line-635"></span><span>
</span><span id="line-636"></span><span>    </span><span class="hs-comment">-- 'fn' Could be either a lambda, or toplevel</span><span>
</span><span id="line-637"></span><span>    </span><span class="annot"><a href="#local-6989586621680987180"><span class="hs-identifier hs-type">addFnObl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoM"><span class="hs-identifier hs-type">MonoM</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>
</span><span id="line-638"></span><span>    </span><span id="local-6989586621680987180"><span class="annot"><span class="annottext">addFnObl :: Var -&gt; [Ty0] -&gt; StateT MonoState PassM Var
</span><a href="#local-6989586621680987180"><span class="hs-identifier hs-var hs-var">addFnObl</span></a></span></span><span> </span><span id="local-6989586621680987297"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987297"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680987298"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987298"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-639"></span><span>      </span><span id="local-6989586621680987299"><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987299"><span class="hs-identifier hs-var">mono_st</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT MonoState PassM MonoState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-640"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987297"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Set Var -&gt; IsBoxed
forall a. Ord a =&gt; a -&gt; Set a -&gt; IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#member"><span class="hs-operator hs-var">`S.member`</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680987169"><span class="hs-identifier hs-var">toplevel</span></a></span><span>
</span><span id="line-641"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Ty0]) -&gt; Map (Var, [Ty0]) Var -&gt; Maybe Var
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987297"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987298"><span class="hs-identifier hs-var">tyapps</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MonoState -&gt; Map (Var, [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_funs_done"><span class="hs-identifier hs-var">mono_funs_done</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987299"><span class="hs-identifier hs-var">mono_st</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0]) -&gt; Map (Var, [Ty0]) Var -&gt; Maybe Var
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987297"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987298"><span class="hs-identifier hs-var">tyapps</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MonoState -&gt; Map (Var, [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_funs_worklist"><span class="hs-identifier hs-var">mono_funs_worklist</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987299"><span class="hs-identifier hs-var">mono_st</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-642"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Var
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Var
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-643"></span><span>               </span><span id="local-6989586621680987301"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987301"><span class="hs-identifier hs-var">new_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PassM Var -&gt; StateT MonoState PassM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT MonoState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Var -&gt; StateT MonoState PassM Var)
-&gt; PassM Var -&gt; StateT MonoState PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987297"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-644"></span><span>               </span><span class="annot"><span class="annottext">(MonoState -&gt; ((), MonoState)) -&gt; StateT MonoState PassM ()
forall a. (MonoState -&gt; (a, MonoState)) -&gt; StateT MonoState PassM a
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; (a, s)) -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#state"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680987302"><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987302"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0]) -&gt; Var -&gt; MonoState -&gt; MonoState
</span><a href="Gibbon.L0.Specialize2.html#extendFuns"><span class="hs-identifier hs-var">extendFuns</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987297"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987298"><span class="hs-identifier hs-var">tyapps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987301"><span class="hs-identifier hs-var">new_name</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987302"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-645"></span><span>               </span><span class="annot"><span class="annottext">Var -&gt; StateT MonoState PassM Var
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987301"><span class="hs-identifier hs-var">new_name</span></a></span><span>
</span><span id="line-646"></span><span>             </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680987303"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987303"><span class="hs-identifier hs-var">fn_name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; StateT MonoState PassM Var
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987303"><span class="hs-identifier hs-var">fn_name</span></a></span><span>
</span><span id="line-647"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680987304"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987304"><span class="hs-identifier hs-var">fn_name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; StateT MonoState PassM Var
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987304"><span class="hs-identifier hs-var">fn_name</span></a></span><span>
</span><span id="line-648"></span><span>
</span><span id="line-649"></span><span>      </span><span class="hs-comment">-- Why (f,[])? See &quot;Special case for lambda bindings passed in as function arguments&quot;.</span><span>
</span><span id="line-650"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Ty0]) -&gt; Map (Var, [Ty0]) Var -&gt; Maybe Var
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987297"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MonoState -&gt; Map (Var, [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_lams"><span class="hs-identifier hs-var">mono_lams</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987299"><span class="hs-identifier hs-var">mono_st</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0]) -&gt; Map (Var, [Ty0]) Var -&gt; Maybe Var
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987297"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987298"><span class="hs-identifier hs-var">tyapps</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MonoState -&gt; Map (Var, [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_lams"><span class="hs-identifier hs-var">mono_lams</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987299"><span class="hs-identifier hs-var">mono_st</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-651"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Var
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Var
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-652"></span><span>               </span><span id="local-6989586621680987305"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987305"><span class="hs-identifier hs-var">new_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PassM Var -&gt; StateT MonoState PassM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT MonoState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Var -&gt; StateT MonoState PassM Var)
-&gt; PassM Var -&gt; StateT MonoState PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987297"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-653"></span><span>               </span><span class="annot"><span class="annottext">(MonoState -&gt; ((), MonoState)) -&gt; StateT MonoState PassM ()
forall a. (MonoState -&gt; (a, MonoState)) -&gt; StateT MonoState PassM a
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; (a, s)) -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#state"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680987306"><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987306"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">(Var, [Ty0]) -&gt; Var -&gt; MonoState -&gt; MonoState
</span><a href="Gibbon.L0.Specialize2.html#extendLambdas"><span class="hs-identifier hs-var">extendLambdas</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987297"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987298"><span class="hs-identifier hs-var">tyapps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987305"><span class="hs-identifier hs-var">new_name</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987306"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-654"></span><span>               </span><span class="annot"><span class="annottext">Var -&gt; StateT MonoState PassM Var
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987305"><span class="hs-identifier hs-var">new_name</span></a></span><span>
</span><span id="line-655"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680987307"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987307"><span class="hs-identifier hs-var">lam_name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; StateT MonoState PassM Var
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987307"><span class="hs-identifier hs-var">lam_name</span></a></span><span>
</span><span id="line-656"></span><span>             </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680987308"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987308"><span class="hs-identifier hs-var">lam_name</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; StateT MonoState PassM Var
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987308"><span class="hs-identifier hs-var">lam_name</span></a></span><span>
</span><span id="line-657"></span><span>
</span><span id="line-658"></span><span>
</span><span id="line-659"></span><span class="hs-comment">-- | Create monomorphic versions of lambdas bound in this expression.</span><span>
</span><span id="line-660"></span><span class="hs-comment">-- This does not float out the lambda definitions.</span><span>
</span><span id="line-661"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#monoLambdas"><span class="hs-identifier hs-type">monoLambdas</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoM"><span class="hs-identifier hs-type">MonoM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span>
</span><span id="line-662"></span><span class="hs-comment">-- Assummption: lambdas only appear as RHS in a let.</span><span>
</span><span id="line-663"></span><span id="monoLambdas"><span class="annot"><span class="annottext">monoLambdas :: Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#monoLambdas"><span class="hs-identifier hs-var hs-var">monoLambdas</span></a></span></span><span> </span><span id="local-6989586621680987425"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987425"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-664"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987425"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-665"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680987426"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987426"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span id="local-6989586621680987427"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987427"><span class="hs-identifier hs-var">vty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680987428"><span class="annot"><span class="annottext">rhs :: Exp0
</span><a href="#local-6989586621680987428"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#LambdaE"><span class="hs-identifier hs-type">LambdaE</span></a></span><span> </span><span id="local-6989586621680987429"><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680987429"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621680987430"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987430"><span class="hs-identifier hs-var">lam_bod</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621680987431"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987431"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-666"></span><span>      </span><span id="local-6989586621680987432"><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987432"><span class="hs-identifier hs-var">mono_st</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT MonoState PassM MonoState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-667"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680987433"><span class="annot"><span class="annottext">lam_mono_st :: Map Var [Ty0]
</span><a href="#local-6989586621680987433"><span class="hs-identifier hs-var hs-var">lam_mono_st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; MonoState -&gt; Map Var [Ty0]
</span><a href="Gibbon.L0.Specialize2.html#getLambdaObls"><span class="hs-identifier hs-var">getLambdaObls</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987426"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987432"><span class="hs-identifier hs-var">mono_st</span></a></span><span>
</span><span id="line-668"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Map Var [Ty0] -&gt; IsBoxed
forall k a. Map k a -&gt; IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#null"><span class="hs-identifier hs-var">M.null</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [Ty0]
</span><a href="#local-6989586621680987433"><span class="hs-identifier hs-var">lam_mono_st</span></a></span><span>
</span><span id="line-669"></span><span>      </span><span class="hs-comment">-- This lambda is not polymorphic, don't monomorphize.</span><span>
</span><span id="line-670"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-671"></span><span>        </span><span id="local-6989586621680987434"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987434"><span class="hs-identifier hs-var">bod'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="#local-6989586621680987435"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987431"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-672"></span><span>        </span><span id="local-6989586621680987436"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987436"><span class="hs-identifier hs-var">lam_bod'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#monoLambdas"><span class="hs-identifier hs-var">monoLambdas</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987430"><span class="hs-identifier hs-var">lam_bod</span></a></span><span>
</span><span id="line-673"></span><span>        </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0) -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987426"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987427"><span class="hs-identifier hs-var">vty</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, Ty0)] -&gt; Exp0 -&gt; E0Ext Ty0 Ty0
forall loc dec.
[(Var, dec)] -&gt; PreExp E0Ext loc dec -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#LambdaE"><span class="hs-identifier hs-var">LambdaE</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680987429"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987436"><span class="hs-identifier hs-var">lam_bod'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987434"><span class="hs-identifier hs-var">bod'</span></a></span><span>
</span><span id="line-674"></span><span>      </span><span class="hs-comment">-- Monomorphize and only bind those, drop the polymorphic defn.</span><span>
</span><span id="line-675"></span><span>      </span><span class="hs-comment">-- Also drop the obligation that we applied from MonoState.</span><span>
</span><span id="line-676"></span><span>      </span><span class="hs-comment">-- So after 'monoLambdas' is done, (mono_lams MonoState) should be [].</span><span>
</span><span id="line-677"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-678"></span><span>        </span><span class="hs-comment">-- new_lam_mono_st = old_lam_mono_st - applied_lam_mono_st</span><span>
</span><span id="line-679"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680987437"><span class="annot"><span class="annottext">new_lam_mono_st :: Map (Var, [Ty0]) Var
</span><a href="#local-6989586621680987437"><span class="hs-identifier hs-var hs-var">new_lam_mono_st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MonoState -&gt; Map (Var, [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_lams"><span class="hs-identifier hs-var">mono_lams</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987432"><span class="hs-identifier hs-var">mono_st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (Var, [Ty0]) Var
-&gt; Map (Var, [Ty0]) Var -&gt; Map (Var, [Ty0]) Var
forall k a b. Ord k =&gt; Map k a -&gt; Map k b -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#difference"><span class="hs-operator hs-var">`M.difference`</span></a></span><span>
</span><span id="line-680"></span><span>                              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[((Var, [Ty0]), Var)] -&gt; Map (Var, [Ty0]) Var
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([((Var, [Ty0]), Var)] -&gt; Map (Var, [Ty0]) Var)
-&gt; [((Var, [Ty0]), Var)] -&gt; Map (Var, [Ty0]) Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((Var, [Ty0]) -&gt; ((Var, [Ty0]), Var))
-&gt; [(Var, [Ty0])] -&gt; [((Var, [Ty0]), Var)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680987439"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987439"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680987440"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987440"><span class="hs-identifier hs-var">wtyapps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987426"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987440"><span class="hs-identifier hs-var">wtyapps</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987439"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [Ty0] -&gt; [(Var, [Ty0])]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#toList"><span class="hs-identifier hs-var">M.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [Ty0]
</span><a href="#local-6989586621680987433"><span class="hs-identifier hs-var">lam_mono_st</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-681"></span><span>            </span><span id="local-6989586621680987441"><span class="annot"><span class="annottext">mono_st' :: MonoState
</span><a href="#local-6989586621680987441"><span class="hs-identifier hs-var hs-var">mono_st'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987432"><span class="hs-identifier hs-var">mono_st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mono_lams :: Map (Var, [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_lams"><span class="hs-identifier hs-var">mono_lams</span></a></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Map (Var, [Ty0]) Var
</span><a href="#local-6989586621680987437"><span class="hs-identifier hs-var">new_lam_mono_st</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-682"></span><span>        </span><span class="annot"><span class="annottext">MonoState -&gt; StateT MonoState PassM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987441"><span class="hs-identifier hs-var">mono_st'</span></a></span><span>
</span><span id="line-683"></span><span>        </span><span id="local-6989586621680987442"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987442"><span class="hs-identifier hs-var">bod'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#monoLambdas"><span class="hs-identifier hs-var">monoLambdas</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987431"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-684"></span><span>        </span><span id="local-6989586621680987443"><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680987443"><span class="hs-identifier hs-var">monomorphized</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0])] -&gt; (Ty0, Exp0) -&gt; MonoM [(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680987444"><span class="hs-identifier hs-var">monoLamBinds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [Ty0] -&gt; [(Var, [Ty0])]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#toList"><span class="hs-identifier hs-var">M.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [Ty0]
</span><a href="#local-6989586621680987433"><span class="hs-identifier hs-var">lam_mono_st</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987427"><span class="hs-identifier hs-var">vty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987428"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-685"></span><span>        </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; (Var, [Ty0], Ty0, Exp0) -&gt; Exp0)
-&gt; Exp0 -&gt; [(Var, [Ty0], Ty0, Exp0)] -&gt; Exp0
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">foldl</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680987446"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987446"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621680987447"><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0)
</span><a href="#local-6989586621680987447"><span class="hs-identifier hs-var">bind</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0) -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0)
</span><a href="#local-6989586621680987447"><span class="hs-identifier hs-var">bind</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987446"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987442"><span class="hs-identifier hs-var">bod'</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680987443"><span class="hs-identifier hs-var">monomorphized</span></a></span><span>
</span><span id="line-686"></span><span>
</span><span id="line-687"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp0
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; MonoM Exp0
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; MonoM Exp0) -&gt; [Char] -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;monoLambdas: Let not monomorphized: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987425"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-688"></span><span>
</span><span id="line-689"></span><span>    </span><span class="hs-comment">-- Straightforward recursion</span><span>
</span><span id="line-690"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987425"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-691"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-type">LitE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987425"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-692"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CharE"><span class="hs-identifier hs-type">CharE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987425"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-693"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-type">FloatE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987425"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-694"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-type">LitSymE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987425"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-695"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span id="local-6989586621680987448"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987448"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680987449"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987449"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span> </span><span id="local-6989586621680987450"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987450"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-696"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987449"><span class="hs-identifier hs-var">tyapps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-697"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680987451"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987451"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; [Exp0] -&gt; StateT MonoState PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#monoLambdas"><span class="hs-identifier hs-var">monoLambdas</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987450"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-698"></span><span>                 </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987448"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987451"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-699"></span><span>        </span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; MonoM Exp0
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; MonoM Exp0) -&gt; [Char] -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;monoLambdas: Expression probably not processed by collectMonoObls: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987425"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-700"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span id="local-6989586621680987452"><span class="annot"><span class="annottext">Prim Ty0
</span><a href="#local-6989586621680987452"><span class="hs-identifier hs-var">pr</span></a></span></span><span> </span><span id="local-6989586621680987453"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987453"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680987454"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987454"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; [Exp0] -&gt; StateT MonoState PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#monoLambdas"><span class="hs-identifier hs-var">monoLambdas</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987453"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-701"></span><span>                           </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0 -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0
</span><a href="#local-6989586621680987452"><span class="hs-identifier hs-var">pr</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987454"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-702"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680987455"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987455"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span id="local-6989586621680987456"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987456"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680987457"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987457"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680987458"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987458"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-703"></span><span>      </span><span id="local-6989586621680987459"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987459"><span class="hs-identifier hs-var">rhs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="#local-6989586621680987435"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987457"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-704"></span><span>      </span><span id="local-6989586621680987460"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987460"><span class="hs-identifier hs-var">bod'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#monoLambdas"><span class="hs-identifier hs-var">monoLambdas</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987458"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-705"></span><span>      </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0) -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987455"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987456"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987459"><span class="hs-identifier hs-var">rhs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987460"><span class="hs-identifier hs-var">bod'</span></a></span><span>
</span><span id="line-706"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-type">IfE</span></a></span><span> </span><span id="local-6989586621680987461"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987461"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680987462"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987462"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680987463"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987463"><span class="hs-identifier hs-var">c</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0 -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-var">IfE</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0 -&gt; Exp0 -&gt; Exp0)
-&gt; MonoM Exp0 -&gt; StateT MonoState PassM (Exp0 -&gt; Exp0 -&gt; Exp0)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="#local-6989586621680987435"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987461"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">StateT MonoState PassM (Exp0 -&gt; Exp0 -&gt; Exp0)
-&gt; MonoM Exp0 -&gt; StateT MonoState PassM (Exp0 -&gt; Exp0)
forall a b.
StateT MonoState PassM (a -&gt; b)
-&gt; StateT MonoState PassM a -&gt; StateT MonoState PassM b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="#local-6989586621680987435"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987462"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">StateT MonoState PassM (Exp0 -&gt; Exp0) -&gt; MonoM Exp0 -&gt; MonoM Exp0
forall a b.
StateT MonoState PassM (a -&gt; b)
-&gt; StateT MonoState PassM a -&gt; StateT MonoState PassM b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="#local-6989586621680987435"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987463"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-707"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-type">MkProdE</span></a></span><span> </span><span id="local-6989586621680987464"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987464"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
[PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-var">MkProdE</span></a></span><span> </span><span class="annot"><span class="annottext">([Exp0] -&gt; Exp0) -&gt; StateT MonoState PassM [Exp0] -&gt; MonoM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; [Exp0] -&gt; StateT MonoState PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#monoLambdas"><span class="hs-identifier hs-var">monoLambdas</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987464"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-708"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-type">ProjE</span></a></span><span> </span><span id="local-6989586621680987465"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680987465"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680987466"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987466"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Int -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-var">ProjE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680987465"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0) -&gt; MonoM Exp0 -&gt; MonoM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="#local-6989586621680987435"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987466"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-709"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-type">CaseE</span></a></span><span> </span><span id="local-6989586621680987467"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987467"><span class="hs-identifier hs-var">scrt</span></a></span></span><span> </span><span id="local-6989586621680987468"><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680987468"><span class="hs-identifier hs-var">brs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-710"></span><span>      </span><span id="local-6989586621680987469"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987469"><span class="hs-identifier hs-var">scrt'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="#local-6989586621680987435"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987467"><span class="hs-identifier hs-var">scrt</span></a></span><span>
</span><span id="line-711"></span><span>      </span><span id="local-6989586621680987470"><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680987470"><span class="hs-identifier hs-var">brs'</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(([Char], [(Var, Ty0)], Exp0)
 -&gt; StateT MonoState PassM ([Char], [(Var, Ty0)], Exp0))
-&gt; [([Char], [(Var, Ty0)], Exp0)]
-&gt; StateT MonoState PassM [([Char], [(Var, Ty0)], Exp0)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680987471"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987471"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680987472"><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680987472"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680987473"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987473"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987471"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680987472"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; ([Char], [(Var, Ty0)], Exp0))
-&gt; MonoM Exp0
-&gt; StateT MonoState PassM ([Char], [(Var, Ty0)], Exp0)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="#local-6989586621680987435"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987473"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680987468"><span class="hs-identifier hs-var">brs</span></a></span><span>
</span><span id="line-712"></span><span>      </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [([Char], [(Var, Ty0)], Exp0)] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; [([Char], [(Var, loc)], PreExp ext loc dec)]
-&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-var">CaseE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987469"><span class="hs-identifier hs-var">scrt'</span></a></span><span> </span><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680987470"><span class="hs-identifier hs-var">brs'</span></a></span><span>
</span><span id="line-713"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-type">DataConE</span></a></span><span> </span><span id="local-6989586621680987474"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987474"><span class="hs-identifier hs-var">tyapp</span></a></span></span><span> </span><span id="local-6989586621680987475"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987475"><span class="hs-identifier hs-var">dcon</span></a></span></span><span> </span><span id="local-6989586621680987476"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987476"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-714"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; [Char] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
loc -&gt; [Char] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-var">DataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987474"><span class="hs-identifier hs-var">tyapp</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987475"><span class="hs-identifier hs-var">dcon</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Exp0] -&gt; Exp0) -&gt; StateT MonoState PassM [Exp0] -&gt; MonoM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; [Exp0] -&gt; StateT MonoState PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#monoLambdas"><span class="hs-identifier hs-var">monoLambdas</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987476"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-715"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-type">TimeIt</span></a></span><span> </span><span id="local-6989586621680987477"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987477"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680987478"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987478"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680987479"><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680987479"><span class="hs-identifier hs-var">b</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680987480"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987480"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Ty0 -&gt; IsBoxed -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec -&gt; dec -&gt; IsBoxed -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-var">TimeIt</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987480"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987478"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680987479"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0) -&gt; MonoM Exp0 -&gt; MonoM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="#local-6989586621680987435"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987477"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-716"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-type">WithArenaE</span></a></span><span> </span><span id="local-6989586621680987481"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987481"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680987482"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987482"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680987483"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987483"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-var">WithArenaE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987481"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987483"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0) -&gt; MonoM Exp0 -&gt; MonoM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="#local-6989586621680987435"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987482"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-717"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#LambdaE"><span class="hs-identifier hs-type">LambdaE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; MonoM Exp0
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; MonoM Exp0) -&gt; [Char] -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;monoLambdas: Encountered a LambdaE outside a let binding. In\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987425"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-718"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#PolyAppE"><span class="hs-identifier hs-type">PolyAppE</span></a></span><span> </span><span id="local-6989586621680987484"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987484"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621680987485"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987485"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-719"></span><span>      </span><span id="local-6989586621680987486"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987486"><span class="hs-identifier hs-var">op'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="#local-6989586621680987435"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987484"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-720"></span><span>      </span><span id="local-6989586621680987487"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987487"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="#local-6989586621680987435"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987485"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-721"></span><span>      </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0) -&gt; E0Ext Ty0 Ty0 -&gt; Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0 -&gt; E0Ext Ty0 Ty0
forall loc dec.
PreExp E0Ext loc dec -&gt; PreExp E0Ext loc dec -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#PolyAppE"><span class="hs-identifier hs-var">PolyAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987486"><span class="hs-identifier hs-var">op'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987487"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-722"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunRefE"><span class="hs-identifier hs-type">FunRefE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987425"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-723"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#BenchE"><span class="hs-identifier hs-type">BenchE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987425"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-724"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#ParE0"><span class="hs-identifier hs-type">ParE0</span></a></span><span> </span><span id="local-6989586621680987488"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987488"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0)
-&gt; ([Exp0] -&gt; E0Ext Ty0 Ty0) -&gt; [Exp0] -&gt; Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0] -&gt; E0Ext Ty0 Ty0
forall loc dec. [PreExp E0Ext loc dec] -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#ParE0"><span class="hs-identifier hs-var">ParE0</span></a></span><span> </span><span class="annot"><span class="annottext">([Exp0] -&gt; Exp0) -&gt; StateT MonoState PassM [Exp0] -&gt; MonoM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; [Exp0] -&gt; StateT MonoState PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#monoLambdas"><span class="hs-identifier hs-var">monoLambdas</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987488"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-725"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#PrintPacked"><span class="hs-identifier hs-type">PrintPacked</span></a></span><span> </span><span id="local-6989586621680987489"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987489"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680987490"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987490"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0) -&gt; (Exp0 -&gt; E0Ext Ty0 Ty0) -&gt; Exp0 -&gt; Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; Exp0 -&gt; E0Ext Ty0 Ty0
forall loc dec. dec -&gt; PreExp E0Ext loc dec -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#PrintPacked"><span class="hs-identifier hs-var">PrintPacked</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987489"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0) -&gt; MonoM Exp0 -&gt; MonoM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#monoLambdas"><span class="hs-identifier hs-var">monoLambdas</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987490"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-726"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#CopyPacked"><span class="hs-identifier hs-type">CopyPacked</span></a></span><span> </span><span id="local-6989586621680987491"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987491"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680987492"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987492"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0) -&gt; (Exp0 -&gt; E0Ext Ty0 Ty0) -&gt; Exp0 -&gt; Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; Exp0 -&gt; E0Ext Ty0 Ty0
forall loc dec. dec -&gt; PreExp E0Ext loc dec -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#CopyPacked"><span class="hs-identifier hs-var">CopyPacked</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987491"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0) -&gt; MonoM Exp0 -&gt; MonoM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#monoLambdas"><span class="hs-identifier hs-var">monoLambdas</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987492"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-727"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#TravPacked"><span class="hs-identifier hs-type">TravPacked</span></a></span><span> </span><span id="local-6989586621680987493"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987493"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680987494"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987494"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0) -&gt; (Exp0 -&gt; E0Ext Ty0 Ty0) -&gt; Exp0 -&gt; Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; Exp0 -&gt; E0Ext Ty0 Ty0
forall loc dec. dec -&gt; PreExp E0Ext loc dec -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#TravPacked"><span class="hs-identifier hs-var">TravPacked</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987493"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0) -&gt; MonoM Exp0 -&gt; MonoM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#monoLambdas"><span class="hs-identifier hs-var">monoLambdas</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987494"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-728"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621680987495"><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621680987495"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680987496"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987496"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0) -&gt; (Exp0 -&gt; E0Ext Ty0 Ty0) -&gt; Exp0 -&gt; Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Loc -&gt; Exp0 -&gt; E0Ext Ty0 Ty0
forall loc dec. Loc -&gt; PreExp E0Ext loc dec -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621680987495"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0) -&gt; MonoM Exp0 -&gt; MonoM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#monoLambdas"><span class="hs-identifier hs-var">monoLambdas</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987496"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-729"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#LinearExt"><span class="hs-identifier hs-type">LinearExt</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; MonoM Exp0
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; MonoM Exp0) -&gt; [Char] -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;monoLambdas: a linear types extension wasn't desugared: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987425"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-730"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-type">SpawnE</span></a></span><span> </span><span id="local-6989586621680987497"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987497"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680987498"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987498"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span> </span><span id="local-6989586621680987499"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987499"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-731"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987498"><span class="hs-identifier hs-var">tyapps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-732"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680987500"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987500"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; [Exp0] -&gt; StateT MonoState PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#monoLambdas"><span class="hs-identifier hs-var">monoLambdas</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987499"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-733"></span><span>                 </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; MonoM Exp0) -&gt; Exp0 -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-var">SpawnE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987497"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987500"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-734"></span><span>        </span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; MonoM Exp0
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; MonoM Exp0) -&gt; [Char] -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;monoLambdas: Expression probably not processed by collectMonoObls: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987425"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-735"></span><span>    </span><span class="annot"><span class="annottext">Exp0
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span>
</span><span id="line-736"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MapE"><span class="hs-identifier hs-type">MapE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; MonoM Exp0
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; MonoM Exp0) -&gt; [Char] -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;monoLambdas: TODO: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987425"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-737"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FoldE"><span class="hs-identifier hs-type">FoldE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; MonoM Exp0
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; MonoM Exp0) -&gt; [Char] -&gt; MonoM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;monoLambdas: TODO: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987425"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-738"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680987435"><span class="annot"><span class="annottext">go :: Exp0 -&gt; MonoM Exp0
</span><a href="#local-6989586621680987435"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; MonoM Exp0
</span><a href="Gibbon.L0.Specialize2.html#monoLambdas"><span class="hs-identifier hs-var">monoLambdas</span></a></span><span>
</span><span id="line-739"></span><span>
</span><span id="line-740"></span><span>        </span><span class="annot"><a href="#local-6989586621680987444"><span class="hs-identifier hs-type">monoLamBinds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoM"><span class="hs-identifier hs-type">MonoM</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-741"></span><span>        </span><span id="local-6989586621680987444"><span class="annot"><span class="annottext">monoLamBinds :: [(Var, [Ty0])] -&gt; (Ty0, Exp0) -&gt; MonoM [(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680987444"><span class="hs-identifier hs-var hs-var">monoLamBinds</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Ty0, Exp0)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)] -&gt; MonoM [(Var, [Ty0], Ty0, Exp0)]
forall a. a -&gt; StateT MonoState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-742"></span><span>        </span><span class="annot"><a href="#local-6989586621680987444"><span class="hs-identifier hs-var">monoLamBinds</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621680987501"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987501"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680987502"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987502"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span class="hs-special">)</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680987503"><span class="annot"><span class="annottext">[(Var, [Ty0])]
</span><a href="#local-6989586621680987503"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680987504"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987504"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680987505"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987505"><span class="hs-identifier hs-var">ex1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-743"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680987506"><span class="annot"><span class="annottext">tyvars :: [TyVar]
</span><a href="#local-6989586621680987506"><span class="hs-identifier hs-var hs-var">tyvars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; [TyVar]
</span><a href="Gibbon.L0.Syntax.html#tyVarsInTy"><span class="hs-identifier hs-var">tyVarsInTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987504"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-744"></span><span>          </span><span class="annot"><span class="annottext">[Char] -&gt; [TyVar] -&gt; [Ty0] -&gt; StateT MonoState PassM ()
forall a b (m :: * -&gt; *).
(Out a, Out b, Monad m, HasCallStack) =&gt;
[Char] -&gt; [a] -&gt; [b] -&gt; m ()
</span><a href="Gibbon.L0.Specialize2.html#assertSameLength"><span class="hs-identifier hs-var">assertSameLength</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;In the expression: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987505"><span class="hs-identifier hs-var">ex1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680987506"><span class="hs-identifier hs-var">tyvars</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987502"><span class="hs-identifier hs-var">tyapps</span></a></span><span>
</span><span id="line-745"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680987508"><span class="annot"><span class="annottext">mp :: Map TyVar Ty0
</span><a href="#local-6989586621680987508"><span class="hs-identifier hs-var hs-var">mp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(TyVar, Ty0)] -&gt; Map TyVar Ty0
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(TyVar, Ty0)] -&gt; Map TyVar Ty0)
-&gt; [(TyVar, Ty0)] -&gt; Map TyVar Ty0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; [Ty0] -&gt; [(TyVar, Ty0)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680987506"><span class="hs-identifier hs-var">tyvars</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987502"><span class="hs-identifier hs-var">tyapps</span></a></span><span>
</span><span id="line-746"></span><span>              </span><span id="local-6989586621680987509"><span class="annot"><span class="annottext">ty' :: Ty0
</span><a href="#local-6989586621680987509"><span class="hs-identifier hs-var hs-var">ty'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map TyVar Ty0 -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#substTyVar"><span class="hs-identifier hs-var">substTyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Map TyVar Ty0
</span><a href="#local-6989586621680987508"><span class="hs-identifier hs-var">mp</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987504"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-747"></span><span>              </span><span id="local-6989586621680987510"><span class="annot"><span class="annottext">ex' :: Exp0
</span><a href="#local-6989586621680987510"><span class="hs-identifier hs-var hs-var">ex'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map TyVar Ty0 -&gt; Exp0 -&gt; Exp0
</span><a href="Gibbon.L0.Typecheck.html#substTyVarExp"><span class="hs-identifier hs-var">substTyVarExp</span></a></span><span> </span><span class="annot"><span class="annottext">Map TyVar Ty0
</span><a href="#local-6989586621680987508"><span class="hs-identifier hs-var">mp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987505"><span class="hs-identifier hs-var">ex1</span></a></span><span>
</span><span id="line-748"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
-&gt; [(Var, [Ty0], Ty0, Exp0)] -&gt; [(Var, [Ty0], Ty0, Exp0)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987501"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987509"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987510"><span class="hs-identifier hs-var">ex'</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)] -&gt; [(Var, [Ty0], Ty0, Exp0)])
-&gt; MonoM [(Var, [Ty0], Ty0, Exp0)]
-&gt; MonoM [(Var, [Ty0], Ty0, Exp0)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0])] -&gt; (Ty0, Exp0) -&gt; MonoM [(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680987444"><span class="hs-identifier hs-var">monoLamBinds</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0])]
</span><a href="#local-6989586621680987503"><span class="hs-identifier hs-var">rst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987504"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987505"><span class="hs-identifier hs-var">ex1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-749"></span><span>
</span><span id="line-750"></span><span>
</span><span id="line-751"></span><span class="hs-comment">-- | Remove all polymorphic functions and datatypes from a program. 'monoLambdas'</span><span>
</span><span id="line-752"></span><span class="hs-comment">-- already gets rid of polymorphic mono_lams.</span><span>
</span><span id="line-753"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#purgePolyFuns"><span class="hs-identifier hs-type">purgePolyFuns</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Prog0"><span class="hs-identifier hs-type">Prog0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Prog0"><span class="hs-identifier hs-type">Prog0</span></a></span><span>
</span><span id="line-754"></span><span id="purgePolyFuns"><span class="annot"><span class="annottext">purgePolyFuns :: Prog0 -&gt; Prog0
</span><a href="Gibbon.L0.Specialize2.html#purgePolyFuns"><span class="hs-identifier hs-var hs-var">purgePolyFuns</span></a></span></span><span> </span><span id="local-6989586621680987511"><span class="annot"><span class="annottext">p :: Prog0
</span><a href="#local-6989586621680987511"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span class="hs-special">{</span><span id="local-6989586621680987512"><span class="annot"><span class="annottext">FunDefs Exp0
fundefs :: forall ex. Prog ex -&gt; FunDefs ex
fundefs :: FunDefs Exp0
</span><a href="Gibbon.Language.Syntax.html#fundefs"><span class="hs-identifier hs-var hs-var">fundefs</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-755"></span><span>  </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680987511"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fundefs :: FunDefs Exp0
</span><a href="Gibbon.Language.Syntax.html#fundefs"><span class="hs-identifier hs-var">fundefs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FunDef0 -&gt; IsBoxed) -&gt; FunDefs Exp0 -&gt; FunDefs Exp0
forall a k. (a -&gt; IsBoxed) -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#filter"><span class="hs-identifier hs-var">M.filter</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef0 -&gt; IsBoxed
</span><a href="Gibbon.L0.Specialize2.html#isMonoFun"><span class="hs-identifier hs-var">isMonoFun</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680987512"><span class="hs-identifier hs-var">fundefs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-756"></span><span>
</span><span id="line-757"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#isMonoFun"><span class="hs-identifier hs-type">isMonoFun</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunDef0"><span class="hs-identifier hs-type">FunDef0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-758"></span><span id="isMonoFun"><span class="annot"><span class="annottext">isMonoFun :: FunDef0 -&gt; IsBoxed
</span><a href="Gibbon.L0.Specialize2.html#isMonoFun"><span class="hs-identifier hs-var hs-var">isMonoFun</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span class="hs-special">{</span><span id="local-6989586621680987515"><span class="annot"><span class="annottext">ArrowTy (TyOf Exp0)
funTy :: forall ex. FunDef ex -&gt; ArrowTy (TyOf ex)
funTy :: ArrowTy (TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#funTy"><span class="hs-identifier hs-var hs-var">funTy</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyScheme -&gt; [TyVar]
</span><a href="Gibbon.L0.Syntax.html#tyVarsFromScheme"><span class="hs-identifier hs-var">tyVarsFromScheme</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy (TyOf Exp0)
TyScheme
</span><a href="#local-6989586621680987515"><span class="hs-identifier hs-var">funTy</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; [TyVar] -&gt; IsBoxed
forall a. Eq a =&gt; a -&gt; a -&gt; IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-759"></span><span>
</span><span id="line-760"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#purgePolyDDefs"><span class="hs-identifier hs-type">purgePolyDDefs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Prog0"><span class="hs-identifier hs-type">Prog0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Prog0"><span class="hs-identifier hs-type">Prog0</span></a></span><span>
</span><span id="line-761"></span><span id="purgePolyDDefs"><span class="annot"><span class="annottext">purgePolyDDefs :: Prog0 -&gt; Prog0
</span><a href="Gibbon.L0.Specialize2.html#purgePolyDDefs"><span class="hs-identifier hs-var hs-var">purgePolyDDefs</span></a></span></span><span> </span><span id="local-6989586621680987516"><span class="annot"><span class="annottext">p :: Prog0
</span><a href="#local-6989586621680987516"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span class="hs-special">{</span><span id="local-6989586621680987517"><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
ddefs :: forall ex. Prog ex -&gt; DDefs (TyOf ex)
ddefs :: DDefs (TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#ddefs"><span class="hs-identifier hs-var hs-var">ddefs</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-762"></span><span>  </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680987516"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ddefs :: DDefs (TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#ddefs"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DDef0 -&gt; IsBoxed) -&gt; Map Var DDef0 -&gt; Map Var DDef0
forall a k. (a -&gt; IsBoxed) -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#filter"><span class="hs-identifier hs-var">M.filter</span></a></span><span> </span><span class="annot"><span class="annottext">DDef0 -&gt; IsBoxed
forall {a}. DDef a -&gt; IsBoxed
</span><a href="#local-6989586621680987518"><span class="hs-identifier hs-var">isMonoDDef</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
Map Var DDef0
</span><a href="#local-6989586621680987517"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-763"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-764"></span><span>    </span><span id="local-6989586621680987518"><span class="annot"><span class="annottext">isMonoDDef :: DDef a -&gt; IsBoxed
</span><a href="#local-6989586621680987518"><span class="hs-identifier hs-var hs-var">isMonoDDef</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DDef"><span class="hs-identifier hs-type">DDef</span></a></span><span class="hs-special">{</span><span id="local-6989586621680987521"><span class="annot"><span class="annottext">[TyVar]
tyArgs :: forall a. DDef a -&gt; [TyVar]
tyArgs :: [TyVar]
</span><a href="Gibbon.Language.Syntax.html#tyArgs"><span class="hs-identifier hs-var hs-var">tyArgs</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680987521"><span class="hs-identifier hs-var">tyArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; [TyVar] -&gt; IsBoxed
forall a. Eq a =&gt; a -&gt; a -&gt; IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-765"></span><span>
</span><span id="line-766"></span><span class="hs-comment">-- See Step (4) in the big note. Lot of code duplication :(</span><span>
</span><span id="line-767"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#updateTyCons"><span class="hs-identifier hs-type">updateTyCons</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoState"><span class="hs-identifier hs-type">MonoState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Prog0"><span class="hs-identifier hs-type">Prog0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Prog0"><span class="hs-identifier hs-type">Prog0</span></a></span><span>
</span><span id="line-768"></span><span id="updateTyCons"><span class="annot"><span class="annottext">updateTyCons :: MonoState -&gt; Prog0 -&gt; Prog0
</span><a href="Gibbon.L0.Specialize2.html#updateTyCons"><span class="hs-identifier hs-var hs-var">updateTyCons</span></a></span></span><span> </span><span id="local-6989586621680987522"><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987522"><span class="hs-identifier hs-var">mono_st</span></a></span></span><span> </span><span id="local-6989586621680987523"><span class="annot"><span class="annottext">p :: Prog0
</span><a href="#local-6989586621680987523"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span class="hs-special">{</span><span id="local-6989586621680987524"><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
ddefs :: forall ex. Prog ex -&gt; DDefs (TyOf ex)
ddefs :: DDefs (TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#ddefs"><span class="hs-identifier hs-var hs-var">ddefs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680987525"><span class="annot"><span class="annottext">FunDefs Exp0
fundefs :: forall ex. Prog ex -&gt; FunDefs ex
fundefs :: FunDefs Exp0
</span><a href="Gibbon.Language.Syntax.html#fundefs"><span class="hs-identifier hs-var hs-var">fundefs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680987526"><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
mainExp :: forall ex. Prog ex -&gt; Maybe (ex, TyOf ex)
mainExp :: Maybe (Exp0, TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#mainExp"><span class="hs-identifier hs-var hs-var">mainExp</span></a></span></span><span class="hs-special">}</span><span class="hs-glyph">=</span><span>
</span><span id="line-769"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680987527"><span class="annot"><span class="annottext">fundefs' :: FunDefs Exp0
</span><a href="#local-6989586621680987527"><span class="hs-identifier hs-var hs-var">fundefs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FunDef0 -&gt; FunDef0) -&gt; FunDefs Exp0 -&gt; FunDefs Exp0
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#map"><span class="hs-identifier hs-var">M.map</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef0 -&gt; FunDef0
</span><a href="#local-6989586621680987528"><span class="hs-identifier hs-var">fixFunDef</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680987525"><span class="hs-identifier hs-var">fundefs</span></a></span><span>
</span><span id="line-770"></span><span>      </span><span id="local-6989586621680987529"><span class="annot"><span class="annottext">mainExp' :: Maybe (Exp0, Ty0)
</span><a href="#local-6989586621680987529"><span class="hs-identifier hs-var hs-var">mainExp'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
</span><a href="#local-6989586621680987526"><span class="hs-identifier hs-var">mainExp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-771"></span><span>                   </span><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp0, Ty0)
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-772"></span><span>                   </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680987530"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987530"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680987531"><span class="annot"><span class="annottext">TyOf Exp0
</span><a href="#local-6989586621680987531"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Exp0, Ty0) -&gt; Maybe (Exp0, Ty0)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; MonoState -&gt; Exp0 -&gt; Exp0
</span><a href="Gibbon.L0.Specialize2.html#updateTyConsExp"><span class="hs-identifier hs-var">updateTyConsExp</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
Map Var DDef0
</span><a href="#local-6989586621680987524"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987522"><span class="hs-identifier hs-var">mono_st</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987530"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; MonoState -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Specialize2.html#updateTyConsTy"><span class="hs-identifier hs-var">updateTyConsTy</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
Map Var DDef0
</span><a href="#local-6989586621680987524"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987522"><span class="hs-identifier hs-var">mono_st</span></a></span><span> </span><span class="annot"><span class="annottext">TyOf Exp0
Ty0
</span><a href="#local-6989586621680987531"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-773"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680987523"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fundefs :: FunDefs Exp0
</span><a href="Gibbon.Language.Syntax.html#fundefs"><span class="hs-identifier hs-var">fundefs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680987527"><span class="hs-identifier hs-var">fundefs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mainExp :: Maybe (Exp0, TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#mainExp"><span class="hs-identifier hs-var">mainExp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
Maybe (Exp0, Ty0)
</span><a href="#local-6989586621680987529"><span class="hs-identifier hs-var">mainExp'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-774"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-775"></span><span>    </span><span class="annot"><a href="#local-6989586621680987528"><span class="hs-identifier hs-type">fixFunDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunDef0"><span class="hs-identifier hs-type">FunDef0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunDef0"><span class="hs-identifier hs-type">FunDef0</span></a></span><span>
</span><span id="line-776"></span><span>    </span><span id="local-6989586621680987528"><span class="annot"><span class="annottext">fixFunDef :: FunDef0 -&gt; FunDef0
</span><a href="#local-6989586621680987528"><span class="hs-identifier hs-var hs-var">fixFunDef</span></a></span></span><span> </span><span id="local-6989586621680987533"><span class="annot"><span class="annottext">fn :: FunDef0
</span><a href="#local-6989586621680987533"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span class="hs-special">{</span><span id="local-6989586621680987534"><span class="annot"><span class="annottext">ArrowTy (TyOf Exp0)
funTy :: forall ex. FunDef ex -&gt; ArrowTy (TyOf ex)
funTy :: ArrowTy (TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#funTy"><span class="hs-identifier hs-var hs-var">funTy</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680987535"><span class="annot"><span class="annottext">Exp0
funBody :: forall ex. FunDef ex -&gt; ex
funBody :: Exp0
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var hs-var">funBody</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-777"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680987536"><span class="annot"><span class="annottext">funTy' :: TyScheme
</span><a href="#local-6989586621680987536"><span class="hs-identifier hs-var hs-var">funTy'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; Ty0 -&gt; TyScheme
</span><a href="Gibbon.L0.Syntax.html#ForAll"><span class="hs-identifier hs-var">ForAll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyScheme -&gt; [TyVar]
</span><a href="Gibbon.L0.Syntax.html#tyVarsFromScheme"><span class="hs-identifier hs-var">tyVarsFromScheme</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy (TyOf Exp0)
TyScheme
</span><a href="#local-6989586621680987534"><span class="hs-identifier hs-var">funTy</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; MonoState -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Specialize2.html#updateTyConsTy"><span class="hs-identifier hs-var">updateTyConsTy</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
Map Var DDef0
</span><a href="#local-6989586621680987524"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987522"><span class="hs-identifier hs-var">mono_st</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyScheme -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#tyFromScheme"><span class="hs-identifier hs-var">tyFromScheme</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy (TyOf Exp0)
TyScheme
</span><a href="#local-6989586621680987534"><span class="hs-identifier hs-var">funTy</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-778"></span><span>          </span><span id="local-6989586621680987537"><span class="annot"><span class="annottext">funBody' :: Exp0
</span><a href="#local-6989586621680987537"><span class="hs-identifier hs-var hs-var">funBody'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; MonoState -&gt; Exp0 -&gt; Exp0
</span><a href="Gibbon.L0.Specialize2.html#updateTyConsExp"><span class="hs-identifier hs-var">updateTyConsExp</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
Map Var DDef0
</span><a href="#local-6989586621680987524"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987522"><span class="hs-identifier hs-var">mono_st</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987535"><span class="hs-identifier hs-var">funBody</span></a></span><span>
</span><span id="line-779"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680987533"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funTy :: ArrowTy (TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#funTy"><span class="hs-identifier hs-var">funTy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArrowTy (TyOf Exp0)
TyScheme
</span><a href="#local-6989586621680987536"><span class="hs-identifier hs-var">funTy'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funBody :: Exp0
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987537"><span class="hs-identifier hs-var">funBody'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-780"></span><span>
</span><span id="line-781"></span><span class="annot"><span class="hs-comment">-- |</span></span><span>
</span><span id="line-782"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#updateTyConsExp"><span class="hs-identifier hs-type">updateTyConsExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#DDefs0"><span class="hs-identifier hs-type">DDefs0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoState"><span class="hs-identifier hs-type">MonoState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span>
</span><span id="line-783"></span><span id="updateTyConsExp"><span class="annot"><span class="annottext">updateTyConsExp :: Map Var DDef0 -&gt; MonoState -&gt; Exp0 -&gt; Exp0
</span><a href="Gibbon.L0.Specialize2.html#updateTyConsExp"><span class="hs-identifier hs-var hs-var">updateTyConsExp</span></a></span></span><span> </span><span id="local-6989586621680987562"><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987562"><span class="hs-identifier hs-var">ddefs</span></a></span></span><span> </span><span id="local-6989586621680987563"><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987563"><span class="hs-identifier hs-var">mono_st</span></a></span></span><span> </span><span id="local-6989586621680987564"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987564"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-784"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987564"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-785"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987564"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-786"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-type">LitE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987564"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-787"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CharE"><span class="hs-identifier hs-type">CharE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987564"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-788"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-type">FloatE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987564"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-789"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-type">LitSymE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987564"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-790"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span id="local-6989586621680987565"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987565"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680987566"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987566"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span> </span><span id="local-6989586621680987567"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987567"><span class="hs-identifier hs-var">args</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987565"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987566"><span class="hs-identifier hs-var">tyapps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0) -&gt; [Exp0] -&gt; [Exp0]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0
</span><a href="#local-6989586621680987568"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987567"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-791"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span id="local-6989586621680987569"><span class="annot"><span class="annottext">Prim Ty0
</span><a href="#local-6989586621680987569"><span class="hs-identifier hs-var">pr</span></a></span></span><span> </span><span id="local-6989586621680987570"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987570"><span class="hs-identifier hs-var">args</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty0 -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0
</span><a href="#local-6989586621680987569"><span class="hs-identifier hs-var">pr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0) -&gt; [Exp0] -&gt; [Exp0]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0
</span><a href="#local-6989586621680987568"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987570"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-792"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680987571"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987571"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680987572"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987572"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680987573"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987573"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680987574"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987574"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680987575"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987575"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0) -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987571"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987572"><span class="hs-identifier hs-var">tyapps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; MonoState -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Specialize2.html#updateTyConsTy"><span class="hs-identifier hs-var">updateTyConsTy</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987562"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987563"><span class="hs-identifier hs-var">mono_st</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987573"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0
</span><a href="#local-6989586621680987568"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987574"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0
</span><a href="#local-6989586621680987568"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987575"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-793"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-type">IfE</span></a></span><span> </span><span id="local-6989586621680987576"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987576"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680987577"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987577"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680987578"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987578"><span class="hs-identifier hs-var">c</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0 -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-var">IfE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0
</span><a href="#local-6989586621680987568"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987576"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0
</span><a href="#local-6989586621680987568"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987577"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0
</span><a href="#local-6989586621680987568"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987578"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-794"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-type">MkProdE</span></a></span><span> </span><span id="local-6989586621680987579"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987579"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
[PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-var">MkProdE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0) -&gt; [Exp0] -&gt; [Exp0]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0
</span><a href="#local-6989586621680987568"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987579"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-795"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-type">ProjE</span></a></span><span> </span><span id="local-6989586621680987580"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680987580"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680987581"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987581"><span class="hs-identifier hs-var">e</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Int -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-var">ProjE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680987580"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0
</span><a href="#local-6989586621680987568"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987581"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-796"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-type">CaseE</span></a></span><span> </span><span id="local-6989586621680987582"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987582"><span class="hs-identifier hs-var">scrt</span></a></span></span><span> </span><span id="local-6989586621680987583"><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680987583"><span class="hs-identifier hs-var">brs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-797"></span><span>      </span><span class="annot"><span class="annottext">Exp0 -&gt; [([Char], [(Var, Ty0)], Exp0)] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; [([Char], [(Var, loc)], PreExp ext loc dec)]
-&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-var">CaseE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0
</span><a href="#local-6989586621680987568"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987582"><span class="hs-identifier hs-var">scrt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(([Char], [(Var, Ty0)], Exp0) -&gt; ([Char], [(Var, Ty0)], Exp0))
-&gt; [([Char], [(Var, Ty0)], Exp0)] -&gt; [([Char], [(Var, Ty0)], Exp0)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span>
</span><span id="line-798"></span><span>                        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680987584"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987584"><span class="hs-identifier hs-var">dcon</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680987585"><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680987585"><span class="hs-identifier hs-var">vtys</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680987586"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987586"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680987587"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680987587"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680987588"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987588"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)] -&gt; ([Var], [Ty0])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680987585"><span class="hs-identifier hs-var">vtys</span></a></span><span>
</span><span id="line-799"></span><span>                                                 </span><span id="local-6989586621680987589"><span class="annot"><span class="annottext">vtys' :: [(Var, Ty0)]
</span><a href="#local-6989586621680987589"><span class="hs-identifier hs-var hs-var">vtys'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Ty0] -&gt; [(Var, Ty0)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680987587"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">([Ty0] -&gt; [(Var, Ty0)]) -&gt; [Ty0] -&gt; [(Var, Ty0)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; Ty0) -&gt; [Ty0] -&gt; [Ty0]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; MonoState -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Specialize2.html#updateTyConsTy"><span class="hs-identifier hs-var">updateTyConsTy</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987562"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987563"><span class="hs-identifier hs-var">mono_st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987588"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-800"></span><span>                                             </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987584"><span class="hs-identifier hs-var">dcon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680987589"><span class="hs-identifier hs-var">vtys'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0
</span><a href="#local-6989586621680987568"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987586"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-801"></span><span>                        </span><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680987583"><span class="hs-identifier hs-var">brs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-802"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-type">DataConE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680987590"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987590"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680987591"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987591"><span class="hs-identifier hs-var">dcon</span></a></span></span><span> </span><span id="local-6989586621680987592"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987592"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-803"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680987593"><span class="annot"><span class="annottext">tyapps' :: [Ty0]
</span><a href="#local-6989586621680987593"><span class="hs-identifier hs-var hs-var">tyapps'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; Ty0) -&gt; [Ty0] -&gt; [Ty0]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; MonoState -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Specialize2.html#updateTyConsTy"><span class="hs-identifier hs-var">updateTyConsTy</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987562"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987563"><span class="hs-identifier hs-var">mono_st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987590"><span class="hs-identifier hs-var">tyapps</span></a></span><span>
</span><span id="line-804"></span><span>          </span><span id="local-6989586621680987594"><span class="annot"><span class="annottext">tycon :: [Char]
</span><a href="#local-6989586621680987594"><span class="hs-identifier hs-var hs-var">tycon</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; [Char] -&gt; [Char]
forall a. Out a =&gt; DDefs a -&gt; [Char] -&gt; [Char]
</span><a href="Gibbon.Language.Syntax.html#getTyOfDataCon"><span class="hs-identifier hs-var">getTyOfDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987562"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987591"><span class="hs-identifier hs-var">dcon</span></a></span><span>
</span><span id="line-805"></span><span>          </span><span id="local-6989586621680987595"><span class="annot"><span class="annottext">dcon' :: [Char]
</span><a href="#local-6989586621680987595"><span class="hs-identifier hs-var hs-var">dcon'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">([Char], [Ty0]) -&gt; Map ([Char], [Ty0]) Var -&gt; Maybe Var
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987594"><span class="hs-identifier hs-var">tycon</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987593"><span class="hs-identifier hs-var">tyapps'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MonoState -&gt; Map ([Char], [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_dcons"><span class="hs-identifier hs-var">mono_dcons</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987563"><span class="hs-identifier hs-var">mono_st</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-806"></span><span>                    </span><span class="annot"><span class="annottext">Maybe Var
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987591"><span class="hs-identifier hs-var">dcon</span></a></span><span>
</span><span id="line-807"></span><span>                    </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680987596"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987596"><span class="hs-identifier hs-var">suffix</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987591"><span class="hs-identifier hs-var">dcon</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Char]
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987596"><span class="hs-identifier hs-var">suffix</span></a></span><span>
</span><span id="line-808"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; [Char] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
loc -&gt; [Char] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-var">DataConE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987590"><span class="hs-identifier hs-var">tyapps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987595"><span class="hs-identifier hs-var">dcon'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0) -&gt; [Exp0] -&gt; [Exp0]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0
</span><a href="#local-6989586621680987568"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987592"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-809"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-type">DataConE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp0
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Exp0) -&gt; [Char] -&gt; Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;updateTyConsExp: DataConE expected ProdTy tyapps, got: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987564"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-810"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-type">TimeIt</span></a></span><span> </span><span id="local-6989586621680987597"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987597"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680987598"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987598"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680987599"><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680987599"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Ty0 -&gt; IsBoxed -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec -&gt; dec -&gt; IsBoxed -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-var">TimeIt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0
</span><a href="#local-6989586621680987568"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987597"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; MonoState -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Specialize2.html#updateTyConsTy"><span class="hs-identifier hs-var">updateTyConsTy</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987562"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987563"><span class="hs-identifier hs-var">mono_st</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987598"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680987599"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-811"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-type">WithArenaE</span></a></span><span> </span><span id="local-6989586621680987600"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987600"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680987601"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987601"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-var">WithArenaE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987600"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0
</span><a href="#local-6989586621680987568"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987601"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-812"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-type">SpawnE</span></a></span><span> </span><span id="local-6989586621680987602"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987602"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621680987603"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987603"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span> </span><span id="local-6989586621680987604"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987604"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-var">SpawnE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987602"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987603"><span class="hs-identifier hs-var">tyapps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0) -&gt; [Exp0] -&gt; [Exp0]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0
</span><a href="#local-6989586621680987568"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987604"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-813"></span><span>    </span><span class="annot"><span class="annottext">Exp0
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span>
</span><span id="line-814"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MapE"><span class="hs-identifier hs-type">MapE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp0
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Exp0) -&gt; [Char] -&gt; Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;updateTyConsExp: TODO: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987564"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-815"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FoldE"><span class="hs-identifier hs-type">FoldE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp0
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Exp0) -&gt; [Char] -&gt; Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;updateTyConsExp: TODO: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987564"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-816"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#LambdaE"><span class="hs-identifier hs-type">LambdaE</span></a></span><span> </span><span id="local-6989586621680987605"><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680987605"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621680987606"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987606"><span class="hs-identifier hs-var">bod</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, Ty0)] -&gt; Exp0 -&gt; E0Ext Ty0 Ty0
forall loc dec.
[(Var, dec)] -&gt; PreExp E0Ext loc dec -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#LambdaE"><span class="hs-identifier hs-var">LambdaE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Var, Ty0) -&gt; (Var, Ty0)) -&gt; [(Var, Ty0)] -&gt; [(Var, Ty0)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680987607"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987607"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680987608"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987608"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987607"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; MonoState -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Specialize2.html#updateTyConsTy"><span class="hs-identifier hs-var">updateTyConsTy</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987562"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987563"><span class="hs-identifier hs-var">mono_st</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987608"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680987605"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0
</span><a href="#local-6989586621680987568"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987606"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-817"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#PolyAppE"><span class="hs-identifier hs-type">PolyAppE</span></a></span><span> </span><span id="local-6989586621680987609"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987609"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680987610"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987610"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0 -&gt; E0Ext Ty0 Ty0
forall loc dec.
PreExp E0Ext loc dec -&gt; PreExp E0Ext loc dec -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#PolyAppE"><span class="hs-identifier hs-var">PolyAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0
</span><a href="#local-6989586621680987568"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987609"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0
</span><a href="#local-6989586621680987568"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987610"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-818"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunRefE"><span class="hs-identifier hs-type">FunRefE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987564"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-819"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#BenchE"><span class="hs-identifier hs-type">BenchE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987564"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-820"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#ParE0"><span class="hs-identifier hs-type">ParE0</span></a></span><span> </span><span id="local-6989586621680987611"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987611"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0) -&gt; E0Ext Ty0 Ty0 -&gt; Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0] -&gt; E0Ext Ty0 Ty0
forall loc dec. [PreExp E0Ext loc dec] -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#ParE0"><span class="hs-identifier hs-var">ParE0</span></a></span><span> </span><span class="annot"><span class="annottext">([Exp0] -&gt; E0Ext Ty0 Ty0) -&gt; [Exp0] -&gt; E0Ext Ty0 Ty0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0) -&gt; [Exp0] -&gt; [Exp0]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0
</span><a href="#local-6989586621680987568"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680987611"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-821"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#PrintPacked"><span class="hs-identifier hs-type">PrintPacked</span></a></span><span> </span><span id="local-6989586621680987612"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987612"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680987613"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987613"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0) -&gt; E0Ext Ty0 Ty0 -&gt; Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; Exp0 -&gt; E0Ext Ty0 Ty0
forall loc dec. dec -&gt; PreExp E0Ext loc dec -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#PrintPacked"><span class="hs-identifier hs-var">PrintPacked</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; MonoState -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Specialize2.html#updateTyConsTy"><span class="hs-identifier hs-var">updateTyConsTy</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987562"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987563"><span class="hs-identifier hs-var">mono_st</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987612"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0
</span><a href="#local-6989586621680987568"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987613"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-822"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#CopyPacked"><span class="hs-identifier hs-type">CopyPacked</span></a></span><span> </span><span id="local-6989586621680987614"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987614"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680987615"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987615"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0) -&gt; E0Ext Ty0 Ty0 -&gt; Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; Exp0 -&gt; E0Ext Ty0 Ty0
forall loc dec. dec -&gt; PreExp E0Ext loc dec -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#CopyPacked"><span class="hs-identifier hs-var">CopyPacked</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; MonoState -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Specialize2.html#updateTyConsTy"><span class="hs-identifier hs-var">updateTyConsTy</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987562"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987563"><span class="hs-identifier hs-var">mono_st</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987614"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0
</span><a href="#local-6989586621680987568"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987615"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-823"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#TravPacked"><span class="hs-identifier hs-type">TravPacked</span></a></span><span> </span><span id="local-6989586621680987616"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987616"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680987617"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987617"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0) -&gt; E0Ext Ty0 Ty0 -&gt; Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; Exp0 -&gt; E0Ext Ty0 Ty0
forall loc dec. dec -&gt; PreExp E0Ext loc dec -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#TravPacked"><span class="hs-identifier hs-var">TravPacked</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; MonoState -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Specialize2.html#updateTyConsTy"><span class="hs-identifier hs-var">updateTyConsTy</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987562"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987563"><span class="hs-identifier hs-var">mono_st</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987616"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0
</span><a href="#local-6989586621680987568"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987617"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-824"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621680987618"><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621680987618"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680987619"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987619"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0) -&gt; E0Ext Ty0 Ty0 -&gt; Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Loc -&gt; Exp0 -&gt; E0Ext Ty0 Ty0
forall loc dec. Loc -&gt; PreExp E0Ext loc dec -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621680987618"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0
</span><a href="#local-6989586621680987568"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987619"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-825"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#LinearExt"><span class="hs-identifier hs-type">LinearExt</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Exp0
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Exp0) -&gt; [Char] -&gt; Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;updateTyConsExp: a linear types extension wasn't desugared: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987564"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-826"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-827"></span><span>    </span><span id="local-6989586621680987568"><span class="annot"><span class="annottext">go :: Exp0 -&gt; Exp0
</span><a href="#local-6989586621680987568"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; MonoState -&gt; Exp0 -&gt; Exp0
</span><a href="Gibbon.L0.Specialize2.html#updateTyConsExp"><span class="hs-identifier hs-var">updateTyConsExp</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987562"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987563"><span class="hs-identifier hs-var">mono_st</span></a></span><span>
</span><span id="line-828"></span><span>
</span><span id="line-829"></span><span class="annot"><span class="hs-comment">-- | Update TyCons if an appropriate monomorphization obligation exists.</span></span><span>
</span><span id="line-830"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#updateTyConsTy"><span class="hs-identifier hs-type">updateTyConsTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#DDefs0"><span class="hs-identifier hs-type">DDefs0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#MonoState"><span class="hs-identifier hs-type">MonoState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span>
</span><span id="line-831"></span><span id="updateTyConsTy"><span class="annot"><span class="annottext">updateTyConsTy :: Map Var DDef0 -&gt; MonoState -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Specialize2.html#updateTyConsTy"><span class="hs-identifier hs-var hs-var">updateTyConsTy</span></a></span></span><span> </span><span id="local-6989586621680987625"><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987625"><span class="hs-identifier hs-var">ddefs</span></a></span></span><span> </span><span id="local-6989586621680987626"><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987626"><span class="hs-identifier hs-var">mono_st</span></a></span></span><span> </span><span id="local-6989586621680987627"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987627"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-832"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987627"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-833"></span><span>    </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#CharTy"><span class="hs-identifier hs-var">CharTy</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987627"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-834"></span><span>    </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#IntTy"><span class="hs-identifier hs-var">IntTy</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987627"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-835"></span><span>    </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#FloatTy"><span class="hs-identifier hs-var">FloatTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987627"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-836"></span><span>    </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#SymTy0"><span class="hs-identifier hs-var">SymTy0</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987627"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-837"></span><span>    </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#BoolTy"><span class="hs-identifier hs-var">BoolTy</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987627"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-838"></span><span>    </span><span class="annot"><a href="Gibbon.L0.Syntax.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987627"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-839"></span><span>    </span><span class="annot"><a href="Gibbon.L0.Syntax.html#MetaTv"><span class="hs-identifier hs-type">MetaTv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987627"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-840"></span><span>    </span><span class="annot"><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680987628"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987628"><span class="hs-identifier hs-var">tys</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Ty0 -&gt; Ty0) -&gt; [Ty0] -&gt; [Ty0]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; Ty0
</span><a href="#local-6989586621680987629"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987628"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-841"></span><span>    </span><span class="annot"><a href="Gibbon.L0.Syntax.html#SymDictTy"><span class="hs-identifier hs-type">SymDictTy</span></a></span><span> </span><span id="local-6989586621680987630"><span class="annot"><span class="annottext">Maybe Var
</span><a href="#local-6989586621680987630"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680987631"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987631"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Var -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#SymDictTy"><span class="hs-identifier hs-var">SymDictTy</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Var
</span><a href="#local-6989586621680987630"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; Ty0
</span><a href="#local-6989586621680987629"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987631"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-842"></span><span>    </span><span class="annot"><a href="Gibbon.L0.Syntax.html#PDictTy"><span class="hs-identifier hs-type">PDictTy</span></a></span><span> </span><span id="local-6989586621680987632"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987632"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680987633"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987633"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#PDictTy"><span class="hs-identifier hs-var">PDictTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; Ty0
</span><a href="#local-6989586621680987629"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987632"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; Ty0
</span><a href="#local-6989586621680987629"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987633"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-843"></span><span>    </span><span class="annot"><a href="Gibbon.L0.Syntax.html#ArrowTy"><span class="hs-identifier hs-type">ArrowTy</span></a></span><span> </span><span id="local-6989586621680987634"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987634"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621680987635"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987635"><span class="hs-identifier hs-var">b</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ArrowTy"><span class="hs-identifier hs-var">ArrowTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Ty0 -&gt; Ty0) -&gt; [Ty0] -&gt; [Ty0]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; Ty0
</span><a href="#local-6989586621680987629"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987634"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; Ty0
</span><a href="#local-6989586621680987629"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987635"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-844"></span><span>    </span><span class="annot"><a href="Gibbon.L0.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span id="local-6989586621680987636"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987636"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621680987637"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987637"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-845"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680987638"><span class="annot"><span class="annottext">tys' :: [Ty0]
</span><a href="#local-6989586621680987638"><span class="hs-identifier hs-var hs-var">tys'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; Ty0) -&gt; [Ty0] -&gt; [Ty0]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; Ty0
</span><a href="#local-6989586621680987629"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987637"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-846"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">([Char], [Ty0]) -&gt; Map ([Char], [Ty0]) Var -&gt; Maybe Var
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987636"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987638"><span class="hs-identifier hs-var">tys'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MonoState -&gt; Map ([Char], [Ty0]) Var
</span><a href="Gibbon.L0.Specialize2.html#mono_dcons"><span class="hs-identifier hs-var">mono_dcons</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987626"><span class="hs-identifier hs-var">mono_st</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-847"></span><span>           </span><span class="annot"><span class="annottext">Maybe Var
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#PackedTy"><span class="hs-identifier hs-var">PackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987636"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987638"><span class="hs-identifier hs-var">tys'</span></a></span><span>
</span><span id="line-848"></span><span>           </span><span class="hs-comment">-- Why [] ? The type arguments aren't required as the DDef is monomorphic.</span><span>
</span><span id="line-849"></span><span>           </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680987639"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987639"><span class="hs-identifier hs-var">suffix</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#PackedTy"><span class="hs-identifier hs-var">PackedTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680987636"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Char]
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987639"><span class="hs-identifier hs-var">suffix</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-850"></span><span>    </span><span class="annot"><a href="Gibbon.L0.Syntax.html#VectorTy"><span class="hs-identifier hs-type">VectorTy</span></a></span><span> </span><span id="local-6989586621680987640"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987640"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#VectorTy"><span class="hs-identifier hs-var">VectorTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; Ty0
</span><a href="#local-6989586621680987629"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987640"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-851"></span><span>    </span><span class="annot"><a href="Gibbon.L0.Syntax.html#ListTy"><span class="hs-identifier hs-type">ListTy</span></a></span><span> </span><span id="local-6989586621680987641"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987641"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ListTy"><span class="hs-identifier hs-var">ListTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; Ty0
</span><a href="#local-6989586621680987629"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987641"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-852"></span><span>    </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#ArenaTy"><span class="hs-identifier hs-var">ArenaTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987627"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-853"></span><span>    </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#SymSetTy"><span class="hs-identifier hs-var">SymSetTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987627"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-854"></span><span>    </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#SymHashTy"><span class="hs-identifier hs-var">SymHashTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987627"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-855"></span><span>    </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#IntHashTy"><span class="hs-identifier hs-var">IntHashTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987627"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-856"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-857"></span><span>    </span><span id="local-6989586621680987629"><span class="annot"><span class="annottext">go :: Ty0 -&gt; Ty0
</span><a href="#local-6989586621680987629"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; MonoState -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Specialize2.html#updateTyConsTy"><span class="hs-identifier hs-var">updateTyConsTy</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987625"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">MonoState
</span><a href="#local-6989586621680987626"><span class="hs-identifier hs-var">mono_st</span></a></span><span>
</span><span id="line-858"></span><span>
</span><span id="line-859"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-860"></span><span>
</span><span id="line-861"></span><span class="hs-comment">-- The specialization monad.</span><span>
</span><span id="line-862"></span><span class="hs-keyword">type</span><span> </span><span id="SpecM"><span class="annot"><a href="Gibbon.L0.Specialize2.html#SpecM"><span class="hs-identifier hs-var">SpecM</span></a></span></span><span> </span><span id="local-6989586621680987642"><span class="annot"><a href="#local-6989586621680987642"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#SpecState"><span class="hs-identifier hs-type">SpecState</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680987642"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-863"></span><span>
</span><span id="line-864"></span><span class="hs-keyword">type</span><span> </span><span id="FunRef"><span class="annot"><a href="Gibbon.L0.Specialize2.html#FunRef"><span class="hs-identifier hs-var">FunRef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>
</span><span id="line-865"></span><span>
</span><span id="line-866"></span><span class="hs-keyword">data</span><span> </span><span id="SpecState"><span class="annot"><a href="Gibbon.L0.Specialize2.html#SpecState"><span class="hs-identifier hs-var">SpecState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SpecState"><span class="annot"><a href="Gibbon.L0.Specialize2.html#SpecState"><span class="hs-identifier hs-var">SpecState</span></a></span></span><span>
</span><span id="line-867"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="sp_funs_worklist"><span class="annot"><span class="annottext">SpecState -&gt; Map (Var, [Var]) Var
</span><a href="Gibbon.L0.Specialize2.html#sp_funs_worklist"><span class="hs-identifier hs-var hs-var">sp_funs_worklist</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">M.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L0.Specialize2.html#FunRef"><span class="hs-identifier hs-type">FunRef</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>
</span><span id="line-868"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="sp_funs_done"><span class="annot"><span class="annottext">SpecState -&gt; Map (Var, [Var]) Var
</span><a href="Gibbon.L0.Specialize2.html#sp_funs_done"><span class="hs-identifier hs-var hs-var">sp_funs_done</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">M.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L0.Specialize2.html#FunRef"><span class="hs-identifier hs-type">FunRef</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>
</span><span id="line-869"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="sp_extra_args"><span class="annot"><span class="annottext">SpecState -&gt; Map Var [(Var, Ty0)]
</span><a href="Gibbon.L0.Specialize2.html#sp_extra_args"><span class="hs-identifier hs-var hs-var">sp_extra_args</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">M.Map</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-870"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="sp_fundefs"><span class="annot"><span class="annottext">SpecState -&gt; FunDefs Exp0
</span><a href="Gibbon.L0.Specialize2.html#sp_fundefs"><span class="hs-identifier hs-var hs-var">sp_fundefs</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunDefs0"><span class="hs-identifier hs-type">FunDefs0</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-871"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680987650"><span id="local-6989586621680987662"><span id="local-6989586621680987666"><span class="annot"><span class="annottext">Int -&gt; SpecState -&gt; [Char] -&gt; [Char]
[SpecState] -&gt; [Char] -&gt; [Char]
SpecState -&gt; [Char]
(Int -&gt; SpecState -&gt; [Char] -&gt; [Char])
-&gt; (SpecState -&gt; [Char])
-&gt; ([SpecState] -&gt; [Char] -&gt; [Char])
-&gt; Show SpecState
forall a.
(Int -&gt; a -&gt; [Char] -&gt; [Char])
-&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; [Char] -&gt; [Char]) -&gt; Show a
$cshowsPrec :: Int -&gt; SpecState -&gt; [Char] -&gt; [Char]
showsPrec :: Int -&gt; SpecState -&gt; [Char] -&gt; [Char]
$cshow :: SpecState -&gt; [Char]
show :: SpecState -&gt; [Char]
$cshowList :: [SpecState] -&gt; [Char] -&gt; [Char]
showList :: [SpecState] -&gt; [Char] -&gt; [Char]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680987680"><span id="local-6989586621680987691"><span class="annot"><span class="annottext">SpecState -&gt; SpecState -&gt; IsBoxed
(SpecState -&gt; SpecState -&gt; IsBoxed)
-&gt; (SpecState -&gt; SpecState -&gt; IsBoxed) -&gt; Eq SpecState
forall a. (a -&gt; a -&gt; IsBoxed) -&gt; (a -&gt; a -&gt; IsBoxed) -&gt; Eq a
$c== :: SpecState -&gt; SpecState -&gt; IsBoxed
== :: SpecState -&gt; SpecState -&gt; IsBoxed
$c/= :: SpecState -&gt; SpecState -&gt; IsBoxed
/= :: SpecState -&gt; SpecState -&gt; IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680987706"><span id="local-6989586621680987708"><span class="annot"><span class="annottext">(forall x. SpecState -&gt; Rep SpecState x)
-&gt; (forall x. Rep SpecState x -&gt; SpecState) -&gt; Generic SpecState
forall x. Rep SpecState x -&gt; SpecState
forall x. SpecState -&gt; Rep SpecState x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. SpecState -&gt; Rep SpecState x
from :: forall x. SpecState -&gt; Rep SpecState x
$cto :: forall x. Rep SpecState x -&gt; SpecState
to :: forall x. Rep SpecState x -&gt; SpecState
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Generics.html#Generic"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680987711"><span id="local-6989586621680987718"><span id="local-6989586621680987724"><span class="annot"><span class="annottext">Int -&gt; SpecState -&gt; Doc
[SpecState] -&gt; Doc
SpecState -&gt; Doc
(Int -&gt; SpecState -&gt; Doc)
-&gt; (SpecState -&gt; Doc) -&gt; ([SpecState] -&gt; Doc) -&gt; Out SpecState
forall a. (Int -&gt; a -&gt; Doc) -&gt; (a -&gt; Doc) -&gt; ([a] -&gt; Doc) -&gt; Out a
$cdocPrec :: Int -&gt; SpecState -&gt; Doc
docPrec :: Int -&gt; SpecState -&gt; Doc
$cdoc :: SpecState -&gt; Doc
doc :: SpecState -&gt; Doc
$cdocList :: [SpecState] -&gt; Doc
docList :: [SpecState] -&gt; Doc
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/GenericPretty-1.2.2-7277c36a966d41cd8e1371a7ee4c855b29a76e94dfe1d95510f68242766a5b82/share/doc/html/src/Text.PrettyPrint.GenericPretty.html#Out"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Out</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-872"></span><span>
</span><span id="line-873"></span><span class="annot"><span class="hs-comment">{-|

Specialization, only lambdas for now. E.g.

    foo :: (a -&gt; b) -&gt; a -&gt; b
    foo f1 a = f1 a

    ... foo top1 x ...

becomes

    foo f1 a = ...

    foo2 :: a -&gt; b
    foo2 a = top1 a

    ... foo2 x ...

-}</span></span><span>
</span><span id="line-892"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#specLambdas"><span class="hs-identifier hs-type">specLambdas</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Prog0"><span class="hs-identifier hs-type">Prog0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Prog0"><span class="hs-identifier hs-type">Prog0</span></a></span><span>
</span><span id="line-893"></span><span id="specLambdas"><span class="annot"><span class="annottext">specLambdas :: Prog0 -&gt; PassM Prog0
</span><a href="Gibbon.L0.Specialize2.html#specLambdas"><span class="hs-identifier hs-var hs-var">specLambdas</span></a></span></span><span> </span><span id="local-6989586621680987888"><span class="annot"><span class="annottext">prg :: Prog0
</span><a href="#local-6989586621680987888"><span class="hs-identifier hs-var">prg</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span class="hs-special">{</span><span id="local-6989586621680987889"><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
ddefs :: forall ex. Prog ex -&gt; DDefs (TyOf ex)
ddefs :: DDefs (TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#ddefs"><span class="hs-identifier hs-var hs-var">ddefs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680987890"><span class="annot"><span class="annottext">FunDefs Exp0
fundefs :: forall ex. Prog ex -&gt; FunDefs ex
fundefs :: FunDefs Exp0
</span><a href="Gibbon.Language.Syntax.html#fundefs"><span class="hs-identifier hs-var hs-var">fundefs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680987891"><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
mainExp :: forall ex. Prog ex -&gt; Maybe (ex, TyOf ex)
mainExp :: Maybe (Exp0, TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#mainExp"><span class="hs-identifier hs-var hs-var">mainExp</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-894"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680987892"><span class="annot"><span class="annottext">spec_m :: StateT SpecState PassM (Maybe (Exp0, Ty0))
</span><a href="#local-6989586621680987892"><span class="hs-identifier hs-var hs-var">spec_m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-895"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680987893"><span class="annot"><span class="annottext">env2 :: Env2 (TyOf Exp0)
</span><a href="#local-6989586621680987893"><span class="hs-identifier hs-var hs-var">env2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prog0 -&gt; Env2 (TyOf Exp0)
forall a. Prog a -&gt; Env2 (TyOf a)
</span><a href="Gibbon.Language.Syntax.html#progToEnv"><span class="hs-identifier hs-var">progToEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680987888"><span class="hs-identifier hs-var">prg</span></a></span><span>
</span><span id="line-896"></span><span>        </span><span id="local-6989586621680987895"><span class="annot"><span class="annottext">Maybe (Exp0, Ty0)
</span><a href="#local-6989586621680987895"><span class="hs-identifier hs-var">mainExp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-897"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
</span><a href="#local-6989586621680987891"><span class="hs-identifier hs-var">mainExp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-898"></span><span>            </span><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp0, Ty0) -&gt; StateT SpecState PassM (Maybe (Exp0, Ty0))
forall a. a -&gt; StateT SpecState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Exp0, Ty0)
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-899"></span><span>            </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680987896"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987896"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680987897"><span class="annot"><span class="annottext">TyOf Exp0
</span><a href="#local-6989586621680987897"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-900"></span><span>              </span><span id="local-6989586621680987898"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987898"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Exp0 -&gt; SpecM Exp0
</span><a href="Gibbon.L0.Specialize2.html#specLambdasExp"><span class="hs-identifier hs-var">specLambdasExp</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
Map Var DDef0
</span><a href="#local-6989586621680987889"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 (TyOf Exp0)
Env2 Ty0
</span><a href="#local-6989586621680987893"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987896"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-901"></span><span>              </span><span class="annot"><span class="annottext">Maybe (Exp0, Ty0) -&gt; StateT SpecState PassM (Maybe (Exp0, Ty0))
forall a. a -&gt; StateT SpecState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Exp0, Ty0) -&gt; StateT SpecState PassM (Maybe (Exp0, Ty0)))
-&gt; Maybe (Exp0, Ty0) -&gt; StateT SpecState PassM (Maybe (Exp0, Ty0))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0, Ty0) -&gt; Maybe (Exp0, Ty0)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987898"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyOf Exp0
Ty0
</span><a href="#local-6989586621680987897"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-902"></span><span>        </span><span class="hs-comment">-- Same reason as Step (1.2) in monomorphization.</span><span>
</span><span id="line-903"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680987900"><span class="annot"><span class="annottext">fo_funs :: FunDefs Exp0
</span><a href="#local-6989586621680987900"><span class="hs-identifier hs-var hs-var">fo_funs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FunDef0 -&gt; IsBoxed) -&gt; FunDefs Exp0 -&gt; FunDefs Exp0
forall a k. (a -&gt; IsBoxed) -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#filter"><span class="hs-identifier hs-var">M.filter</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef0 -&gt; IsBoxed
</span><a href="#local-6989586621680987901"><span class="hs-identifier hs-var">isFOFun</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680987890"><span class="hs-identifier hs-var">fundefs</span></a></span><span>
</span><span id="line-904"></span><span>        </span><span class="annot"><span class="annottext">(FunDef0 -&gt; StateT SpecState PassM ())
-&gt; [FunDef0] -&gt; StateT SpecState PassM ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span>
</span><span id="line-905"></span><span>          </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680987903"><span class="annot"><span class="annottext">fn :: FunDef0
</span><a href="#local-6989586621680987903"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span class="hs-special">{</span><span id="local-6989586621680987904"><span class="annot"><span class="annottext">Var
funName :: forall ex. FunDef ex -&gt; Var
funName :: Var
</span><a href="Gibbon.Language.Syntax.html#funName"><span class="hs-identifier hs-var hs-var">funName</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680987905"><span class="annot"><span class="annottext">[Var]
funArgs :: forall ex. FunDef ex -&gt; [Var]
funArgs :: [Var]
</span><a href="Gibbon.Language.Syntax.html#funArgs"><span class="hs-identifier hs-var hs-var">funArgs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680987906"><span class="annot"><span class="annottext">ArrowTy (TyOf Exp0)
funTy :: forall ex. FunDef ex -&gt; ArrowTy (TyOf ex)
funTy :: ArrowTy (TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#funTy"><span class="hs-identifier hs-var hs-var">funTy</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680987907"><span class="annot"><span class="annottext">Exp0
funBody :: forall ex. FunDef ex -&gt; ex
funBody :: Exp0
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var hs-var">funBody</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-906"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680987908"><span class="annot"><span class="annottext">venv :: TyEnv Ty0
</span><a href="#local-6989586621680987908"><span class="hs-identifier hs-var hs-var">venv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)] -&gt; TyEnv Ty0
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; [Ty0] -&gt; [(Var, Ty0)]
forall a b.
(Show a, Show b, HasCallStack) =&gt;
[a] -&gt; [b] -&gt; [(a, b)]
</span><a href="Gibbon.Common.html#fragileZip"><span class="hs-identifier hs-var">fragileZip</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680987905"><span class="hs-identifier hs-var">funArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArrowTy Ty0 -&gt; [Ty0]
forall ty. FunctionTy ty =&gt; ArrowTy ty -&gt; [ty]
</span><a href="Gibbon.Language.Syntax.html#inTys"><span class="hs-identifier hs-var">inTys</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy (TyOf Exp0)
ArrowTy Ty0
</span><a href="#local-6989586621680987906"><span class="hs-identifier hs-var">funTy</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-907"></span><span>                    </span><span id="local-6989586621680987910"><span class="annot"><span class="annottext">env2' :: Env2 Ty0
</span><a href="#local-6989586621680987910"><span class="hs-identifier hs-var hs-var">env2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyEnv Ty0 -&gt; Env2 Ty0 -&gt; Env2 Ty0
forall a. Map Var a -&gt; Env2 a -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#extendsVEnv"><span class="hs-identifier hs-var">extendsVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">TyEnv Ty0
</span><a href="#local-6989586621680987908"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 (TyOf Exp0)
Env2 Ty0
</span><a href="#local-6989586621680987893"><span class="hs-identifier hs-var">env2</span></a></span><span>
</span><span id="line-908"></span><span>                </span><span id="local-6989586621680987911"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987911"><span class="hs-identifier hs-var">funBody'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Exp0 -&gt; SpecM Exp0
</span><a href="Gibbon.L0.Specialize2.html#specLambdasExp"><span class="hs-identifier hs-var">specLambdasExp</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
Map Var DDef0
</span><a href="#local-6989586621680987889"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680987910"><span class="hs-identifier hs-var">env2'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987907"><span class="hs-identifier hs-var">funBody</span></a></span><span>
</span><span id="line-909"></span><span>                </span><span id="local-6989586621680987912"><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680987912"><span class="hs-identifier hs-var">sp_state</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT SpecState PassM SpecState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-910"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680987913"><span class="annot"><span class="annottext">funs :: FunDefs Exp0
</span><a href="#local-6989586621680987913"><span class="hs-identifier hs-var hs-var">funs</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SpecState -&gt; FunDefs Exp0
</span><a href="Gibbon.L0.Specialize2.html#sp_fundefs"><span class="hs-identifier hs-var">sp_fundefs</span></a></span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680987912"><span class="hs-identifier hs-var">sp_state</span></a></span><span>
</span><span id="line-911"></span><span>                    </span><span id="local-6989586621680987914"><span class="annot"><span class="annottext">fn' :: FunDef0
</span><a href="#local-6989586621680987914"><span class="hs-identifier hs-var hs-var">fn'</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680987903"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funBody :: Exp0
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987911"><span class="hs-identifier hs-var">funBody'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-912"></span><span>                    </span><span id="local-6989586621680987915"><span class="annot"><span class="annottext">funs' :: FunDefs Exp0
</span><a href="#local-6989586621680987915"><span class="hs-identifier hs-var hs-var">funs'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; FunDef0 -&gt; FunDefs Exp0 -&gt; FunDefs Exp0
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987904"><span class="hs-identifier hs-var">funName</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680987914"><span class="hs-identifier hs-var">fn'</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680987913"><span class="hs-identifier hs-var">funs</span></a></span><span>
</span><span id="line-913"></span><span>                    </span><span id="local-6989586621680987916"><span class="annot"><span class="annottext">sp_state' :: SpecState
</span><a href="#local-6989586621680987916"><span class="hs-identifier hs-var hs-var">sp_state'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680987912"><span class="hs-identifier hs-var">sp_state</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sp_fundefs :: FunDefs Exp0
</span><a href="Gibbon.L0.Specialize2.html#sp_fundefs"><span class="hs-identifier hs-var">sp_fundefs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680987915"><span class="hs-identifier hs-var">funs'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-914"></span><span>                </span><span class="annot"><span class="annottext">SpecState -&gt; StateT SpecState PassM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680987916"><span class="hs-identifier hs-var">sp_state'</span></a></span><span>
</span><span id="line-915"></span><span>                </span><span class="annot"><span class="annottext">() -&gt; StateT SpecState PassM ()
forall a. a -&gt; StateT SpecState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-916"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunDefs Exp0 -&gt; [FunDef0]
forall k a. Map k a -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#elems"><span class="hs-identifier hs-var">M.elems</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680987900"><span class="hs-identifier hs-var">fo_funs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-917"></span><span>        </span><span class="annot"><span class="annottext">StateT SpecState PassM ()
</span><a href="#local-6989586621680987917"><span class="hs-identifier hs-var">fixpoint</span></a></span><span>
</span><span id="line-918"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Exp0, Ty0) -&gt; StateT SpecState PassM (Maybe (Exp0, Ty0))
forall a. a -&gt; StateT SpecState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Exp0, Ty0)
</span><a href="#local-6989586621680987895"><span class="hs-identifier hs-var">mainExp'</span></a></span><span>
</span><span id="line-919"></span><span>
</span><span id="line-920"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621680987918"><span class="annot"><span class="annottext">Maybe (Exp0, Ty0)
</span><a href="#local-6989586621680987918"><span class="hs-identifier hs-var">mainExp'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680987919"><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680987919"><span class="hs-identifier hs-var">sp_state''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT SpecState PassM (Maybe (Exp0, Ty0))
-&gt; SpecState -&gt; PassM (Maybe (Exp0, Ty0), SpecState)
forall s (m :: * -&gt; *) a. StateT s m a -&gt; s -&gt; m (a, s)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#runStateT"><span class="hs-identifier hs-var">runStateT</span></a></span><span> </span><span class="annot"><span class="annottext">StateT SpecState PassM (Maybe (Exp0, Ty0))
</span><a href="#local-6989586621680987892"><span class="hs-identifier hs-var">spec_m</span></a></span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680987920"><span class="hs-identifier hs-var">emptySpecState</span></a></span><span>
</span><span id="line-921"></span><span>  </span><span class="hs-comment">-- Get rid of all higher order functions.</span><span>
</span><span id="line-922"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680987921"><span class="annot"><span class="annottext">fundefs' :: FunDefs Exp0
</span><a href="#local-6989586621680987921"><span class="hs-identifier hs-var hs-var">fundefs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0 -&gt; FunDefs Exp0
</span><a href="#local-6989586621680987922"><span class="hs-identifier hs-var">purgeHO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpecState -&gt; FunDefs Exp0
</span><a href="Gibbon.L0.Specialize2.html#sp_fundefs"><span class="hs-identifier hs-var">sp_fundefs</span></a></span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680987919"><span class="hs-identifier hs-var">sp_state''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-923"></span><span>      </span><span id="local-6989586621680987923"><span class="annot"><span class="annottext">prg' :: Prog0
</span><a href="#local-6989586621680987923"><span class="hs-identifier hs-var hs-var">prg'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680987888"><span class="hs-identifier hs-var">prg</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">mainExp :: Maybe (Exp0, TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#mainExp"><span class="hs-identifier hs-var">mainExp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
Maybe (Exp0, Ty0)
</span><a href="#local-6989586621680987918"><span class="hs-identifier hs-var">mainExp'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fundefs :: FunDefs Exp0
</span><a href="Gibbon.Language.Syntax.html#fundefs"><span class="hs-identifier hs-var">fundefs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680987921"><span class="hs-identifier hs-var">fundefs'</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-924"></span><span>
</span><span id="line-925"></span><span class="hs-comment">-- Typecheck again.</span><span>
</span><span id="line-926"></span><span>  </span><span class="annot"><span class="annottext">Prog0 -&gt; PassM Prog0
</span><a href="Gibbon.L0.Typecheck.html#tcProg"><span class="hs-identifier hs-var">tcProg</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680987923"><span class="hs-identifier hs-var">prg'</span></a></span><span>
</span><span id="line-927"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-928"></span><span>    </span><span class="annot"><a href="#local-6989586621680987920"><span class="hs-identifier hs-type">emptySpecState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#SpecState"><span class="hs-identifier hs-type">SpecState</span></a></span><span>
</span><span id="line-929"></span><span>    </span><span id="local-6989586621680987920"><span class="annot"><span class="annottext">emptySpecState :: SpecState
</span><a href="#local-6989586621680987920"><span class="hs-identifier hs-var hs-var">emptySpecState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Var, [Var]) Var
-&gt; Map (Var, [Var]) Var
-&gt; Map Var [(Var, Ty0)]
-&gt; FunDefs Exp0
-&gt; SpecState
</span><a href="Gibbon.L0.Specialize2.html#SpecState"><span class="hs-identifier hs-var">SpecState</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Var, [Var]) Var
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Var, [Var]) Var
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Ty0)]
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680987890"><span class="hs-identifier hs-var">fundefs</span></a></span><span>
</span><span id="line-930"></span><span>
</span><span id="line-931"></span><span>    </span><span class="hs-comment">-- Lower functions</span><span>
</span><span id="line-932"></span><span>    </span><span class="annot"><a href="#local-6989586621680987917"><span class="hs-identifier hs-type">fixpoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#SpecM"><span class="hs-identifier hs-type">SpecM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-933"></span><span>    </span><span id="local-6989586621680987917"><span class="annot"><span class="annottext">fixpoint :: StateT SpecState PassM ()
</span><a href="#local-6989586621680987917"><span class="hs-identifier hs-var hs-var">fixpoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-934"></span><span>      </span><span id="local-6989586621680987924"><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680987924"><span class="hs-identifier hs-var">sp_state</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT SpecState PassM SpecState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-935"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Map (Var, [Var]) Var -&gt; IsBoxed
forall k a. Map k a -&gt; IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#null"><span class="hs-identifier hs-var">M.null</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpecState -&gt; Map (Var, [Var]) Var
</span><a href="Gibbon.L0.Specialize2.html#sp_funs_worklist"><span class="hs-identifier hs-var">sp_funs_worklist</span></a></span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680987924"><span class="hs-identifier hs-var">sp_state</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-936"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; StateT SpecState PassM ()
forall a. a -&gt; StateT SpecState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-937"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-938"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680987925"><span class="annot"><span class="annottext">fns :: FunDefs Exp0
</span><a href="#local-6989586621680987925"><span class="hs-identifier hs-var hs-var">fns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SpecState -&gt; FunDefs Exp0
</span><a href="Gibbon.L0.Specialize2.html#sp_fundefs"><span class="hs-identifier hs-var">sp_fundefs</span></a></span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680987924"><span class="hs-identifier hs-var">sp_state</span></a></span><span>
</span><span id="line-939"></span><span>            </span><span id="local-6989586621680987926"><span class="annot"><span class="annottext">fn :: FunDef0
</span><a href="#local-6989586621680987926"><span class="hs-identifier hs-var hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680987925"><span class="hs-identifier hs-var">fns</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0 -&gt; Var -&gt; FunDef0
forall a b.
(Ord a, Out a, Out b, Show a, HasCallStack) =&gt;
Map a b -&gt; a -&gt; b
</span><a href="Gibbon.Common.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987927"><span class="hs-identifier hs-var">fn_name</span></a></span><span>
</span><span id="line-940"></span><span>            </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621680987927"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987927"><span class="hs-identifier hs-var">fn_name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680987928"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680987928"><span class="hs-identifier hs-var">refs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621680987929"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987929"><span class="hs-identifier hs-var">new_fn_name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Map (Var, [Var]) Var -&gt; ((Var, [Var]), Var)
forall k a. Int -&gt; Map k a -&gt; (k, a)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#elemAt"><span class="hs-identifier hs-var">M.elemAt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpecState -&gt; Map (Var, [Var]) Var
</span><a href="Gibbon.L0.Specialize2.html#sp_funs_worklist"><span class="hs-identifier hs-var">sp_funs_worklist</span></a></span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680987924"><span class="hs-identifier hs-var">sp_state</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-941"></span><span>        </span><span class="annot"><span class="annottext">Map Var DDef0
-&gt; Var -&gt; [Var] -&gt; FunDef0 -&gt; StateT SpecState PassM ()
</span><a href="Gibbon.L0.Specialize2.html#specLambdasFun"><span class="hs-identifier hs-var">specLambdasFun</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
Map Var DDef0
</span><a href="#local-6989586621680987889"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987929"><span class="hs-identifier hs-var">new_fn_name</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680987928"><span class="hs-identifier hs-var">refs</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680987926"><span class="hs-identifier hs-var">fn</span></a></span><span>
</span><span id="line-942"></span><span>        </span><span class="annot"><span class="annottext">(SpecState -&gt; ((), SpecState)) -&gt; StateT SpecState PassM ()
forall a. (SpecState -&gt; (a, SpecState)) -&gt; StateT SpecState PassM a
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; (a, s)) -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#state"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680987932"><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680987932"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680987932"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sp_funs_worklist :: Map (Var, [Var]) Var
</span><a href="Gibbon.L0.Specialize2.html#sp_funs_worklist"><span class="hs-identifier hs-var">sp_funs_worklist</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var, [Var]) -&gt; Map (Var, [Var]) Var -&gt; Map (Var, [Var]) Var
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#delete"><span class="hs-identifier hs-var">M.delete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987927"><span class="hs-identifier hs-var">fn_name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680987928"><span class="hs-identifier hs-var">refs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpecState -&gt; Map (Var, [Var]) Var
</span><a href="Gibbon.L0.Specialize2.html#sp_funs_worklist"><span class="hs-identifier hs-var">sp_funs_worklist</span></a></span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680987932"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-943"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sp_funs_done :: Map (Var, [Var]) Var
</span><a href="Gibbon.L0.Specialize2.html#sp_funs_done"><span class="hs-identifier hs-var">sp_funs_done</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var, [Var]) -&gt; Var -&gt; Map (Var, [Var]) Var -&gt; Map (Var, [Var]) Var
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987927"><span class="hs-identifier hs-var">fn_name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680987928"><span class="hs-identifier hs-var">refs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987929"><span class="hs-identifier hs-var">new_fn_name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpecState -&gt; Map (Var, [Var]) Var
</span><a href="Gibbon.L0.Specialize2.html#sp_funs_done"><span class="hs-identifier hs-var">sp_funs_done</span></a></span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680987932"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-944"></span><span>        </span><span class="annot"><span class="annottext">StateT SpecState PassM ()
</span><a href="#local-6989586621680987917"><span class="hs-identifier hs-var">fixpoint</span></a></span><span>
</span><span id="line-945"></span><span>
</span><span id="line-946"></span><span>    </span><span class="annot"><a href="#local-6989586621680987922"><span class="hs-identifier hs-type">purgeHO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunDefs0"><span class="hs-identifier hs-type">FunDefs0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunDefs0"><span class="hs-identifier hs-type">FunDefs0</span></a></span><span>
</span><span id="line-947"></span><span>    </span><span id="local-6989586621680987922"><span class="annot"><span class="annottext">purgeHO :: FunDefs Exp0 -&gt; FunDefs Exp0
</span><a href="#local-6989586621680987922"><span class="hs-identifier hs-var hs-var">purgeHO</span></a></span></span><span> </span><span id="local-6989586621680987934"><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680987934"><span class="hs-identifier hs-var">fns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FunDef0 -&gt; IsBoxed) -&gt; FunDefs Exp0 -&gt; FunDefs Exp0
forall a k. (a -&gt; IsBoxed) -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#filter"><span class="hs-identifier hs-var">M.filter</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef0 -&gt; IsBoxed
</span><a href="#local-6989586621680987901"><span class="hs-identifier hs-var">isFOFun</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680987934"><span class="hs-identifier hs-var">fns</span></a></span><span>
</span><span id="line-948"></span><span>
</span><span id="line-949"></span><span>    </span><span class="annot"><a href="#local-6989586621680987901"><span class="hs-identifier hs-type">isFOFun</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunDef0"><span class="hs-identifier hs-type">FunDef0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-950"></span><span>    </span><span id="local-6989586621680987901"><span class="annot"><span class="annottext">isFOFun :: FunDef0 -&gt; IsBoxed
</span><a href="#local-6989586621680987901"><span class="hs-identifier hs-var hs-var">isFOFun</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span class="hs-special">{</span><span id="local-6989586621680987935"><span class="annot"><span class="annottext">ArrowTy (TyOf Exp0)
funTy :: forall ex. FunDef ex -&gt; ArrowTy (TyOf ex)
funTy :: ArrowTy (TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#funTy"><span class="hs-identifier hs-var hs-var">funTy</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-951"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#ForAll"><span class="hs-identifier hs-type">ForAll</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#ArrowTy"><span class="hs-identifier hs-type">ArrowTy</span></a></span><span> </span><span id="local-6989586621680987936"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987936"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span> </span><span id="local-6989586621680987937"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987937"><span class="hs-identifier hs-var">ret_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArrowTy (TyOf Exp0)
</span><a href="#local-6989586621680987935"><span class="hs-identifier hs-var">funTy</span></a></span><span>
</span><span id="line-952"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; IsBoxed) -&gt; [Ty0] -&gt; IsBoxed
forall (t :: * -&gt; *) a.
Foldable t =&gt;
(a -&gt; IsBoxed) -&gt; t a -&gt; IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty0] -&gt; IsBoxed
forall a. [a] -&gt; IsBoxed
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">([Ty0] -&gt; IsBoxed) -&gt; (Ty0 -&gt; [Ty0]) -&gt; Ty0 -&gt; IsBoxed
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; [Ty0]
</span><a href="Gibbon.L0.Syntax.html#arrowTysInTy"><span class="hs-identifier hs-var">arrowTysInTy</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987936"><span class="hs-identifier hs-var">arg_tys</span></a></span><span> </span><span class="annot"><span class="annottext">IsBoxed -&gt; IsBoxed -&gt; IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span>
</span><span id="line-953"></span><span>         </span><span class="annot"><span class="annottext">Ty0 -&gt; [Ty0]
</span><a href="Gibbon.L0.Syntax.html#arrowTysInTy"><span class="hs-identifier hs-var">arrowTysInTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680987937"><span class="hs-identifier hs-var">ret_ty</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; [Ty0] -&gt; IsBoxed
forall a. Eq a =&gt; a -&gt; a -&gt; IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-954"></span><span>
</span><span id="line-955"></span><span class="hs-comment">-- Eliminate all functions passed in as arguments to this function.</span><span>
</span><span id="line-956"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#specLambdasFun"><span class="hs-identifier hs-type">specLambdasFun</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#DDefs0"><span class="hs-identifier hs-type">DDefs0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L0.Specialize2.html#FunRef"><span class="hs-identifier hs-type">FunRef</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunDef0"><span class="hs-identifier hs-type">FunDef0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#SpecM"><span class="hs-identifier hs-type">SpecM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-957"></span><span id="specLambdasFun"><span class="annot"><span class="annottext">specLambdasFun :: Map Var DDef0
-&gt; Var -&gt; [Var] -&gt; FunDef0 -&gt; StateT SpecState PassM ()
</span><a href="Gibbon.L0.Specialize2.html#specLambdasFun"><span class="hs-identifier hs-var hs-var">specLambdasFun</span></a></span></span><span> </span><span id="local-6989586621680987973"><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987973"><span class="hs-identifier hs-var">ddefs</span></a></span></span><span> </span><span id="local-6989586621680987974"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987974"><span class="hs-identifier hs-var">new_fn_name</span></a></span></span><span> </span><span id="local-6989586621680987975"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680987975"><span class="hs-identifier hs-var">refs</span></a></span></span><span> </span><span id="local-6989586621680987976"><span class="annot"><span class="annottext">fn :: FunDef0
</span><a href="#local-6989586621680987976"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span class="hs-special">{</span><span id="local-6989586621680987977"><span class="annot"><span class="annottext">[Var]
funArgs :: forall ex. FunDef ex -&gt; [Var]
funArgs :: [Var]
</span><a href="Gibbon.Language.Syntax.html#funArgs"><span class="hs-identifier hs-var hs-var">funArgs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680987978"><span class="annot"><span class="annottext">ArrowTy (TyOf Exp0)
funTy :: forall ex. FunDef ex -&gt; ArrowTy (TyOf ex)
funTy :: ArrowTy (TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#funTy"><span class="hs-identifier hs-var hs-var">funTy</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-958"></span><span>  </span><span id="local-6989586621680987979"><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680987979"><span class="hs-identifier hs-var">sp_state</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT SpecState PassM SpecState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-959"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-960"></span><span>      </span><span class="hs-comment">-- lamda args</span><span>
</span><span id="line-961"></span><span>      </span><span id="local-6989586621680987980"><span class="annot"><span class="annottext">funArgs' :: [Var]
</span><a href="#local-6989586621680987980"><span class="hs-identifier hs-var hs-var">funArgs'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Var, Ty0) -&gt; Var) -&gt; [(Var, Ty0)] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty0) -&gt; Var
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">([(Var, Ty0)] -&gt; [Var]) -&gt; [(Var, Ty0)] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((Var, Ty0) -&gt; IsBoxed) -&gt; [(Var, Ty0)] -&gt; [(Var, Ty0)]
forall a. (a -&gt; IsBoxed) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; IsBoxed
</span><a href="Gibbon.L0.Syntax.html#isFunTy"><span class="hs-identifier hs-var">isFunTy</span></a></span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; IsBoxed) -&gt; ((Var, Ty0) -&gt; Ty0) -&gt; (Var, Ty0) -&gt; IsBoxed
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty0) -&gt; Ty0
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Var, Ty0)] -&gt; [(Var, Ty0)]) -&gt; [(Var, Ty0)] -&gt; [(Var, Ty0)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Ty0] -&gt; [(Var, Ty0)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680987977"><span class="hs-identifier hs-var">funArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArrowTy Ty0 -&gt; [Ty0]
forall ty. FunctionTy ty =&gt; ArrowTy ty -&gt; [ty]
</span><a href="Gibbon.Language.Syntax.html#inTys"><span class="hs-identifier hs-var">inTys</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy (TyOf Exp0)
ArrowTy Ty0
</span><a href="#local-6989586621680987978"><span class="hs-identifier hs-var">funTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-962"></span><span>      </span><span id="local-6989586621680987984"><span class="annot"><span class="annottext">specs :: [(Var, Var)]
</span><a href="#local-6989586621680987984"><span class="hs-identifier hs-var hs-var">specs</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [(Var, Var)]
forall a b.
(Show a, Show b, HasCallStack) =&gt;
[a] -&gt; [b] -&gt; [(a, b)]
</span><a href="Gibbon.Common.html#fragileZip"><span class="hs-identifier hs-var">fragileZip</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680987980"><span class="hs-identifier hs-var">funArgs'</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680987975"><span class="hs-identifier hs-var">refs</span></a></span><span>
</span><span id="line-963"></span><span>      </span><span class="hs-comment">-- non-lambda args</span><span>
</span><span id="line-964"></span><span>      </span><span id="local-6989586621680987985"><span class="annot"><span class="annottext">funArgs'' :: [Var]
</span><a href="#local-6989586621680987985"><span class="hs-identifier hs-var hs-var">funArgs''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Var, Ty0) -&gt; Var) -&gt; [(Var, Ty0)] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty0) -&gt; Var
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">([(Var, Ty0)] -&gt; [Var]) -&gt; [(Var, Ty0)] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((Var, Ty0) -&gt; IsBoxed) -&gt; [(Var, Ty0)] -&gt; [(Var, Ty0)]
forall a. (a -&gt; IsBoxed) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IsBoxed -&gt; IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(IsBoxed -&gt; IsBoxed)
-&gt; ((Var, Ty0) -&gt; IsBoxed) -&gt; (Var, Ty0) -&gt; IsBoxed
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; IsBoxed
</span><a href="Gibbon.L0.Syntax.html#isFunTy"><span class="hs-identifier hs-var">isFunTy</span></a></span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; IsBoxed) -&gt; ((Var, Ty0) -&gt; Ty0) -&gt; (Var, Ty0) -&gt; IsBoxed
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty0) -&gt; Ty0
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Var, Ty0)] -&gt; [(Var, Ty0)]) -&gt; [(Var, Ty0)] -&gt; [(Var, Ty0)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Ty0] -&gt; [(Var, Ty0)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680987977"><span class="hs-identifier hs-var">funArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArrowTy Ty0 -&gt; [Ty0]
forall ty. FunctionTy ty =&gt; ArrowTy ty -&gt; [ty]
</span><a href="Gibbon.Language.Syntax.html#inTys"><span class="hs-identifier hs-var">inTys</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy (TyOf Exp0)
ArrowTy Ty0
</span><a href="#local-6989586621680987978"><span class="hs-identifier hs-var">funTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-965"></span><span>      </span><span id="local-6989586621680987987"><span class="annot"><span class="annottext">fn' :: FunDef0
</span><a href="#local-6989586621680987987"><span class="hs-identifier hs-var hs-var">fn'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680987976"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funName :: Var
</span><a href="Gibbon.Language.Syntax.html#funName"><span class="hs-identifier hs-var">funName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987974"><span class="hs-identifier hs-var">new_fn_name</span></a></span><span>
</span><span id="line-966"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funBody :: Exp0
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Var)] -&gt; Exp0 -&gt; Exp0
</span><a href="#local-6989586621680987988"><span class="hs-identifier hs-var">do_spec</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680987984"><span class="hs-identifier hs-var">specs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunDef0 -&gt; Exp0
forall ex. FunDef ex -&gt; ex
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680987976"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-967"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680987989"><span class="annot"><span class="annottext">venv :: TyEnv Ty0
</span><a href="#local-6989586621680987989"><span class="hs-identifier hs-var hs-var">venv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)] -&gt; TyEnv Ty0
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; [Ty0] -&gt; [(Var, Ty0)]
forall a b.
(Show a, Show b, HasCallStack) =&gt;
[a] -&gt; [b] -&gt; [(a, b)]
</span><a href="Gibbon.Common.html#fragileZip"><span class="hs-identifier hs-var">fragileZip</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680987985"><span class="hs-identifier hs-var">funArgs''</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArrowTy Ty0 -&gt; [Ty0]
forall ty. FunctionTy ty =&gt; ArrowTy ty -&gt; [ty]
</span><a href="Gibbon.Language.Syntax.html#inTys"><span class="hs-identifier hs-var">inTys</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy Ty0
TyScheme
</span><a href="#local-6989586621680987990"><span class="hs-identifier hs-var">funTy'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-968"></span><span>      </span><span id="local-6989586621680987991"><span class="annot"><span class="annottext">env2 :: Env2 Ty0
</span><a href="#local-6989586621680987991"><span class="hs-identifier hs-var hs-var">env2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyEnv Ty0 -&gt; TyEnv (ArrowTy Ty0) -&gt; Env2 Ty0
forall a. TyEnv a -&gt; TyEnv (ArrowTy a) -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#Env2"><span class="hs-identifier hs-var">Env2</span></a></span><span> </span><span class="annot"><span class="annottext">TyEnv Ty0
</span><a href="#local-6989586621680987989"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunDefs Exp0 -&gt; TyEnv (ArrowTy (TyOf Exp0))
forall a. FunDefs a -&gt; TyEnv (ArrowTy (TyOf a))
</span><a href="Gibbon.Language.Syntax.html#initFunEnv"><span class="hs-identifier hs-var">initFunEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpecState -&gt; FunDefs Exp0
</span><a href="Gibbon.L0.Specialize2.html#sp_fundefs"><span class="hs-identifier hs-var">sp_fundefs</span></a></span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680987979"><span class="hs-identifier hs-var">sp_state</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-969"></span><span>  </span><span id="local-6989586621680987993"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987993"><span class="hs-identifier hs-var">funBody'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Exp0 -&gt; SpecM Exp0
</span><a href="Gibbon.L0.Specialize2.html#specLambdasExp"><span class="hs-identifier hs-var">specLambdasExp</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680987973"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680987991"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunDef0 -&gt; Exp0
forall ex. FunDef ex -&gt; ex
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680987987"><span class="hs-identifier hs-var">fn'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-970"></span><span>  </span><span id="local-6989586621680987994"><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680987994"><span class="hs-identifier hs-var">sp_state'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT SpecState PassM SpecState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-971"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680987995"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680987995"><span class="hs-identifier hs-var">funArgs'''</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680987996"><span class="annot"><span class="annottext">TyScheme
</span><a href="#local-6989586621680987996"><span class="hs-identifier hs-var">funTy''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-972"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Map Var [(Var, Ty0)] -&gt; Maybe [(Var, Ty0)]
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987974"><span class="hs-identifier hs-var">new_fn_name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpecState -&gt; Map Var [(Var, Ty0)]
</span><a href="Gibbon.L0.Specialize2.html#sp_extra_args"><span class="hs-identifier hs-var">sp_extra_args</span></a></span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680987994"><span class="hs-identifier hs-var">sp_state'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-973"></span><span>          </span><span class="annot"><span class="annottext">Maybe [(Var, Ty0)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680987985"><span class="hs-identifier hs-var">funArgs''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyScheme
</span><a href="#local-6989586621680987990"><span class="hs-identifier hs-var">funTy'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-974"></span><span>          </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680987997"><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680987997"><span class="hs-identifier hs-var">extra_args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-975"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#ForAll"><span class="hs-identifier hs-type">ForAll</span></a></span><span> </span><span id="local-6989586621680987998"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680987998"><span class="hs-identifier hs-var">tyvars1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#ArrowTy"><span class="hs-identifier hs-type">ArrowTy</span></a></span><span> </span><span id="local-6989586621680987999"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987999"><span class="hs-identifier hs-var">arg_tys1</span></a></span></span><span> </span><span id="local-6989586621680988000"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988000"><span class="hs-identifier hs-var">ret_ty1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyScheme
</span><a href="#local-6989586621680987990"><span class="hs-identifier hs-var">funTy'</span></a></span><span>
</span><span id="line-976"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621680988001"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988001"><span class="hs-identifier hs-var">extra_vars</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680988002"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988002"><span class="hs-identifier hs-var">extra_tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)] -&gt; ([Var], [Ty0])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680987997"><span class="hs-identifier hs-var">extra_args</span></a></span><span>
</span><span id="line-977"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680987985"><span class="hs-identifier hs-var">funArgs''</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [Var]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988001"><span class="hs-identifier hs-var">extra_vars</span></a></span><span>
</span><span id="line-978"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; Ty0 -&gt; TyScheme
</span><a href="Gibbon.L0.Syntax.html#ForAll"><span class="hs-identifier hs-var">ForAll</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680987998"><span class="hs-identifier hs-var">tyvars1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ArrowTy"><span class="hs-identifier hs-var">ArrowTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680987999"><span class="hs-identifier hs-var">arg_tys1</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; [Ty0] -&gt; [Ty0]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988002"><span class="hs-identifier hs-var">extra_tys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988000"><span class="hs-identifier hs-var">ret_ty1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-979"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680988003"><span class="annot"><span class="annottext">fn'' :: FunDef0
</span><a href="#local-6989586621680988003"><span class="hs-identifier hs-var hs-var">fn''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-980"></span><span>        </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680987987"><span class="hs-identifier hs-var">fn'</span></a></span><span>
</span><span id="line-981"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funBody :: Exp0
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680987993"><span class="hs-identifier hs-var">funBody'</span></a></span><span>
</span><span id="line-982"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funArgs :: [Var]
</span><a href="Gibbon.Language.Syntax.html#funArgs"><span class="hs-identifier hs-var">funArgs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680987995"><span class="hs-identifier hs-var">funArgs'''</span></a></span><span>
</span><span id="line-983"></span><span>
</span><span id="line-984"></span><span class="hs-comment">-- N.B. Only update the type after 'specExp' runs.</span><span>
</span><span id="line-985"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funTy :: ArrowTy (TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#funTy"><span class="hs-identifier hs-var">funTy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArrowTy (TyOf Exp0)
TyScheme
</span><a href="#local-6989586621680987996"><span class="hs-identifier hs-var">funTy''</span></a></span><span>
</span><span id="line-986"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-987"></span><span>  </span><span class="annot"><span class="annottext">(SpecState -&gt; ((), SpecState)) -&gt; StateT SpecState PassM ()
forall a. (SpecState -&gt; (a, SpecState)) -&gt; StateT SpecState PassM a
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; (a, s)) -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#state"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-988"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680988004"><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680988004"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680988004"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">sp_fundefs :: FunDefs Exp0
</span><a href="Gibbon.L0.Specialize2.html#sp_fundefs"><span class="hs-identifier hs-var">sp_fundefs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; FunDef0 -&gt; FunDefs Exp0 -&gt; FunDefs Exp0
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680987974"><span class="hs-identifier hs-var">new_fn_name</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680988003"><span class="hs-identifier hs-var">fn''</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpecState -&gt; FunDefs Exp0
</span><a href="Gibbon.L0.Specialize2.html#sp_fundefs"><span class="hs-identifier hs-var">sp_fundefs</span></a></span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680988004"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-989"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-990"></span><span>    </span><span class="annot"><a href="Gibbon.L0.Syntax.html#ForAll"><span class="hs-identifier hs-type">ForAll</span></a></span><span> </span><span id="local-6989586621680988005"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680988005"><span class="hs-identifier hs-var">tyvars</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#ArrowTy"><span class="hs-identifier hs-type">ArrowTy</span></a></span><span> </span><span id="local-6989586621680988006"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988006"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span> </span><span id="local-6989586621680988007"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988007"><span class="hs-identifier hs-var">ret_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArrowTy (TyOf Exp0)
</span><a href="#local-6989586621680987978"><span class="hs-identifier hs-var">funTy</span></a></span><span>
</span><span id="line-991"></span><span>
</span><span id="line-992"></span><span class="hs-comment">-- TODO: What if the function returns another function ? Not handled yet.</span><span>
</span><span id="line-993"></span><span>    </span><span class="hs-comment">-- First order type</span><span>
</span><span id="line-994"></span><span>    </span><span id="local-6989586621680987990"><span class="annot"><span class="annottext">funTy' :: TyScheme
</span><a href="#local-6989586621680987990"><span class="hs-identifier hs-var hs-var">funTy'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; Ty0 -&gt; TyScheme
</span><a href="Gibbon.L0.Syntax.html#ForAll"><span class="hs-identifier hs-var">ForAll</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680988005"><span class="hs-identifier hs-var">tyvars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ArrowTy"><span class="hs-identifier hs-var">ArrowTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Ty0 -&gt; IsBoxed) -&gt; [Ty0] -&gt; [Ty0]
forall a. (a -&gt; IsBoxed) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IsBoxed -&gt; IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(IsBoxed -&gt; IsBoxed) -&gt; (Ty0 -&gt; IsBoxed) -&gt; Ty0 -&gt; IsBoxed
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; IsBoxed
</span><a href="Gibbon.L0.Syntax.html#isFunTy"><span class="hs-identifier hs-var">isFunTy</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988006"><span class="hs-identifier hs-var">arg_tys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988007"><span class="hs-identifier hs-var">ret_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-995"></span><span>
</span><span id="line-996"></span><span>    </span><span class="annot"><a href="#local-6989586621680987988"><span class="hs-identifier hs-type">do_spec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span>
</span><span id="line-997"></span><span>    </span><span id="local-6989586621680987988"><span class="annot"><span class="annottext">do_spec :: [(Var, Var)] -&gt; Exp0 -&gt; Exp0
</span><a href="#local-6989586621680987988"><span class="hs-identifier hs-var hs-var">do_spec</span></a></span></span><span> </span><span id="local-6989586621680988008"><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680988008"><span class="hs-identifier hs-var">lams</span></a></span></span><span> </span><span id="local-6989586621680988009"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988009"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Var, Var) -&gt; Exp0 -&gt; Exp0) -&gt; Exp0 -&gt; [(Var, Var)] -&gt; Exp0
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var -&gt; Var -&gt; Exp0 -&gt; Exp0) -&gt; (Var, Var) -&gt; Exp0 -&gt; Exp0
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#uncurry"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Exp0 -&gt; Exp0
forall {e}. Renamable e =&gt; Var -&gt; Var -&gt; e -&gt; e
</span><a href="#local-6989586621680988012"><span class="hs-identifier hs-var">subst'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988009"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680988008"><span class="hs-identifier hs-var">lams</span></a></span><span>
</span><span id="line-998"></span><span>
</span><span id="line-999"></span><span>    </span><span id="local-6989586621680988012"><span class="annot"><span class="annottext">subst' :: Var -&gt; Var -&gt; e -&gt; e
</span><a href="#local-6989586621680988012"><span class="hs-identifier hs-var hs-var">subst'</span></a></span></span><span> </span><span id="local-6989586621680988015"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988015"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span id="local-6989586621680988016"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988016"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span id="local-6989586621680988017"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680988017"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var Var -&gt; e -&gt; e
forall e. Renamable e =&gt; Map Var Var -&gt; e -&gt; e
</span><a href="Gibbon.Language.Syntax.html#gRename"><span class="hs-identifier hs-var">gRename</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Map Var Var
forall k a. k -&gt; a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#singleton"><span class="hs-identifier hs-var">M.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988015"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988016"><span class="hs-identifier hs-var">new</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621680988017"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1000"></span><span>
</span><span id="line-1001"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#specLambdasExp"><span class="hs-identifier hs-type">specLambdasExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#DDefs0"><span class="hs-identifier hs-type">DDefs0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Env2"><span class="hs-identifier hs-type">Env2</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#SpecM"><span class="hs-identifier hs-type">SpecM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span>
</span><span id="line-1002"></span><span id="specLambdasExp"><span class="annot"><span class="annottext">specLambdasExp :: Map Var DDef0 -&gt; Env2 Ty0 -&gt; Exp0 -&gt; SpecM Exp0
</span><a href="Gibbon.L0.Specialize2.html#specLambdasExp"><span class="hs-identifier hs-var hs-var">specLambdasExp</span></a></span></span><span> </span><span id="local-6989586621680988263"><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680988263"><span class="hs-identifier hs-var">ddefs</span></a></span></span><span> </span><span id="local-6989586621680988264"><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680988264"><span class="hs-identifier hs-var">env2</span></a></span></span><span> </span><span id="local-6989586621680988265"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988265"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1003"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988265"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1004"></span><span>    </span><span class="hs-comment">-- TODO, docs.</span><span>
</span><span id="line-1005"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span id="local-6989586621680988266"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988266"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621680988267"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988267"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1006"></span><span>      </span><span id="local-6989586621680988268"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988268"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; SpecM Exp0) -&gt; [Exp0] -&gt; StateT SpecState PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
</span><a href="#local-6989586621680988269"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988267"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1007"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680988270"><span class="annot"><span class="annottext">args'' :: [Exp0]
</span><a href="#local-6989586621680988270"><span class="hs-identifier hs-var hs-var">args''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Env2 Ty0 -&gt; [Exp0] -&gt; [Exp0]
</span><a href="#local-6989586621680988271"><span class="hs-identifier hs-var">dropFunRefs</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988266"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680988264"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988268"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-1008"></span><span>          </span><span id="local-6989586621680988272"><span class="annot"><span class="annottext">refs :: [Var]
</span><a href="#local-6989586621680988272"><span class="hs-identifier hs-var hs-var">refs</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; [Var] -&gt; [Var]) -&gt; [Var] -&gt; [Exp0] -&gt; [Var]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988273"><span class="hs-identifier hs-var">collectFunRefs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988268"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-1009"></span><span>      </span><span id="local-6989586621680988274"><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680988274"><span class="hs-identifier hs-var">sp_state</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT SpecState PassM SpecState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-1010"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988272"><span class="hs-identifier hs-var">refs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1011"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1012"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Map Var [(Var, Ty0)] -&gt; Maybe [(Var, Ty0)]
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988266"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpecState -&gt; Map Var [(Var, Ty0)]
</span><a href="Gibbon.L0.Specialize2.html#sp_extra_args"><span class="hs-identifier hs-var">sp_extra_args</span></a></span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680988274"><span class="hs-identifier hs-var">sp_state</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1013"></span><span>              </span><span class="annot"><span class="annottext">Maybe [(Var, Ty0)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
forall a. a -&gt; StateT SpecState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; SpecM Exp0) -&gt; Exp0 -&gt; SpecM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988266"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988270"><span class="hs-identifier hs-var">args''</span></a></span><span>
</span><span id="line-1014"></span><span>              </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680988275"><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988275"><span class="hs-identifier hs-var">extra_args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1015"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680988276"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988276"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)] -&gt; ([Var], [Ty0])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988275"><span class="hs-identifier hs-var">extra_args</span></a></span><span>
</span><span id="line-1016"></span><span>                      </span><span id="local-6989586621680988277"><span class="annot"><span class="annottext">args''' :: [Exp0]
</span><a href="#local-6989586621680988277"><span class="hs-identifier hs-var hs-var">args'''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988270"><span class="hs-identifier hs-var">args''</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0] -&gt; [Exp0] -&gt; [Exp0]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">(Var -&gt; Exp0) -&gt; [Var] -&gt; [Exp0]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988276"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-1017"></span><span>                  </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
forall a. a -&gt; StateT SpecState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; SpecM Exp0) -&gt; Exp0 -&gt; SpecM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988266"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988277"><span class="hs-identifier hs-var">args'''</span></a></span><span>
</span><span id="line-1018"></span><span>        </span><span class="annot"><span class="annottext">[Var]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1019"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680988278"><span class="annot"><span class="annottext">extra_args :: [(Var, Ty0)]
</span><a href="#local-6989586621680988278"><span class="hs-identifier hs-var hs-var">extra_args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; [(Var, Ty0)] -&gt; [(Var, Ty0)])
-&gt; [(Var, Ty0)] -&gt; [Var] -&gt; [(Var, Ty0)]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680988279"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988279"><span class="hs-identifier hs-var">fnref</span></a></span></span><span> </span><span id="local-6989586621680988280"><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988280"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1020"></span><span>                                          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Map Var [(Var, Ty0)] -&gt; Maybe [(Var, Ty0)]
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988279"><span class="hs-identifier hs-var">fnref</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpecState -&gt; Map Var [(Var, Ty0)]
</span><a href="Gibbon.L0.Specialize2.html#sp_extra_args"><span class="hs-identifier hs-var">sp_extra_args</span></a></span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680988274"><span class="hs-identifier hs-var">sp_state</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1021"></span><span>                                              </span><span class="annot"><span class="annottext">Maybe [(Var, Ty0)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988280"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1022"></span><span>                                              </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680988281"><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988281"><span class="hs-identifier hs-var">extra</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988281"><span class="hs-identifier hs-var">extra</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)] -&gt; [(Var, Ty0)] -&gt; [(Var, Ty0)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988280"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1023"></span><span>                                     </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988272"><span class="hs-identifier hs-var">refs</span></a></span><span>
</span><span id="line-1024"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680988282"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988282"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)] -&gt; ([Var], [Ty0])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988278"><span class="hs-identifier hs-var">extra_args</span></a></span><span>
</span><span id="line-1025"></span><span>              </span><span id="local-6989586621680988283"><span class="annot"><span class="annottext">args''' :: [Exp0]
</span><a href="#local-6989586621680988283"><span class="hs-identifier hs-var hs-var">args'''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988270"><span class="hs-identifier hs-var">args''</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0] -&gt; [Exp0] -&gt; [Exp0]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var -&gt; Exp0) -&gt; [Var] -&gt; [Exp0]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988282"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1026"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var]) -&gt; Map (Var, [Var]) Var -&gt; Maybe Var
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988266"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988272"><span class="hs-identifier hs-var">refs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpecState -&gt; Map (Var, [Var]) Var
</span><a href="Gibbon.L0.Specialize2.html#sp_funs_done"><span class="hs-identifier hs-var">sp_funs_done</span></a></span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680988274"><span class="hs-identifier hs-var">sp_state</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Var, [Var]) -&gt; Map (Var, [Var]) Var -&gt; Maybe Var
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988266"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988272"><span class="hs-identifier hs-var">refs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpecState -&gt; Map (Var, [Var]) Var
</span><a href="Gibbon.L0.Specialize2.html#sp_funs_worklist"><span class="hs-identifier hs-var">sp_funs_worklist</span></a></span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680988274"><span class="hs-identifier hs-var">sp_state</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1027"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Var
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Var
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1028"></span><span>              </span><span id="local-6989586621680988284"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988284"><span class="hs-identifier hs-var">f'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PassM Var -&gt; StateT SpecState PassM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT SpecState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Var -&gt; StateT SpecState PassM Var)
-&gt; PassM Var -&gt; StateT SpecState PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988266"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1029"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#ForAll"><span class="hs-identifier hs-type">ForAll</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#ArrowTy"><span class="hs-identifier hs-type">ArrowTy</span></a></span><span> </span><span id="local-6989586621680988285"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988285"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Env2 Ty0 -&gt; ArrowTy Ty0
forall a. Out (ArrowTy a) =&gt; Var -&gt; Env2 a -&gt; ArrowTy a
</span><a href="Gibbon.Language.Syntax.html#lookupFEnv"><span class="hs-identifier hs-var">lookupFEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988266"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680988264"><span class="hs-identifier hs-var">env2</span></a></span><span>
</span><span id="line-1030"></span><span>                  </span><span id="local-6989586621680988287"><span class="annot"><span class="annottext">arrow_tys :: [Ty0]
</span><a href="#local-6989586621680988287"><span class="hs-identifier hs-var hs-var">arrow_tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; [Ty0]) -&gt; [Ty0] -&gt; [Ty0]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; [Ty0]
</span><a href="Gibbon.L0.Syntax.html#arrowTysInTy"><span class="hs-identifier hs-var">arrowTysInTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988285"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-1031"></span><span>
</span><span id="line-1032"></span><span class="hs-comment">-- Check that the # of refs we collected actually matches the #</span><span>
</span><span id="line-1033"></span><span>              </span><span class="hs-comment">-- of functions 'f' expects.</span><span>
</span><span id="line-1034"></span><span>              </span><span class="annot"><span class="annottext">[Char] -&gt; [Var] -&gt; [Ty0] -&gt; StateT SpecState PassM ()
forall a b (m :: * -&gt; *).
(Out a, Out b, Monad m, HasCallStack) =&gt;
[Char] -&gt; [a] -&gt; [b] -&gt; m ()
</span><a href="Gibbon.L0.Specialize2.html#assertSameLength"><span class="hs-identifier hs-var">assertSameLength</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;While lowering the expression &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988265"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988272"><span class="hs-identifier hs-var">refs</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988287"><span class="hs-identifier hs-var">arrow_tys</span></a></span><span>
</span><span id="line-1035"></span><span>              </span><span class="hs-comment">-- We have a new lowering obligation.</span><span>
</span><span id="line-1036"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680988289"><span class="annot"><span class="annottext">sp_extra_args' :: Map Var [(Var, Ty0)]
</span><a href="#local-6989586621680988289"><span class="hs-identifier hs-var hs-var">sp_extra_args'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988278"><span class="hs-identifier hs-var">extra_args</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1037"></span><span>                                     </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SpecState -&gt; Map Var [(Var, Ty0)]
</span><a href="Gibbon.L0.Specialize2.html#sp_extra_args"><span class="hs-identifier hs-var">sp_extra_args</span></a></span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680988274"><span class="hs-identifier hs-var">sp_state</span></a></span><span>
</span><span id="line-1038"></span><span>                                     </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [(Var, Ty0)] -&gt; Map Var [(Var, Ty0)] -&gt; Map Var [(Var, Ty0)]
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988284"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988278"><span class="hs-identifier hs-var">extra_args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpecState -&gt; Map Var [(Var, Ty0)]
</span><a href="Gibbon.L0.Specialize2.html#sp_extra_args"><span class="hs-identifier hs-var">sp_extra_args</span></a></span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680988274"><span class="hs-identifier hs-var">sp_state</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1039"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680988290"><span class="annot"><span class="annottext">sp_state' :: SpecState
</span><a href="#local-6989586621680988290"><span class="hs-identifier hs-var hs-var">sp_state'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680988274"><span class="hs-identifier hs-var">sp_state</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sp_funs_worklist :: Map (Var, [Var]) Var
</span><a href="Gibbon.L0.Specialize2.html#sp_funs_worklist"><span class="hs-identifier hs-var">sp_funs_worklist</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var, [Var]) -&gt; Var -&gt; Map (Var, [Var]) Var -&gt; Map (Var, [Var]) Var
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988266"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988272"><span class="hs-identifier hs-var">refs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988284"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpecState -&gt; Map (Var, [Var]) Var
</span><a href="Gibbon.L0.Specialize2.html#sp_funs_worklist"><span class="hs-identifier hs-var">sp_funs_worklist</span></a></span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680988274"><span class="hs-identifier hs-var">sp_state</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1040"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sp_extra_args :: Map Var [(Var, Ty0)]
</span><a href="Gibbon.L0.Specialize2.html#sp_extra_args"><span class="hs-identifier hs-var">sp_extra_args</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Ty0)]
</span><a href="#local-6989586621680988289"><span class="hs-identifier hs-var">sp_extra_args'</span></a></span><span>
</span><span id="line-1041"></span><span>                                       </span><span class="hs-special">}</span><span>
</span><span id="line-1042"></span><span>              </span><span class="annot"><span class="annottext">SpecState -&gt; StateT SpecState PassM ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680988290"><span class="hs-identifier hs-var">sp_state'</span></a></span><span>
</span><span id="line-1043"></span><span>              </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
forall a. a -&gt; StateT SpecState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; SpecM Exp0) -&gt; Exp0 -&gt; SpecM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988284"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988283"><span class="hs-identifier hs-var">args'''</span></a></span><span>
</span><span id="line-1044"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680988291"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988291"><span class="hs-identifier hs-var">f'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
forall a. a -&gt; StateT SpecState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; SpecM Exp0) -&gt; Exp0 -&gt; SpecM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988291"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988283"><span class="hs-identifier hs-var">args'''</span></a></span><span>
</span><span id="line-1045"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680988292"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988292"><span class="hs-identifier hs-var">f'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
forall a. a -&gt; StateT SpecState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; SpecM Exp0) -&gt; Exp0 -&gt; SpecM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988292"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988283"><span class="hs-identifier hs-var">args'''</span></a></span><span>
</span><span id="line-1046"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SpecM Exp0
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; SpecM Exp0) -&gt; [Char] -&gt; SpecM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;specLambdasExp: Call-site not monomorphized: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988265"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1047"></span><span>
</span><span id="line-1048"></span><span>    </span><span class="hs-comment">-- Float out a lambda fun to the top-level.</span><span>
</span><span id="line-1049"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680988293"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988293"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621680988294"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988294"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#LambdaE"><span class="hs-identifier hs-type">LambdaE</span></a></span><span> </span><span id="local-6989586621680988295"><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988295"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621680988296"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988296"><span class="hs-identifier hs-var">lam_bod</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621680988297"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988297"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1050"></span><span>      </span><span id="local-6989586621680988298"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988298"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PassM Var -&gt; StateT SpecState PassM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT SpecState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Var -&gt; StateT SpecState PassM Var)
-&gt; PassM Var -&gt; StateT SpecState PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988293"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1051"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680988299"><span class="annot"><span class="annottext">bod' :: Exp0
</span><a href="#local-6989586621680988299"><span class="hs-identifier hs-var hs-var">bod'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var Var -&gt; Exp0 -&gt; Exp0
forall e. Renamable e =&gt; Map Var Var -&gt; e -&gt; e
</span><a href="Gibbon.Language.Syntax.html#gRename"><span class="hs-identifier hs-var">gRename</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Map Var Var
forall k a. k -&gt; a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#singleton"><span class="hs-identifier hs-var">M.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988293"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988298"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988297"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-1052"></span><span>      </span><span id="local-6989586621680988300"><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680988300"><span class="hs-identifier hs-var">sp_state</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT SpecState PassM SpecState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-1053"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680988301"><span class="annot"><span class="annottext">arg_vars :: [Var]
</span><a href="#local-6989586621680988301"><span class="hs-identifier hs-var hs-var">arg_vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Var, Ty0) -&gt; Var) -&gt; [(Var, Ty0)] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty0) -&gt; Var
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988295"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1054"></span><span>          </span><span id="local-6989586621680988302"><span class="annot"><span class="annottext">captured_vars :: Set Var
</span><a href="#local-6989586621680988302"><span class="hs-identifier hs-var hs-var">captured_vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Set Var
forall a. FreeVars a =&gt; a -&gt; Set Var
</span><a href="Gibbon.Language.Syntax.html#gFreeVars"><span class="hs-identifier hs-var">gFreeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988296"><span class="hs-identifier hs-var">lam_bod</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; Set Var -&gt; Set Var
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#difference"><span class="hs-operator hs-var">`S.difference`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; Set Var
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">S.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988301"><span class="hs-identifier hs-var">arg_vars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1055"></span><span>                          </span><span class="annot"><span class="annottext">Set Var -&gt; Set Var -&gt; Set Var
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#difference"><span class="hs-operator hs-var">`S.difference`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunDefs Exp0 -&gt; Set Var
forall k a. Map k a -&gt; Set k
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#keysSet"><span class="hs-identifier hs-var">M.keysSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpecState -&gt; FunDefs Exp0
</span><a href="Gibbon.L0.Specialize2.html#sp_fundefs"><span class="hs-identifier hs-var">sp_fundefs</span></a></span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680988300"><span class="hs-identifier hs-var">sp_state</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1056"></span><span>      </span><span id="local-6989586621680988306"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988306"><span class="hs-identifier hs-var">lam_bod'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Exp0 -&gt; SpecM Exp0
</span><a href="Gibbon.L0.Specialize2.html#specLambdasExp"><span class="hs-identifier hs-var">specLambdasExp</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680988263"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TyEnv Ty0 -&gt; Env2 Ty0 -&gt; Env2 Ty0
forall a. Map Var a -&gt; Env2 a -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#extendsVEnv"><span class="hs-identifier hs-var">L1.extendsVEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, Ty0)] -&gt; TyEnv Ty0
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988295"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680988264"><span class="hs-identifier hs-var">env2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988296"><span class="hs-identifier hs-var">lam_bod</span></a></span><span>
</span><span id="line-1057"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">IsBoxed -&gt; IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Var -&gt; IsBoxed
forall a. Set a -&gt; IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#null"><span class="hs-identifier hs-var">S.null</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680988302"><span class="hs-identifier hs-var">captured_vars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1058"></span><span>      </span><span class="hs-comment">-- Pass captured values as extra arguments</span><span>
</span><span id="line-1059"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1060"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680988308"><span class="annot"><span class="annottext">ls :: [Var]
</span><a href="#local-6989586621680988308"><span class="hs-identifier hs-var hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; [Var]
forall a. Set a -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#toList"><span class="hs-identifier hs-var">S.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680988302"><span class="hs-identifier hs-var">captured_vars</span></a></span><span>
</span><span id="line-1061"></span><span>            </span><span id="local-6989586621680988310"><span class="annot"><span class="annottext">tys :: [Ty0]
</span><a href="#local-6989586621680988310"><span class="hs-identifier hs-var hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; Ty0) -&gt; [Var] -&gt; [Ty0]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680988311"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988311"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TyEnv Ty0 -&gt; Maybe Ty0
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988311"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Env2 Ty0 -&gt; TyEnv Ty0
forall a. Env2 a -&gt; TyEnv a
</span><a href="Gibbon.Language.Syntax.html#vEnv"><span class="hs-identifier hs-var">vEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680988264"><span class="hs-identifier hs-var">env2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1062"></span><span>                               </span><span class="annot"><span class="annottext">Maybe Ty0
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Ty0
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Ty0) -&gt; [Char] -&gt; Ty0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Unbound variable: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Char]
forall e. Pretty e =&gt; e -&gt; [Char]
</span><a href="Gibbon.Pretty.html#pprender"><span class="hs-identifier hs-var">pprender</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988311"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-1063"></span><span>                               </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680988314"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988314"><span class="hs-identifier hs-var">ty1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988314"><span class="hs-identifier hs-var">ty1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1064"></span><span>                      </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988308"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1065"></span><span>            </span><span id="local-6989586621680988315"><span class="annot"><span class="annottext">fns :: [Var]
</span><a href="#local-6989586621680988315"><span class="hs-identifier hs-var hs-var">fns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988316"><span class="hs-identifier hs-var">collectAllFuns</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988296"><span class="hs-identifier hs-var">lam_bod</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1066"></span><span>            </span><span id="local-6989586621680988317"><span class="annot"><span class="annottext">extra_args :: [(Var, Ty0)]
</span><a href="#local-6989586621680988317"><span class="hs-identifier hs-var hs-var">extra_args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; [(Var, Ty0)] -&gt; [(Var, Ty0)])
-&gt; [(Var, Ty0)] -&gt; [Var] -&gt; [(Var, Ty0)]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680988318"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988318"><span class="hs-identifier hs-var">fnref</span></a></span></span><span> </span><span id="local-6989586621680988319"><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988319"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1067"></span><span>                                          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Map Var [(Var, Ty0)] -&gt; Maybe [(Var, Ty0)]
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988318"><span class="hs-identifier hs-var">fnref</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpecState -&gt; Map Var [(Var, Ty0)]
</span><a href="Gibbon.L0.Specialize2.html#sp_extra_args"><span class="hs-identifier hs-var">sp_extra_args</span></a></span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680988300"><span class="hs-identifier hs-var">sp_state</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1068"></span><span>                                              </span><span class="annot"><span class="annottext">Maybe [(Var, Ty0)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988319"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1069"></span><span>                                              </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680988320"><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988320"><span class="hs-identifier hs-var">extra</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988320"><span class="hs-identifier hs-var">extra</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)] -&gt; [(Var, Ty0)] -&gt; [(Var, Ty0)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988319"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1070"></span><span>                                     </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988315"><span class="hs-identifier hs-var">fns</span></a></span><span>
</span><span id="line-1071"></span><span>            </span><span id="local-6989586621680988321"><span class="annot"><span class="annottext">extra_args1 :: [(Var, Ty0)]
</span><a href="#local-6989586621680988321"><span class="hs-identifier hs-var hs-var">extra_args1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; [Ty0] -&gt; [(Var, Ty0)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988308"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988310"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)] -&gt; [(Var, Ty0)] -&gt; [(Var, Ty0)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988317"><span class="hs-identifier hs-var">extra_args</span></a></span><span>
</span><span id="line-1072"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621680988322"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988322"><span class="hs-identifier hs-var">vars1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988323"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988323"><span class="hs-identifier hs-var">tys1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)] -&gt; ([Var], [Ty0])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988321"><span class="hs-identifier hs-var">extra_args1</span></a></span><span>
</span><span id="line-1073"></span><span>            </span><span id="local-6989586621680988324"><span class="annot"><span class="annottext">ty' :: TyScheme
</span><a href="#local-6989586621680988324"><span class="hs-identifier hs-var hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; TyScheme -&gt; TyScheme
</span><a href="Gibbon.L0.Specialize2.html#addArgsToTy"><span class="hs-identifier hs-var">addArgsToTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988323"><span class="hs-identifier hs-var">tys1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar] -&gt; Ty0 -&gt; TyScheme
</span><a href="Gibbon.L0.Syntax.html#ForAll"><span class="hs-identifier hs-var">ForAll</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988294"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1074"></span><span>            </span><span id="local-6989586621680988326"><span class="annot"><span class="annottext">fn :: FunDef0
</span><a href="#local-6989586621680988326"><span class="hs-identifier hs-var hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funName :: Var
</span><a href="Gibbon.Language.Syntax.html#funName"><span class="hs-identifier hs-var">funName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988298"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-1075"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funArgs :: [Var]
</span><a href="Gibbon.Language.Syntax.html#funArgs"><span class="hs-identifier hs-var">funArgs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988301"><span class="hs-identifier hs-var">arg_vars</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [Var]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988322"><span class="hs-identifier hs-var">vars1</span></a></span><span>
</span><span id="line-1076"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funTy :: ArrowTy (TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#funTy"><span class="hs-identifier hs-var">funTy</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArrowTy (TyOf Exp0)
TyScheme
</span><a href="#local-6989586621680988324"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-1077"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funBody :: Exp0
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988306"><span class="hs-identifier hs-var">lam_bod'</span></a></span><span>
</span><span id="line-1078"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funMeta :: FunMeta
</span><a href="Gibbon.Language.Syntax.html#funMeta"><span class="hs-identifier hs-var">funMeta</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunMeta"><span class="hs-identifier hs-type">FunMeta</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funRec :: FunRec
</span><a href="Gibbon.Language.Syntax.html#funRec"><span class="hs-identifier hs-var">funRec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunRec
</span><a href="Gibbon.Language.Syntax.html#NotRec"><span class="hs-identifier hs-var">NotRec</span></a></span><span>
</span><span id="line-1079"></span><span>                                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funInline :: FunInline
</span><a href="Gibbon.Language.Syntax.html#funInline"><span class="hs-identifier hs-var">funInline</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunInline
</span><a href="Gibbon.Language.Syntax.html#Inline"><span class="hs-identifier hs-var">Inline</span></a></span><span>
</span><span id="line-1080"></span><span>                                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funCanTriggerGC :: IsBoxed
</span><a href="Gibbon.Language.Syntax.html#funCanTriggerGC"><span class="hs-identifier hs-var">funCanTriggerGC</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-1081"></span><span>                                            </span><span class="hs-special">}</span><span>
</span><span id="line-1082"></span><span>                        </span><span class="hs-special">}</span><span>
</span><span id="line-1083"></span><span>            </span><span id="local-6989586621680988334"><span class="annot"><span class="annottext">env2' :: Env2 Ty0
</span><a href="#local-6989586621680988334"><span class="hs-identifier hs-var hs-var">env2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; ArrowTy Ty0 -&gt; Env2 Ty0 -&gt; Env2 Ty0
forall a. Var -&gt; ArrowTy a -&gt; Env2 a -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#extendFEnv"><span class="hs-identifier hs-var">extendFEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988298"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy Ty0
TyScheme
</span><a href="#local-6989586621680988324"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680988264"><span class="hs-identifier hs-var">env2</span></a></span><span>
</span><span id="line-1084"></span><span>        </span><span class="annot"><span class="annottext">(SpecState -&gt; ((), SpecState)) -&gt; StateT SpecState PassM ()
forall a. (SpecState -&gt; (a, SpecState)) -&gt; StateT SpecState PassM a
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; (a, s)) -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#state"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680988336"><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680988336"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680988336"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sp_fundefs :: FunDefs Exp0
</span><a href="Gibbon.L0.Specialize2.html#sp_fundefs"><span class="hs-identifier hs-var">sp_fundefs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; FunDef0 -&gt; FunDefs Exp0 -&gt; FunDefs Exp0
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988298"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680988326"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpecState -&gt; FunDefs Exp0
</span><a href="Gibbon.L0.Specialize2.html#sp_fundefs"><span class="hs-identifier hs-var">sp_fundefs</span></a></span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680988336"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1085"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sp_extra_args :: Map Var [(Var, Ty0)]
</span><a href="Gibbon.L0.Specialize2.html#sp_extra_args"><span class="hs-identifier hs-var">sp_extra_args</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [(Var, Ty0)] -&gt; Map Var [(Var, Ty0)] -&gt; Map Var [(Var, Ty0)]
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988298"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988321"><span class="hs-identifier hs-var">extra_args1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpecState -&gt; Map Var [(Var, Ty0)]
</span><a href="Gibbon.L0.Specialize2.html#sp_extra_args"><span class="hs-identifier hs-var">sp_extra_args</span></a></span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680988336"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1086"></span><span>        </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Exp0 -&gt; SpecM Exp0
</span><a href="Gibbon.L0.Specialize2.html#specLambdasExp"><span class="hs-identifier hs-var">specLambdasExp</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680988263"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680988334"><span class="hs-identifier hs-var">env2'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988299"><span class="hs-identifier hs-var">bod'</span></a></span><span>
</span><span id="line-1087"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1088"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680988337"><span class="annot"><span class="annottext">fns :: [Var]
</span><a href="#local-6989586621680988337"><span class="hs-identifier hs-var hs-var">fns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988316"><span class="hs-identifier hs-var">collectAllFuns</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988296"><span class="hs-identifier hs-var">lam_bod</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1089"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680988338"><span class="annot"><span class="annottext">extra_args :: [(Var, Ty0)]
</span><a href="#local-6989586621680988338"><span class="hs-identifier hs-var hs-var">extra_args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; [(Var, Ty0)] -&gt; [(Var, Ty0)])
-&gt; [(Var, Ty0)] -&gt; [Var] -&gt; [(Var, Ty0)]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680988339"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988339"><span class="hs-identifier hs-var">fnref</span></a></span></span><span> </span><span id="local-6989586621680988340"><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988340"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1090"></span><span>                                          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Map Var [(Var, Ty0)] -&gt; Maybe [(Var, Ty0)]
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988339"><span class="hs-identifier hs-var">fnref</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpecState -&gt; Map Var [(Var, Ty0)]
</span><a href="Gibbon.L0.Specialize2.html#sp_extra_args"><span class="hs-identifier hs-var">sp_extra_args</span></a></span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680988300"><span class="hs-identifier hs-var">sp_state</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1091"></span><span>                                              </span><span class="annot"><span class="annottext">Maybe [(Var, Ty0)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988340"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1092"></span><span>                                              </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680988341"><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988341"><span class="hs-identifier hs-var">extra</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988341"><span class="hs-identifier hs-var">extra</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)] -&gt; [(Var, Ty0)] -&gt; [(Var, Ty0)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988340"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1093"></span><span>                                     </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988337"><span class="hs-identifier hs-var">fns</span></a></span><span>
</span><span id="line-1094"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680988342"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988342"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988343"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988343"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)] -&gt; ([Var], [Ty0])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988338"><span class="hs-identifier hs-var">extra_args</span></a></span><span>
</span><span id="line-1095"></span><span>            </span><span id="local-6989586621680988344"><span class="annot"><span class="annottext">ty' :: TyScheme
</span><a href="#local-6989586621680988344"><span class="hs-identifier hs-var hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; TyScheme -&gt; TyScheme
</span><a href="Gibbon.L0.Specialize2.html#addArgsToTy"><span class="hs-identifier hs-var">addArgsToTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988343"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar] -&gt; Ty0 -&gt; TyScheme
</span><a href="Gibbon.L0.Syntax.html#ForAll"><span class="hs-identifier hs-var">ForAll</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988294"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1096"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680988345"><span class="annot"><span class="annottext">fn :: FunDef0
</span><a href="#local-6989586621680988345"><span class="hs-identifier hs-var hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funName :: Var
</span><a href="Gibbon.Language.Syntax.html#funName"><span class="hs-identifier hs-var">funName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988298"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-1097"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funArgs :: [Var]
</span><a href="Gibbon.Language.Syntax.html#funArgs"><span class="hs-identifier hs-var">funArgs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988301"><span class="hs-identifier hs-var">arg_vars</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [Var]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988342"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-1098"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funTy :: ArrowTy (TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#funTy"><span class="hs-identifier hs-var">funTy</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArrowTy (TyOf Exp0)
TyScheme
</span><a href="#local-6989586621680988344"><span class="hs-identifier hs-var">ty'</span></a></span><span>
</span><span id="line-1099"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funBody :: Exp0
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988306"><span class="hs-identifier hs-var">lam_bod'</span></a></span><span>
</span><span id="line-1100"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funMeta :: FunMeta
</span><a href="Gibbon.Language.Syntax.html#funMeta"><span class="hs-identifier hs-var">funMeta</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunMeta"><span class="hs-identifier hs-type">FunMeta</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funRec :: FunRec
</span><a href="Gibbon.Language.Syntax.html#funRec"><span class="hs-identifier hs-var">funRec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunRec
</span><a href="Gibbon.Language.Syntax.html#NotRec"><span class="hs-identifier hs-var">NotRec</span></a></span><span>
</span><span id="line-1101"></span><span>                                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funInline :: FunInline
</span><a href="Gibbon.Language.Syntax.html#funInline"><span class="hs-identifier hs-var">funInline</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunInline
</span><a href="Gibbon.Language.Syntax.html#Inline"><span class="hs-identifier hs-var">Inline</span></a></span><span>
</span><span id="line-1102"></span><span>                                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funCanTriggerGC :: IsBoxed
</span><a href="Gibbon.Language.Syntax.html#funCanTriggerGC"><span class="hs-identifier hs-var">funCanTriggerGC</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-1103"></span><span>                                            </span><span class="hs-special">}</span><span>
</span><span id="line-1104"></span><span>                        </span><span class="hs-special">}</span><span>
</span><span id="line-1105"></span><span>            </span><span id="local-6989586621680988346"><span class="annot"><span class="annottext">env2' :: Env2 Ty0
</span><a href="#local-6989586621680988346"><span class="hs-identifier hs-var hs-var">env2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; ArrowTy Ty0 -&gt; Env2 Ty0 -&gt; Env2 Ty0
forall a. Var -&gt; ArrowTy a -&gt; Env2 a -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#extendFEnv"><span class="hs-identifier hs-var">extendFEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988298"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar] -&gt; Ty0 -&gt; TyScheme
</span><a href="Gibbon.L0.Syntax.html#ForAll"><span class="hs-identifier hs-var">ForAll</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988294"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680988264"><span class="hs-identifier hs-var">env2</span></a></span><span>
</span><span id="line-1106"></span><span>        </span><span class="annot"><span class="annottext">(SpecState -&gt; ((), SpecState)) -&gt; StateT SpecState PassM ()
forall a. (SpecState -&gt; (a, SpecState)) -&gt; StateT SpecState PassM a
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; (a, s)) -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#state"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680988347"><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680988347"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680988347"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sp_fundefs :: FunDefs Exp0
</span><a href="Gibbon.L0.Specialize2.html#sp_fundefs"><span class="hs-identifier hs-var">sp_fundefs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; FunDef0 -&gt; FunDefs Exp0 -&gt; FunDefs Exp0
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988298"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680988345"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpecState -&gt; FunDefs Exp0
</span><a href="Gibbon.L0.Specialize2.html#sp_fundefs"><span class="hs-identifier hs-var">sp_fundefs</span></a></span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680988347"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1107"></span><span>                              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sp_extra_args :: Map Var [(Var, Ty0)]
</span><a href="Gibbon.L0.Specialize2.html#sp_extra_args"><span class="hs-identifier hs-var">sp_extra_args</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [(Var, Ty0)] -&gt; Map Var [(Var, Ty0)] -&gt; Map Var [(Var, Ty0)]
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988298"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988338"><span class="hs-identifier hs-var">extra_args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpecState -&gt; Map Var [(Var, Ty0)]
</span><a href="Gibbon.L0.Specialize2.html#sp_extra_args"><span class="hs-identifier hs-var">sp_extra_args</span></a></span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680988347"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1108"></span><span>        </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Exp0 -&gt; SpecM Exp0
</span><a href="Gibbon.L0.Specialize2.html#specLambdasExp"><span class="hs-identifier hs-var">specLambdasExp</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680988263"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680988346"><span class="hs-identifier hs-var">env2'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988299"><span class="hs-identifier hs-var">bod'</span></a></span><span>
</span><span id="line-1109"></span><span>
</span><span id="line-1110"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680988348"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988348"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621680988349"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988349"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680988350"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988350"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680988351"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988351"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1111"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680988352"><span class="annot"><span class="annottext">_fn_refs :: [Var]
</span><a href="#local-6989586621680988352"><span class="hs-identifier hs-var hs-var">_fn_refs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988273"><span class="hs-identifier hs-var">collectFunRefs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988350"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1112"></span><span>          </span><span id="local-6989586621680988353"><span class="annot"><span class="annottext">env2' :: Env2 Ty0
</span><a href="#local-6989586621680988353"><span class="hs-identifier hs-var hs-var">env2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty0 -&gt; Env2 Ty0 -&gt; Env2 Ty0
forall a. Var -&gt; a -&gt; Env2 a -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988348"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988349"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680988264"><span class="hs-identifier hs-var">env2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1113"></span><span>      </span><span id="local-6989586621680988354"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988354"><span class="hs-identifier hs-var">rhs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
</span><a href="#local-6989586621680988269"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988350"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1114"></span><span>      </span><span id="local-6989586621680988355"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988355"><span class="hs-identifier hs-var">bod'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Exp0 -&gt; SpecM Exp0
</span><a href="Gibbon.L0.Specialize2.html#specLambdasExp"><span class="hs-identifier hs-var">specLambdasExp</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680988263"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680988353"><span class="hs-identifier hs-var">env2'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988351"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-1115"></span><span>      </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
forall a. a -&gt; StateT SpecState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; SpecM Exp0) -&gt; Exp0 -&gt; SpecM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0) -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988348"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988349"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988354"><span class="hs-identifier hs-var">rhs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988355"><span class="hs-identifier hs-var">bod'</span></a></span><span>
</span><span id="line-1116"></span><span>
</span><span id="line-1117"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp0
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SpecM Exp0
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; SpecM Exp0) -&gt; [Char] -&gt; SpecM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;specExp: Binding not monomorphized: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988265"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1118"></span><span>
</span><span id="line-1119"></span><span>    </span><span class="hs-comment">-- Straightforward recursion</span><span>
</span><span id="line-1120"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
forall a. a -&gt; StateT SpecState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988265"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1121"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-type">LitE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
forall a. a -&gt; StateT SpecState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988265"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1122"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CharE"><span class="hs-identifier hs-type">CharE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
forall a. a -&gt; StateT SpecState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988265"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1123"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-type">FloatE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
forall a. a -&gt; StateT SpecState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988265"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1124"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-type">LitSymE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
forall a. a -&gt; StateT SpecState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988265"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1125"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span id="local-6989586621680988356"><span class="annot"><span class="annottext">Prim Ty0
</span><a href="#local-6989586621680988356"><span class="hs-identifier hs-var">pr</span></a></span></span><span> </span><span id="local-6989586621680988357"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988357"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1126"></span><span>      </span><span id="local-6989586621680988358"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988358"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; SpecM Exp0) -&gt; [Exp0] -&gt; StateT SpecState PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
</span><a href="#local-6989586621680988269"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988357"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1127"></span><span>      </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
forall a. a -&gt; StateT SpecState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; SpecM Exp0) -&gt; Exp0 -&gt; SpecM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0 -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0
</span><a href="#local-6989586621680988356"><span class="hs-identifier hs-var">pr</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988358"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-1128"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-type">IfE</span></a></span><span> </span><span id="local-6989586621680988359"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988359"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680988360"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988360"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680988361"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988361"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0 -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-var">IfE</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0 -&gt; Exp0 -&gt; Exp0)
-&gt; SpecM Exp0 -&gt; StateT SpecState PassM (Exp0 -&gt; Exp0 -&gt; Exp0)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
</span><a href="#local-6989586621680988269"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988359"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">StateT SpecState PassM (Exp0 -&gt; Exp0 -&gt; Exp0)
-&gt; SpecM Exp0 -&gt; StateT SpecState PassM (Exp0 -&gt; Exp0)
forall a b.
StateT SpecState PassM (a -&gt; b)
-&gt; StateT SpecState PassM a -&gt; StateT SpecState PassM b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
</span><a href="#local-6989586621680988269"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988360"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">StateT SpecState PassM (Exp0 -&gt; Exp0) -&gt; SpecM Exp0 -&gt; SpecM Exp0
forall a b.
StateT SpecState PassM (a -&gt; b)
-&gt; StateT SpecState PassM a -&gt; StateT SpecState PassM b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
</span><a href="#local-6989586621680988269"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988361"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-1129"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-type">MkProdE</span></a></span><span> </span><span id="local-6989586621680988362"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988362"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
[PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-var">MkProdE</span></a></span><span> </span><span class="annot"><span class="annottext">([Exp0] -&gt; Exp0) -&gt; StateT SpecState PassM [Exp0] -&gt; SpecM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; SpecM Exp0) -&gt; [Exp0] -&gt; StateT SpecState PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
</span><a href="#local-6989586621680988269"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988362"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1130"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-type">ProjE</span></a></span><span> </span><span id="local-6989586621680988363"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680988363"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680988364"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988364"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Int -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-var">ProjE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680988363"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0) -&gt; SpecM Exp0 -&gt; SpecM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
</span><a href="#local-6989586621680988269"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988364"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1131"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-type">CaseE</span></a></span><span> </span><span id="local-6989586621680988365"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988365"><span class="hs-identifier hs-var">scrt</span></a></span></span><span> </span><span id="local-6989586621680988366"><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680988366"><span class="hs-identifier hs-var">brs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1132"></span><span>      </span><span id="local-6989586621680988367"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988367"><span class="hs-identifier hs-var">scrt'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
</span><a href="#local-6989586621680988269"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988365"><span class="hs-identifier hs-var">scrt</span></a></span><span>
</span><span id="line-1133"></span><span>      </span><span id="local-6989586621680988368"><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680988368"><span class="hs-identifier hs-var">brs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(([Char], [(Var, Ty0)], Exp0)
 -&gt; StateT SpecState PassM ([Char], [(Var, Ty0)], Exp0))
-&gt; [([Char], [(Var, Ty0)], Exp0)]
-&gt; StateT SpecState PassM [([Char], [(Var, Ty0)], Exp0)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span>
</span><span id="line-1134"></span><span>                </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680988369"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680988369"><span class="hs-identifier hs-var">dcon</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988370"><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988370"><span class="hs-identifier hs-var">vtys</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988371"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988371"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1135"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680988372"><span class="annot"><span class="annottext">env2' :: Env2 Ty0
</span><a href="#local-6989586621680988372"><span class="hs-identifier hs-var hs-var">env2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyEnv Ty0 -&gt; Env2 Ty0 -&gt; Env2 Ty0
forall a. Map Var a -&gt; Env2 a -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#extendsVEnv"><span class="hs-identifier hs-var">extendsVEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, Ty0)] -&gt; TyEnv Ty0
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988370"><span class="hs-identifier hs-var">vtys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680988264"><span class="hs-identifier hs-var">env2</span></a></span><span>
</span><span id="line-1136"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680988369"><span class="hs-identifier hs-var">dcon</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988370"><span class="hs-identifier hs-var">vtys</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; ([Char], [(Var, Ty0)], Exp0))
-&gt; SpecM Exp0
-&gt; StateT SpecState PassM ([Char], [(Var, Ty0)], Exp0)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Exp0 -&gt; SpecM Exp0
</span><a href="Gibbon.L0.Specialize2.html#specLambdasExp"><span class="hs-identifier hs-var">specLambdasExp</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680988263"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680988372"><span class="hs-identifier hs-var">env2'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988371"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1137"></span><span>                </span><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680988366"><span class="hs-identifier hs-var">brs</span></a></span><span>
</span><span id="line-1138"></span><span>      </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
forall a. a -&gt; StateT SpecState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; SpecM Exp0) -&gt; Exp0 -&gt; SpecM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [([Char], [(Var, Ty0)], Exp0)] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; [([Char], [(Var, loc)], PreExp ext loc dec)]
-&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-var">CaseE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988367"><span class="hs-identifier hs-var">scrt'</span></a></span><span> </span><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680988368"><span class="hs-identifier hs-var">brs'</span></a></span><span>
</span><span id="line-1139"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-type">DataConE</span></a></span><span> </span><span id="local-6989586621680988373"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988373"><span class="hs-identifier hs-var">tyapp</span></a></span></span><span> </span><span id="local-6989586621680988374"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680988374"><span class="hs-identifier hs-var">dcon</span></a></span></span><span> </span><span id="local-6989586621680988375"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988375"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; [Char] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
loc -&gt; [Char] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-var">DataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988373"><span class="hs-identifier hs-var">tyapp</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680988374"><span class="hs-identifier hs-var">dcon</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Exp0] -&gt; Exp0) -&gt; StateT SpecState PassM [Exp0] -&gt; SpecM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; SpecM Exp0) -&gt; [Exp0] -&gt; StateT SpecState PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
</span><a href="#local-6989586621680988269"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988375"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1140"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-type">TimeIt</span></a></span><span> </span><span id="local-6989586621680988376"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988376"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680988377"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988377"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680988378"><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680988378"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1141"></span><span>       </span><span id="local-6989586621680988379"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988379"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
</span><a href="#local-6989586621680988269"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988376"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1142"></span><span>       </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
forall a. a -&gt; StateT SpecState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; SpecM Exp0) -&gt; Exp0 -&gt; SpecM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Ty0 -&gt; IsBoxed -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec -&gt; dec -&gt; IsBoxed -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-var">TimeIt</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988379"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988377"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680988378"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1143"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-type">WithArenaE</span></a></span><span> </span><span id="local-6989586621680988380"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988380"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680988381"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988381"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1144"></span><span>       </span><span id="local-6989586621680988382"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988382"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Exp0 -&gt; SpecM Exp0
</span><a href="Gibbon.L0.Specialize2.html#specLambdasExp"><span class="hs-identifier hs-var">specLambdasExp</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680988263"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty0 -&gt; Env2 Ty0 -&gt; Env2 Ty0
forall a. Var -&gt; a -&gt; Env2 a -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988380"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#ArenaTy"><span class="hs-identifier hs-var">ArenaTy</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680988264"><span class="hs-identifier hs-var">env2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988381"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1145"></span><span>       </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
forall a. a -&gt; StateT SpecState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; SpecM Exp0) -&gt; Exp0 -&gt; SpecM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-var">WithArenaE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988380"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988382"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-1146"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-type">SpawnE</span></a></span><span> </span><span id="local-6989586621680988383"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988383"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621680988384"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988384"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span> </span><span id="local-6989586621680988385"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988385"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1147"></span><span>      </span><span id="local-6989586621680988386"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988386"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Exp0 -&gt; SpecM Exp0
</span><a href="Gibbon.L0.Specialize2.html#specLambdasExp"><span class="hs-identifier hs-var">specLambdasExp</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680988263"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680988264"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988383"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988384"><span class="hs-identifier hs-var">tyapps</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988385"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1148"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988386"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1149"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span id="local-6989586621680988387"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988387"><span class="hs-identifier hs-var">fn'</span></a></span></span><span> </span><span id="local-6989586621680988388"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988388"><span class="hs-identifier hs-var">tyapps'</span></a></span></span><span> </span><span id="local-6989586621680988389"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988389"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
forall a. a -&gt; StateT SpecState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; SpecM Exp0) -&gt; Exp0 -&gt; SpecM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-var">SpawnE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988387"><span class="hs-identifier hs-var">fn'</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988388"><span class="hs-identifier hs-var">tyapps'</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988389"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-1150"></span><span>        </span><span class="annot"><span class="annottext">Exp0
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SpecM Exp0
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;specLambdasExp: SpawnE&quot;</span></span><span>
</span><span id="line-1151"></span><span>    </span><span class="annot"><span class="annottext">Exp0
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
forall a. a -&gt; StateT SpecState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span>
</span><span id="line-1152"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MapE"><span class="hs-identifier hs-type">MapE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SpecM Exp0
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; SpecM Exp0) -&gt; [Char] -&gt; SpecM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;specLambdasExp: TODO: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988265"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1153"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FoldE"><span class="hs-identifier hs-type">FoldE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SpecM Exp0
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; SpecM Exp0) -&gt; [Char] -&gt; SpecM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;specLambdasExp: TODO: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988265"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1154"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span id="local-6989586621680988390"><span class="annot"><span class="annottext">E0Ext Ty0 Ty0
</span><a href="#local-6989586621680988390"><span class="hs-identifier hs-var">ext</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1155"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0
</span><a href="#local-6989586621680988390"><span class="hs-identifier hs-var">ext</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1156"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#LambdaE"><span class="hs-identifier hs-type">LambdaE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SpecM Exp0
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; SpecM Exp0) -&gt; [Char] -&gt; SpecM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;specLambdasExp: Should reach a LambdaE. It should be floated out by the Let case.&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988265"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1157"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#PolyAppE"><span class="hs-identifier hs-type">PolyAppE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SpecM Exp0
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; SpecM Exp0) -&gt; [Char] -&gt; SpecM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;specLambdasExp: TODO: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988265"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1158"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunRefE"><span class="hs-identifier hs-type">FunRefE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
forall a. a -&gt; StateT SpecState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988265"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1159"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#BenchE"><span class="hs-identifier hs-type">BenchE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
forall a. a -&gt; StateT SpecState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988265"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1160"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#ParE0"><span class="hs-identifier hs-type">ParE0</span></a></span><span> </span><span id="local-6989586621680988391"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988391"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1161"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621680988392"><span class="hs-identifier hs-type">mk_fn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#SpecM"><span class="hs-identifier hs-type">SpecM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunDef0"><span class="hs-identifier hs-type">FunDef0</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#PreExp"><span class="hs-identifier hs-type">PreExp</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#E0Ext"><span class="hs-identifier hs-type">E0Ext</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1162"></span><span>              </span><span id="local-6989586621680988392"><span class="annot"><span class="annottext">mk_fn :: Exp0 -&gt; SpecM (Maybe FunDef0, [(Var, [Ty0], Ty0, Exp0)], Exp0)
</span><a href="#local-6989586621680988392"><span class="hs-identifier hs-var hs-var">mk_fn</span></a></span></span><span> </span><span id="local-6989586621680988393"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988393"><span class="hs-identifier hs-var">e0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1163"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680988394"><span class="annot"><span class="annottext">vars :: [Var]
</span><a href="#local-6989586621680988394"><span class="hs-identifier hs-var hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; [Var]
forall a. Set a -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#toList"><span class="hs-identifier hs-var">S.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(Set Var -&gt; [Var]) -&gt; Set Var -&gt; [Var]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Set Var
forall a. FreeVars a =&gt; a -&gt; Set Var
</span><a href="Gibbon.Language.Syntax.html#gFreeVars"><span class="hs-identifier hs-var">gFreeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988393"><span class="hs-identifier hs-var">e0</span></a></span><span>
</span><span id="line-1164"></span><span>                </span><span id="local-6989586621680988395"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988395"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; StateT SpecState PassM Var)
-&gt; [Var] -&gt; StateT SpecState PassM [Var]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680988396"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988396"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PassM Var -&gt; StateT SpecState PassM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT SpecState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Var -&gt; StateT SpecState PassM Var)
-&gt; PassM Var -&gt; StateT SpecState PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988396"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988394"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-1165"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680988397"><span class="annot"><span class="annottext">e0' :: Exp0
</span><a href="#local-6989586621680988397"><span class="hs-identifier hs-var hs-var">e0'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Var, Var) -&gt; Exp0 -&gt; Exp0) -&gt; Exp0 -&gt; [(Var, Var)] -&gt; Exp0
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680988398"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988398"><span class="hs-identifier hs-var">old</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988399"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988399"><span class="hs-identifier hs-var">new</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680988400"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988400"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1166"></span><span>                                  </span><span class="annot"><span class="annottext">Var -&gt; Exp0 -&gt; Exp0 -&gt; Exp0
forall e. Substitutable e =&gt; Var -&gt; e -&gt; e -&gt; e
</span><a href="Gibbon.Language.Syntax.html#gSubst"><span class="hs-identifier hs-var">gSubst</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988398"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988399"><span class="hs-identifier hs-var">new</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988400"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1167"></span><span>                                </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988393"><span class="hs-identifier hs-var">e0</span></a></span><span>
</span><span id="line-1168"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [(Var, Var)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988394"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988395"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1169"></span><span>                </span><span class="hs-comment">-- let bind args = vars before call_a</span><span>
</span><span id="line-1170"></span><span>                </span><span id="local-6989586621680988402"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988402"><span class="hs-identifier hs-var">fnname</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PassM Var -&gt; StateT SpecState PassM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT SpecState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Var -&gt; StateT SpecState PassM Var)
-&gt; PassM Var -&gt; StateT SpecState PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;fn&quot;</span></span><span>
</span><span id="line-1171"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680988403"><span class="annot"><span class="annottext">binds :: [(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988403"><span class="hs-identifier hs-var hs-var">binds</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Var, Var, Ty0) -&gt; (Var, [Ty0], Ty0, Exp0))
-&gt; [(Var, Var, Ty0)] -&gt; [(Var, [Ty0], Ty0, Exp0)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680988404"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988404"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988405"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988405"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988406"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988406"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988404"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988406"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988405"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [Ty0] -&gt; [(Var, Var, Ty0)]
forall a b c. [a] -&gt; [b] -&gt; [c] -&gt; [(a, b, c)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip3"><span class="hs-identifier hs-var">zip3</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988395"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988394"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988408"><span class="hs-identifier hs-var">argtys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1172"></span><span>                    </span><span id="local-6989586621680988409"><span class="annot"><span class="annottext">retty :: Ty0
</span><a href="#local-6989586621680988409"><span class="hs-identifier hs-var hs-var">retty</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Exp0 -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#recoverType"><span class="hs-identifier hs-var">recoverType</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680988263"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680988264"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988393"><span class="hs-identifier hs-var">e0</span></a></span><span>
</span><span id="line-1173"></span><span>                    </span><span id="local-6989586621680988408"><span class="annot"><span class="annottext">argtys :: [Ty0]
</span><a href="#local-6989586621680988408"><span class="hs-identifier hs-var hs-var">argtys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; Ty0) -&gt; [Var] -&gt; [Ty0]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680988410"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988410"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Env2 Ty0 -&gt; Ty0
forall a. Out a =&gt; Var -&gt; Env2 a -&gt; a
</span><a href="Gibbon.Language.Syntax.html#lookupVEnv"><span class="hs-identifier hs-var">lookupVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988410"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680988264"><span class="hs-identifier hs-var">env2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988394"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-1174"></span><span>                    </span><span id="local-6989586621680988412"><span class="annot"><span class="annottext">fn :: FunDef0
</span><a href="#local-6989586621680988412"><span class="hs-identifier hs-var hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funName :: Var
</span><a href="Gibbon.Language.Syntax.html#funName"><span class="hs-identifier hs-var">funName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988402"><span class="hs-identifier hs-var">fnname</span></a></span><span>
</span><span id="line-1175"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funArgs :: [Var]
</span><a href="Gibbon.Language.Syntax.html#funArgs"><span class="hs-identifier hs-var">funArgs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988395"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1176"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funTy :: ArrowTy (TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#funTy"><span class="hs-identifier hs-var">funTy</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; Ty0 -&gt; TyScheme
</span><a href="Gibbon.L0.Syntax.html#ForAll"><span class="hs-identifier hs-var">ForAll</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ArrowTy"><span class="hs-identifier hs-var">ArrowTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988408"><span class="hs-identifier hs-var">argtys</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988409"><span class="hs-identifier hs-var">retty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1177"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funBody :: Exp0
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988397"><span class="hs-identifier hs-var">e0'</span></a></span><span>
</span><span id="line-1178"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funMeta :: FunMeta
</span><a href="Gibbon.Language.Syntax.html#funMeta"><span class="hs-identifier hs-var">funMeta</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunMeta"><span class="hs-identifier hs-type">FunMeta</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funRec :: FunRec
</span><a href="Gibbon.Language.Syntax.html#funRec"><span class="hs-identifier hs-var">funRec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunRec
</span><a href="Gibbon.Language.Syntax.html#NotRec"><span class="hs-identifier hs-var">NotRec</span></a></span><span>
</span><span id="line-1179"></span><span>                                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funInline :: FunInline
</span><a href="Gibbon.Language.Syntax.html#funInline"><span class="hs-identifier hs-var">funInline</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunInline
</span><a href="Gibbon.Language.Syntax.html#NoInline"><span class="hs-identifier hs-var">NoInline</span></a></span><span>
</span><span id="line-1180"></span><span>                                                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funCanTriggerGC :: IsBoxed
</span><a href="Gibbon.Language.Syntax.html#funCanTriggerGC"><span class="hs-identifier hs-var">funCanTriggerGC</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-1181"></span><span>                                                    </span><span class="hs-special">}</span><span>
</span><span id="line-1182"></span><span>                                </span><span class="hs-special">}</span><span>
</span><span id="line-1183"></span><span>                </span><span class="annot"><span class="annottext">(Maybe FunDef0, [(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; SpecM (Maybe FunDef0, [(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; StateT SpecState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunDef0 -&gt; Maybe FunDef0
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680988412"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988403"><span class="hs-identifier hs-var">binds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988402"><span class="hs-identifier hs-var">fnname</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var -&gt; Exp0) -&gt; [Var] -&gt; [Exp0]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988395"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1184"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680988415"><span class="annot"><span class="annottext">mb_insert :: Maybe (FunDef ex) -&gt; Map Var (FunDef ex) -&gt; Map Var (FunDef ex)
</span><a href="#local-6989586621680988415"><span class="hs-identifier hs-var hs-var">mb_insert</span></a></span></span><span> </span><span id="local-6989586621680988416"><span class="annot"><span class="annottext">Maybe (FunDef ex)
</span><a href="#local-6989586621680988416"><span class="hs-identifier hs-var">mb_fn</span></a></span></span><span> </span><span id="local-6989586621680988417"><span class="annot"><span class="annottext">Map Var (FunDef ex)
</span><a href="#local-6989586621680988417"><span class="hs-identifier hs-var">mp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (FunDef ex)
</span><a href="#local-6989586621680988416"><span class="hs-identifier hs-var">mb_fn</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1185"></span><span>                                     </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680988418"><span class="annot"><span class="annottext">FunDef ex
</span><a href="#local-6989586621680988418"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; FunDef ex -&gt; Map Var (FunDef ex) -&gt; Map Var (FunDef ex)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunDef ex -&gt; Var
forall ex. FunDef ex -&gt; Var
</span><a href="Gibbon.Language.Syntax.html#funName"><span class="hs-identifier hs-var">funName</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef ex
</span><a href="#local-6989586621680988418"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FunDef ex
</span><a href="#local-6989586621680988418"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var (FunDef ex)
</span><a href="#local-6989586621680988417"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-1186"></span><span>                                     </span><span class="annot"><span class="annottext">Maybe (FunDef ex)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map Var (FunDef ex)
</span><a href="#local-6989586621680988417"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-1187"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680988419"><span class="annot"><span class="annottext">[Maybe FunDef0]
</span><a href="#local-6989586621680988419"><span class="hs-identifier hs-var">mb_fns</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680988420"><span class="annot"><span class="annottext">[[(Var, [Ty0], Ty0, Exp0)]]
</span><a href="#local-6989586621680988420"><span class="hs-identifier hs-var">binds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680988421"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988421"><span class="hs-identifier hs-var">calls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Maybe FunDef0, [(Var, [Ty0], Ty0, Exp0)], Exp0)]
-&gt; ([Maybe FunDef0], [[(Var, [Ty0], Ty0, Exp0)]], [Exp0])
forall a b c. [(a, b, c)] -&gt; ([a], [b], [c])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip3"><span class="hs-identifier hs-var">unzip3</span></a></span><span> </span><span class="annot"><span class="annottext">([(Maybe FunDef0, [(Var, [Ty0], Ty0, Exp0)], Exp0)]
 -&gt; ([Maybe FunDef0], [[(Var, [Ty0], Ty0, Exp0)]], [Exp0]))
-&gt; StateT
     SpecState PassM [(Maybe FunDef0, [(Var, [Ty0], Ty0, Exp0)], Exp0)]
-&gt; StateT
     SpecState
     PassM
     ([Maybe FunDef0], [[(Var, [Ty0], Ty0, Exp0)]], [Exp0])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; SpecM (Maybe FunDef0, [(Var, [Ty0], Ty0, Exp0)], Exp0))
-&gt; [Exp0]
-&gt; StateT
     SpecState PassM [(Maybe FunDef0, [(Var, [Ty0], Ty0, Exp0)], Exp0)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680988423"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988423"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988423"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1188"></span><span>                                                  </span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Maybe FunDef0, [(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; SpecM (Maybe FunDef0, [(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; StateT SpecState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe FunDef0
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988423"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1189"></span><span>                                                  </span><span class="annot"><span class="annottext">Exp0
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM (Maybe FunDef0, [(Var, [Ty0], Ty0, Exp0)], Exp0)
</span><a href="#local-6989586621680988392"><span class="hs-identifier hs-var">mk_fn</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988423"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1190"></span><span>                                         </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988391"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1191"></span><span>          </span><span class="annot"><span class="annottext">(SpecState -&gt; ((), SpecState)) -&gt; StateT SpecState PassM ()
forall a. (SpecState -&gt; (a, SpecState)) -&gt; StateT SpecState PassM a
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; (a, s)) -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#state"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680988424"><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680988424"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680988424"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sp_fundefs :: FunDefs Exp0
</span><a href="Gibbon.L0.Specialize2.html#sp_fundefs"><span class="hs-identifier hs-var">sp_fundefs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe FunDef0 -&gt; FunDefs Exp0 -&gt; FunDefs Exp0)
-&gt; FunDefs Exp0 -&gt; [Maybe FunDef0] -&gt; FunDefs Exp0
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FunDef0 -&gt; FunDefs Exp0 -&gt; FunDefs Exp0
forall {ex}.
Maybe (FunDef ex) -&gt; Map Var (FunDef ex) -&gt; Map Var (FunDef ex)
</span><a href="#local-6989586621680988415"><span class="hs-identifier hs-var">mb_insert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SpecState -&gt; FunDefs Exp0
</span><a href="Gibbon.L0.Specialize2.html#sp_fundefs"><span class="hs-identifier hs-var">sp_fundefs</span></a></span><span> </span><span class="annot"><span class="annottext">SpecState
</span><a href="#local-6989586621680988424"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Maybe FunDef0]
</span><a href="#local-6989586621680988419"><span class="hs-identifier hs-var">mb_fns</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1192"></span><span>          </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
forall a. a -&gt; StateT SpecState PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; SpecM Exp0) -&gt; Exp0 -&gt; SpecM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)] -&gt; Exp0 -&gt; Exp0
forall loc dec (ext :: * -&gt; * -&gt; *).
[(Var, [loc], dec, PreExp ext loc dec)]
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.html#mkLets"><span class="hs-identifier hs-var">mkLets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[(Var, [Ty0], Ty0, Exp0)]] -&gt; [(Var, [Ty0], Ty0, Exp0)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">[[(Var, [Ty0], Ty0, Exp0)]]
</span><a href="#local-6989586621680988420"><span class="hs-identifier hs-var">binds</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0) -&gt; E0Ext Ty0 Ty0 -&gt; Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0] -&gt; E0Ext Ty0 Ty0
forall loc dec. [PreExp E0Ext loc dec] -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#ParE0"><span class="hs-identifier hs-var">ParE0</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988421"><span class="hs-identifier hs-var">calls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1193"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#PrintPacked"><span class="hs-identifier hs-type">PrintPacked</span></a></span><span> </span><span id="local-6989586621680988427"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988427"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680988428"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988428"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0) -&gt; (Exp0 -&gt; E0Ext Ty0 Ty0) -&gt; Exp0 -&gt; Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; Exp0 -&gt; E0Ext Ty0 Ty0
forall loc dec. dec -&gt; PreExp E0Ext loc dec -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#PrintPacked"><span class="hs-identifier hs-var">PrintPacked</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988427"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0) -&gt; SpecM Exp0 -&gt; SpecM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
</span><a href="#local-6989586621680988269"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988428"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-1194"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#CopyPacked"><span class="hs-identifier hs-type">CopyPacked</span></a></span><span> </span><span id="local-6989586621680988429"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988429"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680988430"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988430"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0) -&gt; (Exp0 -&gt; E0Ext Ty0 Ty0) -&gt; Exp0 -&gt; Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; Exp0 -&gt; E0Ext Ty0 Ty0
forall loc dec. dec -&gt; PreExp E0Ext loc dec -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#CopyPacked"><span class="hs-identifier hs-var">CopyPacked</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988429"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0) -&gt; SpecM Exp0 -&gt; SpecM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
</span><a href="#local-6989586621680988269"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988430"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-1195"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#TravPacked"><span class="hs-identifier hs-type">TravPacked</span></a></span><span> </span><span id="local-6989586621680988431"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988431"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680988432"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988432"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0) -&gt; (Exp0 -&gt; E0Ext Ty0 Ty0) -&gt; Exp0 -&gt; Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; Exp0 -&gt; E0Ext Ty0 Ty0
forall loc dec. dec -&gt; PreExp E0Ext loc dec -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#TravPacked"><span class="hs-identifier hs-var">TravPacked</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988431"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0) -&gt; SpecM Exp0 -&gt; SpecM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
</span><a href="#local-6989586621680988269"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988432"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-1196"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#LinearExt"><span class="hs-identifier hs-type">LinearExt</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; SpecM Exp0
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; SpecM Exp0) -&gt; [Char] -&gt; SpecM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;specLambdasExp: a linear types extension wasn't desugared: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988265"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1197"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621680988433"><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621680988433"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680988434"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988434"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0) -&gt; (Exp0 -&gt; E0Ext Ty0 Ty0) -&gt; Exp0 -&gt; Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Loc -&gt; Exp0 -&gt; E0Ext Ty0 Ty0
forall loc dec. Loc -&gt; PreExp E0Ext loc dec -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621680988433"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0) -&gt; SpecM Exp0 -&gt; SpecM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; SpecM Exp0
</span><a href="#local-6989586621680988269"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988434"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1198"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1199"></span><span>    </span><span id="local-6989586621680988269"><span class="annot"><span class="annottext">go :: Exp0 -&gt; SpecM Exp0
</span><a href="#local-6989586621680988269"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Exp0 -&gt; SpecM Exp0
</span><a href="Gibbon.L0.Specialize2.html#specLambdasExp"><span class="hs-identifier hs-var">specLambdasExp</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var DDef0
</span><a href="#local-6989586621680988263"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680988264"><span class="hs-identifier hs-var">env2</span></a></span><span>
</span><span id="line-1200"></span><span>
</span><span id="line-1201"></span><span>    </span><span id="local-6989586621680988435"><span class="annot"><span class="annottext">_isFunRef :: PreExp Any Any Any -&gt; IsBoxed
</span><a href="#local-6989586621680988435"><span class="hs-identifier hs-var hs-var">_isFunRef</span></a></span></span><span> </span><span id="local-6989586621680988436"><span class="annot"><span class="annottext">PreExp Any Any Any
</span><a href="#local-6989586621680988436"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1202"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PreExp Any Any Any
</span><a href="#local-6989586621680988436"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1203"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span id="local-6989586621680988437"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988437"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Map Var TyScheme -&gt; IsBoxed
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#member"><span class="hs-identifier hs-var">M.member</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988437"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Env2 Ty0 -&gt; TyEnv (ArrowTy Ty0)
forall a. Env2 a -&gt; TyEnv (ArrowTy a)
</span><a href="Gibbon.Language.Syntax.html#fEnv"><span class="hs-identifier hs-var">fEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680988264"><span class="hs-identifier hs-var">env2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1204"></span><span>        </span><span class="annot"><span class="annottext">PreExp Any Any Any
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-1205"></span><span>
</span><span id="line-1206"></span><span>    </span><span class="hs-comment">-- fn_0 (fn_1, thing, fn_2) =&gt; fn_0 (thing)</span><span>
</span><span id="line-1207"></span><span>    </span><span class="annot"><a href="#local-6989586621680988271"><span class="hs-identifier hs-type">dropFunRefs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Env2"><span class="hs-identifier hs-type">Env2</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1208"></span><span>    </span><span id="local-6989586621680988271"><span class="annot"><span class="annottext">dropFunRefs :: Var -&gt; Env2 Ty0 -&gt; [Exp0] -&gt; [Exp0]
</span><a href="#local-6989586621680988271"><span class="hs-identifier hs-var hs-var">dropFunRefs</span></a></span></span><span> </span><span id="local-6989586621680988440"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988440"><span class="hs-identifier hs-var">fn_name</span></a></span></span><span> </span><span id="local-6989586621680988441"><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680988441"><span class="hs-identifier hs-var">env21</span></a></span></span><span> </span><span id="local-6989586621680988442"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988442"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1209"></span><span>      </span><span class="annot"><span class="annottext">((Exp0, Ty0) -&gt; [Exp0] -&gt; [Exp0])
-&gt; [Exp0] -&gt; [(Exp0, Ty0)] -&gt; [Exp0]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680988443"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988443"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988444"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988444"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680988445"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988445"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; IsBoxed
</span><a href="Gibbon.L0.Syntax.html#isFunTy"><span class="hs-identifier hs-var">isFunTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988444"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988445"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988443"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">Exp0 -&gt; [Exp0] -&gt; [Exp0]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988445"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Exp0] -&gt; [Ty0] -&gt; [(Exp0, Ty0)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988442"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988446"><span class="hs-identifier hs-var">arg_tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1210"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1211"></span><span>        </span><span class="annot"><a href="Gibbon.L0.Syntax.html#ForAll"><span class="hs-identifier hs-type">ForAll</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#ArrowTy"><span class="hs-identifier hs-type">ArrowTy</span></a></span><span> </span><span id="local-6989586621680988446"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988446"><span class="hs-identifier hs-var">arg_tys</span></a></span></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Env2 Ty0 -&gt; ArrowTy Ty0
forall a. Out (ArrowTy a) =&gt; Var -&gt; Env2 a -&gt; ArrowTy a
</span><a href="Gibbon.Language.Syntax.html#lookupFEnv"><span class="hs-identifier hs-var">lookupFEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988440"><span class="hs-identifier hs-var">fn_name</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680988441"><span class="hs-identifier hs-var">env21</span></a></span><span>
</span><span id="line-1212"></span><span>
</span><span id="line-1213"></span><span>    </span><span class="annot"><a href="#local-6989586621680988273"><span class="hs-identifier hs-type">collectFunRefs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L0.Specialize2.html#FunRef"><span class="hs-identifier hs-type">FunRef</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L0.Specialize2.html#FunRef"><span class="hs-identifier hs-type">FunRef</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1214"></span><span>    </span><span id="local-6989586621680988273"><span class="annot"><span class="annottext">collectFunRefs :: Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988273"><span class="hs-identifier hs-var hs-var">collectFunRefs</span></a></span></span><span> </span><span id="local-6989586621680988447"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988447"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680988448"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988448"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1215"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988447"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1216"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988448"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1217"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-type">LitE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988448"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1218"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CharE"><span class="hs-identifier hs-type">CharE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988448"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1219"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-type">FloatE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988448"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1220"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-type">LitSymE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988448"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1221"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680988449"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988449"><span class="hs-identifier hs-var">args</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; [Var] -&gt; [Var]) -&gt; [Var] -&gt; [Exp0] -&gt; [Var]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988273"><span class="hs-identifier hs-var">collectFunRefs</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988448"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988449"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1222"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680988450"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988450"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; [Var] -&gt; [Var]) -&gt; [Var] -&gt; [Exp0] -&gt; [Var]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988273"><span class="hs-identifier hs-var">collectFunRefs</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988448"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988450"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1223"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680988451"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988451"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680988452"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988452"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; [Var] -&gt; [Var]) -&gt; [Var] -&gt; [Exp0] -&gt; [Var]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988273"><span class="hs-identifier hs-var">collectFunRefs</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988448"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988452"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988451"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1224"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-type">IfE</span></a></span><span> </span><span id="local-6989586621680988453"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988453"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680988454"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988454"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680988455"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988455"><span class="hs-identifier hs-var">c</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; [Var] -&gt; [Var]) -&gt; [Var] -&gt; [Exp0] -&gt; [Var]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988273"><span class="hs-identifier hs-var">collectFunRefs</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988448"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988455"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988454"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988453"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1225"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-type">MkProdE</span></a></span><span> </span><span id="local-6989586621680988456"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988456"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; [Var] -&gt; [Var]) -&gt; [Var] -&gt; [Exp0] -&gt; [Var]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988273"><span class="hs-identifier hs-var">collectFunRefs</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988448"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988456"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1226"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-type">ProjE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680988457"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988457"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988273"><span class="hs-identifier hs-var">collectFunRefs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988457"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988448"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1227"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-type">DataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680988458"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988458"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; [Var] -&gt; [Var]) -&gt; [Var] -&gt; [Exp0] -&gt; [Var]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988273"><span class="hs-identifier hs-var">collectFunRefs</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988448"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988458"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1228"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-type">TimeIt</span></a></span><span> </span><span id="local-6989586621680988459"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988459"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988273"><span class="hs-identifier hs-var">collectFunRefs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988459"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988448"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1229"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-type">WithArenaE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680988460"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988460"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988273"><span class="hs-identifier hs-var">collectFunRefs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988460"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988448"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1230"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-type">CaseE</span></a></span><span> </span><span id="local-6989586621680988461"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988461"><span class="hs-identifier hs-var">scrt</span></a></span></span><span> </span><span id="local-6989586621680988462"><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680988462"><span class="hs-identifier hs-var">brs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(([Char], [(Var, Ty0)], Exp0) -&gt; [Var] -&gt; [Var])
-&gt; [Var] -&gt; [([Char], [(Var, Ty0)], Exp0)] -&gt; [Var]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span>
</span><span id="line-1231"></span><span>                            </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680988463"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988463"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680988464"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988464"><span class="hs-identifier hs-var">acc2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988273"><span class="hs-identifier hs-var">collectFunRefs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988463"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988464"><span class="hs-identifier hs-var">acc2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1232"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988273"><span class="hs-identifier hs-var">collectFunRefs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988461"><span class="hs-identifier hs-var">scrt</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988448"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1233"></span><span>                            </span><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680988462"><span class="hs-identifier hs-var">brs</span></a></span><span>
</span><span id="line-1234"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-type">SpawnE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680988465"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988465"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; [Var] -&gt; [Var]) -&gt; [Var] -&gt; [Exp0] -&gt; [Var]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988273"><span class="hs-identifier hs-var">collectFunRefs</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988448"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988465"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1235"></span><span>        </span><span class="annot"><span class="annottext">Exp0
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988448"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1236"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MapE"><span class="hs-identifier hs-type">MapE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Var]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Var]) -&gt; [Char] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;collectFunRefs: TODO: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988447"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1237"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FoldE"><span class="hs-identifier hs-type">FoldE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Var]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Var]) -&gt; [Char] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;collectFunRefs: TODO: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988447"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1238"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span id="local-6989586621680988466"><span class="annot"><span class="annottext">E0Ext Ty0 Ty0
</span><a href="#local-6989586621680988466"><span class="hs-identifier hs-var">ext</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1239"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0
</span><a href="#local-6989586621680988466"><span class="hs-identifier hs-var">ext</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1240"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#LambdaE"><span class="hs-identifier hs-type">LambdaE</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680988467"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988467"><span class="hs-identifier hs-var">bod</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988273"><span class="hs-identifier hs-var">collectFunRefs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988467"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988448"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1241"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#PolyAppE"><span class="hs-identifier hs-type">PolyAppE</span></a></span><span> </span><span id="local-6989586621680988468"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988468"><span class="hs-identifier hs-var">rator</span></a></span></span><span> </span><span id="local-6989586621680988469"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988469"><span class="hs-identifier hs-var">rand</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988273"><span class="hs-identifier hs-var">collectFunRefs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988469"><span class="hs-identifier hs-var">rand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988273"><span class="hs-identifier hs-var">collectFunRefs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988468"><span class="hs-identifier hs-var">rator</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988448"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1242"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunRefE"><span class="hs-identifier hs-type">FunRefE</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680988470"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988470"><span class="hs-identifier hs-var">f</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988470"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Var]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988448"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1243"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#BenchE"><span class="hs-identifier hs-type">BenchE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988448"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1244"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#ParE0"><span class="hs-identifier hs-type">ParE0</span></a></span><span> </span><span id="local-6989586621680988471"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988471"><span class="hs-identifier hs-var">ls</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; [Var] -&gt; [Var]) -&gt; [Var] -&gt; [Exp0] -&gt; [Var]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988273"><span class="hs-identifier hs-var">collectFunRefs</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988448"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988471"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1245"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#PrintPacked"><span class="hs-identifier hs-type">PrintPacked</span></a></span><span> </span><span id="local-6989586621680988472"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988472"><span class="hs-identifier hs-var">_ty</span></a></span></span><span> </span><span id="local-6989586621680988473"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988473"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988273"><span class="hs-identifier hs-var">collectFunRefs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988473"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988448"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1246"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#CopyPacked"><span class="hs-identifier hs-type">CopyPacked</span></a></span><span> </span><span id="local-6989586621680988474"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988474"><span class="hs-identifier hs-var">_ty</span></a></span></span><span> </span><span id="local-6989586621680988475"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988475"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988273"><span class="hs-identifier hs-var">collectFunRefs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988475"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988448"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1247"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#TravPacked"><span class="hs-identifier hs-type">TravPacked</span></a></span><span> </span><span id="local-6989586621680988476"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988476"><span class="hs-identifier hs-var">_ty</span></a></span></span><span> </span><span id="local-6989586621680988477"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988477"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988273"><span class="hs-identifier hs-var">collectFunRefs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988477"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988448"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1248"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">Loc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680988478"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988478"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988273"><span class="hs-identifier hs-var">collectFunRefs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988478"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988448"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1249"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#LinearExt"><span class="hs-identifier hs-type">LinearExt</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1250"></span><span>              </span><span class="annot"><span class="annottext">[Char] -&gt; [Var]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Var]) -&gt; [Char] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1251"></span><span>              </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;collectFunRefs: a linear types extension wasn't desugared: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-1252"></span><span>              </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988265"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1253"></span><span>
</span><span id="line-1254"></span><span class="hs-comment">-- Returns all functions used in an expression, both in AppE's and FunRefE's.</span><span>
</span><span id="line-1255"></span><span>    </span><span class="annot"><a href="#local-6989586621680988316"><span class="hs-identifier hs-type">collectAllFuns</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L0.Specialize2.html#FunRef"><span class="hs-identifier hs-type">FunRef</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L0.Specialize2.html#FunRef"><span class="hs-identifier hs-type">FunRef</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1256"></span><span>    </span><span id="local-6989586621680988316"><span class="annot"><span class="annottext">collectAllFuns :: Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988316"><span class="hs-identifier hs-var hs-var">collectAllFuns</span></a></span></span><span> </span><span id="local-6989586621680988479"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988479"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680988480"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988480"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1257"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988479"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1258"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988480"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1259"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-type">LitE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988480"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1260"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CharE"><span class="hs-identifier hs-type">CharE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988480"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1261"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-type">FloatE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988480"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1262"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-type">LitSymE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988480"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1263"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span id="local-6989586621680988481"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988481"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680988482"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988482"><span class="hs-identifier hs-var">args</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988481"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Var]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; [Var] -&gt; [Var]) -&gt; [Var] -&gt; [Exp0] -&gt; [Var]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988316"><span class="hs-identifier hs-var">collectAllFuns</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988480"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988482"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1264"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680988483"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988483"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; [Var] -&gt; [Var]) -&gt; [Var] -&gt; [Exp0] -&gt; [Var]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988316"><span class="hs-identifier hs-var">collectAllFuns</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988480"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988483"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1265"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680988484"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988484"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680988485"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988485"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; [Var] -&gt; [Var]) -&gt; [Var] -&gt; [Exp0] -&gt; [Var]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988316"><span class="hs-identifier hs-var">collectAllFuns</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988480"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988485"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988484"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1266"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-type">IfE</span></a></span><span> </span><span id="local-6989586621680988486"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988486"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680988487"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988487"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680988488"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988488"><span class="hs-identifier hs-var">c</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; [Var] -&gt; [Var]) -&gt; [Var] -&gt; [Exp0] -&gt; [Var]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988316"><span class="hs-identifier hs-var">collectAllFuns</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988480"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988488"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988487"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988486"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1267"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-type">MkProdE</span></a></span><span> </span><span id="local-6989586621680988489"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988489"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; [Var] -&gt; [Var]) -&gt; [Var] -&gt; [Exp0] -&gt; [Var]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988316"><span class="hs-identifier hs-var">collectAllFuns</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988480"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988489"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1268"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-type">ProjE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680988490"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988490"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988316"><span class="hs-identifier hs-var">collectAllFuns</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988490"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988480"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1269"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-type">DataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680988491"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988491"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; [Var] -&gt; [Var]) -&gt; [Var] -&gt; [Exp0] -&gt; [Var]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988316"><span class="hs-identifier hs-var">collectAllFuns</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988480"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988491"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1270"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-type">TimeIt</span></a></span><span> </span><span id="local-6989586621680988492"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988492"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988316"><span class="hs-identifier hs-var">collectAllFuns</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988492"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988480"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1271"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-type">WithArenaE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680988493"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988493"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988316"><span class="hs-identifier hs-var">collectAllFuns</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988493"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988480"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1272"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-type">CaseE</span></a></span><span> </span><span id="local-6989586621680988494"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988494"><span class="hs-identifier hs-var">scrt</span></a></span></span><span> </span><span id="local-6989586621680988495"><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680988495"><span class="hs-identifier hs-var">brs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(([Char], [(Var, Ty0)], Exp0) -&gt; [Var] -&gt; [Var])
-&gt; [Var] -&gt; [([Char], [(Var, Ty0)], Exp0)] -&gt; [Var]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span>
</span><span id="line-1273"></span><span>                            </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680988496"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988496"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680988497"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988497"><span class="hs-identifier hs-var">acc2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988316"><span class="hs-identifier hs-var">collectAllFuns</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988496"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988497"><span class="hs-identifier hs-var">acc2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1274"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988316"><span class="hs-identifier hs-var">collectAllFuns</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988494"><span class="hs-identifier hs-var">scrt</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988480"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1275"></span><span>                            </span><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680988495"><span class="hs-identifier hs-var">brs</span></a></span><span>
</span><span id="line-1276"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-type">SpawnE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680988498"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988498"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; [Var] -&gt; [Var]) -&gt; [Var] -&gt; [Exp0] -&gt; [Var]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988316"><span class="hs-identifier hs-var">collectAllFuns</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988480"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988498"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1277"></span><span>        </span><span class="annot"><span class="annottext">Exp0
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988480"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1278"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MapE"><span class="hs-identifier hs-type">MapE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Var]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Var]) -&gt; [Char] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;collectAllFuns: TODO: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988479"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1279"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FoldE"><span class="hs-identifier hs-type">FoldE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Var]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Var]) -&gt; [Char] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;collectAllFuns: TODO: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988479"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1280"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span id="local-6989586621680988499"><span class="annot"><span class="annottext">E0Ext Ty0 Ty0
</span><a href="#local-6989586621680988499"><span class="hs-identifier hs-var">ext</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1281"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0
</span><a href="#local-6989586621680988499"><span class="hs-identifier hs-var">ext</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1282"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#LambdaE"><span class="hs-identifier hs-type">LambdaE</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680988500"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988500"><span class="hs-identifier hs-var">bod</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988316"><span class="hs-identifier hs-var">collectAllFuns</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988500"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988480"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1283"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#PolyAppE"><span class="hs-identifier hs-type">PolyAppE</span></a></span><span> </span><span id="local-6989586621680988501"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988501"><span class="hs-identifier hs-var">rator</span></a></span></span><span> </span><span id="local-6989586621680988502"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988502"><span class="hs-identifier hs-var">rand</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988316"><span class="hs-identifier hs-var">collectAllFuns</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988502"><span class="hs-identifier hs-var">rand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988316"><span class="hs-identifier hs-var">collectAllFuns</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988501"><span class="hs-identifier hs-var">rator</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988480"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1284"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunRefE"><span class="hs-identifier hs-type">FunRefE</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680988503"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988503"><span class="hs-identifier hs-var">f</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988503"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Var]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988480"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1285"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#BenchE"><span class="hs-identifier hs-type">BenchE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988480"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1286"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#ParE0"><span class="hs-identifier hs-type">ParE0</span></a></span><span> </span><span id="local-6989586621680988504"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988504"><span class="hs-identifier hs-var">ls</span></a></span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; [Var] -&gt; [Var]) -&gt; [Var] -&gt; [Exp0] -&gt; [Var]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988316"><span class="hs-identifier hs-var">collectAllFuns</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988480"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988504"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1287"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#PrintPacked"><span class="hs-identifier hs-type">PrintPacked</span></a></span><span> </span><span id="local-6989586621680988505"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988505"><span class="hs-identifier hs-var">_ty</span></a></span></span><span> </span><span id="local-6989586621680988506"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988506"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988316"><span class="hs-identifier hs-var">collectAllFuns</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988506"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988480"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1288"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#CopyPacked"><span class="hs-identifier hs-type">CopyPacked</span></a></span><span> </span><span id="local-6989586621680988507"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988507"><span class="hs-identifier hs-var">_ty</span></a></span></span><span> </span><span id="local-6989586621680988508"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988508"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988316"><span class="hs-identifier hs-var">collectAllFuns</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988508"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988480"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1289"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#TravPacked"><span class="hs-identifier hs-type">TravPacked</span></a></span><span> </span><span id="local-6989586621680988509"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988509"><span class="hs-identifier hs-var">_ty</span></a></span></span><span> </span><span id="local-6989586621680988510"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988510"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988316"><span class="hs-identifier hs-var">collectAllFuns</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988510"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988480"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1290"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">Loc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680988511"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988511"><span class="hs-identifier hs-var">e1</span></a></span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Var] -&gt; [Var]
</span><a href="#local-6989586621680988316"><span class="hs-identifier hs-var">collectAllFuns</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988511"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988480"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1291"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#LinearExt"><span class="hs-identifier hs-type">LinearExt</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Var]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Var]) -&gt; [Char] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;collectAllFuns: a linear types extension wasn't desugared: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988265"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1292"></span><span>
</span><span id="line-1293"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#addArgsToTy"><span class="hs-identifier hs-type">addArgsToTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#TyScheme"><span class="hs-identifier hs-type">TyScheme</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#TyScheme"><span class="hs-identifier hs-type">TyScheme</span></a></span><span>
</span><span id="line-1294"></span><span id="addArgsToTy"><span class="annot"><span class="annottext">addArgsToTy :: [Ty0] -&gt; TyScheme -&gt; TyScheme
</span><a href="Gibbon.L0.Specialize2.html#addArgsToTy"><span class="hs-identifier hs-var hs-var">addArgsToTy</span></a></span></span><span> </span><span id="local-6989586621680988518"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988518"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#ForAll"><span class="hs-identifier hs-type">ForAll</span></a></span><span> </span><span id="local-6989586621680988519"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680988519"><span class="hs-identifier hs-var">tyvars</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#ArrowTy"><span class="hs-identifier hs-type">ArrowTy</span></a></span><span> </span><span id="local-6989586621680988520"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988520"><span class="hs-identifier hs-var">in_tys</span></a></span></span><span> </span><span id="local-6989586621680988521"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988521"><span class="hs-identifier hs-var">ret_ty</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1295"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680988522"><span class="annot"><span class="annottext">in_tys' :: [Ty0]
</span><a href="#local-6989586621680988522"><span class="hs-identifier hs-var hs-var">in_tys'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988520"><span class="hs-identifier hs-var">in_tys</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; [Ty0] -&gt; [Ty0]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988518"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1296"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; Ty0 -&gt; TyScheme
</span><a href="Gibbon.L0.Syntax.html#ForAll"><span class="hs-identifier hs-var">ForAll</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680988519"><span class="hs-identifier hs-var">tyvars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ArrowTy"><span class="hs-identifier hs-var">ArrowTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988522"><span class="hs-identifier hs-var">in_tys'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988521"><span class="hs-identifier hs-var">ret_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1297"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#addArgsToTy"><span class="hs-identifier hs-var">addArgsToTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680988523"><span class="annot"><span class="annottext">TyScheme
</span><a href="#local-6989586621680988523"><span class="hs-identifier hs-var">oth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; TyScheme
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; TyScheme) -&gt; [Char] -&gt; TyScheme
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;addArgsToTy: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">TyScheme -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">TyScheme
</span><a href="#local-6989586621680988523"><span class="hs-identifier hs-var">oth</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; is not ArrowTy.&quot;</span></span><span>
</span><span id="line-1298"></span><span>
</span><span id="line-1299"></span><span>
</span><span id="line-1300"></span><span>
</span><span id="line-1301"></span><span class="annot"><span class="hs-comment">{-|

Let bind all anonymous lambdas.

    map (\x -&gt; x + 1) [1,2,3]

becomes

   let lam_1 = (\x -&gt; x + 1)
   in map lam_1 [1,2,3]

This is an intermediate step before the specializer turns the let bound
lambdas into top-level functions.

-}</span></span><span>
</span><span id="line-1316"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#bindLambdas"><span class="hs-identifier hs-type">bindLambdas</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Prog0"><span class="hs-identifier hs-type">Prog0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Prog0"><span class="hs-identifier hs-type">Prog0</span></a></span><span>
</span><span id="line-1317"></span><span id="bindLambdas"><span class="annot"><span class="annottext">bindLambdas :: Prog0 -&gt; PassM Prog0
</span><a href="Gibbon.L0.Specialize2.html#bindLambdas"><span class="hs-identifier hs-var hs-var">bindLambdas</span></a></span></span><span> </span><span id="local-6989586621680988621"><span class="annot"><span class="annottext">prg :: Prog0
</span><a href="#local-6989586621680988621"><span class="hs-identifier hs-var">prg</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span class="hs-special">{</span><span id="local-6989586621680988622"><span class="annot"><span class="annottext">FunDefs Exp0
fundefs :: forall ex. Prog ex -&gt; FunDefs ex
fundefs :: FunDefs Exp0
</span><a href="Gibbon.Language.Syntax.html#fundefs"><span class="hs-identifier hs-var hs-var">fundefs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988623"><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
mainExp :: forall ex. Prog ex -&gt; Maybe (ex, TyOf ex)
mainExp :: Maybe (Exp0, TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#mainExp"><span class="hs-identifier hs-var hs-var">mainExp</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1318"></span><span>  </span><span id="local-6989586621680988624"><span class="annot"><span class="annottext">Maybe (Exp0, Ty0)
</span><a href="#local-6989586621680988624"><span class="hs-identifier hs-var">mainExp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
</span><a href="#local-6989586621680988623"><span class="hs-identifier hs-var">mainExp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1319"></span><span>                </span><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp0, Ty0) -&gt; PassM (Maybe (Exp0, Ty0))
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Exp0, Ty0)
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1320"></span><span>                </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680988625"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988625"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680988626"><span class="annot"><span class="annottext">TyOf Exp0
</span><a href="#local-6989586621680988626"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Exp0, Ty0) -&gt; Maybe (Exp0, Ty0)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">((Exp0, Ty0) -&gt; Maybe (Exp0, Ty0))
-&gt; (Exp0 -&gt; (Exp0, Ty0)) -&gt; Exp0 -&gt; Maybe (Exp0, Ty0)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><span class="annottext">TyOf Exp0
Ty0
</span><a href="#local-6989586621680988626"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Maybe (Exp0, Ty0))
-&gt; PassM Exp0 -&gt; PassM (Maybe (Exp0, Ty0))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988627"><span class="hs-identifier hs-var">goExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988625"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1321"></span><span>  </span><span id="local-6989586621680988628"><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680988628"><span class="hs-identifier hs-var">fundefs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FunDef0 -&gt; PassM FunDef0) -&gt; FunDefs Exp0 -&gt; PassM (FunDefs Exp0)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; Map Var a -&gt; m (Map Var b)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span>
</span><span id="line-1322"></span><span>                </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680988629"><span class="annot"><span class="annottext">fn :: FunDef0
</span><a href="#local-6989586621680988629"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span class="hs-special">{</span><span id="local-6989586621680988630"><span class="annot"><span class="annottext">Exp0
funBody :: forall ex. FunDef ex -&gt; ex
funBody :: Exp0
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var hs-var">funBody</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988627"><span class="hs-identifier hs-var">goExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988630"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Exp0 -&gt; (Exp0 -&gt; PassM FunDef0) -&gt; PassM FunDef0
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span>
</span><span id="line-1323"></span><span>                                        </span><span class="hs-glyph">\</span><span id="local-6989586621680988631"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988631"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FunDef0 -&gt; PassM FunDef0
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(FunDef0 -&gt; PassM FunDef0) -&gt; FunDef0 -&gt; PassM FunDef0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680988629"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">funBody :: Exp0
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988631"><span class="hs-identifier hs-var">b'</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1324"></span><span>                </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680988622"><span class="hs-identifier hs-var">fundefs</span></a></span><span>
</span><span id="line-1325"></span><span>  </span><span class="annot"><span class="annottext">Prog0 -&gt; PassM Prog0
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Prog0 -&gt; PassM Prog0) -&gt; Prog0 -&gt; PassM Prog0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680988621"><span class="hs-identifier hs-var">prg</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">fundefs :: FunDefs Exp0
</span><a href="Gibbon.Language.Syntax.html#fundefs"><span class="hs-identifier hs-var">fundefs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680988628"><span class="hs-identifier hs-var">fundefs'</span></a></span><span>
</span><span id="line-1326"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">mainExp :: Maybe (Exp0, TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#mainExp"><span class="hs-identifier hs-var">mainExp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
Maybe (Exp0, Ty0)
</span><a href="#local-6989586621680988624"><span class="hs-identifier hs-var">mainExp'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1327"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1328"></span><span>    </span><span class="annot"><a href="#local-6989586621680988627"><span class="hs-identifier hs-type">goExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span>
</span><span id="line-1329"></span><span>    </span><span id="local-6989586621680988627"><span class="annot"><span class="annottext">goExp :: Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988627"><span class="hs-identifier hs-var hs-var">goExp</span></a></span></span><span> </span><span id="local-6989586621680988632"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988632"><span class="hs-identifier hs-var">ex0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988633"><span class="hs-identifier hs-var">gocap</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988632"><span class="hs-identifier hs-var">ex0</span></a></span><span>
</span><span id="line-1330"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1331"></span><span>      </span><span id="local-6989586621680988633"><span class="annot"><span class="annottext">gocap :: Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988633"><span class="hs-identifier hs-var hs-var">gocap</span></a></span></span><span> </span><span id="local-6989586621680988636"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988636"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680988637"><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988637"><span class="hs-identifier hs-var">lets</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988638"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988638"><span class="hs-identifier hs-var">ex'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
</span><a href="#local-6989586621680988639"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988636"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1332"></span><span>                    </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; PassM Exp0) -&gt; Exp0 -&gt; PassM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)] -&gt; Exp0 -&gt; Exp0
forall loc dec (ext :: * -&gt; * -&gt; *).
[(Var, [loc], dec, PreExp ext loc dec)]
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.html#mkLets"><span class="hs-identifier hs-var">mkLets</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988637"><span class="hs-identifier hs-var">lets</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988638"><span class="hs-identifier hs-var">ex'</span></a></span><span>
</span><span id="line-1333"></span><span>      </span><span class="annot"><a href="#local-6989586621680988639"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1334"></span><span>      </span><span id="local-6989586621680988639"><span class="annot"><span class="annottext">go :: Exp0 -&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
</span><a href="#local-6989586621680988639"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680988640"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988640"><span class="hs-identifier hs-var">e0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1335"></span><span>       </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988640"><span class="hs-identifier hs-var">e0</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1336"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#LambdaE"><span class="hs-identifier hs-type">LambdaE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1337"></span><span>          </span><span id="local-6989586621680988641"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988641"><span class="hs-identifier hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;lam&quot;</span></span><span>
</span><span id="line-1338"></span><span>          </span><span id="local-6989586621680988642"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988642"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PassM Ty0
forall (m :: * -&gt; *). MonadState Int m =&gt; m Ty0
</span><a href="Gibbon.L0.Syntax.html#newMetaTy"><span class="hs-identifier hs-var">newMetaTy</span></a></span><span>
</span><span id="line-1339"></span><span>          </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988641"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988642"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988640"><span class="hs-identifier hs-var">e0</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988641"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1340"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680988644"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988644"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988645"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988645"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988646"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988646"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988647"><span class="annot"><span class="annottext">rhs :: Exp0
</span><a href="#local-6989586621680988647"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#LambdaE"><span class="hs-identifier hs-type">LambdaE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621680988648"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988648"><span class="hs-identifier hs-var">bod</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1341"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621680988649"><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988649"><span class="hs-identifier hs-var">lts2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680988650"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988650"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
</span><a href="#local-6989586621680988639"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988648"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-1342"></span><span>            </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988649"><span class="hs-identifier hs-var">lts2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0) -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988644"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988645"><span class="hs-identifier hs-var">tyapps</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988646"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988647"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988650"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1343"></span><span>        </span><span class="hs-comment">-- boilerplate</span><span>
</span><span id="line-1344"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#ParE0"><span class="hs-identifier hs-type">ParE0</span></a></span><span> </span><span id="local-6989586621680988651"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988651"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1345"></span><span>          </span><span id="local-6989586621680988652"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988652"><span class="hs-identifier hs-var">ls'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; PassM Exp0) -&gt; [Exp0] -&gt; PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988633"><span class="hs-identifier hs-var">gocap</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988651"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1346"></span><span>          </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0) -&gt; E0Ext Ty0 Ty0 -&gt; Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0] -&gt; E0Ext Ty0 Ty0
forall loc dec. [PreExp E0Ext loc dec] -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#ParE0"><span class="hs-identifier hs-var">ParE0</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988652"><span class="hs-identifier hs-var">ls'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1347"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#PolyAppE"><span class="hs-identifier hs-type">PolyAppE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988640"><span class="hs-identifier hs-var">e0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1348"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunRefE"><span class="hs-identifier hs-type">FunRefE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988640"><span class="hs-identifier hs-var">e0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1349"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#BenchE"><span class="hs-identifier hs-type">BenchE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988640"><span class="hs-identifier hs-var">e0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1350"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#PrintPacked"><span class="hs-identifier hs-type">PrintPacked</span></a></span><span> </span><span id="local-6989586621680988653"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988653"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680988654"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988654"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1351"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680988655"><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988655"><span class="hs-identifier hs-var">lts</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680988656"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988656"><span class="hs-identifier hs-var">arg'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
</span><a href="#local-6989586621680988639"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988654"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-1352"></span><span>          </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988655"><span class="hs-identifier hs-var">lts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; Exp0 -&gt; E0Ext Ty0 Ty0
forall loc dec. dec -&gt; PreExp E0Ext loc dec -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#PrintPacked"><span class="hs-identifier hs-var">PrintPacked</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988653"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988656"><span class="hs-identifier hs-var">arg'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1353"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#CopyPacked"><span class="hs-identifier hs-type">CopyPacked</span></a></span><span> </span><span id="local-6989586621680988657"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988657"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680988658"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988658"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1354"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680988659"><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988659"><span class="hs-identifier hs-var">lts</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680988660"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988660"><span class="hs-identifier hs-var">arg'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
</span><a href="#local-6989586621680988639"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988658"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-1355"></span><span>          </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988659"><span class="hs-identifier hs-var">lts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; Exp0 -&gt; E0Ext Ty0 Ty0
forall loc dec. dec -&gt; PreExp E0Ext loc dec -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#CopyPacked"><span class="hs-identifier hs-var">CopyPacked</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988657"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988660"><span class="hs-identifier hs-var">arg'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1356"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#TravPacked"><span class="hs-identifier hs-type">TravPacked</span></a></span><span> </span><span id="local-6989586621680988661"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988661"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680988662"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988662"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1357"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680988663"><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988663"><span class="hs-identifier hs-var">lts</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680988664"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988664"><span class="hs-identifier hs-var">arg'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
</span><a href="#local-6989586621680988639"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988662"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-1358"></span><span>          </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988663"><span class="hs-identifier hs-var">lts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; Exp0 -&gt; E0Ext Ty0 Ty0
forall loc dec. dec -&gt; PreExp E0Ext loc dec -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#TravPacked"><span class="hs-identifier hs-var">TravPacked</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988661"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988664"><span class="hs-identifier hs-var">arg'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1359"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621680988665"><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621680988665"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680988666"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988666"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1360"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680988667"><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988667"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680988668"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988668"><span class="hs-identifier hs-var">e1'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
</span><a href="#local-6989586621680988639"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988666"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-1361"></span><span>          </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988667"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0) -&gt; E0Ext Ty0 Ty0 -&gt; Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Loc -&gt; Exp0 -&gt; E0Ext Ty0 Ty0
forall loc dec. Loc -&gt; PreExp E0Ext loc dec -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621680988665"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988668"><span class="hs-identifier hs-var">e1'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1362"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#LinearExt"><span class="hs-identifier hs-type">LinearExt</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0))
-&gt; [Char] -&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;bindLambdas: a linear types extension wasn't desugared: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988640"><span class="hs-identifier hs-var">e0</span></a></span><span>
</span><span id="line-1363"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-type">LitE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988640"><span class="hs-identifier hs-var">e0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1364"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#CharE"><span class="hs-identifier hs-type">CharE</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988640"><span class="hs-identifier hs-var">e0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1365"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-type">FloatE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988640"><span class="hs-identifier hs-var">e0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1366"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-type">LitSymE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988640"><span class="hs-identifier hs-var">e0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1367"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988640"><span class="hs-identifier hs-var">e0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1368"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988640"><span class="hs-identifier hs-var">e0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1369"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span id="local-6989586621680988669"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988669"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680988670"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988670"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span> </span><span id="local-6989586621680988671"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988671"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1370"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680988672"><span class="annot"><span class="annottext">[[(Var, [Ty0], Ty0, Exp0)]]
</span><a href="#local-6989586621680988672"><span class="hs-identifier hs-var">ltss</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988673"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988673"><span class="hs-identifier hs-var">args'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[([(Var, [Ty0], Ty0, Exp0)], Exp0)]
-&gt; ([[(Var, [Ty0], Ty0, Exp0)]], [Exp0])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">([([(Var, [Ty0], Ty0, Exp0)], Exp0)]
 -&gt; ([[(Var, [Ty0], Ty0, Exp0)]], [Exp0]))
-&gt; PassM [([(Var, [Ty0], Ty0, Exp0)], Exp0)]
-&gt; PassM ([[(Var, [Ty0], Ty0, Exp0)]], [Exp0])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0))
-&gt; [Exp0] -&gt; PassM [([(Var, [Ty0], Ty0, Exp0)], Exp0)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
</span><a href="#local-6989586621680988639"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988671"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1371"></span><span>          </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[(Var, [Ty0], Ty0, Exp0)]] -&gt; [(Var, [Ty0], Ty0, Exp0)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">[[(Var, [Ty0], Ty0, Exp0)]]
</span><a href="#local-6989586621680988672"><span class="hs-identifier hs-var">ltss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988669"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988670"><span class="hs-identifier hs-var">tyapps</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988673"><span class="hs-identifier hs-var">args'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1372"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#MapE"><span class="hs-identifier hs-type">MapE</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty0, Exp0)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;bindLambdas: FINISHME MapE&quot;</span></span><span>
</span><span id="line-1373"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#FoldE"><span class="hs-identifier hs-type">FoldE</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty0, Exp0)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">(Var, Ty0, Exp0)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;bindLambdas: FINISHME FoldE&quot;</span></span><span>
</span><span id="line-1374"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680988674"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988674"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988675"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988675"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988676"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988676"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988677"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988677"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680988678"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988678"><span class="hs-identifier hs-var">bod</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1375"></span><span>           </span><span class="hs-special">(</span><span id="local-6989586621680988679"><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988679"><span class="hs-identifier hs-var">lts1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680988680"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988680"><span class="hs-identifier hs-var">rhs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
</span><a href="#local-6989586621680988639"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988677"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1376"></span><span>           </span><span id="local-6989586621680988681"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988681"><span class="hs-identifier hs-var">bod'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988633"><span class="hs-identifier hs-var">gocap</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988678"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-1377"></span><span>           </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988679"><span class="hs-identifier hs-var">lts1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0) -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988674"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988675"><span class="hs-identifier hs-var">tyapps</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988676"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988680"><span class="hs-identifier hs-var">rhs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988681"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1378"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-type">IfE</span></a></span><span> </span><span id="local-6989586621680988682"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988682"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680988683"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988683"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span id="local-6989586621680988684"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988684"><span class="hs-identifier hs-var">e3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1379"></span><span>             </span><span class="hs-special">(</span><span id="local-6989586621680988685"><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988685"><span class="hs-identifier hs-var">lts1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680988686"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988686"><span class="hs-identifier hs-var">e1'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
</span><a href="#local-6989586621680988639"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988682"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-1380"></span><span>             </span><span id="local-6989586621680988687"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988687"><span class="hs-identifier hs-var">e2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988633"><span class="hs-identifier hs-var">gocap</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988683"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-1381"></span><span>             </span><span id="local-6989586621680988688"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988688"><span class="hs-identifier hs-var">e3'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988633"><span class="hs-identifier hs-var">gocap</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988684"><span class="hs-identifier hs-var">e3</span></a></span><span>
</span><span id="line-1382"></span><span>             </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988685"><span class="hs-identifier hs-var">lts1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0 -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-var">IfE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988686"><span class="hs-identifier hs-var">e1'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988687"><span class="hs-identifier hs-var">e2'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988688"><span class="hs-identifier hs-var">e3'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1383"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-type">ProjE</span></a></span><span> </span><span id="local-6989586621680988689"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680988689"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680988690"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988690"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680988691"><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988691"><span class="hs-identifier hs-var">lts</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988692"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988692"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
</span><a href="#local-6989586621680988639"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988690"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1384"></span><span>                           </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988691"><span class="hs-identifier hs-var">lts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Int -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-var">ProjE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680988689"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988692"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1385"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-type">MkProdE</span></a></span><span> </span><span id="local-6989586621680988693"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988693"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680988694"><span class="annot"><span class="annottext">[[(Var, [Ty0], Ty0, Exp0)]]
</span><a href="#local-6989586621680988694"><span class="hs-identifier hs-var">ltss</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988695"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988695"><span class="hs-identifier hs-var">es'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[([(Var, [Ty0], Ty0, Exp0)], Exp0)]
-&gt; ([[(Var, [Ty0], Ty0, Exp0)]], [Exp0])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">([([(Var, [Ty0], Ty0, Exp0)], Exp0)]
 -&gt; ([[(Var, [Ty0], Ty0, Exp0)]], [Exp0]))
-&gt; PassM [([(Var, [Ty0], Ty0, Exp0)], Exp0)]
-&gt; PassM ([[(Var, [Ty0], Ty0, Exp0)]], [Exp0])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0))
-&gt; [Exp0] -&gt; PassM [([(Var, [Ty0], Ty0, Exp0)], Exp0)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
</span><a href="#local-6989586621680988639"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988693"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1386"></span><span>                           </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[(Var, [Ty0], Ty0, Exp0)]] -&gt; [(Var, [Ty0], Ty0, Exp0)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">[[(Var, [Ty0], Ty0, Exp0)]]
</span><a href="#local-6989586621680988694"><span class="hs-identifier hs-var">ltss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
[PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-var">MkProdE</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988695"><span class="hs-identifier hs-var">es'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1387"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-type">CaseE</span></a></span><span> </span><span id="local-6989586621680988696"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988696"><span class="hs-identifier hs-var">scrt</span></a></span></span><span> </span><span id="local-6989586621680988697"><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680988697"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680988698"><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988698"><span class="hs-identifier hs-var">lts</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988699"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988699"><span class="hs-identifier hs-var">scrt'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
</span><a href="#local-6989586621680988639"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988696"><span class="hs-identifier hs-var">scrt</span></a></span><span>
</span><span id="line-1388"></span><span>                              </span><span id="local-6989586621680988700"><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680988700"><span class="hs-identifier hs-var">ls'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(([Char], [(Var, Ty0)], Exp0)
 -&gt; PassM ([Char], [(Var, Ty0)], Exp0))
-&gt; [([Char], [(Var, Ty0)], Exp0)]
-&gt; PassM [([Char], [(Var, Ty0)], Exp0)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680988701"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680988701"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988702"><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988702"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988703"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988703"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680988701"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988702"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; ([Char], [(Var, Ty0)], Exp0))
-&gt; PassM Exp0 -&gt; PassM ([Char], [(Var, Ty0)], Exp0)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988633"><span class="hs-identifier hs-var">gocap</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988703"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680988697"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1389"></span><span>                              </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988698"><span class="hs-identifier hs-var">lts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [([Char], [(Var, Ty0)], Exp0)] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; [([Char], [(Var, loc)], PreExp ext loc dec)]
-&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-var">CaseE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988699"><span class="hs-identifier hs-var">scrt'</span></a></span><span> </span><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680988700"><span class="hs-identifier hs-var">ls'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1390"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-type">DataConE</span></a></span><span> </span><span id="local-6989586621680988704"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988704"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621680988705"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680988705"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621680988706"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988706"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680988707"><span class="annot"><span class="annottext">[[(Var, [Ty0], Ty0, Exp0)]]
</span><a href="#local-6989586621680988707"><span class="hs-identifier hs-var">ltss</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988708"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988708"><span class="hs-identifier hs-var">es'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[([(Var, [Ty0], Ty0, Exp0)], Exp0)]
-&gt; ([[(Var, [Ty0], Ty0, Exp0)]], [Exp0])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">([([(Var, [Ty0], Ty0, Exp0)], Exp0)]
 -&gt; ([[(Var, [Ty0], Ty0, Exp0)]], [Exp0]))
-&gt; PassM [([(Var, [Ty0], Ty0, Exp0)], Exp0)]
-&gt; PassM ([[(Var, [Ty0], Ty0, Exp0)]], [Exp0])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0))
-&gt; [Exp0] -&gt; PassM [([(Var, [Ty0], Ty0, Exp0)], Exp0)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
</span><a href="#local-6989586621680988639"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988706"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1391"></span><span>                                  </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[(Var, [Ty0], Ty0, Exp0)]] -&gt; [(Var, [Ty0], Ty0, Exp0)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">[[(Var, [Ty0], Ty0, Exp0)]]
</span><a href="#local-6989586621680988707"><span class="hs-identifier hs-var">ltss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; [Char] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
loc -&gt; [Char] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-var">DataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988704"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680988705"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988708"><span class="hs-identifier hs-var">es'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1392"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-type">SpawnE</span></a></span><span> </span><span id="local-6989586621680988709"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988709"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680988710"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988710"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span> </span><span id="local-6989586621680988711"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988711"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1393"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680988712"><span class="annot"><span class="annottext">[[(Var, [Ty0], Ty0, Exp0)]]
</span><a href="#local-6989586621680988712"><span class="hs-identifier hs-var">ltss</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988713"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988713"><span class="hs-identifier hs-var">args'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[([(Var, [Ty0], Ty0, Exp0)], Exp0)]
-&gt; ([[(Var, [Ty0], Ty0, Exp0)]], [Exp0])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">([([(Var, [Ty0], Ty0, Exp0)], Exp0)]
 -&gt; ([[(Var, [Ty0], Ty0, Exp0)]], [Exp0]))
-&gt; PassM [([(Var, [Ty0], Ty0, Exp0)], Exp0)]
-&gt; PassM ([[(Var, [Ty0], Ty0, Exp0)]], [Exp0])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0))
-&gt; [Exp0] -&gt; PassM [([(Var, [Ty0], Ty0, Exp0)], Exp0)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
</span><a href="#local-6989586621680988639"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988711"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1394"></span><span>          </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[(Var, [Ty0], Ty0, Exp0)]] -&gt; [(Var, [Ty0], Ty0, Exp0)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">[[(Var, [Ty0], Ty0, Exp0)]]
</span><a href="#local-6989586621680988712"><span class="hs-identifier hs-var">ltss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-var">SpawnE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988709"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988710"><span class="hs-identifier hs-var">tyapps</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988713"><span class="hs-identifier hs-var">args'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1395"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1396"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-type">WithArenaE</span></a></span><span> </span><span id="local-6989586621680988714"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988714"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680988715"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988715"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1397"></span><span>          </span><span id="local-6989586621680988716"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988716"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988633"><span class="hs-identifier hs-var">gocap</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988715"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1398"></span><span>          </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-var">WithArenaE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988714"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988716"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1399"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-type">TimeIt</span></a></span><span> </span><span id="local-6989586621680988717"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988717"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680988718"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988718"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621680988719"><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680988719"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680988720"><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988720"><span class="hs-identifier hs-var">lts</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988721"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988721"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
</span><a href="#local-6989586621680988639"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988717"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1400"></span><span>                             </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)], Exp0)
-&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988720"><span class="hs-identifier hs-var">lts</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Ty0 -&gt; IsBoxed -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec -&gt; dec -&gt; IsBoxed -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-var">TimeIt</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988721"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988718"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680988719"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1401"></span><span>
</span><span id="line-1402"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-1403"></span><span>
</span><span id="line-1404"></span><span class="annot"><span class="hs-comment">-- | Desugar parallel tuples to spawn's and sync's, and printPacked into function calls.</span></span><span>
</span><span id="line-1405"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#desugarL0"><span class="hs-identifier hs-type">desugarL0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Prog0"><span class="hs-identifier hs-type">Prog0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Prog0"><span class="hs-identifier hs-type">Prog0</span></a></span><span>
</span><span id="line-1406"></span><span id="desugarL0"><span class="annot"><span class="annottext">desugarL0 :: Prog0 -&gt; PassM Prog0
</span><a href="Gibbon.L0.Specialize2.html#desugarL0"><span class="hs-identifier hs-var hs-var">desugarL0</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span id="local-6989586621680988868"><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
</span><a href="#local-6989586621680988868"><span class="hs-identifier hs-var">ddefs</span></a></span></span><span> </span><span id="local-6989586621680988869"><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680988869"><span class="hs-identifier hs-var">fundefs'</span></a></span></span><span> </span><span id="local-6989586621680988870"><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
</span><a href="#local-6989586621680988870"><span class="hs-identifier hs-var">mainExp'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1407"></span><span>  </span><span class="hs-comment">-- (Prog ddefs' fundefs' mainExp') &lt;- addRepairFns prg</span><span>
</span><span id="line-1408"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680988871"><span class="annot"><span class="annottext">ddefs'' :: Map Var DDef0
</span><a href="#local-6989586621680988871"><span class="hs-identifier hs-var hs-var">ddefs''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DDef0 -&gt; DDef0) -&gt; Map Var DDef0 -&gt; Map Var DDef0
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#map"><span class="hs-identifier hs-var">M.map</span></a></span><span> </span><span class="annot"><span class="annottext">DDef0 -&gt; DDef0
</span><a href="#local-6989586621680988872"><span class="hs-identifier hs-var">desugar_tuples</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
Map Var DDef0
</span><a href="#local-6989586621680988868"><span class="hs-identifier hs-var">ddefs</span></a></span><span>
</span><span id="line-1409"></span><span>  </span><span id="local-6989586621680988873"><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680988873"><span class="hs-identifier hs-var">fundefs''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FunDef0 -&gt; PassM FunDef0) -&gt; FunDefs Exp0 -&gt; PassM (FunDefs Exp0)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; Map Var a -&gt; m (Map Var b)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680988874"><span class="annot"><span class="annottext">fn :: FunDef0
</span><a href="#local-6989586621680988874"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span class="hs-special">{</span><span id="local-6989586621680988875"><span class="annot"><span class="annottext">Exp0
funBody :: forall ex. FunDef ex -&gt; ex
funBody :: Exp0
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var hs-var">funBody</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988876"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988875"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Exp0 -&gt; (Exp0 -&gt; PassM FunDef0) -&gt; PassM FunDef0
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680988877"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988877"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FunDef0 -&gt; PassM FunDef0
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(FunDef0 -&gt; PassM FunDef0) -&gt; FunDef0 -&gt; PassM FunDef0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680988874"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">funBody :: Exp0
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988877"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680988869"><span class="hs-identifier hs-var">fundefs'</span></a></span><span>
</span><span id="line-1410"></span><span>  </span><span id="local-6989586621680988878"><span class="annot"><span class="annottext">Maybe (Exp0, Ty0)
</span><a href="#local-6989586621680988878"><span class="hs-identifier hs-var">mainExp''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
</span><a href="#local-6989586621680988870"><span class="hs-identifier hs-var">mainExp'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1411"></span><span>                </span><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp0, Ty0) -&gt; PassM (Maybe (Exp0, Ty0))
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Exp0, Ty0)
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1412"></span><span>                </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680988879"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988879"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988880"><span class="annot"><span class="annottext">TyOf Exp0
</span><a href="#local-6989586621680988880"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Exp0, Ty0) -&gt; Maybe (Exp0, Ty0)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">((Exp0, Ty0) -&gt; Maybe (Exp0, Ty0))
-&gt; (Exp0 -&gt; (Exp0, Ty0)) -&gt; Exp0 -&gt; Maybe (Exp0, Ty0)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><span class="annottext">TyOf Exp0
Ty0
</span><a href="#local-6989586621680988880"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Maybe (Exp0, Ty0))
-&gt; PassM Exp0 -&gt; PassM (Maybe (Exp0, Ty0))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988876"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988879"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1413"></span><span>  </span><span class="annot"><span class="annottext">Prog0 -&gt; PassM Prog0
</span><a href="Gibbon.L0.Specialize2.html#addRepairFns"><span class="hs-identifier hs-var">addRepairFns</span></a></span><span> </span><span class="annot"><span class="annottext">(Prog0 -&gt; PassM Prog0) -&gt; Prog0 -&gt; PassM Prog0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
-&gt; FunDefs Exp0 -&gt; Maybe (Exp0, TyOf Exp0) -&gt; Prog0
forall ex.
DDefs (TyOf ex) -&gt; FunDefs ex -&gt; Maybe (ex, TyOf ex) -&gt; Prog ex
</span><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-var">Prog</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
Map Var DDef0
</span><a href="#local-6989586621680988871"><span class="hs-identifier hs-var">ddefs''</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680988873"><span class="hs-identifier hs-var">fundefs''</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
Maybe (Exp0, Ty0)
</span><a href="#local-6989586621680988878"><span class="hs-identifier hs-var">mainExp''</span></a></span><span>
</span><span id="line-1414"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1415"></span><span>    </span><span id="local-6989586621680988886"><span class="annot"><span class="annottext">err1 :: [Char] -&gt; a
</span><a href="#local-6989586621680988886"><span class="hs-identifier hs-var hs-var">err1</span></a></span></span><span> </span><span id="local-6989586621680988887"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680988887"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; a
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; a) -&gt; [Char] -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;desugarL0: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680988887"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-1416"></span><span>
</span><span id="line-1417"></span><span>    </span><span class="annot"><a href="#local-6989586621680988872"><span class="hs-identifier hs-type">desugar_tuples</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#DDef0"><span class="hs-identifier hs-type">DDef0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#DDef0"><span class="hs-identifier hs-type">DDef0</span></a></span><span>
</span><span id="line-1418"></span><span>    </span><span id="local-6989586621680988872"><span class="annot"><span class="annottext">desugar_tuples :: DDef0 -&gt; DDef0
</span><a href="#local-6989586621680988872"><span class="hs-identifier hs-var hs-var">desugar_tuples</span></a></span></span><span> </span><span id="local-6989586621680988888"><span class="annot"><span class="annottext">d :: DDef0
</span><a href="#local-6989586621680988888"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Language.Syntax.html#DDef"><span class="hs-identifier hs-type">DDef</span></a></span><span class="hs-special">{</span><span id="local-6989586621680988889"><span class="annot"><span class="annottext">[([Char], [(IsBoxed, Ty0)])]
dataCons :: forall a. DDef a -&gt; [([Char], [(IsBoxed, a)])]
dataCons :: [([Char], [(IsBoxed, Ty0)])]
</span><a href="Gibbon.Language.Syntax.html#dataCons"><span class="hs-identifier hs-var hs-var">dataCons</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1419"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680988890"><span class="annot"><span class="annottext">dataCons' :: [([Char], [(IsBoxed, Ty0)])]
</span><a href="#local-6989586621680988890"><span class="hs-identifier hs-var hs-var">dataCons'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([Char], [(IsBoxed, Ty0)]) -&gt; ([Char], [(IsBoxed, Ty0)]))
-&gt; [([Char], [(IsBoxed, Ty0)])] -&gt; [([Char], [(IsBoxed, Ty0)])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([(IsBoxed, Ty0)] -&gt; [(IsBoxed, Ty0)])
-&gt; ([Char], [(IsBoxed, Ty0)]) -&gt; ([Char], [(IsBoxed, Ty0)])
forall b c a. (b -&gt; c) -&gt; (a, b) -&gt; (a, c)
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Bifunctor.html#second"><span class="hs-identifier hs-var">second</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((IsBoxed, Ty0) -&gt; [(IsBoxed, Ty0)])
-&gt; [(IsBoxed, Ty0)] -&gt; [(IsBoxed, Ty0)]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">(IsBoxed, Ty0) -&gt; [(IsBoxed, Ty0)]
forall t. (t, Ty0) -&gt; [(t, Ty0)]
</span><a href="#local-6989586621680988892"><span class="hs-identifier hs-var">goty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[([Char], [(IsBoxed, Ty0)])]
</span><a href="#local-6989586621680988889"><span class="hs-identifier hs-var">dataCons</span></a></span><span>
</span><span id="line-1420"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">DDef0
</span><a href="#local-6989586621680988888"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dataCons :: [([Char], [(IsBoxed, Ty0)])]
</span><a href="Gibbon.Language.Syntax.html#dataCons"><span class="hs-identifier hs-var">dataCons</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[([Char], [(IsBoxed, Ty0)])]
</span><a href="#local-6989586621680988890"><span class="hs-identifier hs-var">dataCons'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1421"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1422"></span><span>        </span><span id="local-6989586621680985979"><span class="annot"><a href="#local-6989586621680988892"><span class="hs-identifier hs-type">goty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680985979"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680985979"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-1423"></span><span>        </span><span id="local-6989586621680988892"><span class="annot"><span class="annottext">goty :: forall t. (t, Ty0) -&gt; [(t, Ty0)]
</span><a href="#local-6989586621680988892"><span class="hs-identifier hs-var hs-var">goty</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680988894"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680988894"><span class="hs-identifier hs-var">isBoxed</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680988895"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988895"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1424"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988895"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1425"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680988896"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988896"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; [(t, Ty0)]) -&gt; [Ty0] -&gt; [(t, Ty0)]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(t, Ty0) -&gt; [(t, Ty0)]
forall t. (t, Ty0) -&gt; [(t, Ty0)]
</span><a href="#local-6989586621680988892"><span class="hs-identifier hs-var">goty</span></a></span><span> </span><span class="annot"><span class="annottext">((t, Ty0) -&gt; [(t, Ty0)]) -&gt; (Ty0 -&gt; (t, Ty0)) -&gt; Ty0 -&gt; [(t, Ty0)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680988894"><span class="hs-identifier hs-var">isBoxed</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988896"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1426"></span><span>            </span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621680988894"><span class="hs-identifier hs-var">isBoxed</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988895"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1427"></span><span>
</span><span id="line-1428"></span><span>    </span><span class="annot"><a href="#local-6989586621680988876"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span>
</span><span id="line-1429"></span><span>    </span><span id="local-6989586621680988876"><span class="annot"><span class="annottext">go :: Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988876"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680988897"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988897"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1430"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988897"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1431"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988897"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1432"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-type">LitE</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988897"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1433"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CharE"><span class="hs-identifier hs-type">CharE</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988897"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1434"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-type">FloatE</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988897"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1435"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-type">LitSymE</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988897"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1436"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span id="local-6989586621680988898"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988898"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680988899"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988899"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span> </span><span id="local-6989586621680988900"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988900"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988898"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988899"><span class="hs-identifier hs-var">tyapps</span></a></span><span> </span><span class="annot"><span class="annottext">([Exp0] -&gt; Exp0) -&gt; PassM [Exp0] -&gt; PassM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; PassM Exp0) -&gt; [Exp0] -&gt; PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988876"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988900"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1437"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span id="local-6989586621680988901"><span class="annot"><span class="annottext">Prim Ty0
</span><a href="#local-6989586621680988901"><span class="hs-identifier hs-var">pr</span></a></span></span><span> </span><span id="local-6989586621680988902"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988902"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1438"></span><span>          </span><span class="hs-comment">-- This is always going to have a function reference which</span><span>
</span><span id="line-1439"></span><span>          </span><span class="hs-comment">-- we cannot eliminate.</span><span>
</span><span id="line-1440"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680988903"><span class="annot"><span class="annottext">args' :: [Exp0]
</span><a href="#local-6989586621680988903"><span class="hs-identifier hs-var hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1441"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Prim Ty0
</span><a href="#local-6989586621680988901"><span class="hs-identifier hs-var">pr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1442"></span><span>                  </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VSortP"><span class="hs-identifier hs-type">VSortP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1443"></span><span>                    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988902"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1444"></span><span>                      </span><span class="hs-special">[</span><span id="local-6989586621680988904"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988904"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunRefE"><span class="hs-identifier hs-type">FunRefE</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680988905"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988905"><span class="hs-identifier hs-var">fp</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988904"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988905"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1445"></span><span>                      </span><span class="hs-special">[</span><span id="local-6989586621680988906"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988906"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">Loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunRefE"><span class="hs-identifier hs-type">FunRefE</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680988907"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988907"><span class="hs-identifier hs-var">fp</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988906"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988907"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1446"></span><span>                      </span><span class="annot"><span class="annottext">[Exp0]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Exp0]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Exp0]) -&gt; [Char] -&gt; [Exp0]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;desugarL0: vsort&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988897"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1447"></span><span>                  </span><span class="annot"><a href="Gibbon.Language.Syntax.html#InplaceVSortP"><span class="hs-identifier hs-type">InplaceVSortP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1448"></span><span>                    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988902"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1449"></span><span>                      </span><span class="hs-special">[</span><span id="local-6989586621680988909"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988909"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunRefE"><span class="hs-identifier hs-type">FunRefE</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680988910"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988910"><span class="hs-identifier hs-var">fp</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988909"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988910"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1450"></span><span>                      </span><span class="hs-special">[</span><span id="local-6989586621680988911"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988911"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span class="annot"><span class="annottext">Loc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunRefE"><span class="hs-identifier hs-type">FunRefE</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680988912"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988912"><span class="hs-identifier hs-var">fp</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988911"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988912"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1451"></span><span>                      </span><span class="annot"><span class="annottext">[Exp0]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Exp0]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Exp0]) -&gt; [Char] -&gt; [Exp0]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;desugarL0: vsort&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988897"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1452"></span><span>                  </span><span class="annot"><span class="annottext">Prim Ty0
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988902"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1453"></span><span>          </span><span id="local-6989586621680988913"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988913"><span class="hs-identifier hs-var">args''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; PassM Exp0) -&gt; [Exp0] -&gt; PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988876"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988903"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-1454"></span><span>          </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; PassM Exp0) -&gt; Exp0 -&gt; PassM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0 -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0
</span><a href="#local-6989586621680988901"><span class="hs-identifier hs-var">pr</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988913"><span class="hs-identifier hs-var">args''</span></a></span><span>
</span><span id="line-1455"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680988914"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988914"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988915"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988915"><span class="hs-identifier hs-var">_tyapps</span></a></span></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680988916"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988916"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#ParE0"><span class="hs-identifier hs-type">ParE0</span></a></span><span> </span><span id="local-6989586621680988917"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988917"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621680988918"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988918"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1456"></span><span>          </span><span id="local-6989586621680988919"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988919"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; PassM Var) -&gt; [Exp0] -&gt; PassM [Var]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Exp0
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;par_&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988917"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1457"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680988920"><span class="annot"><span class="annottext">xs :: [(Var, Ty0, Exp0)]
</span><a href="#local-6989586621680988920"><span class="hs-identifier hs-var hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; [Ty0] -&gt; [Exp0] -&gt; [(Var, Ty0, Exp0)]
forall a b c. [a] -&gt; [b] -&gt; [c] -&gt; [(a, b, c)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip3"><span class="hs-identifier hs-var">zip3</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988919"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988916"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988917"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1458"></span><span>              </span><span id="local-6989586621680988921"><span class="annot"><span class="annottext">spawns :: [(Var, Ty0, Exp0)]
</span><a href="#local-6989586621680988921"><span class="hs-identifier hs-var hs-var">spawns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0, Exp0)] -&gt; [(Var, Ty0, Exp0)]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#init"><span class="hs-identifier hs-var">init</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0, Exp0)]
</span><a href="#local-6989586621680988920"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1459"></span><span>              </span><span class="hs-special">(</span><span id="local-6989586621680988923"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988923"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988924"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988924"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988925"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988925"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0, Exp0)] -&gt; (Var, Ty0, Exp0)
forall a. HasCallStack =&gt; [a] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#last"><span class="hs-identifier hs-var">last</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0, Exp0)]
</span><a href="#local-6989586621680988920"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1460"></span><span>              </span><span id="local-6989586621680988927"><span class="annot"><span class="annottext">ls' :: [(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988927"><span class="hs-identifier hs-var hs-var">ls'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Var, Ty0, Exp0)
 -&gt; [(Var, [Ty0], Ty0, Exp0)] -&gt; [(Var, [Ty0], Ty0, Exp0)])
-&gt; [(Var, [Ty0], Ty0, Exp0)]
-&gt; [(Var, Ty0, Exp0)]
-&gt; [(Var, [Ty0], Ty0, Exp0)]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span>
</span><span id="line-1461"></span><span>                      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680988928"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988928"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988929"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988929"><span class="hs-identifier hs-var">ty1</span></a></span></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span id="local-6989586621680988930"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988930"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621680988931"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988931"><span class="hs-identifier hs-var">tyapps1</span></a></span></span><span> </span><span id="local-6989586621680988932"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988932"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621680988933"><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988933"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1462"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988928"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988929"><span class="hs-identifier hs-var">ty1</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-var">SpawnE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988930"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988931"><span class="hs-identifier hs-var">tyapps1</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988932"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0)
-&gt; [(Var, [Ty0], Ty0, Exp0)] -&gt; [(Var, [Ty0], Ty0, Exp0)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988933"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1463"></span><span>                      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1464"></span><span>                      </span><span class="annot"><span class="annottext">[(Var, Ty0, Exp0)]
</span><a href="#local-6989586621680988921"><span class="hs-identifier hs-var">spawns</span></a></span><span>
</span><span id="line-1465"></span><span>              </span><span id="local-6989586621680988934"><span class="annot"><span class="annottext">ls'' :: [(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988934"><span class="hs-identifier hs-var hs-var">ls''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988927"><span class="hs-identifier hs-var">ls'</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
-&gt; [(Var, [Ty0], Ty0, Exp0)] -&gt; [(Var, [Ty0], Ty0, Exp0)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988923"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988924"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988925"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1466"></span><span>          </span><span id="local-6989586621680988935"><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988935"><span class="hs-identifier hs-var">ls'''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((Var, [Ty0], Ty0, Exp0) -&gt; PassM (Var, [Ty0], Ty0, Exp0))
-&gt; [(Var, [Ty0], Ty0, Exp0)] -&gt; PassM [(Var, [Ty0], Ty0, Exp0)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680988936"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988936"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988937"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988937"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988938"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988938"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988939"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988939"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988936"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988937"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988938"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; (Var, [Ty0], Ty0, Exp0))
-&gt; PassM Exp0 -&gt; PassM (Var, [Ty0], Ty0, Exp0)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988876"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988939"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988934"><span class="hs-identifier hs-var">ls''</span></a></span><span>
</span><span id="line-1467"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680988940"><span class="annot"><span class="annottext">binds :: [(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988940"><span class="hs-identifier hs-var hs-var">binds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988935"><span class="hs-identifier hs-var">ls'''</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
-&gt; [(Var, [Ty0], Ty0, Exp0)] -&gt; [(Var, [Ty0], Ty0, Exp0)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;_&quot;</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1468"></span><span>              </span><span id="local-6989586621680988941"><span class="annot"><span class="annottext">bod' :: Exp0
</span><a href="#local-6989586621680988941"><span class="hs-identifier hs-var hs-var">bod'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(((Var, [Ty0], Ty0, Exp0), Int) -&gt; Exp0 -&gt; Exp0)
-&gt; Exp0 -&gt; [((Var, [Ty0], Ty0, Exp0), Int)] -&gt; Exp0
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621680988942"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988942"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp0
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621680988943"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680988943"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680988944"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988944"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1469"></span><span>                                </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0 -&gt; Exp0 -&gt; Exp0
forall e. Substitutable e =&gt; e -&gt; e -&gt; e -&gt; e
</span><a href="Gibbon.Language.Syntax.html#gSubstE"><span class="hs-identifier hs-var">gSubstE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Int -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-var">ProjE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680988943"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988914"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988942"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988944"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1470"></span><span>                           </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988918"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-1471"></span><span>                           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
-&gt; [Int] -&gt; [((Var, [Ty0], Ty0, Exp0), Int)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988935"><span class="hs-identifier hs-var">ls'''</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1472"></span><span>          </span><span id="local-6989586621680988946"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988946"><span class="hs-identifier hs-var">bod''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988876"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988941"><span class="hs-identifier hs-var">bod'</span></a></span><span>
</span><span id="line-1473"></span><span>          </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; PassM Exp0) -&gt; Exp0 -&gt; PassM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>  </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)] -&gt; Exp0 -&gt; Exp0
forall loc dec (ext :: * -&gt; * -&gt; *).
[(Var, [loc], dec, PreExp ext loc dec)]
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.html#mkLets"><span class="hs-identifier hs-var">mkLets</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680988940"><span class="hs-identifier hs-var">binds</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988946"><span class="hs-identifier hs-var">bod''</span></a></span><span>
</span><span id="line-1474"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680988947"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988947"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988948"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988948"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988949"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988949"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988950"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988950"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680988951"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988951"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0) -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="annot"><span class="annottext">((Var, [Ty0], Ty0, Exp0) -&gt; Exp0 -&gt; Exp0)
-&gt; (Exp0 -&gt; (Var, [Ty0], Ty0, Exp0)) -&gt; Exp0 -&gt; Exp0 -&gt; Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988947"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988948"><span class="hs-identifier hs-var">tyapps</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988949"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0 -&gt; Exp0) -&gt; PassM Exp0 -&gt; PassM (Exp0 -&gt; Exp0)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988876"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988950"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">PassM (Exp0 -&gt; Exp0) -&gt; PassM Exp0 -&gt; PassM Exp0
forall a b. PassM (a -&gt; b) -&gt; PassM a -&gt; PassM b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988876"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988951"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-1475"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-type">IfE</span></a></span><span> </span><span id="local-6989586621680988952"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988952"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680988953"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988953"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680988954"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988954"><span class="hs-identifier hs-var">c</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0 -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-var">IfE</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0 -&gt; Exp0 -&gt; Exp0)
-&gt; PassM Exp0 -&gt; PassM (Exp0 -&gt; Exp0 -&gt; Exp0)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988876"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988952"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">PassM (Exp0 -&gt; Exp0 -&gt; Exp0) -&gt; PassM Exp0 -&gt; PassM (Exp0 -&gt; Exp0)
forall a b. PassM (a -&gt; b) -&gt; PassM a -&gt; PassM b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988876"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988953"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">PassM (Exp0 -&gt; Exp0) -&gt; PassM Exp0 -&gt; PassM Exp0
forall a b. PassM (a -&gt; b) -&gt; PassM a -&gt; PassM b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988876"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988954"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-1476"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-type">MkProdE</span></a></span><span> </span><span id="local-6989586621680988955"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988955"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
[PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-var">MkProdE</span></a></span><span> </span><span class="annot"><span class="annottext">([Exp0] -&gt; Exp0) -&gt; PassM [Exp0] -&gt; PassM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; PassM Exp0) -&gt; [Exp0] -&gt; PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988876"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988955"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1477"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-type">ProjE</span></a></span><span> </span><span id="local-6989586621680988956"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680988956"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680988957"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988957"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Int -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-var">ProjE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680988956"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0) -&gt; PassM Exp0 -&gt; PassM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988876"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988957"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1478"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-type">CaseE</span></a></span><span> </span><span id="local-6989586621680988958"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988958"><span class="hs-identifier hs-var">scrt</span></a></span></span><span> </span><span id="local-6989586621680988959"><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680988959"><span class="hs-identifier hs-var">brs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1479"></span><span>          </span><span id="local-6989586621680988960"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988960"><span class="hs-identifier hs-var">scrt'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988876"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988958"><span class="hs-identifier hs-var">scrt</span></a></span><span>
</span><span id="line-1480"></span><span>          </span><span id="local-6989586621680988961"><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680988961"><span class="hs-identifier hs-var">brs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(([Char], [(Var, Ty0)], Exp0)
 -&gt; PassM ([Char], [(Var, Ty0)], Exp0))
-&gt; [([Char], [(Var, Ty0)], Exp0)]
-&gt; PassM [([Char], [(Var, Ty0)], Exp0)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680988962"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680988962"><span class="hs-identifier hs-var">dcon</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988963"><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988963"><span class="hs-identifier hs-var">vtys</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988964"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988964"><span class="hs-identifier hs-var">bod</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1481"></span><span>                          </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680988965"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988965"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988966"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988966"><span class="hs-identifier hs-var">_tyapps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)] -&gt; ([Var], [Ty0])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988963"><span class="hs-identifier hs-var">vtys</span></a></span><span>
</span><span id="line-1482"></span><span>                          </span><span id="local-6989586621680988967"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988967"><span class="hs-identifier hs-var">bod'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988876"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988964"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-1483"></span><span>                          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680988968"><span class="annot"><span class="annottext">dcon_tys :: [Ty0]
</span><a href="#local-6989586621680988968"><span class="hs-identifier hs-var hs-var">dcon_tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; [Char] -&gt; [Ty0]
forall a. Out a =&gt; DDefs a -&gt; [Char] -&gt; [a]
</span><a href="Gibbon.Language.Syntax.html#lookupDataCon"><span class="hs-identifier hs-var">lookupDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
Map Var DDef0
</span><a href="#local-6989586621680988868"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680988962"><span class="hs-identifier hs-var">dcon</span></a></span><span>
</span><span id="line-1484"></span><span>                              </span><span class="annot"><a href="#local-6989586621680988970"><span class="hs-identifier hs-type">flattenTupleArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1485"></span><span>                              </span><span id="local-6989586621680988970"><span class="annot"><span class="annottext">flattenTupleArgs :: (Var, Ty0) -&gt; ([Var], Exp0) -&gt; PassM ([Var], Exp0)
</span><a href="#local-6989586621680988970"><span class="hs-identifier hs-var hs-var">flattenTupleArgs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680988971"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988971"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680988972"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988972"><span class="hs-identifier hs-var">vty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680988973"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988973"><span class="hs-identifier hs-var">vs0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680988974"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988974"><span class="hs-identifier hs-var">bod0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1486"></span><span>                                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988972"><span class="hs-identifier hs-var">vty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1487"></span><span>                                  </span><span class="annot"><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680988975"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988975"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1488"></span><span>                                    </span><span class="hs-comment">-- create projection variables: v = (y1, y2, ...)</span><span>
</span><span id="line-1489"></span><span>                                    </span><span id="local-6989586621680988976"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988976"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; PassM Var) -&gt; [Ty0] -&gt; PassM [Var]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;y&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988975"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1490"></span><span>                                    </span><span class="hs-comment">-- substitute projections in body with new variable: yi = ProjE i v</span><span>
</span><span id="line-1491"></span><span>                                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680988977"><span class="annot"><span class="annottext">bod1 :: Exp0
</span><a href="#local-6989586621680988977"><span class="hs-identifier hs-var hs-var">bod1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, Var) -&gt; Exp0 -&gt; Exp0) -&gt; Exp0 -&gt; [(Int, Var)] -&gt; Exp0
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680988978"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680988978"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680988979"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988979"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680988980"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988980"><span class="hs-identifier hs-var">bod1'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0 -&gt; Exp0 -&gt; Exp0
forall e. Substitutable e =&gt; e -&gt; e -&gt; e -&gt; e
</span><a href="Gibbon.Language.Syntax.html#gSubstE"><span class="hs-identifier hs-var">gSubstE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Int -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-var">ProjE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680988978"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988971"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988979"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988980"><span class="hs-identifier hs-var">bod1'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988974"><span class="hs-identifier hs-var">bod0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; [Var] -&gt; [(Int, Var)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988976"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1492"></span><span>                                    </span><span class="hs-comment">-- substitute whole variable v with product: v = MkProdE (y1, y2, ...)</span><span>
</span><span id="line-1493"></span><span>                                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680988981"><span class="annot"><span class="annottext">bod2 :: Exp0
</span><a href="#local-6989586621680988981"><span class="hs-identifier hs-var hs-var">bod2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0 -&gt; Exp0 -&gt; Exp0
forall e. Substitutable e =&gt; e -&gt; e -&gt; e -&gt; e
</span><a href="Gibbon.Language.Syntax.html#gSubstE"><span class="hs-identifier hs-var">gSubstE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988971"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
[PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-var">MkProdE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var -&gt; Exp0) -&gt; [Var] -&gt; [Exp0]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988976"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988977"><span class="hs-identifier hs-var">bod1</span></a></span><span>
</span><span id="line-1494"></span><span>                                    </span><span class="hs-comment">-- flatten each of yis</span><span>
</span><span id="line-1495"></span><span>                                    </span><span class="hs-special">(</span><span id="local-6989586621680988982"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988982"><span class="hs-identifier hs-var">ys'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680988983"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988983"><span class="hs-identifier hs-var">bod3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((Var, Ty0) -&gt; ([Var], Exp0) -&gt; PassM ([Var], Exp0))
-&gt; ([Var], Exp0) -&gt; [(Var, Ty0)] -&gt; PassM ([Var], Exp0)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; b -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldrM"><span class="hs-identifier hs-var">foldrM</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty0) -&gt; ([Var], Exp0) -&gt; PassM ([Var], Exp0)
</span><a href="#local-6989586621680988970"><span class="hs-identifier hs-var">flattenTupleArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988973"><span class="hs-identifier hs-var">vs0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988981"><span class="hs-identifier hs-var">bod2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; [Ty0] -&gt; [(Var, Ty0)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988976"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988975"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1496"></span><span>                                    </span><span class="annot"><span class="annottext">([Var], Exp0) -&gt; PassM ([Var], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988982"><span class="hs-identifier hs-var">ys'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988983"><span class="hs-identifier hs-var">bod3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1497"></span><span>                                  </span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([Var], Exp0) -&gt; PassM ([Var], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680988971"><span class="hs-identifier hs-var">v</span></a></span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Var]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988973"><span class="hs-identifier hs-var">vs0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988974"><span class="hs-identifier hs-var">bod0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1498"></span><span>
</span><span id="line-1499"></span><span>                          </span><span class="hs-special">(</span><span id="local-6989586621680988984"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988984"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680988985"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988985"><span class="hs-identifier hs-var">bod''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((Var, Ty0) -&gt; ([Var], Exp0) -&gt; PassM ([Var], Exp0))
-&gt; ([Var], Exp0) -&gt; [(Var, Ty0)] -&gt; PassM ([Var], Exp0)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; b -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldrM"><span class="hs-identifier hs-var">foldrM</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty0) -&gt; ([Var], Exp0) -&gt; PassM ([Var], Exp0)
</span><a href="#local-6989586621680988970"><span class="hs-identifier hs-var">flattenTupleArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988967"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; [Ty0] -&gt; [(Var, Ty0)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988965"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988968"><span class="hs-identifier hs-var">dcon_tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1500"></span><span>                          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680988986"><span class="annot"><span class="annottext">vtys' :: [(Var, Ty0)]
</span><a href="#local-6989586621680988986"><span class="hs-identifier hs-var hs-var">vtys'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Ty0] -&gt; [(Var, Ty0)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680988984"><span class="hs-identifier hs-var">xs'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; [Ty0]
forall a. a -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#repeat"><span class="hs-identifier hs-var">repeat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1501"></span><span>                          </span><span class="annot"><span class="annottext">([Char], [(Var, Ty0)], Exp0) -&gt; PassM ([Char], [(Var, Ty0)], Exp0)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680988962"><span class="hs-identifier hs-var">dcon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680988986"><span class="hs-identifier hs-var">vtys'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988985"><span class="hs-identifier hs-var">bod''</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1502"></span><span>                       </span><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680988959"><span class="hs-identifier hs-var">brs</span></a></span><span>
</span><span id="line-1503"></span><span>          </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; PassM Exp0) -&gt; Exp0 -&gt; PassM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [([Char], [(Var, Ty0)], Exp0)] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; [([Char], [(Var, loc)], PreExp ext loc dec)]
-&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-var">CaseE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988960"><span class="hs-identifier hs-var">scrt'</span></a></span><span> </span><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680988961"><span class="hs-identifier hs-var">brs'</span></a></span><span>
</span><span id="line-1504"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-type">DataConE</span></a></span><span> </span><span id="local-6989586621680988988"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988988"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680988989"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680988989"><span class="hs-identifier hs-var">dcon</span></a></span></span><span> </span><span id="local-6989586621680988990"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988990"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1505"></span><span>          </span><span id="local-6989586621680988991"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988991"><span class="hs-identifier hs-var">ls'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; PassM Exp0) -&gt; [Exp0] -&gt; PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988876"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988990"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1506"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680988992"><span class="annot"><span class="annottext">tys :: [Ty0]
</span><a href="#local-6989586621680988992"><span class="hs-identifier hs-var hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; [Char] -&gt; [Ty0]
forall a. Out a =&gt; DDefs a -&gt; [Char] -&gt; [a]
</span><a href="Gibbon.Language.Syntax.html#lookupDataCon"><span class="hs-identifier hs-var">lookupDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
Map Var DDef0
</span><a href="#local-6989586621680988868"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680988989"><span class="hs-identifier hs-var">dcon</span></a></span><span>
</span><span id="line-1507"></span><span>              </span><span id="local-6989586621680985989"><span class="annot"><a href="#local-6989586621680988993"><span class="hs-identifier hs-type">flattenTupleArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680985989"><span class="hs-identifier hs-type">loc</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-1508"></span><span>              </span><span id="local-6989586621680988993"><span class="annot"><span class="annottext">flattenTupleArgs :: forall loc.
Exp0 -&gt; Ty0 -&gt; PassM ([(Var, [loc], Ty0, Exp0)], [Exp0])
</span><a href="#local-6989586621680988993"><span class="hs-identifier hs-var hs-var">flattenTupleArgs</span></a></span></span><span> </span><span id="local-6989586621680989017"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989017"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621680989018"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989018"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989018"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1509"></span><span>                </span><span class="annot"><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680989019"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680989019"><span class="hs-identifier hs-var">tys'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1510"></span><span>                  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989017"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1511"></span><span>                    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-type">MkProdE</span></a></span><span> </span><span id="local-6989586621680989020"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680989020"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1512"></span><span>                      </span><span class="hs-special">(</span><span id="local-6989586621680989021"><span class="annot"><span class="annottext">[[(Var, [loc], Ty0, Exp0)]]
</span><a href="#local-6989586621680989021"><span class="hs-identifier hs-var">bnds'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680989022"><span class="annot"><span class="annottext">[[Exp0]]
</span><a href="#local-6989586621680989022"><span class="hs-identifier hs-var">args'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[([(Var, [loc], Ty0, Exp0)], [Exp0])]
-&gt; ([[(Var, [loc], Ty0, Exp0)]], [[Exp0]])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">([([(Var, [loc], Ty0, Exp0)], [Exp0])]
 -&gt; ([[(Var, [loc], Ty0, Exp0)]], [[Exp0]]))
-&gt; PassM [([(Var, [loc], Ty0, Exp0)], [Exp0])]
-&gt; PassM ([[(Var, [loc], Ty0, Exp0)]], [[Exp0]])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Ty0 -&gt; PassM ([(Var, [loc], Ty0, Exp0)], [Exp0]))
-&gt; [Exp0] -&gt; [Ty0] -&gt; PassM [([(Var, [loc], Ty0, Exp0)], [Exp0])]
forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; b -&gt; m c) -&gt; [a] -&gt; [b] -&gt; m [c]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Control.Monad.html#zipWithM"><span class="hs-identifier hs-var">zipWithM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Ty0 -&gt; PassM ([(Var, [loc], Ty0, Exp0)], [Exp0])
forall loc.
Exp0 -&gt; Ty0 -&gt; PassM ([(Var, [loc], Ty0, Exp0)], [Exp0])
</span><a href="#local-6989586621680988993"><span class="hs-identifier hs-var">flattenTupleArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680989020"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680989019"><span class="hs-identifier hs-var">tys'</span></a></span><span>
</span><span id="line-1513"></span><span>                      </span><span class="annot"><span class="annottext">([(Var, [loc], Ty0, Exp0)], [Exp0])
-&gt; PassM ([(Var, [loc], Ty0, Exp0)], [Exp0])
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[(Var, [loc], Ty0, Exp0)]] -&gt; [(Var, [loc], Ty0, Exp0)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">[[(Var, [loc], Ty0, Exp0)]]
</span><a href="#local-6989586621680989021"><span class="hs-identifier hs-var">bnds'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[[Exp0]] -&gt; [Exp0]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">[[Exp0]]
</span><a href="#local-6989586621680989022"><span class="hs-identifier hs-var">args'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1514"></span><span>                    </span><span class="annot"><span class="annottext">Exp0
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1515"></span><span>                        </span><span class="hs-comment">-- generating alias so that repeated expression is</span><span>
</span><span id="line-1516"></span><span>                        </span><span class="hs-comment">-- eliminated and we are taking projection of trivial varEs</span><span>
</span><span id="line-1517"></span><span>                        </span><span id="local-6989586621680989024"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989024"><span class="hs-identifier hs-var">argalias</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;alias&quot;</span></span><span>
</span><span id="line-1518"></span><span>                        </span><span id="local-6989586621680989025"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989025"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; PassM Var) -&gt; [Ty0] -&gt; PassM [Var]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;proj&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680989019"><span class="hs-identifier hs-var">tys'</span></a></span><span>
</span><span id="line-1519"></span><span>                        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680989026"><span class="annot"><span class="annottext">vs :: [Exp0]
</span><a href="#local-6989586621680989026"><span class="hs-identifier hs-var hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; Exp0) -&gt; [Var] -&gt; [Exp0]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989025"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-1520"></span><span>                        </span><span class="hs-special">(</span><span id="local-6989586621680989027"><span class="annot"><span class="annottext">[[(Var, [loc], Ty0, Exp0)]]
</span><a href="#local-6989586621680989027"><span class="hs-identifier hs-var">bnds'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680989028"><span class="annot"><span class="annottext">[[Exp0]]
</span><a href="#local-6989586621680989028"><span class="hs-identifier hs-var">args'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-1521"></span><span>                          </span><span class="annot"><span class="annottext">[([(Var, [loc], Ty0, Exp0)], [Exp0])]
-&gt; ([[(Var, [loc], Ty0, Exp0)]], [[Exp0]])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">([([(Var, [loc], Ty0, Exp0)], [Exp0])]
 -&gt; ([[(Var, [loc], Ty0, Exp0)]], [[Exp0]]))
-&gt; PassM [([(Var, [loc], Ty0, Exp0)], [Exp0])]
-&gt; PassM ([[(Var, [loc], Ty0, Exp0)]], [[Exp0]])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Ty0 -&gt; PassM ([(Var, [loc], Ty0, Exp0)], [Exp0]))
-&gt; [Exp0] -&gt; [Ty0] -&gt; PassM [([(Var, [loc], Ty0, Exp0)], [Exp0])]
forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; b -&gt; m c) -&gt; [a] -&gt; [b] -&gt; m [c]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Control.Monad.html#zipWithM"><span class="hs-identifier hs-var">zipWithM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Ty0 -&gt; PassM ([(Var, [loc], Ty0, Exp0)], [Exp0])
forall loc.
Exp0 -&gt; Ty0 -&gt; PassM ([(Var, [loc], Ty0, Exp0)], [Exp0])
</span><a href="#local-6989586621680988993"><span class="hs-identifier hs-var">flattenTupleArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680989026"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680989019"><span class="hs-identifier hs-var">tys'</span></a></span><span>
</span><span id="line-1522"></span><span>                        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680989029"><span class="annot"><span class="annottext">bnds'' :: [(Var, [loc], Ty0, Exp0)]
</span><a href="#local-6989586621680989029"><span class="hs-identifier hs-var hs-var">bnds''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1523"></span><span>                              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989024"><span class="hs-identifier hs-var">argalias</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989018"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989017"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Var, [loc], Ty0, Exp0)
-&gt; [(Var, [loc], Ty0, Exp0)] -&gt; [(Var, [loc], Ty0, Exp0)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span>
</span><span id="line-1524"></span><span>                              </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989030"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989031"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Int -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-var">ProjE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680989032"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989024"><span class="hs-identifier hs-var">argalias</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1525"></span><span>                              </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680989030"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989030"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680989031"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989031"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680989032"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680989032"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Ty0] -&gt; [Int] -&gt; [(Var, Ty0, Int)]
forall a b c. [a] -&gt; [b] -&gt; [c] -&gt; [(a, b, c)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip3"><span class="hs-identifier hs-var">zip3</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989025"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680989019"><span class="hs-identifier hs-var">tys'</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-1526"></span><span>                              </span><span class="hs-special">]</span><span>
</span><span id="line-1527"></span><span>                        </span><span class="annot"><span class="annottext">([(Var, [loc], Ty0, Exp0)], [Exp0])
-&gt; PassM ([(Var, [loc], Ty0, Exp0)], [Exp0])
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, [loc], Ty0, Exp0)]
</span><a href="#local-6989586621680989029"><span class="hs-identifier hs-var">bnds''</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [loc], Ty0, Exp0)]
-&gt; [(Var, [loc], Ty0, Exp0)] -&gt; [(Var, [loc], Ty0, Exp0)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[[(Var, [loc], Ty0, Exp0)]] -&gt; [(Var, [loc], Ty0, Exp0)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">[[(Var, [loc], Ty0, Exp0)]]
</span><a href="#local-6989586621680989027"><span class="hs-identifier hs-var">bnds'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[Exp0]] -&gt; [Exp0]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">[[Exp0]]
</span><a href="#local-6989586621680989028"><span class="hs-identifier hs-var">args'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1528"></span><span>                </span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1529"></span><span>                  </span><span class="annot"><span class="annottext">([(Var, [loc], Ty0, Exp0)], [Exp0])
-&gt; PassM ([(Var, [loc], Ty0, Exp0)], [Exp0])
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989017"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1530"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680989033"><span class="annot"><span class="annottext">[[(Var, [Ty0], Ty0, Exp0)]]
</span><a href="#local-6989586621680989033"><span class="hs-identifier hs-var">binds</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680989034"><span class="annot"><span class="annottext">[[Exp0]]
</span><a href="#local-6989586621680989034"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[([(Var, [Ty0], Ty0, Exp0)], [Exp0])]
-&gt; ([[(Var, [Ty0], Ty0, Exp0)]], [[Exp0]])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">([([(Var, [Ty0], Ty0, Exp0)], [Exp0])]
 -&gt; ([[(Var, [Ty0], Ty0, Exp0)]], [[Exp0]]))
-&gt; PassM [([(Var, [Ty0], Ty0, Exp0)], [Exp0])]
-&gt; PassM ([[(Var, [Ty0], Ty0, Exp0)]], [[Exp0]])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Ty0 -&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], [Exp0]))
-&gt; [Exp0] -&gt; [Ty0] -&gt; PassM [([(Var, [Ty0], Ty0, Exp0)], [Exp0])]
forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; b -&gt; m c) -&gt; [a] -&gt; [b] -&gt; m [c]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Control.Monad.html#zipWithM"><span class="hs-identifier hs-var">zipWithM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Ty0 -&gt; PassM ([(Var, [Ty0], Ty0, Exp0)], [Exp0])
forall loc.
Exp0 -&gt; Ty0 -&gt; PassM ([(Var, [loc], Ty0, Exp0)], [Exp0])
</span><a href="#local-6989586621680988993"><span class="hs-identifier hs-var">flattenTupleArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680988991"><span class="hs-identifier hs-var">ls'</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680988992"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1531"></span><span>          </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; PassM Exp0) -&gt; Exp0 -&gt; PassM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)] -&gt; Exp0 -&gt; Exp0
forall loc dec (ext :: * -&gt; * -&gt; *).
[(Var, [loc], dec, PreExp ext loc dec)]
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.html#mkLets"><span class="hs-identifier hs-var">mkLets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[(Var, [Ty0], Ty0, Exp0)]] -&gt; [(Var, [Ty0], Ty0, Exp0)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">[[(Var, [Ty0], Ty0, Exp0)]]
</span><a href="#local-6989586621680989033"><span class="hs-identifier hs-var">binds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0) -&gt; Exp0 -&gt; Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; [Char] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
loc -&gt; [Char] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-var">DataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680988988"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680988989"><span class="hs-identifier hs-var">dcon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Exp0]] -&gt; [Exp0]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">[[Exp0]]
</span><a href="#local-6989586621680989034"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1532"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-type">TimeIt</span></a></span><span> </span><span id="local-6989586621680989035"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989035"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680989036"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989036"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680989037"><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680989037"><span class="hs-identifier hs-var">b</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680989038"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989038"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Ty0 -&gt; IsBoxed -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec -&gt; dec -&gt; IsBoxed -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-var">TimeIt</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989038"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989036"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680989037"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0) -&gt; PassM Exp0 -&gt; PassM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988876"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989035"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1533"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-type">WithArenaE</span></a></span><span> </span><span id="local-6989586621680989039"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989039"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680989040"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989040"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-var">WithArenaE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989039"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0) -&gt; PassM Exp0 -&gt; PassM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988876"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989040"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1534"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-type">SpawnE</span></a></span><span> </span><span id="local-6989586621680989041"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989041"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621680989042"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680989042"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span> </span><span id="local-6989586621680989043"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680989043"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-var">SpawnE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989041"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680989042"><span class="hs-identifier hs-var">tyapps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Exp0] -&gt; Exp0) -&gt; PassM [Exp0] -&gt; PassM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; PassM Exp0) -&gt; [Exp0] -&gt; PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988876"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680989043"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1535"></span><span>        </span><span class="annot"><span class="annottext">Exp0
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span>
</span><span id="line-1536"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MapE"><span class="hs-identifier hs-type">MapE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; PassM Exp0
forall {a}. [Char] -&gt; a
</span><a href="#local-6989586621680988886"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988897"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1537"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FoldE"><span class="hs-identifier hs-type">FoldE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; PassM Exp0
forall {a}. [Char] -&gt; a
</span><a href="#local-6989586621680988886"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988897"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1538"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span id="local-6989586621680989044"><span class="annot"><span class="annottext">E0Ext Ty0 Ty0
</span><a href="#local-6989586621680989044"><span class="hs-identifier hs-var">ext</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1539"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0
</span><a href="#local-6989586621680989044"><span class="hs-identifier hs-var">ext</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1540"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#LambdaE"><span class="hs-identifier hs-type">LambdaE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; PassM Exp0
forall {a}. [Char] -&gt; a
</span><a href="#local-6989586621680988886"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988897"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1541"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#PolyAppE"><span class="hs-identifier hs-type">PolyAppE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; PassM Exp0
forall {a}. [Char] -&gt; a
</span><a href="#local-6989586621680988886"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988897"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1542"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunRefE"><span class="hs-identifier hs-type">FunRefE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; PassM Exp0
forall {a}. [Char] -&gt; a
</span><a href="#local-6989586621680988886"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988897"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1543"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#BenchE"><span class="hs-identifier hs-type">BenchE</span></a></span><span> </span><span id="local-6989586621680989045"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989045"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621680989046"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680989046"><span class="hs-identifier hs-var">_tyapps</span></a></span></span><span> </span><span id="local-6989586621680989047"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680989047"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621680989048"><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680989048"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680989049"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680989049"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0) -&gt; E0Ext Ty0 Ty0 -&gt; Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; IsBoxed -&gt; E0Ext Ty0 Ty0
forall loc dec.
Var -&gt; [loc] -&gt; [PreExp E0Ext loc dec] -&gt; IsBoxed -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#BenchE"><span class="hs-identifier hs-var">BenchE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989045"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680989049"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680989048"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Exp0] -&gt; Exp0) -&gt; PassM [Exp0] -&gt; PassM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; PassM Exp0) -&gt; [Exp0] -&gt; PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988876"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680989047"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1544"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#ParE0"><span class="hs-identifier hs-type">ParE0</span></a></span><span> </span><span id="local-6989586621680989050"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680989050"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; PassM Exp0
forall {a}. [Char] -&gt; a
</span><a href="#local-6989586621680988886"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;unbound ParE0&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0] -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680989050"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1545"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#PrintPacked"><span class="hs-identifier hs-type">PrintPacked</span></a></span><span> </span><span id="local-6989586621680989051"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989051"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680989052"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989052"><span class="hs-identifier hs-var">arg</span></a></span></span><span>
</span><span id="line-1546"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span id="local-6989586621680989053"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989053"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989051"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1547"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680989054"><span class="annot"><span class="annottext">f :: Var
</span><a href="#local-6989586621680989054"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Var
</span><a href="Gibbon.Language.Constants.html#mkPrinterName"><span class="hs-identifier hs-var">mkPrinterName</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989053"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-1548"></span><span>                  </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; PassM Exp0) -&gt; Exp0 -&gt; PassM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989054"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989052"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1549"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; PassM Exp0
forall {a}. [Char] -&gt; a
</span><a href="#local-6989586621680988886"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; PassM Exp0) -&gt; [Char] -&gt; PassM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;printPacked without a packed type. Got &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989051"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1550"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#CopyPacked"><span class="hs-identifier hs-type">CopyPacked</span></a></span><span> </span><span id="local-6989586621680989056"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989056"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680989057"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989057"><span class="hs-identifier hs-var">arg</span></a></span></span><span>
</span><span id="line-1551"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span id="local-6989586621680989058"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989058"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989056"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1552"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680989059"><span class="annot"><span class="annottext">f :: Var
</span><a href="#local-6989586621680989059"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Var
</span><a href="Gibbon.Language.Constants.html#mkCopyFunName"><span class="hs-identifier hs-var">mkCopyFunName</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989058"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-1553"></span><span>                  </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; PassM Exp0) -&gt; Exp0 -&gt; PassM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989059"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989057"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1554"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; PassM Exp0
forall {a}. [Char] -&gt; a
</span><a href="#local-6989586621680988886"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; PassM Exp0) -&gt; [Char] -&gt; PassM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;printPacked without a packed type. Got &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989056"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1555"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#TravPacked"><span class="hs-identifier hs-type">TravPacked</span></a></span><span> </span><span id="local-6989586621680989061"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989061"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680989062"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989062"><span class="hs-identifier hs-var">arg</span></a></span></span><span>
</span><span id="line-1556"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span id="local-6989586621680989063"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989063"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989061"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1557"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680989064"><span class="annot"><span class="annottext">f :: Var
</span><a href="#local-6989586621680989064"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Var
</span><a href="Gibbon.Language.Constants.html#mkTravFunName"><span class="hs-identifier hs-var">mkTravFunName</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989063"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-1558"></span><span>                  </span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; PassM Exp0) -&gt; Exp0 -&gt; PassM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989064"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989062"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1559"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; PassM Exp0
forall {a}. [Char] -&gt; a
</span><a href="#local-6989586621680988886"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; PassM Exp0) -&gt; [Char] -&gt; PassM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;printPacked without a packed type. Got &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989061"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1560"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#L"><span class="hs-identifier hs-type">L</span></a></span><span> </span><span id="local-6989586621680989066"><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621680989066"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680989067"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989067"><span class="hs-identifier hs-var">e</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">E0Ext Ty0 Ty0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E0Ext Ty0 Ty0 -&gt; Exp0) -&gt; (Exp0 -&gt; E0Ext Ty0 Ty0) -&gt; Exp0 -&gt; Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Loc -&gt; Exp0 -&gt; E0Ext Ty0 Ty0
forall loc dec. Loc -&gt; PreExp E0Ext loc dec -&gt; E0Ext loc dec
</span><a href="Gibbon.L0.Syntax.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621680989066"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0) -&gt; PassM Exp0 -&gt; PassM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; PassM Exp0
</span><a href="#local-6989586621680988876"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989067"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1561"></span><span>            </span><span class="annot"><a href="Gibbon.L0.Syntax.html#LinearExt"><span class="hs-identifier hs-type">LinearExt</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; PassM Exp0
forall {a}. [Char] -&gt; a
</span><a href="#local-6989586621680988886"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680988897"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1562"></span><span>
</span><span id="line-1563"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-1564"></span><span>
</span><span id="line-1565"></span><span class="annot"><span class="hs-comment">-- | Add copy &amp; traversal functions for each data type in a prog</span></span><span>
</span><span id="line-1566"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#addRepairFns"><span class="hs-identifier hs-type">addRepairFns</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Prog0"><span class="hs-identifier hs-type">Prog0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Prog0"><span class="hs-identifier hs-type">Prog0</span></a></span><span>
</span><span id="line-1567"></span><span id="addRepairFns"><span class="annot"><span class="annottext">addRepairFns :: Prog0 -&gt; PassM Prog0
</span><a href="Gibbon.L0.Specialize2.html#addRepairFns"><span class="hs-identifier hs-var hs-var">addRepairFns</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span id="local-6989586621680989081"><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
</span><a href="#local-6989586621680989081"><span class="hs-identifier hs-var">dfs</span></a></span></span><span> </span><span id="local-6989586621680989082"><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680989082"><span class="hs-identifier hs-var">fds</span></a></span></span><span> </span><span id="local-6989586621680989083"><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
</span><a href="#local-6989586621680989083"><span class="hs-identifier hs-var">me</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1568"></span><span>  </span><span id="local-6989586621680989084"><span class="annot"><span class="annottext">[FunDef0]
</span><a href="#local-6989586621680989084"><span class="hs-identifier hs-var">newFns</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[[FunDef0]] -&gt; [FunDef0]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">([[FunDef0]] -&gt; [FunDef0]) -&gt; PassM [[FunDef0]] -&gt; PassM [FunDef0]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span>
</span><span id="line-1569"></span><span>              </span><span class="annot"><span class="annottext">(DDef0 -&gt; PassM [FunDef0]) -&gt; [DDef0] -&gt; PassM [[FunDef0]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680989085"><span class="annot"><span class="annottext">DDef0
</span><a href="#local-6989586621680989085"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1570"></span><span>                    </span><span id="local-6989586621680989086"><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680989086"><span class="hs-identifier hs-var">copy_fn</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DDef0 -&gt; PassM FunDef0
</span><a href="Gibbon.L0.Specialize2.html#genCopyFn"><span class="hs-identifier hs-var">genCopyFn</span></a></span><span> </span><span class="annot"><span class="annottext">DDef0
</span><a href="#local-6989586621680989085"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-1571"></span><span>                    </span><span id="local-6989586621680989088"><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680989088"><span class="hs-identifier hs-var">copy2_fn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DDef0 -&gt; PassM FunDef0
</span><a href="Gibbon.L0.Specialize2.html#genCopySansPtrsFn"><span class="hs-identifier hs-var">genCopySansPtrsFn</span></a></span><span> </span><span class="annot"><span class="annottext">DDef0
</span><a href="#local-6989586621680989085"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-1572"></span><span>                    </span><span id="local-6989586621680989090"><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680989090"><span class="hs-identifier hs-var">trav_fn</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DDef0 -&gt; PassM FunDef0
</span><a href="Gibbon.L0.Specialize2.html#genTravFn"><span class="hs-identifier hs-var">genTravFn</span></a></span><span> </span><span class="annot"><span class="annottext">DDef0
</span><a href="#local-6989586621680989085"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-1573"></span><span>                    </span><span id="local-6989586621680989092"><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680989092"><span class="hs-identifier hs-var">print_fn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DDef0 -&gt; PassM FunDef0
</span><a href="Gibbon.L0.Specialize2.html#genPrintFn"><span class="hs-identifier hs-var">genPrintFn</span></a></span><span> </span><span class="annot"><span class="annottext">DDef0
</span><a href="#local-6989586621680989085"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-1574"></span><span>                    </span><span class="annot"><span class="annottext">[FunDef0] -&gt; PassM [FunDef0]
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680989086"><span class="hs-identifier hs-var">copy_fn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680989088"><span class="hs-identifier hs-var">copy2_fn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680989090"><span class="hs-identifier hs-var">trav_fn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680989092"><span class="hs-identifier hs-var">print_fn</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1575"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DDef0 -&gt; IsBoxed) -&gt; [DDef0] -&gt; [DDef0]
forall a. (a -&gt; IsBoxed) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IsBoxed -&gt; IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(IsBoxed -&gt; IsBoxed) -&gt; (DDef0 -&gt; IsBoxed) -&gt; DDef0 -&gt; IsBoxed
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">DDef0 -&gt; IsBoxed
forall {a}. DDef a -&gt; IsBoxed
</span><a href="Gibbon.Language.Syntax.html#isVoidDDef"><span class="hs-identifier hs-var">isVoidDDef</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; [DDef0]
forall k a. Map k a -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#elems"><span class="hs-identifier hs-var">M.elems</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
Map Var DDef0
</span><a href="#local-6989586621680989081"><span class="hs-identifier hs-var">dfs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1576"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680989095"><span class="annot"><span class="annottext">fds' :: FunDefs Exp0
</span><a href="#local-6989586621680989095"><span class="hs-identifier hs-var hs-var">fds'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680989082"><span class="hs-identifier hs-var">fds</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0 -&gt; FunDefs Exp0 -&gt; FunDefs Exp0
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, FunDef0)] -&gt; FunDefs Exp0
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(Var, FunDef0)] -&gt; FunDefs Exp0)
-&gt; [(Var, FunDef0)] -&gt; FunDefs Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(FunDef0 -&gt; (Var, FunDef0)) -&gt; [FunDef0] -&gt; [(Var, FunDef0)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680989096"><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680989096"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunDef0 -&gt; Var
forall ex. FunDef ex -&gt; Var
</span><a href="Gibbon.Language.Syntax.html#funName"><span class="hs-identifier hs-var">funName</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680989096"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680989096"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FunDef0]
</span><a href="#local-6989586621680989084"><span class="hs-identifier hs-var">newFns</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1577"></span><span>  </span><span class="annot"><span class="annottext">Prog0 -&gt; PassM Prog0
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Prog0 -&gt; PassM Prog0) -&gt; Prog0 -&gt; PassM Prog0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
-&gt; FunDefs Exp0 -&gt; Maybe (Exp0, TyOf Exp0) -&gt; Prog0
forall ex.
DDefs (TyOf ex) -&gt; FunDefs ex -&gt; Maybe (ex, TyOf ex) -&gt; Prog ex
</span><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-var">Prog</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
</span><a href="#local-6989586621680989081"><span class="hs-identifier hs-var">dfs</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680989095"><span class="hs-identifier hs-var">fds'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
</span><a href="#local-6989586621680989083"><span class="hs-identifier hs-var">me</span></a></span><span>
</span><span id="line-1578"></span><span>
</span><span id="line-1579"></span><span>
</span><span id="line-1580"></span><span class="hs-comment">-- | Generate a copy function for a particular data definition.</span><span>
</span><span id="line-1581"></span><span class="hs-comment">-- Note: there will be redundant let bindings in the function body which may need to be inlined.</span><span>
</span><span id="line-1582"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#genCopyFn"><span class="hs-identifier hs-type">genCopyFn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#DDef0"><span class="hs-identifier hs-type">DDef0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunDef0"><span class="hs-identifier hs-type">FunDef0</span></a></span><span>
</span><span id="line-1583"></span><span id="genCopyFn"><span class="annot"><span class="annottext">genCopyFn :: DDef0 -&gt; PassM FunDef0
</span><a href="Gibbon.L0.Specialize2.html#genCopyFn"><span class="hs-identifier hs-var hs-var">genCopyFn</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DDef"><span class="hs-identifier hs-type">DDef</span></a></span><span class="hs-special">{</span><span id="local-6989586621680989116"><span class="annot"><span class="annottext">Var
tyName :: forall a. DDef a -&gt; Var
tyName :: Var
</span><a href="Gibbon.Language.Syntax.html#tyName"><span class="hs-identifier hs-var hs-var">tyName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680989117"><span class="annot"><span class="annottext">[([Char], [(IsBoxed, Ty0)])]
dataCons :: forall a. DDef a -&gt; [([Char], [(IsBoxed, a)])]
dataCons :: [([Char], [(IsBoxed, Ty0)])]
</span><a href="Gibbon.Language.Syntax.html#dataCons"><span class="hs-identifier hs-var hs-var">dataCons</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1584"></span><span>  </span><span id="local-6989586621680989118"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989118"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">(Var -&gt; PassM Var) -&gt; Var -&gt; PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;arg&quot;</span></span><span>
</span><span id="line-1585"></span><span>  </span><span id="local-6989586621680989119"><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680989119"><span class="hs-identifier hs-var">casebod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[([Char], [(IsBoxed, Ty0)])]
-&gt; (([Char], [(IsBoxed, Ty0)])
    -&gt; PassM ([Char], [(Var, Ty0)], Exp0))
-&gt; PassM [([Char], [(Var, Ty0)], Exp0)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#forM"><span class="hs-identifier hs-var">forM</span></a></span><span> </span><span class="annot"><span class="annottext">[([Char], [(IsBoxed, Ty0)])]
</span><a href="#local-6989586621680989117"><span class="hs-identifier hs-var">dataCons</span></a></span><span> </span><span class="annot"><span class="annottext">((([Char], [(IsBoxed, Ty0)]) -&gt; PassM ([Char], [(Var, Ty0)], Exp0))
 -&gt; PassM [([Char], [(Var, Ty0)], Exp0)])
-&gt; (([Char], [(IsBoxed, Ty0)])
    -&gt; PassM ([Char], [(Var, Ty0)], Exp0))
-&gt; PassM [([Char], [(Var, Ty0)], Exp0)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680989121"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989121"><span class="hs-identifier hs-var">dcon</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680989122"><span class="annot"><span class="annottext">[(IsBoxed, Ty0)]
</span><a href="#local-6989586621680989122"><span class="hs-identifier hs-var">dtys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1586"></span><span>             </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680989123"><span class="annot"><span class="annottext">tys :: [Ty0]
</span><a href="#local-6989586621680989123"><span class="hs-identifier hs-var hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((IsBoxed, Ty0) -&gt; Ty0) -&gt; [(IsBoxed, Ty0)] -&gt; [Ty0]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(IsBoxed, Ty0) -&gt; Ty0
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[(IsBoxed, Ty0)]
</span><a href="#local-6989586621680989122"><span class="hs-identifier hs-var">dtys</span></a></span><span>
</span><span id="line-1587"></span><span>                </span><span id="local-6989586621680989124"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989124"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; PassM Var) -&gt; [Ty0] -&gt; PassM [Var]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;x&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680989123"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1588"></span><span>                </span><span id="local-6989586621680989125"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989125"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; PassM Var) -&gt; [Ty0] -&gt; PassM [Var]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;y&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680989123"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1589"></span><span>                </span><span class="hs-comment">-- let packed_vars = map fst $ filter (\(x,ty) -&gt; isPackedTy ty) (zip ys tys)</span><span>
</span><span id="line-1590"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680989126"><span class="annot"><span class="annottext">bod :: Exp0
</span><a href="#local-6989586621680989126"><span class="hs-identifier hs-var hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Ty0, Var, Var) -&gt; Exp0 -&gt; Exp0)
-&gt; Exp0 -&gt; [(Ty0, Var, Var)] -&gt; Exp0
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680989127"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989127"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680989128"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989128"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680989129"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989129"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680989130"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989130"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1591"></span><span>                                     </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989127"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1592"></span><span>                                       </span><span class="annot"><a href="Gibbon.L0.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span id="local-6989586621680989131"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989131"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0) -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989129"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989127"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Var
</span><a href="Gibbon.Language.Constants.html#mkCopyFunName"><span class="hs-identifier hs-var">mkCopyFunName</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989131"><span class="hs-identifier hs-var">tycon</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989128"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989130"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1593"></span><span>                                       </span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0) -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989129"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989127"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989128"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989130"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1594"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; [Char] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
loc -&gt; [Char] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-var">DataConE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989121"><span class="hs-identifier hs-var">dcon</span></a></span><span> </span><span class="annot"><span class="annottext">([Exp0] -&gt; Exp0) -&gt; [Exp0] -&gt; Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Var -&gt; Exp0) -&gt; [Var] -&gt; [Exp0]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989125"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty0] -&gt; [Var] -&gt; [Var] -&gt; [(Ty0, Var, Var)]
forall a b c. [a] -&gt; [b] -&gt; [c] -&gt; [(a, b, c)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip3"><span class="hs-identifier hs-var">zip3</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680989123"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989124"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989125"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1595"></span><span>                </span><span class="annot"><span class="annottext">([Char], [(Var, Ty0)], Exp0) -&gt; PassM ([Char], [(Var, Ty0)], Exp0)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989121"><span class="hs-identifier hs-var">dcon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; (Var, Ty0)) -&gt; [Var] -&gt; [(Var, Ty0)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680989132"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989132"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989132"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989124"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989126"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1596"></span><span>  </span><span class="annot"><span class="annottext">FunDef0 -&gt; PassM FunDef0
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(FunDef0 -&gt; PassM FunDef0) -&gt; FunDef0 -&gt; PassM FunDef0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funName :: Var
</span><a href="Gibbon.Language.Syntax.html#funName"><span class="hs-identifier hs-var">funName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Var
</span><a href="Gibbon.Language.Constants.html#mkCopyFunName"><span class="hs-identifier hs-var">mkCopyFunName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Char]
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989116"><span class="hs-identifier hs-var">tyName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1597"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funArgs :: [Var]
</span><a href="Gibbon.Language.Syntax.html#funArgs"><span class="hs-identifier hs-var">funArgs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989118"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1598"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funTy :: ArrowTy (TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#funTy"><span class="hs-identifier hs-var">funTy</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar] -&gt; Ty0 -&gt; TyScheme
</span><a href="Gibbon.L0.Syntax.html#ForAll"><span class="hs-identifier hs-var">ForAll</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ArrowTy"><span class="hs-identifier hs-var">ArrowTy</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char] -&gt; [Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#PackedTy"><span class="hs-identifier hs-var">PackedTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Char]
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989116"><span class="hs-identifier hs-var">tyName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; [Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#PackedTy"><span class="hs-identifier hs-var">PackedTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Char]
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989116"><span class="hs-identifier hs-var">tyName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1599"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funBody :: Exp0
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [([Char], [(Var, Ty0)], Exp0)] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; [([Char], [(Var, loc)], PreExp ext loc dec)]
-&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-var">CaseE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989118"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680989119"><span class="hs-identifier hs-var">casebod</span></a></span><span>
</span><span id="line-1600"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funMeta :: FunMeta
</span><a href="Gibbon.Language.Syntax.html#funMeta"><span class="hs-identifier hs-var">funMeta</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunMeta"><span class="hs-identifier hs-type">FunMeta</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funRec :: FunRec
</span><a href="Gibbon.Language.Syntax.html#funRec"><span class="hs-identifier hs-var">funRec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunRec
</span><a href="Gibbon.Language.Syntax.html#Rec"><span class="hs-identifier hs-var">Rec</span></a></span><span>
</span><span id="line-1601"></span><span>                                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funInline :: FunInline
</span><a href="Gibbon.Language.Syntax.html#funInline"><span class="hs-identifier hs-var">funInline</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunInline
</span><a href="Gibbon.Language.Syntax.html#NoInline"><span class="hs-identifier hs-var">NoInline</span></a></span><span>
</span><span id="line-1602"></span><span>                                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funCanTriggerGC :: IsBoxed
</span><a href="Gibbon.Language.Syntax.html#funCanTriggerGC"><span class="hs-identifier hs-var">funCanTriggerGC</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-1603"></span><span>                                      </span><span class="hs-special">}</span><span>
</span><span id="line-1604"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-1605"></span><span>
</span><span id="line-1606"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#genCopySansPtrsFn"><span class="hs-identifier hs-type">genCopySansPtrsFn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#DDef0"><span class="hs-identifier hs-type">DDef0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunDef0"><span class="hs-identifier hs-type">FunDef0</span></a></span><span>
</span><span id="line-1607"></span><span id="genCopySansPtrsFn"><span class="annot"><span class="annottext">genCopySansPtrsFn :: DDef0 -&gt; PassM FunDef0
</span><a href="Gibbon.L0.Specialize2.html#genCopySansPtrsFn"><span class="hs-identifier hs-var hs-var">genCopySansPtrsFn</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DDef"><span class="hs-identifier hs-type">DDef</span></a></span><span class="hs-special">{</span><span id="local-6989586621680989153"><span class="annot"><span class="annottext">Var
tyName :: forall a. DDef a -&gt; Var
tyName :: Var
</span><a href="Gibbon.Language.Syntax.html#tyName"><span class="hs-identifier hs-var hs-var">tyName</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680989154"><span class="annot"><span class="annottext">[([Char], [(IsBoxed, Ty0)])]
dataCons :: forall a. DDef a -&gt; [([Char], [(IsBoxed, a)])]
dataCons :: [([Char], [(IsBoxed, Ty0)])]
</span><a href="Gibbon.Language.Syntax.html#dataCons"><span class="hs-identifier hs-var hs-var">dataCons</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1608"></span><span>  </span><span id="local-6989586621680989155"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989155"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">(Var -&gt; PassM Var) -&gt; Var -&gt; PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;arg&quot;</span></span><span>
</span><span id="line-1609"></span><span>  </span><span id="local-6989586621680989156"><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680989156"><span class="hs-identifier hs-var">casebod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[([Char], [(IsBoxed, Ty0)])]
-&gt; (([Char], [(IsBoxed, Ty0)])
    -&gt; PassM ([Char], [(Var, Ty0)], Exp0))
-&gt; PassM [([Char], [(Var, Ty0)], Exp0)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#forM"><span class="hs-identifier hs-var">forM</span></a></span><span> </span><span class="annot"><span class="annottext">[([Char], [(IsBoxed, Ty0)])]
</span><a href="#local-6989586621680989154"><span class="hs-identifier hs-var">dataCons</span></a></span><span> </span><span class="annot"><span class="annottext">((([Char], [(IsBoxed, Ty0)]) -&gt; PassM ([Char], [(Var, Ty0)], Exp0))
 -&gt; PassM [([Char], [(Var, Ty0)], Exp0)])
-&gt; (([Char], [(IsBoxed, Ty0)])
    -&gt; PassM ([Char], [(Var, Ty0)], Exp0))
-&gt; PassM [([Char], [(Var, Ty0)], Exp0)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680989157"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989157"><span class="hs-identifier hs-var">dcon</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680989158"><span class="annot"><span class="annottext">[(IsBoxed, Ty0)]
</span><a href="#local-6989586621680989158"><span class="hs-identifier hs-var">dtys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1610"></span><span>             </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680989159"><span class="annot"><span class="annottext">tys :: [Ty0]
</span><a href="#local-6989586621680989159"><span class="hs-identifier hs-var hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((IsBoxed, Ty0) -&gt; Ty0) -&gt; [(IsBoxed, Ty0)] -&gt; [Ty0]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(IsBoxed, Ty0) -&gt; Ty0
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[(IsBoxed, Ty0)]
</span><a href="#local-6989586621680989158"><span class="hs-identifier hs-var">dtys</span></a></span><span>
</span><span id="line-1611"></span><span>                </span><span id="local-6989586621680989160"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989160"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; PassM Var) -&gt; [Ty0] -&gt; PassM [Var]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;x&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680989159"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1612"></span><span>                </span><span id="local-6989586621680989161"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989161"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Ty0 -&gt; PassM Var) -&gt; [Ty0] -&gt; PassM [Var]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;y&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680989159"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1613"></span><span>                </span><span class="hs-comment">-- let packed_vars = map fst $ filter (\(x,ty) -&gt; isPackedTy ty) (zip ys tys)</span><span>
</span><span id="line-1614"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680989162"><span class="annot"><span class="annottext">bod :: Exp0
</span><a href="#local-6989586621680989162"><span class="hs-identifier hs-var hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Ty0, Var, Var) -&gt; Exp0 -&gt; Exp0)
-&gt; Exp0 -&gt; [(Ty0, Var, Var)] -&gt; Exp0
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680989163"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989163"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680989164"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989164"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680989165"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989165"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680989166"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989166"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1615"></span><span>                                     </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989163"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1616"></span><span>                                       </span><span class="annot"><a href="Gibbon.L0.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span id="local-6989586621680989167"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989167"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0) -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989165"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989163"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Var
</span><a href="Gibbon.Language.Constants.html#mkCopySansPtrsFunName"><span class="hs-identifier hs-var">mkCopySansPtrsFunName</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989167"><span class="hs-identifier hs-var">tycon</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989164"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989166"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1617"></span><span>                                       </span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0) -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989165"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989163"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989164"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989166"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1618"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty0 -&gt; [Char] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
loc -&gt; [Char] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-var">DataConE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989157"><span class="hs-identifier hs-var">dcon</span></a></span><span> </span><span class="annot"><span class="annottext">([Exp0] -&gt; Exp0) -&gt; [Exp0] -&gt; Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Var -&gt; Exp0) -&gt; [Var] -&gt; [Exp0]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989161"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty0] -&gt; [Var] -&gt; [Var] -&gt; [(Ty0, Var, Var)]
forall a b c. [a] -&gt; [b] -&gt; [c] -&gt; [(a, b, c)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip3"><span class="hs-identifier hs-var">zip3</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680989159"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989160"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989161"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1619"></span><span>                </span><span class="annot"><span class="annottext">([Char], [(Var, Ty0)], Exp0) -&gt; PassM ([Char], [(Var, Ty0)], Exp0)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989157"><span class="hs-identifier hs-var">dcon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; (Var, Ty0)) -&gt; [Var] -&gt; [(Var, Ty0)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680989169"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989169"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989169"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989160"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989162"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1620"></span><span>  </span><span class="annot"><span class="annottext">FunDef0 -&gt; PassM FunDef0
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(FunDef0 -&gt; PassM FunDef0) -&gt; FunDef0 -&gt; PassM FunDef0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funName :: Var
</span><a href="Gibbon.Language.Syntax.html#funName"><span class="hs-identifier hs-var">funName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Var
</span><a href="Gibbon.Language.Constants.html#mkCopySansPtrsFunName"><span class="hs-identifier hs-var">mkCopySansPtrsFunName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Char]
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989153"><span class="hs-identifier hs-var">tyName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1621"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funArgs :: [Var]
</span><a href="Gibbon.Language.Syntax.html#funArgs"><span class="hs-identifier hs-var">funArgs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989155"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1622"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funTy :: ArrowTy (TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#funTy"><span class="hs-identifier hs-var">funTy</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar] -&gt; Ty0 -&gt; TyScheme
</span><a href="Gibbon.L0.Syntax.html#ForAll"><span class="hs-identifier hs-var">ForAll</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ArrowTy"><span class="hs-identifier hs-var">ArrowTy</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char] -&gt; [Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#PackedTy"><span class="hs-identifier hs-var">PackedTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Char]
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989153"><span class="hs-identifier hs-var">tyName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; [Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#PackedTy"><span class="hs-identifier hs-var">PackedTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Char]
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989153"><span class="hs-identifier hs-var">tyName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1623"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funBody :: Exp0
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [([Char], [(Var, Ty0)], Exp0)] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; [([Char], [(Var, loc)], PreExp ext loc dec)]
-&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-var">CaseE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989155"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680989156"><span class="hs-identifier hs-var">casebod</span></a></span><span>
</span><span id="line-1624"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funMeta :: FunMeta
</span><a href="Gibbon.Language.Syntax.html#funMeta"><span class="hs-identifier hs-var">funMeta</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunMeta"><span class="hs-identifier hs-type">FunMeta</span></a></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funRec :: FunRec
</span><a href="Gibbon.Language.Syntax.html#funRec"><span class="hs-identifier hs-var">funRec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunRec
</span><a href="Gibbon.Language.Syntax.html#Rec"><span class="hs-identifier hs-var">Rec</span></a></span><span>
</span><span id="line-1625"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funInline :: FunInline
</span><a href="Gibbon.Language.Syntax.html#funInline"><span class="hs-identifier hs-var">funInline</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunInline
</span><a href="Gibbon.Language.Syntax.html#NoInline"><span class="hs-identifier hs-var">NoInline</span></a></span><span>
</span><span id="line-1626"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funCanTriggerGC :: IsBoxed
</span><a href="Gibbon.Language.Syntax.html#funCanTriggerGC"><span class="hs-identifier hs-var">funCanTriggerGC</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-1627"></span><span>                                       </span><span class="hs-special">}</span><span>
</span><span id="line-1628"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-1629"></span><span>
</span><span id="line-1630"></span><span>
</span><span id="line-1631"></span><span>
</span><span id="line-1632"></span><span>
</span><span id="line-1633"></span><span class="annot"><span class="hs-comment">-- | Traverses a packed data type.</span></span><span>
</span><span id="line-1634"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#genTravFn"><span class="hs-identifier hs-type">genTravFn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#DDef0"><span class="hs-identifier hs-type">DDef0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunDef0"><span class="hs-identifier hs-type">FunDef0</span></a></span><span>
</span><span id="line-1635"></span><span id="genTravFn"><span class="annot"><span class="annottext">genTravFn :: DDef0 -&gt; PassM FunDef0
</span><a href="Gibbon.L0.Specialize2.html#genTravFn"><span class="hs-identifier hs-var hs-var">genTravFn</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DDef"><span class="hs-identifier hs-type">DDef</span></a></span><span class="hs-special">{</span><span id="local-6989586621680989189"><span class="annot"><span class="annottext">Var
tyName :: forall a. DDef a -&gt; Var
tyName :: Var
</span><a href="Gibbon.Language.Syntax.html#tyName"><span class="hs-identifier hs-var hs-var">tyName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680989190"><span class="annot"><span class="annottext">[([Char], [(IsBoxed, Ty0)])]
dataCons :: forall a. DDef a -&gt; [([Char], [(IsBoxed, a)])]
dataCons :: [([Char], [(IsBoxed, Ty0)])]
</span><a href="Gibbon.Language.Syntax.html#dataCons"><span class="hs-identifier hs-var hs-var">dataCons</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1636"></span><span>  </span><span id="local-6989586621680989191"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989191"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">(Var -&gt; PassM Var) -&gt; Var -&gt; PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;arg&quot;</span></span><span>
</span><span id="line-1637"></span><span>  </span><span id="local-6989586621680989192"><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680989192"><span class="hs-identifier hs-var">casebod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[([Char], [(IsBoxed, Ty0)])]
-&gt; (([Char], [(IsBoxed, Ty0)])
    -&gt; PassM ([Char], [(Var, Ty0)], Exp0))
-&gt; PassM [([Char], [(Var, Ty0)], Exp0)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#forM"><span class="hs-identifier hs-var">forM</span></a></span><span> </span><span class="annot"><span class="annottext">[([Char], [(IsBoxed, Ty0)])]
</span><a href="#local-6989586621680989190"><span class="hs-identifier hs-var">dataCons</span></a></span><span> </span><span class="annot"><span class="annottext">((([Char], [(IsBoxed, Ty0)]) -&gt; PassM ([Char], [(Var, Ty0)], Exp0))
 -&gt; PassM [([Char], [(Var, Ty0)], Exp0)])
-&gt; (([Char], [(IsBoxed, Ty0)])
    -&gt; PassM ([Char], [(Var, Ty0)], Exp0))
-&gt; PassM [([Char], [(Var, Ty0)], Exp0)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680989193"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989193"><span class="hs-identifier hs-var">dcon</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680989194"><span class="annot"><span class="annottext">[(IsBoxed, Ty0)]
</span><a href="#local-6989586621680989194"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1638"></span><span>             </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680989195"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989195"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((IsBoxed, Ty0) -&gt; PassM Var) -&gt; [(IsBoxed, Ty0)] -&gt; PassM [Var]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">(IsBoxed, Ty0)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;x&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(IsBoxed, Ty0)]
</span><a href="#local-6989586621680989194"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1639"></span><span>                </span><span id="local-6989586621680989196"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989196"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((IsBoxed, Ty0) -&gt; PassM Var) -&gt; [(IsBoxed, Ty0)] -&gt; PassM [Var]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">(IsBoxed, Ty0)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;y&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(IsBoxed, Ty0)]
</span><a href="#local-6989586621680989194"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1640"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680989197"><span class="annot"><span class="annottext">bod :: Exp0
</span><a href="#local-6989586621680989197"><span class="hs-identifier hs-var hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Ty0, Var, Var) -&gt; Exp0 -&gt; Exp0)
-&gt; Exp0 -&gt; [(Ty0, Var, Var)] -&gt; Exp0
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680989198"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989198"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680989199"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989199"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680989200"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989200"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680989201"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989201"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1641"></span><span>                                     </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989198"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1642"></span><span>                                       </span><span class="annot"><a href="Gibbon.L0.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span id="local-6989586621680989202"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989202"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0) -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989200"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Var
</span><a href="Gibbon.Language.Constants.html#mkTravFunName"><span class="hs-identifier hs-var">mkTravFunName</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989202"><span class="hs-identifier hs-var">tycon</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989199"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989201"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1643"></span><span>                                       </span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989201"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1644"></span><span>                          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
[PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-var">MkProdE</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1645"></span><span>                          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty0] -&gt; [Var] -&gt; [Var] -&gt; [(Ty0, Var, Var)]
forall a b c. [a] -&gt; [b] -&gt; [c] -&gt; [(a, b, c)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip3"><span class="hs-identifier hs-var">zip3</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((IsBoxed, Ty0) -&gt; Ty0) -&gt; [(IsBoxed, Ty0)] -&gt; [Ty0]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(IsBoxed, Ty0) -&gt; Ty0
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[(IsBoxed, Ty0)]
</span><a href="#local-6989586621680989194"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989195"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989196"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1646"></span><span>                </span><span class="annot"><span class="annottext">([Char], [(Var, Ty0)], Exp0) -&gt; PassM ([Char], [(Var, Ty0)], Exp0)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989193"><span class="hs-identifier hs-var">dcon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; (Var, Ty0)) -&gt; [Var] -&gt; [(Var, Ty0)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680989203"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989203"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989203"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989195"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989197"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1647"></span><span>  </span><span class="annot"><span class="annottext">FunDef0 -&gt; PassM FunDef0
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(FunDef0 -&gt; PassM FunDef0) -&gt; FunDef0 -&gt; PassM FunDef0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funName :: Var
</span><a href="Gibbon.Language.Syntax.html#funName"><span class="hs-identifier hs-var">funName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Var
</span><a href="Gibbon.Language.Constants.html#mkTravFunName"><span class="hs-identifier hs-var">mkTravFunName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Char]
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989189"><span class="hs-identifier hs-var">tyName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1648"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funArgs :: [Var]
</span><a href="Gibbon.Language.Syntax.html#funArgs"><span class="hs-identifier hs-var">funArgs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989191"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1649"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funTy :: ArrowTy (TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#funTy"><span class="hs-identifier hs-var">funTy</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar] -&gt; Ty0 -&gt; TyScheme
</span><a href="Gibbon.L0.Syntax.html#ForAll"><span class="hs-identifier hs-var">ForAll</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ArrowTy"><span class="hs-identifier hs-var">ArrowTy</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char] -&gt; [Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#PackedTy"><span class="hs-identifier hs-var">PackedTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Char]
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989189"><span class="hs-identifier hs-var">tyName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1650"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funBody :: Exp0
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [([Char], [(Var, Ty0)], Exp0)] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; [([Char], [(Var, loc)], PreExp ext loc dec)]
-&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-var">CaseE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989191"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680989192"><span class="hs-identifier hs-var">casebod</span></a></span><span>
</span><span id="line-1651"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funMeta :: FunMeta
</span><a href="Gibbon.Language.Syntax.html#funMeta"><span class="hs-identifier hs-var">funMeta</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunMeta"><span class="hs-identifier hs-type">FunMeta</span></a></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funRec :: FunRec
</span><a href="Gibbon.Language.Syntax.html#funRec"><span class="hs-identifier hs-var">funRec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunRec
</span><a href="Gibbon.Language.Syntax.html#Rec"><span class="hs-identifier hs-var">Rec</span></a></span><span>
</span><span id="line-1652"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funInline :: FunInline
</span><a href="Gibbon.Language.Syntax.html#funInline"><span class="hs-identifier hs-var">funInline</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunInline
</span><a href="Gibbon.Language.Syntax.html#NoInline"><span class="hs-identifier hs-var">NoInline</span></a></span><span>
</span><span id="line-1653"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funCanTriggerGC :: IsBoxed
</span><a href="Gibbon.Language.Syntax.html#funCanTriggerGC"><span class="hs-identifier hs-var">funCanTriggerGC</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-1654"></span><span>                                       </span><span class="hs-special">}</span><span>
</span><span id="line-1655"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-1656"></span><span>
</span><span id="line-1657"></span><span>
</span><span id="line-1658"></span><span class="annot"><span class="hs-comment">-- | Print a packed datatype.</span></span><span>
</span><span id="line-1659"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#genPrintFn"><span class="hs-identifier hs-type">genPrintFn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#DDef0"><span class="hs-identifier hs-type">DDef0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunDef0"><span class="hs-identifier hs-type">FunDef0</span></a></span><span>
</span><span id="line-1660"></span><span id="genPrintFn"><span class="annot"><span class="annottext">genPrintFn :: DDef0 -&gt; PassM FunDef0
</span><a href="Gibbon.L0.Specialize2.html#genPrintFn"><span class="hs-identifier hs-var hs-var">genPrintFn</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DDef"><span class="hs-identifier hs-type">DDef</span></a></span><span class="hs-special">{</span><span id="local-6989586621680989239"><span class="annot"><span class="annottext">Var
tyName :: forall a. DDef a -&gt; Var
tyName :: Var
</span><a href="Gibbon.Language.Syntax.html#tyName"><span class="hs-identifier hs-var hs-var">tyName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680989240"><span class="annot"><span class="annottext">[([Char], [(IsBoxed, Ty0)])]
dataCons :: forall a. DDef a -&gt; [([Char], [(IsBoxed, a)])]
dataCons :: [([Char], [(IsBoxed, Ty0)])]
</span><a href="Gibbon.Language.Syntax.html#dataCons"><span class="hs-identifier hs-var hs-var">dataCons</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1661"></span><span>  </span><span id="local-6989586621680989241"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989241"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;arg&quot;</span></span><span>
</span><span id="line-1662"></span><span>  </span><span id="local-6989586621680989242"><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680989242"><span class="hs-identifier hs-var">casebod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[([Char], [(IsBoxed, Ty0)])]
-&gt; (([Char], [(IsBoxed, Ty0)])
    -&gt; PassM ([Char], [(Var, Ty0)], Exp0))
-&gt; PassM [([Char], [(Var, Ty0)], Exp0)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#forM"><span class="hs-identifier hs-var">forM</span></a></span><span> </span><span class="annot"><span class="annottext">[([Char], [(IsBoxed, Ty0)])]
</span><a href="#local-6989586621680989240"><span class="hs-identifier hs-var">dataCons</span></a></span><span> </span><span class="annot"><span class="annottext">((([Char], [(IsBoxed, Ty0)]) -&gt; PassM ([Char], [(Var, Ty0)], Exp0))
 -&gt; PassM [([Char], [(Var, Ty0)], Exp0)])
-&gt; (([Char], [(IsBoxed, Ty0)])
    -&gt; PassM ([Char], [(Var, Ty0)], Exp0))
-&gt; PassM [([Char], [(Var, Ty0)], Exp0)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680989243"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989243"><span class="hs-identifier hs-var">dcon</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680989244"><span class="annot"><span class="annottext">[(IsBoxed, Ty0)]
</span><a href="#local-6989586621680989244"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1663"></span><span>             </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680989245"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989245"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((IsBoxed, Ty0) -&gt; PassM Var) -&gt; [(IsBoxed, Ty0)] -&gt; PassM [Var]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">(IsBoxed, Ty0)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;x&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(IsBoxed, Ty0)]
</span><a href="#local-6989586621680989244"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1664"></span><span>                </span><span id="local-6989586621680989246"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989246"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((IsBoxed, Ty0) -&gt; PassM Var) -&gt; [(IsBoxed, Ty0)] -&gt; PassM [Var]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">(IsBoxed, Ty0)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;y&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(IsBoxed, Ty0)]
</span><a href="#local-6989586621680989244"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1665"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680989247"><span class="annot"><span class="annottext">bnds :: [(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680989247"><span class="hs-identifier hs-var hs-var">bnds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Ty0, Var, Var)
 -&gt; [(Var, [Ty0], Ty0, Exp0)] -&gt; [(Var, [Ty0], Ty0, Exp0)])
-&gt; [(Var, [Ty0], Ty0, Exp0)]
-&gt; [(Ty0, Var, Var)]
-&gt; [(Var, [Ty0], Ty0, Exp0)]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680989248"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989248"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680989249"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989249"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680989250"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989250"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680989251"><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680989251"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1666"></span><span>                                     </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989248"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1667"></span><span>                                       </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#IntTy"><span class="hs-identifier hs-var">IntTy</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989250"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Prim Ty0 -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#PrintInt"><span class="hs-identifier hs-var">PrintInt</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989249"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0)
-&gt; [(Var, [Ty0], Ty0, Exp0)] -&gt; [(Var, [Ty0], Ty0, Exp0)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680989251"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1668"></span><span>                                       </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#FloatTy"><span class="hs-identifier hs-var">FloatTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989250"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Prim Ty0 -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#PrintFloat"><span class="hs-identifier hs-var">PrintFloat</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989249"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0)
-&gt; [(Var, [Ty0], Ty0, Exp0)] -&gt; [(Var, [Ty0], Ty0, Exp0)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680989251"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1669"></span><span>                                       </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#SymTy0"><span class="hs-identifier hs-var">SymTy0</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989250"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Prim Ty0 -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#PrintSym"><span class="hs-identifier hs-var">PrintSym</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989249"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0)
-&gt; [(Var, [Ty0], Ty0, Exp0)] -&gt; [(Var, [Ty0], Ty0, Exp0)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680989251"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1670"></span><span>                                       </span><span class="annot"><span class="annottext">Ty0
</span><a href="Gibbon.L0.Syntax.html#BoolTy"><span class="hs-identifier hs-var">BoolTy</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989250"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Prim Ty0 -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#PrintBool"><span class="hs-identifier hs-var">PrintBool</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989249"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0)
-&gt; [(Var, [Ty0], Ty0, Exp0)] -&gt; [(Var, [Ty0], Ty0, Exp0)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680989251"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1671"></span><span>                                       </span><span class="annot"><a href="Gibbon.L0.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span id="local-6989586621680989256"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989256"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989250"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Var
</span><a href="Gibbon.Language.Constants.html#mkPrinterName"><span class="hs-identifier hs-var">mkPrinterName</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989256"><span class="hs-identifier hs-var">tycon</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989249"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0)
-&gt; [(Var, [Ty0], Ty0, Exp0)] -&gt; [(Var, [Ty0], Ty0, Exp0)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680989251"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1672"></span><span>                                       </span><span class="annot"><a href="Gibbon.L0.Syntax.html#SymDictTy"><span class="hs-identifier hs-type">SymDictTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989250"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Prim Ty0 -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#PrintSym"><span class="hs-identifier hs-var">PrintSym</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-var">LitSymE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;SymDict&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0)
-&gt; [(Var, [Ty0], Ty0, Exp0)] -&gt; [(Var, [Ty0], Ty0, Exp0)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680989251"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1673"></span><span>                                       </span><span class="annot"><a href="Gibbon.L0.Syntax.html#VectorTy"><span class="hs-identifier hs-type">VectorTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989250"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Prim Ty0 -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#PrintSym"><span class="hs-identifier hs-var">PrintSym</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-var">LitSymE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Vector&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0)
-&gt; [(Var, [Ty0], Ty0, Exp0)] -&gt; [(Var, [Ty0], Ty0, Exp0)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680989251"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1674"></span><span>                                       </span><span class="annot"><a href="Gibbon.L0.Syntax.html#PDictTy"><span class="hs-identifier hs-type">PDictTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989250"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Prim Ty0 -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#PrintSym"><span class="hs-identifier hs-var">PrintSym</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-var">LitSymE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;PDict&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0)
-&gt; [(Var, [Ty0], Ty0, Exp0)] -&gt; [(Var, [Ty0], Ty0, Exp0)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680989251"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1675"></span><span>                                       </span><span class="annot"><a href="Gibbon.L0.Syntax.html#ListTy"><span class="hs-identifier hs-type">ListTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989250"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Prim Ty0 -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#PrintSym"><span class="hs-identifier hs-var">PrintSym</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-var">LitSymE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;List&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0)
-&gt; [(Var, [Ty0], Ty0, Exp0)] -&gt; [(Var, [Ty0], Ty0, Exp0)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680989251"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1676"></span><span>                                       </span><span class="annot"><a href="Gibbon.L0.Syntax.html#ArenaTy"><span class="hs-identifier hs-type">ArenaTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989250"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Prim Ty0 -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#PrintSym"><span class="hs-identifier hs-var">PrintSym</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-var">LitSymE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Arena&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0)
-&gt; [(Var, [Ty0], Ty0, Exp0)] -&gt; [(Var, [Ty0], Ty0, Exp0)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680989251"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1677"></span><span>                                       </span><span class="annot"><a href="Gibbon.L0.Syntax.html#SymSetTy"><span class="hs-identifier hs-type">SymSetTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989250"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Prim Ty0 -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#PrintSym"><span class="hs-identifier hs-var">PrintSym</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-var">LitSymE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;SymSet&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0)
-&gt; [(Var, [Ty0], Ty0, Exp0)] -&gt; [(Var, [Ty0], Ty0, Exp0)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680989251"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1678"></span><span>                                       </span><span class="annot"><a href="Gibbon.L0.Syntax.html#SymHashTy"><span class="hs-identifier hs-type">SymHashTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989250"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Prim Ty0 -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#PrintSym"><span class="hs-identifier hs-var">PrintSym</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-var">LitSymE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;SymHash&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0)
-&gt; [(Var, [Ty0], Ty0, Exp0)] -&gt; [(Var, [Ty0], Ty0, Exp0)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680989251"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1679"></span><span>                                       </span><span class="annot"><a href="Gibbon.L0.Syntax.html#IntHashTy"><span class="hs-identifier hs-type">IntHashTy</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989250"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Prim Ty0 -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#PrintSym"><span class="hs-identifier hs-var">PrintSym</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-var">LitSymE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;IntHash&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0)
-&gt; [(Var, [Ty0], Ty0, Exp0)] -&gt; [(Var, [Ty0], Ty0, Exp0)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680989251"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-1680"></span><span>                                       </span><span class="annot"><span class="annottext">Ty0
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680989251"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1681"></span><span>                          </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1682"></span><span>                          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty0] -&gt; [Var] -&gt; [Var] -&gt; [(Ty0, Var, Var)]
forall a b c. [a] -&gt; [b] -&gt; [c] -&gt; [(a, b, c)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip3"><span class="hs-identifier hs-var">zip3</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((IsBoxed, Ty0) -&gt; Ty0) -&gt; [(IsBoxed, Ty0)] -&gt; [Ty0]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(IsBoxed, Ty0) -&gt; Ty0
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[(IsBoxed, Ty0)]
</span><a href="#local-6989586621680989244"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989245"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989246"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1683"></span><span>                </span><span id="local-6989586621680989258"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989258"><span class="hs-identifier hs-var">w1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;wildcard&quot;</span></span><span>
</span><span id="line-1684"></span><span>                </span><span id="local-6989586621680989259"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989259"><span class="hs-identifier hs-var">w2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;wildcard&quot;</span></span><span>
</span><span id="line-1685"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621680989260"><span class="hs-identifier hs-type">add_spaces</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PreExp"><span class="hs-identifier hs-type">PreExp</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#E0Ext"><span class="hs-identifier hs-type">E0Ext</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PreExp"><span class="hs-identifier hs-type">PreExp</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#E0Ext"><span class="hs-identifier hs-type">E0Ext</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1686"></span><span>                    </span><span id="local-6989586621680989260"><span class="annot"><span class="annottext">add_spaces :: [(Var, [Ty0], Ty0, Exp0)] -&gt; PassM [(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680989260"><span class="hs-identifier hs-var hs-var">add_spaces</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)] -&gt; PassM [(Var, [Ty0], Ty0, Exp0)]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1687"></span><span>                    </span><span class="annot"><a href="#local-6989586621680989260"><span class="hs-identifier hs-var">add_spaces</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621680989261"><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0)
</span><a href="#local-6989586621680989261"><span class="hs-identifier hs-var">z</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)] -&gt; PassM [(Var, [Ty0], Ty0, Exp0)]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0)
</span><a href="#local-6989586621680989261"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1688"></span><span>                    </span><span class="annot"><a href="#local-6989586621680989260"><span class="hs-identifier hs-var">add_spaces</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680989262"><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0)
</span><a href="#local-6989586621680989262"><span class="hs-identifier hs-var">z</span></a></span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680989263"><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680989263"><span class="hs-identifier hs-var">zs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1689"></span><span>                      </span><span id="local-6989586621680989264"><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680989264"><span class="hs-identifier hs-var">zs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)] -&gt; PassM [(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680989260"><span class="hs-identifier hs-var">add_spaces</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680989263"><span class="hs-identifier hs-var">zs</span></a></span><span>
</span><span id="line-1690"></span><span>                      </span><span id="local-6989586621680989265"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989265"><span class="hs-identifier hs-var">wi</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;wildcard&quot;</span></span><span>
</span><span id="line-1691"></span><span>                      </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)] -&gt; PassM [(Var, [Ty0], Ty0, Exp0)]
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)] -&gt; PassM [(Var, [Ty0], Ty0, Exp0)])
-&gt; [(Var, [Ty0], Ty0, Exp0)] -&gt; PassM [(Var, [Ty0], Ty0, Exp0)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0)
</span><a href="#local-6989586621680989262"><span class="hs-identifier hs-var">z</span></a></span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0)
-&gt; [(Var, [Ty0], Ty0, Exp0)] -&gt; [(Var, [Ty0], Ty0, Exp0)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989265"><span class="hs-identifier hs-var">wi</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Prim Ty0 -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#PrintSym"><span class="hs-identifier hs-var">PrintSym</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-var">LitSymE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0)
-&gt; [(Var, [Ty0], Ty0, Exp0)] -&gt; [(Var, [Ty0], Ty0, Exp0)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680989264"><span class="hs-identifier hs-var">zs'</span></a></span><span>
</span><span id="line-1692"></span><span>
</span><span id="line-1693"></span><span>                </span><span id="local-6989586621680989266"><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680989266"><span class="hs-identifier hs-var">bnds''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)] -&gt; PassM [(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680989260"><span class="hs-identifier hs-var">add_spaces</span></a></span><span> </span><span class="annot"><span class="annottext">([(Var, [Ty0], Ty0, Exp0)] -&gt; PassM [(Var, [Ty0], Ty0, Exp0)])
-&gt; [(Var, [Ty0], Ty0, Exp0)] -&gt; PassM [(Var, [Ty0], Ty0, Exp0)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989258"><span class="hs-identifier hs-var">w1</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Prim Ty0 -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#PrintSym"><span class="hs-identifier hs-var">PrintSym</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-var">LitSymE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989243"><span class="hs-identifier hs-var">dcon</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
-&gt; [(Var, [Ty0], Ty0, Exp0)] -&gt; [(Var, [Ty0], Ty0, Exp0)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680989247"><span class="hs-identifier hs-var">bnds</span></a></span><span>
</span><span id="line-1694"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680989267"><span class="annot"><span class="annottext">bnds' :: [(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680989267"><span class="hs-identifier hs-var hs-var">bnds'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680989266"><span class="hs-identifier hs-var">bnds''</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
-&gt; [(Var, [Ty0], Ty0, Exp0)] -&gt; [(Var, [Ty0], Ty0, Exp0)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989259"><span class="hs-identifier hs-var">w2</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Prim Ty0 -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#PrintSym"><span class="hs-identifier hs-var">PrintSym</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-var">LitSymE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1695"></span><span>                    </span><span id="local-6989586621680989268"><span class="annot"><span class="annottext">bod :: Exp0
</span><a href="#local-6989586621680989268"><span class="hs-identifier hs-var hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)] -&gt; Exp0 -&gt; Exp0
forall loc dec (ext :: * -&gt; * -&gt; *).
[(Var, [loc], dec, PreExp ext loc dec)]
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.html#mkLets"><span class="hs-identifier hs-var">mkLets</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Ty0], Ty0, Exp0)]
</span><a href="#local-6989586621680989267"><span class="hs-identifier hs-var">bnds'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
[PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-var">MkProdE</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1696"></span><span>                </span><span class="annot"><span class="annottext">([Char], [(Var, Ty0)], Exp0) -&gt; PassM ([Char], [(Var, Ty0)], Exp0)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989243"><span class="hs-identifier hs-var">dcon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; (Var, Ty0)) -&gt; [Var] -&gt; [(Var, Ty0)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680989269"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989269"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989269"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989245"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989268"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1697"></span><span>  </span><span class="annot"><span class="annottext">FunDef0 -&gt; PassM FunDef0
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(FunDef0 -&gt; PassM FunDef0) -&gt; FunDef0 -&gt; PassM FunDef0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funName :: Var
</span><a href="Gibbon.Language.Syntax.html#funName"><span class="hs-identifier hs-var">funName</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Var
</span><a href="Gibbon.Language.Constants.html#mkPrinterName"><span class="hs-identifier hs-var">mkPrinterName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Char]
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989239"><span class="hs-identifier hs-var">tyName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1698"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funArgs :: [Var]
</span><a href="Gibbon.Language.Syntax.html#funArgs"><span class="hs-identifier hs-var">funArgs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989241"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1699"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funTy :: ArrowTy (TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#funTy"><span class="hs-identifier hs-var">funTy</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TyVar] -&gt; Ty0 -&gt; TyScheme
</span><a href="Gibbon.L0.Syntax.html#ForAll"><span class="hs-identifier hs-var">ForAll</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ArrowTy"><span class="hs-identifier hs-var">ArrowTy</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char] -&gt; [Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#PackedTy"><span class="hs-identifier hs-var">PackedTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Char]
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989239"><span class="hs-identifier hs-var">tyName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1700"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funBody :: Exp0
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [([Char], [(Var, Ty0)], Exp0)] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; [([Char], [(Var, loc)], PreExp ext loc dec)]
-&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-var">CaseE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989241"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680989242"><span class="hs-identifier hs-var">casebod</span></a></span><span>
</span><span id="line-1701"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funMeta :: FunMeta
</span><a href="Gibbon.Language.Syntax.html#funMeta"><span class="hs-identifier hs-var">funMeta</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunMeta"><span class="hs-identifier hs-type">FunMeta</span></a></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funRec :: FunRec
</span><a href="Gibbon.Language.Syntax.html#funRec"><span class="hs-identifier hs-var">funRec</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunRec
</span><a href="Gibbon.Language.Syntax.html#Rec"><span class="hs-identifier hs-var">Rec</span></a></span><span>
</span><span id="line-1702"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funInline :: FunInline
</span><a href="Gibbon.Language.Syntax.html#funInline"><span class="hs-identifier hs-var">funInline</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunInline
</span><a href="Gibbon.Language.Syntax.html#NoInline"><span class="hs-identifier hs-var">NoInline</span></a></span><span>
</span><span id="line-1703"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funCanTriggerGC :: IsBoxed
</span><a href="Gibbon.Language.Syntax.html#funCanTriggerGC"><span class="hs-identifier hs-var">funCanTriggerGC</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-1704"></span><span>                                       </span><span class="hs-special">}</span><span>
</span><span id="line-1705"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-1706"></span><span>
</span><span id="line-1707"></span><span>
</span><span id="line-1708"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-1709"></span><span>
</span><span id="line-1710"></span><span class="hs-comment">-------------------------------------------------------------------------------</span><span>
</span><span id="line-1711"></span><span>
</span><span id="line-1712"></span><span class="hs-keyword">type</span><span> </span><span id="FloatState"><span class="annot"><a href="Gibbon.L0.Specialize2.html#FloatState"><span class="hs-identifier hs-var">FloatState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#FunDefs0"><span class="hs-identifier hs-type">FunDefs0</span></a></span><span>
</span><span id="line-1713"></span><span class="hs-keyword">type</span><span> </span><span id="FloatM"><span class="annot"><a href="Gibbon.L0.Specialize2.html#FloatM"><span class="hs-identifier hs-var">FloatM</span></a></span></span><span> </span><span id="local-6989586621680989271"><span class="annot"><a href="#local-6989586621680989271"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#FloatState"><span class="hs-identifier hs-type">FloatState</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680989271"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-1714"></span><span>
</span><span id="line-1715"></span><span class="annot"><a href="Gibbon.L0.Specialize2.html#floatOutCase"><span class="hs-identifier hs-type">floatOutCase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Prog0"><span class="hs-identifier hs-type">Prog0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Prog0"><span class="hs-identifier hs-type">Prog0</span></a></span><span>
</span><span id="line-1716"></span><span id="floatOutCase"><span class="annot"><span class="annottext">floatOutCase :: Prog0 -&gt; PassM Prog0
</span><a href="Gibbon.L0.Specialize2.html#floatOutCase"><span class="hs-identifier hs-var hs-var">floatOutCase</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span id="local-6989586621680989375"><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
</span><a href="#local-6989586621680989375"><span class="hs-identifier hs-var">ddefs</span></a></span></span><span> </span><span id="local-6989586621680989376"><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680989376"><span class="hs-identifier hs-var">fundefs</span></a></span></span><span> </span><span id="local-6989586621680989377"><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
</span><a href="#local-6989586621680989377"><span class="hs-identifier hs-var">mainExp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1717"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680989378"><span class="annot"><span class="annottext">float_m :: StateT (FunDefs Exp0) PassM (Maybe (Exp0, Ty0))
</span><a href="#local-6989586621680989378"><span class="hs-identifier hs-var hs-var">float_m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1718"></span><span>          </span><span class="annot"><span class="annottext">(FunDef0 -&gt; StateT (FunDefs Exp0) PassM ())
-&gt; [FunDef0] -&gt; StateT (FunDefs Exp0) PassM ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span>
</span><span id="line-1719"></span><span>            </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680989379"><span class="annot"><span class="annottext">fn :: FunDef0
</span><a href="#local-6989586621680989379"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span class="hs-special">{</span><span id="local-6989586621680989380"><span class="annot"><span class="annottext">Var
funName :: forall ex. FunDef ex -&gt; Var
funName :: Var
</span><a href="Gibbon.Language.Syntax.html#funName"><span class="hs-identifier hs-var hs-var">funName</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680989381"><span class="annot"><span class="annottext">[Var]
funArgs :: forall ex. FunDef ex -&gt; [Var]
funArgs :: [Var]
</span><a href="Gibbon.Language.Syntax.html#funArgs"><span class="hs-identifier hs-var hs-var">funArgs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680989382"><span class="annot"><span class="annottext">ArrowTy (TyOf Exp0)
funTy :: forall ex. FunDef ex -&gt; ArrowTy (TyOf ex)
funTy :: ArrowTy (TyOf Exp0)
</span><a href="Gibbon.Language.Syntax.html#funTy"><span class="hs-identifier hs-var hs-var">funTy</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680989383"><span class="annot"><span class="annottext">Exp0
funBody :: forall ex. FunDef ex -&gt; ex
funBody :: Exp0
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var hs-var">funBody</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1720"></span><span>                  </span><span id="local-6989586621680989384"><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680989384"><span class="hs-identifier hs-var">fstate</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT (FunDefs Exp0) PassM (FunDefs Exp0)
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-1721"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680989385"><span class="annot"><span class="annottext">venv :: TyEnv Ty0
</span><a href="#local-6989586621680989385"><span class="hs-identifier hs-var hs-var">venv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)] -&gt; TyEnv Ty0
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; [Ty0] -&gt; [(Var, Ty0)]
forall a b.
(Show a, Show b, HasCallStack) =&gt;
[a] -&gt; [b] -&gt; [(a, b)]
</span><a href="Gibbon.Common.html#fragileZip"><span class="hs-identifier hs-var">fragileZip</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989381"><span class="hs-identifier hs-var">funArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArrowTy Ty0 -&gt; [Ty0]
forall ty. FunctionTy ty =&gt; ArrowTy ty -&gt; [ty]
</span><a href="Gibbon.Language.Syntax.html#inTys"><span class="hs-identifier hs-var">inTys</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy (TyOf Exp0)
ArrowTy Ty0
</span><a href="#local-6989586621680989382"><span class="hs-identifier hs-var">funTy</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1722"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680989386"><span class="annot"><span class="annottext">env2 :: Env2 Ty0
</span><a href="#local-6989586621680989386"><span class="hs-identifier hs-var hs-var">env2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyEnv Ty0 -&gt; TyEnv (ArrowTy Ty0) -&gt; Env2 Ty0
forall a. TyEnv a -&gt; TyEnv (ArrowTy a) -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#Env2"><span class="hs-identifier hs-var">Env2</span></a></span><span> </span><span class="annot"><span class="annottext">TyEnv Ty0
</span><a href="#local-6989586621680989385"><span class="hs-identifier hs-var">venv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunDefs Exp0 -&gt; TyEnv (ArrowTy (TyOf Exp0))
forall a. FunDefs a -&gt; TyEnv (ArrowTy (TyOf a))
</span><a href="Gibbon.Language.Syntax.html#initFunEnv"><span class="hs-identifier hs-var">initFunEnv</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680989384"><span class="hs-identifier hs-var">fstate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1723"></span><span>                  </span><span id="local-6989586621680989387"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989387"><span class="hs-identifier hs-var">funBody'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IsBoxed -&gt; Env2 Ty0 -&gt; Exp0 -&gt; FloatM Exp0
</span><a href="#local-6989586621680989388"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680989386"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989383"><span class="hs-identifier hs-var">funBody</span></a></span><span>
</span><span id="line-1724"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680989389"><span class="annot"><span class="annottext">fn' :: FunDef0
</span><a href="#local-6989586621680989389"><span class="hs-identifier hs-var hs-var">fn'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680989379"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funBody :: Exp0
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989387"><span class="hs-identifier hs-var">funBody'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1725"></span><span>                  </span><span class="annot"><span class="annottext">(FunDefs Exp0 -&gt; ((), FunDefs Exp0))
-&gt; StateT (FunDefs Exp0) PassM ()
forall a.
(FunDefs Exp0 -&gt; (a, FunDefs Exp0))
-&gt; StateT (FunDefs Exp0) PassM a
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; (a, s)) -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#state"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680989390"><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680989390"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; FunDef0 -&gt; FunDefs Exp0 -&gt; FunDefs Exp0
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989380"><span class="hs-identifier hs-var">funName</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680989389"><span class="hs-identifier hs-var">fn'</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680989390"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1726"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunDefs Exp0 -&gt; [FunDef0]
forall k a. Map k a -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#elems"><span class="hs-identifier hs-var">M.elems</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680989376"><span class="hs-identifier hs-var">fundefs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1727"></span><span>          </span><span id="local-6989586621680989391"><span class="annot"><span class="annottext">Maybe (Exp0, Ty0)
</span><a href="#local-6989586621680989391"><span class="hs-identifier hs-var">float_main</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1728"></span><span>             </span><span id="local-6989586621680989392"><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680989392"><span class="hs-identifier hs-var">fstate</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT (FunDefs Exp0) PassM (FunDefs Exp0)
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-1729"></span><span>             </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680989393"><span class="annot"><span class="annottext">env2 :: Env2 Ty0
</span><a href="#local-6989586621680989393"><span class="hs-identifier hs-var hs-var">env2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyEnv Ty0 -&gt; TyEnv (ArrowTy Ty0) -&gt; Env2 Ty0
forall a. TyEnv a -&gt; TyEnv (ArrowTy a) -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#Env2"><span class="hs-identifier hs-var">Env2</span></a></span><span> </span><span class="annot"><span class="annottext">TyEnv Ty0
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunDefs Exp0 -&gt; TyEnv (ArrowTy (TyOf Exp0))
forall a. FunDefs a -&gt; TyEnv (ArrowTy (TyOf a))
</span><a href="Gibbon.Language.Syntax.html#initFunEnv"><span class="hs-identifier hs-var">initFunEnv</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680989392"><span class="hs-identifier hs-var">fstate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1730"></span><span>             </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
</span><a href="#local-6989586621680989377"><span class="hs-identifier hs-var">mainExp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1731"></span><span>               </span><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp0, Ty0)
-&gt; StateT (FunDefs Exp0) PassM (Maybe (Exp0, Ty0))
forall a. a -&gt; StateT (FunDefs Exp0) PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Exp0, Ty0)
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1732"></span><span>               </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680989394"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989394"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680989395"><span class="annot"><span class="annottext">TyOf Exp0
</span><a href="#local-6989586621680989395"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Exp0, Ty0) -&gt; Maybe (Exp0, Ty0)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">((Exp0, Ty0) -&gt; Maybe (Exp0, Ty0))
-&gt; (Exp0 -&gt; (Exp0, Ty0)) -&gt; Exp0 -&gt; Maybe (Exp0, Ty0)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><span class="annottext">TyOf Exp0
Ty0
</span><a href="#local-6989586621680989395"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Maybe (Exp0, Ty0))
-&gt; FloatM Exp0 -&gt; StateT (FunDefs Exp0) PassM (Maybe (Exp0, Ty0))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IsBoxed -&gt; Env2 Ty0 -&gt; Exp0 -&gt; FloatM Exp0
</span><a href="#local-6989586621680989388"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680989393"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989394"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1733"></span><span>          </span><span class="annot"><span class="annottext">Maybe (Exp0, Ty0)
-&gt; StateT (FunDefs Exp0) PassM (Maybe (Exp0, Ty0))
forall a. a -&gt; StateT (FunDefs Exp0) PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Exp0, Ty0)
</span><a href="#local-6989586621680989391"><span class="hs-identifier hs-var">float_main</span></a></span><span>
</span><span id="line-1734"></span><span>
</span><span id="line-1735"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680989396"><span class="annot"><span class="annottext">Maybe (Exp0, Ty0)
</span><a href="#local-6989586621680989396"><span class="hs-identifier hs-var">mainExp'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680989397"><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680989397"><span class="hs-identifier hs-var">state'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT (FunDefs Exp0) PassM (Maybe (Exp0, Ty0))
-&gt; FunDefs Exp0 -&gt; PassM (Maybe (Exp0, Ty0), FunDefs Exp0)
forall s (m :: * -&gt; *) a. StateT s m a -&gt; s -&gt; m (a, s)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#runStateT"><span class="hs-identifier hs-var">runStateT</span></a></span><span> </span><span class="annot"><span class="annottext">StateT (FunDefs Exp0) PassM (Maybe (Exp0, Ty0))
</span><a href="#local-6989586621680989378"><span class="hs-identifier hs-var">float_m</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680989376"><span class="hs-identifier hs-var">fundefs</span></a></span><span>
</span><span id="line-1736"></span><span>    </span><span class="annot"><span class="annottext">Prog0 -&gt; PassM Prog0
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Prog0 -&gt; PassM Prog0) -&gt; Prog0 -&gt; PassM Prog0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
-&gt; FunDefs Exp0 -&gt; Maybe (Exp0, TyOf Exp0) -&gt; Prog0
forall ex.
DDefs (TyOf ex) -&gt; FunDefs ex -&gt; Maybe (ex, TyOf ex) -&gt; Prog ex
</span><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-var">Prog</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
</span><a href="#local-6989586621680989375"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680989397"><span class="hs-identifier hs-var">state'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Exp0, TyOf Exp0)
Maybe (Exp0, Ty0)
</span><a href="#local-6989586621680989396"><span class="hs-identifier hs-var">mainExp'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1737"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1738"></span><span>    </span><span id="local-6989586621680989402"><span class="annot"><span class="annottext">err1 :: [Char] -&gt; a
</span><a href="#local-6989586621680989402"><span class="hs-identifier hs-var hs-var">err1</span></a></span></span><span> </span><span id="local-6989586621680989403"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989403"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; a
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; a) -&gt; [Char] -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;floatOutCase: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989403"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-1739"></span><span>
</span><span id="line-1740"></span><span>    </span><span class="annot"><a href="#local-6989586621680989404"><span class="hs-identifier hs-type">float_fn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Env2"><span class="hs-identifier hs-type">Env2</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#FloatM"><span class="hs-identifier hs-type">FloatM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span>
</span><span id="line-1741"></span><span>    </span><span id="local-6989586621680989404"><span class="annot"><span class="annottext">float_fn :: Env2 Ty0 -&gt; Exp0 -&gt; FloatM Exp0
</span><a href="#local-6989586621680989404"><span class="hs-identifier hs-var hs-var">float_fn</span></a></span></span><span> </span><span id="local-6989586621680989405"><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680989405"><span class="hs-identifier hs-var">env2</span></a></span></span><span> </span><span id="local-6989586621680989406"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989406"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1742"></span><span>      </span><span id="local-6989586621680989407"><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680989407"><span class="hs-identifier hs-var">fundefs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT (FunDefs Exp0) PassM (FunDefs Exp0)
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-1743"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680989408"><span class="annot"><span class="annottext">fenv' :: TyEnv (ArrowTy (TyOf Exp0))
</span><a href="#local-6989586621680989408"><span class="hs-identifier hs-var hs-var">fenv'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FunDef0 -&gt; ArrowTy (TyOf Exp0))
-&gt; FunDefs Exp0 -&gt; TyEnv (ArrowTy (TyOf Exp0))
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#map"><span class="hs-identifier hs-var">M.map</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef0 -&gt; ArrowTy (TyOf Exp0)
forall ex. FunDef ex -&gt; ArrowTy (TyOf ex)
</span><a href="Gibbon.Language.Syntax.html#funTy"><span class="hs-identifier hs-var">funTy</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680989407"><span class="hs-identifier hs-var">fundefs'</span></a></span><span>
</span><span id="line-1744"></span><span>          </span><span id="local-6989586621680989409"><span class="annot"><span class="annottext">env2' :: Env2 Ty0
</span><a href="#local-6989586621680989409"><span class="hs-identifier hs-var hs-var">env2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680989405"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">fEnv :: TyEnv (ArrowTy Ty0)
</span><a href="Gibbon.Language.Syntax.html#fEnv"><span class="hs-identifier hs-var">fEnv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyEnv (ArrowTy (TyOf Exp0))
TyEnv (ArrowTy Ty0)
</span><a href="#local-6989586621680989408"><span class="hs-identifier hs-var">fenv'</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1745"></span><span>          </span><span id="local-6989586621680989410"><span class="annot"><span class="annottext">free :: [Var]
</span><a href="#local-6989586621680989410"><span class="hs-identifier hs-var hs-var">free</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; [Var]
forall a. Set a -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#toList"><span class="hs-identifier hs-var">S.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(Set Var -&gt; [Var]) -&gt; Set Var -&gt; [Var]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Set Var
forall a. FreeVars a =&gt; a -&gt; Set Var
</span><a href="Gibbon.Language.Syntax.html#gFreeVars"><span class="hs-identifier hs-var">gFreeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989406"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; Set Var -&gt; Set Var
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#difference"><span class="hs-operator hs-var">`S.difference`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunDefs Exp0 -&gt; Set Var
forall k a. Map k a -&gt; Set k
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#keysSet"><span class="hs-identifier hs-var">M.keysSet</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680989407"><span class="hs-identifier hs-var">fundefs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1746"></span><span>          </span><span id="local-6989586621680989411"><span class="annot"><span class="annottext">in_tys :: [Ty0]
</span><a href="#local-6989586621680989411"><span class="hs-identifier hs-var hs-var">in_tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; Ty0) -&gt; [Var] -&gt; [Ty0]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680989412"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989412"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Env2 Ty0 -&gt; Ty0
forall a. Out a =&gt; Var -&gt; Env2 a -&gt; a
</span><a href="Gibbon.Language.Syntax.html#lookupVEnv"><span class="hs-identifier hs-var">lookupVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989412"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680989409"><span class="hs-identifier hs-var">env2'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989410"><span class="hs-identifier hs-var">free</span></a></span><span>
</span><span id="line-1747"></span><span>          </span><span id="local-6989586621680989413"><span class="annot"><span class="annottext">ret_ty :: Ty0
</span><a href="#local-6989586621680989413"><span class="hs-identifier hs-var hs-var">ret_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; Env2 Ty0 -&gt; Exp0 -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#recoverType"><span class="hs-identifier hs-var">recoverType</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
Map Var DDef0
</span><a href="#local-6989586621680989375"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680989409"><span class="hs-identifier hs-var">env2'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989406"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1748"></span><span>          </span><span id="local-6989586621680989414"><span class="annot"><span class="annottext">fn_ty :: TyScheme
</span><a href="#local-6989586621680989414"><span class="hs-identifier hs-var hs-var">fn_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TyVar] -&gt; Ty0 -&gt; TyScheme
</span><a href="Gibbon.L0.Syntax.html#ForAll"><span class="hs-identifier hs-var">ForAll</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty0] -&gt; Ty0 -&gt; Ty0
</span><a href="Gibbon.L0.Syntax.html#ArrowTy"><span class="hs-identifier hs-var">ArrowTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680989411"><span class="hs-identifier hs-var">in_tys</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989413"><span class="hs-identifier hs-var">ret_ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1749"></span><span>      </span><span id="local-6989586621680989415"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989415"><span class="hs-identifier hs-var">fn_name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PassM Var -&gt; StateT (FunDefs Exp0) PassM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT (FunDefs Exp0) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Var -&gt; StateT (FunDefs Exp0) PassM Var)
-&gt; PassM Var -&gt; StateT (FunDefs Exp0) PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;caseFn&quot;</span></span><span>
</span><span id="line-1750"></span><span>      </span><span id="local-6989586621680989416"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989416"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; StateT (FunDefs Exp0) PassM Var)
-&gt; [Var] -&gt; StateT (FunDefs Exp0) PassM [Var]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680989417"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989417"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PassM Var -&gt; StateT (FunDefs Exp0) PassM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT (FunDefs Exp0) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Var -&gt; StateT (FunDefs Exp0) PassM Var)
-&gt; PassM Var -&gt; StateT (FunDefs Exp0) PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989417"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989410"><span class="hs-identifier hs-var">free</span></a></span><span>
</span><span id="line-1751"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680989418"><span class="annot"><span class="annottext">ex' :: Exp0
</span><a href="#local-6989586621680989418"><span class="hs-identifier hs-var hs-var">ex'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Var, Var) -&gt; Exp0 -&gt; Exp0) -&gt; Exp0 -&gt; [(Var, Var)] -&gt; Exp0
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680989419"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989419"><span class="hs-identifier hs-var">from</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680989420"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989420"><span class="hs-identifier hs-var">to</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680989421"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989421"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp0 -&gt; Exp0 -&gt; Exp0
forall e. Substitutable e =&gt; Var -&gt; e -&gt; e -&gt; e
</span><a href="Gibbon.Language.Syntax.html#gSubst"><span class="hs-identifier hs-var">gSubst</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989419"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989420"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989421"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989406"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [(Var, Var)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989410"><span class="hs-identifier hs-var">free</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989416"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1752"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680989422"><span class="annot"><span class="annottext">fn :: FunDef0
</span><a href="#local-6989586621680989422"><span class="hs-identifier hs-var hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; ArrowTy (TyOf Exp0) -&gt; Exp0 -&gt; FunMeta -&gt; FunDef0
forall ex.
Var -&gt; [Var] -&gt; ArrowTy (TyOf ex) -&gt; ex -&gt; FunMeta -&gt; FunDef ex
</span><a href="Gibbon.Language.Syntax.html#FunDef"><span class="hs-identifier hs-var">FunDef</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989415"><span class="hs-identifier hs-var">fn_name</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989416"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy (TyOf Exp0)
TyScheme
</span><a href="#local-6989586621680989414"><span class="hs-identifier hs-var">fn_ty</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989418"><span class="hs-identifier hs-var">ex'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunRec -&gt; FunInline -&gt; IsBoxed -&gt; FunMeta
</span><a href="Gibbon.Language.Syntax.html#FunMeta"><span class="hs-identifier hs-var">FunMeta</span></a></span><span> </span><span class="annot"><span class="annottext">FunRec
</span><a href="Gibbon.Language.Syntax.html#NotRec"><span class="hs-identifier hs-var">NotRec</span></a></span><span> </span><span class="annot"><span class="annottext">FunInline
</span><a href="Gibbon.Language.Syntax.html#NoInline"><span class="hs-identifier hs-var">NoInline</span></a></span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1753"></span><span>      </span><span class="annot"><span class="annottext">(FunDefs Exp0 -&gt; (Exp0, FunDefs Exp0)) -&gt; FloatM Exp0
forall a.
(FunDefs Exp0 -&gt; (a, FunDefs Exp0))
-&gt; StateT (FunDefs Exp0) PassM a
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; (a, s)) -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#state"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680989423"><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680989423"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989415"><span class="hs-identifier hs-var">fn_name</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var -&gt; Exp0) -&gt; [Var] -&gt; [Exp0]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989410"><span class="hs-identifier hs-var">free</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; FunDef0 -&gt; FunDefs Exp0 -&gt; FunDefs Exp0
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989415"><span class="hs-identifier hs-var">fn_name</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef0
</span><a href="#local-6989586621680989422"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp0
</span><a href="#local-6989586621680989423"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1754"></span><span>
</span><span id="line-1755"></span><span>    </span><span class="annot"><a href="#local-6989586621680989388"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Env2"><span class="hs-identifier hs-type">Env2</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Ty0"><span class="hs-identifier hs-type">Ty0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html#FloatM"><span class="hs-identifier hs-type">FloatM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">Exp0</span></a></span><span>
</span><span id="line-1756"></span><span>    </span><span id="local-6989586621680989388"><span class="annot"><span class="annottext">go :: IsBoxed -&gt; Env2 Ty0 -&gt; Exp0 -&gt; FloatM Exp0
</span><a href="#local-6989586621680989388"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680989424"><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680989424"><span class="hs-identifier hs-var">float</span></a></span></span><span> </span><span id="local-6989586621680989425"><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680989425"><span class="hs-identifier hs-var">env2</span></a></span></span><span> </span><span id="local-6989586621680989426"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989426"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1757"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989426"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1758"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; FloatM Exp0
forall a. a -&gt; StateT (FunDefs Exp0) PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989426"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1759"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-type">LitE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; FloatM Exp0
forall a. a -&gt; StateT (FunDefs Exp0) PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989426"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1760"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CharE"><span class="hs-identifier hs-type">CharE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; FloatM Exp0
forall a. a -&gt; StateT (FunDefs Exp0) PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989426"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1761"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-type">FloatE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; FloatM Exp0
forall a. a -&gt; StateT (FunDefs Exp0) PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989426"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1762"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-type">LitSymE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; FloatM Exp0
forall a. a -&gt; StateT (FunDefs Exp0) PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989426"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1763"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span id="local-6989586621680989427"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989427"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680989428"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680989428"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span> </span><span id="local-6989586621680989429"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680989429"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989427"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680989428"><span class="hs-identifier hs-var">tyapps</span></a></span><span> </span><span class="annot"><span class="annottext">([Exp0] -&gt; Exp0)
-&gt; StateT (FunDefs Exp0) PassM [Exp0] -&gt; FloatM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; FloatM Exp0)
-&gt; [Exp0] -&gt; StateT (FunDefs Exp0) PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; FloatM Exp0
</span><a href="#local-6989586621680989430"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680989429"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1764"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span id="local-6989586621680989431"><span class="annot"><span class="annottext">Prim Ty0
</span><a href="#local-6989586621680989431"><span class="hs-identifier hs-var">pr</span></a></span></span><span> </span><span id="local-6989586621680989432"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680989432"><span class="hs-identifier hs-var">args</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1765"></span><span>          </span><span id="local-6989586621680989433"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680989433"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; FloatM Exp0)
-&gt; [Exp0] -&gt; StateT (FunDefs Exp0) PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; FloatM Exp0
</span><a href="#local-6989586621680989430"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680989432"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1766"></span><span>          </span><span class="annot"><span class="annottext">Exp0 -&gt; FloatM Exp0
forall a. a -&gt; StateT (FunDefs Exp0) PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; FloatM Exp0) -&gt; Exp0 -&gt; FloatM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0 -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty0
</span><a href="#local-6989586621680989431"><span class="hs-identifier hs-var">pr</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680989433"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-1767"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680989434"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989434"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680989435"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680989435"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680989436"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989436"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680989437"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989437"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680989438"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989438"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-1768"></span><span>          </span><span id="local-6989586621680989439"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989439"><span class="hs-identifier hs-var">rhs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IsBoxed -&gt; Env2 Ty0 -&gt; Exp0 -&gt; FloatM Exp0
</span><a href="#local-6989586621680989388"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680989425"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989437"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1769"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680989440"><span class="annot"><span class="annottext">env2' :: Env2 Ty0
</span><a href="#local-6989586621680989440"><span class="hs-identifier hs-var hs-var">env2'</span></a></span></span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Ty0 -&gt; Env2 Ty0 -&gt; Env2 Ty0
forall a. Var -&gt; a -&gt; Env2 a -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989434"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989436"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680989425"><span class="hs-identifier hs-var">env2</span></a></span><span>
</span><span id="line-1770"></span><span>          </span><span id="local-6989586621680989441"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989441"><span class="hs-identifier hs-var">bod'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IsBoxed -&gt; Env2 Ty0 -&gt; Exp0 -&gt; FloatM Exp0
</span><a href="#local-6989586621680989388"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680989440"><span class="hs-identifier hs-var">env2'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989438"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-1771"></span><span>          </span><span class="annot"><span class="annottext">Exp0 -&gt; FloatM Exp0
forall a. a -&gt; StateT (FunDefs Exp0) PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; FloatM Exp0) -&gt; Exp0 -&gt; FloatM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, [Ty0], Ty0, Exp0) -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989434"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680989435"><span class="hs-identifier hs-var">tyapps</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989436"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989439"><span class="hs-identifier hs-var">rhs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989441"><span class="hs-identifier hs-var">bod'</span></a></span><span>
</span><span id="line-1772"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-type">IfE</span></a></span><span> </span><span id="local-6989586621680989442"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989442"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680989443"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989443"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680989444"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989444"><span class="hs-identifier hs-var">c</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Exp0 -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-var">IfE</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0 -&gt; Exp0 -&gt; Exp0)
-&gt; FloatM Exp0
-&gt; StateT (FunDefs Exp0) PassM (Exp0 -&gt; Exp0 -&gt; Exp0)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IsBoxed -&gt; Env2 Ty0 -&gt; Exp0 -&gt; FloatM Exp0
</span><a href="#local-6989586621680989388"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680989425"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989442"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">StateT (FunDefs Exp0) PassM (Exp0 -&gt; Exp0 -&gt; Exp0)
-&gt; FloatM Exp0 -&gt; StateT (FunDefs Exp0) PassM (Exp0 -&gt; Exp0)
forall a b.
StateT (FunDefs Exp0) PassM (a -&gt; b)
-&gt; StateT (FunDefs Exp0) PassM a -&gt; StateT (FunDefs Exp0) PassM b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IsBoxed -&gt; Env2 Ty0 -&gt; Exp0 -&gt; FloatM Exp0
</span><a href="#local-6989586621680989388"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680989425"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989443"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">StateT (FunDefs Exp0) PassM (Exp0 -&gt; Exp0)
-&gt; FloatM Exp0 -&gt; FloatM Exp0
forall a b.
StateT (FunDefs Exp0) PassM (a -&gt; b)
-&gt; StateT (FunDefs Exp0) PassM a -&gt; StateT (FunDefs Exp0) PassM b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IsBoxed -&gt; Env2 Ty0 -&gt; Exp0 -&gt; FloatM Exp0
</span><a href="#local-6989586621680989388"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680989425"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989444"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-1773"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-type">MkProdE</span></a></span><span> </span><span id="local-6989586621680989445"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680989445"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
[PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-var">MkProdE</span></a></span><span> </span><span class="annot"><span class="annottext">([Exp0] -&gt; Exp0)
-&gt; StateT (FunDefs Exp0) PassM [Exp0] -&gt; FloatM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; FloatM Exp0)
-&gt; [Exp0] -&gt; StateT (FunDefs Exp0) PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; FloatM Exp0
</span><a href="#local-6989586621680989430"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680989445"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1774"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-type">ProjE</span></a></span><span> </span><span id="local-6989586621680989446"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680989446"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680989447"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989447"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Int -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-var">ProjE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680989446"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0) -&gt; FloatM Exp0 -&gt; FloatM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; FloatM Exp0
</span><a href="#local-6989586621680989430"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989447"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1775"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-type">CaseE</span></a></span><span> </span><span id="local-6989586621680989448"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989448"><span class="hs-identifier hs-var">scrt</span></a></span></span><span> </span><span id="local-6989586621680989449"><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680989449"><span class="hs-identifier hs-var">brs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1776"></span><span>          </span><span id="local-6989586621680989450"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989450"><span class="hs-identifier hs-var">scrt'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IsBoxed -&gt; Env2 Ty0 -&gt; Exp0 -&gt; FloatM Exp0
</span><a href="#local-6989586621680989388"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680989424"><span class="hs-identifier hs-var">float</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680989425"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989448"><span class="hs-identifier hs-var">scrt</span></a></span><span>
</span><span id="line-1777"></span><span>          </span><span id="local-6989586621680989451"><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680989451"><span class="hs-identifier hs-var">brs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(([Char], [(Var, Ty0)], Exp0)
 -&gt; StateT (FunDefs Exp0) PassM ([Char], [(Var, Ty0)], Exp0))
-&gt; [([Char], [(Var, Ty0)], Exp0)]
-&gt; StateT (FunDefs Exp0) PassM [([Char], [(Var, Ty0)], Exp0)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680989452"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989452"><span class="hs-identifier hs-var">dcon</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680989453"><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680989453"><span class="hs-identifier hs-var">vtys</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680989454"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989454"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1778"></span><span>                          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680989455"><span class="annot"><span class="annottext">vars :: [Var]
</span><a href="#local-6989586621680989455"><span class="hs-identifier hs-var hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Var, Ty0) -&gt; Var) -&gt; [(Var, Ty0)] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty0) -&gt; Var
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680989453"><span class="hs-identifier hs-var">vtys</span></a></span><span>
</span><span id="line-1779"></span><span>                          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680989456"><span class="annot"><span class="annottext">tys :: [Ty0]
</span><a href="#local-6989586621680989456"><span class="hs-identifier hs-var hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var DDef0 -&gt; [Char] -&gt; [Ty0]
forall a. Out a =&gt; DDefs a -&gt; [Char] -&gt; [a]
</span><a href="Gibbon.Language.Syntax.html#lookupDataCon"><span class="hs-identifier hs-var">lookupDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp0)
Map Var DDef0
</span><a href="#local-6989586621680989375"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989452"><span class="hs-identifier hs-var">dcon</span></a></span><span>
</span><span id="line-1780"></span><span>                          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680989457"><span class="annot"><span class="annottext">env2' :: Env2 Ty0
</span><a href="#local-6989586621680989457"><span class="hs-identifier hs-var hs-var">env2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyEnv Ty0 -&gt; Env2 Ty0 -&gt; Env2 Ty0
forall a. Map Var a -&gt; Env2 a -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#extendsVEnv"><span class="hs-identifier hs-var">extendsVEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, Ty0)] -&gt; TyEnv Ty0
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; [Ty0] -&gt; [(Var, Ty0)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680989455"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680989456"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680989425"><span class="hs-identifier hs-var">env2</span></a></span><span>
</span><span id="line-1781"></span><span>                          </span><span id="local-6989586621680989458"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989458"><span class="hs-identifier hs-var">rhs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IsBoxed -&gt; Env2 Ty0 -&gt; Exp0 -&gt; FloatM Exp0
</span><a href="#local-6989586621680989388"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680989457"><span class="hs-identifier hs-var">env2'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989454"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1782"></span><span>                          </span><span class="annot"><span class="annottext">([Char], [(Var, Ty0)], Exp0)
-&gt; StateT (FunDefs Exp0) PassM ([Char], [(Var, Ty0)], Exp0)
forall a. a -&gt; StateT (FunDefs Exp0) PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989452"><span class="hs-identifier hs-var">dcon</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(Var, Ty0)]
</span><a href="#local-6989586621680989453"><span class="hs-identifier hs-var">vtys</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989458"><span class="hs-identifier hs-var">rhs'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1783"></span><span>                       </span><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680989449"><span class="hs-identifier hs-var">brs</span></a></span><span>
</span><span id="line-1784"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680989424"><span class="hs-identifier hs-var">float</span></a></span><span>
</span><span id="line-1785"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Env2 Ty0 -&gt; Exp0 -&gt; FloatM Exp0
</span><a href="#local-6989586621680989404"><span class="hs-identifier hs-var">float_fn</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680989425"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; [([Char], [(Var, Ty0)], Exp0)] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; [([Char], [(Var, loc)], PreExp ext loc dec)]
-&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-var">CaseE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989450"><span class="hs-identifier hs-var">scrt'</span></a></span><span> </span><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680989451"><span class="hs-identifier hs-var">brs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1786"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; FloatM Exp0
forall a. a -&gt; StateT (FunDefs Exp0) PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; FloatM Exp0) -&gt; Exp0 -&gt; FloatM Exp0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; [([Char], [(Var, Ty0)], Exp0)] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; [([Char], [(Var, loc)], PreExp ext loc dec)]
-&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-var">CaseE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989450"><span class="hs-identifier hs-var">scrt'</span></a></span><span> </span><span class="annot"><span class="annottext">[([Char], [(Var, Ty0)], Exp0)]
</span><a href="#local-6989586621680989451"><span class="hs-identifier hs-var">brs'</span></a></span><span>
</span><span id="line-1787"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-type">DataConE</span></a></span><span> </span><span id="local-6989586621680989459"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989459"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680989460"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989460"><span class="hs-identifier hs-var">dcon</span></a></span></span><span> </span><span id="local-6989586621680989461"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680989461"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty0 -&gt; [Char] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
loc -&gt; [Char] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-var">DataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989459"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680989460"><span class="hs-identifier hs-var">dcon</span></a></span><span> </span><span class="annot"><span class="annottext">([Exp0] -&gt; Exp0)
-&gt; StateT (FunDefs Exp0) PassM [Exp0] -&gt; FloatM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; FloatM Exp0)
-&gt; [Exp0] -&gt; StateT (FunDefs Exp0) PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; FloatM Exp0
</span><a href="#local-6989586621680989430"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680989461"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1788"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-type">TimeIt</span></a></span><span> </span><span id="local-6989586621680989462"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989462"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680989463"><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989463"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680989464"><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680989464"><span class="hs-identifier hs-var">b</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680989465"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989465"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; Ty0 -&gt; IsBoxed -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec -&gt; dec -&gt; IsBoxed -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-var">TimeIt</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989465"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Ty0
</span><a href="#local-6989586621680989463"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680989464"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0) -&gt; FloatM Exp0 -&gt; FloatM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; FloatM Exp0
</span><a href="#local-6989586621680989430"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989462"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1789"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-type">WithArenaE</span></a></span><span> </span><span id="local-6989586621680989466"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989466"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680989467"><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989467"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp0 -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-var">WithArenaE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989466"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; Exp0) -&gt; FloatM Exp0 -&gt; FloatM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; FloatM Exp0
</span><a href="#local-6989586621680989430"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989467"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1790"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-type">SpawnE</span></a></span><span> </span><span id="local-6989586621680989468"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989468"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621680989469"><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680989469"><span class="hs-identifier hs-var">tyapps</span></a></span></span><span> </span><span id="local-6989586621680989470"><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680989470"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Ty0] -&gt; [Exp0] -&gt; Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-var">SpawnE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680989468"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty0]
</span><a href="#local-6989586621680989469"><span class="hs-identifier hs-var">tyapps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Exp0] -&gt; Exp0)
-&gt; StateT (FunDefs Exp0) PassM [Exp0] -&gt; FloatM Exp0
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp0 -&gt; FloatM Exp0)
-&gt; [Exp0] -&gt; StateT (FunDefs Exp0) PassM [Exp0]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; FloatM Exp0
</span><a href="#local-6989586621680989430"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp0]
</span><a href="#local-6989586621680989470"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1791"></span><span>        </span><span class="annot"><span class="annottext">Exp0
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; FloatM Exp0
forall a. a -&gt; StateT (FunDefs Exp0) PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
forall (ext :: * -&gt; * -&gt; *) loc dec. PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span>
</span><span id="line-1792"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp0 -&gt; FloatM Exp0
forall a. a -&gt; StateT (FunDefs Exp0) PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989426"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1793"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MapE"><span class="hs-identifier hs-type">MapE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; FloatM Exp0
forall {a}. [Char] -&gt; a
</span><a href="#local-6989586621680989402"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989426"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1794"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FoldE"><span class="hs-identifier hs-type">FoldE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; FloatM Exp0
forall {a}. [Char] -&gt; a
</span><a href="#local-6989586621680989402"><span class="hs-identifier hs-var">err1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp0 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp0
</span><a href="#local-6989586621680989426"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1795"></span><span>
</span><span id="line-1796"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1797"></span><span>        </span><span id="local-6989586621680989430"><span class="annot"><span class="annottext">recur :: Exp0 -&gt; FloatM Exp0
</span><a href="#local-6989586621680989430"><span class="hs-identifier hs-var hs-var">recur</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IsBoxed -&gt; Env2 Ty0 -&gt; Exp0 -&gt; FloatM Exp0
</span><a href="#local-6989586621680989388"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">IsBoxed
</span><a href="#local-6989586621680989424"><span class="hs-identifier hs-var">float</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty0
</span><a href="#local-6989586621680989425"><span class="hs-identifier hs-var">env2</span></a></span><span>
</span><span id="line-1798"></span></pre></body></html>
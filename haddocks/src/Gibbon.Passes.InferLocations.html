<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-name-shadowing #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-unused-matches #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="annot"><span class="hs-comment">-- | Convert from L1 to L2, adding region constructs.</span></span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Gibbon.Passes.InferLocations</span><span>
</span><span id="line-7"></span><span>    </span><span class="hs-special">(</span><span class="hs-comment">-- data types</span><span>
</span><span id="line-8"></span><span>     </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FullEnv"><span class="hs-identifier">FullEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier">TiM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#InferState"><span class="hs-identifier">InferState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Result"><span class="hs-identifier">Result</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#UnifyLoc"><span class="hs-identifier">UnifyLoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Failure"><span class="hs-identifier">Failure</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Dest"><span class="hs-identifier">Dest</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>     </span><span class="hs-comment">-- functions for manipulating locations</span><span>
</span><span id="line-10"></span><span>     </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#fresh"><span class="hs-identifier">fresh</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#freshUnifyLoc"><span class="hs-identifier">freshUnifyLoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#finalUnifyLoc"><span class="hs-identifier">finalUnifyLoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#fixLoc"><span class="hs-identifier">fixLoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#freshLocVar"><span class="hs-identifier">freshLocVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier">finalLocVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#assocLoc"><span class="hs-identifier">assocLoc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#finishExp"><span class="hs-identifier">finishExp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>          </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#prim"><span class="hs-keyword">prim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#emptyEnv"><span class="hs-identifier">emptyEnv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>     </span><span class="hs-comment">-- main functions</span><span>
</span><span id="line-13"></span><span>     </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#unify"><span class="hs-identifier">unify</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#inferLocs"><span class="hs-identifier">inferLocs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier">inferExp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#inferExp%27"><span class="hs-identifier">inferExp'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#convertFunTy"><span class="hs-identifier">convertFunTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#copyOutOfOrderPacked"><span class="hs-identifier">copyOutOfOrderPacked</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#fixRANs"><span class="hs-identifier">fixRANs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#removeAliasesForCopyCalls"><span class="hs-identifier">removeAliasesForCopyCalls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-comment">{-
  Basic Strategy
  --------------

The basic strategy here is to use a simple, type-directed pass to translate
programs from L1 to L2. First, we start with a function type, with the
basic starting assumption that all packed values will have distinct locations:

```
  f  :: Int -&gt; Tree -&gt; Tree
  f' :: forall l_1 in r_1, l_2 in r_2 . Int -&gt; Tree l_1 -&gt; Tree l_2
```

After this, the locations from the function type are treated as *fixed*, and
the inference procedure proceeds to walk through the body of the function.

To infer location bindings in an expression, we build up a set of *constraints*
and propogate them up the expression (ie, recurring on a sub-expression will
yield the constraints induced by that sub-expression). After recurring on
all sub-expressions, we use these constraints to determine whether to
emit a binding for a new location or a new region.

Constraints in location inference are very similar to constraints used
in type checking L2. When the expression in consideration is a data type
constructor, a series of constraints are generated: the locations for
each field in the constructor are constrained to occur after the previous one
(enforcing that they occur in the right order), and the first field must
occur after the tag of the data constructor itself.

Knowing all this *isn't enough* to generate the location bindings, however,
since the values that we use in the constructor may have been produced
by multiple different function calls (for example), so the locations
must carefully be bound earlier in the expression at the right locations.
Ideally, we also want them to be bound as tightly as possible, to avoid
binding locations that aren't used (eg, in some branches of a conditional).
So the constraints are *discharged* as the recursion unwinds.

For example, a constraint that location `loc1` occurs after the value `x2`
can safely be discharged after the value `x2` is bound, so in the handling
of a let binding for a packed value, we search through the constraints
returned by recurring on the body of the let and discharge any constraint
that invloves a location occurring after that newly-bound variable.

 Program repair
 --------------

During the inference procedure, unification will occur between locations,
and if two *fixed* locations are unified there will be an error thrown.
To recover, the procedure will have to transform (repair) the expression.
The simplest way to do this is to insert a copy.

Naively, this simple strategy will require lots of copies. For exmaple, the identity
function's type transforms as follows:

```
  id  :: Tree -&gt; Tree
  id' :: forall l1 in r1, l2 in r2 . Tree l1 -&gt; Tree l2
```

With this type, inferExp will immediately fail on the body of 'id x = x', requiring
a copy-insertion tactic to repair the failure and proceed.

Copy-insertion is very simple. For each data type, we generate a copy traversal
function which matches on each element of the structure. These functions undergo
location inference just like normal user code. During location inference when
a unification failure indicates a copy must be inserted, a call to `&quot;copy_Type&quot;`
is emitted, where `Type` is the name of the packed data type that must be copied.

-}</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.html"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Prelude.html"><span class="hs-identifier">Prelude</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Strict.html"><span class="hs-identifier">Control.Monad.Trans.State.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">St</span></span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Except.html"><span class="hs-identifier">Control.Monad.Trans.Except</span></a></span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.Trans.html"><span class="hs-identifier">Control.Monad.Trans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier">lift</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/GenericPretty-1.2.2-7277c36a966d41cd8e1371a7ee4c855b29a76e94dfe1d95510f68242766a5b82/share/doc/html/src/Text.PrettyPrint.GenericPretty.html"><span class="hs-identifier">Text.PrettyPrint.GenericPretty</span></a></span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Stack.html"><span class="hs-identifier">GHC.Stack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier">HasCallStack</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Gibbon.Common.html"><span class="hs-identifier">Gibbon.Common</span></a></span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html"><span class="hs-identifier">Gibbon.L1.Syntax</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L1</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#extendVEnv"><span class="hs-identifier">extendVEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#extendsVEnv"><span class="hs-identifier">extendsVEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#lookupVEnv"><span class="hs-identifier">lookupVEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#lookupFEnv"><span class="hs-identifier">lookupFEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html"><span class="hs-identifier">Gibbon.L1.Syntax</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L1</span></span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html"><span class="hs-identifier">Gibbon.L2.Syntax</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L2</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#extendVEnv"><span class="hs-identifier">extendVEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#extendsVEnv"><span class="hs-identifier">extendsVEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#lookupVEnv"><span class="hs-identifier">lookupVEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#lookupFEnv"><span class="hs-identifier">lookupFEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Gibbon.Passes.InlineTriv.html"><span class="hs-identifier">Gibbon.Passes.InlineTriv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.InlineTriv.html#inlineTriv"><span class="hs-identifier">inlineTriv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Gibbon.Passes.Flatten.html"><span class="hs-identifier">Gibbon.Passes.Flatten</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.Flatten.html#flattenL1"><span class="hs-identifier">flattenL1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- Environments</span><span>
</span><span id="line-108"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="annot"><span class="hs-comment">-- | Combine the different kinds of contextual information in-scope.</span></span><span>
</span><span id="line-111"></span><span class="hs-keyword">data</span><span> </span><span id="FullEnv"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FullEnv"><span class="hs-identifier hs-var">FullEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FullEnv"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FullEnv"><span class="hs-identifier hs-var">FullEnv</span></a></span></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="dataDefs"><span class="annot"><span class="annottext">FullEnv -&gt; DDefs Ty2
</span><a href="Gibbon.Passes.InferLocations.html#dataDefs"><span class="hs-identifier hs-var hs-var">dataDefs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DDefs"><span class="hs-identifier hs-type">DDefs</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Data type definitions</span></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="valEnv"><span class="annot"><span class="annottext">FullEnv -&gt; TyEnv Ty2
</span><a href="Gibbon.Passes.InferLocations.html#valEnv"><span class="hs-identifier hs-var hs-var">valEnv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#TyEnv"><span class="hs-identifier hs-type">TyEnv</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ Type env for local bindings</span></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="funEnv"><span class="annot"><span class="annottext">FullEnv -&gt; TyEnv (ArrowTy Ty2)
</span><a href="Gibbon.Passes.InferLocations.html#funEnv"><span class="hs-identifier hs-var hs-var">funEnv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#TyEnv"><span class="hs-identifier hs-type">TyEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#ArrowTy"><span class="hs-identifier hs-type">ArrowTy</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Top level fundef types</span></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621680963176"><span id="local-6989586621680963188"><span id="local-6989586621680963192"><span class="annot"><span class="annottext">Int -&gt; FullEnv -&gt; ShowS
[FullEnv] -&gt; ShowS
FullEnv -&gt; String
(Int -&gt; FullEnv -&gt; ShowS)
-&gt; (FullEnv -&gt; String) -&gt; ([FullEnv] -&gt; ShowS) -&gt; Show FullEnv
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; FullEnv -&gt; ShowS
showsPrec :: Int -&gt; FullEnv -&gt; ShowS
$cshow :: FullEnv -&gt; String
show :: FullEnv -&gt; String
$cshowList :: [FullEnv] -&gt; ShowS
showList :: [FullEnv] -&gt; ShowS
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-type">extendVEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FullEnv"><span class="hs-identifier hs-type">FullEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FullEnv"><span class="hs-identifier hs-type">FullEnv</span></a></span><span>
</span><span id="line-118"></span><span id="extendVEnv"><span class="annot"><span class="annottext">extendVEnv :: Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var hs-var">extendVEnv</span></a></span></span><span> </span><span id="local-6989586621680963202"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963202"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680963203"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680963203"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680963204"><span class="annot"><span class="annottext">fe :: FullEnv
</span><a href="#local-6989586621680963204"><span class="hs-identifier hs-var">fe</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FullEnv"><span class="hs-identifier hs-type">FullEnv</span></a></span><span class="hs-special">{</span><span id="local-6989586621680963205"><span class="annot"><span class="annottext">TyEnv Ty2
valEnv :: FullEnv -&gt; TyEnv Ty2
valEnv :: TyEnv Ty2
</span><a href="Gibbon.Passes.InferLocations.html#valEnv"><span class="hs-identifier hs-var hs-var">valEnv</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680963204"><span class="hs-identifier hs-var">fe</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">valEnv :: TyEnv Ty2
</span><a href="Gibbon.Passes.InferLocations.html#valEnv"><span class="hs-identifier hs-var">valEnv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; TyEnv Ty2 -&gt; TyEnv Ty2
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963202"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680963203"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">TyEnv Ty2
</span><a href="#local-6989586621680963205"><span class="hs-identifier hs-var">valEnv</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#extendsVEnv"><span class="hs-identifier hs-type">extendsVEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#TyEnv"><span class="hs-identifier hs-type">TyEnv</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FullEnv"><span class="hs-identifier hs-type">FullEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FullEnv"><span class="hs-identifier hs-type">FullEnv</span></a></span><span>
</span><span id="line-121"></span><span id="extendsVEnv"><span class="annot"><span class="annottext">extendsVEnv :: TyEnv Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendsVEnv"><span class="hs-identifier hs-var hs-var">extendsVEnv</span></a></span></span><span> </span><span id="local-6989586621680963211"><span class="annot"><span class="annottext">TyEnv Ty2
</span><a href="#local-6989586621680963211"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621680963212"><span class="annot"><span class="annottext">fe :: FullEnv
</span><a href="#local-6989586621680963212"><span class="hs-identifier hs-var">fe</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FullEnv"><span class="hs-identifier hs-type">FullEnv</span></a></span><span class="hs-special">{</span><span id="local-6989586621680963213"><span class="annot"><span class="annottext">TyEnv Ty2
valEnv :: FullEnv -&gt; TyEnv Ty2
valEnv :: TyEnv Ty2
</span><a href="Gibbon.Passes.InferLocations.html#valEnv"><span class="hs-identifier hs-var hs-var">valEnv</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680963212"><span class="hs-identifier hs-var">fe</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">valEnv :: TyEnv Ty2
</span><a href="Gibbon.Passes.InferLocations.html#valEnv"><span class="hs-identifier hs-var">valEnv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyEnv Ty2
</span><a href="#local-6989586621680963213"><span class="hs-identifier hs-var">valEnv</span></a></span><span> </span><span class="annot"><span class="annottext">TyEnv Ty2 -&gt; TyEnv Ty2 -&gt; TyEnv Ty2
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TyEnv Ty2
</span><a href="#local-6989586621680963211"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#lookupVEnv"><span class="hs-identifier hs-type">lookupVEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FullEnv"><span class="hs-identifier hs-type">FullEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span>
</span><span id="line-124"></span><span id="lookupVEnv"><span class="annot"><span class="annottext">lookupVEnv :: Var -&gt; FullEnv -&gt; Ty2
</span><a href="Gibbon.Passes.InferLocations.html#lookupVEnv"><span class="hs-identifier hs-var hs-var">lookupVEnv</span></a></span></span><span> </span><span id="local-6989586621680963223"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963223"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FullEnv"><span class="hs-identifier hs-type">FullEnv</span></a></span><span class="hs-special">{</span><span id="local-6989586621680963224"><span class="annot"><span class="annottext">TyEnv Ty2
valEnv :: FullEnv -&gt; TyEnv Ty2
valEnv :: TyEnv Ty2
</span><a href="Gibbon.Passes.InferLocations.html#valEnv"><span class="hs-identifier hs-var hs-var">valEnv</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyEnv Ty2
</span><a href="#local-6989586621680963224"><span class="hs-identifier hs-var">valEnv</span></a></span><span> </span><span class="annot"><span class="annottext">TyEnv Ty2 -&gt; Var -&gt; Ty2
forall a b.
(Ord a, Out a, Out b, Show a, HasCallStack) =&gt;
Map a b -&gt; a -&gt; b
</span><a href="Gibbon.Common.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963223"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#lookupFEnv"><span class="hs-identifier hs-type">lookupFEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FullEnv"><span class="hs-identifier hs-type">FullEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#ArrowTy2"><span class="hs-identifier hs-type">ArrowTy2</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span>
</span><span id="line-127"></span><span id="lookupFEnv"><span class="annot"><span class="annottext">lookupFEnv :: Var -&gt; FullEnv -&gt; ArrowTy2 Ty2
</span><a href="Gibbon.Passes.InferLocations.html#lookupFEnv"><span class="hs-identifier hs-var hs-var">lookupFEnv</span></a></span></span><span> </span><span id="local-6989586621680963234"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963234"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FullEnv"><span class="hs-identifier hs-type">FullEnv</span></a></span><span class="hs-special">{</span><span id="local-6989586621680963235"><span class="annot"><span class="annottext">TyEnv (ArrowTy Ty2)
funEnv :: FullEnv -&gt; TyEnv (ArrowTy Ty2)
funEnv :: TyEnv (ArrowTy Ty2)
</span><a href="Gibbon.Passes.InferLocations.html#funEnv"><span class="hs-identifier hs-var hs-var">funEnv</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyEnv (ArrowTy Ty2)
TyEnv (ArrowTy2 Ty2)
</span><a href="#local-6989586621680963235"><span class="hs-identifier hs-var">funEnv</span></a></span><span> </span><span class="annot"><span class="annottext">TyEnv (ArrowTy2 Ty2) -&gt; Var -&gt; ArrowTy2 Ty2
forall a b.
(Ord a, Out a, Out b, Show a, HasCallStack) =&gt;
Map a b -&gt; a -&gt; b
</span><a href="Gibbon.Common.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963234"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">-- Types</span><span>
</span><span id="line-130"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="hs-comment">-- | This helper exemplifies the simplicity of our current approach.</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- If we assume output regions are disjoint from input ones, then we</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- can instantiate an L1 function type into a polymorphic L2 one,</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- mechanically.</span><span>
</span><span id="line-136"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#convertFunTy"><span class="hs-identifier hs-type">convertFunTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L1.Syntax.html#Ty1"><span class="hs-identifier hs-type">Ty1</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><a href="Gibbon.L1.Syntax.html#Ty1"><span class="hs-identifier hs-type">Ty1</span></a></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#ArrowTy2"><span class="hs-identifier hs-type">ArrowTy2</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span id="convertFunTy"><span class="annot"><span class="annottext">convertFunTy :: ([Ty1], Ty1, Bool) -&gt; PassM (ArrowTy2 Ty2)
</span><a href="Gibbon.Passes.InferLocations.html#convertFunTy"><span class="hs-identifier hs-var hs-var">convertFunTy</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680963254"><span class="annot"><span class="annottext">[Ty1]
</span><a href="#local-6989586621680963254"><span class="hs-identifier hs-var">from</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680963255"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680963255"><span class="hs-identifier hs-var">to</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680963256"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680963256"><span class="hs-identifier hs-var">isPar</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-138"></span><span>    </span><span id="local-6989586621680963257"><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680963257"><span class="hs-identifier hs-var">from'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Ty1 -&gt; PassM Ty2) -&gt; [Ty1] -&gt; PassM [Ty2]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty1]
</span><a href="#local-6989586621680963254"><span class="hs-identifier hs-var">from</span></a></span><span>
</span><span id="line-139"></span><span>    </span><span id="local-6989586621680963260"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680963260"><span class="hs-identifier hs-var">to'</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680963255"><span class="hs-identifier hs-var">to</span></a></span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-comment">-- For this simple version, we assume every location is in a separate region:</span><span>
</span><span id="line-141"></span><span>    </span><span id="local-6989586621680963261"><span class="annot"><span class="annottext">[LRM]
</span><a href="#local-6989586621680963261"><span class="hs-identifier hs-var">lrm1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[[LRM]] -&gt; [LRM]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">([[LRM]] -&gt; [LRM]) -&gt; PassM [[LRM]] -&gt; PassM [LRM]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Ty2 -&gt; PassM [LRM]) -&gt; [Ty2] -&gt; PassM [[LRM]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Modality -&gt; Ty2 -&gt; PassM [LRM]
forall {t :: * -&gt; *}.
Foldable t =&gt;
Modality -&gt; t Var -&gt; PassM [LRM]
</span><a href="#local-6989586621680963264"><span class="hs-identifier hs-var">toLRM</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="Gibbon.L2.Syntax.html#Input"><span class="hs-identifier hs-var">Input</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680963257"><span class="hs-identifier hs-var">from'</span></a></span><span>
</span><span id="line-142"></span><span>    </span><span id="local-6989586621680963266"><span class="annot"><span class="annottext">[LRM]
</span><a href="#local-6989586621680963266"><span class="hs-identifier hs-var">lrm2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Modality -&gt; Ty2 -&gt; PassM [LRM]
forall {t :: * -&gt; *}.
Foldable t =&gt;
Modality -&gt; t Var -&gt; PassM [LRM]
</span><a href="#local-6989586621680963264"><span class="hs-identifier hs-var">toLRM</span></a></span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="Gibbon.L2.Syntax.html#Output"><span class="hs-identifier hs-var">Output</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680963260"><span class="hs-identifier hs-var">to'</span></a></span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><span class="annottext">ArrowTy2 Ty2 -&gt; PassM (ArrowTy2 Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(ArrowTy2 Ty2 -&gt; PassM (ArrowTy2 Ty2))
-&gt; ArrowTy2 Ty2 -&gt; PassM (ArrowTy2 Ty2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#ArrowTy2"><span class="hs-identifier hs-type">ArrowTy2</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">locVars :: [LRM]
</span><a href="Gibbon.L2.Syntax.html#locVars"><span class="hs-identifier hs-var">locVars</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LRM]
</span><a href="#local-6989586621680963261"><span class="hs-identifier hs-var">lrm1</span></a></span><span> </span><span class="annot"><span class="annottext">[LRM] -&gt; [LRM] -&gt; [LRM]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[LRM]
</span><a href="#local-6989586621680963266"><span class="hs-identifier hs-var">lrm2</span></a></span><span>
</span><span id="line-144"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">arrIns :: [Ty2]
</span><a href="Gibbon.L2.Syntax.html#arrIns"><span class="hs-identifier hs-var">arrIns</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680963257"><span class="hs-identifier hs-var">from'</span></a></span><span>
</span><span id="line-145"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">arrEffs :: Set Effect
</span><a href="Gibbon.L2.Syntax.html#arrEffs"><span class="hs-identifier hs-var">arrEffs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set Effect
forall a. Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">S.empty</span></a></span><span>
</span><span id="line-146"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">arrOut :: Ty2
</span><a href="Gibbon.L2.Syntax.html#arrOut"><span class="hs-identifier hs-var">arrOut</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680963260"><span class="hs-identifier hs-var">to'</span></a></span><span>
</span><span id="line-147"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">locRets :: [LocRet]
</span><a href="Gibbon.L2.Syntax.html#locRets"><span class="hs-identifier hs-var">locRets</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-148"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hasParallelism :: Bool
</span><a href="Gibbon.L2.Syntax.html#hasParallelism"><span class="hs-identifier hs-var">hasParallelism</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680963256"><span class="hs-identifier hs-var">isPar</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-149"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-150"></span><span>   </span><span id="local-6989586621680963264"><span class="annot"><span class="annottext">toLRM :: Modality -&gt; t Var -&gt; PassM [LRM]
</span><a href="#local-6989586621680963264"><span class="hs-identifier hs-var hs-var">toLRM</span></a></span></span><span> </span><span id="local-6989586621680963282"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621680963282"><span class="hs-identifier hs-var">md</span></a></span></span><span> </span><span id="local-6989586621680963283"><span class="annot"><span class="annottext">t Var
</span><a href="#local-6989586621680963283"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-151"></span><span>       </span><span class="annot"><span class="annottext">(Var -&gt; PassM LRM) -&gt; [Var] -&gt; PassM [LRM]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680963284"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963284"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680963285"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963285"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; PassM Var
</span><a href="Gibbon.Passes.InferLocations.html#freshLocVar"><span class="hs-identifier hs-var">freshLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;r&quot;</span></span><span>
</span><span id="line-152"></span><span>                      </span><span class="annot"><span class="annottext">LRM -&gt; PassM LRM
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(LRM -&gt; PassM LRM) -&gt; LRM -&gt; PassM LRM
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Region -&gt; Modality -&gt; LRM
</span><a href="Gibbon.L2.Syntax.html#LRM"><span class="hs-identifier hs-var">LRM</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963284"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Region
</span><a href="Gibbon.L2.Syntax.html#VarR"><span class="hs-identifier hs-var">VarR</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963285"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621680963282"><span class="hs-identifier hs-var">md</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t Var -&gt; [Var]
forall a. t a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#toList"><span class="hs-identifier hs-var">F.toList</span></a></span><span> </span><span class="annot"><span class="annottext">t Var
</span><a href="#local-6989586621680963283"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-type">convertTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Ty1"><span class="hs-identifier hs-type">Ty1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span>
</span><span id="line-156"></span><span id="convertTy"><span class="annot"><span class="annottext">convertTy :: Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var hs-var">convertTy</span></a></span></span><span> </span><span id="local-6989586621680963293"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680963293"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() -&gt; PassM Var) -&gt; Ty1 -&gt; PassM Ty2
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; UrTy a -&gt; f (UrTy b)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#traverse"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PassM Var -&gt; () -&gt; PassM Var
forall a b. a -&gt; b -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; PassM Var
</span><a href="Gibbon.Passes.InferLocations.html#freshLocVar"><span class="hs-identifier hs-var">freshLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;loc&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680963293"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#convertDDefs"><span class="hs-identifier hs-type">convertDDefs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DDefs"><span class="hs-identifier hs-type">DDefs</span></a></span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Ty1"><span class="hs-identifier hs-type">Ty1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#DDefs"><span class="hs-identifier hs-type">DDefs</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span id="convertDDefs"><span class="annot"><span class="annottext">convertDDefs :: DDefs Ty1 -&gt; PassM (DDefs Ty2)
</span><a href="Gibbon.Passes.InferLocations.html#convertDDefs"><span class="hs-identifier hs-var hs-var">convertDDefs</span></a></span></span><span> </span><span id="local-6989586621680963300"><span class="annot"><span class="annottext">DDefs Ty1
</span><a href="#local-6989586621680963300"><span class="hs-identifier hs-var">ddefs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DDef Ty1 -&gt; PassM (DDef Ty2)) -&gt; DDefs Ty1 -&gt; PassM (DDefs Ty2)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Map Var a -&gt; f (Map Var b)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#traverse"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">DDef Ty1 -&gt; PassM (DDef Ty2)
</span><a href="#local-6989586621680963301"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs Ty1
</span><a href="#local-6989586621680963300"><span class="hs-identifier hs-var">ddefs</span></a></span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680963301"><span class="annot"><span class="annottext">f :: DDef Ty1 -&gt; PassM (DDef Ty2)
</span><a href="#local-6989586621680963301"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#DDef"><span class="hs-identifier hs-type">DDef</span></a></span><span> </span><span id="local-6989586621680963313"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963313"><span class="hs-identifier hs-var">tyargs</span></a></span></span><span> </span><span id="local-6989586621680963314"><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680963314"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680963315"><span class="annot"><span class="annottext">[(String, [(Bool, Ty1)])]
</span><a href="#local-6989586621680963315"><span class="hs-identifier hs-var">dcs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-161"></span><span>            </span><span id="local-6989586621680963316"><span class="annot"><span class="annottext">[(String, [(Bool, Ty2)])]
</span><a href="#local-6989586621680963316"><span class="hs-identifier hs-var">dcs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(String, [(Bool, Ty1)])]
-&gt; ((String, [(Bool, Ty1)]) -&gt; PassM (String, [(Bool, Ty2)]))
-&gt; PassM [(String, [(Bool, Ty2)])]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#forM"><span class="hs-identifier hs-var">forM</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, [(Bool, Ty1)])]
</span><a href="#local-6989586621680963315"><span class="hs-identifier hs-var">dcs</span></a></span><span> </span><span class="annot"><span class="annottext">(((String, [(Bool, Ty1)]) -&gt; PassM (String, [(Bool, Ty2)]))
 -&gt; PassM [(String, [(Bool, Ty2)])])
-&gt; ((String, [(Bool, Ty1)]) -&gt; PassM (String, [(Bool, Ty2)]))
-&gt; PassM [(String, [(Bool, Ty2)])]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680963318"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680963318"><span class="hs-identifier hs-var">dc</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680963319"><span class="annot"><span class="annottext">[(Bool, Ty1)]
</span><a href="#local-6989586621680963319"><span class="hs-identifier hs-var">bnds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-162"></span><span>                             </span><span id="local-6989586621680963320"><span class="annot"><span class="annottext">[(Bool, Ty2)]
</span><a href="#local-6989586621680963320"><span class="hs-identifier hs-var">bnds'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Bool, Ty1)]
-&gt; ((Bool, Ty1) -&gt; PassM (Bool, Ty2)) -&gt; PassM [(Bool, Ty2)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#forM"><span class="hs-identifier hs-var">forM</span></a></span><span> </span><span class="annot"><span class="annottext">[(Bool, Ty1)]
</span><a href="#local-6989586621680963319"><span class="hs-identifier hs-var">bnds</span></a></span><span> </span><span class="annot"><span class="annottext">(((Bool, Ty1) -&gt; PassM (Bool, Ty2)) -&gt; PassM [(Bool, Ty2)])
-&gt; ((Bool, Ty1) -&gt; PassM (Bool, Ty2)) -&gt; PassM [(Bool, Ty2)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680963321"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680963321"><span class="hs-identifier hs-var">isb</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680963322"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680963322"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-163"></span><span>                                               </span><span id="local-6989586621680963323"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680963323"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680963322"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-164"></span><span>                                               </span><span class="annot"><span class="annottext">(Bool, Ty2) -&gt; PassM (Bool, Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680963321"><span class="hs-identifier hs-var">isb</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680963323"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>                             </span><span class="annot"><span class="annottext">(String, [(Bool, Ty2)]) -&gt; PassM (String, [(Bool, Ty2)])
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680963318"><span class="hs-identifier hs-var">dc</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(Bool, Ty2)]
</span><a href="#local-6989586621680963320"><span class="hs-identifier hs-var">bnds'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>            </span><span class="annot"><span class="annottext">DDef Ty2 -&gt; PassM (DDef Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(DDef Ty2 -&gt; PassM (DDef Ty2)) -&gt; DDef Ty2 -&gt; PassM (DDef Ty2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [TyVar] -&gt; [(String, [(Bool, Ty2)])] -&gt; DDef Ty2
forall a. Var -&gt; [TyVar] -&gt; [(String, [(Bool, a)])] -&gt; DDef a
</span><a href="Gibbon.Language.Syntax.html#DDef"><span class="hs-identifier hs-var">DDef</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963313"><span class="hs-identifier hs-var">tyargs</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVar]
</span><a href="#local-6989586621680963314"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, [(Bool, Ty2)])]
</span><a href="#local-6989586621680963316"><span class="hs-identifier hs-var">dcs'</span></a></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-comment">-- Inference algorithm</span><span>
</span><span id="line-169"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="annot"><span class="hs-comment">-- | The location inference monad is a stack of ExceptT and StateT.</span></span><span>
</span><span id="line-172"></span><span class="hs-keyword">type</span><span> </span><span id="TiM"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-var">TiM</span></a></span></span><span> </span><span id="local-6989586621680963324"><span class="annot"><a href="#local-6989586621680963324"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Except.html#ExceptT"><span class="hs-identifier hs-type">ExceptT</span></a></span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Failure"><span class="hs-identifier hs-type">Failure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Strict.html#StateT"><span class="hs-identifier hs-type">St.StateT</span></a></span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#InferState"><span class="hs-identifier hs-type">InferState</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680963324"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-comment">-- | The state of the inference procedure is a map from location variable</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- to `UnifyLoc`, which is explained below.</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- This is a bit awkward, since after inference is done we have to make another</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- pass over the AST to update all the `LocVar`s. One refactoring that would</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- make this less awkward would be to make a type-level distinction between</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- `LocVar`s that occur before and after this pass.</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- Also, it would be more efficient to use mutable state directly for this,</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- or possibly some more sophisticated union find thing.</span><span>
</span><span id="line-182"></span><span class="hs-keyword">type</span><span> </span><span id="InferState"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#InferState"><span class="hs-identifier hs-var">InferState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">M.Map</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#UnifyLoc"><span class="hs-identifier hs-type">UnifyLoc</span></a></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="annot"><span class="hs-comment">-- | A location is either fixed or fresh. Two fixed locations cannot unify.</span></span><span>
</span><span id="line-185"></span><span class="hs-keyword">data</span><span> </span><span id="UnifyLoc"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#UnifyLoc"><span class="hs-identifier hs-var">UnifyLoc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FixedLoc"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FixedLoc"><span class="hs-identifier hs-var">FixedLoc</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>
</span><span id="line-186"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span id="FreshLoc"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FreshLoc"><span class="hs-identifier hs-var">FreshLoc</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>
</span><span id="line-187"></span><span>                </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680963329"><span id="local-6989586621680963335"><span id="local-6989586621680963339"><span class="annot"><span class="annottext">Int -&gt; UnifyLoc -&gt; ShowS
[UnifyLoc] -&gt; ShowS
UnifyLoc -&gt; String
(Int -&gt; UnifyLoc -&gt; ShowS)
-&gt; (UnifyLoc -&gt; String) -&gt; ([UnifyLoc] -&gt; ShowS) -&gt; Show UnifyLoc
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; UnifyLoc -&gt; ShowS
showsPrec :: Int -&gt; UnifyLoc -&gt; ShowS
$cshow :: UnifyLoc -&gt; String
show :: UnifyLoc -&gt; String
$cshowList :: [UnifyLoc] -&gt; ShowS
showList :: [UnifyLoc] -&gt; ShowS
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680963342"><span id="local-6989586621680963347"><span class="annot"><span class="annottext">UnifyLoc -&gt; UnifyLoc -&gt; Bool
(UnifyLoc -&gt; UnifyLoc -&gt; Bool)
-&gt; (UnifyLoc -&gt; UnifyLoc -&gt; Bool) -&gt; Eq UnifyLoc
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: UnifyLoc -&gt; UnifyLoc -&gt; Bool
== :: UnifyLoc -&gt; UnifyLoc -&gt; Bool
$c/= :: UnifyLoc -&gt; UnifyLoc -&gt; Bool
/= :: UnifyLoc -&gt; UnifyLoc -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-keyword">data</span><span> </span><span id="Failure"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Failure"><span class="hs-identifier hs-var">Failure</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FailUnify"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FailUnify"><span class="hs-identifier hs-var">FailUnify</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span>
</span><span id="line-190"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span id="FailInfer"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FailInfer"><span class="hs-identifier hs-var">FailInfer</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Exp1"><span class="hs-identifier hs-type">Exp1</span></a></span><span>
</span><span id="line-191"></span><span>               </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680963354"><span id="local-6989586621680963366"><span id="local-6989586621680963370"><span class="annot"><span class="annottext">Int -&gt; Failure -&gt; ShowS
[Failure] -&gt; ShowS
Failure -&gt; String
(Int -&gt; Failure -&gt; ShowS)
-&gt; (Failure -&gt; String) -&gt; ([Failure] -&gt; ShowS) -&gt; Show Failure
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Failure -&gt; ShowS
showsPrec :: Int -&gt; Failure -&gt; ShowS
$cshow :: Failure -&gt; String
show :: Failure -&gt; String
$cshowList :: [Failure] -&gt; ShowS
showList :: [Failure] -&gt; ShowS
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680963375"><span id="local-6989586621680963386"><span class="annot"><span class="annottext">Failure -&gt; Failure -&gt; Bool
(Failure -&gt; Failure -&gt; Bool)
-&gt; (Failure -&gt; Failure -&gt; Bool) -&gt; Eq Failure
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Failure -&gt; Failure -&gt; Bool
== :: Failure -&gt; Failure -&gt; Bool
$c/= :: Failure -&gt; Failure -&gt; Bool
/= :: Failure -&gt; Failure -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">---------------------------------------</span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="hs-comment">-- | Constraints here mean almost the same thing as they do in the L2 type checker.</span><span>
</span><span id="line-196"></span><span class="hs-comment">-- One difference is the presence of an AfterTag constraint, though I'm not opposed to</span><span>
</span><span id="line-197"></span><span class="hs-comment">-- adding one to the L2 language for symmetry.</span><span>
</span><span id="line-198"></span><span class="hs-keyword">data</span><span> </span><span id="Constraint"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Constraint"><span class="hs-identifier hs-var">Constraint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AfterConstantL"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#AfterConstantL"><span class="hs-identifier hs-var">AfterConstantL</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span>
</span><span id="line-199"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="AfterVariableL"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#AfterVariableL"><span class="hs-identifier hs-var">AfterVariableL</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span>
</span><span id="line-200"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="AfterTagL"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#AfterTagL"><span class="hs-identifier hs-var">AfterTagL</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span>
</span><span id="line-201"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="StartRegionL"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#StartRegionL"><span class="hs-identifier hs-var">StartRegionL</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Region"><span class="hs-identifier hs-type">Region</span></a></span><span>
</span><span id="line-202"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="AfterCopyL"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#AfterCopyL"><span class="hs-identifier hs-var">AfterCopyL</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-203"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="FreeL"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FreeL"><span class="hs-identifier hs-var">FreeL</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span>
</span><span id="line-204"></span><span>                  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680963398"><span id="local-6989586621680963426"><span id="local-6989586621680963430"><span class="annot"><span class="annottext">Int -&gt; Constraint -&gt; ShowS
[Constraint] -&gt; ShowS
Constraint -&gt; String
(Int -&gt; Constraint -&gt; ShowS)
-&gt; (Constraint -&gt; String)
-&gt; ([Constraint] -&gt; ShowS)
-&gt; Show Constraint
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Constraint -&gt; ShowS
showsPrec :: Int -&gt; Constraint -&gt; ShowS
$cshow :: Constraint -&gt; String
show :: Constraint -&gt; String
$cshowList :: [Constraint] -&gt; ShowS
showList :: [Constraint] -&gt; ShowS
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680963433"><span id="local-6989586621680963455"><span class="annot"><span class="annottext">Constraint -&gt; Constraint -&gt; Bool
(Constraint -&gt; Constraint -&gt; Bool)
-&gt; (Constraint -&gt; Constraint -&gt; Bool) -&gt; Eq Constraint
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Constraint -&gt; Constraint -&gt; Bool
== :: Constraint -&gt; Constraint -&gt; Bool
$c/= :: Constraint -&gt; Constraint -&gt; Bool
/= :: Constraint -&gt; Constraint -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680963459"><span id="local-6989586621680963461"><span class="annot"><span class="annottext">(forall x. Constraint -&gt; Rep Constraint x)
-&gt; (forall x. Rep Constraint x -&gt; Constraint) -&gt; Generic Constraint
forall x. Rep Constraint x -&gt; Constraint
forall x. Constraint -&gt; Rep Constraint x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. Constraint -&gt; Rep Constraint x
from :: forall x. Constraint -&gt; Rep Constraint x
$cto :: forall x. Rep Constraint x -&gt; Constraint
to :: forall x. Rep Constraint x -&gt; Constraint
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Generics.html#Generic"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680963465"><span id="local-6989586621680963472"><span id="local-6989586621680963478"><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/GenericPretty-1.2.2-7277c36a966d41cd8e1371a7ee4c855b29a76e94dfe1d95510f68242766a5b82/share/doc/html/src/Text.PrettyPrint.GenericPretty.html#Out"><span class="hs-identifier hs-type">Out</span></a></span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span></span></span></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-comment">-- | The result type for this pass.  Return a new expression and its</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- type, which includes/implies its location.</span><span>
</span><span id="line-210"></span><span class="hs-keyword">type</span><span> </span><span id="Result"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Result"><span class="hs-identifier hs-var">Result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">Exp2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="hs-keyword">data</span><span> </span><span id="DCArg"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#DCArg"><span class="hs-identifier hs-var">DCArg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ArgFixed"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#ArgFixed"><span class="hs-identifier hs-var">ArgFixed</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-213"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span id="ArgVar"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#ArgVar"><span class="hs-identifier hs-var">ArgVar</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>
</span><span id="line-214"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span id="ArgCopy"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#ArgCopy"><span class="hs-identifier hs-var">ArgCopy</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621680963611"><span id="local-6989586621680963622"><span id="local-6989586621680963626"><span class="annot"><span class="annottext">Int -&gt; DCArg -&gt; ShowS
[DCArg] -&gt; ShowS
DCArg -&gt; String
(Int -&gt; DCArg -&gt; ShowS)
-&gt; (DCArg -&gt; String) -&gt; ([DCArg] -&gt; ShowS) -&gt; Show DCArg
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; DCArg -&gt; ShowS
showsPrec :: Int -&gt; DCArg -&gt; ShowS
$cshow :: DCArg -&gt; String
show :: DCArg -&gt; String
$cshowList :: [DCArg] -&gt; ShowS
showList :: [DCArg] -&gt; ShowS
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#inferLocs"><span class="hs-identifier hs-type">inferLocs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Prog1"><span class="hs-identifier hs-type">Prog1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Prog2"><span class="hs-identifier hs-type">L2.Prog2</span></a></span><span>
</span><span id="line-218"></span><span id="inferLocs"><span class="annot"><span class="annottext">inferLocs :: Prog1 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.InferLocations.html#inferLocs"><span class="hs-identifier hs-var hs-var">inferLocs</span></a></span></span><span> </span><span id="local-6989586621680963685"><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680963685"><span class="hs-identifier hs-var">initPrg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-comment">-- p@(Prog dfs fds me) &lt;- addRepairFns initPrg</span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span id="local-6989586621680963687"><span class="annot"><span class="annottext">DDefs (TyOf Exp1)
</span><a href="#local-6989586621680963687"><span class="hs-identifier hs-var">dfs</span></a></span></span><span> </span><span id="local-6989586621680963688"><span class="annot"><span class="annottext">FunDefs Exp1
</span><a href="#local-6989586621680963688"><span class="hs-identifier hs-var">fds</span></a></span></span><span> </span><span id="local-6989586621680963689"><span class="annot"><span class="annottext">Maybe (Exp1, TyOf Exp1)
</span><a href="#local-6989586621680963689"><span class="hs-identifier hs-var">me</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680963690"><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680963690"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Prog1 -&gt; PassM Prog1
</span><a href="Gibbon.Passes.Flatten.html#flattenL1"><span class="hs-identifier hs-var">flattenL1</span></a></span><span> </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680963685"><span class="hs-identifier hs-var">initPrg</span></a></span><span>
</span><span id="line-221"></span><span>                          </span><span class="annot"><span class="annottext">Prog1 -&gt; PassM Prog1
forall (e :: * -&gt; * -&gt; *) l d.
HasSimplifiable e l d =&gt;
Prog (PreExp e l d) -&gt; PassM (Prog (PreExp e l d))
</span><a href="Gibbon.Passes.InlineTriv.html#inlineTriv"><span class="hs-identifier hs-var">inlineTriv</span></a></span><span> </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680963690"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680963691"><span class="annot"><span class="annottext">m :: ExceptT Failure (StateT InferState PassM) Prog2
</span><a href="#local-6989586621680963691"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-223"></span><span>          </span><span id="local-6989586621680963692"><span class="annot"><span class="annottext">DDefs Ty2
</span><a href="#local-6989586621680963692"><span class="hs-identifier hs-var">dfs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM (DDefs Ty2)
-&gt; ExceptT Failure (StateT InferState PassM) (DDefs Ty2)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM (DDefs Ty2)
 -&gt; ExceptT Failure (StateT InferState PassM) (DDefs Ty2))
-&gt; StateT InferState PassM (DDefs Ty2)
-&gt; ExceptT Failure (StateT InferState PassM) (DDefs Ty2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM (DDefs Ty2) -&gt; StateT InferState PassM (DDefs Ty2)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM (DDefs Ty2) -&gt; StateT InferState PassM (DDefs Ty2))
-&gt; PassM (DDefs Ty2) -&gt; StateT InferState PassM (DDefs Ty2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs Ty1 -&gt; PassM (DDefs Ty2)
</span><a href="Gibbon.Passes.InferLocations.html#convertDDefs"><span class="hs-identifier hs-var">convertDDefs</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp1)
DDefs Ty1
</span><a href="#local-6989586621680963687"><span class="hs-identifier hs-var">dfs</span></a></span><span>
</span><span id="line-224"></span><span>          </span><span id="local-6989586621680963693"><span class="annot"><span class="annottext">TyEnv (ArrowTy2 Ty2)
</span><a href="#local-6989586621680963693"><span class="hs-identifier hs-var">fenv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FunDefs Exp1
-&gt; (FunDef Exp1
    -&gt; ExceptT Failure (StateT InferState PassM) (ArrowTy2 Ty2))
-&gt; ExceptT Failure (StateT InferState PassM) (TyEnv (ArrowTy2 Ty2))
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#forM"><span class="hs-identifier hs-var">forM</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp1
</span><a href="#local-6989586621680963688"><span class="hs-identifier hs-var">fds</span></a></span><span> </span><span class="annot"><span class="annottext">((FunDef Exp1
  -&gt; ExceptT Failure (StateT InferState PassM) (ArrowTy2 Ty2))
 -&gt; ExceptT
      Failure (StateT InferState PassM) (TyEnv (ArrowTy2 Ty2)))
-&gt; (FunDef Exp1
    -&gt; ExceptT Failure (StateT InferState PassM) (ArrowTy2 Ty2))
-&gt; ExceptT Failure (StateT InferState PassM) (TyEnv (ArrowTy2 Ty2))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680963695"><span class="annot"><span class="annottext">[Ty1]
</span><a href="#local-6989586621680963695"><span class="hs-identifier hs-var">intys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680963696"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680963696"><span class="hs-identifier hs-var">outty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680963697"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680963697"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span id="local-6989586621680963698"><span class="annot"><span class="annottext">FunMeta
</span><a href="#local-6989586621680963698"><span class="hs-identifier hs-var">_meta</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-225"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680963699"><span class="annot"><span class="annottext">has_par :: Bool
</span><a href="#local-6989586621680963699"><span class="hs-identifier hs-var hs-var">has_par</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; Bool
forall (e :: * -&gt; * -&gt; *) l d. PreExp e l d -&gt; Bool
</span><a href="Gibbon.Language.html#hasSpawns"><span class="hs-identifier hs-var">hasSpawns</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680963697"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-226"></span><span>                  </span><span class="annot"><span class="annottext">StateT InferState PassM (ArrowTy2 Ty2)
-&gt; ExceptT Failure (StateT InferState PassM) (ArrowTy2 Ty2)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM (ArrowTy2 Ty2)
 -&gt; ExceptT Failure (StateT InferState PassM) (ArrowTy2 Ty2))
-&gt; StateT InferState PassM (ArrowTy2 Ty2)
-&gt; ExceptT Failure (StateT InferState PassM) (ArrowTy2 Ty2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM (ArrowTy2 Ty2) -&gt; StateT InferState PassM (ArrowTy2 Ty2)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM (ArrowTy2 Ty2) -&gt; StateT InferState PassM (ArrowTy2 Ty2))
-&gt; PassM (ArrowTy2 Ty2) -&gt; StateT InferState PassM (ArrowTy2 Ty2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">([Ty1], Ty1, Bool) -&gt; PassM (ArrowTy2 Ty2)
</span><a href="Gibbon.Passes.InferLocations.html#convertFunTy"><span class="hs-identifier hs-var">convertFunTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty1]
</span><a href="#local-6989586621680963695"><span class="hs-identifier hs-var">intys</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680963696"><span class="hs-identifier hs-var">outty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680963699"><span class="hs-identifier hs-var">has_par</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680963701"><span class="annot"><span class="annottext">fe :: FullEnv
</span><a href="#local-6989586621680963701"><span class="hs-identifier hs-var hs-var">fe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DDefs Ty2 -&gt; TyEnv Ty2 -&gt; TyEnv (ArrowTy Ty2) -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#FullEnv"><span class="hs-identifier hs-var">FullEnv</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs Ty2
</span><a href="#local-6989586621680963692"><span class="hs-identifier hs-var">dfs'</span></a></span><span> </span><span class="annot"><span class="annottext">TyEnv Ty2
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span> </span><span class="annot"><span class="annottext">TyEnv (ArrowTy Ty2)
TyEnv (ArrowTy2 Ty2)
</span><a href="#local-6989586621680963693"><span class="hs-identifier hs-var">fenv</span></a></span><span>
</span><span id="line-228"></span><span>          </span><span id="local-6989586621680963703"><span class="annot"><span class="annottext">Maybe (Exp2, Ty2)
</span><a href="#local-6989586621680963703"><span class="hs-identifier hs-var">me'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp1, TyOf Exp1)
</span><a href="#local-6989586621680963689"><span class="hs-identifier hs-var">me</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-229"></span><span>            </span><span class="hs-comment">-- We ignore the type of the main expression inferred in L1..</span><span>
</span><span id="line-230"></span><span>            </span><span class="hs-comment">-- Probably should add a small check here</span><span>
</span><span id="line-231"></span><span>            </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680963704"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680963704"><span class="hs-identifier hs-var">me</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680963705"><span class="annot"><span class="annottext">TyOf Exp1
</span><a href="#local-6989586621680963705"><span class="hs-identifier hs-var">_ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-232"></span><span>              </span><span class="hs-special">(</span><span id="local-6989586621680963706"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680963706"><span class="hs-identifier hs-var">me'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680963707"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680963707"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; [Var] -&gt; Dest -&gt; TiM (Exp2, Ty2)
</span><a href="Gibbon.Passes.InferLocations.html#inferExp%27"><span class="hs-identifier hs-var">inferExp'</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680963701"><span class="hs-identifier hs-var">fe</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680963704"><span class="hs-identifier hs-var">me</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span>
</span><span id="line-233"></span><span>              </span><span class="annot"><span class="annottext">Maybe (Exp2, Ty2)
-&gt; ExceptT Failure (StateT InferState PassM) (Maybe (Exp2, Ty2))
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Exp2, Ty2)
 -&gt; ExceptT Failure (StateT InferState PassM) (Maybe (Exp2, Ty2)))
-&gt; Maybe (Exp2, Ty2)
-&gt; ExceptT Failure (StateT InferState PassM) (Maybe (Exp2, Ty2))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2, Ty2) -&gt; Maybe (Exp2, Ty2)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680963706"><span class="hs-identifier hs-var">me'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680963707"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>            </span><span class="annot"><span class="annottext">Maybe (Exp1, TyOf Exp1)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp2, Ty2)
-&gt; ExceptT Failure (StateT InferState PassM) (Maybe (Exp2, Ty2))
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Exp2, Ty2)
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-235"></span><span>          </span><span id="local-6989586621680963709"><span class="annot"><span class="annottext">Map Var (FunDef Exp2)
</span><a href="#local-6989586621680963709"><span class="hs-identifier hs-var">fds'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FunDefs Exp1
-&gt; (FunDef Exp1
    -&gt; ExceptT Failure (StateT InferState PassM) (FunDef Exp2))
-&gt; ExceptT
     Failure (StateT InferState PassM) (Map Var (FunDef Exp2))
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#forM"><span class="hs-identifier hs-var">forM</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp1
</span><a href="#local-6989586621680963688"><span class="hs-identifier hs-var">fds</span></a></span><span> </span><span class="annot"><span class="annottext">((FunDef Exp1
  -&gt; ExceptT Failure (StateT InferState PassM) (FunDef Exp2))
 -&gt; ExceptT
      Failure (StateT InferState PassM) (Map Var (FunDef Exp2)))
-&gt; (FunDef Exp1
    -&gt; ExceptT Failure (StateT InferState PassM) (FunDef Exp2))
-&gt; ExceptT
     Failure (StateT InferState PassM) (Map Var (FunDef Exp2))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span> </span><span id="local-6989586621680963710"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963710"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621680963711"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680963711"><span class="hs-identifier hs-var">fa</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680963712"><span class="annot"><span class="annottext">[Ty1]
</span><a href="#local-6989586621680963712"><span class="hs-identifier hs-var">intty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680963713"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680963713"><span class="hs-identifier hs-var">outty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680963714"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680963714"><span class="hs-identifier hs-var">fbod</span></a></span></span><span> </span><span id="local-6989586621680963715"><span class="annot"><span class="annottext">FunMeta
</span><a href="#local-6989586621680963715"><span class="hs-identifier hs-var">meta</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-236"></span><span>                                   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680963716"><span class="annot"><span class="annottext">arrty :: ArrowTy2 Ty2
</span><a href="#local-6989586621680963716"><span class="hs-identifier hs-var hs-var">arrty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; FullEnv -&gt; ArrowTy2 Ty2
</span><a href="Gibbon.Passes.InferLocations.html#lookupFEnv"><span class="hs-identifier hs-var">lookupFEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963710"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680963701"><span class="hs-identifier hs-var">fe</span></a></span><span>
</span><span id="line-237"></span><span>                                       </span><span id="local-6989586621680963717"><span class="annot"><span class="annottext">fe' :: FullEnv
</span><a href="#local-6989586621680963717"><span class="hs-identifier hs-var hs-var">fe'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyEnv Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendsVEnv"><span class="hs-identifier hs-var">extendsVEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, Ty2)] -&gt; TyEnv Ty2
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(Var, Ty2)] -&gt; TyEnv Ty2) -&gt; [(Var, Ty2)] -&gt; TyEnv Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Ty2] -&gt; [(Var, Ty2)]
forall a b.
(Show a, Show b, HasCallStack) =&gt;
[a] -&gt; [b] -&gt; [(a, b)]
</span><a href="Gibbon.Common.html#fragileZip"><span class="hs-identifier hs-var">fragileZip</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680963711"><span class="hs-identifier hs-var">fa</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArrowTy2 Ty2 -&gt; [Ty2]
forall ty2. ArrowTy2 ty2 -&gt; [ty2]
</span><a href="Gibbon.L2.Syntax.html#arrIns"><span class="hs-identifier hs-var">arrIns</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy2 Ty2
</span><a href="#local-6989586621680963716"><span class="hs-identifier hs-var">arrty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680963701"><span class="hs-identifier hs-var">fe</span></a></span><span>
</span><span id="line-238"></span><span>                                       </span><span id="local-6989586621680963720"><span class="annot"><span class="annottext">boundLocs :: [Var]
</span><a href="#local-6989586621680963720"><span class="hs-identifier hs-var hs-var">boundLocs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Var]] -&gt; [Var]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">([[Var]] -&gt; [Var]) -&gt; [[Var]] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Ty2 -&gt; [Var]) -&gt; [Ty2] -&gt; [[Var]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; [Var]
</span><a href="Gibbon.L2.Syntax.html#locsInTy"><span class="hs-identifier hs-var">locsInTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArrowTy2 Ty2 -&gt; [Ty2]
forall ty2. ArrowTy2 ty2 -&gt; [ty2]
</span><a href="Gibbon.L2.Syntax.html#arrIns"><span class="hs-identifier hs-var">arrIns</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy2 Ty2
</span><a href="#local-6989586621680963716"><span class="hs-identifier hs-var">arrty</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2] -&gt; [Ty2] -&gt; [Ty2]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ArrowTy2 Ty2 -&gt; Ty2
forall ty2. ArrowTy2 ty2 -&gt; ty2
</span><a href="Gibbon.L2.Syntax.html#arrOut"><span class="hs-identifier hs-var">arrOut</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy2 Ty2
</span><a href="#local-6989586621680963716"><span class="hs-identifier hs-var">arrty</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>                                   </span><span id="local-6989586621680963722"><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680963722"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; TiM Dest
</span><a href="Gibbon.Passes.InferLocations.html#destFromType"><span class="hs-identifier hs-var">destFromType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArrowTy2 Ty2 -&gt; Ty2
forall ty2. ArrowTy2 ty2 -&gt; ty2
</span><a href="Gibbon.L2.Syntax.html#arrOut"><span class="hs-identifier hs-var">arrOut</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy2 Ty2
</span><a href="#local-6989586621680963716"><span class="hs-identifier hs-var">arrty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>                                   </span><span class="annot"><span class="annottext">(Ty2 -&gt; ExceptT Failure (StateT InferState PassM) ())
-&gt; [Ty2] -&gt; ExceptT Failure (StateT InferState PassM) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; ExceptT Failure (StateT InferState PassM) ()
</span><a href="Gibbon.Passes.InferLocations.html#fixType_"><span class="hs-identifier hs-var">fixType_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArrowTy2 Ty2 -&gt; [Ty2]
forall ty2. ArrowTy2 ty2 -&gt; [ty2]
</span><a href="Gibbon.L2.Syntax.html#arrIns"><span class="hs-identifier hs-var">arrIns</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy2 Ty2
</span><a href="#local-6989586621680963716"><span class="hs-identifier hs-var">arrty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>                                   </span><span class="hs-special">(</span><span id="local-6989586621680963726"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680963726"><span class="hs-identifier hs-var">fbod'</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; [Var] -&gt; Dest -&gt; TiM (Exp2, Ty2)
</span><a href="Gibbon.Passes.InferLocations.html#inferExp%27"><span class="hs-identifier hs-var">inferExp'</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680963717"><span class="hs-identifier hs-var">fe'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680963714"><span class="hs-identifier hs-var">fbod</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680963720"><span class="hs-identifier hs-var">boundLocs</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680963722"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-242"></span><span>                                   </span><span class="annot"><span class="annottext">FunDef Exp2
-&gt; ExceptT Failure (StateT InferState PassM) (FunDef Exp2)
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(FunDef Exp2
 -&gt; ExceptT Failure (StateT InferState PassM) (FunDef Exp2))
-&gt; FunDef Exp2
-&gt; ExceptT Failure (StateT InferState PassM) (FunDef Exp2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var
-&gt; [Var] -&gt; ArrowTy (TyOf Exp2) -&gt; Exp2 -&gt; FunMeta -&gt; FunDef Exp2
forall ex.
Var -&gt; [Var] -&gt; ArrowTy (TyOf ex) -&gt; ex -&gt; FunMeta -&gt; FunDef ex
</span><a href="Gibbon.Language.Syntax.html#FunDef"><span class="hs-identifier hs-var">FunDef</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963710"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680963711"><span class="hs-identifier hs-var">fa</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy (TyOf Exp2)
ArrowTy2 Ty2
</span><a href="#local-6989586621680963716"><span class="hs-identifier hs-var">arrty</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680963726"><span class="hs-identifier hs-var">fbod'</span></a></span><span> </span><span class="annot"><span class="annottext">FunMeta
</span><a href="#local-6989586621680963715"><span class="hs-identifier hs-var">meta</span></a></span><span>
</span><span id="line-243"></span><span>          </span><span class="annot"><span class="annottext">Prog2 -&gt; ExceptT Failure (StateT InferState PassM) Prog2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prog2 -&gt; ExceptT Failure (StateT InferState PassM) Prog2)
-&gt; Prog2 -&gt; ExceptT Failure (StateT InferState PassM) Prog2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp2)
-&gt; Map Var (FunDef Exp2) -&gt; Maybe (Exp2, TyOf Exp2) -&gt; Prog2
forall ex.
DDefs (TyOf ex) -&gt; FunDefs ex -&gt; Maybe (ex, TyOf ex) -&gt; Prog ex
</span><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-var">Prog</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp2)
DDefs Ty2
</span><a href="#local-6989586621680963692"><span class="hs-identifier hs-var">dfs'</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var (FunDef Exp2)
</span><a href="#local-6989586621680963709"><span class="hs-identifier hs-var">fds'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Exp2, TyOf Exp2)
Maybe (Exp2, Ty2)
</span><a href="#local-6989586621680963703"><span class="hs-identifier hs-var">me'</span></a></span><span>
</span><span id="line-244"></span><span>  </span><span id="local-6989586621680963727"><span class="annot"><span class="annottext">(Either Failure Prog2, InferState)
</span><a href="#local-6989586621680963727"><span class="hs-identifier hs-var">prg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM (Either Failure Prog2)
-&gt; InferState -&gt; PassM (Either Failure Prog2, InferState)
forall s (m :: * -&gt; *) a. StateT s m a -&gt; s -&gt; m (a, s)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Strict.html#runStateT"><span class="hs-identifier hs-var">St.runStateT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExceptT Failure (StateT InferState PassM) Prog2
-&gt; StateT InferState PassM (Either Failure Prog2)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Except.html#runExceptT"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT Failure (StateT InferState PassM) Prog2
</span><a href="#local-6989586621680963691"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InferState
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Either Failure Prog2, InferState) -&gt; Either Failure Prog2
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(Either Failure Prog2, InferState)
</span><a href="#local-6989586621680963727"><span class="hs-identifier hs-var">prg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-246"></span><span>    </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621680963731"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680963731"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680963731"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-247"></span><span>    </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621680963732"><span class="annot"><span class="annottext">Failure
</span><a href="#local-6989586621680963732"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; PassM Prog2
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; PassM Prog2) -&gt; String -&gt; PassM Prog2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Failure -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Failure
</span><a href="#local-6989586621680963732"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="hs-comment">-- | Destination can be a single location var, a tuple of destinations,</span><span>
</span><span id="line-250"></span><span class="hs-comment">-- or nothing (for scalar values)</span><span>
</span><span id="line-251"></span><span class="hs-keyword">data</span><span> </span><span id="Dest"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Dest"><span class="hs-identifier hs-var">Dest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SingleDest"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#SingleDest"><span class="hs-identifier hs-var">SingleDest</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span> </span><span class="hs-comment">-- TODO: refactor to just be list of locations, or actually enforce invariants of non-empty list, etc</span><span>
</span><span id="line-252"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span id="TupleDest"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TupleDest"><span class="hs-identifier hs-var">TupleDest</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Dest"><span class="hs-identifier hs-type">Dest</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-253"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span id="NoDest"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span></span><span>
</span><span id="line-254"></span><span>            </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680963738"><span id="local-6989586621680963745"><span id="local-6989586621680963749"><span class="annot"><span class="annottext">Int -&gt; Dest -&gt; ShowS
[Dest] -&gt; ShowS
Dest -&gt; String
(Int -&gt; Dest -&gt; ShowS)
-&gt; (Dest -&gt; String) -&gt; ([Dest] -&gt; ShowS) -&gt; Show Dest
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Dest -&gt; ShowS
showsPrec :: Int -&gt; Dest -&gt; ShowS
$cshow :: Dest -&gt; String
show :: Dest -&gt; String
$cshowList :: [Dest] -&gt; ShowS
showList :: [Dest] -&gt; ShowS
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680963752"><span id="local-6989586621680963754"><span class="annot"><span class="annottext">(forall x. Dest -&gt; Rep Dest x)
-&gt; (forall x. Rep Dest x -&gt; Dest) -&gt; Generic Dest
forall x. Rep Dest x -&gt; Dest
forall x. Dest -&gt; Rep Dest x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. Dest -&gt; Rep Dest x
from :: forall x. Dest -&gt; Rep Dest x
$cto :: forall x. Rep Dest x -&gt; Dest
to :: forall x. Rep Dest x -&gt; Dest
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Generics.html#Generic"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680963757"><span id="local-6989586621680963764"><span id="local-6989586621680963770"><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/GenericPretty-1.2.2-7277c36a966d41cd8e1371a7ee4c855b29a76e94dfe1d95510f68242766a5b82/share/doc/html/src/Text.PrettyPrint.GenericPretty.html#Out"><span class="hs-identifier hs-type">Out</span></a></span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Dest"><span class="hs-identifier hs-type">Dest</span></a></span></span></span></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#locsInDest"><span class="hs-identifier hs-type">locsInDest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Dest"><span class="hs-identifier hs-type">Dest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-259"></span><span id="locsInDest"><span class="annot"><span class="annottext">locsInDest :: Dest -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#locsInDest"><span class="hs-identifier hs-var hs-var">locsInDest</span></a></span></span><span> </span><span id="local-6989586621680963833"><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680963833"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680963833"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-260"></span><span>                 </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#SingleDest"><span class="hs-identifier hs-type">SingleDest</span></a></span><span> </span><span id="local-6989586621680963834"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963834"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963834"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-261"></span><span>                 </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TupleDest"><span class="hs-identifier hs-type">TupleDest</span></a></span><span> </span><span id="local-6989586621680963835"><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680963835"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Dest -&gt; [Var]) -&gt; [Dest] -&gt; [Var]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">L.concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">Dest -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#locsInDest"><span class="hs-identifier hs-var">locsInDest</span></a></span><span> </span><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680963835"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-262"></span><span>                 </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#destFromType"><span class="hs-identifier hs-type">destFromType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Dest"><span class="hs-identifier hs-type">Dest</span></a></span><span>
</span><span id="line-265"></span><span id="destFromType"><span class="annot"><span class="annottext">destFromType :: Ty2 -&gt; TiM Dest
</span><a href="Gibbon.Passes.InferLocations.html#destFromType"><span class="hs-identifier hs-var hs-var">destFromType</span></a></span></span><span> </span><span id="local-6989586621680963846"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680963846"><span class="hs-identifier hs-var">frt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680963846"><span class="hs-identifier hs-var">frt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-267"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span id="local-6989586621680963848"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680963848"><span class="hs-identifier hs-var">_tc</span></a></span></span><span> </span><span id="local-6989586621680963849"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963849"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM UnifyLoc
</span><a href="Gibbon.Passes.InferLocations.html#fixLoc"><span class="hs-identifier hs-var">fixLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963849"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="annot"><span class="annottext">TiM UnifyLoc -&gt; TiM Dest -&gt; TiM Dest
forall a b.
ExceptT Failure (StateT InferState PassM) a
-&gt; ExceptT Failure (StateT InferState PassM) b
-&gt; ExceptT Failure (StateT InferState PassM) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Dest -&gt; TiM Dest
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Dest
</span><a href="Gibbon.Passes.InferLocations.html#SingleDest"><span class="hs-identifier hs-var">SingleDest</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963849"><span class="hs-identifier hs-var">lv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680963851"><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680963851"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Ty2 -&gt; TiM Dest)
-&gt; [Ty2] -&gt; ExceptT Failure (StateT InferState PassM) [Dest]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; TiM Dest
</span><a href="Gibbon.Passes.InferLocations.html#destFromType"><span class="hs-identifier hs-var">destFromType</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680963851"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT Failure (StateT InferState PassM) [Dest]
-&gt; ([Dest] -&gt; TiM Dest) -&gt; TiM Dest
forall a b.
ExceptT Failure (StateT InferState PassM) a
-&gt; (a -&gt; ExceptT Failure (StateT InferState PassM) b)
-&gt; ExceptT Failure (StateT InferState PassM) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Dest -&gt; TiM Dest
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Dest -&gt; TiM Dest) -&gt; ([Dest] -&gt; Dest) -&gt; [Dest] -&gt; TiM Dest
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[Dest] -&gt; Dest
</span><a href="Gibbon.Passes.InferLocations.html#TupleDest"><span class="hs-identifier hs-var">TupleDest</span></a></span><span>
</span><span id="line-269"></span><span>    </span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Dest -&gt; TiM Dest
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#destFromType%27"><span class="hs-identifier hs-type">destFromType'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Dest"><span class="hs-identifier hs-type">Dest</span></a></span><span>
</span><span id="line-272"></span><span id="destFromType%27"><span class="annot"><span class="annottext">destFromType' :: Ty2 -&gt; TiM Dest
</span><a href="Gibbon.Passes.InferLocations.html#destFromType%27"><span class="hs-identifier hs-var hs-var">destFromType'</span></a></span></span><span> </span><span id="local-6989586621680963862"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680963862"><span class="hs-identifier hs-var">frt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680963862"><span class="hs-identifier hs-var">frt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-274"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span id="local-6989586621680963863"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680963863"><span class="hs-identifier hs-var">_tc</span></a></span></span><span> </span><span id="local-6989586621680963864"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963864"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Dest -&gt; TiM Dest
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Dest
</span><a href="Gibbon.Passes.InferLocations.html#SingleDest"><span class="hs-identifier hs-var">SingleDest</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963864"><span class="hs-identifier hs-var">lv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680963865"><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680963865"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Ty2 -&gt; TiM Dest)
-&gt; [Ty2] -&gt; ExceptT Failure (StateT InferState PassM) [Dest]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; TiM Dest
</span><a href="Gibbon.Passes.InferLocations.html#destFromType%27"><span class="hs-identifier hs-var">destFromType'</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680963865"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT Failure (StateT InferState PassM) [Dest]
-&gt; ([Dest] -&gt; TiM Dest) -&gt; TiM Dest
forall a b.
ExceptT Failure (StateT InferState PassM) a
-&gt; (a -&gt; ExceptT Failure (StateT InferState PassM) b)
-&gt; ExceptT Failure (StateT InferState PassM) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Dest -&gt; TiM Dest
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Dest -&gt; TiM Dest) -&gt; ([Dest] -&gt; Dest) -&gt; [Dest] -&gt; TiM Dest
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[Dest] -&gt; Dest
</span><a href="Gibbon.Passes.InferLocations.html#TupleDest"><span class="hs-identifier hs-var">TupleDest</span></a></span><span>
</span><span id="line-276"></span><span>    </span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Dest -&gt; TiM Dest
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#freshTyLocs"><span class="hs-identifier hs-type">freshTyLocs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span>
</span><span id="line-279"></span><span id="freshTyLocs"><span class="annot"><span class="annottext">freshTyLocs :: Ty2 -&gt; TiM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#freshTyLocs"><span class="hs-identifier hs-var hs-var">freshTyLocs</span></a></span></span><span> </span><span id="local-6989586621680963876"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680963876"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680963876"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-281"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span id="local-6989586621680963877"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680963877"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680963878"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963878"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#fresh"><span class="hs-identifier hs-var">fresh</span></a></span><span> </span><span class="annot"><span class="annottext">TiM Var -&gt; (Var -&gt; TiM Ty2) -&gt; TiM Ty2
forall a b.
ExceptT Failure (StateT InferState PassM) a
-&gt; (a -&gt; ExceptT Failure (StateT InferState PassM) b)
-&gt; ExceptT Failure (StateT InferState PassM) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; TiM Ty2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Ty2 -&gt; TiM Ty2) -&gt; (Var -&gt; Ty2) -&gt; Var -&gt; TiM Ty2
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Var -&gt; Ty2
forall loc. String -&gt; loc -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-var">PackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680963877"><span class="hs-identifier hs-var">tc</span></a></span><span>
</span><span id="line-282"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680963879"><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680963879"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Ty2 -&gt; TiM Ty2)
-&gt; [Ty2] -&gt; ExceptT Failure (StateT InferState PassM) [Ty2]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; TiM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#freshTyLocs"><span class="hs-identifier hs-var">freshTyLocs</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680963879"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT Failure (StateT InferState PassM) [Ty2]
-&gt; ([Ty2] -&gt; TiM Ty2) -&gt; TiM Ty2
forall a b.
ExceptT Failure (StateT InferState PassM) a
-&gt; (a -&gt; ExceptT Failure (StateT InferState PassM) b)
-&gt; ExceptT Failure (StateT InferState PassM) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; TiM Ty2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Ty2 -&gt; TiM Ty2) -&gt; ([Ty2] -&gt; Ty2) -&gt; [Ty2] -&gt; TiM Ty2
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2] -&gt; Ty2
forall loc. [UrTy loc] -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span>
</span><span id="line-283"></span><span>      </span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; TiM Ty2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680963876"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#fixType_"><span class="hs-identifier hs-type">fixType_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span id="fixType_"><span class="annot"><span class="annottext">fixType_ :: Ty2 -&gt; ExceptT Failure (StateT InferState PassM) ()
</span><a href="Gibbon.Passes.InferLocations.html#fixType_"><span class="hs-identifier hs-var hs-var">fixType_</span></a></span></span><span> </span><span id="local-6989586621680963887"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680963887"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-287"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680963887"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-288"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span id="local-6989586621680963888"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680963888"><span class="hs-identifier hs-var">_tc</span></a></span></span><span> </span><span id="local-6989586621680963889"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963889"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM UnifyLoc
</span><a href="Gibbon.Passes.InferLocations.html#fixLoc"><span class="hs-identifier hs-var">fixLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963889"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="annot"><span class="annottext">TiM UnifyLoc
-&gt; ExceptT Failure (StateT InferState PassM) ()
-&gt; ExceptT Failure (StateT InferState PassM) ()
forall a b.
ExceptT Failure (StateT InferState PassM) a
-&gt; ExceptT Failure (StateT InferState PassM) b
-&gt; ExceptT Failure (StateT InferState PassM) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; ExceptT Failure (StateT InferState PassM) ()
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680963890"><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680963890"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Ty2 -&gt; ExceptT Failure (StateT InferState PassM) ())
-&gt; [Ty2] -&gt; ExceptT Failure (StateT InferState PassM) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; ExceptT Failure (StateT InferState PassM) ()
</span><a href="Gibbon.Passes.InferLocations.html#fixType_"><span class="hs-identifier hs-var">fixType_</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680963890"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-290"></span><span>      </span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; ExceptT Failure (StateT InferState PassM) ()
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="annot"><span class="hs-comment">-- | Wrap the inferExp procedure, and consume all remaining constraints</span></span><span>
</span><span id="line-293"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#inferExp%27"><span class="hs-identifier hs-type">inferExp'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FullEnv"><span class="hs-identifier hs-type">FullEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Exp1"><span class="hs-identifier hs-type">Exp1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Dest"><span class="hs-identifier hs-type">Dest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">L2.Exp2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">L2.Ty2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span id="inferExp%27"><span class="annot"><span class="annottext">inferExp' :: FullEnv -&gt; Exp1 -&gt; [Var] -&gt; Dest -&gt; TiM (Exp2, Ty2)
</span><a href="Gibbon.Passes.InferLocations.html#inferExp%27"><span class="hs-identifier hs-var hs-var">inferExp'</span></a></span></span><span> </span><span id="local-6989586621680963936"><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680963936"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621680963937"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680963937"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span id="local-6989586621680963938"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680963938"><span class="hs-identifier hs-var">bound</span></a></span></span><span> </span><span id="local-6989586621680963939"><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680963939"><span class="hs-identifier hs-var">dest</span></a></span></span><span class="hs-glyph">=</span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span>      </span><span class="hs-comment">-- TODO: These should not be necessary, eventually</span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span>      </span><span class="annot"><a href="#local-6989586621680963940"><span class="hs-identifier hs-type">bindAllUnbound</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">L2.Exp2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">L2.Exp2</span></a></span><span>
</span><span id="line-300"></span><span>      </span><span id="local-6989586621680963940"><span class="annot"><span class="annottext">bindAllUnbound :: Exp2 -&gt; [Var] -&gt; TiM Exp2
</span><a href="#local-6989586621680963940"><span class="hs-identifier hs-var hs-var">bindAllUnbound</span></a></span></span><span> </span><span id="local-6989586621680963941"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680963941"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680963942"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963942"><span class="hs-identifier hs-var">lv</span></a></span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680963943"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680963943"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-301"></span><span>        </span><span id="local-6989586621680963944"><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680963944"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Region
-&gt; ExceptT Failure (StateT InferState PassM) Region
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Region
 -&gt; ExceptT Failure (StateT InferState PassM) Region)
-&gt; StateT InferState PassM Region
-&gt; ExceptT Failure (StateT InferState PassM) Region
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Region -&gt; StateT InferState PassM Region
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Region -&gt; StateT InferState PassM Region)
-&gt; PassM Region -&gt; StateT InferState PassM Region
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Region
</span><a href="Gibbon.Passes.InferLocations.html#freshRegVar"><span class="hs-identifier hs-var">freshRegVar</span></a></span><span>
</span><span id="line-302"></span><span>        </span><span id="local-6989586621680963946"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680963946"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; [Var] -&gt; TiM Exp2
</span><a href="#local-6989586621680963940"><span class="hs-identifier hs-var">bindAllUnbound</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680963941"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680963943"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-303"></span><span>        </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2) -&gt; Exp2 -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Region -&gt; RegionSize -&gt; Maybe RegionType -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec.
Region
-&gt; RegionSize -&gt; Maybe RegionType -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetRegionE"><span class="hs-identifier hs-var">LetRegionE</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680963944"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">RegionSize
</span><a href="Gibbon.L2.Syntax.html#Undefined"><span class="hs-identifier hs-var">Undefined</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RegionType
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; PreLocExp Var -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; PreLocExp loc -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-var">LetLocE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963942"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Region -&gt; PreLocExp Var
forall loc. Region -&gt; PreLocExp loc
</span><a href="Gibbon.L2.Syntax.html#StartOfRegionLE"><span class="hs-identifier hs-var">StartOfRegionLE</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680963944"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680963946"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>      </span><span class="annot"><a href="#local-6989586621680963940"><span class="hs-identifier hs-var">bindAllUnbound</span></a></span><span> </span><span id="local-6989586621680963952"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680963952"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680963952"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span>      </span><span class="annot"><a href="#local-6989586621680963953"><span class="hs-identifier hs-type">bindAllLocations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>
</span><span id="line-307"></span><span>      </span><span id="local-6989586621680963953"><span class="annot"><span class="annottext">bindAllLocations :: Result -&gt; TiM Result
</span><a href="#local-6989586621680963953"><span class="hs-identifier hs-var hs-var">bindAllLocations</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680963954"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680963954"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680963955"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680963955"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680963956"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680963956"><span class="hs-identifier hs-var">constrs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Result -&gt; TiM Result) -&gt; Result -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680963957"><span class="hs-identifier hs-var">expr'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680963955"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>          </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680963958"><span class="annot"><span class="annottext">constrs' :: [Constraint]
</span><a href="#local-6989586621680963958"><span class="hs-identifier hs-var hs-var">constrs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.OldList.html#nub"><span class="hs-identifier hs-var">L.nub</span></a></span><span> </span><span class="annot"><span class="annottext">([Constraint] -&gt; [Constraint]) -&gt; [Constraint] -&gt; [Constraint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680963956"><span class="hs-identifier hs-var">constrs</span></a></span><span>
</span><span id="line-309"></span><span>                </span><span id="local-6989586621680963957"><span class="annot"><span class="annottext">expr' :: Exp2
</span><a href="#local-6989586621680963957"><span class="hs-identifier hs-var hs-var">expr'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Constraint -&gt; Exp2 -&gt; Exp2) -&gt; Exp2 -&gt; [Constraint] -&gt; Exp2
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Constraint -&gt; Exp2 -&gt; Exp2
</span><a href="#local-6989586621680963961"><span class="hs-identifier hs-var">addLetLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680963954"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680963958"><span class="hs-identifier hs-var">constrs'</span></a></span><span>
</span><span id="line-310"></span><span>                </span><span id="local-6989586621680963961"><span class="annot"><span class="annottext">addLetLoc :: Constraint -&gt; Exp2 -&gt; Exp2
</span><a href="#local-6989586621680963961"><span class="hs-identifier hs-var hs-var">addLetLoc</span></a></span></span><span> </span><span id="local-6989586621680963962"><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680963962"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680963963"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680963963"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-311"></span><span>                    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680963962"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-312"></span><span>                      </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#AfterConstantL"><span class="hs-identifier hs-type">AfterConstantL</span></a></span><span> </span><span id="local-6989586621680963964"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963964"><span class="hs-identifier hs-var">lv1</span></a></span></span><span> </span><span id="local-6989586621680963965"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680963965"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680963966"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963966"><span class="hs-identifier hs-var">lv2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; PreLocExp Var -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; PreLocExp loc -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-var">LetLocE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963964"><span class="hs-identifier hs-var">lv1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Var -&gt; PreLocExp Var
forall loc. Int -&gt; loc -&gt; PreLocExp loc
</span><a href="Gibbon.L2.Syntax.html#AfterConstantLE"><span class="hs-identifier hs-var">AfterConstantLE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680963965"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963966"><span class="hs-identifier hs-var">lv2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680963963"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>                      </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#AfterVariableL"><span class="hs-identifier hs-type">AfterVariableL</span></a></span><span> </span><span id="local-6989586621680963968"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963968"><span class="hs-identifier hs-var">lv1</span></a></span></span><span> </span><span id="local-6989586621680963969"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963969"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680963970"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963970"><span class="hs-identifier hs-var">lv2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; PreLocExp Var -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; PreLocExp loc -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-var">LetLocE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963968"><span class="hs-identifier hs-var">lv1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Bool -&gt; PreLocExp Var
forall loc. Var -&gt; loc -&gt; Bool -&gt; PreLocExp loc
</span><a href="Gibbon.L2.Syntax.html#AfterVariableLE"><span class="hs-identifier hs-var">AfterVariableLE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963969"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963970"><span class="hs-identifier hs-var">lv2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680963963"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>                      </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#StartRegionL"><span class="hs-identifier hs-type">StartRegionL</span></a></span><span> </span><span id="local-6989586621680963972"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963972"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span id="local-6989586621680963973"><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680963973"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Region -&gt; RegionSize -&gt; Maybe RegionType -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec.
Region
-&gt; RegionSize -&gt; Maybe RegionType -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetRegionE"><span class="hs-identifier hs-var">LetRegionE</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680963973"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">RegionSize
</span><a href="Gibbon.L2.Syntax.html#Undefined"><span class="hs-identifier hs-var">Undefined</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RegionType
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; PreLocExp Var -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; PreLocExp loc -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-var">LetLocE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963972"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Region -&gt; PreLocExp Var
forall loc. Region -&gt; PreLocExp loc
</span><a href="Gibbon.L2.Syntax.html#StartOfRegionLE"><span class="hs-identifier hs-var">StartOfRegionLE</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680963973"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680963963"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>                      </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#AfterTagL"><span class="hs-identifier hs-type">AfterTagL</span></a></span><span> </span><span id="local-6989586621680963974"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963974"><span class="hs-identifier hs-var">lv1</span></a></span></span><span> </span><span id="local-6989586621680963975"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963975"><span class="hs-identifier hs-var">lv2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; PreLocExp Var -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; PreLocExp loc -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-var">LetLocE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963974"><span class="hs-identifier hs-var">lv1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Var -&gt; PreLocExp Var
forall loc. Int -&gt; loc -&gt; PreLocExp loc
</span><a href="Gibbon.L2.Syntax.html#AfterConstantLE"><span class="hs-identifier hs-var">AfterConstantLE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963975"><span class="hs-identifier hs-var">lv2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680963963"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>                      </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FreeL"><span class="hs-identifier hs-type">FreeL</span></a></span><span> </span><span id="local-6989586621680963976"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963976"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; PreLocExp Var -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; PreLocExp loc -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-var">LetLocE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963976"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="annot"><span class="annottext">PreLocExp Var
forall loc. PreLocExp loc
</span><a href="Gibbon.L2.Syntax.html#FreeLE"><span class="hs-identifier hs-var">FreeLE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680963963"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>                      </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#AfterCopyL"><span class="hs-identifier hs-type">AfterCopyL</span></a></span><span> </span><span id="local-6989586621680963978"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963978"><span class="hs-identifier hs-var">lv1</span></a></span></span><span> </span><span id="local-6989586621680963979"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963979"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span id="local-6989586621680963980"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963980"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span id="local-6989586621680963981"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963981"><span class="hs-identifier hs-var">lv2</span></a></span></span><span> </span><span id="local-6989586621680963982"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963982"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680963983"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680963983"><span class="hs-identifier hs-var">lvs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-318"></span><span>                        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680963984"><span class="annot"><span class="annottext">arrty :: Ty2
</span><a href="#local-6989586621680963984"><span class="hs-identifier hs-var hs-var">arrty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArrowTy2 Ty2 -&gt; Ty2
forall ty2. ArrowTy2 ty2 -&gt; ty2
</span><a href="Gibbon.L2.Syntax.html#arrOut"><span class="hs-identifier hs-var">arrOut</span></a></span><span> </span><span class="annot"><span class="annottext">(ArrowTy2 Ty2 -&gt; Ty2) -&gt; ArrowTy2 Ty2 -&gt; Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; FullEnv -&gt; ArrowTy2 Ty2
</span><a href="Gibbon.Passes.InferLocations.html#lookupFEnv"><span class="hs-identifier hs-var">lookupFEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963982"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680963936"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-319"></span><span>                            </span><span class="hs-comment">-- Substitute the location occurring at the call site</span><span>
</span><span id="line-320"></span><span>                            </span><span class="hs-comment">-- in place of the one in the function's return type</span><span>
</span><span id="line-321"></span><span>                            </span><span id="local-6989586621680963985"><span class="annot"><span class="annottext">copyRetTy :: Ty2
</span><a href="#local-6989586621680963985"><span class="hs-identifier hs-var hs-var">copyRetTy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680963984"><span class="hs-identifier hs-var">arrty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-322"></span><span>                                          </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680963986"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963986"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map Var Var -&gt; Ty2 -&gt; Ty2
</span><a href="Gibbon.L2.Syntax.html#substLoc"><span class="hs-identifier hs-var">substLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Map Var Var
forall k a. k -&gt; a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#singleton"><span class="hs-identifier hs-var">M.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963986"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963981"><span class="hs-identifier hs-var">lv2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680963984"><span class="hs-identifier hs-var">arrty</span></a></span><span>
</span><span id="line-323"></span><span>                                          </span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Ty2
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;bindAllLocations: Not a packed type&quot;</span></span><span>
</span><span id="line-324"></span><span>                            </span><span id="local-6989586621680963990"><span class="annot"><span class="annottext">a' :: Exp2
</span><a href="#local-6989586621680963990"><span class="hs-identifier hs-var hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp2 -&gt; Exp2 -&gt; Exp2
forall (e :: * -&gt; * -&gt; *) l d.
HasSubstitutable e l d =&gt;
Var -&gt; PreExp e l d -&gt; PreExp e l d -&gt; PreExp e l d
</span><a href="Gibbon.Language.html#subst"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963979"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963980"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680963963"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-325"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963980"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680963985"><span class="hs-identifier hs-var">copyRetTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963982"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680963983"><span class="hs-identifier hs-var">lvs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963979"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; Exp2) -&gt; Exp2 -&gt; Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-326"></span><span>                           </span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; PreLocExp Var -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; PreLocExp loc -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-var">LetLocE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963978"><span class="hs-identifier hs-var">lv1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Bool -&gt; PreLocExp Var
forall loc. Var -&gt; loc -&gt; Bool -&gt; PreLocExp loc
</span><a href="Gibbon.L2.Syntax.html#AfterVariableLE"><span class="hs-identifier hs-var">AfterVariableLE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963980"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680963981"><span class="hs-identifier hs-var">lv2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680963990"><span class="hs-identifier hs-var">a'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680963995"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680963995"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680963936"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680963937"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680963939"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-329"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621680963996"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680963996"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680963997"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680963997"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680963998"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680963998"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>  </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
</span><a href="#local-6989586621680963953"><span class="hs-identifier hs-var">bindAllLocations</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680963995"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-330"></span><span>        </span><span id="local-6989586621680963999"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680963999"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>   </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
</span><a href="Gibbon.Passes.InferLocations.html#finishExp"><span class="hs-identifier hs-var">finishExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680963996"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-331"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964000"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964000"><span class="hs-identifier hs-var">e''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964001"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680964001"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; (Exp2, Set Var)
</span><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-var">cleanExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680963999"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-332"></span><span>            </span><span id="local-6989586621680964003"><span class="annot"><span class="annottext">unbound :: Set Var
</span><a href="#local-6989586621680964003"><span class="hs-identifier hs-var hs-var">unbound</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680964001"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; Set Var -&gt; Set Var
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#%5C%5C"><span class="hs-operator hs-var">S.\\</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; Set Var
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">S.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680963938"><span class="hs-identifier hs-var">bound</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>        </span><span id="local-6989586621680964006"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964006"><span class="hs-identifier hs-var">e'''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; [Var] -&gt; TiM Exp2
</span><a href="#local-6989586621680963940"><span class="hs-identifier hs-var">bindAllUnbound</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964000"><span class="hs-identifier hs-var">e''</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Var -&gt; [Var]
forall a. Set a -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#toList"><span class="hs-identifier hs-var">S.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680964003"><span class="hs-identifier hs-var">unbound</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>        </span><span class="annot"><span class="annottext">(Exp2, Ty2) -&gt; TiM (Exp2, Ty2)
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964006"><span class="hs-identifier hs-var">e'''</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680963997"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="hs-comment">-- | We proceed in a destination-passing style given the target region</span><span>
</span><span id="line-337"></span><span class="hs-comment">-- into which we must produce the resulting value.</span><span>
</span><span id="line-338"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-type">inferExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FullEnv"><span class="hs-identifier hs-type">FullEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Exp1"><span class="hs-identifier hs-type">Exp1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Dest"><span class="hs-identifier hs-type">Dest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>
</span><span id="line-339"></span><span id="inferExp"><span class="annot"><span class="annottext">inferExp :: FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var hs-var">inferExp</span></a></span></span><span> </span><span id="local-6989586621680964803"><span class="annot"><span class="annottext">env :: FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FullEnv"><span class="hs-identifier hs-type">FullEnv</span></a></span><span class="hs-special">{</span><span id="local-6989586621680964804"><span class="annot"><span class="annottext">DDefs Ty2
dataDefs :: FullEnv -&gt; DDefs Ty2
dataDefs :: DDefs Ty2
</span><a href="Gibbon.Passes.InferLocations.html#dataDefs"><span class="hs-identifier hs-var hs-var">dataDefs</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621680964805"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680964805"><span class="hs-identifier hs-var">ex0</span></a></span></span><span> </span><span id="local-6989586621680964806"><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-340"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span>      </span><span class="hs-comment">-- | Check if there are any StartRegion constraints that can be dischaged here.</span><span>
</span><span id="line-343"></span><span>      </span><span class="hs-comment">-- The basic logic is that if we know a location `loc` is the start of a region `r`,</span><span>
</span><span id="line-344"></span><span>      </span><span class="hs-comment">-- and we know that there are no constraints for anything after `loc` left</span><span>
</span><span id="line-345"></span><span>      </span><span class="hs-comment">-- to be discharged, then we can insert the region binding for `r`.</span><span>
</span><span id="line-346"></span><span>      </span><span class="annot"><a href="#local-6989586621680964807"><span class="hs-identifier hs-type">tryBindReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>
</span><span id="line-347"></span><span>      </span><span id="local-6989586621680964807"><span class="annot"><span class="annottext">tryBindReg :: Result -&gt; TiM Result
</span><a href="#local-6989586621680964807"><span class="hs-identifier hs-var hs-var">tryBindReg</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964808"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964808"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964809"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964809"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#StartRegionL"><span class="hs-identifier hs-type">StartRegionL</span></a></span><span> </span><span id="local-6989586621680964810"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964810"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span id="local-6989586621680964811"><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680964811"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621680964812"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964812"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-348"></span><span>          </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680964813"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964813"><span class="hs-identifier hs-var">lv'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964810"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-349"></span><span>             </span><span class="hs-special">(</span><span id="local-6989586621680964814"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964814"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964815"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964815"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964816"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964816"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
</span><a href="#local-6989586621680964807"><span class="hs-identifier hs-var">tryBindReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964808"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964809"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964812"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>             </span><span id="local-6989586621680964817"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680964817"><span class="hs-identifier hs-var">b1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Constraint] -&gt; [Constraint] -&gt; TiM Bool
</span><a href="Gibbon.Passes.InferLocations.html#noAfterLoc"><span class="hs-identifier hs-var">noAfterLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964813"><span class="hs-identifier hs-var">lv'</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964816"><span class="hs-identifier hs-var">cs'</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964816"><span class="hs-identifier hs-var">cs'</span></a></span><span>
</span><span id="line-351"></span><span>             </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680964817"><span class="hs-identifier hs-var">b1</span></a></span><span>
</span><span id="line-352"></span><span>             </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964819"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964819"><span class="hs-identifier hs-var">e''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964820"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964820"><span class="hs-identifier hs-var">ty''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964821"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964821"><span class="hs-identifier hs-var">cs''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964822"><span class="hs-identifier hs-var">bindTrivialAfterLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964813"><span class="hs-identifier hs-var">lv'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964814"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964815"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964816"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>                     </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Region -&gt; RegionSize -&gt; Maybe RegionType -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec.
Region
-&gt; RegionSize -&gt; Maybe RegionType -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetRegionE"><span class="hs-identifier hs-var">LetRegionE</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680964811"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">RegionSize
</span><a href="Gibbon.L2.Syntax.html#Undefined"><span class="hs-identifier hs-var">Undefined</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RegionType
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; PreLocExp Var -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; PreLocExp loc -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-var">LetLocE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964813"><span class="hs-identifier hs-var">lv'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Region -&gt; PreLocExp Var
forall loc. Region -&gt; PreLocExp loc
</span><a href="Gibbon.L2.Syntax.html#StartOfRegionLE"><span class="hs-identifier hs-var">StartOfRegionLE</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680964811"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964819"><span class="hs-identifier hs-var">e''</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964820"><span class="hs-identifier hs-var">ty''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964821"><span class="hs-identifier hs-var">cs''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>             </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964814"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964815"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Region -&gt; Constraint
</span><a href="Gibbon.Passes.InferLocations.html#StartRegionL"><span class="hs-identifier hs-var">StartRegionL</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964810"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680964811"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Constraint -&gt; [Constraint] -&gt; [Constraint]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964816"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>      </span><span class="annot"><a href="#local-6989586621680964807"><span class="hs-identifier hs-var">tryBindReg</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964823"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964823"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964824"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964824"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964825"><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680964825"><span class="hs-identifier hs-var">c</span></a></span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680964826"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964826"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-356"></span><span>          </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964827"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964827"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964828"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964828"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964829"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964829"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
</span><a href="#local-6989586621680964807"><span class="hs-identifier hs-var">tryBindReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964823"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964824"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964826"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>             </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964827"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964828"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680964825"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Constraint -&gt; [Constraint] -&gt; [Constraint]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964829"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>      </span><span class="annot"><a href="#local-6989586621680964807"><span class="hs-identifier hs-var">tryBindReg</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964830"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964830"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964831"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964831"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964830"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964831"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span>      </span><span class="hs-comment">-- | Check the existing list of constraints to determine if we need to introduce a new</span><span>
</span><span id="line-361"></span><span>      </span><span class="hs-comment">-- StartRegion constraint based on an existing AfterTag constraint.</span><span>
</span><span id="line-362"></span><span>      </span><span class="hs-comment">-- The logic here is that if we have an AfterTag constraint on two locations loc1 and loc2,</span><span>
</span><span id="line-363"></span><span>      </span><span class="hs-comment">-- (ie, loc2 is a data structure and loc1 is its first field), and we know that nothing is</span><span>
</span><span id="line-364"></span><span>      </span><span class="hs-comment">-- before loc2 and it isn't a fixed location, then it might be the start of a new region.</span><span>
</span><span id="line-365"></span><span>      </span><span class="hs-comment">-- We can't just bind the region immediately, though, so this function just adds a new</span><span>
</span><span id="line-366"></span><span>      </span><span class="hs-comment">-- constraint when appropriate, which will be discharged later.</span><span>
</span><span id="line-367"></span><span>      </span><span class="hs-comment">-- TODO: refactor and merge this function with other logic for region insertion</span><span>
</span><span id="line-368"></span><span>      </span><span class="annot"><a href="#local-6989586621680964832"><span class="hs-identifier hs-type">tryInRegion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-369"></span><span>      </span><span id="local-6989586621680964832"><span class="annot"><span class="annottext">tryInRegion :: [Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964832"><span class="hs-identifier hs-var hs-var">tryInRegion</span></a></span></span><span> </span><span id="local-6989586621680964833"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964833"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964834"><span class="hs-identifier hs-var">tryInRegion'</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964833"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964833"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span>      </span><span class="hs-comment">-- Hack, need a full copy of the constraint set in addition to the one being iterated over.</span><span>
</span><span id="line-372"></span><span>      </span><span class="annot"><a href="#local-6989586621680964834"><span class="hs-identifier hs-type">tryInRegion'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-373"></span><span>      </span><span id="local-6989586621680964834"><span class="annot"><span class="annottext">tryInRegion' :: [Constraint] -&gt; [Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964834"><span class="hs-identifier hs-var hs-var">tryInRegion'</span></a></span></span><span> </span><span id="local-6989586621680964835"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964835"><span class="hs-identifier hs-var">fcs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964836"><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680964836"><span class="hs-identifier hs-var">c</span></a></span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680964837"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964837"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-374"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680964836"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-375"></span><span>            </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#AfterTagL"><span class="hs-identifier hs-type">AfterTagL</span></a></span><span> </span><span id="local-6989586621680964838"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964838"><span class="hs-identifier hs-var">lv1</span></a></span></span><span> </span><span id="local-6989586621680964839"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964839"><span class="hs-identifier hs-var">lv2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-376"></span><span>                </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680964840"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964840"><span class="hs-identifier hs-var">lv1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964838"><span class="hs-identifier hs-var">lv1</span></a></span><span>
</span><span id="line-377"></span><span>                   </span><span id="local-6989586621680964841"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964841"><span class="hs-identifier hs-var">lv2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964839"><span class="hs-identifier hs-var">lv2</span></a></span><span>
</span><span id="line-378"></span><span>                   </span><span id="local-6989586621680964842"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680964842"><span class="hs-identifier hs-var">b1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Constraint] -&gt; TiM Bool
</span><a href="Gibbon.Passes.InferLocations.html#noBeforeLoc"><span class="hs-identifier hs-var">noBeforeLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964841"><span class="hs-identifier hs-var">lv2'</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964835"><span class="hs-identifier hs-var">fcs</span></a></span><span>
</span><span id="line-379"></span><span>                   </span><span id="local-6989586621680964844"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680964844"><span class="hs-identifier hs-var">b2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Constraint] -&gt; TiM Bool
</span><a href="Gibbon.Passes.InferLocations.html#noRegionStart"><span class="hs-identifier hs-var">noRegionStart</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964841"><span class="hs-identifier hs-var">lv2'</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964835"><span class="hs-identifier hs-var">fcs</span></a></span><span>
</span><span id="line-380"></span><span>                   </span><span id="local-6989586621680964846"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680964846"><span class="hs-identifier hs-var">b3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Bool
</span><a href="Gibbon.Passes.InferLocations.html#notFixedLoc"><span class="hs-identifier hs-var">notFixedLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964841"><span class="hs-identifier hs-var">lv2'</span></a></span><span>
</span><span id="line-381"></span><span>                   </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680964842"><span class="hs-identifier hs-var">b1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680964844"><span class="hs-identifier hs-var">b2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680964846"><span class="hs-identifier hs-var">b3</span></a></span><span>
</span><span id="line-382"></span><span>                   </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680964849"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964849"><span class="hs-identifier hs-var">cs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964834"><span class="hs-identifier hs-var">tryInRegion'</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964835"><span class="hs-identifier hs-var">fcs</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964837"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-383"></span><span>                           </span><span id="local-6989586621680964850"><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680964850"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Region
-&gt; ExceptT Failure (StateT InferState PassM) Region
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Region
 -&gt; ExceptT Failure (StateT InferState PassM) Region)
-&gt; StateT InferState PassM Region
-&gt; ExceptT Failure (StateT InferState PassM) Region
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Region -&gt; StateT InferState PassM Region
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Region -&gt; StateT InferState PassM Region)
-&gt; PassM Region -&gt; StateT InferState PassM Region
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Region
</span><a href="Gibbon.Passes.InferLocations.html#freshRegVar"><span class="hs-identifier hs-var">freshRegVar</span></a></span><span>
</span><span id="line-384"></span><span>                           </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680964851"><span class="annot"><span class="annottext">c' :: Constraint
</span><a href="#local-6989586621680964851"><span class="hs-identifier hs-var hs-var">c'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Region -&gt; Constraint
</span><a href="Gibbon.Passes.InferLocations.html#StartRegionL"><span class="hs-identifier hs-var">StartRegionL</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964841"><span class="hs-identifier hs-var">lv2'</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680964850"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-385"></span><span>                           </span><span class="annot"><span class="annottext">[Constraint] -&gt; TiM [Constraint]
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680964851"><span class="hs-identifier hs-var">c'</span></a></span><span class="annot"><span class="annottext">Constraint -&gt; [Constraint] -&gt; [Constraint]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680964836"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Constraint -&gt; [Constraint] -&gt; [Constraint]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964849"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-386"></span><span>                   </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680964852"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964852"><span class="hs-identifier hs-var">cs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964834"><span class="hs-identifier hs-var">tryInRegion'</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964835"><span class="hs-identifier hs-var">fcs</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964837"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-387"></span><span>                           </span><span class="annot"><span class="annottext">[Constraint] -&gt; TiM [Constraint]
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680964836"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Constraint -&gt; [Constraint] -&gt; [Constraint]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964852"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>            </span><span class="annot"><span class="annottext">Constraint
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680964853"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964853"><span class="hs-identifier hs-var">cs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964834"><span class="hs-identifier hs-var">tryInRegion'</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964835"><span class="hs-identifier hs-var">fcs</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964837"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-389"></span><span>                    </span><span class="annot"><span class="annottext">[Constraint] -&gt; TiM [Constraint]
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680964836"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Constraint -&gt; [Constraint] -&gt; [Constraint]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964853"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>      </span><span class="annot"><a href="#local-6989586621680964834"><span class="hs-identifier hs-var">tryInRegion'</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; TiM [Constraint]
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span>      </span><span class="hs-comment">-- | This function looks at a series of locations and a type, and determines if</span><span>
</span><span id="line-393"></span><span>      </span><span class="hs-comment">-- any of those locations could be the start of a region. Similar to `tryInRegion`.</span><span>
</span><span id="line-394"></span><span>      </span><span class="hs-comment">-- A location might be the start of a region if there's nothing before it and</span><span>
</span><span id="line-395"></span><span>      </span><span class="hs-comment">-- it isn't fixed.</span><span>
</span><span id="line-396"></span><span>      </span><span class="annot"><a href="#local-6989586621680964854"><span class="hs-identifier hs-type">tryNeedRegion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-397"></span><span>      </span><span id="local-6989586621680964854"><span class="annot"><span class="annottext">tryNeedRegion :: [Var] -&gt; Ty2 -&gt; [Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964854"><span class="hs-identifier hs-var hs-var">tryNeedRegion</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964855"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964855"><span class="hs-identifier hs-var">l</span></a></span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680964856"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680964856"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680964857"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964857"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680964858"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964858"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-398"></span><span>          </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680964859"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964859"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964855"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-399"></span><span>             </span><span id="local-6989586621680964860"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680964860"><span class="hs-identifier hs-var">vls</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; TiM Var)
-&gt; [Var] -&gt; ExceptT Failure (StateT InferState PassM) [Var]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty2 -&gt; [Var]
</span><a href="Gibbon.L2.Syntax.html#locsInTy"><span class="hs-identifier hs-var">locsInTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964857"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>             </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964859"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#elem"><span class="hs-operator hs-var">`L.elem`</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680964860"><span class="hs-identifier hs-var">vls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>             </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680964863"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680964863"><span class="hs-identifier hs-var">b1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Constraint] -&gt; TiM Bool
</span><a href="Gibbon.Passes.InferLocations.html#noBeforeLoc"><span class="hs-identifier hs-var">noBeforeLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964859"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964858"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-402"></span><span>                     </span><span id="local-6989586621680964864"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680964864"><span class="hs-identifier hs-var">b2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Constraint] -&gt; TiM Bool
</span><a href="Gibbon.Passes.InferLocations.html#noRegionStart"><span class="hs-identifier hs-var">noRegionStart</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964859"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964858"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-403"></span><span>                     </span><span id="local-6989586621680964865"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680964865"><span class="hs-identifier hs-var">b3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Bool
</span><a href="Gibbon.Passes.InferLocations.html#notFixedLoc"><span class="hs-identifier hs-var">notFixedLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964859"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-404"></span><span>                     </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680964863"><span class="hs-identifier hs-var">b1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680964864"><span class="hs-identifier hs-var">b2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680964865"><span class="hs-identifier hs-var">b3</span></a></span><span>
</span><span id="line-405"></span><span>                     </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680964866"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964866"><span class="hs-identifier hs-var">cs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; Ty2 -&gt; [Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964854"><span class="hs-identifier hs-var">tryNeedRegion</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680964856"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964857"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964858"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-406"></span><span>                             </span><span id="local-6989586621680964867"><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680964867"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Region
-&gt; ExceptT Failure (StateT InferState PassM) Region
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Region
 -&gt; ExceptT Failure (StateT InferState PassM) Region)
-&gt; StateT InferState PassM Region
-&gt; ExceptT Failure (StateT InferState PassM) Region
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Region -&gt; StateT InferState PassM Region
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Region -&gt; StateT InferState PassM Region)
-&gt; PassM Region -&gt; StateT InferState PassM Region
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Region
</span><a href="Gibbon.Passes.InferLocations.html#freshRegVar"><span class="hs-identifier hs-var">freshRegVar</span></a></span><span>
</span><span id="line-407"></span><span>                             </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680964868"><span class="annot"><span class="annottext">c :: Constraint
</span><a href="#local-6989586621680964868"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Region -&gt; Constraint
</span><a href="Gibbon.Passes.InferLocations.html#StartRegionL"><span class="hs-identifier hs-var">StartRegionL</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964859"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680964867"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-408"></span><span>                             </span><span class="annot"><span class="annottext">[Constraint] -&gt; TiM [Constraint]
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680964868"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Constraint -&gt; [Constraint] -&gt; [Constraint]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964866"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>                     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; Ty2 -&gt; [Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964854"><span class="hs-identifier hs-var">tryNeedRegion</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680964856"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964857"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964858"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-410"></span><span>             </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; Ty2 -&gt; [Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964854"><span class="hs-identifier hs-var">tryNeedRegion</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680964856"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964857"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964858"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-411"></span><span>      </span><span class="annot"><a href="#local-6989586621680964854"><span class="hs-identifier hs-var">tryNeedRegion</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680964869"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964869"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; TiM [Constraint]
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964869"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span>      </span><span class="hs-comment">-- | This function will transform a result to wrap the sub-expression with any</span><span>
</span><span id="line-414"></span><span>      </span><span class="hs-comment">-- simple location bindings for locations from the provided list.</span><span>
</span><span id="line-415"></span><span>      </span><span class="hs-comment">-- For example, if a location `loc1` is known from an AfterTag constraint,</span><span>
</span><span id="line-416"></span><span>      </span><span class="hs-comment">-- and `[loc1]` is passed in, the `letloc` binding for `loc1` will be wrapped</span><span>
</span><span id="line-417"></span><span>      </span><span class="hs-comment">-- around the expression in the result.</span><span>
</span><span id="line-418"></span><span>      </span><span class="annot"><a href="#local-6989586621680964870"><span class="hs-identifier hs-type">bindImmediateDependentLocs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>
</span><span id="line-419"></span><span>      </span><span id="local-6989586621680964870"><span class="annot"><span class="annottext">bindImmediateDependentLocs :: [Var] -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964870"><span class="hs-identifier hs-var hs-var">bindImmediateDependentLocs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964871"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964871"><span class="hs-identifier hs-var">lv</span></a></span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680964872"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680964872"><span class="hs-identifier hs-var">lvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964873"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964873"><span class="hs-identifier hs-var">bod</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964874"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964874"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964875"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964875"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-420"></span><span>          </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964876"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964876"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964877"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964877"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964878"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964878"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964870"><span class="hs-identifier hs-var">bindImmediateDependentLocs</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680964872"><span class="hs-identifier hs-var">lvs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964873"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964874"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964875"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>             </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964879"><span class="hs-identifier hs-var">bindImmediateDependentLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964871"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964876"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964877"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964878"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span>      </span><span class="annot"><a href="#local-6989586621680964870"><span class="hs-identifier hs-var">bindImmediateDependentLocs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621680964880"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680964880"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680964880"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span>      </span><span class="hs-comment">-- single location variant of above function</span><span>
</span><span id="line-425"></span><span>      </span><span class="annot"><a href="#local-6989586621680964879"><span class="hs-identifier hs-type">bindImmediateDependentLoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>
</span><span id="line-426"></span><span>      </span><span id="local-6989586621680964879"><span class="annot"><span class="annottext">bindImmediateDependentLoc :: Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964879"><span class="hs-identifier hs-var hs-var">bindImmediateDependentLoc</span></a></span></span><span> </span><span id="local-6989586621680964881"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964881"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964882"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964882"><span class="hs-identifier hs-var">bod</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964883"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964883"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#AfterTagL"><span class="hs-identifier hs-type">AfterTagL</span></a></span><span> </span><span id="local-6989586621680964884"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964884"><span class="hs-identifier hs-var">lv1</span></a></span></span><span> </span><span id="local-6989586621680964885"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964885"><span class="hs-identifier hs-var">lv2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621680964886"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964886"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-427"></span><span>          </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680964887"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964887"><span class="hs-identifier hs-var">lv'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964881"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-428"></span><span>             </span><span id="local-6989586621680964888"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964888"><span class="hs-identifier hs-var">lv1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964884"><span class="hs-identifier hs-var">lv1</span></a></span><span>
</span><span id="line-429"></span><span>             </span><span id="local-6989586621680964889"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964889"><span class="hs-identifier hs-var">lv2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964885"><span class="hs-identifier hs-var">lv2</span></a></span><span>
</span><span id="line-430"></span><span>             </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964887"><span class="hs-identifier hs-var">lv'</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964888"><span class="hs-identifier hs-var">lv1'</span></a></span><span>
</span><span id="line-431"></span><span>             </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964890"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964890"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964891"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964891"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964892"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964892"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964879"><span class="hs-identifier hs-var">bindImmediateDependentLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964881"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964882"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964883"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964886"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>                     </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680964893"><span class="annot"><span class="annottext">bod'' :: Exp2
</span><a href="#local-6989586621680964893"><span class="hs-identifier hs-var hs-var">bod''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; PreLocExp Var -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; PreLocExp loc -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-var">LetLocE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964888"><span class="hs-identifier hs-var">lv1'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Var -&gt; PreLocExp Var
forall loc. Int -&gt; loc -&gt; PreLocExp loc
</span><a href="Gibbon.L2.Syntax.html#AfterConstantLE"><span class="hs-identifier hs-var">AfterConstantLE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964889"><span class="hs-identifier hs-var">lv2'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964890"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span>                     </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964893"><span class="hs-identifier hs-var">bod''</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964891"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964892"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span>             </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964894"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964894"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964895"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964895"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964896"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964896"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964879"><span class="hs-identifier hs-var">bindImmediateDependentLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964881"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964882"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964883"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964886"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-435"></span><span>                     </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964894"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964895"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Constraint
</span><a href="Gibbon.Passes.InferLocations.html#AfterTagL"><span class="hs-identifier hs-var">AfterTagL</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964884"><span class="hs-identifier hs-var">lv1</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964885"><span class="hs-identifier hs-var">lv2</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Constraint -&gt; [Constraint] -&gt; [Constraint]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964896"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>      </span><span class="annot"><a href="#local-6989586621680964879"><span class="hs-identifier hs-var">bindImmediateDependentLoc</span></a></span><span> </span><span id="local-6989586621680964897"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964897"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964898"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964898"><span class="hs-identifier hs-var">bod</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964899"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964899"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621680964900"><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680964900"><span class="hs-identifier hs-var">c</span></a></span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680964901"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964901"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-437"></span><span>          </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964902"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964902"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964903"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964903"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964904"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964904"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964879"><span class="hs-identifier hs-var">bindImmediateDependentLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964897"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964898"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964899"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964901"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>             </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964902"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964903"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680964900"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Constraint -&gt; [Constraint] -&gt; [Constraint]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964904"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>      </span><span class="annot"><a href="#local-6989586621680964879"><span class="hs-identifier hs-var">bindImmediateDependentLoc</span></a></span><span> </span><span id="local-6989586621680964905"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964905"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964906"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964906"><span class="hs-identifier hs-var">bod</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964907"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964907"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964906"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964907"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span>      </span><span class="hs-comment">-- | This transforms a result to add location bindings that can be inserted safely</span><span>
</span><span id="line-442"></span><span>      </span><span class="hs-comment">-- once the variable passed in is in scope.</span><span>
</span><span id="line-443"></span><span>      </span><span class="hs-comment">-- This is expected to be called on the *whole let expression*, not its body.</span><span>
</span><span id="line-444"></span><span>      </span><span class="annot"><a href="#local-6989586621680964908"><span class="hs-identifier hs-type">handleTrailingBindLoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>
</span><span id="line-445"></span><span>      </span><span id="local-6989586621680964908"><span class="annot"><span class="annottext">handleTrailingBindLoc :: Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964908"><span class="hs-identifier hs-var hs-var">handleTrailingBindLoc</span></a></span></span><span> </span><span id="local-6989586621680964909"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964909"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680964910"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680964910"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-446"></span><span>          </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964911"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964911"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964912"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964912"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964913"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964913"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964914"><span class="hs-identifier hs-var">bindAfterLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964909"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680964910"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-447"></span><span>             </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964911"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-448"></span><span>               </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-type">LetLocE</span></a></span><span> </span><span id="local-6989586621680964915"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964915"><span class="hs-identifier hs-var">lv1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#AfterVariableLE"><span class="hs-identifier hs-type">AfterVariableLE</span></a></span><span> </span><span id="local-6989586621680964916"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964916"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680964917"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964917"><span class="hs-identifier hs-var">lv2</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680964918"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964918"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-449"></span><span>                   </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964919"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964919"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964920"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964920"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964921"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964921"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964822"><span class="hs-identifier hs-var">bindTrivialAfterLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964915"><span class="hs-identifier hs-var">lv1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964918"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964912"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964913"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>                      </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; PreLocExp Var -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; PreLocExp loc -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-var">LetLocE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964915"><span class="hs-identifier hs-var">lv1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Bool -&gt; PreLocExp Var
forall loc. Var -&gt; loc -&gt; Bool -&gt; PreLocExp loc
</span><a href="Gibbon.L2.Syntax.html#AfterVariableLE"><span class="hs-identifier hs-var">AfterVariableLE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964916"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964917"><span class="hs-identifier hs-var">lv2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964919"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964920"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964921"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span>               </span><span class="annot"><span class="annottext">Exp2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964911"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964912"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964913"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Should this signal an error instead of silently returning?</span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span>      </span><span class="hs-comment">-- | Transforms a result by adding a location binding derived from an AfterVariable constraint</span><span>
</span><span id="line-454"></span><span>      </span><span class="hs-comment">-- associated with the passed-in variable.</span><span>
</span><span id="line-455"></span><span>      </span><span class="annot"><a href="#local-6989586621680964914"><span class="hs-identifier hs-type">bindAfterLoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>
</span><span id="line-456"></span><span>      </span><span id="local-6989586621680964914"><span class="annot"><span class="annottext">bindAfterLoc :: Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964914"><span class="hs-identifier hs-var hs-var">bindAfterLoc</span></a></span></span><span> </span><span id="local-6989586621680964922"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964922"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964923"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964923"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964924"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964924"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964925"><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680964925"><span class="hs-identifier hs-var">c</span></a></span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680964926"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964926"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-457"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680964925"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-458"></span><span>            </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#AfterVariableL"><span class="hs-identifier hs-type">AfterVariableL</span></a></span><span> </span><span id="local-6989586621680964927"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964927"><span class="hs-identifier hs-var">lv1</span></a></span></span><span> </span><span id="local-6989586621680964928"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964928"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span id="local-6989586621680964929"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964929"><span class="hs-identifier hs-var">lv2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-459"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964922"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964928"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-460"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680964930"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964930"><span class="hs-identifier hs-var">lv1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964927"><span class="hs-identifier hs-var">lv1</span></a></span><span>
</span><span id="line-461"></span><span>                        </span><span id="local-6989586621680964931"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964931"><span class="hs-identifier hs-var">lv2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964929"><span class="hs-identifier hs-var">lv2</span></a></span><span>
</span><span id="line-462"></span><span>                        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680964932"><span class="annot"><span class="annottext">res' :: Result
</span><a href="#local-6989586621680964932"><span class="hs-identifier hs-var hs-var">res'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; PreLocExp Var -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; PreLocExp loc -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-var">LetLocE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964930"><span class="hs-identifier hs-var">lv1'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Bool -&gt; PreLocExp Var
forall loc. Var -&gt; loc -&gt; Bool -&gt; PreLocExp loc
</span><a href="Gibbon.L2.Syntax.html#AfterVariableLE"><span class="hs-identifier hs-var">AfterVariableLE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964922"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964929"><span class="hs-identifier hs-var">lv2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964923"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964924"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964926"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>                        </span><span id="local-6989586621680964933"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680964933"><span class="hs-identifier hs-var">res''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964914"><span class="hs-identifier hs-var">bindAfterLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964922"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680964932"><span class="hs-identifier hs-var">res'</span></a></span><span>
</span><span id="line-464"></span><span>                        </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680964933"><span class="hs-identifier hs-var">res''</span></a></span><span>
</span><span id="line-465"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964934"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964934"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964935"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964935"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964936"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964936"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964914"><span class="hs-identifier hs-var">bindAfterLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964922"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964923"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964924"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964926"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>                        </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964934"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964935"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680964925"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Constraint -&gt; [Constraint] -&gt; [Constraint]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964936"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span>            </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#AfterCopyL"><span class="hs-identifier hs-type">AfterCopyL</span></a></span><span> </span><span id="local-6989586621680964937"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964937"><span class="hs-identifier hs-var">lv1</span></a></span></span><span> </span><span id="local-6989586621680964938"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964938"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span id="local-6989586621680964939"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964939"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span id="local-6989586621680964940"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964940"><span class="hs-identifier hs-var">lv2</span></a></span></span><span> </span><span id="local-6989586621680964941"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964941"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680964942"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680964942"><span class="hs-identifier hs-var">lvs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-468"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964922"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964938"><span class="hs-identifier hs-var">v1</span></a></span><span>
</span><span id="line-469"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680964943"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964943"><span class="hs-identifier hs-var">lv1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964937"><span class="hs-identifier hs-var">lv1</span></a></span><span>
</span><span id="line-470"></span><span>                        </span><span id="local-6989586621680964944"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964944"><span class="hs-identifier hs-var">lv2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964940"><span class="hs-identifier hs-var">lv2</span></a></span><span>
</span><span id="line-471"></span><span>                        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680964945"><span class="annot"><span class="annottext">arrty :: ArrowTy2 Ty2
</span><a href="#local-6989586621680964945"><span class="hs-identifier hs-var hs-var">arrty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; FullEnv -&gt; ArrowTy2 Ty2
</span><a href="Gibbon.Passes.InferLocations.html#lookupFEnv"><span class="hs-identifier hs-var">lookupFEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964941"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-472"></span><span>                            </span><span class="hs-comment">-- Substitute the location occurring at the call site</span><span>
</span><span id="line-473"></span><span>                            </span><span class="hs-comment">-- in place of the one in the function's return type</span><span>
</span><span id="line-474"></span><span>                            </span><span id="local-6989586621680964946"><span class="annot"><span class="annottext">copyRetTy :: Ty2
</span><a href="#local-6989586621680964946"><span class="hs-identifier hs-var hs-var">copyRetTy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ArrowTy2 Ty2 -&gt; Ty2
forall ty2. ArrowTy2 ty2 -&gt; ty2
</span><a href="Gibbon.L2.Syntax.html#arrOut"><span class="hs-identifier hs-var">arrOut</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy2 Ty2
</span><a href="#local-6989586621680964945"><span class="hs-identifier hs-var">arrty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-475"></span><span>                                          </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680964947"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964947"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map Var Var -&gt; Ty2 -&gt; Ty2
</span><a href="Gibbon.L2.Syntax.html#substLoc"><span class="hs-identifier hs-var">substLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Map Var Var
forall k a. k -&gt; a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#singleton"><span class="hs-identifier hs-var">M.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964947"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964940"><span class="hs-identifier hs-var">lv2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArrowTy2 Ty2 -&gt; Ty2
forall ty2. ArrowTy2 ty2 -&gt; ty2
</span><a href="Gibbon.L2.Syntax.html#arrOut"><span class="hs-identifier hs-var">arrOut</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy2 Ty2
</span><a href="#local-6989586621680964945"><span class="hs-identifier hs-var">arrty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>                                          </span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Ty2
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;bindAfterLoc: Not a packed type&quot;</span></span><span>
</span><span id="line-477"></span><span>                        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680964948"><span class="annot"><span class="annottext">res' :: Result
</span><a href="#local-6989586621680964948"><span class="hs-identifier hs-var hs-var">res'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964939"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964946"><span class="hs-identifier hs-var">copyRetTy</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964941"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680964942"><span class="hs-identifier hs-var">lvs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964938"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; Exp2) -&gt; Exp2 -&gt; Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; PreLocExp Var -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; PreLocExp loc -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-var">LetLocE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964943"><span class="hs-identifier hs-var">lv1'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Bool -&gt; PreLocExp Var
forall loc. Var -&gt; loc -&gt; Bool -&gt; PreLocExp loc
</span><a href="Gibbon.L2.Syntax.html#AfterVariableLE"><span class="hs-identifier hs-var">AfterVariableLE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964939"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964944"><span class="hs-identifier hs-var">lv2'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964923"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964924"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964926"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>                        </span><span id="local-6989586621680964949"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680964949"><span class="hs-identifier hs-var">res''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964914"><span class="hs-identifier hs-var">bindAfterLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964922"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680964948"><span class="hs-identifier hs-var">res'</span></a></span><span>
</span><span id="line-479"></span><span>                        </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680964949"><span class="hs-identifier hs-var">res''</span></a></span><span>
</span><span id="line-480"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964950"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964950"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964951"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964951"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964952"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964952"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964914"><span class="hs-identifier hs-var">bindAfterLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964922"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964923"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964924"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964926"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span>                        </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964950"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964951"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680964925"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Constraint -&gt; [Constraint] -&gt; [Constraint]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964952"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>            </span><span class="annot"><span class="annottext">Constraint
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964953"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964953"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964954"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964954"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964955"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964955"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964914"><span class="hs-identifier hs-var">bindAfterLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964922"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964923"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964924"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964926"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-483"></span><span>                    </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964953"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964954"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680964925"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Constraint -&gt; [Constraint] -&gt; [Constraint]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964955"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>      </span><span class="annot"><a href="#local-6989586621680964914"><span class="hs-identifier hs-var">bindAfterLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964956"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964956"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964957"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964957"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964956"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964957"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span>      </span><span class="hs-comment">-- | Transform a result by discharging AfterVariable constraints corresponding to</span><span>
</span><span id="line-487"></span><span>      </span><span class="hs-comment">-- a list of newly bound variables.</span><span>
</span><span id="line-488"></span><span>      </span><span class="hs-comment">-- NOTE : Reversing the order in which bindings are discharged seems to fix the location type check error. </span><span>
</span><span id="line-489"></span><span>      </span><span class="annot"><a href="#local-6989586621680964958"><span class="hs-identifier hs-type">bindAfterLocs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>
</span><span id="line-490"></span><span>      </span><span id="local-6989586621680964958"><span class="annot"><span class="annottext">bindAfterLocs :: [Var] -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964958"><span class="hs-identifier hs-var hs-var">bindAfterLocs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964959"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964959"><span class="hs-identifier hs-var">v</span></a></span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680964960"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680964960"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680964961"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680964961"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-491"></span><span>          </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680964962"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680964962"><span class="hs-identifier hs-var">res''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964958"><span class="hs-identifier hs-var">bindAfterLocs</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680964960"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680964961"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-492"></span><span>             </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964914"><span class="hs-identifier hs-var">bindAfterLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964959"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680964962"><span class="hs-identifier hs-var">res''</span></a></span><span>
</span><span id="line-493"></span><span>      </span><span class="annot"><a href="#local-6989586621680964958"><span class="hs-identifier hs-var">bindAfterLocs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621680964963"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680964963"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680964963"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-494"></span><span>
</span><span id="line-495"></span><span>      </span><span class="hs-comment">-- | Transforms a result by binding any additional locations that are safe to be bound</span><span>
</span><span id="line-496"></span><span>      </span><span class="hs-comment">-- once the location passed in has been bound. For example, if we know `loc1` is `n`</span><span>
</span><span id="line-497"></span><span>      </span><span class="hs-comment">-- bytes after `loc2`, and `loc2` has been passed in, we can bind `loc1`.</span><span>
</span><span id="line-498"></span><span>      </span><span class="annot"><a href="#local-6989586621680964822"><span class="hs-identifier hs-type">bindTrivialAfterLoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>
</span><span id="line-499"></span><span>      </span><span id="local-6989586621680964822"><span class="annot"><span class="annottext">bindTrivialAfterLoc :: Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964822"><span class="hs-identifier hs-var hs-var">bindTrivialAfterLoc</span></a></span></span><span> </span><span id="local-6989586621680964964"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964964"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964965"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964965"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964966"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964966"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964967"><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680964967"><span class="hs-identifier hs-var">c</span></a></span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680964968"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964968"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-500"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680964967"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-501"></span><span>            </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#AfterTagL"><span class="hs-identifier hs-type">AfterTagL</span></a></span><span> </span><span id="local-6989586621680964969"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964969"><span class="hs-identifier hs-var">lv1</span></a></span></span><span> </span><span id="local-6989586621680964970"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964970"><span class="hs-identifier hs-var">lv2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-502"></span><span>                </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680964971"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964971"><span class="hs-identifier hs-var">lv1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964969"><span class="hs-identifier hs-var">lv1</span></a></span><span>
</span><span id="line-503"></span><span>                   </span><span id="local-6989586621680964972"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964972"><span class="hs-identifier hs-var">lv2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964970"><span class="hs-identifier hs-var">lv2</span></a></span><span>
</span><span id="line-504"></span><span>                   </span><span id="local-6989586621680964973"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964973"><span class="hs-identifier hs-var">lv'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964964"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-505"></span><span>                   </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964972"><span class="hs-identifier hs-var">lv2'</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964973"><span class="hs-identifier hs-var">lv'</span></a></span><span>
</span><span id="line-506"></span><span>                   </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964974"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964974"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964975"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964975"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964976"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964976"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964822"><span class="hs-identifier hs-var">bindTrivialAfterLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964969"><span class="hs-identifier hs-var">lv1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964965"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964966"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964968"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span>                           </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; PreLocExp Var -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; PreLocExp loc -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-var">LetLocE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964971"><span class="hs-identifier hs-var">lv1'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Var -&gt; PreLocExp Var
forall loc. Int -&gt; loc -&gt; PreLocExp loc
</span><a href="Gibbon.L2.Syntax.html#AfterConstantLE"><span class="hs-identifier hs-var">AfterConstantLE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964972"><span class="hs-identifier hs-var">lv2'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964974"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964975"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964976"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>                   </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964977"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964977"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964978"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964978"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964979"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964979"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964822"><span class="hs-identifier hs-var">bindTrivialAfterLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964964"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964965"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964966"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964968"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span>                           </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964977"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964978"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680964967"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Constraint -&gt; [Constraint] -&gt; [Constraint]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964979"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span>            </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#AfterConstantL"><span class="hs-identifier hs-type">AfterConstantL</span></a></span><span> </span><span id="local-6989586621680964980"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964980"><span class="hs-identifier hs-var">lv1</span></a></span></span><span> </span><span id="local-6989586621680964981"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680964981"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680964982"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964982"><span class="hs-identifier hs-var">lv2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-511"></span><span>                </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680964983"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964983"><span class="hs-identifier hs-var">lv1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964980"><span class="hs-identifier hs-var">lv1</span></a></span><span>
</span><span id="line-512"></span><span>                   </span><span id="local-6989586621680964984"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964984"><span class="hs-identifier hs-var">lv2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964982"><span class="hs-identifier hs-var">lv2</span></a></span><span>
</span><span id="line-513"></span><span>                   </span><span id="local-6989586621680964985"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964985"><span class="hs-identifier hs-var">lv'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964964"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-514"></span><span>                   </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964984"><span class="hs-identifier hs-var">lv2'</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964985"><span class="hs-identifier hs-var">lv'</span></a></span><span>
</span><span id="line-515"></span><span>                   </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964986"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964986"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964987"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964987"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964988"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964988"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964822"><span class="hs-identifier hs-var">bindTrivialAfterLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964980"><span class="hs-identifier hs-var">lv1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964965"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964966"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964968"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-516"></span><span>                           </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; PreLocExp Var -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; PreLocExp loc -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-var">LetLocE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964983"><span class="hs-identifier hs-var">lv1'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Var -&gt; PreLocExp Var
forall loc. Int -&gt; loc -&gt; PreLocExp loc
</span><a href="Gibbon.L2.Syntax.html#AfterConstantLE"><span class="hs-identifier hs-var">AfterConstantLE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680964981"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964984"><span class="hs-identifier hs-var">lv2'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964986"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964987"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964988"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span>                   </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964989"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964989"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964990"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964990"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964991"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964991"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964822"><span class="hs-identifier hs-var">bindTrivialAfterLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964964"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964965"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964966"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964968"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-518"></span><span>                           </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964989"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964990"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680964967"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Constraint -&gt; [Constraint] -&gt; [Constraint]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964991"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-519"></span><span>            </span><span class="annot"><span class="annottext">Constraint
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964992"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964992"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964993"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964993"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964994"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964994"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964822"><span class="hs-identifier hs-var">bindTrivialAfterLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680964964"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964965"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964966"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964968"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-520"></span><span>                    </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964992"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964993"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680964967"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Constraint -&gt; [Constraint] -&gt; [Constraint]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680964994"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-521"></span><span>      </span><span class="annot"><a href="#local-6989586621680964822"><span class="hs-identifier hs-var">bindTrivialAfterLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680964995"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964995"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680964996"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964996"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680964995"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680964996"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-522"></span><span>
</span><span id="line-523"></span><span>      </span><span class="hs-comment">-- | To handle a case expression, we need to bind locations</span><span>
</span><span id="line-524"></span><span>      </span><span class="hs-comment">-- appropriately for all the fields.</span><span>
</span><span id="line-525"></span><span>      </span><span class="annot"><a href="#local-6989586621680964997"><span class="hs-identifier hs-type">doCase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DDefs"><span class="hs-identifier hs-type">DDefs</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FullEnv"><span class="hs-identifier hs-type">FullEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Dest"><span class="hs-identifier hs-type">Dest</span></a></span><span>
</span><span id="line-526"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Exp1"><span class="hs-identifier hs-type">Exp1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-527"></span><span>             </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">L2.Exp2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-528"></span><span>      </span><span id="local-6989586621680964997"><span class="annot"><span class="annottext">doCase :: DDefs Ty2
-&gt; FullEnv
-&gt; Var
-&gt; Dest
-&gt; (String, [(Var, ())], Exp1)
-&gt; TiM ((String, [(Var, Var)], Exp2), Ty2, [Constraint])
</span><a href="#local-6989586621680964997"><span class="hs-identifier hs-var hs-var">doCase</span></a></span></span><span> </span><span id="local-6989586621680964999"><span class="annot"><span class="annottext">DDefs Ty2
</span><a href="#local-6989586621680964999"><span class="hs-identifier hs-var">ddfs</span></a></span></span><span> </span><span id="local-6989586621680965000"><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680965000"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621680965001"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965001"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span id="local-6989586621680965002"><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680965002"><span class="hs-identifier hs-var">dst</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680965003"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965003"><span class="hs-identifier hs-var">con</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965004"><span class="annot"><span class="annottext">[(Var, ())]
</span><a href="#local-6989586621680965004"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965005"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965005"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-529"></span><span>        </span><span id="local-6989586621680965006"><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680965006"><span class="hs-identifier hs-var">vars'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Var, ())]
-&gt; ((Var, ())
    -&gt; ExceptT Failure (StateT InferState PassM) (Var, Var))
-&gt; ExceptT Failure (StateT InferState PassM) [(Var, Var)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#forM"><span class="hs-identifier hs-var">forM</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, ())]
</span><a href="#local-6989586621680965004"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">(((Var, ())
  -&gt; ExceptT Failure (StateT InferState PassM) (Var, Var))
 -&gt; ExceptT Failure (StateT InferState PassM) [(Var, Var)])
-&gt; ((Var, ())
    -&gt; ExceptT Failure (StateT InferState PassM) (Var, Var))
-&gt; ExceptT Failure (StateT InferState PassM) [(Var, Var)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680965007"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965007"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680965008"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965008"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Var -&gt; TiM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Var -&gt; TiM Var)
-&gt; StateT InferState PassM Var -&gt; TiM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Var -&gt; StateT InferState PassM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Var -&gt; StateT InferState PassM Var)
-&gt; PassM Var -&gt; StateT InferState PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; PassM Var
</span><a href="Gibbon.Passes.InferLocations.html#freshLocVar"><span class="hs-identifier hs-var">freshLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;case&quot;</span></span><span>
</span><span id="line-530"></span><span>                                          </span><span class="annot"><span class="annottext">UnifyLoc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM UnifyLoc
</span><a href="Gibbon.Passes.InferLocations.html#fixLoc"><span class="hs-identifier hs-var">fixLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965008"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-531"></span><span>                                          </span><span class="annot"><span class="annottext">(Var, Var) -&gt; ExceptT Failure (StateT InferState PassM) (Var, Var)
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965007"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965008"><span class="hs-identifier hs-var">lv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-532"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965009"><span class="annot"><span class="annottext">contys :: [Ty2]
</span><a href="#local-6989586621680965009"><span class="hs-identifier hs-var hs-var">contys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DDefs Ty2 -&gt; String -&gt; [Ty2]
forall a. Out a =&gt; DDefs a -&gt; String -&gt; [a]
</span><a href="Gibbon.Language.Syntax.html#lookupDataCon"><span class="hs-identifier hs-var">lookupDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs Ty2
</span><a href="#local-6989586621680964999"><span class="hs-identifier hs-var">ddfs</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965003"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-533"></span><span>            </span><span id="local-6989586621680965011"><span class="annot"><span class="annottext">newtys :: [Ty2]
</span><a href="#local-6989586621680965011"><span class="hs-identifier hs-var hs-var">newtys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Ty2, (Var, Var)) -&gt; Ty2) -&gt; [(Ty2, (Var, Var))] -&gt; [Ty2]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">L.map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680965012"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965012"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680965013"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965013"><span class="hs-identifier hs-var">lv</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; Var) -&gt; Ty2 -&gt; Ty2
forall a b. (a -&gt; b) -&gt; UrTy a -&gt; UrTy b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Var
forall a b. a -&gt; b -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965013"><span class="hs-identifier hs-var">lv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965012"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Ty2, (Var, Var))] -&gt; [Ty2]) -&gt; [(Ty2, (Var, Var))] -&gt; [Ty2]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2] -&gt; [(Var, Var)] -&gt; [(Ty2, (Var, Var))]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965009"><span class="hs-identifier hs-var">contys</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680965006"><span class="hs-identifier hs-var">vars'</span></a></span><span>
</span><span id="line-534"></span><span>            </span><span id="local-6989586621680965014"><span class="annot"><span class="annottext">env' :: FullEnv
</span><a href="#local-6989586621680965014"><span class="hs-identifier hs-var hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Var, Ty2) -&gt; FullEnv -&gt; FullEnv)
-&gt; FullEnv -&gt; [(Var, Ty2)] -&gt; FullEnv
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">L.foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680965015"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965015"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965016"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965016"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680965017"><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680965017"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965015"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965016"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680965017"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680965000"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">([(Var, Ty2)] -&gt; FullEnv) -&gt; [(Var, Ty2)] -&gt; FullEnv
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Ty2] -&gt; [(Var, Ty2)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Var, Var) -&gt; Var) -&gt; [(Var, Var)] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">L.map</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Var) -&gt; Var
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680965006"><span class="hs-identifier hs-var">vars'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965011"><span class="hs-identifier hs-var">newtys</span></a></span><span>
</span><span id="line-535"></span><span>        </span><span id="local-6989586621680965018"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680965018"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680965014"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965005"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680965002"><span class="hs-identifier hs-var">dst</span></a></span><span>
</span><span id="line-536"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621680965019"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965019"><span class="hs-identifier hs-var">rhs'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965020"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965020"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965021"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965021"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>   </span><span class="annot"><span class="annottext">[Var] -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964958"><span class="hs-identifier hs-var">bindAfterLocs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp1 -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#orderOfVarsOutputDataConE"><span class="hs-identifier hs-var">orderOfVarsOutputDataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965005"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680965018"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-537"></span><span>        </span><span class="hs-comment">-- let cs'' = removeLocs (L.map snd vars') cs'</span><span>
</span><span id="line-538"></span><span>        </span><span class="hs-comment">-- TODO: check constraints are correct and fail/repair if they're not!!!</span><span>
</span><span id="line-539"></span><span>        </span><span class="annot"><span class="annottext">((String, [(Var, Var)], Exp2), Ty2, [Constraint])
-&gt; TiM ((String, [(Var, Var)], Exp2), Ty2, [Constraint])
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965003"><span class="hs-identifier hs-var">con</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680965006"><span class="hs-identifier hs-var">vars'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965019"><span class="hs-identifier hs-var">rhs'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965020"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965021"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-540"></span><span>
</span><span id="line-541"></span><span>
</span><span id="line-542"></span><span>  </span><span class="hs-keyword">in</span><span>
</span><span id="line-543"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680964805"><span class="hs-identifier hs-var">ex0</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-544"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span id="local-6989586621680965023"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965023"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-545"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965024"><span class="annot"><span class="annottext">e' :: Exp2
</span><a href="#local-6989586621680965024"><span class="hs-identifier hs-var hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965023"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-546"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-547"></span><span>        </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965024"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; FullEnv -&gt; Ty2
</span><a href="Gibbon.Passes.InferLocations.html#lookupVEnv"><span class="hs-identifier hs-var">lookupVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965023"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-548"></span><span>        </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TupleDest"><span class="hs-identifier hs-type">TupleDest</span></a></span><span> </span><span id="local-6989586621680965025"><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680965025"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-549"></span><span>           </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680965026"><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965026"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; FullEnv -&gt; Ty2
</span><a href="Gibbon.Passes.InferLocations.html#lookupVEnv"><span class="hs-identifier hs-var">lookupVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965023"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-550"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[Dest] -&gt; [Ty2] -&gt; TiM Result -&gt; TiM Result -&gt; TiM Result
forall a. [Dest] -&gt; [Ty2] -&gt; TiM a -&gt; TiM a -&gt; TiM a
</span><a href="Gibbon.Passes.InferLocations.html#unifyAll"><span class="hs-identifier hs-var">unifyAll</span></a></span><span> </span><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680965025"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965026"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-551"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965024"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty2] -&gt; Ty2
forall loc. [UrTy loc] -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965026"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-552"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TiM Result) -&gt; String -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TODO: support copying parts of tuples &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965024"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; in &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Dest] -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680965025"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; for types &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2] -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965026"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-553"></span><span>        </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#SingleDest"><span class="hs-identifier hs-type">SingleDest</span></a></span><span> </span><span id="local-6989586621680965029"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965029"><span class="hs-identifier hs-var">d</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-554"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965030"><span class="annot"><span class="annottext">ty :: Ty2
</span><a href="#local-6989586621680965030"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; FullEnv -&gt; Ty2
</span><a href="Gibbon.Passes.InferLocations.html#lookupVEnv"><span class="hs-identifier hs-var">lookupVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965023"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-555"></span><span>                  </span><span id="local-6989586621680965031"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965031"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965030"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-556"></span><span>                           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680965032"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965032"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965032"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-557"></span><span>                           </span><span class="hs-comment">-- TODO: refactor this so we never try to put a non-packed type</span><span>
</span><span id="line-558"></span><span>                           </span><span class="hs-comment">-- in a location</span><span>
</span><span id="line-559"></span><span>                           </span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Var -&gt; TiM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Var -&gt; TiM Var)
-&gt; StateT InferState PassM Var -&gt; TiM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Var -&gt; StateT InferState PassM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Var -&gt; StateT InferState PassM Var)
-&gt; PassM Var -&gt; StateT InferState PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; PassM Var
</span><a href="Gibbon.Passes.InferLocations.html#freshLocVar"><span class="hs-identifier hs-var">freshLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;imm&quot;</span></span><span>
</span><span id="line-560"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965033"><span class="annot"><span class="annottext">ty' :: Ty2
</span><a href="#local-6989586621680965033"><span class="hs-identifier hs-var hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965030"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-561"></span><span>                              </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span id="local-6989586621680965034"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965034"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680965035"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965035"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Var -&gt; Ty2
forall loc. String -&gt; loc -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-var">PackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965034"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965029"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-562"></span><span>                              </span><span id="local-6989586621680965036"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965036"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965036"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-563"></span><span>                  </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; TiM Result -&gt; TiM Result -&gt; TiM Result
forall a. Var -&gt; Var -&gt; TiM a -&gt; TiM a -&gt; TiM a
</span><a href="Gibbon.Passes.InferLocations.html#unify"><span class="hs-identifier hs-var">unify</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965029"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965031"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-564"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965024"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965033"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-565"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; Var -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#copy"><span class="hs-identifier hs-var">copy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965024"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965030"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965029"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-type">ProjE</span></a></span><span> </span><span id="local-6989586621680965039"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965039"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680965040"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965040"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-568"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621680965041"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965041"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680965042"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965042"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965040"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-569"></span><span>          </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span id="local-6989586621680965043"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965043"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Exp2, Ty2) -&gt; TiM (Exp2, Ty2)
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Int -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-var">ProjE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965039"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965043"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680965044"><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965044"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; FullEnv -&gt; Ty2
</span><a href="Gibbon.Passes.InferLocations.html#lookupVEnv"><span class="hs-identifier hs-var">lookupVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965043"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965044"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2] -&gt; Int -&gt; Ty2
forall a. HasCallStack =&gt; [a] -&gt; Int -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#%21%21"><span class="hs-operator hs-var">!!</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965039"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-570"></span><span>          </span><span id="local-6989586621680965046"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965046"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680965047"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965047"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680965048"><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965048"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Int -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-var">ProjE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965039"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965047"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965048"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2] -&gt; Int -&gt; Ty2
forall a. HasCallStack =&gt; [a] -&gt; Int -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#%21%21"><span class="hs-operator hs-var">!!</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965039"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Result -&gt; (Exp2, Ty2)) -&gt; TiM Result -&gt; TiM (Exp2, Ty2)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965040"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-571"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-572"></span><span>            </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965041"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965042"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-573"></span><span>            </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TupleDest"><span class="hs-identifier hs-type">TupleDest</span></a></span><span> </span><span id="local-6989586621680965049"><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680965049"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TODO: handle tuple of destinations for ProjE&quot;</span></span><span>
</span><span id="line-574"></span><span>            </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#SingleDest"><span class="hs-identifier hs-type">SingleDest</span></a></span><span> </span><span id="local-6989586621680965050"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965050"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-575"></span><span>                </span><span id="local-6989586621680965051"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965051"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965042"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-576"></span><span>                          </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680965052"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965052"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965052"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-577"></span><span>                          </span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Var -&gt; TiM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Var -&gt; TiM Var)
-&gt; StateT InferState PassM Var -&gt; TiM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Var -&gt; StateT InferState PassM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Var -&gt; StateT InferState PassM Var)
-&gt; PassM Var -&gt; StateT InferState PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; PassM Var
</span><a href="Gibbon.Passes.InferLocations.html#freshLocVar"><span class="hs-identifier hs-var">freshLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;imm&quot;</span></span><span>
</span><span id="line-578"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965053"><span class="annot"><span class="annottext">ty' :: Ty2
</span><a href="#local-6989586621680965053"><span class="hs-identifier hs-var hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965042"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-579"></span><span>                            </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span id="local-6989586621680965054"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965054"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680965055"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965055"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Var -&gt; Ty2
forall loc. String -&gt; loc -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-var">PackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965054"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965050"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-580"></span><span>                            </span><span id="local-6989586621680965056"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965056"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965056"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-581"></span><span>                </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; TiM Result -&gt; TiM Result -&gt; TiM Result
forall a. Var -&gt; Var -&gt; TiM a -&gt; TiM a -&gt; TiM a
</span><a href="Gibbon.Passes.InferLocations.html#unify"><span class="hs-identifier hs-var">unify</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965050"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965051"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-582"></span><span>                          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965041"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965053"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-583"></span><span>                          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; Var -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#copy"><span class="hs-identifier hs-var">copy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965041"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965042"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965050"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-584"></span><span>
</span><span id="line-585"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-type">MkProdE</span></a></span><span> </span><span id="local-6989586621680965058"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965058"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-586"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-587"></span><span>        </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680965059"><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965059"><span class="hs-identifier hs-var">results</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; TiM Result)
-&gt; [Exp1] -&gt; ExceptT Failure (StateT InferState PassM) [Result]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680965060"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965060"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965060"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965058"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-588"></span><span>                     </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965061"><span class="annot"><span class="annottext">pty :: Ty2
</span><a href="#local-6989586621680965061"><span class="hs-identifier hs-var hs-var">pty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965059"><span class="hs-identifier hs-var">results</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-589"></span><span>                                 </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680965062"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965062"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965062"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-590"></span><span>                                 </span><span class="annot"><span class="annottext">[Result]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Ty2] -&gt; Ty2
forall loc. [UrTy loc] -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965063"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680965063"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965063"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965059"><span class="hs-identifier hs-var">results</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-591"></span><span>                     </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
[PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-var">MkProdE</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965064"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680965064"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965064"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965059"><span class="hs-identifier hs-var">results</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965061"><span class="hs-identifier hs-var">pty</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-592"></span><span>                               </span><span class="annot"><span class="annottext">[[Constraint]] -&gt; [Constraint]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">([[Constraint]] -&gt; [Constraint]) -&gt; [[Constraint]] -&gt; [Constraint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965065"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680965065"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965065"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965059"><span class="hs-identifier hs-var">results</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-593"></span><span>        </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#SingleDest"><span class="hs-identifier hs-type">SingleDest</span></a></span><span> </span><span id="local-6989586621680965066"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965066"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965058"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-594"></span><span>                          </span><span class="hs-special">[</span><span id="local-6989586621680965067"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965067"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680965068"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965068"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965069"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965069"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965070"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965070"><span class="hs-identifier hs-var">les</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965067"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-595"></span><span>                                    </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
[PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-var">MkProdE</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965068"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965069"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965070"><span class="hs-identifier hs-var">les</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-596"></span><span>                          </span><span class="annot"><span class="annottext">[Exp1]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TiM Result) -&gt; String -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot match single destination to tuple: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680964805"><span class="hs-identifier hs-var">ex0</span></a></span><span>
</span><span id="line-597"></span><span>        </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TupleDest"><span class="hs-identifier hs-type">TupleDest</span></a></span><span> </span><span id="local-6989586621680965071"><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680965071"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680965072"><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965072"><span class="hs-identifier hs-var">results</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((Exp1, Dest) -&gt; TiM Result)
-&gt; [(Exp1, Dest)]
-&gt; ExceptT Failure (StateT InferState PassM) [Result]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680965073"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965073"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965074"><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680965074"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965073"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680965074"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Exp1, Dest)]
 -&gt; ExceptT Failure (StateT InferState PassM) [Result])
-&gt; [(Exp1, Dest)]
-&gt; ExceptT Failure (StateT InferState PassM) [Result]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1] -&gt; [Dest] -&gt; [(Exp1, Dest)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965058"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680965071"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-598"></span><span>                           </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
[PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-var">MkProdE</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965075"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680965075"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965075"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965072"><span class="hs-identifier hs-var">results</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-599"></span><span>                                     </span><span class="annot"><span class="annottext">[Ty2] -&gt; Ty2
forall loc. [UrTy loc] -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965076"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680965076"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965076"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965072"><span class="hs-identifier hs-var">results</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-600"></span><span>                                     </span><span class="annot"><span class="annottext">[[Constraint]] -&gt; [Constraint]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">([[Constraint]] -&gt; [Constraint]) -&gt; [[Constraint]] -&gt; [Constraint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965077"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680965077"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965077"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965072"><span class="hs-identifier hs-var">results</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-601"></span><span>
</span><span id="line-602"></span><span>
</span><span id="line-603"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-type">SpawnE</span></a></span><span> </span><span id="local-6989586621680965079"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965079"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">[()]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680965080"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965080"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-604"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621680965081"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965081"><span class="hs-identifier hs-var">ex0'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680965082"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965082"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680965083"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965083"><span class="hs-identifier hs-var">acs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [()] -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965079"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965080"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-605"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965081"><span class="hs-identifier hs-var">ex0'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-606"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span id="local-6989586621680965084"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965084"><span class="hs-identifier hs-var">f'</span></a></span></span><span> </span><span id="local-6989586621680965085"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965085"><span class="hs-identifier hs-var">locs</span></a></span></span><span> </span><span id="local-6989586621680965086"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965086"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-var">SpawnE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965084"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965085"><span class="hs-identifier hs-var">locs</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965086"><span class="hs-identifier hs-var">args'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965082"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965083"><span class="hs-identifier hs-var">acs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-607"></span><span>        </span><span id="local-6989586621680965087"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965087"><span class="hs-identifier hs-var">oth</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TiM Result) -&gt; String -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SpawnE: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965087"><span class="hs-identifier hs-var">oth</span></a></span><span>
</span><span id="line-608"></span><span>
</span><span id="line-609"></span><span>    </span><span class="annot"><span class="annottext">Exp1
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty2] -&gt; Ty2
forall loc. [UrTy loc] -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-610"></span><span>
</span><span id="line-611"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-type">LitE</span></a></span><span> </span><span id="local-6989586621680965090"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965090"><span class="hs-identifier hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Int -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-var">LitE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965090"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#IntTy"><span class="hs-identifier hs-var">IntTy</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CharE"><span class="hs-identifier hs-type">CharE</span></a></span><span> </span><span id="local-6989586621680965093"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680965093"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Char -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CharE"><span class="hs-identifier hs-var">CharE</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680965093"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#CharTy"><span class="hs-identifier hs-var">CharTy</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-613"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-type">FloatE</span></a></span><span> </span><span id="local-6989586621680965096"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680965096"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Double -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-var">FloatE</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680965096"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#FloatTy"><span class="hs-identifier hs-var">FloatTy</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-614"></span><span>
</span><span id="line-615"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-type">LitSymE</span></a></span><span> </span><span id="local-6989586621680965099"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965099"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-var">LitSymE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965099"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#SymTy"><span class="hs-identifier hs-var">SymTy</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-616"></span><span>
</span><span id="line-617"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span id="local-6989586621680965101"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965101"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">[()]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680965102"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965102"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-618"></span><span>        </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965103"><span class="annot"><span class="annottext">arrty :: ArrowTy2 Ty2
</span><a href="#local-6989586621680965103"><span class="hs-identifier hs-var hs-var">arrty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; FullEnv -&gt; ArrowTy2 Ty2
</span><a href="Gibbon.Passes.InferLocations.html#lookupFEnv"><span class="hs-identifier hs-var">lookupFEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965101"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-619"></span><span>           </span><span id="local-6989586621680965104"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965104"><span class="hs-identifier hs-var">valTy</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; TiM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#freshTyLocs"><span class="hs-identifier hs-var">freshTyLocs</span></a></span><span> </span><span class="annot"><span class="annottext">(Ty2 -&gt; TiM Ty2) -&gt; Ty2 -&gt; TiM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy2 Ty2 -&gt; Ty2
forall ty2. ArrowTy2 ty2 -&gt; ty2
</span><a href="Gibbon.L2.Syntax.html#arrOut"><span class="hs-identifier hs-var">arrOut</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy2 Ty2
</span><a href="#local-6989586621680965103"><span class="hs-identifier hs-var">arrty</span></a></span><span>
</span><span id="line-620"></span><span>           </span><span class="hs-comment">-- /cc @vollmerm</span><span>
</span><span id="line-621"></span><span>           </span><span id="local-6989586621680965105"><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965105"><span class="hs-identifier hs-var">argTys</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Ty2 -&gt; TiM Ty2)
-&gt; [Ty2] -&gt; ExceptT Failure (StateT InferState PassM) [Ty2]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; TiM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#freshTyLocs"><span class="hs-identifier hs-var">freshTyLocs</span></a></span><span> </span><span class="annot"><span class="annottext">([Ty2] -&gt; ExceptT Failure (StateT InferState PassM) [Ty2])
-&gt; [Ty2] -&gt; ExceptT Failure (StateT InferState PassM) [Ty2]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy2 Ty2 -&gt; [Ty2]
forall ty2. ArrowTy2 ty2 -&gt; [ty2]
</span><a href="Gibbon.L2.Syntax.html#arrIns"><span class="hs-identifier hs-var">arrIns</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy2 Ty2
</span><a href="#local-6989586621680965103"><span class="hs-identifier hs-var">arrty</span></a></span><span>
</span><span id="line-622"></span><span>           </span><span id="local-6989586621680965106"><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680965106"><span class="hs-identifier hs-var">argDests</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Ty2 -&gt; TiM Dest)
-&gt; [Ty2] -&gt; ExceptT Failure (StateT InferState PassM) [Dest]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; TiM Dest
</span><a href="Gibbon.Passes.InferLocations.html#destFromType%27"><span class="hs-identifier hs-var">destFromType'</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965105"><span class="hs-identifier hs-var">argTys</span></a></span><span>
</span><span id="line-623"></span><span>           </span><span class="hs-special">(</span><span id="local-6989586621680965107"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965107"><span class="hs-identifier hs-var">args'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680965108"><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965108"><span class="hs-identifier hs-var">atys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680965109"><span class="annot"><span class="annottext">[[Constraint]]
</span><a href="#local-6989586621680965109"><span class="hs-identifier hs-var">acss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Result] -&gt; ([Exp2], [Ty2], [[Constraint]])
forall a b c. [(a, b, c)] -&gt; ([a], [b], [c])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip3"><span class="hs-identifier hs-var">L.unzip3</span></a></span><span> </span><span class="annot"><span class="annottext">([Result] -&gt; ([Exp2], [Ty2], [[Constraint]]))
-&gt; ExceptT Failure (StateT InferState PassM) [Result]
-&gt; ExceptT
     Failure (StateT InferState PassM) ([Exp2], [Ty2], [[Constraint]])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">((Exp1, Dest) -&gt; TiM Result)
-&gt; [(Exp1, Dest)]
-&gt; ExceptT Failure (StateT InferState PassM) [Result]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Exp1 -&gt; Dest -&gt; TiM Result) -&gt; (Exp1, Dest) -&gt; TiM Result
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#uncurry"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">((Exp1 -&gt; Dest -&gt; TiM Result) -&gt; (Exp1, Dest) -&gt; TiM Result)
-&gt; (Exp1 -&gt; Dest -&gt; TiM Result) -&gt; (Exp1, Dest) -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Exp1] -&gt; [Dest] -&gt; [(Exp1, Dest)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965102"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680965106"><span class="hs-identifier hs-var">argDests</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-624"></span><span>           </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965112"><span class="annot"><span class="annottext">acs :: [Constraint]
</span><a href="#local-6989586621680965112"><span class="hs-identifier hs-var hs-var">acs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Constraint]] -&gt; [Constraint]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">[[Constraint]]
</span><a href="#local-6989586621680965109"><span class="hs-identifier hs-var">acss</span></a></span><span>
</span><span id="line-625"></span><span>           </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-626"></span><span>             </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#SingleDest"><span class="hs-identifier hs-type">SingleDest</span></a></span><span> </span><span id="local-6989586621680965113"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965113"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-627"></span><span>               </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; [Var]
</span><a href="Gibbon.L2.Syntax.html#locsInTy"><span class="hs-identifier hs-var">locsInTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965104"><span class="hs-identifier hs-var">valTy</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-628"></span><span>                 </span><span class="hs-special">[</span><span id="local-6989586621680965114"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965114"><span class="hs-identifier hs-var">outloc</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; TiM Result -&gt; TiM Result -&gt; TiM Result
forall a. Var -&gt; Var -&gt; TiM a -&gt; TiM a -&gt; TiM a
</span><a href="Gibbon.Passes.InferLocations.html#unify"><span class="hs-identifier hs-var">unify</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965113"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965114"><span class="hs-identifier hs-var">outloc</span></a></span><span>
</span><span id="line-629"></span><span>                               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">L2.AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965101"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Ty2 -&gt; [Var]) -&gt; [Ty2] -&gt; [Var]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; [Var]
</span><a href="Gibbon.L2.Syntax.html#locsInTy"><span class="hs-identifier hs-var">locsInTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965108"><span class="hs-identifier hs-var">atys</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [Var]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Dest -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#locsInDest"><span class="hs-identifier hs-var">locsInDest</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965107"><span class="hs-identifier hs-var">args'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965104"><span class="hs-identifier hs-var">valTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965112"><span class="hs-identifier hs-var">acs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-630"></span><span>                               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span class="annot"><span class="annottext">(String -&gt; TiM Result) -&gt; String -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(AppE) Cannot unify&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965113"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; and &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965114"><span class="hs-identifier hs-var">outloc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-631"></span><span>                 </span><span class="annot"><span class="annottext">[Var]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span class="annot"><span class="annottext">(String -&gt; TiM Result) -&gt; String -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;AppE expected a single output location in type: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965104"><span class="hs-identifier hs-var">valTy</span></a></span><span>
</span><span id="line-632"></span><span>             </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TupleDest"><span class="hs-identifier hs-type">TupleDest</span></a></span><span> </span><span id="local-6989586621680965115"><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680965115"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-633"></span><span>               </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965104"><span class="hs-identifier hs-var">valTy</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-634"></span><span>                 </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680965116"><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965116"><span class="hs-identifier hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Dest] -&gt; [Ty2] -&gt; TiM Result -&gt; TiM Result -&gt; TiM Result
forall a. [Dest] -&gt; [Ty2] -&gt; TiM a -&gt; TiM a -&gt; TiM a
</span><a href="Gibbon.Passes.InferLocations.html#unifyAll"><span class="hs-identifier hs-var">unifyAll</span></a></span><span> </span><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680965115"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965116"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-635"></span><span>                                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">L2.AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965101"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Ty2 -&gt; [Var]) -&gt; [Ty2] -&gt; [Var]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; [Var]
</span><a href="Gibbon.L2.Syntax.html#locsInTy"><span class="hs-identifier hs-var">locsInTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965108"><span class="hs-identifier hs-var">atys</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [Var]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Dest -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#locsInDest"><span class="hs-identifier hs-var">locsInDest</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965107"><span class="hs-identifier hs-var">args'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965104"><span class="hs-identifier hs-var">valTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965112"><span class="hs-identifier hs-var">acs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-636"></span><span>                                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span class="annot"><span class="annottext">(String -&gt; TiM Result) -&gt; String -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(AppE) Cannot unify&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Dest] -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680965115"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; and &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2] -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965116"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-637"></span><span>                 </span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span class="annot"><span class="annottext">(String -&gt; TiM Result) -&gt; String -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(AppE) Cannot unify&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Dest -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; and &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965104"><span class="hs-identifier hs-var">valTy</span></a></span><span>
</span><span id="line-638"></span><span>             </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-639"></span><span>               </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; [Var]
</span><a href="Gibbon.L2.Syntax.html#locsInTy"><span class="hs-identifier hs-var">locsInTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965104"><span class="hs-identifier hs-var">valTy</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-640"></span><span>                 </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">L2.AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965101"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Ty2 -&gt; [Var]) -&gt; [Ty2] -&gt; [Var]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; [Var]
</span><a href="Gibbon.L2.Syntax.html#locsInTy"><span class="hs-identifier hs-var">locsInTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965108"><span class="hs-identifier hs-var">atys</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [Var]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Dest -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#locsInDest"><span class="hs-identifier hs-var">locsInDest</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965107"><span class="hs-identifier hs-var">args'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965104"><span class="hs-identifier hs-var">valTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965112"><span class="hs-identifier hs-var">acs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-641"></span><span>                 </span><span class="annot"><span class="annottext">[Var]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span class="annot"><span class="annottext">(String -&gt; TiM Result) -&gt; String -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(AppE) Cannot unify NoDest with &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965104"><span class="hs-identifier hs-var">valTy</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;. This might be caused by a main expression having a packed type.&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680964805"><span class="hs-identifier hs-var">ex0</span></a></span><span>
</span><span id="line-642"></span><span>
</span><span id="line-643"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-type">TimeIt</span></a></span><span> </span><span id="local-6989586621680965118"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965118"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680965119"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965119"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621680965120"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680965120"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-644"></span><span>        </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680965121"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965121"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965122"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965122"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965123"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965123"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965118"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-645"></span><span>           </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2 -&gt; Ty2 -&gt; Bool -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec -&gt; dec -&gt; Bool -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-var">TimeIt</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965121"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965122"><span class="hs-identifier hs-var">ty'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680965120"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965122"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965123"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-646"></span><span>
</span><span id="line-647"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-type">WithArenaE</span></a></span><span> </span><span id="local-6989586621680965125"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965125"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680965126"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965126"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-648"></span><span>        </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680965127"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965127"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965128"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965128"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965129"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965129"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965125"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#ArenaTy"><span class="hs-identifier hs-var">ArenaTy</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965126"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-649"></span><span>           </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-var">WithArenaE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965125"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965127"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965128"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965129"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-650"></span><span>
</span><span id="line-651"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-type">DataConE</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span id="local-6989586621680965132"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965132"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-652"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-653"></span><span>          </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TiM Result) -&gt; String -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected single location destination for DataConE&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680964805"><span class="hs-identifier hs-var">ex0</span></a></span><span>
</span><span id="line-654"></span><span>          </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TupleDest"><span class="hs-identifier hs-type">TupleDest</span></a></span><span> </span><span id="local-6989586621680965133"><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680965133"><span class="hs-identifier hs-var">_ds</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TiM Result) -&gt; String -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected single location destination for DataConE&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680964805"><span class="hs-identifier hs-var">ex0</span></a></span><span>
</span><span id="line-655"></span><span>          </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#SingleDest"><span class="hs-identifier hs-type">SingleDest</span></a></span><span> </span><span id="local-6989586621680965134"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965134"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-656"></span><span>              </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680965135"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965135"><span class="hs-identifier hs-var">fakeLoc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#fresh"><span class="hs-identifier hs-var">fresh</span></a></span><span>
</span><span id="line-657"></span><span>                 </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965136"><span class="annot"><span class="annottext">constrs :: [Constraint]
</span><a href="#local-6989586621680965136"><span class="hs-identifier hs-var hs-var">constrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Constraint
</span><a href="Gibbon.Passes.InferLocations.html#AfterTagL"><span class="hs-identifier hs-var">AfterTagL</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965135"><span class="hs-identifier hs-var">fakeLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965134"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-658"></span><span>                 </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; String -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
loc -&gt; String -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-var">DataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965134"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965132"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Var -&gt; Ty2
forall loc. String -&gt; loc -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-var">PackedTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDefs Ty2 -&gt; ShowS
forall a. Out a =&gt; DDefs a -&gt; ShowS
</span><a href="Gibbon.Language.Syntax.html#getTyOfDataCon"><span class="hs-identifier hs-var">getTyOfDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs Ty2
</span><a href="#local-6989586621680964804"><span class="hs-identifier hs-var">dataDefs</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965132"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965134"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965136"><span class="hs-identifier hs-var">constrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-659"></span><span>
</span><span id="line-660"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-type">DataConE</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span id="local-6989586621680965138"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965138"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680965139"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965139"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-661"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-662"></span><span>        </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-663"></span><span>          </span><span class="hs-comment">-- CSK: Should this really be an error ?</span><span>
</span><span id="line-664"></span><span>          </span><span id="local-6989586621680965140"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965140"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Var -&gt; TiM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Var -&gt; TiM Var)
-&gt; StateT InferState PassM Var -&gt; TiM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Var -&gt; StateT InferState PassM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Var -&gt; StateT InferState PassM Var)
-&gt; PassM Var -&gt; StateT InferState PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; PassM Var
</span><a href="Gibbon.Passes.InferLocations.html#freshLocVar"><span class="hs-identifier hs-var">freshLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;datacon&quot;</span></span><span>
</span><span id="line-665"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965141"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965141"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965142"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965142"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965143"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965143"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; String -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
loc -&gt; String -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-var">DataConE</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965138"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965139"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Dest
</span><a href="Gibbon.Passes.InferLocations.html#SingleDest"><span class="hs-identifier hs-var">SingleDest</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965140"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-666"></span><span>          </span><span id="local-6989586621680965144"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965144"><span class="hs-identifier hs-var">fcs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964832"><span class="hs-identifier hs-var">tryInRegion</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965143"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-667"></span><span>          </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
</span><a href="#local-6989586621680964807"><span class="hs-identifier hs-var">tryBindReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965141"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965142"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965144"><span class="hs-identifier hs-var">fcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-668"></span><span>        </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TupleDest"><span class="hs-identifier hs-type">TupleDest</span></a></span><span> </span><span id="local-6989586621680965145"><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680965145"><span class="hs-identifier hs-var">_ds</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TiM Result) -&gt; String -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected single location destination for DataConE&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680964805"><span class="hs-identifier hs-var">ex0</span></a></span><span>
</span><span id="line-669"></span><span>        </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#SingleDest"><span class="hs-identifier hs-type">SingleDest</span></a></span><span> </span><span id="local-6989586621680965146"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965146"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-670"></span><span>                  </span><span id="local-6989586621680965147"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965147"><span class="hs-identifier hs-var">locs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TiM Var] -&gt; ExceptT Failure (StateT InferState PassM) [Var]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
forall (m :: * -&gt; *) a. Monad m =&gt; [m a] -&gt; m [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#sequence"><span class="hs-identifier hs-var">sequence</span></a></span><span> </span><span class="annot"><span class="annottext">([TiM Var] -&gt; ExceptT Failure (StateT InferState PassM) [Var])
-&gt; [TiM Var] -&gt; ExceptT Failure (StateT InferState PassM) [Var]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; TiM Var -&gt; [TiM Var]
forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Exp1] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965139"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#fresh"><span class="hs-identifier hs-var">fresh</span></a></span><span>
</span><span id="line-671"></span><span>                  </span><span class="annot"><span class="annottext">(Var -&gt; TiM UnifyLoc)
-&gt; [Var] -&gt; ExceptT Failure (StateT InferState PassM) ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM UnifyLoc
</span><a href="Gibbon.Passes.InferLocations.html#fixLoc"><span class="hs-identifier hs-var">fixLoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965147"><span class="hs-identifier hs-var">locs</span></a></span><span> </span><span class="hs-comment">-- Don't allow argument locations to freely unify</span><span>
</span><span id="line-672"></span><span>                  </span><span id="local-6989586621680965151"><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965151"><span class="hs-identifier hs-var">ls'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((Exp1, Var) -&gt; TiM Result)
-&gt; [(Exp1, Var)]
-&gt; ExceptT Failure (StateT InferState PassM) [Result]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680965152"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965152"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965153"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965153"><span class="hs-identifier hs-var">lv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965152"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">(Dest -&gt; TiM Result) -&gt; Dest -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Dest
</span><a href="Gibbon.Passes.InferLocations.html#SingleDest"><span class="hs-identifier hs-var">SingleDest</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965153"><span class="hs-identifier hs-var">lv</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Exp1, Var)]
 -&gt; ExceptT Failure (StateT InferState PassM) [Result])
-&gt; [(Exp1, Var)]
-&gt; ExceptT Failure (StateT InferState PassM) [Result]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1] -&gt; [Var] -&gt; [(Exp1, Var)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965139"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965147"><span class="hs-identifier hs-var">locs</span></a></span><span>
</span><span id="line-673"></span><span>                  </span><span class="hs-comment">-- let ls'' = L.map unNestLet ls'</span><span>
</span><span id="line-674"></span><span>                  </span><span class="hs-comment">--     bnds = catMaybes $ L.map pullBnds ls'</span><span>
</span><span id="line-675"></span><span>                  </span><span class="hs-comment">--     env' = addCopyVarToEnv ls' env</span><span>
</span><span id="line-676"></span><span>                  </span><span class="hs-comment">-- Arguments are either a fixed size or a variable</span><span>
</span><span id="line-677"></span><span>                  </span><span class="hs-comment">-- TODO: audit this!</span><span>
</span><span id="line-678"></span><span>                  </span><span id="local-6989586621680965154"><span class="annot"><span class="annottext">[DCArg]
</span><a href="#local-6989586621680965154"><span class="hs-identifier hs-var">argLs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Exp2]
-&gt; (Exp2 -&gt; ExceptT Failure (StateT InferState PassM) DCArg)
-&gt; ExceptT Failure (StateT InferState PassM) [DCArg]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#forM"><span class="hs-identifier hs-var">forM</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965155"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680965155"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965155"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965151"><span class="hs-identifier hs-var">ls'</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">((Exp2 -&gt; ExceptT Failure (StateT InferState PassM) DCArg)
 -&gt; ExceptT Failure (StateT InferState PassM) [DCArg])
-&gt; (Exp2 -&gt; ExceptT Failure (StateT InferState PassM) DCArg)
-&gt; ExceptT Failure (StateT InferState PassM) [DCArg]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680965156"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965156"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-679"></span><span>                           </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965156"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-680"></span><span>                             </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span id="local-6989586621680965157"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965157"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Var -&gt; FullEnv -&gt; Ty2
</span><a href="Gibbon.Passes.InferLocations.html#lookupVEnv"><span class="hs-identifier hs-var">lookupVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965157"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-681"></span><span>                                               </span><span class="annot"><span class="annottext">Ty2
</span><a href="Gibbon.Language.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg)
-&gt; DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; DCArg
</span><a href="Gibbon.Passes.InferLocations.html#ArgFixed"><span class="hs-identifier hs-var">ArgFixed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span>
</span><span id="line-682"></span><span>                                               </span><span class="annot"><span class="annottext">Ty2
</span><a href="Gibbon.Language.Syntax.html#IntTy"><span class="hs-identifier hs-var">IntTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg)
-&gt; DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; DCArg
</span><a href="Gibbon.Passes.InferLocations.html#ArgFixed"><span class="hs-identifier hs-var">ArgFixed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Int
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Maybe.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; Maybe Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UrTy Any -&gt; Maybe Int
forall a. UrTy a -&gt; Maybe Int
</span><a href="Gibbon.Language.html#sizeOfTy"><span class="hs-identifier hs-var">sizeOfTy</span></a></span><span> </span><span class="annot"><span class="annottext">UrTy Any
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#IntTy"><span class="hs-identifier hs-var">IntTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-683"></span><span>                                               </span><span class="annot"><span class="annottext">Ty2
</span><a href="Gibbon.Language.Syntax.html#FloatTy"><span class="hs-identifier hs-var">FloatTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg)
-&gt; DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; DCArg
</span><a href="Gibbon.Passes.InferLocations.html#ArgFixed"><span class="hs-identifier hs-var">ArgFixed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Int
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Maybe.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; Maybe Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UrTy Any -&gt; Maybe Int
forall a. UrTy a -&gt; Maybe Int
</span><a href="Gibbon.Language.html#sizeOfTy"><span class="hs-identifier hs-var">sizeOfTy</span></a></span><span> </span><span class="annot"><span class="annottext">UrTy Any
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#FloatTy"><span class="hs-identifier hs-var">FloatTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-684"></span><span>                                               </span><span class="annot"><span class="annottext">Ty2
</span><a href="Gibbon.Language.Syntax.html#SymTy"><span class="hs-identifier hs-var">SymTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg)
-&gt; DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; DCArg
</span><a href="Gibbon.Passes.InferLocations.html#ArgFixed"><span class="hs-identifier hs-var">ArgFixed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Int
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Maybe.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; Maybe Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UrTy Any -&gt; Maybe Int
forall a. UrTy a -&gt; Maybe Int
</span><a href="Gibbon.Language.html#sizeOfTy"><span class="hs-identifier hs-var">sizeOfTy</span></a></span><span> </span><span class="annot"><span class="annottext">UrTy Any
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#SymTy"><span class="hs-identifier hs-var">SymTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-685"></span><span>                                               </span><span class="annot"><span class="annottext">Ty2
</span><a href="Gibbon.Language.Syntax.html#BoolTy"><span class="hs-identifier hs-var">BoolTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg)
-&gt; DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; DCArg
</span><a href="Gibbon.Passes.InferLocations.html#ArgFixed"><span class="hs-identifier hs-var">ArgFixed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Int
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Maybe.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; Maybe Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UrTy Any -&gt; Maybe Int
forall a. UrTy a -&gt; Maybe Int
</span><a href="Gibbon.Language.html#sizeOfTy"><span class="hs-identifier hs-var">sizeOfTy</span></a></span><span> </span><span class="annot"><span class="annottext">UrTy Any
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#BoolTy"><span class="hs-identifier hs-var">BoolTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-686"></span><span>                                               </span><span class="annot"><span class="annottext">Ty2
</span><a href="Gibbon.Language.Syntax.html#CharTy"><span class="hs-identifier hs-var">CharTy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg)
-&gt; DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; DCArg
</span><a href="Gibbon.Passes.InferLocations.html#ArgFixed"><span class="hs-identifier hs-var">ArgFixed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Int
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Maybe.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; Maybe Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UrTy Any -&gt; Maybe Int
forall a. UrTy a -&gt; Maybe Int
</span><a href="Gibbon.Language.html#sizeOfTy"><span class="hs-identifier hs-var">sizeOfTy</span></a></span><span> </span><span class="annot"><span class="annottext">UrTy Any
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#CharTy"><span class="hs-identifier hs-var">CharTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-687"></span><span>                                               </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VectorTy"><span class="hs-identifier hs-type">VectorTy</span></a></span><span> </span><span id="local-6989586621680965163"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965163"><span class="hs-identifier hs-var">elt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg)
-&gt; DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; DCArg
</span><a href="Gibbon.Passes.InferLocations.html#ArgFixed"><span class="hs-identifier hs-var">ArgFixed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Int
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Maybe.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; Maybe Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Maybe Int
forall a. UrTy a -&gt; Maybe Int
</span><a href="Gibbon.Language.html#sizeOfTy"><span class="hs-identifier hs-var">sizeOfTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty2 -&gt; Ty2
forall loc. UrTy loc -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#VectorTy"><span class="hs-identifier hs-var">VectorTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965163"><span class="hs-identifier hs-var">elt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-688"></span><span>                                               </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ListTy"><span class="hs-identifier hs-type">ListTy</span></a></span><span> </span><span id="local-6989586621680965165"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965165"><span class="hs-identifier hs-var">elt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg)
-&gt; DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; DCArg
</span><a href="Gibbon.Passes.InferLocations.html#ArgFixed"><span class="hs-identifier hs-var">ArgFixed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Int
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Maybe.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; Maybe Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Maybe Int
forall a. UrTy a -&gt; Maybe Int
</span><a href="Gibbon.Language.html#sizeOfTy"><span class="hs-identifier hs-var">sizeOfTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty2 -&gt; Ty2
forall loc. UrTy loc -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#ListTy"><span class="hs-identifier hs-var">ListTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965165"><span class="hs-identifier hs-var">elt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-689"></span><span>                                               </span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg)
-&gt; DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; DCArg
</span><a href="Gibbon.Passes.InferLocations.html#ArgVar"><span class="hs-identifier hs-var">ArgVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965157"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-690"></span><span>                             </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-type">LitE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg)
-&gt; DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; DCArg
</span><a href="Gibbon.Passes.InferLocations.html#ArgFixed"><span class="hs-identifier hs-var">ArgFixed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Int
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Maybe.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; Maybe Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UrTy Any -&gt; Maybe Int
forall a. UrTy a -&gt; Maybe Int
</span><a href="Gibbon.Language.html#sizeOfTy"><span class="hs-identifier hs-var">sizeOfTy</span></a></span><span> </span><span class="annot"><span class="annottext">UrTy Any
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#IntTy"><span class="hs-identifier hs-var">IntTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-691"></span><span>                             </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-type">FloatE</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg)
-&gt; DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; DCArg
</span><a href="Gibbon.Passes.InferLocations.html#ArgFixed"><span class="hs-identifier hs-var">ArgFixed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Int
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Maybe.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; Maybe Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UrTy Any -&gt; Maybe Int
forall a. UrTy a -&gt; Maybe Int
</span><a href="Gibbon.Language.html#sizeOfTy"><span class="hs-identifier hs-var">sizeOfTy</span></a></span><span> </span><span class="annot"><span class="annottext">UrTy Any
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#FloatTy"><span class="hs-identifier hs-var">FloatTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-692"></span><span>                             </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-type">LitSymE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg)
-&gt; DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; DCArg
</span><a href="Gibbon.Passes.InferLocations.html#ArgFixed"><span class="hs-identifier hs-var">ArgFixed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Int
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Maybe.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; Maybe Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UrTy Any -&gt; Maybe Int
forall a. UrTy a -&gt; Maybe Int
</span><a href="Gibbon.Language.html#sizeOfTy"><span class="hs-identifier hs-var">sizeOfTy</span></a></span><span> </span><span class="annot"><span class="annottext">UrTy Any
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#SymTy"><span class="hs-identifier hs-var">SymTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-693"></span><span>                             </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
</span><a href="Gibbon.Language.Syntax.html#MkTrue"><span class="hs-identifier hs-var">MkTrue</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg)
-&gt; DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; DCArg
</span><a href="Gibbon.Passes.InferLocations.html#ArgFixed"><span class="hs-identifier hs-var">ArgFixed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Int
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Maybe.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; Maybe Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UrTy Any -&gt; Maybe Int
forall a. UrTy a -&gt; Maybe Int
</span><a href="Gibbon.Language.html#sizeOfTy"><span class="hs-identifier hs-var">sizeOfTy</span></a></span><span> </span><span class="annot"><span class="annottext">UrTy Any
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#BoolTy"><span class="hs-identifier hs-var">BoolTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-694"></span><span>                             </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
</span><a href="Gibbon.Language.Syntax.html#MkFalse"><span class="hs-identifier hs-var">MkFalse</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg)
-&gt; DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; DCArg
</span><a href="Gibbon.Passes.InferLocations.html#ArgFixed"><span class="hs-identifier hs-var">ArgFixed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Int
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Maybe.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; Maybe Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UrTy Any -&gt; Maybe Int
forall a. UrTy a -&gt; Maybe Int
</span><a href="Gibbon.Language.html#sizeOfTy"><span class="hs-identifier hs-var">sizeOfTy</span></a></span><span> </span><span class="annot"><span class="annottext">UrTy Any
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#BoolTy"><span class="hs-identifier hs-var">BoolTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-695"></span><span>                             </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span id="local-6989586621680965169"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965169"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680965170"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965170"><span class="hs-identifier hs-var">lvs</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span id="local-6989586621680965171"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965171"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680965172"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965172"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Var -&gt; TiM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Var -&gt; TiM Var)
-&gt; StateT InferState PassM Var -&gt; TiM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Var -&gt; StateT InferState PassM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Var -&gt; StateT InferState PassM Var)
-&gt; PassM Var -&gt; StateT InferState PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; PassM Var
</span><a href="Gibbon.Passes.InferLocations.html#freshLocVar"><span class="hs-identifier hs-var">freshLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cpy&quot;</span></span><span>
</span><span id="line-696"></span><span>                                                           </span><span class="annot"><span class="annottext">DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg)
-&gt; DCArg -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Var -&gt; [Var] -&gt; DCArg
</span><a href="Gibbon.Passes.InferLocations.html#ArgCopy"><span class="hs-identifier hs-var">ArgCopy</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965171"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965172"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965169"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965170"><span class="hs-identifier hs-var">lvs</span></a></span><span>
</span><span id="line-697"></span><span>                             </span><span class="annot"><span class="annottext">Exp2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ExceptT Failure (StateT InferState PassM) DCArg)
-&gt; String -&gt; ExceptT Failure (StateT InferState PassM) DCArg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected argument to be trivial, got &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965156"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-698"></span><span>                  </span><span id="local-6989586621680965173"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965173"><span class="hs-identifier hs-var">newLocs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; TiM Var)
-&gt; [Var] -&gt; ExceptT Failure (StateT InferState PassM) [Var]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965147"><span class="hs-identifier hs-var">locs</span></a></span><span>
</span><span id="line-699"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621680965174"><span class="hs-identifier hs-type">afterVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#DCArg"><span class="hs-identifier hs-type">DCArg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span>
</span><span id="line-700"></span><span>                      </span><span id="local-6989586621680965174"><span class="annot"><span class="annottext">afterVar :: (DCArg, Maybe Var, Maybe Var) -&gt; Maybe Constraint
</span><a href="#local-6989586621680965174"><span class="hs-identifier hs-var hs-var">afterVar</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#ArgVar"><span class="hs-identifier hs-type">ArgVar</span></a></span><span> </span><span id="local-6989586621680965175"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965175"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680965176"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965176"><span class="hs-identifier hs-var">loc1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680965177"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965177"><span class="hs-identifier hs-var">loc2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-701"></span><span>                          </span><span class="annot"><span class="annottext">Constraint -&gt; Maybe Constraint
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(Constraint -&gt; Maybe Constraint) -&gt; Constraint -&gt; Maybe Constraint
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Var -&gt; Constraint
</span><a href="Gibbon.Passes.InferLocations.html#AfterVariableL"><span class="hs-identifier hs-var">AfterVariableL</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965176"><span class="hs-identifier hs-var">loc1</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965175"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965177"><span class="hs-identifier hs-var">loc2</span></a></span><span>
</span><span id="line-702"></span><span>                      </span><span class="annot"><a href="#local-6989586621680965174"><span class="hs-identifier hs-var">afterVar</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#ArgFixed"><span class="hs-identifier hs-type">ArgFixed</span></a></span><span> </span><span id="local-6989586621680965178"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965178"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680965179"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965179"><span class="hs-identifier hs-var">loc1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680965180"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965180"><span class="hs-identifier hs-var">loc2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-703"></span><span>                          </span><span class="annot"><span class="annottext">Constraint -&gt; Maybe Constraint
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(Constraint -&gt; Maybe Constraint) -&gt; Constraint -&gt; Maybe Constraint
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Int -&gt; Var -&gt; Constraint
</span><a href="Gibbon.Passes.InferLocations.html#AfterConstantL"><span class="hs-identifier hs-var">AfterConstantL</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965179"><span class="hs-identifier hs-var">loc1</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965178"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965180"><span class="hs-identifier hs-var">loc2</span></a></span><span>
</span><span id="line-704"></span><span>                      </span><span class="annot"><a href="#local-6989586621680965174"><span class="hs-identifier hs-var">afterVar</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#ArgCopy"><span class="hs-identifier hs-type">ArgCopy</span></a></span><span> </span><span id="local-6989586621680965181"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965181"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680965182"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965182"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span id="local-6989586621680965183"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965183"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680965184"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965184"><span class="hs-identifier hs-var">lvs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680965185"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965185"><span class="hs-identifier hs-var">loc1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680965186"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965186"><span class="hs-identifier hs-var">loc2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-705"></span><span>                          </span><span class="annot"><span class="annottext">Constraint -&gt; Maybe Constraint
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(Constraint -&gt; Maybe Constraint) -&gt; Constraint -&gt; Maybe Constraint
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Var -&gt; Var -&gt; Var -&gt; [Var] -&gt; Constraint
</span><a href="Gibbon.Passes.InferLocations.html#AfterCopyL"><span class="hs-identifier hs-var">AfterCopyL</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965185"><span class="hs-identifier hs-var">loc1</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965181"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965182"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965186"><span class="hs-identifier hs-var">loc2</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965183"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965184"><span class="hs-identifier hs-var">lvs</span></a></span><span>
</span><span id="line-706"></span><span>                      </span><span class="annot"><a href="#local-6989586621680965174"><span class="hs-identifier hs-var">afterVar</span></a></span><span> </span><span class="annot"><span class="annottext">(DCArg, Maybe Var, Maybe Var)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Constraint
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-707"></span><span>                      </span><span id="local-6989586621680965187"><span class="annot"><span class="annottext">constrs :: [Constraint]
</span><a href="#local-6989586621680965187"><span class="hs-identifier hs-var hs-var">constrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Constraint]] -&gt; [Constraint]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">([[Constraint]] -&gt; [Constraint]) -&gt; [[Constraint]] -&gt; [Constraint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965188"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680965188"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965188"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965151"><span class="hs-identifier hs-var">ls'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-708"></span><span>                      </span><span id="local-6989586621680965189"><span class="annot"><span class="annottext">constrs' :: [Constraint]
</span><a href="#local-6989586621680965189"><span class="hs-identifier hs-var hs-var">constrs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965147"><span class="hs-identifier hs-var">locs</span></a></span><span>
</span><span id="line-709"></span><span>                                 </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965187"><span class="hs-identifier hs-var">constrs</span></a></span><span>
</span><span id="line-710"></span><span>                                 </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965191"><span class="annot"><span class="annottext">tmpconstrs :: [Constraint]
</span><a href="#local-6989586621680965191"><span class="hs-identifier hs-var hs-var">tmpconstrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Constraint
</span><a href="Gibbon.Passes.InferLocations.html#AfterTagL"><span class="hs-identifier hs-var">AfterTagL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; Var
forall a. HasCallStack =&gt; [a] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#head"><span class="hs-identifier hs-var">L.head</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965147"><span class="hs-identifier hs-var">locs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965146"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint] -&gt; [Constraint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-711"></span><span>                                                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((DCArg, Maybe Var, Maybe Var) -&gt; Maybe Constraint)
-&gt; [(DCArg, Maybe Var, Maybe Var)] -&gt; [Constraint]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Maybe.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">(DCArg, Maybe Var, Maybe Var) -&gt; Maybe Constraint
</span><a href="#local-6989586621680965174"><span class="hs-identifier hs-var">afterVar</span></a></span><span> </span><span class="annot"><span class="annottext">([(DCArg, Maybe Var, Maybe Var)] -&gt; [Constraint])
-&gt; [(DCArg, Maybe Var, Maybe Var)] -&gt; [Constraint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[DCArg]
-&gt; [Maybe Var] -&gt; [Maybe Var] -&gt; [(DCArg, Maybe Var, Maybe Var)]
forall a b c. [a] -&gt; [b] -&gt; [c] -&gt; [(a, b, c)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip3"><span class="hs-identifier hs-var">zip3</span></a></span><span>
</span><span id="line-712"></span><span>                                                         </span><span class="hs-comment">-- ((map Just $ L.tail ([a | (a,_,_) &lt;- ls' ])) ++ [Nothing])</span><span>
</span><span id="line-713"></span><span>                                                        </span><span class="annot"><span class="annottext">[DCArg]
</span><a href="#local-6989586621680965154"><span class="hs-identifier hs-var">argLs</span></a></span><span>
</span><span id="line-714"></span><span>                                                         </span><span class="hs-comment">-- (map Just locs)</span><span>
</span><span id="line-715"></span><span>                                                        </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var -&gt; Maybe Var) -&gt; [Var] -&gt; [Maybe Var]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Maybe Var
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">([Var] -&gt; [Maybe Var]) -&gt; [Var] -&gt; [Maybe Var]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Var]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#tail"><span class="hs-identifier hs-var">L.tail</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965147"><span class="hs-identifier hs-var">locs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Maybe Var] -&gt; [Maybe Var] -&gt; [Maybe Var]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe Var
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-716"></span><span>                                                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var -&gt; Maybe Var) -&gt; [Var] -&gt; [Maybe Var]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Maybe Var
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965147"><span class="hs-identifier hs-var">locs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-717"></span><span>                                                         </span><span class="hs-comment">-- ((map Just $ L.tail locs) ++ [Nothing])) ++</span><span>
</span><span id="line-718"></span><span>                                      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965191"><span class="hs-identifier hs-var">tmpconstrs</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint] -&gt; [Constraint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965187"><span class="hs-identifier hs-var">constrs</span></a></span><span>
</span><span id="line-719"></span><span>                  </span><span class="hs-comment">-- traceShow k $ traceShow locs $</span><span>
</span><span id="line-720"></span><span>                  </span><span class="hs-comment">--let newe = buildLets bnds $ DataConE d k [ e' | (e',_,_)  &lt;- ls'']</span><span>
</span><span id="line-721"></span><span>                  </span><span id="local-6989586621680965196"><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965196"><span class="hs-identifier hs-var">ls''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(DCArg, Result)]
-&gt; ((DCArg, Result) -&gt; TiM Result)
-&gt; ExceptT Failure (StateT InferState PassM) [Result]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#forM"><span class="hs-identifier hs-var">forM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[DCArg] -&gt; [Result] -&gt; [(DCArg, Result)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[DCArg]
</span><a href="#local-6989586621680965154"><span class="hs-identifier hs-var">argLs</span></a></span><span> </span><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965151"><span class="hs-identifier hs-var">ls'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((DCArg, Result) -&gt; TiM Result)
 -&gt; ExceptT Failure (StateT InferState PassM) [Result])
-&gt; ((DCArg, Result) -&gt; TiM Result)
-&gt; ExceptT Failure (StateT InferState PassM) [Result]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680965197"><span class="annot"><span class="annottext">DCArg
</span><a href="#local-6989586621680965197"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621680965198"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965198"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965199"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965199"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965200"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965200"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-722"></span><span>                            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965198"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-723"></span><span>                              </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DCArg
</span><a href="#local-6989586621680965197"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-724"></span><span>                                                    </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#ArgCopy"><span class="hs-identifier hs-type">ArgCopy</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680965201"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965201"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965201"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965199"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965200"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-725"></span><span>                                                    </span><span class="annot"><span class="annottext">DCArg
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TiM Result
forall a. HasCallStack =&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#undefined"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-726"></span><span>                              </span><span class="annot"><span class="annottext">Exp2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965198"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965199"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965200"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-727"></span><span>                  </span><span class="hs-comment">-- bod &lt;- return $ DataConE d k [ e' | (e',_,_)  &lt;- ls'']</span><span>
</span><span id="line-728"></span><span>                  </span><span id="local-6989586621680965203"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965203"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Exp1] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965139"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2 -&gt; Bool
</span><a href="Gibbon.Passes.InferLocations.html#isCpyCall"><span class="hs-identifier hs-var">isCpyCall</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; Bool) -&gt; Exp2 -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2] -&gt; Exp2
forall a. HasCallStack =&gt; [a] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#last"><span class="hs-identifier hs-var">last</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965207"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680965207"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965207"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965151"><span class="hs-identifier hs-var">ls'</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-729"></span><span>                         </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Exp2] -&gt; Exp2
forall a. HasCallStack =&gt; [a] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#last"><span class="hs-identifier hs-var">last</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965208"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680965208"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965208"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965151"><span class="hs-identifier hs-var">ls'</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-730"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span id="local-6989586621680965209"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965209"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680965210"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965210"><span class="hs-identifier hs-var">lvs</span></a></span></span><span> </span><span id="local-6989586621680965211"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965211"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-731"></span><span>                                    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#ArgCopy"><span class="hs-identifier hs-type">ArgCopy</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680965212"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965212"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680965213"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965213"><span class="hs-identifier hs-var">copy_locs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DCArg] -&gt; DCArg
forall a. HasCallStack =&gt; [a] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#last"><span class="hs-identifier hs-var">last</span></a></span><span> </span><span class="annot"><span class="annottext">[DCArg]
</span><a href="#local-6989586621680965154"><span class="hs-identifier hs-var">argLs</span></a></span><span>
</span><span id="line-732"></span><span>                                        </span><span id="local-6989586621680965214"><span class="annot"><span class="annottext">arrty :: Ty2
</span><a href="#local-6989586621680965214"><span class="hs-identifier hs-var hs-var">arrty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArrowTy2 Ty2 -&gt; Ty2
forall ty2. ArrowTy2 ty2 -&gt; ty2
</span><a href="Gibbon.L2.Syntax.html#arrOut"><span class="hs-identifier hs-var">arrOut</span></a></span><span> </span><span class="annot"><span class="annottext">(ArrowTy2 Ty2 -&gt; Ty2) -&gt; ArrowTy2 Ty2 -&gt; Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; FullEnv -&gt; ArrowTy2 Ty2
</span><a href="Gibbon.Passes.InferLocations.html#lookupFEnv"><span class="hs-identifier hs-var">lookupFEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965209"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-733"></span><span>                                        </span><span class="hs-comment">-- Substitute the location occurring at the call site</span><span>
</span><span id="line-734"></span><span>                                        </span><span class="hs-comment">-- in place of the one in the function's return type</span><span>
</span><span id="line-735"></span><span>                                        </span><span class="hs-comment">-- re:last because we want the output location.</span><span>
</span><span id="line-736"></span><span>                                        </span><span id="local-6989586621680965215"><span class="annot"><span class="annottext">copyRetTy :: Ty2
</span><a href="#local-6989586621680965215"><span class="hs-identifier hs-var hs-var">copyRetTy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965214"><span class="hs-identifier hs-var">arrty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-737"></span><span>                                          </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680965216"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965216"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map Var Var -&gt; Ty2 -&gt; Ty2
</span><a href="Gibbon.L2.Syntax.html#substLoc"><span class="hs-identifier hs-var">substLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Map Var Var
forall k a. k -&gt; a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#singleton"><span class="hs-identifier hs-var">M.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965216"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; Var
forall a. HasCallStack =&gt; [a] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#last"><span class="hs-identifier hs-var">last</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965213"><span class="hs-identifier hs-var">copy_locs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965214"><span class="hs-identifier hs-var">arrty</span></a></span><span>
</span><span id="line-738"></span><span>                                          </span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Ty2
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;inferExp: Not a packed type&quot;</span></span><span>
</span><span id="line-739"></span><span>                                    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2) -&gt; Exp2 -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965212"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965215"><span class="hs-identifier hs-var">copyRetTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965209"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965210"><span class="hs-identifier hs-var">lvs</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965211"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; Exp2) -&gt; Exp2 -&gt; Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-740"></span><span>                                       </span><span class="annot"><span class="annottext">Var -&gt; String -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
loc -&gt; String -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-var">DataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965146"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965138"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965217"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680965217"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965217"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965196"><span class="hs-identifier hs-var">ls''</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-741"></span><span>                                </span><span class="annot"><span class="annottext">Exp2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Exp2
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;inferExp: Unexpected pattern &lt;error1&gt;&quot;</span></span><span>
</span><span id="line-742"></span><span>                         </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2) -&gt; Exp2 -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; String -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
loc -&gt; String -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-var">DataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965146"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965138"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965218"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680965218"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965218"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965196"><span class="hs-identifier hs-var">ls''</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-743"></span><span>                  </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965203"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Var -&gt; Ty2
forall loc. String -&gt; loc -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-var">PackedTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDefs Ty2 -&gt; ShowS
forall a. Out a =&gt; DDefs a -&gt; ShowS
</span><a href="Gibbon.Language.Syntax.html#getTyOfDataCon"><span class="hs-identifier hs-var">getTyOfDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs Ty2
</span><a href="#local-6989586621680964804"><span class="hs-identifier hs-var">dataDefs</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965138"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965146"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965189"><span class="hs-identifier hs-var">constrs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-744"></span><span>
</span><span id="line-745"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-type">IfE</span></a></span><span> </span><span id="local-6989586621680965220"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965220"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680965221"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965221"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680965222"><span class="annot"><span class="annottext">c :: Exp1
</span><a href="#local-6989586621680965222"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-glyph">@</span><span id="local-6989586621680965223"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965223"><span class="hs-identifier hs-var">ce</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-746"></span><span>       </span><span class="hs-comment">-- Here we blithely assume BoolTy because L1 typechecking has already passed:</span><span>
</span><span id="line-747"></span><span>       </span><span class="hs-special">(</span><span id="local-6989586621680965224"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965224"><span class="hs-identifier hs-var">a'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965225"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965225"><span class="hs-identifier hs-var">bty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965226"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965226"><span class="hs-identifier hs-var">acs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965220"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span>
</span><span id="line-748"></span><span>       </span><span class="annot"><span class="annottext">Ty2 -&gt; Ty2 -&gt; ExceptT Failure (StateT InferState PassM) ()
forall a.
(Eq a, Show a) =&gt;
a -&gt; a -&gt; ExceptT Failure (StateT InferState PassM) ()
</span><a href="Gibbon.Passes.InferLocations.html#assumeEq"><span class="hs-identifier hs-var">assumeEq</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965225"><span class="hs-identifier hs-var">bty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#BoolTy"><span class="hs-identifier hs-var">BoolTy</span></a></span><span>
</span><span id="line-749"></span><span>       </span><span class="hs-comment">-- Here BOTH branches are unified into the destination, so</span><span>
</span><span id="line-750"></span><span>       </span><span class="hs-comment">-- there is no need to unify with eachother.</span><span>
</span><span id="line-751"></span><span>       </span><span id="local-6989586621680965228"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680965228"><span class="hs-identifier hs-var">res</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965221"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-752"></span><span>       </span><span class="hs-comment">-- bind variables after if branch</span><span>
</span><span id="line-753"></span><span>       </span><span class="hs-comment">-- This ensures that the location bindings are not freely floated up to the upper level expressions</span><span>
</span><span id="line-754"></span><span>       </span><span class="hs-special">(</span><span id="local-6989586621680965229"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965229"><span class="hs-identifier hs-var">b'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965230"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965230"><span class="hs-identifier hs-var">tyb</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965231"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965231"><span class="hs-identifier hs-var">csb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>   </span><span class="annot"><span class="annottext">[Var] -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964958"><span class="hs-identifier hs-var">bindAfterLocs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; [Var]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="Gibbon.Passes.InferLocations.html#removeDuplicates"><span class="hs-identifier hs-var">removeDuplicates</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp1 -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#orderOfVarsOutputDataConE"><span class="hs-identifier hs-var">orderOfVarsOutputDataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965221"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680965228"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-755"></span><span>
</span><span id="line-756"></span><span>       </span><span class="hs-comment">-- Else branch</span><span>
</span><span id="line-757"></span><span>       </span><span id="local-6989586621680965233"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680965233"><span class="hs-identifier hs-var">res'</span></a></span></span><span>    </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965222"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-758"></span><span>       </span><span class="hs-comment">-- bind variables after else branch</span><span>
</span><span id="line-759"></span><span>       </span><span class="hs-comment">-- This ensures that the location bindings are not freely floated up to the upper level expressions</span><span>
</span><span id="line-760"></span><span>       </span><span class="hs-special">(</span><span id="local-6989586621680965234"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965234"><span class="hs-identifier hs-var">c'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965235"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965235"><span class="hs-identifier hs-var">tyc</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965236"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965236"><span class="hs-identifier hs-var">csc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>   </span><span class="annot"><span class="annottext">[Var] -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964958"><span class="hs-identifier hs-var">bindAfterLocs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; [Var]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="Gibbon.Passes.InferLocations.html#removeDuplicates"><span class="hs-identifier hs-var">removeDuplicates</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp1 -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#orderOfVarsOutputDataConE"><span class="hs-identifier hs-var">orderOfVarsOutputDataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965222"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680965233"><span class="hs-identifier hs-var">res'</span></a></span><span>
</span><span id="line-761"></span><span>
</span><span id="line-762"></span><span>       </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2 -&gt; Exp2 -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-var">IfE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965224"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965229"><span class="hs-identifier hs-var">b'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965234"><span class="hs-identifier hs-var">c'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965235"><span class="hs-identifier hs-var">tyc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.OldList.html#nub"><span class="hs-identifier hs-var">L.nub</span></a></span><span> </span><span class="annot"><span class="annottext">([Constraint] -&gt; [Constraint]) -&gt; [Constraint] -&gt; [Constraint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965226"><span class="hs-identifier hs-var">acs</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint] -&gt; [Constraint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965231"><span class="hs-identifier hs-var">csb</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint] -&gt; [Constraint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965236"><span class="hs-identifier hs-var">csc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-763"></span><span>
</span><span id="line-764"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#DictInsertP"><span class="hs-identifier hs-type">DictInsertP</span></a></span><span> </span><span id="local-6989586621680965238"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965238"><span class="hs-identifier hs-var">dty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span id="local-6989586621680965239"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965239"><span class="hs-identifier hs-var">var</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621680965240"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965240"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965241"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965241"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965242"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965242"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-765"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-766"></span><span>        </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#SingleDest"><span class="hs-identifier hs-type">SingleDest</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot unify DictInsert with destination&quot;</span></span><span>
</span><span id="line-767"></span><span>        </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TupleDest"><span class="hs-identifier hs-type">TupleDest</span></a></span><span> </span><span class="annot"><span class="annottext">[Dest]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot unify DictInsert with destination&quot;</span></span><span>
</span><span id="line-768"></span><span>        </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680965243"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965243"><span class="hs-identifier hs-var">d'</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="Gibbon.Language.Syntax.html#SymDictTy"><span class="hs-identifier hs-type">SymDictTy</span></a></span><span> </span><span id="local-6989586621680965245"><span class="annot"><span class="annottext">Maybe Var
</span><a href="#local-6989586621680965245"><span class="hs-identifier hs-var">ar</span></a></span></span><span> </span><span id="local-6989586621680965246"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965246"><span class="hs-identifier hs-var">dty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965247"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965247"><span class="hs-identifier hs-var">_dcs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965240"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span>
</span><span id="line-769"></span><span>                     </span><span class="hs-special">(</span><span id="local-6989586621680965248"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965248"><span class="hs-identifier hs-var">k'</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680965249"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965249"><span class="hs-identifier hs-var">_kcs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965241"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span>
</span><span id="line-770"></span><span>                     </span><span id="local-6989586621680965250"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965250"><span class="hs-identifier hs-var">dty''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Ty2 -&gt; TiM Ty2
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Ty2 -&gt; TiM Ty2)
-&gt; StateT InferState PassM Ty2 -&gt; TiM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; StateT InferState PassM Ty2
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Ty2 -&gt; StateT InferState PassM Ty2)
-&gt; PassM Ty2 -&gt; StateT InferState PassM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965238"><span class="hs-identifier hs-var">dty</span></a></span><span>
</span><span id="line-771"></span><span>                     </span><span id="local-6989586621680965251"><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680965251"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Region
-&gt; ExceptT Failure (StateT InferState PassM) Region
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Region
 -&gt; ExceptT Failure (StateT InferState PassM) Region)
-&gt; StateT InferState PassM Region
-&gt; ExceptT Failure (StateT InferState PassM) Region
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Region -&gt; StateT InferState PassM Region
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Region -&gt; StateT InferState PassM Region)
-&gt; PassM Region -&gt; StateT InferState PassM Region
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Region
</span><a href="Gibbon.Passes.InferLocations.html#freshRegVar"><span class="hs-identifier hs-var">freshRegVar</span></a></span><span>
</span><span id="line-772"></span><span>                     </span><span id="local-6989586621680965252"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965252"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Var -&gt; TiM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Var -&gt; TiM Var)
-&gt; StateT InferState PassM Var -&gt; TiM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Var -&gt; StateT InferState PassM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Var -&gt; StateT InferState PassM Var)
-&gt; PassM Var -&gt; StateT InferState PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; PassM Var
</span><a href="Gibbon.Passes.InferLocations.html#freshLocVar"><span class="hs-identifier hs-var">freshLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ins&quot;</span></span><span>
</span><span id="line-773"></span><span>                     </span><span class="hs-comment">-- _ &lt;- fixLoc loc</span><span>
</span><span id="line-774"></span><span>                     </span><span class="hs-special">(</span><span id="local-6989586621680965253"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965253"><span class="hs-identifier hs-var">v'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965254"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965254"><span class="hs-identifier hs-var">vty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965255"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965255"><span class="hs-identifier hs-var">vcs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965242"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">(Dest -&gt; TiM Result) -&gt; Dest -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Dest
</span><a href="Gibbon.Passes.InferLocations.html#SingleDest"><span class="hs-identifier hs-var">SingleDest</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965252"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-775"></span><span>                     </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965256"><span class="annot"><span class="annottext">cs :: [Constraint]
</span><a href="#local-6989586621680965256"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965255"><span class="hs-identifier hs-var">vcs</span></a></span><span> </span><span class="hs-comment">-- (StartRegionL loc r) : vcs</span><span>
</span><span id="line-776"></span><span>                     </span><span id="local-6989586621680965257"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965257"><span class="hs-identifier hs-var">dummyDty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; TiM Ty2
forall (f :: * -&gt; *). Applicative f =&gt; Ty1 -&gt; f Ty2
</span><a href="Gibbon.L2.Syntax.html#dummyTyLocs"><span class="hs-identifier hs-var">dummyTyLocs</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965246"><span class="hs-identifier hs-var">dty'</span></a></span><span>
</span><span id="line-777"></span><span>                     </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prim Ty2 -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#DictInsertP"><span class="hs-identifier hs-var">DictInsertP</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965257"><span class="hs-identifier hs-var">dummyDty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965239"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965243"><span class="hs-identifier hs-var">d'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965248"><span class="hs-identifier hs-var">k'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965253"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Var -&gt; Ty1 -&gt; Ty2
forall loc. Maybe Var -&gt; Ty1 -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#SymDictTy"><span class="hs-identifier hs-var">SymDictTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Maybe Var
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965239"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Ty1 -&gt; Ty2) -&gt; Ty1 -&gt; Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Ty1
forall a. UrTy a -&gt; Ty1
</span><a href="Gibbon.Language.html#stripTyLocs"><span class="hs-identifier hs-var">stripTyLocs</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965250"><span class="hs-identifier hs-var">dty''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965256"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-778"></span><span>
</span><span id="line-779"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#DictLookupP"><span class="hs-identifier hs-type">DictLookupP</span></a></span><span> </span><span id="local-6989586621680965261"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965261"><span class="hs-identifier hs-var">dty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621680965262"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965262"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965263"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965263"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-780"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-781"></span><span>        </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#SingleDest"><span class="hs-identifier hs-type">SingleDest</span></a></span><span> </span><span id="local-6989586621680965264"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965264"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680965265"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965265"><span class="hs-identifier hs-var">d'</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="Gibbon.Language.Syntax.html#SymDictTy"><span class="hs-identifier hs-type">SymDictTy</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Var
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680965266"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965266"><span class="hs-identifier hs-var">_dty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965267"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965267"><span class="hs-identifier hs-var">_dcs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965262"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span>
</span><span id="line-782"></span><span>                             </span><span class="hs-special">(</span><span id="local-6989586621680965268"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965268"><span class="hs-identifier hs-var">k'</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680965269"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965269"><span class="hs-identifier hs-var">_kcs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965263"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span>
</span><span id="line-783"></span><span>                             </span><span id="local-6989586621680965270"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965270"><span class="hs-identifier hs-var">dty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Ty2 -&gt; TiM Ty2
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Ty2 -&gt; TiM Ty2)
-&gt; StateT InferState PassM Ty2 -&gt; TiM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; StateT InferState PassM Ty2
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Ty2 -&gt; StateT InferState PassM Ty2)
-&gt; PassM Ty2 -&gt; StateT InferState PassM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965261"><span class="hs-identifier hs-var">dty</span></a></span><span>
</span><span id="line-784"></span><span>                             </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965271"><span class="annot"><span class="annottext">loc' :: Var
</span><a href="#local-6989586621680965271"><span class="hs-identifier hs-var hs-var">loc'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Var
</span><a href="Gibbon.Passes.InferLocations.html#locOfTy"><span class="hs-identifier hs-var">locOfTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965270"><span class="hs-identifier hs-var">dty'</span></a></span><span>
</span><span id="line-785"></span><span>                             </span><span class="annot"><span class="annottext">UnifyLoc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM UnifyLoc
</span><a href="Gibbon.Passes.InferLocations.html#fixLoc"><span class="hs-identifier hs-var">fixLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965271"><span class="hs-identifier hs-var">loc'</span></a></span><span>
</span><span id="line-786"></span><span>                             </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965273"><span class="annot"><span class="annottext">e' :: Exp2
</span><a href="#local-6989586621680965273"><span class="hs-identifier hs-var hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#DictLookupP"><span class="hs-identifier hs-var">DictLookupP</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965270"><span class="hs-identifier hs-var">dty'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965265"><span class="hs-identifier hs-var">d'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965268"><span class="hs-identifier hs-var">k'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-787"></span><span>                                 </span><span id="local-6989586621680965274"><span class="annot"><span class="annottext">cs :: [Constraint]
</span><a href="#local-6989586621680965274"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Constraint
</span><a href="Gibbon.Passes.InferLocations.html#FreeL"><span class="hs-identifier hs-var">FreeL</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965271"><span class="hs-identifier hs-var">loc'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-788"></span><span>                             </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; TiM Result -&gt; TiM Result -&gt; TiM Result
forall a. Var -&gt; Var -&gt; TiM a -&gt; TiM a -&gt; TiM a
</span><a href="Gibbon.Passes.InferLocations.html#unify"><span class="hs-identifier hs-var">unify</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965264"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965271"><span class="hs-identifier hs-var">loc'</span></a></span><span>
</span><span id="line-789"></span><span>                                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965273"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965270"><span class="hs-identifier hs-var">dty'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965274"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-790"></span><span>                                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; Var -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#copy"><span class="hs-identifier hs-var">copy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965273"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965270"><span class="hs-identifier hs-var">dty'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965274"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965264"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-791"></span><span>        </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TupleDest"><span class="hs-identifier hs-type">TupleDest</span></a></span><span> </span><span class="annot"><span class="annottext">[Dest]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot unify DictLookup with tuple destination&quot;</span></span><span>
</span><span id="line-792"></span><span>        </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot unify DictLookup with no destination&quot;</span></span><span>
</span><span id="line-793"></span><span>
</span><span id="line-794"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#DictEmptyP"><span class="hs-identifier hs-type">DictEmptyP</span></a></span><span> </span><span id="local-6989586621680965276"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965276"><span class="hs-identifier hs-var">dty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span id="local-6989586621680965277"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965277"><span class="hs-identifier hs-var">var</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-795"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-796"></span><span>        </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#SingleDest"><span class="hs-identifier hs-type">SingleDest</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot unify DictEmpty with destination&quot;</span></span><span>
</span><span id="line-797"></span><span>        </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TupleDest"><span class="hs-identifier hs-type">TupleDest</span></a></span><span> </span><span class="annot"><span class="annottext">[Dest]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot unify DictEmpty with destination&quot;</span></span><span>
</span><span id="line-798"></span><span>        </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680965278"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965278"><span class="hs-identifier hs-var">dty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Ty2 -&gt; TiM Ty2
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Ty2 -&gt; TiM Ty2)
-&gt; StateT InferState PassM Ty2 -&gt; TiM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; StateT InferState PassM Ty2
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Ty2 -&gt; StateT InferState PassM Ty2)
-&gt; PassM Ty2 -&gt; StateT InferState PassM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965276"><span class="hs-identifier hs-var">dty</span></a></span><span>
</span><span id="line-799"></span><span>                     </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prim Ty2 -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#DictEmptyP"><span class="hs-identifier hs-var">DictEmptyP</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965278"><span class="hs-identifier hs-var">dty'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965277"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Var -&gt; Ty1 -&gt; Ty2
forall loc. Maybe Var -&gt; Ty1 -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#SymDictTy"><span class="hs-identifier hs-var">SymDictTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Maybe Var
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965277"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Ty1 -&gt; Ty2) -&gt; Ty1 -&gt; Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Ty1
forall a. UrTy a -&gt; Ty1
</span><a href="Gibbon.Language.html#stripTyLocs"><span class="hs-identifier hs-var">stripTyLocs</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965278"><span class="hs-identifier hs-var">dty'</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-800"></span><span>
</span><span id="line-801"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#DictHasKeyP"><span class="hs-identifier hs-type">DictHasKeyP</span></a></span><span> </span><span id="local-6989586621680965280"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965280"><span class="hs-identifier hs-var">dty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span id="local-6989586621680965281"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965281"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965282"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965282"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-802"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-803"></span><span>        </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#SingleDest"><span class="hs-identifier hs-type">SingleDest</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot unify DictEmpty with destination&quot;</span></span><span>
</span><span id="line-804"></span><span>        </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TupleDest"><span class="hs-identifier hs-type">TupleDest</span></a></span><span> </span><span class="annot"><span class="annottext">[Dest]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot unify DictEmpty with destination&quot;</span></span><span>
</span><span id="line-805"></span><span>        </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680965283"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965283"><span class="hs-identifier hs-var">d'</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="Gibbon.Language.Syntax.html#SymDictTy"><span class="hs-identifier hs-type">SymDictTy</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Var
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680965284"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965284"><span class="hs-identifier hs-var">dty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965285"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965285"><span class="hs-identifier hs-var">_dcs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965281"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span>
</span><span id="line-806"></span><span>                     </span><span class="hs-special">(</span><span id="local-6989586621680965286"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965286"><span class="hs-identifier hs-var">k'</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680965287"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965287"><span class="hs-identifier hs-var">_kcs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965282"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span>
</span><span id="line-807"></span><span>                     </span><span id="local-6989586621680965288"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965288"><span class="hs-identifier hs-var">dummyDty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; TiM Ty2
forall (f :: * -&gt; *). Applicative f =&gt; Ty1 -&gt; f Ty2
</span><a href="Gibbon.L2.Syntax.html#dummyTyLocs"><span class="hs-identifier hs-var">dummyTyLocs</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965284"><span class="hs-identifier hs-var">dty'</span></a></span><span>
</span><span id="line-808"></span><span>                     </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prim Ty2 -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#DictHasKeyP"><span class="hs-identifier hs-var">DictHasKeyP</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965288"><span class="hs-identifier hs-var">dummyDty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965283"><span class="hs-identifier hs-var">d'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965286"><span class="hs-identifier hs-var">k'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#BoolTy"><span class="hs-identifier hs-var">BoolTy</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-809"></span><span>
</span><span id="line-810"></span><span>    </span><span class="hs-comment">-- Special case for VSortP because we don't want to lookup fp in</span><span>
</span><span id="line-811"></span><span>    </span><span class="hs-comment">-- the type environment.</span><span>
</span><span id="line-812"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span id="local-6989586621680965289"><span class="annot"><span class="annottext">pr :: Prim Ty1
</span><a href="#local-6989586621680965289"><span class="hs-identifier hs-var">pr</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#VSortP"><span class="hs-identifier hs-type">VSortP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span id="local-6989586621680965291"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965291"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span id="local-6989586621680965292"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965292"><span class="hs-identifier hs-var">fp</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-813"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-814"></span><span>        </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#SingleDest"><span class="hs-identifier hs-type">SingleDest</span></a></span><span> </span><span id="local-6989586621680965293"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965293"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TiM Result) -&gt; String -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot unify primop &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="#local-6989586621680965289"><span class="hs-identifier hs-var">pr</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; with destination &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965293"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-815"></span><span>        </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TupleDest"><span class="hs-identifier hs-type">TupleDest</span></a></span><span>  </span><span id="local-6989586621680965294"><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680965294"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TiM Result) -&gt; String -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot unify primop &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="#local-6989586621680965289"><span class="hs-identifier hs-var">pr</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; with destination &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Dest] -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680965294"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-816"></span><span>        </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680965295"><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965295"><span class="hs-identifier hs-var">results</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; TiM Result)
-&gt; [Exp1] -&gt; ExceptT Failure (StateT InferState PassM) [Result]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680965296"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965296"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965296"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965291"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-817"></span><span>                     </span><span class="hs-comment">-- Assume arguments to PrimAppE are trivial</span><span>
</span><span id="line-818"></span><span>                     </span><span class="hs-comment">-- so there's no need to deal with constraints or locations</span><span>
</span><span id="line-819"></span><span>                     </span><span id="local-6989586621680965297"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965297"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Ty2 -&gt; TiM Ty2
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Ty2 -&gt; TiM Ty2)
-&gt; StateT InferState PassM Ty2 -&gt; TiM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; StateT InferState PassM Ty2
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Ty2 -&gt; StateT InferState PassM Ty2)
-&gt; PassM Ty2 -&gt; StateT InferState PassM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">(Ty1 -&gt; PassM Ty2) -&gt; Ty1 -&gt; PassM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1 -&gt; Ty1
forall a. Prim (UrTy a) -&gt; UrTy a
</span><a href="Gibbon.Language.html#primRetTy"><span class="hs-identifier hs-var">primRetTy</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="#local-6989586621680965289"><span class="hs-identifier hs-var">pr</span></a></span><span>
</span><span id="line-820"></span><span>                     </span><span id="local-6989586621680965299"><span class="annot"><span class="annottext">Prim Ty2
</span><a href="#local-6989586621680965299"><span class="hs-identifier hs-var">pr'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM (Prim Ty2)
-&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM (Prim Ty2)
 -&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2))
-&gt; StateT InferState PassM (Prim Ty2)
-&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM (Prim Ty2) -&gt; StateT InferState PassM (Prim Ty2)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM (Prim Ty2) -&gt; StateT InferState PassM (Prim Ty2))
-&gt; PassM (Prim Ty2) -&gt; StateT InferState PassM (Prim Ty2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1 -&gt; PassM (Prim Ty2)
</span><a href="Gibbon.Passes.InferLocations.html#prim"><span class="hs-keyword hs-var">prim</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="#local-6989586621680965289"><span class="hs-identifier hs-var">pr</span></a></span><span>
</span><span id="line-821"></span><span>                     </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965300"><span class="annot"><span class="annottext">args :: [Exp2]
</span><a href="#local-6989586621680965300"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965301"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680965301"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965301"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965295"><span class="hs-identifier hs-var">results</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Exp2] -&gt; [Exp2] -&gt; [Exp2]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965292"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-822"></span><span>                     </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prim Ty2 -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
</span><a href="#local-6989586621680965299"><span class="hs-identifier hs-var">pr'</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965300"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965297"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-823"></span><span>
</span><span id="line-824"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span id="local-6989586621680965302"><span class="annot"><span class="annottext">Prim Ty1
</span><a href="#local-6989586621680965302"><span class="hs-identifier hs-var">pr</span></a></span></span><span> </span><span id="local-6989586621680965303"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965303"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-825"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-826"></span><span>        </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#SingleDest"><span class="hs-identifier hs-type">SingleDest</span></a></span><span> </span><span id="local-6989586621680965304"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965304"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TiM Result) -&gt; String -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot unify primop &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="#local-6989586621680965302"><span class="hs-identifier hs-var">pr</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; with destination &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Dest -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;in &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680964805"><span class="hs-identifier hs-var">ex0</span></a></span><span>
</span><span id="line-827"></span><span>        </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TupleDest"><span class="hs-identifier hs-type">TupleDest</span></a></span><span>  </span><span id="local-6989586621680965305"><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680965305"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-828"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="#local-6989586621680965302"><span class="hs-identifier hs-var">pr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-829"></span><span>            </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#PrintInt"><span class="hs-identifier hs-var">PrintInt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680964805"><span class="hs-identifier hs-var">ex0</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span>
</span><span id="line-830"></span><span>            </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#PrintFloat"><span class="hs-identifier hs-var">PrintFloat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680964805"><span class="hs-identifier hs-var">ex0</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span>
</span><span id="line-831"></span><span>            </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#PrintBool"><span class="hs-identifier hs-var">PrintBool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680964805"><span class="hs-identifier hs-var">ex0</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span>
</span><span id="line-832"></span><span>            </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#PrintSym"><span class="hs-identifier hs-var">PrintSym</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680964805"><span class="hs-identifier hs-var">ex0</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span>
</span><span id="line-833"></span><span>            </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VNthP"><span class="hs-identifier hs-type">VNthP</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680964805"><span class="hs-identifier hs-var">ex0</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span>
</span><span id="line-834"></span><span>            </span><span class="annot"><span class="annottext">Prim Ty1
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TiM Result) -&gt; String -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot unify primop &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="#local-6989586621680965302"><span class="hs-identifier hs-var">pr</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; with destination &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Dest -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;in &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680964805"><span class="hs-identifier hs-var">ex0</span></a></span><span>
</span><span id="line-835"></span><span>        </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680965311"><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965311"><span class="hs-identifier hs-var">results</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; TiM Result)
-&gt; [Exp1] -&gt; ExceptT Failure (StateT InferState PassM) [Result]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680965312"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965312"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965312"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965303"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-836"></span><span>                     </span><span class="hs-comment">-- Assume arguments to PrimAppE are trivial</span><span>
</span><span id="line-837"></span><span>                     </span><span class="hs-comment">-- so there's no need to deal with constraints or locations</span><span>
</span><span id="line-838"></span><span>                     </span><span id="local-6989586621680965313"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965313"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Ty2 -&gt; TiM Ty2
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Ty2 -&gt; TiM Ty2)
-&gt; StateT InferState PassM Ty2 -&gt; TiM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; StateT InferState PassM Ty2
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Ty2 -&gt; StateT InferState PassM Ty2)
-&gt; PassM Ty2 -&gt; StateT InferState PassM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">(Ty1 -&gt; PassM Ty2) -&gt; Ty1 -&gt; PassM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1 -&gt; Ty1
forall a. Prim (UrTy a) -&gt; UrTy a
</span><a href="Gibbon.Language.html#primRetTy"><span class="hs-identifier hs-var">primRetTy</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="#local-6989586621680965302"><span class="hs-identifier hs-var">pr</span></a></span><span>
</span><span id="line-839"></span><span>                     </span><span id="local-6989586621680965314"><span class="annot"><span class="annottext">Prim Ty2
</span><a href="#local-6989586621680965314"><span class="hs-identifier hs-var">pr'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM (Prim Ty2)
-&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM (Prim Ty2)
 -&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2))
-&gt; StateT InferState PassM (Prim Ty2)
-&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM (Prim Ty2) -&gt; StateT InferState PassM (Prim Ty2)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM (Prim Ty2) -&gt; StateT InferState PassM (Prim Ty2))
-&gt; PassM (Prim Ty2) -&gt; StateT InferState PassM (Prim Ty2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1 -&gt; PassM (Prim Ty2)
</span><a href="Gibbon.Passes.InferLocations.html#prim"><span class="hs-keyword hs-var">prim</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="#local-6989586621680965302"><span class="hs-identifier hs-var">pr</span></a></span><span>
</span><span id="line-840"></span><span>                     </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prim Ty2 -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
</span><a href="#local-6989586621680965314"><span class="hs-identifier hs-var">pr'</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965315"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680965315"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965315"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965311"><span class="hs-identifier hs-var">results</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965313"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-841"></span><span>
</span><span id="line-842"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-type">CaseE</span></a></span><span> </span><span id="local-6989586621680965317"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965317"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span id="local-6989586621680965318"><span class="annot"><span class="annottext">[(String, [(Var, ())], Exp1)]
</span><a href="#local-6989586621680965318"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-843"></span><span>      </span><span class="hs-comment">-- Case expressions introduce fresh destinations for the scrutinee:</span><span>
</span><span id="line-844"></span><span>      </span><span id="local-6989586621680965319"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965319"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Var -&gt; TiM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Var -&gt; TiM Var)
-&gt; StateT InferState PassM Var -&gt; TiM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Var -&gt; StateT InferState PassM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Var -&gt; StateT InferState PassM Var)
-&gt; PassM Var -&gt; StateT InferState PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; PassM Var
</span><a href="Gibbon.Passes.InferLocations.html#freshLocVar"><span class="hs-identifier hs-var">freshLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;scrut&quot;</span></span><span>
</span><span id="line-845"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621680965320"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965320"><span class="hs-identifier hs-var">ex'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965321"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965321"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965322"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965322"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965317"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Dest
</span><a href="Gibbon.Passes.InferLocations.html#SingleDest"><span class="hs-identifier hs-var">SingleDest</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965319"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-846"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965323"><span class="annot"><span class="annottext">src :: Var
</span><a href="#local-6989586621680965323"><span class="hs-identifier hs-var hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Var
</span><a href="Gibbon.Passes.InferLocations.html#locOfTy"><span class="hs-identifier hs-var">locOfTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965321"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-847"></span><span>      </span><span id="local-6989586621680965324"><span class="annot"><span class="annottext">[((String, [(Var, Var)], Exp2), Ty2, [Constraint])]
</span><a href="#local-6989586621680965324"><span class="hs-identifier hs-var">pairs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((String, [(Var, ())], Exp1)
 -&gt; TiM ((String, [(Var, Var)], Exp2), Ty2, [Constraint]))
-&gt; [(String, [(Var, ())], Exp1)]
-&gt; ExceptT
     Failure
     (StateT InferState PassM)
     [((String, [(Var, Var)], Exp2), Ty2, [Constraint])]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDefs Ty2
-&gt; FullEnv
-&gt; Var
-&gt; Dest
-&gt; (String, [(Var, ())], Exp1)
-&gt; TiM ((String, [(Var, Var)], Exp2), Ty2, [Constraint])
</span><a href="#local-6989586621680964997"><span class="hs-identifier hs-var">doCase</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs Ty2
</span><a href="#local-6989586621680964804"><span class="hs-identifier hs-var">dataDefs</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965323"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(String, [(Var, ())], Exp1)]
</span><a href="#local-6989586621680965318"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-848"></span><span>      </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2 -&gt; [(String, [(Var, Var)], Exp2)] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; [(String, [(Var, loc)], PreExp ext loc dec)]
-&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-var">CaseE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965320"><span class="hs-identifier hs-var">ex'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">(String, [(Var, Var)], Exp2)
</span><a href="#local-6989586621680965325"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680965325"><span class="annot"><span class="annottext">(String, [(Var, Var)], Exp2)
</span><a href="#local-6989586621680965325"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[((String, [(Var, Var)], Exp2), Ty2, [Constraint])]
</span><a href="#local-6989586621680965324"><span class="hs-identifier hs-var">pairs</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-849"></span><span>              </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String, [(Var, Var)], Exp2)
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680965326"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965326"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965326"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[((String, [(Var, Var)], Exp2), Ty2, [Constraint])]
-&gt; ((String, [(Var, Var)], Exp2), Ty2, [Constraint])
forall a. HasCallStack =&gt; [a] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#head"><span class="hs-identifier hs-var">L.head</span></a></span><span> </span><span class="annot"><span class="annottext">[((String, [(Var, Var)], Exp2), Ty2, [Constraint])]
</span><a href="#local-6989586621680965324"><span class="hs-identifier hs-var">pairs</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-850"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Constraint]] -&gt; [Constraint]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">([[Constraint]] -&gt; [Constraint]) -&gt; [[Constraint]] -&gt; [Constraint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965327"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String, [(Var, Var)], Exp2)
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680965327"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965327"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[((String, [(Var, Var)], Exp2), Ty2, [Constraint])]
</span><a href="#local-6989586621680965324"><span class="hs-identifier hs-var">pairs</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-851"></span><span>
</span><span id="line-852"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L1.Syntax.html#AddFixed"><span class="hs-identifier hs-type">L1.AddFixed</span></a></span><span> </span><span id="local-6989586621680965329"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965329"><span class="hs-identifier hs-var">cur</span></a></span></span><span> </span><span id="local-6989586621680965330"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965330"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">L2.Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Int -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; Int -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#AddFixed"><span class="hs-identifier hs-var">L2.AddFixed</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965329"><span class="hs-identifier hs-var">cur</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965330"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-853"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L1.Syntax.html#StartOfPkdCursor"><span class="hs-identifier hs-type">L1.StartOfPkdCursor</span></a></span><span> </span><span id="local-6989586621680965333"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965333"><span class="hs-identifier hs-var">cur</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TiM Result) -&gt; String -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unbound &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680964805"><span class="hs-identifier hs-var">ex0</span></a></span><span>
</span><span id="line-854"></span><span>
</span><span id="line-855"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680965334"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965335"><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680965335"><span class="hs-identifier hs-var">locs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965336"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965336"><span class="hs-identifier hs-var">bty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965337"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965337"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680965338"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965338"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680965335"><span class="hs-identifier hs-var">locs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-856"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965337"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-857"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span class="annot"><span class="annottext">(String -&gt; TiM Result) -&gt; String -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unexpected variable aliasing: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp1 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680964805"><span class="hs-identifier hs-var">ex0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-858"></span><span>
</span><span id="line-859"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span id="local-6989586621680965339"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965339"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621680965340"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965340"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-860"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965341"><span class="annot"><span class="annottext">arrty :: ArrowTy2 Ty2
</span><a href="#local-6989586621680965341"><span class="hs-identifier hs-var hs-var">arrty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; FullEnv -&gt; ArrowTy2 Ty2
</span><a href="Gibbon.Passes.InferLocations.html#lookupFEnv"><span class="hs-identifier hs-var">lookupFEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965339"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-861"></span><span>          </span><span id="local-6989586621680965342"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965342"><span class="hs-identifier hs-var">valTy</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; TiM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#freshTyLocs"><span class="hs-identifier hs-var">freshTyLocs</span></a></span><span> </span><span class="annot"><span class="annottext">(Ty2 -&gt; TiM Ty2) -&gt; Ty2 -&gt; TiM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy2 Ty2 -&gt; Ty2
forall ty2. ArrowTy2 ty2 -&gt; ty2
</span><a href="Gibbon.L2.Syntax.html#arrOut"><span class="hs-identifier hs-var">arrOut</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy2 Ty2
</span><a href="#local-6989586621680965341"><span class="hs-identifier hs-var">arrty</span></a></span><span>
</span><span id="line-862"></span><span>          </span><span class="hs-comment">-- /cc @vollmerm</span><span>
</span><span id="line-863"></span><span>          </span><span id="local-6989586621680965343"><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965343"><span class="hs-identifier hs-var">argTys</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Ty2 -&gt; TiM Ty2)
-&gt; [Ty2] -&gt; ExceptT Failure (StateT InferState PassM) [Ty2]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; TiM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#freshTyLocs"><span class="hs-identifier hs-var">freshTyLocs</span></a></span><span> </span><span class="annot"><span class="annottext">([Ty2] -&gt; ExceptT Failure (StateT InferState PassM) [Ty2])
-&gt; [Ty2] -&gt; ExceptT Failure (StateT InferState PassM) [Ty2]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy2 Ty2 -&gt; [Ty2]
forall ty2. ArrowTy2 ty2 -&gt; [ty2]
</span><a href="Gibbon.L2.Syntax.html#arrIns"><span class="hs-identifier hs-var">arrIns</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy2 Ty2
</span><a href="#local-6989586621680965341"><span class="hs-identifier hs-var">arrty</span></a></span><span>
</span><span id="line-864"></span><span>          </span><span id="local-6989586621680965344"><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680965344"><span class="hs-identifier hs-var">argDests</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Ty2 -&gt; TiM Dest)
-&gt; [Ty2] -&gt; ExceptT Failure (StateT InferState PassM) [Dest]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; TiM Dest
</span><a href="Gibbon.Passes.InferLocations.html#destFromType%27"><span class="hs-identifier hs-var">destFromType'</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965343"><span class="hs-identifier hs-var">argTys</span></a></span><span>
</span><span id="line-865"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965345"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965345"><span class="hs-identifier hs-var">args'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680965346"><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965346"><span class="hs-identifier hs-var">atys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680965347"><span class="annot"><span class="annottext">[[Constraint]]
</span><a href="#local-6989586621680965347"><span class="hs-identifier hs-var">acss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Result] -&gt; ([Exp2], [Ty2], [[Constraint]])
forall a b c. [(a, b, c)] -&gt; ([a], [b], [c])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip3"><span class="hs-identifier hs-var">L.unzip3</span></a></span><span> </span><span class="annot"><span class="annottext">([Result] -&gt; ([Exp2], [Ty2], [[Constraint]]))
-&gt; ExceptT Failure (StateT InferState PassM) [Result]
-&gt; ExceptT
     Failure (StateT InferState PassM) ([Exp2], [Ty2], [[Constraint]])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">((Exp1, Dest) -&gt; TiM Result)
-&gt; [(Exp1, Dest)]
-&gt; ExceptT Failure (StateT InferState PassM) [Result]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Exp1 -&gt; Dest -&gt; TiM Result) -&gt; (Exp1, Dest) -&gt; TiM Result
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#uncurry"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">((Exp1 -&gt; Dest -&gt; TiM Result) -&gt; (Exp1, Dest) -&gt; TiM Result)
-&gt; (Exp1 -&gt; Dest -&gt; TiM Result) -&gt; (Exp1, Dest) -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Exp1] -&gt; [Dest] -&gt; [(Exp1, Dest)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965340"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680965344"><span class="hs-identifier hs-var">argDests</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-866"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965348"><span class="annot"><span class="annottext">acs :: [Constraint]
</span><a href="#local-6989586621680965348"><span class="hs-identifier hs-var hs-var">acs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Constraint]] -&gt; [Constraint]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">[[Constraint]]
</span><a href="#local-6989586621680965347"><span class="hs-identifier hs-var">acss</span></a></span><span>
</span><span id="line-867"></span><span>          </span><span id="local-6989586621680965349"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965349"><span class="hs-identifier hs-var">tupBod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Exp1 -&gt; Exp1 -&gt; TiM Exp1
</span><a href="Gibbon.Passes.InferLocations.html#projTups"><span class="hs-identifier hs-var">projTups</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965342"><span class="hs-identifier hs-var">valTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965338"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-868"></span><span>          </span><span id="local-6989586621680965351"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680965351"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965342"><span class="hs-identifier hs-var">valTy</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965349"><span class="hs-identifier hs-var">tupBod</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-869"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965352"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965352"><span class="hs-identifier hs-var">bod''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965353"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965353"><span class="hs-identifier hs-var">ty''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965354"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965354"><span class="hs-identifier hs-var">cs''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964908"><span class="hs-identifier hs-var">handleTrailingBindLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680965351"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-870"></span><span>          </span><span id="local-6989586621680965355"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965355"><span class="hs-identifier hs-var">vcs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; Ty2 -&gt; [Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964854"><span class="hs-identifier hs-var">tryNeedRegion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty2 -&gt; [Var]
</span><a href="Gibbon.L2.Syntax.html#locsInTy"><span class="hs-identifier hs-var">locsInTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965342"><span class="hs-identifier hs-var">valTy</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965353"><span class="hs-identifier hs-var">ty''</span></a></span><span> </span><span class="annot"><span class="annottext">([Constraint] -&gt; TiM [Constraint])
-&gt; [Constraint] -&gt; TiM [Constraint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965348"><span class="hs-identifier hs-var">acs</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint] -&gt; [Constraint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965354"><span class="hs-identifier hs-var">cs''</span></a></span><span>
</span><span id="line-871"></span><span>          </span><span id="local-6989586621680965356"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965356"><span class="hs-identifier hs-var">fcs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964832"><span class="hs-identifier hs-var">tryInRegion</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965355"><span class="hs-identifier hs-var">vcs</span></a></span><span>
</span><span id="line-872"></span><span>          </span><span class="hs-comment">-- fcs &lt;- tryInRegion $ acs ++ cs''</span><span>
</span><span id="line-873"></span><span>          </span><span id="local-6989586621680965357"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680965357"><span class="hs-identifier hs-var">res'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
</span><a href="#local-6989586621680964807"><span class="hs-identifier hs-var">tryBindReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">L2.LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965342"><span class="hs-identifier hs-var">valTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">L2.AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965339"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Ty2 -&gt; [Var]) -&gt; [Ty2] -&gt; [Var]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; [Var]
</span><a href="Gibbon.L2.Syntax.html#locsInTy"><span class="hs-identifier hs-var">locsInTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965346"><span class="hs-identifier hs-var">atys</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [Var]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; [Var]
</span><a href="Gibbon.L2.Syntax.html#locsInTy"><span class="hs-identifier hs-var">locsInTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965342"><span class="hs-identifier hs-var">valTy</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965345"><span class="hs-identifier hs-var">args'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965352"><span class="hs-identifier hs-var">bod''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965353"><span class="hs-identifier hs-var">ty''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965356"><span class="hs-identifier hs-var">fcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-874"></span><span>          </span><span class="annot"><span class="annottext">[Var] -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964870"><span class="hs-identifier hs-var">bindImmediateDependentLocs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Ty2 -&gt; [Var]) -&gt; [Ty2] -&gt; [Var]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; [Var]
</span><a href="Gibbon.L2.Syntax.html#locsInTy"><span class="hs-identifier hs-var">locsInTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965346"><span class="hs-identifier hs-var">atys</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [Var]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; [Var]
</span><a href="Gibbon.L2.Syntax.html#locsInTy"><span class="hs-identifier hs-var">locsInTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965342"><span class="hs-identifier hs-var">valTy</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680965357"><span class="hs-identifier hs-var">res'</span></a></span><span>
</span><span id="line-875"></span><span>
</span><span id="line-876"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span class="annot"><span class="annottext">(String -&gt; TiM Result) -&gt; String -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Malformed function application: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp1 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680964805"><span class="hs-identifier hs-var">ex0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-877"></span><span>
</span><span id="line-878"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-type">SpawnE</span></a></span><span> </span><span id="local-6989586621680965358"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965358"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">[()]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680965359"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965359"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-879"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965360"><span class="annot"><span class="annottext">_ret_ty :: Ty2
</span><a href="#local-6989586621680965360"><span class="hs-identifier hs-var hs-var">_ret_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArrowTy2 Ty2 -&gt; Ty2
forall ty2. ArrowTy2 ty2 -&gt; ty2
</span><a href="Gibbon.L2.Syntax.html#arrOut"><span class="hs-identifier hs-var">arrOut</span></a></span><span> </span><span class="annot"><span class="annottext">(ArrowTy2 Ty2 -&gt; Ty2) -&gt; ArrowTy2 Ty2 -&gt; Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; FullEnv -&gt; ArrowTy2 Ty2
</span><a href="Gibbon.Passes.InferLocations.html#lookupFEnv"><span class="hs-identifier hs-var">lookupFEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965358"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-880"></span><span>          </span><span class="hs-comment">-- if isScalarTy ret_ty || isPackedTy ret_ty</span><span>
</span><span id="line-881"></span><span>          </span><span class="hs-comment">-- then do</span><span>
</span><span id="line-882"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965361"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965361"><span class="hs-identifier hs-var">ex0'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680965362"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965362"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680965363"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965363"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [()], Ty1, Exp1) -&gt; Exp1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680965335"><span class="hs-identifier hs-var">locs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965336"><span class="hs-identifier hs-var">bty</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [()] -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965358"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965359"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965338"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-883"></span><span>          </span><span class="hs-comment">-- Assume that all args are VarE's</span><span>
</span><span id="line-884"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965364"><span class="annot"><span class="annottext">args2 :: [Exp2]
</span><a href="#local-6989586621680965364"><span class="hs-identifier hs-var hs-var">args2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; Exp2) -&gt; [Exp1] -&gt; [Exp2]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680965365"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965365"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965365"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-885"></span><span>                                   </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span id="local-6989586621680965366"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965366"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965366"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-886"></span><span>                                   </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-type">LitSymE</span></a></span><span> </span><span id="local-6989586621680965367"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965367"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-var">LitSymE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965367"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-887"></span><span>                                   </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-type">LitE</span></a></span><span> </span><span id="local-6989586621680965368"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965368"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Int -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-var">LitE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965368"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-888"></span><span>                                   </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-type">FloatE</span></a></span><span> </span><span id="local-6989586621680965369"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680965369"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Double -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-var">FloatE</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680965369"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-889"></span><span>                                   </span><span id="local-6989586621680965370"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965370"><span class="hs-identifier hs-var">oth</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Exp2
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Exp2) -&gt; String -&gt; Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;inferExp: spawne, arg not simple: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965370"><span class="hs-identifier hs-var">oth</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-890"></span><span>                          </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965359"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-891"></span><span>              </span><span id="local-6989586621680965371"><span class="annot"><span class="annottext">ex0'' :: Exp2
</span><a href="#local-6989586621680965371"><span class="hs-identifier hs-var hs-var">ex0''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Exp2] -&gt; Exp2 -&gt; Exp2
forall loc dec.
(Eq loc, Eq dec) =&gt;
Var
-&gt; [PreExp E2Ext loc dec]
-&gt; PreExp E2Ext loc dec
-&gt; PreExp E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#changeAppToSpawn"><span class="hs-identifier hs-var">changeAppToSpawn</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965358"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965364"><span class="hs-identifier hs-var">args2</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965361"><span class="hs-identifier hs-var">ex0'</span></a></span><span>
</span><span id="line-892"></span><span>          </span><span class="hs-comment">-- pure (moveProjsAfterSync vr ex0'', ty, cs)</span><span>
</span><span id="line-893"></span><span>          </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965371"><span class="hs-identifier hs-var">ex0''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965362"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965363"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-894"></span><span>
</span><span id="line-895"></span><span>        </span><span class="annot"><span class="annottext">Exp1
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-896"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965373"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965373"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965374"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965374"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965375"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965375"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965338"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-897"></span><span>          </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Ty2] -&gt; Ty2
forall loc. [UrTy loc] -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965373"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965374"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965375"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-898"></span><span>
</span><span id="line-899"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-type">IfE</span></a></span><span> </span><span id="local-6989586621680965376"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965376"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680965377"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965377"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680965378"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965378"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-900"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965379"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965379"><span class="hs-identifier hs-var">boda</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965380"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965380"><span class="hs-identifier hs-var">tya</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965381"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965381"><span class="hs-identifier hs-var">csa</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965376"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span>
</span><span id="line-901"></span><span>           </span><span class="hs-comment">-- just assuming tyb == tyc</span><span>
</span><span id="line-902"></span><span>          </span><span id="local-6989586621680965382"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680965382"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965377"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span> </span><span>
</span><span id="line-903"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965383"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965383"><span class="hs-identifier hs-var">bodb</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965384"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965384"><span class="hs-identifier hs-var">tyb</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965385"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965385"><span class="hs-identifier hs-var">csb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>   </span><span class="annot"><span class="annottext">[Var] -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964958"><span class="hs-identifier hs-var">bindAfterLocs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; [Var]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="Gibbon.Passes.InferLocations.html#removeDuplicates"><span class="hs-identifier hs-var">removeDuplicates</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp1 -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#orderOfVarsOutputDataConE"><span class="hs-identifier hs-var">orderOfVarsOutputDataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965377"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680965382"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-904"></span><span>          </span><span id="local-6989586621680965386"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680965386"><span class="hs-identifier hs-var">res'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965378"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span>
</span><span id="line-905"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965387"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965387"><span class="hs-identifier hs-var">bodc</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965388"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965388"><span class="hs-identifier hs-var">tyc</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965389"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965389"><span class="hs-identifier hs-var">csc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>   </span><span class="annot"><span class="annottext">[Var] -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964958"><span class="hs-identifier hs-var">bindAfterLocs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; [Var]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="Gibbon.Passes.InferLocations.html#removeDuplicates"><span class="hs-identifier hs-var">removeDuplicates</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp1 -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#orderOfVarsOutputDataConE"><span class="hs-identifier hs-var">orderOfVarsOutputDataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965378"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621680965386"><span class="hs-identifier hs-var">res'</span></a></span><span>
</span><span id="line-906"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965390"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965390"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965391"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965391"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965392"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965392"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965388"><span class="hs-identifier hs-var">tyc</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965338"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span>
</span><span id="line-907"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965393"><span class="annot"><span class="annottext">cs :: [Constraint]
</span><a href="#local-6989586621680965393"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.OldList.html#nub"><span class="hs-identifier hs-var">L.nub</span></a></span><span> </span><span class="annot"><span class="annottext">([Constraint] -&gt; [Constraint]) -&gt; [Constraint] -&gt; [Constraint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965381"><span class="hs-identifier hs-var">csa</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint] -&gt; [Constraint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965385"><span class="hs-identifier hs-var">csb</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint] -&gt; [Constraint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965389"><span class="hs-identifier hs-var">csc</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint] -&gt; [Constraint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965392"><span class="hs-identifier hs-var">cs'</span></a></span><span>
</span><span id="line-908"></span><span>          </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">L2.LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965388"><span class="hs-identifier hs-var">tyc</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2 -&gt; Exp2 -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-var">L2.IfE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965379"><span class="hs-identifier hs-var">boda</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965383"><span class="hs-identifier hs-var">bodb</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965387"><span class="hs-identifier hs-var">bodc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965390"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965391"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965393"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-909"></span><span>
</span><span id="line-910"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TiM Result) -&gt; String -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected let spine, encountered nested lets: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680964805"><span class="hs-identifier hs-var">ex0</span></a></span><span>
</span><span id="line-911"></span><span>
</span><span id="line-912"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-type">LitE</span></a></span><span> </span><span id="local-6989586621680965394"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965394"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-913"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965395"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965395"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965396"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965396"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965397"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965397"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#IntTy"><span class="hs-identifier hs-var">IntTy</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965338"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-914"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965398"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965398"><span class="hs-identifier hs-var">bod''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965399"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965399"><span class="hs-identifier hs-var">ty''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965400"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965400"><span class="hs-identifier hs-var">cs''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964908"><span class="hs-identifier hs-var">handleTrailingBindLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965395"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965396"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965397"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-915"></span><span>          </span><span id="local-6989586621680965401"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965401"><span class="hs-identifier hs-var">fcs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964832"><span class="hs-identifier hs-var">tryInRegion</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965400"><span class="hs-identifier hs-var">cs''</span></a></span><span>
</span><span id="line-916"></span><span>          </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
</span><a href="#local-6989586621680964807"><span class="hs-identifier hs-var">tryBindReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">L2.LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#IntTy"><span class="hs-identifier hs-var">IntTy</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Int -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-var">L2.LitE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965394"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965398"><span class="hs-identifier hs-var">bod''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965399"><span class="hs-identifier hs-var">ty''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965401"><span class="hs-identifier hs-var">fcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-917"></span><span>
</span><span id="line-918"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CharE"><span class="hs-identifier hs-type">CharE</span></a></span><span> </span><span id="local-6989586621680965402"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680965402"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-919"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965403"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965403"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965404"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965404"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965405"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965405"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#CharTy"><span class="hs-identifier hs-var">CharTy</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965338"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-920"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965406"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965406"><span class="hs-identifier hs-var">bod''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965407"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965407"><span class="hs-identifier hs-var">ty''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965408"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965408"><span class="hs-identifier hs-var">cs''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964908"><span class="hs-identifier hs-var">handleTrailingBindLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965403"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965404"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965405"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-921"></span><span>          </span><span id="local-6989586621680965409"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965409"><span class="hs-identifier hs-var">fcs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964832"><span class="hs-identifier hs-var">tryInRegion</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965408"><span class="hs-identifier hs-var">cs''</span></a></span><span>
</span><span id="line-922"></span><span>          </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
</span><a href="#local-6989586621680964807"><span class="hs-identifier hs-var">tryBindReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">L2.LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#CharTy"><span class="hs-identifier hs-var">CharTy</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Char -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Char -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CharE"><span class="hs-identifier hs-var">L2.CharE</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680965402"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965406"><span class="hs-identifier hs-var">bod''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965407"><span class="hs-identifier hs-var">ty''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965409"><span class="hs-identifier hs-var">fcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-923"></span><span>
</span><span id="line-924"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-type">FloatE</span></a></span><span> </span><span id="local-6989586621680965410"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680965410"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-925"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965411"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965411"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965412"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965412"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965413"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965413"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#FloatTy"><span class="hs-identifier hs-var">FloatTy</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965338"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-926"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965414"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965414"><span class="hs-identifier hs-var">bod''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965415"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965415"><span class="hs-identifier hs-var">ty''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965416"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965416"><span class="hs-identifier hs-var">cs''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964908"><span class="hs-identifier hs-var">handleTrailingBindLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965411"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965412"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965413"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-927"></span><span>          </span><span id="local-6989586621680965417"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965417"><span class="hs-identifier hs-var">fcs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964832"><span class="hs-identifier hs-var">tryInRegion</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965416"><span class="hs-identifier hs-var">cs''</span></a></span><span>
</span><span id="line-928"></span><span>          </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
</span><a href="#local-6989586621680964807"><span class="hs-identifier hs-var">tryBindReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">L2.LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#FloatTy"><span class="hs-identifier hs-var">FloatTy</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Double -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-var">L2.FloatE</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680965410"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965414"><span class="hs-identifier hs-var">bod''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965415"><span class="hs-identifier hs-var">ty''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965417"><span class="hs-identifier hs-var">fcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-929"></span><span>
</span><span id="line-930"></span><span>        </span><span class="hs-comment">-- TODO: docs</span><span>
</span><span id="line-931"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#ReadPackedFile"><span class="hs-identifier hs-type">ReadPackedFile</span></a></span><span> </span><span id="local-6989586621680965419"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621680965419"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621680965420"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965420"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Var
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680965421"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965421"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-932"></span><span>          </span><span id="local-6989586621680965422"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965422"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Var -&gt; TiM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Var -&gt; TiM Var)
-&gt; StateT InferState PassM Var -&gt; TiM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Var -&gt; StateT InferState PassM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Var -&gt; StateT InferState PassM Var)
-&gt; PassM Var -&gt; StateT InferState PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;r&quot;</span></span><span>
</span><span id="line-933"></span><span>          </span><span id="local-6989586621680965424"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965424"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Var -&gt; TiM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Var -&gt; TiM Var)
-&gt; StateT InferState PassM Var -&gt; TiM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Var -&gt; StateT InferState PassM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Var -&gt; StateT InferState PassM Var)
-&gt; PassM Var -&gt; StateT InferState PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; PassM Var
</span><a href="Gibbon.Passes.InferLocations.html#freshLocVar"><span class="hs-identifier hs-var">freshLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mmap_file&quot;</span></span><span>
</span><span id="line-934"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965425"><span class="annot"><span class="annottext">rhs' :: Exp2
</span><a href="#local-6989586621680965425"><span class="hs-identifier hs-var hs-var">rhs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe String -&gt; String -&gt; Maybe Var -&gt; Ty2 -&gt; Prim Ty2
forall ty. Maybe String -&gt; String -&gt; Maybe Var -&gt; ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#ReadPackedFile"><span class="hs-identifier hs-var">ReadPackedFile</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621680965419"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965420"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Maybe Var
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965422"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Var -&gt; Ty2
forall loc. String -&gt; loc -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-var">PackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965420"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965424"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-935"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965426"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965426"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965427"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965427"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965428"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965428"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Var -&gt; Ty2
forall loc. String -&gt; loc -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-var">PackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965420"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965424"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965338"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-936"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965429"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965429"><span class="hs-identifier hs-var">bod''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965430"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965430"><span class="hs-identifier hs-var">ty''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965431"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965431"><span class="hs-identifier hs-var">cs''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964908"><span class="hs-identifier hs-var">handleTrailingBindLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965426"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965427"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965428"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-937"></span><span>          </span><span id="local-6989586621680965432"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965432"><span class="hs-identifier hs-var">fcs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964832"><span class="hs-identifier hs-var">tryInRegion</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965428"><span class="hs-identifier hs-var">cs'</span></a></span><span>
</span><span id="line-938"></span><span>          </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
</span><a href="#local-6989586621680964807"><span class="hs-identifier hs-var">tryBindReg</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span class="annot"><span class="annottext">(E2Ext Var Ty2 -&gt; Exp2) -&gt; E2Ext Var Ty2 -&gt; Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Region -&gt; RegionSize -&gt; Maybe RegionType -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec.
Region
-&gt; RegionSize -&gt; Maybe RegionType -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetRegionE"><span class="hs-identifier hs-var">LetRegionE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Region
</span><a href="Gibbon.L2.Syntax.html#MMapR"><span class="hs-identifier hs-var">MMapR</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965422"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RegionSize
</span><a href="Gibbon.L2.Syntax.html#Undefined"><span class="hs-identifier hs-var">Undefined</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RegionType
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; E2Ext Var Ty2) -&gt; Exp2 -&gt; E2Ext Var Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E2Ext Var Ty2 -&gt; Exp2) -&gt; E2Ext Var Ty2 -&gt; Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; PreLocExp Var -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; PreLocExp loc -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-var">LetLocE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965424"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Region -&gt; PreLocExp Var
forall loc. Region -&gt; PreLocExp loc
</span><a href="Gibbon.L2.Syntax.html#StartOfRegionLE"><span class="hs-identifier hs-var">StartOfRegionLE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Region
</span><a href="Gibbon.L2.Syntax.html#MMapR"><span class="hs-identifier hs-var">MMapR</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965422"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; E2Ext Var Ty2) -&gt; Exp2 -&gt; E2Ext Var Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-939"></span><span>                        </span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">L2.LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">String -&gt; Var -&gt; Ty2
forall loc. String -&gt; loc -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-var">PackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965420"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965424"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965425"><span class="hs-identifier hs-var">rhs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965429"><span class="hs-identifier hs-var">bod''</span></a></span><span>
</span><span id="line-940"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965427"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965432"><span class="hs-identifier hs-var">fcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-941"></span><span>
</span><span id="line-942"></span><span>
</span><span id="line-943"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#WritePackedFile"><span class="hs-identifier hs-type">WritePackedFile</span></a></span><span> </span><span id="local-6989586621680965435"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965435"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621680965436"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965436"><span class="hs-identifier hs-var">_ty0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span id="local-6989586621680965437"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965437"><span class="hs-identifier hs-var">packd</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-944"></span><span>          </span><span id="local-6989586621680965438"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965438"><span class="hs-identifier hs-var">bty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Ty2 -&gt; TiM Ty2
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Ty2 -&gt; TiM Ty2)
-&gt; StateT InferState PassM Ty2 -&gt; TiM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; StateT InferState PassM Ty2
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Ty2 -&gt; StateT InferState PassM Ty2)
-&gt; PassM Ty2 -&gt; StateT InferState PassM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965336"><span class="hs-identifier hs-var">bty</span></a></span><span>
</span><span id="line-945"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965439"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965439"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965440"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965440"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965441"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965441"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965438"><span class="hs-identifier hs-var">bty'</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965338"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-946"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965442"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965442"><span class="hs-identifier hs-var">bod''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965443"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965443"><span class="hs-identifier hs-var">ty''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965444"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965444"><span class="hs-identifier hs-var">cs''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964908"><span class="hs-identifier hs-var">handleTrailingBindLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965439"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965440"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965441"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-947"></span><span>          </span><span id="local-6989586621680965445"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965445"><span class="hs-identifier hs-var">fcs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964832"><span class="hs-identifier hs-var">tryInRegion</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965444"><span class="hs-identifier hs-var">cs''</span></a></span><span>
</span><span id="line-948"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span id="local-6989586621680965446"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965446"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span id="local-6989586621680965447"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965447"><span class="hs-identifier hs-var">loc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; FullEnv -&gt; Ty2
</span><a href="Gibbon.Passes.InferLocations.html#lookupVEnv"><span class="hs-identifier hs-var">lookupVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965437"><span class="hs-identifier hs-var">packd</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-949"></span><span>          </span><span id="local-6989586621680965448"><span class="annot"><span class="annottext">UnifyLoc
</span><a href="#local-6989586621680965448"><span class="hs-identifier hs-var">unifyloc2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM UnifyLoc
</span><a href="Gibbon.Passes.InferLocations.html#lookupUnifyLoc"><span class="hs-identifier hs-var">lookupUnifyLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965447"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-950"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965450"><span class="annot"><span class="annottext">loc2 :: Var
</span><a href="#local-6989586621680965450"><span class="hs-identifier hs-var hs-var">loc2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UnifyLoc
</span><a href="#local-6989586621680965448"><span class="hs-identifier hs-var">unifyloc2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-951"></span><span>                       </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FreshLoc"><span class="hs-identifier hs-type">FreshLoc</span></a></span><span> </span><span id="local-6989586621680965451"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965451"><span class="hs-identifier hs-var">lc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965451"><span class="hs-identifier hs-var">lc</span></a></span><span>
</span><span id="line-952"></span><span>                       </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FixedLoc"><span class="hs-identifier hs-type">FixedLoc</span></a></span><span> </span><span id="local-6989586621680965452"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965452"><span class="hs-identifier hs-var">lc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965452"><span class="hs-identifier hs-var">lc</span></a></span><span>
</span><span id="line-953"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965453"><span class="annot"><span class="annottext">rhs' :: Exp2
</span><a href="#local-6989586621680965453"><span class="hs-identifier hs-var hs-var">rhs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Ty2 -&gt; Prim Ty2
forall ty. String -&gt; ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#WritePackedFile"><span class="hs-identifier hs-var">WritePackedFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965435"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Var -&gt; Ty2
forall loc. String -&gt; loc -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-var">PackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965446"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965450"><span class="hs-identifier hs-var">loc2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965437"><span class="hs-identifier hs-var">packd</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-954"></span><span>          </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
</span><a href="#local-6989586621680964807"><span class="hs-identifier hs-var">tryBindReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">L2.LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965438"><span class="hs-identifier hs-var">bty'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965453"><span class="hs-identifier hs-var">rhs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965442"><span class="hs-identifier hs-var">bod''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965443"><span class="hs-identifier hs-var">ty''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965445"><span class="hs-identifier hs-var">fcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-955"></span><span>
</span><span id="line-956"></span><span>
</span><span id="line-957"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#ReadArrayFile"><span class="hs-identifier hs-type">ReadArrayFile</span></a></span><span> </span><span id="local-6989586621680965455"><span class="annot"><span class="annottext">Maybe (String, Int)
</span><a href="#local-6989586621680965455"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621680965456"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965456"><span class="hs-identifier hs-var">ty0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-958"></span><span>          </span><span id="local-6989586621680965457"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965457"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Ty2 -&gt; TiM Ty2
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Ty2 -&gt; TiM Ty2)
-&gt; StateT InferState PassM Ty2 -&gt; TiM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; StateT InferState PassM Ty2
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Ty2 -&gt; StateT InferState PassM Ty2)
-&gt; PassM Ty2 -&gt; StateT InferState PassM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965336"><span class="hs-identifier hs-var">bty</span></a></span><span>
</span><span id="line-959"></span><span>          </span><span id="local-6989586621680965458"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965458"><span class="hs-identifier hs-var">ty0'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Ty2 -&gt; TiM Ty2
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Ty2 -&gt; TiM Ty2)
-&gt; StateT InferState PassM Ty2 -&gt; TiM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; StateT InferState PassM Ty2
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Ty2 -&gt; StateT InferState PassM Ty2)
-&gt; PassM Ty2 -&gt; StateT InferState PassM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965456"><span class="hs-identifier hs-var">ty0</span></a></span><span>
</span><span id="line-960"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965459"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965459"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965460"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965460"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965461"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965461"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965457"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965338"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-961"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965462"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965462"><span class="hs-identifier hs-var">bod''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965463"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965463"><span class="hs-identifier hs-var">ty''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965464"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965464"><span class="hs-identifier hs-var">cs'''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964908"><span class="hs-identifier hs-var">handleTrailingBindLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965459"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965460"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965461"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-962"></span><span>          </span><span id="local-6989586621680965465"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965465"><span class="hs-identifier hs-var">fcs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964832"><span class="hs-identifier hs-var">tryInRegion</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965464"><span class="hs-identifier hs-var">cs'''</span></a></span><span>
</span><span id="line-963"></span><span>          </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
</span><a href="#local-6989586621680964807"><span class="hs-identifier hs-var">tryBindReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">L2.LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965457"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">L2.PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (String, Int) -&gt; Ty2 -&gt; Prim Ty2
forall ty. Maybe (String, Int) -&gt; ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#ReadArrayFile"><span class="hs-identifier hs-var">ReadArrayFile</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (String, Int)
</span><a href="#local-6989586621680965455"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965458"><span class="hs-identifier hs-var">ty0'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965462"><span class="hs-identifier hs-var">bod''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965463"><span class="hs-identifier hs-var">ty''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965465"><span class="hs-identifier hs-var">fcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-964"></span><span>
</span><span id="line-965"></span><span>        </span><span class="hs-comment">-- Don't process the StartOf or SizeOf operation at all, just recur through it</span><span>
</span><span id="line-966"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#RequestSizeOf"><span class="hs-identifier hs-var">RequestSizeOf</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span id="local-6989586621680965467"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965467"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-967"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965468"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965468"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965469"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965469"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965470"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965470"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965338"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-968"></span><span>          </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">L2.LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#IntTy"><span class="hs-identifier hs-var">IntTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">L2.PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#RequestSizeOf"><span class="hs-identifier hs-var">RequestSizeOf</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">L2.VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965467"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965468"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965469"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965470"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-969"></span><span>
</span><span id="line-970"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#DictInsertP"><span class="hs-identifier hs-type">DictInsertP</span></a></span><span> </span><span id="local-6989586621680965471"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965471"><span class="hs-identifier hs-var">dty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680965472"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965472"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-971"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965473"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965473"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965474"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965474"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965475"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965475"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prim Ty1 -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty1 -&gt; Prim Ty1
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#DictInsertP"><span class="hs-identifier hs-var">DictInsertP</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965471"><span class="hs-identifier hs-var">dty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965472"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span>
</span><span id="line-972"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965476"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965476"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965477"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965477"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965478"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965478"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965474"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965338"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-973"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965479"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965479"><span class="hs-identifier hs-var">bod''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965480"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965480"><span class="hs-identifier hs-var">ty''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965481"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965481"><span class="hs-identifier hs-var">cs'''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964908"><span class="hs-identifier hs-var">handleTrailingBindLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965476"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965477"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.OldList.html#nub"><span class="hs-identifier hs-var">L.nub</span></a></span><span> </span><span class="annot"><span class="annottext">([Constraint] -&gt; [Constraint]) -&gt; [Constraint] -&gt; [Constraint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965478"><span class="hs-identifier hs-var">cs'</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint] -&gt; [Constraint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965475"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-974"></span><span>          </span><span id="local-6989586621680965482"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965482"><span class="hs-identifier hs-var">fcs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964832"><span class="hs-identifier hs-var">tryInRegion</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965481"><span class="hs-identifier hs-var">cs'''</span></a></span><span>
</span><span id="line-975"></span><span>          </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
</span><a href="#local-6989586621680964807"><span class="hs-identifier hs-var">tryBindReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">L2.LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965474"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965473"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965479"><span class="hs-identifier hs-var">bod''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965480"><span class="hs-identifier hs-var">ty''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965482"><span class="hs-identifier hs-var">fcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-976"></span><span>
</span><span id="line-977"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#DictLookupP"><span class="hs-identifier hs-type">DictLookupP</span></a></span><span> </span><span id="local-6989586621680965483"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965483"><span class="hs-identifier hs-var">dty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680965484"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965484"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-978"></span><span>          </span><span id="local-6989586621680965485"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965485"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Var -&gt; TiM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Var -&gt; TiM Var)
-&gt; StateT InferState PassM Var -&gt; TiM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Var -&gt; StateT InferState PassM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Var -&gt; StateT InferState PassM Var)
-&gt; PassM Var -&gt; StateT InferState PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; PassM Var
</span><a href="Gibbon.Passes.InferLocations.html#freshLocVar"><span class="hs-identifier hs-var">freshLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;dict&quot;</span></span><span>
</span><span id="line-979"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965486"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965486"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965487"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965487"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965488"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965488"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prim Ty1 -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty1 -&gt; Prim Ty1
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#DictLookupP"><span class="hs-identifier hs-var">DictLookupP</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965483"><span class="hs-identifier hs-var">dty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965484"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Dest -&gt; TiM Result) -&gt; Dest -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Dest
</span><a href="Gibbon.Passes.InferLocations.html#SingleDest"><span class="hs-identifier hs-var">SingleDest</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965485"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-980"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965489"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965489"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965490"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965490"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965491"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965491"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965487"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965338"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-981"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965492"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965492"><span class="hs-identifier hs-var">bod''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965493"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965493"><span class="hs-identifier hs-var">ty''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965494"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965494"><span class="hs-identifier hs-var">cs'''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964908"><span class="hs-identifier hs-var">handleTrailingBindLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965489"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965490"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.OldList.html#nub"><span class="hs-identifier hs-var">L.nub</span></a></span><span> </span><span class="annot"><span class="annottext">([Constraint] -&gt; [Constraint]) -&gt; [Constraint] -&gt; [Constraint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965488"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint] -&gt; [Constraint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965491"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-982"></span><span>          </span><span id="local-6989586621680965495"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965495"><span class="hs-identifier hs-var">fcs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964832"><span class="hs-identifier hs-var">tryInRegion</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965494"><span class="hs-identifier hs-var">cs'''</span></a></span><span>
</span><span id="line-983"></span><span>          </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
</span><a href="#local-6989586621680964807"><span class="hs-identifier hs-var">tryBindReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">L2.LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965487"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965486"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965492"><span class="hs-identifier hs-var">bod''</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965493"><span class="hs-identifier hs-var">ty''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965495"><span class="hs-identifier hs-var">fcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-984"></span><span>
</span><span id="line-985"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#DictEmptyP"><span class="hs-identifier hs-type">DictEmptyP</span></a></span><span> </span><span id="local-6989586621680965496"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965496"><span class="hs-identifier hs-var">dty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680965497"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965497"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-986"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965498"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965498"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965499"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965499"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965500"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965500"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prim Ty1 -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty1 -&gt; Prim Ty1
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#DictEmptyP"><span class="hs-identifier hs-var">DictEmptyP</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965496"><span class="hs-identifier hs-var">dty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965497"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span>
</span><span id="line-987"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965501"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965501"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965502"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965502"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965503"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965503"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965499"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965338"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-988"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965504"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965504"><span class="hs-identifier hs-var">bod''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965505"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965505"><span class="hs-identifier hs-var">ty''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965506"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965506"><span class="hs-identifier hs-var">cs'''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964908"><span class="hs-identifier hs-var">handleTrailingBindLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965501"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965502"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.OldList.html#nub"><span class="hs-identifier hs-var">L.nub</span></a></span><span> </span><span class="annot"><span class="annottext">([Constraint] -&gt; [Constraint]) -&gt; [Constraint] -&gt; [Constraint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965503"><span class="hs-identifier hs-var">cs'</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint] -&gt; [Constraint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965500"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-989"></span><span>          </span><span id="local-6989586621680965507"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965507"><span class="hs-identifier hs-var">fcs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964832"><span class="hs-identifier hs-var">tryInRegion</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965506"><span class="hs-identifier hs-var">cs'''</span></a></span><span>
</span><span id="line-990"></span><span>          </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
</span><a href="#local-6989586621680964807"><span class="hs-identifier hs-var">tryBindReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">L2.LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965499"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965498"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965504"><span class="hs-identifier hs-var">bod''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965505"><span class="hs-identifier hs-var">ty''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965507"><span class="hs-identifier hs-var">fcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-991"></span><span>
</span><span id="line-992"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#DictHasKeyP"><span class="hs-identifier hs-type">DictHasKeyP</span></a></span><span> </span><span id="local-6989586621680965508"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965508"><span class="hs-identifier hs-var">dty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680965509"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965509"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-993"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965510"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965510"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965511"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965511"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965512"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965512"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prim Ty1 -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty1 -&gt; Prim Ty1
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#DictHasKeyP"><span class="hs-identifier hs-var">DictHasKeyP</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965508"><span class="hs-identifier hs-var">dty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965509"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span>
</span><span id="line-994"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965513"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965513"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965514"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965514"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965515"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965515"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965511"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965338"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-995"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965516"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965516"><span class="hs-identifier hs-var">bod''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965517"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965517"><span class="hs-identifier hs-var">ty''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965518"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965518"><span class="hs-identifier hs-var">cs'''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964908"><span class="hs-identifier hs-var">handleTrailingBindLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965513"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965514"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.OldList.html#nub"><span class="hs-identifier hs-var">L.nub</span></a></span><span> </span><span class="annot"><span class="annottext">([Constraint] -&gt; [Constraint]) -&gt; [Constraint] -&gt; [Constraint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965515"><span class="hs-identifier hs-var">cs'</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint] -&gt; [Constraint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965512"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-996"></span><span>          </span><span id="local-6989586621680965519"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965519"><span class="hs-identifier hs-var">fcs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964832"><span class="hs-identifier hs-var">tryInRegion</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965518"><span class="hs-identifier hs-var">cs'''</span></a></span><span>
</span><span id="line-997"></span><span>          </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
</span><a href="#local-6989586621680964807"><span class="hs-identifier hs-var">tryBindReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">L2.LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965511"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965510"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965516"><span class="hs-identifier hs-var">bod''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965517"><span class="hs-identifier hs-var">ty''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965519"><span class="hs-identifier hs-var">fcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-998"></span><span>
</span><span id="line-999"></span><span>        </span><span class="hs-comment">-- Special case for VSortP because we don't want to lookup fp in</span><span>
</span><span id="line-1000"></span><span>        </span><span class="hs-comment">-- the type environment.</span><span>
</span><span id="line-1001"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span id="local-6989586621680965520"><span class="annot"><span class="annottext">p :: Prim Ty1
</span><a href="#local-6989586621680965520"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#VSortP"><span class="hs-identifier hs-type">VSortP</span></a></span><span> </span><span id="local-6989586621680965521"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965521"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span id="local-6989586621680965522"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965522"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span id="local-6989586621680965523"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965523"><span class="hs-identifier hs-var">fp</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1002"></span><span>          </span><span id="local-6989586621680965524"><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965524"><span class="hs-identifier hs-var">lsrec</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; TiM Result)
-&gt; [Exp1] -&gt; ExceptT Failure (StateT InferState PassM) [Result]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680965525"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965525"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965525"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965522"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1003"></span><span>          </span><span id="local-6989586621680965526"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965526"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Ty2 -&gt; TiM Ty2
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Ty2 -&gt; TiM Ty2)
-&gt; StateT InferState PassM Ty2 -&gt; TiM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; StateT InferState PassM Ty2
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Ty2 -&gt; StateT InferState PassM Ty2)
-&gt; PassM Ty2 -&gt; StateT InferState PassM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965336"><span class="hs-identifier hs-var">bty</span></a></span><span>
</span><span id="line-1004"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965527"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965527"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965528"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965528"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965529"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965529"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965526"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965338"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-1005"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965530"><span class="annot"><span class="annottext">ls' :: [Exp2]
</span><a href="#local-6989586621680965530"><span class="hs-identifier hs-var hs-var">ls'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965531"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680965531"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965531"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965524"><span class="hs-identifier hs-var">lsrec</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Exp2] -&gt; [Exp2] -&gt; [Exp2]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965523"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1006"></span><span>              </span><span id="local-6989586621680965532"><span class="annot"><span class="annottext">cs'' :: [Constraint]
</span><a href="#local-6989586621680965532"><span class="hs-identifier hs-var hs-var">cs''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Constraint]] -&gt; [Constraint]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">([[Constraint]] -&gt; [Constraint]) -&gt; [[Constraint]] -&gt; [Constraint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965533"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680965533"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965533"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965524"><span class="hs-identifier hs-var">lsrec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1007"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965534"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965534"><span class="hs-identifier hs-var">bod''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965535"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965535"><span class="hs-identifier hs-var">ty''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965536"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965536"><span class="hs-identifier hs-var">cs'''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964908"><span class="hs-identifier hs-var">handleTrailingBindLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965527"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965528"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.OldList.html#nub"><span class="hs-identifier hs-var">L.nub</span></a></span><span> </span><span class="annot"><span class="annottext">([Constraint] -&gt; [Constraint]) -&gt; [Constraint] -&gt; [Constraint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965529"><span class="hs-identifier hs-var">cs'</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint] -&gt; [Constraint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965532"><span class="hs-identifier hs-var">cs''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1008"></span><span>          </span><span id="local-6989586621680965537"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965537"><span class="hs-identifier hs-var">fcs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964832"><span class="hs-identifier hs-var">tryInRegion</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965536"><span class="hs-identifier hs-var">cs'''</span></a></span><span>
</span><span id="line-1009"></span><span>          </span><span id="local-6989586621680965538"><span class="annot"><span class="annottext">Prim Ty2
</span><a href="#local-6989586621680965538"><span class="hs-identifier hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM (Prim Ty2)
-&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM (Prim Ty2)
 -&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2))
-&gt; StateT InferState PassM (Prim Ty2)
-&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM (Prim Ty2) -&gt; StateT InferState PassM (Prim Ty2)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM (Prim Ty2) -&gt; StateT InferState PassM (Prim Ty2))
-&gt; PassM (Prim Ty2) -&gt; StateT InferState PassM (Prim Ty2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1 -&gt; PassM (Prim Ty2)
</span><a href="Gibbon.Passes.InferLocations.html#prim"><span class="hs-keyword hs-var">prim</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="#local-6989586621680965520"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1010"></span><span>          </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
</span><a href="#local-6989586621680964807"><span class="hs-identifier hs-var">tryBindReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">L2.LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965526"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">L2.PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
</span><a href="#local-6989586621680965538"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965530"><span class="hs-identifier hs-var">ls'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965534"><span class="hs-identifier hs-var">bod''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965535"><span class="hs-identifier hs-var">ty''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965537"><span class="hs-identifier hs-var">fcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1011"></span><span>
</span><span id="line-1012"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span id="local-6989586621680965539"><span class="annot"><span class="annottext">Prim Ty1
</span><a href="#local-6989586621680965539"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680965540"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965540"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1013"></span><span>          </span><span id="local-6989586621680965541"><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965541"><span class="hs-identifier hs-var">lsrec</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; TiM Result)
-&gt; [Exp1] -&gt; ExceptT Failure (StateT InferState PassM) [Result]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680965542"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965542"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965542"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965540"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1014"></span><span>          </span><span id="local-6989586621680965543"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965543"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Ty2 -&gt; TiM Ty2
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Ty2 -&gt; TiM Ty2)
-&gt; StateT InferState PassM Ty2 -&gt; TiM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; StateT InferState PassM Ty2
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Ty2 -&gt; StateT InferState PassM Ty2)
-&gt; PassM Ty2 -&gt; StateT InferState PassM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965336"><span class="hs-identifier hs-var">bty</span></a></span><span>
</span><span id="line-1015"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965544"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965544"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965545"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965545"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965546"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965546"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965543"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965338"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-1016"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965547"><span class="annot"><span class="annottext">ls' :: [Exp2]
</span><a href="#local-6989586621680965547"><span class="hs-identifier hs-var hs-var">ls'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965548"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680965548"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965548"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965541"><span class="hs-identifier hs-var">lsrec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1017"></span><span>              </span><span id="local-6989586621680965549"><span class="annot"><span class="annottext">cs'' :: [Constraint]
</span><a href="#local-6989586621680965549"><span class="hs-identifier hs-var hs-var">cs''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Constraint]] -&gt; [Constraint]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">([[Constraint]] -&gt; [Constraint]) -&gt; [[Constraint]] -&gt; [Constraint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965550"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680965550"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965550"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965541"><span class="hs-identifier hs-var">lsrec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1018"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965551"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965551"><span class="hs-identifier hs-var">bod''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965552"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965552"><span class="hs-identifier hs-var">ty''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965553"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965553"><span class="hs-identifier hs-var">cs'''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964908"><span class="hs-identifier hs-var">handleTrailingBindLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965544"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965545"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.OldList.html#nub"><span class="hs-identifier hs-var">L.nub</span></a></span><span> </span><span class="annot"><span class="annottext">([Constraint] -&gt; [Constraint]) -&gt; [Constraint] -&gt; [Constraint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965546"><span class="hs-identifier hs-var">cs'</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint] -&gt; [Constraint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965549"><span class="hs-identifier hs-var">cs''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1019"></span><span>          </span><span id="local-6989586621680965554"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965554"><span class="hs-identifier hs-var">fcs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964832"><span class="hs-identifier hs-var">tryInRegion</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965553"><span class="hs-identifier hs-var">cs'''</span></a></span><span>
</span><span id="line-1020"></span><span>          </span><span id="local-6989586621680965555"><span class="annot"><span class="annottext">Prim Ty2
</span><a href="#local-6989586621680965555"><span class="hs-identifier hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM (Prim Ty2)
-&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM (Prim Ty2)
 -&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2))
-&gt; StateT InferState PassM (Prim Ty2)
-&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM (Prim Ty2) -&gt; StateT InferState PassM (Prim Ty2)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM (Prim Ty2) -&gt; StateT InferState PassM (Prim Ty2))
-&gt; PassM (Prim Ty2) -&gt; StateT InferState PassM (Prim Ty2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1 -&gt; PassM (Prim Ty2)
</span><a href="Gibbon.Passes.InferLocations.html#prim"><span class="hs-keyword hs-var">prim</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="#local-6989586621680965539"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1021"></span><span>          </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
</span><a href="#local-6989586621680964807"><span class="hs-identifier hs-var">tryBindReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">L2.LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965543"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">L2.PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
</span><a href="#local-6989586621680965555"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965547"><span class="hs-identifier hs-var">ls'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965551"><span class="hs-identifier hs-var">bod''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965552"><span class="hs-identifier hs-var">ty''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965554"><span class="hs-identifier hs-var">fcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1022"></span><span>
</span><span id="line-1023"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-type">DataConE</span></a></span><span> </span><span id="local-6989586621680965556"><span class="annot"><span class="annottext">()
</span><a href="#local-6989586621680965556"><span class="hs-identifier hs-var">_loc</span></a></span></span><span> </span><span id="local-6989586621680965557"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965557"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680965558"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965558"><span class="hs-identifier hs-var">ls</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1024"></span><span>          </span><span id="local-6989586621680965559"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965559"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Var -&gt; TiM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Var -&gt; TiM Var)
-&gt; StateT InferState PassM Var -&gt; TiM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Var -&gt; StateT InferState PassM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Var -&gt; StateT InferState PassM Var)
-&gt; PassM Var -&gt; StateT InferState PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; PassM Var
</span><a href="Gibbon.Passes.InferLocations.html#freshLocVar"><span class="hs-identifier hs-var">freshLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;datacon&quot;</span></span><span>
</span><span id="line-1025"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965560"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965560"><span class="hs-identifier hs-var">rhs'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965561"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965561"><span class="hs-identifier hs-var">rty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965562"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965562"><span class="hs-identifier hs-var">rcs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; String -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
loc -&gt; String -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-var">DataConE</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965557"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965558"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Dest -&gt; TiM Result) -&gt; Dest -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Dest
</span><a href="Gibbon.Passes.InferLocations.html#SingleDest"><span class="hs-identifier hs-var">SingleDest</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965559"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-1026"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965563"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965563"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965564"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965564"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965565"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965565"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Var -&gt; Ty2
forall loc. String -&gt; loc -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-var">PackedTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDefs Ty2 -&gt; ShowS
forall a. Out a =&gt; DDefs a -&gt; ShowS
</span><a href="Gibbon.Language.Syntax.html#getTyOfDataCon"><span class="hs-identifier hs-var">getTyOfDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs Ty2
</span><a href="#local-6989586621680964804"><span class="hs-identifier hs-var">dataDefs</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965557"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965559"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965338"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-1027"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965566"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965566"><span class="hs-identifier hs-var">bod''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965567"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965567"><span class="hs-identifier hs-var">ty''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965568"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965568"><span class="hs-identifier hs-var">cs''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964908"><span class="hs-identifier hs-var">handleTrailingBindLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965563"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965564"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.OldList.html#nub"><span class="hs-identifier hs-var">L.nub</span></a></span><span> </span><span class="annot"><span class="annottext">([Constraint] -&gt; [Constraint]) -&gt; [Constraint] -&gt; [Constraint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965565"><span class="hs-identifier hs-var">cs'</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint] -&gt; [Constraint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965562"><span class="hs-identifier hs-var">rcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1028"></span><span>          </span><span id="local-6989586621680965569"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965569"><span class="hs-identifier hs-var">fcs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964832"><span class="hs-identifier hs-var">tryInRegion</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965568"><span class="hs-identifier hs-var">cs''</span></a></span><span>
</span><span id="line-1029"></span><span>          </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
</span><a href="#local-6989586621680964807"><span class="hs-identifier hs-var">tryBindReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">L2.LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">String -&gt; Var -&gt; Ty2
forall loc. String -&gt; loc -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-var">PackedTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDefs Ty2 -&gt; ShowS
forall a. Out a =&gt; DDefs a -&gt; ShowS
</span><a href="Gibbon.Language.Syntax.html#getTyOfDataCon"><span class="hs-identifier hs-var">getTyOfDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs Ty2
</span><a href="#local-6989586621680964804"><span class="hs-identifier hs-var">dataDefs</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965557"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965559"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965560"><span class="hs-identifier hs-var">rhs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965566"><span class="hs-identifier hs-var">bod''</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1030"></span><span>                    </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965564"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965569"><span class="hs-identifier hs-var">fcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1031"></span><span>
</span><span id="line-1032"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-type">LitSymE</span></a></span><span> </span><span id="local-6989586621680965570"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965570"><span class="hs-identifier hs-var">x</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1033"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965571"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965571"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965572"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965572"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965573"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965573"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#IntTy"><span class="hs-identifier hs-var">IntTy</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965338"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-1034"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965574"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965574"><span class="hs-identifier hs-var">bod''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965575"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965575"><span class="hs-identifier hs-var">ty''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965576"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965576"><span class="hs-identifier hs-var">cs''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964908"><span class="hs-identifier hs-var">handleTrailingBindLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965571"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965572"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965573"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1035"></span><span>          </span><span id="local-6989586621680965577"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965577"><span class="hs-identifier hs-var">fcs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964832"><span class="hs-identifier hs-var">tryInRegion</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965576"><span class="hs-identifier hs-var">cs''</span></a></span><span>
</span><span id="line-1036"></span><span>          </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
</span><a href="#local-6989586621680964807"><span class="hs-identifier hs-var">tryBindReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">L2.LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#SymTy"><span class="hs-identifier hs-var">SymTy</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Var -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-var">L2.LitSymE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965570"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965574"><span class="hs-identifier hs-var">bod''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965575"><span class="hs-identifier hs-var">ty''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965577"><span class="hs-identifier hs-var">fcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1037"></span><span>
</span><span id="line-1038"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-type">ProjE</span></a></span><span> </span><span id="local-6989586621680965578"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965578"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680965579"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965579"><span class="hs-identifier hs-var">arg</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1039"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965580"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965580"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680965581"><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965581"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965582"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965582"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965579"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span>
</span><span id="line-1040"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965583"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965583"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965584"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965584"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965585"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965585"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965581"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2] -&gt; Int -&gt; Ty2
forall a. HasCallStack =&gt; [a] -&gt; Int -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#%21%21"><span class="hs-operator hs-var">!!</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965578"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965338"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-1041"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965586"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965586"><span class="hs-identifier hs-var">bod''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965587"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965587"><span class="hs-identifier hs-var">ty''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965588"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965588"><span class="hs-identifier hs-var">cs''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964908"><span class="hs-identifier hs-var">handleTrailingBindLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965583"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965584"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.OldList.html#nub"><span class="hs-identifier hs-var">L.nub</span></a></span><span> </span><span class="annot"><span class="annottext">([Constraint] -&gt; [Constraint]) -&gt; [Constraint] -&gt; [Constraint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965582"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint] -&gt; [Constraint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965585"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1042"></span><span>          </span><span id="local-6989586621680965589"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965589"><span class="hs-identifier hs-var">fcs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964832"><span class="hs-identifier hs-var">tryInRegion</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965588"><span class="hs-identifier hs-var">cs''</span></a></span><span>
</span><span id="line-1043"></span><span>          </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
</span><a href="#local-6989586621680964807"><span class="hs-identifier hs-var">tryBindReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">L2.LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965581"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2] -&gt; Int -&gt; Ty2
forall a. HasCallStack =&gt; [a] -&gt; Int -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#%21%21"><span class="hs-operator hs-var">!!</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965578"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Int -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-var">L2.ProjE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965578"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965580"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965586"><span class="hs-identifier hs-var">bod''</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1044"></span><span>                             </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965587"><span class="hs-identifier hs-var">ty''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965589"><span class="hs-identifier hs-var">fcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1045"></span><span>
</span><span id="line-1046"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-type">CaseE</span></a></span><span> </span><span id="local-6989586621680965590"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965590"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span id="local-6989586621680965591"><span class="annot"><span class="annottext">[(String, [(Var, ())], Exp1)]
</span><a href="#local-6989586621680965591"><span class="hs-identifier hs-var">ls</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1047"></span><span>          </span><span id="local-6989586621680965592"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965592"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Var -&gt; TiM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Var -&gt; TiM Var)
-&gt; StateT InferState PassM Var -&gt; TiM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Var -&gt; StateT InferState PassM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Var -&gt; StateT InferState PassM Var)
-&gt; PassM Var -&gt; StateT InferState PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; PassM Var
</span><a href="Gibbon.Passes.InferLocations.html#freshLocVar"><span class="hs-identifier hs-var">freshLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;scrut&quot;</span></span><span>
</span><span id="line-1048"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965593"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965593"><span class="hs-identifier hs-var">ex'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965594"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965594"><span class="hs-identifier hs-var">ty2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965595"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965595"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965590"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Dest
</span><a href="Gibbon.Passes.InferLocations.html#SingleDest"><span class="hs-identifier hs-var">SingleDest</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965592"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1049"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965596"><span class="annot"><span class="annottext">src :: Var
</span><a href="#local-6989586621680965596"><span class="hs-identifier hs-var hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Var
</span><a href="Gibbon.Passes.InferLocations.html#locOfTy"><span class="hs-identifier hs-var">locOfTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965594"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1050"></span><span>          </span><span id="local-6989586621680965597"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965597"><span class="hs-identifier hs-var">rhsTy</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Ty2 -&gt; TiM Ty2
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Ty2 -&gt; TiM Ty2)
-&gt; StateT InferState PassM Ty2 -&gt; TiM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; StateT InferState PassM Ty2
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Ty2 -&gt; StateT InferState PassM Ty2)
-&gt; PassM Ty2 -&gt; StateT InferState PassM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965336"><span class="hs-identifier hs-var">bty</span></a></span><span>
</span><span id="line-1051"></span><span>          </span><span id="local-6989586621680965598"><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680965598"><span class="hs-identifier hs-var">caseDest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; TiM Dest
</span><a href="Gibbon.Passes.InferLocations.html#destFromType%27"><span class="hs-identifier hs-var">destFromType'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965597"><span class="hs-identifier hs-var">rhsTy</span></a></span><span>
</span><span id="line-1052"></span><span>          </span><span id="local-6989586621680965599"><span class="annot"><span class="annottext">[((String, [(Var, Var)], Exp2), Ty2, [Constraint])]
</span><a href="#local-6989586621680965599"><span class="hs-identifier hs-var">pairs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((String, [(Var, ())], Exp1)
 -&gt; TiM ((String, [(Var, Var)], Exp2), Ty2, [Constraint]))
-&gt; [(String, [(Var, ())], Exp1)]
-&gt; ExceptT
     Failure
     (StateT InferState PassM)
     [((String, [(Var, Var)], Exp2), Ty2, [Constraint])]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DDefs Ty2
-&gt; FullEnv
-&gt; Var
-&gt; Dest
-&gt; (String, [(Var, ())], Exp1)
-&gt; TiM ((String, [(Var, Var)], Exp2), Ty2, [Constraint])
</span><a href="#local-6989586621680964997"><span class="hs-identifier hs-var">doCase</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs Ty2
</span><a href="#local-6989586621680964804"><span class="hs-identifier hs-var">dataDefs</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965596"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680965598"><span class="hs-identifier hs-var">caseDest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(String, [(Var, ())], Exp1)]
</span><a href="#local-6989586621680965591"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1053"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965600"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965600"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965601"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965601"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965602"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965602"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965597"><span class="hs-identifier hs-var">rhsTy</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965338"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-1054"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965603"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965603"><span class="hs-identifier hs-var">bod''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965604"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965604"><span class="hs-identifier hs-var">ty''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965605"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965605"><span class="hs-identifier hs-var">cs''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964908"><span class="hs-identifier hs-var">handleTrailingBindLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965600"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965601"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965602"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1055"></span><span>          </span><span id="local-6989586621680965606"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965606"><span class="hs-identifier hs-var">fcs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964832"><span class="hs-identifier hs-var">tryInRegion</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965605"><span class="hs-identifier hs-var">cs''</span></a></span><span>
</span><span id="line-1056"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965607"><span class="annot"><span class="annottext">ccs :: [Constraint]
</span><a href="#local-6989586621680965607"><span class="hs-identifier hs-var hs-var">ccs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.OldList.html#nub"><span class="hs-identifier hs-var">L.nub</span></a></span><span> </span><span class="annot"><span class="annottext">([Constraint] -&gt; [Constraint]) -&gt; [Constraint] -&gt; [Constraint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965595"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint] -&gt; [Constraint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965606"><span class="hs-identifier hs-var">fcs</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint] -&gt; [Constraint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Constraint]] -&gt; [Constraint]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">([[Constraint]] -&gt; [Constraint]) -&gt; [[Constraint]] -&gt; [Constraint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965608"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String, [(Var, Var)], Exp2)
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680965608"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965608"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[((String, [(Var, Var)], Exp2), Ty2, [Constraint])]
</span><a href="#local-6989586621680965599"><span class="hs-identifier hs-var">pairs</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1057"></span><span>              </span><span id="local-6989586621680965609"><span class="annot"><span class="annottext">cexp :: Exp2
</span><a href="#local-6989586621680965609"><span class="hs-identifier hs-var hs-var">cexp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; [(String, [(Var, Var)], Exp2)] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; [(String, [(Var, loc)], PreExp ext loc dec)]
-&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-var">L2.CaseE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965593"><span class="hs-identifier hs-var">ex'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">(String, [(Var, Var)], Exp2)
</span><a href="#local-6989586621680965610"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680965610"><span class="annot"><span class="annottext">(String, [(Var, Var)], Exp2)
</span><a href="#local-6989586621680965610"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[((String, [(Var, Var)], Exp2), Ty2, [Constraint])]
</span><a href="#local-6989586621680965599"><span class="hs-identifier hs-var">pairs</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1058"></span><span>          </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
</span><a href="#local-6989586621680964807"><span class="hs-identifier hs-var">tryBindReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">L2.LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2 -&gt; [Var]
</span><a href="Gibbon.L2.Syntax.html#locsInTy"><span class="hs-identifier hs-var">locsInTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965597"><span class="hs-identifier hs-var">rhsTy</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965597"><span class="hs-identifier hs-var">rhsTy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965609"><span class="hs-identifier hs-var">cexp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965603"><span class="hs-identifier hs-var">bod''</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1059"></span><span>                      </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965604"><span class="hs-identifier hs-var">ty''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965607"><span class="hs-identifier hs-var">ccs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1060"></span><span>
</span><span id="line-1061"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-type">MkProdE</span></a></span><span> </span><span id="local-6989586621680965611"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965611"><span class="hs-identifier hs-var">ls</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1062"></span><span>          </span><span class="hs-comment">-- ckoparkar: Shouldn't this check the types of things in ls</span><span>
</span><span id="line-1063"></span><span>          </span><span class="hs-comment">-- before recurring with a NoDest ? Some things in this list may</span><span>
</span><span id="line-1064"></span><span>          </span><span class="hs-comment">-- need fresh destinations. I think it's set up this way because</span><span>
</span><span id="line-1065"></span><span>          </span><span class="hs-comment">-- there's an assumption that things in a MkProdE will always be a</span><span>
</span><span id="line-1066"></span><span>          </span><span class="hs-comment">-- variable reference (because of ANF), and the AppE/DataConE cases</span><span>
</span><span id="line-1067"></span><span>          </span><span class="hs-comment">-- above will do the right thing.</span><span>
</span><span id="line-1068"></span><span>          </span><span id="local-6989586621680965612"><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965612"><span class="hs-identifier hs-var">lsrec</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; TiM Result)
-&gt; [Exp1] -&gt; ExceptT Failure (StateT InferState PassM) [Result]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680965613"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965613"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965613"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965611"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1069"></span><span>          </span><span id="local-6989586621680965614"><span class="annot"><span class="annottext">ty :: Ty2
</span><a href="#local-6989586621680965614"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680965615"><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965615"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Ty2 -&gt; TiM Ty2
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Ty2 -&gt; TiM Ty2)
-&gt; StateT InferState PassM Ty2 -&gt; TiM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; StateT InferState PassM Ty2
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Ty2 -&gt; StateT InferState PassM Ty2)
-&gt; PassM Ty2 -&gt; StateT InferState PassM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965336"><span class="hs-identifier hs-var">bty</span></a></span><span>
</span><span id="line-1070"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965616"><span class="annot"><span class="annottext">env' :: FullEnv
</span><a href="#local-6989586621680965616"><span class="hs-identifier hs-var hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965614"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-1071"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965617"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965617"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965618"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965618"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965619"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965619"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680965616"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965338"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-1072"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965620"><span class="annot"><span class="annottext">als :: [Exp2]
</span><a href="#local-6989586621680965620"><span class="hs-identifier hs-var hs-var">als</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965621"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680965621"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965621"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965612"><span class="hs-identifier hs-var">lsrec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1073"></span><span>              </span><span id="local-6989586621680965622"><span class="annot"><span class="annottext">acs :: [Constraint]
</span><a href="#local-6989586621680965622"><span class="hs-identifier hs-var hs-var">acs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Constraint]] -&gt; [Constraint]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">([[Constraint]] -&gt; [Constraint]) -&gt; [[Constraint]] -&gt; [Constraint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965623"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680965623"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965623"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965612"><span class="hs-identifier hs-var">lsrec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1074"></span><span>              </span><span id="local-6989586621680965624"><span class="annot"><span class="annottext">aty :: [Ty2]
</span><a href="#local-6989586621680965624"><span class="hs-identifier hs-var hs-var">aty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965625"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680965625"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965625"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Result]
</span><a href="#local-6989586621680965612"><span class="hs-identifier hs-var">lsrec</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1075"></span><span>           </span><span class="hs-comment">-- unify projection locations with variable type locations: this kind of does what copyTuple should be doing</span><span>
</span><span id="line-1076"></span><span>          </span><span id="local-6989586621680965626"><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680965626"><span class="hs-identifier hs-var">adests</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Ty2 -&gt; TiM Dest)
-&gt; [Ty2] -&gt; ExceptT Failure (StateT InferState PassM) [Dest]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; TiM Dest
</span><a href="Gibbon.Passes.InferLocations.html#destFromType%27"><span class="hs-identifier hs-var">destFromType'</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965615"><span class="hs-identifier hs-var">tys</span></a></span><span>
</span><span id="line-1077"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965627"><span class="annot"><span class="annottext">e' :: Exp2
</span><a href="#local-6989586621680965627"><span class="hs-identifier hs-var hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">L2.LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965614"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
[PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-var">L2.MkProdE</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965620"><span class="hs-identifier hs-var">als</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965617"><span class="hs-identifier hs-var">bod'</span></a></span><span>
</span><span id="line-1078"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965663"><span class="annot"><span class="annottext">go :: (Exp2, [Ty2])
-&gt; (Exp2, Ty2, Dest)
-&gt; ExceptT Failure (StateT InferState PassM) (Exp2, [Ty2])
</span><a href="#local-6989586621680965663"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680965664"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965664"><span class="hs-identifier hs-var">e''</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680965665"><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965665"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680965666"><span class="annot"><span class="annottext">r :: (Exp2, Ty2, Dest)
</span><a href="#local-6989586621680965666"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621680965667"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965667"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680965668"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965668"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680965669"><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680965669"><span class="hs-identifier hs-var">dt</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1079"></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965668"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1080"></span><span>                      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680965670"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965670"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680965669"><span class="hs-identifier hs-var">dt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1081"></span><span>                        </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#SingleDest"><span class="hs-identifier hs-type">SingleDest</span></a></span><span> </span><span id="local-6989586621680965671"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965671"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1082"></span><span>                          </span><span id="local-6989586621680965672"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965672"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Var -&gt; TiM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Var -&gt; TiM Var)
-&gt; StateT InferState PassM Var -&gt; TiM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Var -&gt; StateT InferState PassM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Var -&gt; StateT InferState PassM Var)
-&gt; PassM Var -&gt; StateT InferState PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-string">&quot;copyProj&quot;</span></span><span>
</span><span id="line-1083"></span><span>                          </span><span class="hs-special">(</span><span id="local-6989586621680965673"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965673"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680965674"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965674"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Var -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#copy"><span class="hs-identifier hs-var">copy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965667"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965668"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965671"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-1084"></span><span>                          </span><span class="annot"><span class="annottext">(Exp2, [Ty2])
-&gt; ExceptT Failure (StateT InferState PassM) (Exp2, [Ty2])
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">L2.LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965672"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965674"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965673"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965664"><span class="hs-identifier hs-var">e''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965668"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">Ty2 -&gt; [Ty2] -&gt; [Ty2]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965665"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1085"></span><span>                        </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TupleDest"><span class="hs-identifier hs-type">TupleDest</span></a></span><span> </span><span id="local-6989586621680965675"><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680965675"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1086"></span><span>                          </span><span class="annot"><span class="annottext">String -&gt; ExceptT Failure (StateT InferState PassM) (Exp2, [Ty2])
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ExceptT Failure (StateT InferState PassM) (Exp2, [Ty2]))
-&gt; String
-&gt; ExceptT Failure (StateT InferState PassM) (Exp2, [Ty2])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tupledest: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2, Ty2, Dest) -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2, Ty2, Dest)
</span><a href="#local-6989586621680965666"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; for &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965664"><span class="hs-identifier hs-var">e''</span></a></span><span>
</span><span id="line-1087"></span><span>                        </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Exp2, [Ty2])
-&gt; ExceptT Failure (StateT InferState PassM) (Exp2, [Ty2])
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965664"><span class="hs-identifier hs-var">e''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965665"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1088"></span><span>                      </span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Exp2, [Ty2])
-&gt; ExceptT Failure (StateT InferState PassM) (Exp2, [Ty2])
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965664"><span class="hs-identifier hs-var">e''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965665"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1089"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">L2.LetE</span></a></span><span> </span><span id="local-6989586621680965676"><span class="annot"><span class="annottext">bind :: (Var, [Var], Ty2, Exp2)
</span><a href="#local-6989586621680965676"><span class="hs-identifier hs-var">bind</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621680965677"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965677"><span class="hs-identifier hs-var">vr'</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Var]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680965678"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965678"><span class="hs-identifier hs-var">bod1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680965679"><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965679"><span class="hs-identifier hs-var">ty1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((Exp2, [Ty2])
 -&gt; (Exp2, Ty2, Dest)
 -&gt; ExceptT Failure (StateT InferState PassM) (Exp2, [Ty2]))
-&gt; (Exp2, [Ty2])
-&gt; [(Exp2, Ty2, Dest)]
-&gt; ExceptT Failure (StateT InferState PassM) (Exp2, [Ty2])
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Control.Monad.html#foldM"><span class="hs-identifier hs-var">foldM</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2, [Ty2])
-&gt; (Exp2, Ty2, Dest)
-&gt; ExceptT Failure (StateT InferState PassM) (Exp2, [Ty2])
</span><a href="#local-6989586621680965663"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965627"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965624"><span class="hs-identifier hs-var">aty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Exp2, Ty2, Dest)]
 -&gt; ExceptT Failure (StateT InferState PassM) (Exp2, [Ty2]))
-&gt; [(Exp2, Ty2, Dest)]
-&gt; ExceptT Failure (StateT InferState PassM) (Exp2, [Ty2])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2] -&gt; [Ty2] -&gt; [Dest] -&gt; [(Exp2, Ty2, Dest)]
forall a b c. [a] -&gt; [b] -&gt; [c] -&gt; [(a, b, c)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip3"><span class="hs-identifier hs-var">zip3</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965620"><span class="hs-identifier hs-var">als</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965624"><span class="hs-identifier hs-var">aty</span></a></span><span> </span><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680965626"><span class="hs-identifier hs-var">adests</span></a></span><span>
</span><span id="line-1090"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965681"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965681"><span class="hs-identifier hs-var">bod''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965682"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965682"><span class="hs-identifier hs-var">ty''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965683"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965683"><span class="hs-identifier hs-var">cs'''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964908"><span class="hs-identifier hs-var">handleTrailingBindLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965677"><span class="hs-identifier hs-var">vr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965678"><span class="hs-identifier hs-var">bod1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Ty2] -&gt; Ty2
forall loc. [UrTy loc] -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965679"><span class="hs-identifier hs-var">ty1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.OldList.html#nub"><span class="hs-identifier hs-var">L.nub</span></a></span><span> </span><span class="annot"><span class="annottext">([Constraint] -&gt; [Constraint]) -&gt; [Constraint] -&gt; [Constraint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965619"><span class="hs-identifier hs-var">cs'</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint] -&gt; [Constraint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965622"><span class="hs-identifier hs-var">acs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1091"></span><span>          </span><span id="local-6989586621680965684"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965684"><span class="hs-identifier hs-var">fcs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964832"><span class="hs-identifier hs-var">tryInRegion</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965683"><span class="hs-identifier hs-var">cs'''</span></a></span><span>
</span><span id="line-1092"></span><span>          </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
</span><a href="#local-6989586621680964807"><span class="hs-identifier hs-var">tryBindReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">L2.LetE</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2)
</span><a href="#local-6989586621680965676"><span class="hs-identifier hs-var">bind</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965681"><span class="hs-identifier hs-var">bod''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965682"><span class="hs-identifier hs-var">ty''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965684"><span class="hs-identifier hs-var">fcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1093"></span><span>
</span><span id="line-1094"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-type">WithArenaE</span></a></span><span> </span><span id="local-6989586621680965685"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965685"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680965686"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965686"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1095"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965687"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965687"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965688"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965688"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965689"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965689"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965685"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#ArenaTy"><span class="hs-identifier hs-var">ArenaTy</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965686"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span>
</span><span id="line-1096"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965690"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965690"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965691"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965691"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965692"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965692"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965688"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965338"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-1097"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965693"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965693"><span class="hs-identifier hs-var">bod''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965694"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965694"><span class="hs-identifier hs-var">ty''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965695"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965695"><span class="hs-identifier hs-var">cs''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964908"><span class="hs-identifier hs-var">handleTrailingBindLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965690"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965691"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.OldList.html#nub"><span class="hs-identifier hs-var">L.nub</span></a></span><span> </span><span class="annot"><span class="annottext">([Constraint] -&gt; [Constraint]) -&gt; [Constraint] -&gt; [Constraint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965689"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint] -&gt; [Constraint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965692"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1098"></span><span>          </span><span id="local-6989586621680965696"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965696"><span class="hs-identifier hs-var">vcs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; Ty2 -&gt; [Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964854"><span class="hs-identifier hs-var">tryNeedRegion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty2 -&gt; [Var]
</span><a href="Gibbon.L2.Syntax.html#locsInTy"><span class="hs-identifier hs-var">locsInTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965688"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965694"><span class="hs-identifier hs-var">ty''</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965695"><span class="hs-identifier hs-var">cs''</span></a></span><span>
</span><span id="line-1099"></span><span>          </span><span id="local-6989586621680965697"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965697"><span class="hs-identifier hs-var">fcs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964832"><span class="hs-identifier hs-var">tryInRegion</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965696"><span class="hs-identifier hs-var">vcs</span></a></span><span>
</span><span id="line-1100"></span><span>          </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
</span><a href="#local-6989586621680964807"><span class="hs-identifier hs-var">tryBindReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">L2.LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965688"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Var -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-var">WithArenaE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965685"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965687"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965693"><span class="hs-identifier hs-var">bod''</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1101"></span><span>                        </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965694"><span class="hs-identifier hs-var">ty''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965697"><span class="hs-identifier hs-var">fcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1102"></span><span>
</span><span id="line-1103"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-type">TimeIt</span></a></span><span> </span><span id="local-6989586621680965698"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965698"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680965699"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965699"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621680965700"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680965700"><span class="hs-identifier hs-var">b</span></a></span></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1104"></span><span>          </span><span id="local-6989586621680965701"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965701"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Var -&gt; TiM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Var -&gt; TiM Var)
-&gt; StateT InferState PassM Var -&gt; TiM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Var -&gt; StateT InferState PassM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Var -&gt; StateT InferState PassM Var)
-&gt; PassM Var -&gt; StateT InferState PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; PassM Var
</span><a href="Gibbon.Passes.InferLocations.html#freshLocVar"><span class="hs-identifier hs-var">freshLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;timeit&quot;</span></span><span>
</span><span id="line-1105"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965702"><span class="annot"><span class="annottext">subdest :: Dest
</span><a href="#local-6989586621680965702"><span class="hs-identifier hs-var hs-var">subdest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680965336"><span class="hs-identifier hs-var">bty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1106"></span><span>                          </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Dest
</span><a href="Gibbon.Passes.InferLocations.html#SingleDest"><span class="hs-identifier hs-var">SingleDest</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965701"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-1107"></span><span>                          </span><span class="annot"><span class="annottext">Ty1
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span>
</span><span id="line-1108"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965703"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965703"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965704"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965704"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965705"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965705"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965698"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680965702"><span class="hs-identifier hs-var">subdest</span></a></span><span>
</span><span id="line-1109"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965706"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965706"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965707"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965707"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965708"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965708"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965704"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965338"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-1110"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965709"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965709"><span class="hs-identifier hs-var">bod''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965710"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965710"><span class="hs-identifier hs-var">ty''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965711"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965711"><span class="hs-identifier hs-var">cs''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Result -&gt; TiM Result
</span><a href="#local-6989586621680964908"><span class="hs-identifier hs-var">handleTrailingBindLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965706"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965707"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.OldList.html#nub"><span class="hs-identifier hs-var">L.nub</span></a></span><span> </span><span class="annot"><span class="annottext">([Constraint] -&gt; [Constraint]) -&gt; [Constraint] -&gt; [Constraint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965705"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; [Constraint] -&gt; [Constraint]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965708"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1111"></span><span>          </span><span id="local-6989586621680965712"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965712"><span class="hs-identifier hs-var">vcs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; Ty2 -&gt; [Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964854"><span class="hs-identifier hs-var">tryNeedRegion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty2 -&gt; [Var]
</span><a href="Gibbon.L2.Syntax.html#locsInTy"><span class="hs-identifier hs-var">locsInTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965704"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965710"><span class="hs-identifier hs-var">ty''</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965711"><span class="hs-identifier hs-var">cs''</span></a></span><span>
</span><span id="line-1112"></span><span>          </span><span id="local-6989586621680965713"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965713"><span class="hs-identifier hs-var">fcs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Constraint] -&gt; TiM [Constraint]
</span><a href="#local-6989586621680964832"><span class="hs-identifier hs-var">tryInRegion</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965712"><span class="hs-identifier hs-var">vcs</span></a></span><span>
</span><span id="line-1113"></span><span>          </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
</span><a href="#local-6989586621680964807"><span class="hs-identifier hs-var">tryBindReg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">L2.LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965704"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2 -&gt; Ty2 -&gt; Bool -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec -&gt; dec -&gt; Bool -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-var">TimeIt</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965703"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965704"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680965700"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965709"><span class="hs-identifier hs-var">bod''</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1114"></span><span>                    </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965710"><span class="hs-identifier hs-var">ty''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965713"><span class="hs-identifier hs-var">fcs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1115"></span><span>
</span><span id="line-1116"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MapE"><span class="hs-identifier hs-type">MapE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span class="annot"><span class="annottext">(String -&gt; TiM Result) -&gt; String -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;MapE unsupported&quot;</span></span><span>
</span><span id="line-1117"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FoldE"><span class="hs-identifier hs-type">FoldE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span class="annot"><span class="annottext">(String -&gt; TiM Result) -&gt; String -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;FoldE unsupported&quot;</span></span><span>
</span><span id="line-1118"></span><span>
</span><span id="line-1119"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L1.Syntax.html#AddFixed"><span class="hs-identifier hs-type">L1.AddFixed</span></a></span><span> </span><span id="local-6989586621680965716"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965716"><span class="hs-identifier hs-var">cur</span></a></span></span><span> </span><span id="local-6989586621680965717"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965717"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1120"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965718"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965718"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965719"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965719"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965720"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965720"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965338"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-1121"></span><span>          </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">L2.LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#CursorTy"><span class="hs-identifier hs-var">L2.CursorTy</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">L2.Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Int -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; Int -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#AddFixed"><span class="hs-identifier hs-var">L2.AddFixed</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965716"><span class="hs-identifier hs-var">cur</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965717"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965718"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965719"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965720"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1122"></span><span>
</span><span id="line-1123"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L1.Syntax.html#StartOfPkdCursor"><span class="hs-identifier hs-type">L1.StartOfPkdCursor</span></a></span><span> </span><span id="local-6989586621680965721"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965721"><span class="hs-identifier hs-var">cur</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1124"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680965722"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965722"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965723"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965723"><span class="hs-identifier hs-var">ty'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965724"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965724"><span class="hs-identifier hs-var">cs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965338"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-1125"></span><span>          </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">L2.LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965334"><span class="hs-identifier hs-var">vr</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#CursorTy"><span class="hs-identifier hs-var">L2.CursorTy</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">L2.Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#StartOfPkdCursor"><span class="hs-identifier hs-var">L2.StartOfPkdCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965721"><span class="hs-identifier hs-var">cur</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965722"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965723"><span class="hs-identifier hs-var">ty'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680965724"><span class="hs-identifier hs-var">cs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1126"></span><span>
</span><span id="line-1127"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L1.Syntax.html#BenchE"><span class="hs-identifier hs-type">BenchE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;inferExp: BenchE not handled.&quot;</span></span><span>
</span><span id="line-1128"></span><span>
</span><span id="line-1129"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span class="annot"><span class="annottext">(String -&gt; TiM Result) -&gt; String -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Malformed let expression: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp1 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680964805"><span class="hs-identifier hs-var">ex0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1130"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MapE"><span class="hs-identifier hs-type">MapE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span class="annot"><span class="annottext">(String -&gt; TiM Result) -&gt; String -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;MapE unsupported&quot;</span></span><span>
</span><span id="line-1131"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FoldE"><span class="hs-identifier hs-type">FoldE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span class="annot"><span class="annottext">(String -&gt; TiM Result) -&gt; String -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;FoldE unsupported&quot;</span></span><span>
</span><span id="line-1132"></span><span>    </span><span class="hs-comment">-- Just-in-time convert this to TimeIt</span><span>
</span><span id="line-1133"></span><span>    </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L1.Syntax.html#BenchE"><span class="hs-identifier hs-type">BenchE</span></a></span><span> </span><span id="local-6989586621680965727"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965727"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621680965728"><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680965728"><span class="hs-identifier hs-var">locs</span></a></span></span><span> </span><span id="local-6989586621680965729"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965729"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621680965730"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680965730"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1134"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680965731"><span class="annot"><span class="annottext">fn_ty :: ArrowTy2 Ty2
</span><a href="#local-6989586621680965731"><span class="hs-identifier hs-var hs-var">fn_ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; FullEnv -&gt; ArrowTy2 Ty2
</span><a href="Gibbon.Passes.InferLocations.html#lookupFEnv"><span class="hs-identifier hs-var">lookupFEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965727"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-1135"></span><span>          </span><span class="annot"><a href="#local-6989586621680965732"><span class="hs-identifier hs-type">retty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span>
</span><span id="line-1136"></span><span>          </span><span id="local-6989586621680965732"><span class="annot"><span class="annottext">retty :: Ty2
</span><a href="#local-6989586621680965732"><span class="hs-identifier hs-var hs-var">retty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArrowTy Ty2 -&gt; Ty2
forall ty. FunctionTy ty =&gt; ArrowTy ty -&gt; ty
</span><a href="Gibbon.Language.Syntax.html#outTy"><span class="hs-identifier hs-var">outTy</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy Ty2
ArrowTy2 Ty2
</span><a href="#local-6989586621680965731"><span class="hs-identifier hs-var">fn_ty</span></a></span><span>
</span><span id="line-1137"></span><span>          </span><span id="local-6989586621680965734"><span class="annot"><span class="annottext">e' :: Exp1
</span><a href="#local-6989586621680965734"><span class="hs-identifier hs-var hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; Ty1 -&gt; Bool -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec -&gt; dec -&gt; Bool -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-var">TimeIt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [()] -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965727"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680965728"><span class="hs-identifier hs-var">locs</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680965729"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty2 -&gt; Ty1
forall a. UrTy a -&gt; Ty1
</span><a href="Gibbon.Language.html#stripTyLocs"><span class="hs-identifier hs-var">stripTyLocs</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965732"><span class="hs-identifier hs-var">retty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680965730"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1138"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">FullEnv -&gt; Exp1 -&gt; Dest -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#inferExp"><span class="hs-identifier hs-var">inferExp</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680964803"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680965734"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680964806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-1139"></span><span>
</span><span id="line-1140"></span><span>
</span><span id="line-1141"></span><span class="hs-comment">-- TODO: Should eventually allow src and dest regions to be the same</span><span>
</span><span id="line-1142"></span><span class="hs-comment">-- for in-place updates packed data with linear types.</span><span>
</span><span id="line-1143"></span><span>
</span><span id="line-1144"></span><span class="hs-comment">-- | Transforms an expression by updating all locations to their final mapping</span><span>
</span><span id="line-1145"></span><span class="hs-comment">-- as a result of unification.</span><span>
</span><span id="line-1146"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#finishExp"><span class="hs-identifier hs-type">finishExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">Exp2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">Exp2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1147"></span><span id="finishExp"><span class="annot"><span class="annottext">finishExp :: Exp2 -&gt; TiM Exp2
</span><a href="Gibbon.Passes.InferLocations.html#finishExp"><span class="hs-identifier hs-var hs-var">finishExp</span></a></span></span><span> </span><span id="local-6989586621680965874"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965874"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-1148"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965874"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1149"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span id="local-6989586621680965875"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965875"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2) -&gt; Exp2 -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965875"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1150"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-type">LitE</span></a></span><span> </span><span id="local-6989586621680965876"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965876"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2) -&gt; Exp2 -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Int -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-var">LitE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965876"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1151"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CharE"><span class="hs-identifier hs-type">CharE</span></a></span><span> </span><span id="local-6989586621680965877"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680965877"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2) -&gt; Exp2 -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Char -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CharE"><span class="hs-identifier hs-var">CharE</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680965877"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1152"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-type">FloatE</span></a></span><span> </span><span id="local-6989586621680965878"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680965878"><span class="hs-identifier hs-var">i</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2) -&gt; Exp2 -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Double -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-var">FloatE</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680965878"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-1153"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-type">LitSymE</span></a></span><span> </span><span id="local-6989586621680965879"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965879"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2) -&gt; Exp2 -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-var">LitSymE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965879"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1154"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span id="local-6989586621680965880"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965880"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680965881"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965881"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621680965882"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965882"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1155"></span><span>             </span><span id="local-6989586621680965883"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965883"><span class="hs-identifier hs-var">es'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2)
-&gt; [Exp2] -&gt; ExceptT Failure (StateT InferState PassM) [Exp2]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
</span><a href="Gibbon.Passes.InferLocations.html#finishExp"><span class="hs-identifier hs-var">finishExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965882"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1156"></span><span>             </span><span id="local-6989586621680965884"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965884"><span class="hs-identifier hs-var">ls'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; TiM Var)
-&gt; [Var] -&gt; ExceptT Failure (StateT InferState PassM) [Var]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965881"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1157"></span><span>             </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2) -&gt; Exp2 -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965880"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965884"><span class="hs-identifier hs-var">ls'</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965883"><span class="hs-identifier hs-var">es'</span></a></span><span>
</span><span id="line-1158"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span id="local-6989586621680965885"><span class="annot"><span class="annottext">Prim Ty2
</span><a href="#local-6989586621680965885"><span class="hs-identifier hs-var">pr</span></a></span></span><span> </span><span id="local-6989586621680965886"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965886"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1159"></span><span>             </span><span id="local-6989586621680965887"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965887"><span class="hs-identifier hs-var">es'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2)
-&gt; [Exp2] -&gt; ExceptT Failure (StateT InferState PassM) [Exp2]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
</span><a href="Gibbon.Passes.InferLocations.html#finishExp"><span class="hs-identifier hs-var">finishExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965886"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1160"></span><span>             </span><span id="local-6989586621680965888"><span class="annot"><span class="annottext">Prim Ty2
</span><a href="#local-6989586621680965888"><span class="hs-identifier hs-var">pr'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2)
</span><a href="Gibbon.Passes.InferLocations.html#finishPr"><span class="hs-identifier hs-var">finishPr</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
</span><a href="#local-6989586621680965885"><span class="hs-identifier hs-var">pr</span></a></span><span>
</span><span id="line-1161"></span><span>             </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2) -&gt; Exp2 -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
</span><a href="#local-6989586621680965888"><span class="hs-identifier hs-var">pr'</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965887"><span class="hs-identifier hs-var">es'</span></a></span><span>
</span><span id="line-1162"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680965890"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965890"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965891"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965891"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965892"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965892"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965893"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965893"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680965894"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965894"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1163"></span><span>             </span><span id="local-6989586621680965895"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965895"><span class="hs-identifier hs-var">e1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
</span><a href="Gibbon.Passes.InferLocations.html#finishExp"><span class="hs-identifier hs-var">finishExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965893"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-1164"></span><span>             </span><span id="local-6989586621680965896"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965896"><span class="hs-identifier hs-var">e2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
</span><a href="Gibbon.Passes.InferLocations.html#finishExp"><span class="hs-identifier hs-var">finishExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965894"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-1165"></span><span>             </span><span id="local-6989586621680965897"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965897"><span class="hs-identifier hs-var">ls'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; TiM Var)
-&gt; [Var] -&gt; ExceptT Failure (StateT InferState PassM) [Var]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965891"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1166"></span><span>             </span><span id="local-6989586621680965898"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965898"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; TiM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#finishTy"><span class="hs-identifier hs-var">finishTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965892"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1167"></span><span>             </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2) -&gt; Exp2 -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965890"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965897"><span class="hs-identifier hs-var">ls'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965898"><span class="hs-identifier hs-var">t'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965895"><span class="hs-identifier hs-var">e1'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965896"><span class="hs-identifier hs-var">e2'</span></a></span><span>
</span><span id="line-1168"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-type">IfE</span></a></span><span> </span><span id="local-6989586621680965900"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965900"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680965901"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965901"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span id="local-6989586621680965902"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965902"><span class="hs-identifier hs-var">e3</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1169"></span><span>             </span><span id="local-6989586621680965903"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965903"><span class="hs-identifier hs-var">e1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
</span><a href="Gibbon.Passes.InferLocations.html#finishExp"><span class="hs-identifier hs-var">finishExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965900"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-1170"></span><span>             </span><span id="local-6989586621680965904"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965904"><span class="hs-identifier hs-var">e2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
</span><a href="Gibbon.Passes.InferLocations.html#finishExp"><span class="hs-identifier hs-var">finishExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965901"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-1171"></span><span>             </span><span id="local-6989586621680965905"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965905"><span class="hs-identifier hs-var">e3'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
</span><a href="Gibbon.Passes.InferLocations.html#finishExp"><span class="hs-identifier hs-var">finishExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965902"><span class="hs-identifier hs-var">e3</span></a></span><span>
</span><span id="line-1172"></span><span>             </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2) -&gt; Exp2 -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; Exp2 -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-var">IfE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965903"><span class="hs-identifier hs-var">e1'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965904"><span class="hs-identifier hs-var">e2'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965905"><span class="hs-identifier hs-var">e3'</span></a></span><span>
</span><span id="line-1173"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-type">MkProdE</span></a></span><span> </span><span id="local-6989586621680965906"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965906"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1174"></span><span>             </span><span id="local-6989586621680965907"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965907"><span class="hs-identifier hs-var">es'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2)
-&gt; [Exp2] -&gt; ExceptT Failure (StateT InferState PassM) [Exp2]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
</span><a href="Gibbon.Passes.InferLocations.html#finishExp"><span class="hs-identifier hs-var">finishExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965906"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1175"></span><span>             </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2) -&gt; Exp2 -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
[PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-var">MkProdE</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965907"><span class="hs-identifier hs-var">es'</span></a></span><span>
</span><span id="line-1176"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-type">ProjE</span></a></span><span> </span><span id="local-6989586621680965908"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965908"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680965909"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965909"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1177"></span><span>             </span><span id="local-6989586621680965910"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965910"><span class="hs-identifier hs-var">e1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
</span><a href="Gibbon.Passes.InferLocations.html#finishExp"><span class="hs-identifier hs-var">finishExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965909"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-1178"></span><span>             </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2) -&gt; Exp2 -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Int -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-var">ProjE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965908"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965910"><span class="hs-identifier hs-var">e1'</span></a></span><span>
</span><span id="line-1179"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-type">CaseE</span></a></span><span> </span><span id="local-6989586621680965911"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965911"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680965912"><span class="annot"><span class="annottext">[(String, [(Var, Var)], Exp2)]
</span><a href="#local-6989586621680965912"><span class="hs-identifier hs-var">prs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1180"></span><span>             </span><span id="local-6989586621680965913"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965913"><span class="hs-identifier hs-var">e1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
</span><a href="Gibbon.Passes.InferLocations.html#finishExp"><span class="hs-identifier hs-var">finishExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965911"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-1181"></span><span>             </span><span id="local-6989586621680965914"><span class="annot"><span class="annottext">[(String, [(Var, Var)], Exp2)]
</span><a href="#local-6989586621680965914"><span class="hs-identifier hs-var">prs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(String, [(Var, Var)], Exp2)]
-&gt; ((String, [(Var, Var)], Exp2)
    -&gt; ExceptT
         Failure (StateT InferState PassM) (String, [(Var, Var)], Exp2))
-&gt; ExceptT
     Failure (StateT InferState PassM) [(String, [(Var, Var)], Exp2)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#forM"><span class="hs-identifier hs-var">forM</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, [(Var, Var)], Exp2)]
</span><a href="#local-6989586621680965912"><span class="hs-identifier hs-var">prs</span></a></span><span> </span><span class="annot"><span class="annottext">(((String, [(Var, Var)], Exp2)
  -&gt; ExceptT
       Failure (StateT InferState PassM) (String, [(Var, Var)], Exp2))
 -&gt; ExceptT
      Failure (StateT InferState PassM) [(String, [(Var, Var)], Exp2)])
-&gt; ((String, [(Var, Var)], Exp2)
    -&gt; ExceptT
         Failure (StateT InferState PassM) (String, [(Var, Var)], Exp2))
-&gt; ExceptT
     Failure (StateT InferState PassM) [(String, [(Var, Var)], Exp2)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680965915"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965915"><span class="hs-identifier hs-var">dc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680965916"><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680965916"><span class="hs-identifier hs-var">lvs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680965917"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965917"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1182"></span><span>                         </span><span id="local-6989586621680965918"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965918"><span class="hs-identifier hs-var">e2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
</span><a href="Gibbon.Passes.InferLocations.html#finishExp"><span class="hs-identifier hs-var">finishExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965917"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-1183"></span><span>                         </span><span id="local-6989586621680965919"><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680965919"><span class="hs-identifier hs-var">lvs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Var, Var)]
-&gt; ((Var, Var)
    -&gt; ExceptT Failure (StateT InferState PassM) (Var, Var))
-&gt; ExceptT Failure (StateT InferState PassM) [(Var, Var)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#forM"><span class="hs-identifier hs-var">forM</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680965916"><span class="hs-identifier hs-var">lvs</span></a></span><span> </span><span class="annot"><span class="annottext">(((Var, Var)
  -&gt; ExceptT Failure (StateT InferState PassM) (Var, Var))
 -&gt; ExceptT Failure (StateT InferState PassM) [(Var, Var)])
-&gt; ((Var, Var)
    -&gt; ExceptT Failure (StateT InferState PassM) (Var, Var))
-&gt; ExceptT Failure (StateT InferState PassM) [(Var, Var)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680965920"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965920"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680965921"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965921"><span class="hs-identifier hs-var">lv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1184"></span><span>                                                    </span><span id="local-6989586621680965922"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965922"><span class="hs-identifier hs-var">lv'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965921"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-1185"></span><span>                                                    </span><span class="annot"><span class="annottext">(Var, Var) -&gt; ExceptT Failure (StateT InferState PassM) (Var, Var)
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965920"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965922"><span class="hs-identifier hs-var">lv'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1186"></span><span>                         </span><span class="annot"><span class="annottext">(String, [(Var, Var)], Exp2)
-&gt; ExceptT
     Failure (StateT InferState PassM) (String, [(Var, Var)], Exp2)
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965915"><span class="hs-identifier hs-var">dc</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680965919"><span class="hs-identifier hs-var">lvs'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965918"><span class="hs-identifier hs-var">e2'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1187"></span><span>             </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2) -&gt; Exp2 -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; [(String, [(Var, Var)], Exp2)] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; [(String, [(Var, loc)], PreExp ext loc dec)]
-&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-var">CaseE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965913"><span class="hs-identifier hs-var">e1'</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, [(Var, Var)], Exp2)]
</span><a href="#local-6989586621680965914"><span class="hs-identifier hs-var">prs'</span></a></span><span>
</span><span id="line-1188"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-type">DataConE</span></a></span><span> </span><span id="local-6989586621680965923"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965923"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span id="local-6989586621680965924"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965924"><span class="hs-identifier hs-var">dc</span></a></span></span><span> </span><span id="local-6989586621680965925"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965925"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1189"></span><span>             </span><span id="local-6989586621680965926"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965926"><span class="hs-identifier hs-var">es'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2)
-&gt; [Exp2] -&gt; ExceptT Failure (StateT InferState PassM) [Exp2]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
</span><a href="Gibbon.Passes.InferLocations.html#finishExp"><span class="hs-identifier hs-var">finishExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965925"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1190"></span><span>             </span><span id="local-6989586621680965927"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965927"><span class="hs-identifier hs-var">lv'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965923"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-1191"></span><span>             </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2) -&gt; Exp2 -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; String -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
loc -&gt; String -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-var">DataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965927"><span class="hs-identifier hs-var">lv'</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965924"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965926"><span class="hs-identifier hs-var">es'</span></a></span><span>
</span><span id="line-1192"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-type">TimeIt</span></a></span><span> </span><span id="local-6989586621680965928"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965928"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680965929"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965929"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621680965930"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680965930"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1193"></span><span>             </span><span id="local-6989586621680965931"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965931"><span class="hs-identifier hs-var">e1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
</span><a href="Gibbon.Passes.InferLocations.html#finishExp"><span class="hs-identifier hs-var">finishExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965928"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-1194"></span><span>             </span><span id="local-6989586621680965932"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965932"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965929"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1195"></span><span>                     </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span id="local-6989586621680965933"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965933"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680965934"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965934"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1196"></span><span>                         </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680965935"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965935"><span class="hs-identifier hs-var">lv'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965934"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-1197"></span><span>                            </span><span class="annot"><span class="annottext">Ty2 -&gt; TiM Ty2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Ty2 -&gt; TiM Ty2) -&gt; Ty2 -&gt; TiM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Var -&gt; Ty2
forall loc. String -&gt; loc -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-var">PackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965933"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965935"><span class="hs-identifier hs-var">lv'</span></a></span><span>
</span><span id="line-1198"></span><span>                     </span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; TiM Ty2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965929"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1199"></span><span>             </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2) -&gt; Exp2 -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; Ty2 -&gt; Bool -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec -&gt; dec -&gt; Bool -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-var">TimeIt</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965931"><span class="hs-identifier hs-var">e1'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965932"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680965930"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1200"></span><span>
</span><span id="line-1201"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-type">SpawnE</span></a></span><span> </span><span id="local-6989586621680965936"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965936"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680965937"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965937"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621680965938"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965938"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1202"></span><span>        </span><span id="local-6989586621680965939"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965939"><span class="hs-identifier hs-var">es'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2)
-&gt; [Exp2] -&gt; ExceptT Failure (StateT InferState PassM) [Exp2]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
</span><a href="Gibbon.Passes.InferLocations.html#finishExp"><span class="hs-identifier hs-var">finishExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965938"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1203"></span><span>        </span><span id="local-6989586621680965940"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965940"><span class="hs-identifier hs-var">ls'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; TiM Var)
-&gt; [Var] -&gt; ExceptT Failure (StateT InferState PassM) [Var]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965937"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1204"></span><span>        </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2) -&gt; Exp2 -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-var">SpawnE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965936"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680965940"><span class="hs-identifier hs-var">ls'</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680965939"><span class="hs-identifier hs-var">es'</span></a></span><span>
</span><span id="line-1205"></span><span>
</span><span id="line-1206"></span><span>      </span><span class="annot"><span class="annottext">Exp2
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2) -&gt; Exp2 -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span>
</span><span id="line-1207"></span><span>
</span><span id="line-1208"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-type">WithArenaE</span></a></span><span> </span><span id="local-6989586621680965941"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965941"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680965942"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965942"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1209"></span><span>             </span><span id="local-6989586621680965943"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965943"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
</span><a href="Gibbon.Passes.InferLocations.html#finishExp"><span class="hs-identifier hs-var">finishExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965942"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1210"></span><span>             </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2) -&gt; Exp2 -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-var">WithArenaE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965941"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965943"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-1211"></span><span>
</span><span id="line-1212"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetRegionE"><span class="hs-identifier hs-type">LetRegionE</span></a></span><span> </span><span id="local-6989586621680965944"><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680965944"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680965945"><span class="annot"><span class="annottext">RegionSize
</span><a href="#local-6989586621680965945"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span id="local-6989586621680965946"><span class="annot"><span class="annottext">Maybe RegionType
</span><a href="#local-6989586621680965946"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680965947"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965947"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1213"></span><span>             </span><span id="local-6989586621680965948"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965948"><span class="hs-identifier hs-var">e1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
</span><a href="Gibbon.Passes.InferLocations.html#finishExp"><span class="hs-identifier hs-var">finishExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965947"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-1214"></span><span>             </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2) -&gt; Exp2 -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Region -&gt; RegionSize -&gt; Maybe RegionType -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec.
Region
-&gt; RegionSize -&gt; Maybe RegionType -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetRegionE"><span class="hs-identifier hs-var">LetRegionE</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680965944"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">RegionSize
</span><a href="#local-6989586621680965945"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RegionType
</span><a href="#local-6989586621680965946"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965948"><span class="hs-identifier hs-var">e1'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1215"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-type">LetLocE</span></a></span><span> </span><span id="local-6989586621680965949"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965949"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621680965950"><span class="annot"><span class="annottext">PreLocExp Var
</span><a href="#local-6989586621680965950"><span class="hs-identifier hs-var">lex</span></a></span></span><span> </span><span id="local-6989586621680965951"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965951"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1216"></span><span>             </span><span id="local-6989586621680965952"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965952"><span class="hs-identifier hs-var">e1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
</span><a href="Gibbon.Passes.InferLocations.html#finishExp"><span class="hs-identifier hs-var">finishExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965951"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-1217"></span><span>             </span><span id="local-6989586621680965953"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965953"><span class="hs-identifier hs-var">loc'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965949"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-1218"></span><span>             </span><span id="local-6989586621680965954"><span class="annot"><span class="annottext">PreLocExp Var
</span><a href="#local-6989586621680965954"><span class="hs-identifier hs-var">lex'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PreLocExp Var
</span><a href="#local-6989586621680965950"><span class="hs-identifier hs-var">lex</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1219"></span><span>                       </span><span class="annot"><a href="Gibbon.L2.Syntax.html#AfterConstantLE"><span class="hs-identifier hs-type">AfterConstantLE</span></a></span><span> </span><span id="local-6989586621680965955"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965955"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680965956"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965956"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1220"></span><span>                                    </span><span id="local-6989586621680965957"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965957"><span class="hs-identifier hs-var">lv'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965956"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-1221"></span><span>                                    </span><span class="annot"><span class="annottext">PreLocExp Var
-&gt; ExceptT Failure (StateT InferState PassM) (PreLocExp Var)
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(PreLocExp Var
 -&gt; ExceptT Failure (StateT InferState PassM) (PreLocExp Var))
-&gt; PreLocExp Var
-&gt; ExceptT Failure (StateT InferState PassM) (PreLocExp Var)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Var -&gt; PreLocExp Var
forall loc. Int -&gt; loc -&gt; PreLocExp loc
</span><a href="Gibbon.L2.Syntax.html#AfterConstantLE"><span class="hs-identifier hs-var">AfterConstantLE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965955"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965957"><span class="hs-identifier hs-var">lv'</span></a></span><span>
</span><span id="line-1222"></span><span>                       </span><span class="annot"><a href="Gibbon.L2.Syntax.html#AfterVariableLE"><span class="hs-identifier hs-type">AfterVariableLE</span></a></span><span> </span><span id="local-6989586621680965958"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965958"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680965959"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965959"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span id="local-6989586621680965960"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680965960"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1223"></span><span>                                    </span><span id="local-6989586621680965961"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965961"><span class="hs-identifier hs-var">lv'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965959"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-1224"></span><span>                                    </span><span class="annot"><span class="annottext">PreLocExp Var
-&gt; ExceptT Failure (StateT InferState PassM) (PreLocExp Var)
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(PreLocExp Var
 -&gt; ExceptT Failure (StateT InferState PassM) (PreLocExp Var))
-&gt; PreLocExp Var
-&gt; ExceptT Failure (StateT InferState PassM) (PreLocExp Var)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Bool -&gt; PreLocExp Var
forall loc. Var -&gt; loc -&gt; Bool -&gt; PreLocExp loc
</span><a href="Gibbon.L2.Syntax.html#AfterVariableLE"><span class="hs-identifier hs-var">AfterVariableLE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965958"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965961"><span class="hs-identifier hs-var">lv'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680965960"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1225"></span><span>                       </span><span id="local-6989586621680965962"><span class="annot"><span class="annottext">PreLocExp Var
</span><a href="#local-6989586621680965962"><span class="hs-identifier hs-var">oth</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PreLocExp Var
-&gt; ExceptT Failure (StateT InferState PassM) (PreLocExp Var)
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">PreLocExp Var
</span><a href="#local-6989586621680965962"><span class="hs-identifier hs-var">oth</span></a></span><span>
</span><span id="line-1226"></span><span>             </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2) -&gt; Exp2 -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; PreLocExp Var -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; PreLocExp loc -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-var">LetLocE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965953"><span class="hs-identifier hs-var">loc'</span></a></span><span> </span><span class="annot"><span class="annottext">PreLocExp Var
</span><a href="#local-6989586621680965954"><span class="hs-identifier hs-var">lex'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965952"><span class="hs-identifier hs-var">e1'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1227"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#AddFixed"><span class="hs-identifier hs-type">L2.AddFixed</span></a></span><span> </span><span id="local-6989586621680965963"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965963"><span class="hs-identifier hs-var">cur</span></a></span></span><span> </span><span id="local-6989586621680965964"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965964"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2) -&gt; Exp2 -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Int -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; Int -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#AddFixed"><span class="hs-identifier hs-var">L2.AddFixed</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965963"><span class="hs-identifier hs-var">cur</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680965964"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1228"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#StartOfPkdCursor"><span class="hs-identifier hs-type">L2.StartOfPkdCursor</span></a></span><span> </span><span id="local-6989586621680965965"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965965"><span class="hs-identifier hs-var">cur</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2) -&gt; Exp2 -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#StartOfPkdCursor"><span class="hs-identifier hs-var">L2.StartOfPkdCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965965"><span class="hs-identifier hs-var">cur</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1229"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#TagCursor"><span class="hs-identifier hs-type">L2.TagCursor</span></a></span><span> </span><span id="local-6989586621680965967"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965967"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680965968"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965968"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; TiM Exp2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; TiM Exp2) -&gt; Exp2 -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; Var -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#TagCursor"><span class="hs-identifier hs-var">L2.TagCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965967"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965968"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1230"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetParRegionE"><span class="hs-identifier hs-type">LetParRegionE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Exp2
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TiM Exp2) -&gt; String -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;todo: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965874"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1231"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#RetE"><span class="hs-identifier hs-type">RetE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Exp2
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TiM Exp2) -&gt; String -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;todo: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965874"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1232"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#FromEndE"><span class="hs-identifier hs-type">FromEndE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Exp2
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TiM Exp2) -&gt; String -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;todo: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965874"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1233"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#BoundsCheck"><span class="hs-identifier hs-type">BoundsCheck</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Exp2
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TiM Exp2) -&gt; String -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;todo: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965874"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1234"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#IndirectionE"><span class="hs-identifier hs-type">IndirectionE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Exp2
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TiM Exp2) -&gt; String -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;todo: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965874"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1235"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#GetCilkWorkerNum"><span class="hs-identifier hs-type">GetCilkWorkerNum</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Exp2
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TiM Exp2) -&gt; String -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;todo: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965874"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1236"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetAvail"><span class="hs-identifier hs-type">LetAvail</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Exp2
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TiM Exp2) -&gt; String -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;todo: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965874"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1237"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#AllocateTagHere"><span class="hs-identifier hs-type">AllocateTagHere</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Exp2
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TiM Exp2) -&gt; String -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;todo: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965874"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1238"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#AllocateScalarsHere"><span class="hs-identifier hs-type">AllocateScalarsHere</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Exp2
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TiM Exp2) -&gt; String -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;todo: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965874"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1239"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#SSPush"><span class="hs-identifier hs-type">SSPush</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Exp2
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TiM Exp2) -&gt; String -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;todo: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965874"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1240"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#SSPop"><span class="hs-identifier hs-type">SSPop</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Exp2
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TiM Exp2) -&gt; String -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;todo: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680965874"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1241"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MapE"><span class="hs-identifier hs-type">MapE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Exp2
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span class="annot"><span class="annottext">(String -&gt; TiM Exp2) -&gt; String -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;MapE not supported&quot;</span></span><span>
</span><span id="line-1242"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FoldE"><span class="hs-identifier hs-type">FoldE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Exp2
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span class="annot"><span class="annottext">(String -&gt; TiM Exp2) -&gt; String -&gt; TiM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;FoldE not supported&quot;</span></span><span>
</span><span id="line-1243"></span><span>
</span><span id="line-1244"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#finishTy"><span class="hs-identifier hs-type">finishTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span>
</span><span id="line-1245"></span><span id="finishTy"><span class="annot"><span class="annottext">finishTy :: Ty2 -&gt; TiM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#finishTy"><span class="hs-identifier hs-var hs-var">finishTy</span></a></span></span><span> </span><span id="local-6989586621680965989"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965989"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1246"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965989"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1247"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span id="local-6989586621680965990"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965990"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680965991"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965991"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1248"></span><span>          </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680965992"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965992"><span class="hs-identifier hs-var">lv'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965991"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-1249"></span><span>             </span><span class="annot"><span class="annottext">Ty2 -&gt; TiM Ty2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Ty2 -&gt; TiM Ty2) -&gt; Ty2 -&gt; TiM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Var -&gt; Ty2
forall loc. String -&gt; loc -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-var">PackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680965990"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680965992"><span class="hs-identifier hs-var">lv'</span></a></span><span>
</span><span id="line-1250"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680965993"><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965993"><span class="hs-identifier hs-var">pls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1251"></span><span>           </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680965994"><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965994"><span class="hs-identifier hs-var">pls'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Ty2 -&gt; TiM Ty2)
-&gt; [Ty2] -&gt; ExceptT Failure (StateT InferState PassM) [Ty2]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; TiM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#finishTy"><span class="hs-identifier hs-var">finishTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965993"><span class="hs-identifier hs-var">pls</span></a></span><span>
</span><span id="line-1252"></span><span>              </span><span class="annot"><span class="annottext">Ty2 -&gt; TiM Ty2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Ty2 -&gt; TiM Ty2) -&gt; Ty2 -&gt; TiM Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2] -&gt; Ty2
forall loc. [UrTy loc] -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680965994"><span class="hs-identifier hs-var">pls'</span></a></span><span>
</span><span id="line-1253"></span><span>      </span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; TiM Ty2
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680965989"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-1254"></span><span>
</span><span id="line-1255"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#finishPr"><span class="hs-identifier hs-type">finishPr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1256"></span><span id="finishPr"><span class="annot"><span class="annottext">finishPr :: Prim Ty2 -&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2)
</span><a href="Gibbon.Passes.InferLocations.html#finishPr"><span class="hs-identifier hs-var hs-var">finishPr</span></a></span></span><span> </span><span id="local-6989586621680966006"><span class="annot"><span class="annottext">Prim Ty2
</span><a href="#local-6989586621680966006"><span class="hs-identifier hs-var">pr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1257"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Prim Ty2
</span><a href="#local-6989586621680966006"><span class="hs-identifier hs-var">pr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1258"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DictInsertP"><span class="hs-identifier hs-type">DictInsertP</span></a></span><span> </span><span id="local-6989586621680966007"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966007"><span class="hs-identifier hs-var">bty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; TiM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#finishTy"><span class="hs-identifier hs-var">finishTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966007"><span class="hs-identifier hs-var">bty</span></a></span><span> </span><span class="annot"><span class="annottext">TiM Ty2
-&gt; (Ty2 -&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2))
-&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2)
forall a b.
ExceptT Failure (StateT InferState PassM) a
-&gt; (a -&gt; ExceptT Failure (StateT InferState PassM) b)
-&gt; ExceptT Failure (StateT InferState PassM) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2)
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2))
-&gt; (Ty2 -&gt; Prim Ty2)
-&gt; Ty2
-&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#DictInsertP"><span class="hs-identifier hs-var">DictInsertP</span></a></span><span>
</span><span id="line-1259"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DictLookupP"><span class="hs-identifier hs-type">DictLookupP</span></a></span><span> </span><span id="local-6989586621680966008"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966008"><span class="hs-identifier hs-var">bty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; TiM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#finishTy"><span class="hs-identifier hs-var">finishTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966008"><span class="hs-identifier hs-var">bty</span></a></span><span> </span><span class="annot"><span class="annottext">TiM Ty2
-&gt; (Ty2 -&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2))
-&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2)
forall a b.
ExceptT Failure (StateT InferState PassM) a
-&gt; (a -&gt; ExceptT Failure (StateT InferState PassM) b)
-&gt; ExceptT Failure (StateT InferState PassM) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2)
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2))
-&gt; (Ty2 -&gt; Prim Ty2)
-&gt; Ty2
-&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#DictLookupP"><span class="hs-identifier hs-var">DictLookupP</span></a></span><span>
</span><span id="line-1260"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DictEmptyP"><span class="hs-identifier hs-type">DictEmptyP</span></a></span><span> </span><span id="local-6989586621680966009"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966009"><span class="hs-identifier hs-var">bty</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; TiM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#finishTy"><span class="hs-identifier hs-var">finishTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966009"><span class="hs-identifier hs-var">bty</span></a></span><span> </span><span class="annot"><span class="annottext">TiM Ty2
-&gt; (Ty2 -&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2))
-&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2)
forall a b.
ExceptT Failure (StateT InferState PassM) a
-&gt; (a -&gt; ExceptT Failure (StateT InferState PassM) b)
-&gt; ExceptT Failure (StateT InferState PassM) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2)
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2))
-&gt; (Ty2 -&gt; Prim Ty2)
-&gt; Ty2
-&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#DictEmptyP"><span class="hs-identifier hs-var">DictEmptyP</span></a></span><span>
</span><span id="line-1261"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DictHasKeyP"><span class="hs-identifier hs-type">DictHasKeyP</span></a></span><span> </span><span id="local-6989586621680966010"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966010"><span class="hs-identifier hs-var">bty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; TiM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#finishTy"><span class="hs-identifier hs-var">finishTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966010"><span class="hs-identifier hs-var">bty</span></a></span><span> </span><span class="annot"><span class="annottext">TiM Ty2
-&gt; (Ty2 -&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2))
-&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2)
forall a b.
ExceptT Failure (StateT InferState PassM) a
-&gt; (a -&gt; ExceptT Failure (StateT InferState PassM) b)
-&gt; ExceptT Failure (StateT InferState PassM) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2)
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2))
-&gt; (Ty2 -&gt; Prim Ty2)
-&gt; Ty2
-&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#DictHasKeyP"><span class="hs-identifier hs-var">DictHasKeyP</span></a></span><span>
</span><span id="line-1262"></span><span>      </span><span class="annot"><span class="annottext">Prim Ty2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; ExceptT Failure (StateT InferState PassM) (Prim Ty2)
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
</span><a href="#local-6989586621680966006"><span class="hs-identifier hs-var">pr</span></a></span><span>
</span><span id="line-1263"></span><span>
</span><span id="line-1264"></span><span class="hs-comment">-- | Remove unused location bindings</span><span>
</span><span id="line-1265"></span><span class="hs-comment">-- Returns pair of (new exp, set of free locations)</span><span>
</span><span id="line-1266"></span><span class="hs-comment">-- TODO: avoid generating location bindings for immediate values</span><span>
</span><span id="line-1267"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-type">cleanExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">Exp2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">Exp2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1268"></span><span id="cleanExp"><span class="annot"><span class="annottext">cleanExp :: Exp2 -&gt; (Exp2, Set Var)
</span><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-var hs-var">cleanExp</span></a></span></span><span> </span><span id="local-6989586621680966116"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966116"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1269"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966116"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1270"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span id="local-6989586621680966117"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966117"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966117"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Var
forall a. Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">S.empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1271"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-type">LitE</span></a></span><span> </span><span id="local-6989586621680966118"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680966118"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Int -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-var">LitE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680966118"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Var
forall a. Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">S.empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1272"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CharE"><span class="hs-identifier hs-type">CharE</span></a></span><span> </span><span id="local-6989586621680966119"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680966119"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Char -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CharE"><span class="hs-identifier hs-var">CharE</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680966119"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Var
forall a. Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">S.empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1273"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-type">FloatE</span></a></span><span> </span><span id="local-6989586621680966120"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680966120"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Double -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-var">FloatE</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680966120"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Var
forall a. Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">S.empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1274"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-type">LitSymE</span></a></span><span> </span><span id="local-6989586621680966121"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966121"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-var">LitSymE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966121"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Var
forall a. Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">S.empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1275"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span id="local-6989586621680966122"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966122"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680966123"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680966123"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621680966124"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966124"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966125"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966125"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966126"><span class="annot"><span class="annottext">[Set Var]
</span><a href="#local-6989586621680966126"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Exp2, Set Var)] -&gt; ([Exp2], [Set Var])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">([(Exp2, Set Var)] -&gt; ([Exp2], [Set Var]))
-&gt; [(Exp2, Set Var)] -&gt; ([Exp2], [Set Var])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; (Exp2, Set Var)) -&gt; [Exp2] -&gt; [(Exp2, Set Var)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; (Exp2, Set Var)
</span><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-var">cleanExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966124"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1276"></span><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966122"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680966123"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966125"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Set Var] -&gt; Set Var
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#unions"><span class="hs-identifier hs-var">S.unions</span></a></span><span> </span><span class="annot"><span class="annottext">[Set Var]
</span><a href="#local-6989586621680966126"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; Set Var -&gt; Set Var
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-operator hs-var">`S.union`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; Set Var
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">S.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680966123"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1277"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#DictInsertP"><span class="hs-identifier hs-type">DictInsertP</span></a></span><span> </span><span id="local-6989586621680966130"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966130"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680966131"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966131"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966132"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966132"><span class="hs-identifier hs-var">es'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966133"><span class="annot"><span class="annottext">[Set Var]
</span><a href="#local-6989586621680966133"><span class="hs-identifier hs-var">ls'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Exp2, Set Var)] -&gt; ([Exp2], [Set Var])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">([(Exp2, Set Var)] -&gt; ([Exp2], [Set Var]))
-&gt; [(Exp2, Set Var)] -&gt; ([Exp2], [Set Var])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; (Exp2, Set Var)) -&gt; [Exp2] -&gt; [(Exp2, Set Var)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">L.map</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; (Exp2, Set Var)
</span><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-var">cleanExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966131"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1278"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prim Ty2 -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#DictInsertP"><span class="hs-identifier hs-var">DictInsertP</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966130"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966132"><span class="hs-identifier hs-var">es'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1279"></span><span>                             </span><span class="annot"><span class="annottext">Set Var -&gt; Set Var -&gt; Set Var
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-identifier hs-var">S.union</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Set Var] -&gt; Set Var
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#unions"><span class="hs-identifier hs-var">S.unions</span></a></span><span> </span><span class="annot"><span class="annottext">[Set Var]
</span><a href="#local-6989586621680966133"><span class="hs-identifier hs-var">ls'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; Set Var
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">S.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([Var] -&gt; Set Var) -&gt; [Var] -&gt; Set Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; [Var]
</span><a href="Gibbon.L2.Syntax.html#locsInTy"><span class="hs-identifier hs-var">locsInTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966130"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1280"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#DictLookupP"><span class="hs-identifier hs-type">DictLookupP</span></a></span><span> </span><span id="local-6989586621680966134"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966134"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680966135"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966135"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966136"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966136"><span class="hs-identifier hs-var">es'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966137"><span class="annot"><span class="annottext">[Set Var]
</span><a href="#local-6989586621680966137"><span class="hs-identifier hs-var">ls'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Exp2, Set Var)] -&gt; ([Exp2], [Set Var])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">([(Exp2, Set Var)] -&gt; ([Exp2], [Set Var]))
-&gt; [(Exp2, Set Var)] -&gt; ([Exp2], [Set Var])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; (Exp2, Set Var)) -&gt; [Exp2] -&gt; [(Exp2, Set Var)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">L.map</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; (Exp2, Set Var)
</span><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-var">cleanExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966135"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1281"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prim Ty2 -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#DictLookupP"><span class="hs-identifier hs-var">DictLookupP</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966134"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966136"><span class="hs-identifier hs-var">es'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1282"></span><span>                             </span><span class="annot"><span class="annottext">Set Var -&gt; Set Var -&gt; Set Var
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-identifier hs-var">S.union</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Set Var] -&gt; Set Var
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#unions"><span class="hs-identifier hs-var">S.unions</span></a></span><span> </span><span class="annot"><span class="annottext">[Set Var]
</span><a href="#local-6989586621680966137"><span class="hs-identifier hs-var">ls'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; Set Var
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">S.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([Var] -&gt; Set Var) -&gt; [Var] -&gt; Set Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; [Var]
</span><a href="Gibbon.L2.Syntax.html#locsInTy"><span class="hs-identifier hs-var">locsInTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966134"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1283"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#DictEmptyP"><span class="hs-identifier hs-type">DictEmptyP</span></a></span><span> </span><span id="local-6989586621680966138"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966138"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680966139"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966139"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966140"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966140"><span class="hs-identifier hs-var">es'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966141"><span class="annot"><span class="annottext">[Set Var]
</span><a href="#local-6989586621680966141"><span class="hs-identifier hs-var">ls'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Exp2, Set Var)] -&gt; ([Exp2], [Set Var])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">([(Exp2, Set Var)] -&gt; ([Exp2], [Set Var]))
-&gt; [(Exp2, Set Var)] -&gt; ([Exp2], [Set Var])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; (Exp2, Set Var)) -&gt; [Exp2] -&gt; [(Exp2, Set Var)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">L.map</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; (Exp2, Set Var)
</span><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-var">cleanExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966139"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1284"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prim Ty2 -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#DictEmptyP"><span class="hs-identifier hs-var">DictEmptyP</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966138"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966140"><span class="hs-identifier hs-var">es'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1285"></span><span>                             </span><span class="annot"><span class="annottext">Set Var -&gt; Set Var -&gt; Set Var
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-identifier hs-var">S.union</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Set Var] -&gt; Set Var
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#unions"><span class="hs-identifier hs-var">S.unions</span></a></span><span> </span><span class="annot"><span class="annottext">[Set Var]
</span><a href="#local-6989586621680966141"><span class="hs-identifier hs-var">ls'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; Set Var
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">S.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([Var] -&gt; Set Var) -&gt; [Var] -&gt; Set Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; [Var]
</span><a href="Gibbon.L2.Syntax.html#locsInTy"><span class="hs-identifier hs-var">locsInTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966138"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1286"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#DictHasKeyP"><span class="hs-identifier hs-type">DictHasKeyP</span></a></span><span> </span><span id="local-6989586621680966142"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966142"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680966143"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966143"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966144"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966144"><span class="hs-identifier hs-var">es'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966145"><span class="annot"><span class="annottext">[Set Var]
</span><a href="#local-6989586621680966145"><span class="hs-identifier hs-var">ls'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Exp2, Set Var)] -&gt; ([Exp2], [Set Var])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">([(Exp2, Set Var)] -&gt; ([Exp2], [Set Var]))
-&gt; [(Exp2, Set Var)] -&gt; ([Exp2], [Set Var])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; (Exp2, Set Var)) -&gt; [Exp2] -&gt; [(Exp2, Set Var)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">L.map</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; (Exp2, Set Var)
</span><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-var">cleanExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966143"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1287"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prim Ty2 -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#DictHasKeyP"><span class="hs-identifier hs-var">DictHasKeyP</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966142"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966144"><span class="hs-identifier hs-var">es'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1288"></span><span>                             </span><span class="annot"><span class="annottext">Set Var -&gt; Set Var -&gt; Set Var
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-identifier hs-var">S.union</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Set Var] -&gt; Set Var
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#unions"><span class="hs-identifier hs-var">S.unions</span></a></span><span> </span><span class="annot"><span class="annottext">[Set Var]
</span><a href="#local-6989586621680966145"><span class="hs-identifier hs-var">ls'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; Set Var
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">S.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([Var] -&gt; Set Var) -&gt; [Var] -&gt; Set Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; [Var]
</span><a href="Gibbon.L2.Syntax.html#locsInTy"><span class="hs-identifier hs-var">locsInTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966142"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1289"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span id="local-6989586621680966146"><span class="annot"><span class="annottext">Prim Ty2
</span><a href="#local-6989586621680966146"><span class="hs-identifier hs-var">pr</span></a></span></span><span> </span><span id="local-6989586621680966147"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966147"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966148"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966148"><span class="hs-identifier hs-var">es'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966149"><span class="annot"><span class="annottext">[Set Var]
</span><a href="#local-6989586621680966149"><span class="hs-identifier hs-var">ls'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Exp2, Set Var)] -&gt; ([Exp2], [Set Var])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">([(Exp2, Set Var)] -&gt; ([Exp2], [Set Var]))
-&gt; [(Exp2, Set Var)] -&gt; ([Exp2], [Set Var])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; (Exp2, Set Var)) -&gt; [Exp2] -&gt; [(Exp2, Set Var)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">L.map</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; (Exp2, Set Var)
</span><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-var">cleanExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966147"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1290"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prim Ty2 -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
</span><a href="#local-6989586621680966146"><span class="hs-identifier hs-var">pr</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966148"><span class="hs-identifier hs-var">es'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Set Var] -&gt; Set Var
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#unions"><span class="hs-identifier hs-var">S.unions</span></a></span><span> </span><span class="annot"><span class="annottext">[Set Var]
</span><a href="#local-6989586621680966149"><span class="hs-identifier hs-var">ls'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1291"></span><span>      </span><span class="hs-comment">-- StartOfPkdCursor and AddFixed actually bind locations outside LetLoc forms,</span><span>
</span><span id="line-1292"></span><span>      </span><span class="hs-comment">-- these should be removed from the set of free locations.</span><span>
</span><span id="line-1293"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966150"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966150"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966151"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680966151"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966152"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966152"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966153"><span class="annot"><span class="annottext">e1 :: Exp2
</span><a href="#local-6989586621680966153"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#StartOfPkdCursor"><span class="hs-identifier hs-type">L2.StartOfPkdCursor</span></a></span><span> </span><span id="local-6989586621680966154"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966154"><span class="hs-identifier hs-var">_cur</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621680966155"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966155"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1294"></span><span>                        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966156"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966156"><span class="hs-identifier hs-var">e1'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680966157"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966157"><span class="hs-identifier hs-var">s1'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; (Exp2, Set Var)
</span><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-var">cleanExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966153"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-1295"></span><span>                            </span><span class="hs-special">(</span><span id="local-6989586621680966158"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966158"><span class="hs-identifier hs-var">e2'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680966159"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966159"><span class="hs-identifier hs-var">s2'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; (Exp2, Set Var)
</span><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-var">cleanExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966155"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-1296"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966150"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680966151"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966152"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966156"><span class="hs-identifier hs-var">e1'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966158"><span class="hs-identifier hs-var">e2'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Set Var -&gt; Set Var
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#delete"><span class="hs-identifier hs-var">S.delete</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966150"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Set Var] -&gt; Set Var
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#unions"><span class="hs-identifier hs-var">S.unions</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966157"><span class="hs-identifier hs-var">s1'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966159"><span class="hs-identifier hs-var">s2'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Var] -&gt; Set Var
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">S.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680966151"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1297"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966161"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966161"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966162"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680966162"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966163"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966163"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966164"><span class="annot"><span class="annottext">e1 :: Exp2
</span><a href="#local-6989586621680966164"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#AddFixed"><span class="hs-identifier hs-type">L2.AddFixed</span></a></span><span> </span><span id="local-6989586621680966165"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966165"><span class="hs-identifier hs-var">_cur</span></a></span></span><span> </span><span id="local-6989586621680966166"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680966166"><span class="hs-identifier hs-var">_i</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621680966167"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966167"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1298"></span><span>                        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966168"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966168"><span class="hs-identifier hs-var">e2'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680966169"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966169"><span class="hs-identifier hs-var">s2'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; (Exp2, Set Var)
</span><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-var">cleanExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966167"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-1299"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966161"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680966162"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966163"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966164"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966168"><span class="hs-identifier hs-var">e2'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Set Var -&gt; Set Var
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#delete"><span class="hs-identifier hs-var">S.delete</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966161"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Set Var] -&gt; Set Var
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#unions"><span class="hs-identifier hs-var">S.unions</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966169"><span class="hs-identifier hs-var">s2'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Var] -&gt; Set Var
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">S.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680966162"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1300"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966170"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966170"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966171"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680966171"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966172"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966172"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966173"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966173"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680966174"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966174"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966175"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966175"><span class="hs-identifier hs-var">e1'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680966176"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966176"><span class="hs-identifier hs-var">s1'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; (Exp2, Set Var)
</span><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-var">cleanExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966173"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-1301"></span><span>                                 </span><span class="hs-special">(</span><span id="local-6989586621680966177"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966177"><span class="hs-identifier hs-var">e2'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680966178"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966178"><span class="hs-identifier hs-var">s2'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; (Exp2, Set Var)
</span><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-var">cleanExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966174"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-1302"></span><span>                             </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966170"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680966171"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966172"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966175"><span class="hs-identifier hs-var">e1'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966177"><span class="hs-identifier hs-var">e2'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Set Var] -&gt; Set Var
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#unions"><span class="hs-identifier hs-var">S.unions</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966176"><span class="hs-identifier hs-var">s1'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966178"><span class="hs-identifier hs-var">s2'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Var] -&gt; Set Var
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">S.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680966171"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1303"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-type">IfE</span></a></span><span> </span><span id="local-6989586621680966179"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966179"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680966180"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966180"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span id="local-6989586621680966181"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966181"><span class="hs-identifier hs-var">e3</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966182"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966182"><span class="hs-identifier hs-var">e1'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966183"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966183"><span class="hs-identifier hs-var">s1'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; (Exp2, Set Var)
</span><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-var">cleanExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966179"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-1304"></span><span>                          </span><span class="hs-special">(</span><span id="local-6989586621680966184"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966184"><span class="hs-identifier hs-var">e2'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966185"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966185"><span class="hs-identifier hs-var">s2'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; (Exp2, Set Var)
</span><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-var">cleanExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966180"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-1305"></span><span>                          </span><span class="hs-special">(</span><span id="local-6989586621680966186"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966186"><span class="hs-identifier hs-var">e3'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966187"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966187"><span class="hs-identifier hs-var">s3'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; (Exp2, Set Var)
</span><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-var">cleanExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966181"><span class="hs-identifier hs-var">e3</span></a></span><span>
</span><span id="line-1306"></span><span>                      </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2 -&gt; Exp2 -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-var">IfE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966182"><span class="hs-identifier hs-var">e1'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966184"><span class="hs-identifier hs-var">e2'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966186"><span class="hs-identifier hs-var">e3'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Set Var] -&gt; Set Var
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#unions"><span class="hs-identifier hs-var">S.unions</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966183"><span class="hs-identifier hs-var">s1'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966185"><span class="hs-identifier hs-var">s2'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966187"><span class="hs-identifier hs-var">s3'</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1307"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-type">MkProdE</span></a></span><span> </span><span id="local-6989586621680966188"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966188"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966189"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966189"><span class="hs-identifier hs-var">es'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966190"><span class="annot"><span class="annottext">[Set Var]
</span><a href="#local-6989586621680966190"><span class="hs-identifier hs-var">ls'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Exp2, Set Var)] -&gt; ([Exp2], [Set Var])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">([(Exp2, Set Var)] -&gt; ([Exp2], [Set Var]))
-&gt; [(Exp2, Set Var)] -&gt; ([Exp2], [Set Var])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; (Exp2, Set Var)) -&gt; [Exp2] -&gt; [(Exp2, Set Var)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">L.map</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; (Exp2, Set Var)
</span><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-var">cleanExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966188"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1308"></span><span>                    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
[PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-var">MkProdE</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966189"><span class="hs-identifier hs-var">es'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Set Var] -&gt; Set Var
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#unions"><span class="hs-identifier hs-var">S.unions</span></a></span><span> </span><span class="annot"><span class="annottext">[Set Var]
</span><a href="#local-6989586621680966190"><span class="hs-identifier hs-var">ls'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1309"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-type">ProjE</span></a></span><span> </span><span id="local-6989586621680966191"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680966191"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680966192"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966192"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966193"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966193"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966194"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966194"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; (Exp2, Set Var)
</span><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-var">cleanExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966192"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1310"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Int -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-var">ProjE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680966191"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966193"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966194"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1311"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-type">CaseE</span></a></span><span> </span><span id="local-6989586621680966195"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966195"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680966196"><span class="annot"><span class="annottext">[(String, [(Var, Var)], Exp2)]
</span><a href="#local-6989586621680966196"><span class="hs-identifier hs-var">prs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966197"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966197"><span class="hs-identifier hs-var">e1'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966198"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966198"><span class="hs-identifier hs-var">s1'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; (Exp2, Set Var)
</span><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-var">cleanExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966195"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-1312"></span><span>                          </span><span class="hs-special">(</span><span id="local-6989586621680966199"><span class="annot"><span class="annottext">[(String, [(Var, Var)], Exp2)]
</span><a href="#local-6989586621680966199"><span class="hs-identifier hs-var">prs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680966200"><span class="annot"><span class="annottext">[Set Var]
</span><a href="#local-6989586621680966200"><span class="hs-identifier hs-var">ls2'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[((String, [(Var, Var)], Exp2), Set Var)]
-&gt; ([(String, [(Var, Var)], Exp2)], [Set Var])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">([((String, [(Var, Var)], Exp2), Set Var)]
 -&gt; ([(String, [(Var, Var)], Exp2)], [Set Var]))
-&gt; [((String, [(Var, Var)], Exp2), Set Var)]
-&gt; ([(String, [(Var, Var)], Exp2)], [Set Var])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((String, [(Var, Var)], Exp2)
 -&gt; ((String, [(Var, Var)], Exp2), Set Var))
-&gt; [(String, [(Var, Var)], Exp2)]
-&gt; [((String, [(Var, Var)], Exp2), Set Var)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">L.map</span></a></span><span>
</span><span id="line-1313"></span><span>                                         </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680966201"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680966201"><span class="hs-identifier hs-var">dc</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966202"><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680966202"><span class="hs-identifier hs-var">lvs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966203"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966203"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966204"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966204"><span class="hs-identifier hs-var">e2'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680966205"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966205"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; (Exp2, Set Var)
</span><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-var">cleanExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966203"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-1314"></span><span>                                                          </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680966201"><span class="hs-identifier hs-var">dc</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680966202"><span class="hs-identifier hs-var">lvs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966204"><span class="hs-identifier hs-var">e2'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966205"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; Set Var -&gt; Set Var
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#%5C%5C"><span class="hs-operator hs-var">S.\\</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; Set Var
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">S.fromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Var, Var) -&gt; Var) -&gt; [(Var, Var)] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Var) -&gt; Var
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680966202"><span class="hs-identifier hs-var">lvs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(String, [(Var, Var)], Exp2)]
</span><a href="#local-6989586621680966196"><span class="hs-identifier hs-var">prs</span></a></span><span>
</span><span id="line-1315"></span><span>                      </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2 -&gt; [(String, [(Var, Var)], Exp2)] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; [(String, [(Var, loc)], PreExp ext loc dec)]
-&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-var">CaseE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966197"><span class="hs-identifier hs-var">e1'</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, [(Var, Var)], Exp2)]
</span><a href="#local-6989586621680966199"><span class="hs-identifier hs-var">prs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; Set Var -&gt; Set Var
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-identifier hs-var">S.union</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966198"><span class="hs-identifier hs-var">s1'</span></a></span><span> </span><span class="annot"><span class="annottext">(Set Var -&gt; Set Var) -&gt; Set Var -&gt; Set Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Set Var] -&gt; Set Var
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#unions"><span class="hs-identifier hs-var">S.unions</span></a></span><span> </span><span class="annot"><span class="annottext">[Set Var]
</span><a href="#local-6989586621680966200"><span class="hs-identifier hs-var">ls2'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1316"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-type">DataConE</span></a></span><span> </span><span id="local-6989586621680966207"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966207"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span id="local-6989586621680966208"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680966208"><span class="hs-identifier hs-var">dc</span></a></span></span><span> </span><span id="local-6989586621680966209"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966209"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966210"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966210"><span class="hs-identifier hs-var">es'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966211"><span class="annot"><span class="annottext">[Set Var]
</span><a href="#local-6989586621680966211"><span class="hs-identifier hs-var">ls'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Exp2, Set Var)] -&gt; ([Exp2], [Set Var])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">([(Exp2, Set Var)] -&gt; ([Exp2], [Set Var]))
-&gt; [(Exp2, Set Var)] -&gt; ([Exp2], [Set Var])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; (Exp2, Set Var)) -&gt; [Exp2] -&gt; [(Exp2, Set Var)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">L.map</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; (Exp2, Set Var)
</span><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-var">cleanExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966209"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1317"></span><span>                           </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; String -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
loc -&gt; String -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-var">DataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966207"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680966208"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966210"><span class="hs-identifier hs-var">es'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; Set Var -&gt; Set Var
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-identifier hs-var">S.union</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Set Var
forall a. a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#singleton"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966207"><span class="hs-identifier hs-var">lv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Set Var -&gt; Set Var) -&gt; Set Var -&gt; Set Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Set Var] -&gt; Set Var
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#unions"><span class="hs-identifier hs-var">S.unions</span></a></span><span> </span><span class="annot"><span class="annottext">[Set Var]
</span><a href="#local-6989586621680966211"><span class="hs-identifier hs-var">ls'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1318"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-type">TimeIt</span></a></span><span> </span><span id="local-6989586621680966213"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966213"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680966214"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966214"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621680966215"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680966215"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966216"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966216"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966217"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966217"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; (Exp2, Set Var)
</span><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-var">cleanExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966213"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1319"></span><span>                      </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2 -&gt; Ty2 -&gt; Bool -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec -&gt; dec -&gt; Bool -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-var">TimeIt</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966216"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966214"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680966215"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966217"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1320"></span><span>
</span><span id="line-1321"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-type">SpawnE</span></a></span><span> </span><span id="local-6989586621680966218"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966218"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680966219"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680966219"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621680966220"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966220"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966221"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966221"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966222"><span class="annot"><span class="annottext">[Set Var]
</span><a href="#local-6989586621680966222"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Exp2, Set Var)] -&gt; ([Exp2], [Set Var])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">([(Exp2, Set Var)] -&gt; ([Exp2], [Set Var]))
-&gt; [(Exp2, Set Var)] -&gt; ([Exp2], [Set Var])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; (Exp2, Set Var)) -&gt; [Exp2] -&gt; [(Exp2, Set Var)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; (Exp2, Set Var)
</span><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-var">cleanExp</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966220"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1322"></span><span>                       </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-var">SpawnE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966218"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680966219"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966221"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Set Var] -&gt; Set Var
forall (f :: * -&gt; *) a. (Foldable f, Ord a) =&gt; f (Set a) -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#unions"><span class="hs-identifier hs-var">S.unions</span></a></span><span> </span><span class="annot"><span class="annottext">[Set Var]
</span><a href="#local-6989586621680966222"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; Set Var -&gt; Set Var
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-operator hs-var">`S.union`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; Set Var
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">S.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680966219"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1323"></span><span>
</span><span id="line-1324"></span><span>      </span><span class="annot"><span class="annottext">Exp2
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Var
forall a. Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">S.empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1325"></span><span>
</span><span id="line-1326"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-type">WithArenaE</span></a></span><span> </span><span id="local-6989586621680966223"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966223"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680966224"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966224"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966225"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966225"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966226"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966226"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; (Exp2, Set Var)
</span><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-var">cleanExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966224"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1327"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-var">WithArenaE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966223"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966225"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966226"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1328"></span><span>
</span><span id="line-1329"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetRegionE"><span class="hs-identifier hs-type">LetRegionE</span></a></span><span> </span><span id="local-6989586621680966227"><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680966227"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680966228"><span class="annot"><span class="annottext">RegionSize
</span><a href="#local-6989586621680966228"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span id="local-6989586621680966229"><span class="annot"><span class="annottext">Maybe RegionType
</span><a href="#local-6989586621680966229"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680966230"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966230"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966231"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966231"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966232"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966232"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; (Exp2, Set Var)
</span><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-var">cleanExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966230"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1330"></span><span>                              </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Region -&gt; RegionSize -&gt; Maybe RegionType -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec.
Region
-&gt; RegionSize -&gt; Maybe RegionType -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetRegionE"><span class="hs-identifier hs-var">LetRegionE</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680966227"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">RegionSize
</span><a href="#local-6989586621680966228"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RegionType
</span><a href="#local-6989586621680966229"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966231"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966232"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1331"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetParRegionE"><span class="hs-identifier hs-type">LetParRegionE</span></a></span><span> </span><span id="local-6989586621680966233"><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680966233"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680966234"><span class="annot"><span class="annottext">RegionSize
</span><a href="#local-6989586621680966234"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span id="local-6989586621680966235"><span class="annot"><span class="annottext">Maybe RegionType
</span><a href="#local-6989586621680966235"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680966236"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966236"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966237"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966237"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966238"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966238"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; (Exp2, Set Var)
</span><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-var">cleanExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966236"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1332"></span><span>                                 </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Region -&gt; RegionSize -&gt; Maybe RegionType -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec.
Region
-&gt; RegionSize -&gt; Maybe RegionType -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetParRegionE"><span class="hs-identifier hs-var">LetParRegionE</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680966233"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">RegionSize
</span><a href="#local-6989586621680966234"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RegionType
</span><a href="#local-6989586621680966235"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966237"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966238"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1333"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-type">LetLocE</span></a></span><span> </span><span id="local-6989586621680966239"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966239"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="annot"><span class="annottext">PreLocExp Var
</span><a href="Gibbon.L2.Syntax.html#FreeLE"><span class="hs-identifier hs-var">FreeLE</span></a></span><span> </span><span id="local-6989586621680966240"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966240"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966241"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966241"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680966242"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966242"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; (Exp2, Set Var)
</span><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-var">cleanExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966240"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1334"></span><span>                                    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Set Var -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#member"><span class="hs-identifier hs-var">S.member</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966239"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966242"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-1335"></span><span>                                       </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; PreLocExp Var -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; PreLocExp loc -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-var">LetLocE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966239"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">PreLocExp Var
forall loc. PreLocExp loc
</span><a href="Gibbon.L2.Syntax.html#FreeLE"><span class="hs-identifier hs-var">FreeLE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966241"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Set Var -&gt; Set Var
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#delete"><span class="hs-identifier hs-var">S.delete</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966239"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966242"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1336"></span><span>                                       </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966241"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966242"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1337"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-type">LetLocE</span></a></span><span> </span><span id="local-6989586621680966244"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966244"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621680966245"><span class="annot"><span class="annottext">PreLocExp Var
</span><a href="#local-6989586621680966245"><span class="hs-identifier hs-var">lex</span></a></span></span><span> </span><span id="local-6989586621680966246"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966246"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966247"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966247"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966248"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966248"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; (Exp2, Set Var)
</span><a href="Gibbon.Passes.InferLocations.html#cleanExp"><span class="hs-identifier hs-var">cleanExp</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966246"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1338"></span><span>                                 </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Set Var -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#member"><span class="hs-identifier hs-var">S.member</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966244"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966248"><span class="hs-identifier hs-var">s'</span></a></span><span>
</span><span id="line-1339"></span><span>                                    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680966249"><span class="annot"><span class="annottext">ls :: [Var]
</span><a href="#local-6989586621680966249"><span class="hs-identifier hs-var hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PreLocExp Var
</span><a href="#local-6989586621680966245"><span class="hs-identifier hs-var">lex</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1340"></span><span>                                                    </span><span class="annot"><a href="Gibbon.L2.Syntax.html#AfterConstantLE"><span class="hs-identifier hs-type">AfterConstantLE</span></a></span><span> </span><span id="local-6989586621680966250"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680966250"><span class="hs-identifier hs-var">_i</span></a></span></span><span> </span><span id="local-6989586621680966251"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966251"><span class="hs-identifier hs-var">lv</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966251"><span class="hs-identifier hs-var">lv</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1341"></span><span>                                                    </span><span class="annot"><a href="Gibbon.L2.Syntax.html#AfterVariableLE"><span class="hs-identifier hs-type">AfterVariableLE</span></a></span><span> </span><span id="local-6989586621680966252"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966252"><span class="hs-identifier hs-var">_v</span></a></span></span><span> </span><span id="local-6989586621680966253"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966253"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966253"><span class="hs-identifier hs-var">lv</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1342"></span><span>                                                    </span><span id="local-6989586621680966254"><span class="annot"><span class="annottext">PreLocExp Var
</span><a href="#local-6989586621680966254"><span class="hs-identifier hs-var">oth</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1343"></span><span>                                         </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; PreLocExp Var -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; PreLocExp loc -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-var">LetLocE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966244"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">PreLocExp Var
</span><a href="#local-6989586621680966245"><span class="hs-identifier hs-var">lex</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966247"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1344"></span><span>                                              </span><span class="annot"><span class="annottext">Var -&gt; Set Var -&gt; Set Var
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#delete"><span class="hs-identifier hs-var">S.delete</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966244"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">(Set Var -&gt; Set Var) -&gt; Set Var -&gt; Set Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; Set Var -&gt; Set Var
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-identifier hs-var">S.union</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966248"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="annot"><span class="annottext">(Set Var -&gt; Set Var) -&gt; Set Var -&gt; Set Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; Set Var
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">S.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680966249"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1345"></span><span>                                    </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966247"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966248"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1346"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#AddFixed"><span class="hs-identifier hs-type">L2.AddFixed</span></a></span><span> </span><span id="local-6989586621680966255"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966255"><span class="hs-identifier hs-var">cur</span></a></span></span><span> </span><span id="local-6989586621680966256"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680966256"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Int -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; Int -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#AddFixed"><span class="hs-identifier hs-var">L2.AddFixed</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966255"><span class="hs-identifier hs-var">cur</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680966256"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Var
forall a. Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">S.empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1347"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#StartOfPkdCursor"><span class="hs-identifier hs-type">L2.StartOfPkdCursor</span></a></span><span> </span><span id="local-6989586621680966257"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966257"><span class="hs-identifier hs-var">cur</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#StartOfPkdCursor"><span class="hs-identifier hs-var">L2.StartOfPkdCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966257"><span class="hs-identifier hs-var">cur</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Var
forall a. Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">S.empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1348"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#TagCursor"><span class="hs-identifier hs-type">L2.TagCursor</span></a></span><span> </span><span id="local-6989586621680966258"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966258"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680966259"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966259"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; Var -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#TagCursor"><span class="hs-identifier hs-var">L2.TagCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966258"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966259"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Var
forall a. Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">S.empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1349"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#RetE"><span class="hs-identifier hs-type">RetE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Exp2, Set Var)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; (Exp2, Set Var)) -&gt; String -&gt; (Exp2, Set Var)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;todo: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966116"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1350"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#FromEndE"><span class="hs-identifier hs-type">FromEndE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Exp2, Set Var)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; (Exp2, Set Var)) -&gt; String -&gt; (Exp2, Set Var)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;todo: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966116"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1351"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#BoundsCheck"><span class="hs-identifier hs-type">BoundsCheck</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Exp2, Set Var)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; (Exp2, Set Var)) -&gt; String -&gt; (Exp2, Set Var)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;todo: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966116"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1352"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#IndirectionE"><span class="hs-identifier hs-type">IndirectionE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Exp2, Set Var)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; (Exp2, Set Var)) -&gt; String -&gt; (Exp2, Set Var)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;todo: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966116"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1353"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#GetCilkWorkerNum"><span class="hs-identifier hs-type">GetCilkWorkerNum</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Exp2, Set Var)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; (Exp2, Set Var)) -&gt; String -&gt; (Exp2, Set Var)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;todo: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966116"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1354"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetAvail"><span class="hs-identifier hs-type">LetAvail</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Exp2, Set Var)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; (Exp2, Set Var)) -&gt; String -&gt; (Exp2, Set Var)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;todo: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966116"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1355"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#AllocateTagHere"><span class="hs-identifier hs-type">AllocateTagHere</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Exp2, Set Var)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; (Exp2, Set Var)) -&gt; String -&gt; (Exp2, Set Var)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;todo: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966116"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1356"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#AllocateScalarsHere"><span class="hs-identifier hs-type">AllocateScalarsHere</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Exp2, Set Var)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; (Exp2, Set Var)) -&gt; String -&gt; (Exp2, Set Var)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;todo: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966116"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1357"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#SSPush"><span class="hs-identifier hs-type">SSPush</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Exp2, Set Var)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; (Exp2, Set Var)) -&gt; String -&gt; (Exp2, Set Var)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;todo: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966116"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1358"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#SSPop"><span class="hs-identifier hs-type">SSPop</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Exp2, Set Var)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; (Exp2, Set Var)) -&gt; String -&gt; (Exp2, Set Var)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;todo: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966116"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1359"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MapE"><span class="hs-identifier hs-type">MapE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Exp2, Set Var)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span class="annot"><span class="annottext">(String -&gt; (Exp2, Set Var)) -&gt; String -&gt; (Exp2, Set Var)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;MapE not supported&quot;</span></span><span>
</span><span id="line-1360"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FoldE"><span class="hs-identifier hs-type">FoldE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Exp2, Set Var)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span class="annot"><span class="annottext">(String -&gt; (Exp2, Set Var)) -&gt; String -&gt; (Exp2, Set Var)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;FoldE not supported&quot;</span></span><span>
</span><span id="line-1361"></span><span>
</span><span id="line-1362"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#projTups"><span class="hs-identifier hs-type">projTups</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Exp1"><span class="hs-identifier hs-type">Exp1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Exp1"><span class="hs-identifier hs-type">Exp1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Exp1"><span class="hs-identifier hs-type">Exp1</span></a></span><span>
</span><span id="line-1363"></span><span id="projTups"><span class="annot"><span class="annottext">projTups :: Ty2 -&gt; Exp1 -&gt; Exp1 -&gt; TiM Exp1
</span><a href="Gibbon.Passes.InferLocations.html#projTups"><span class="hs-identifier hs-var hs-var">projTups</span></a></span></span><span> </span><span id="local-6989586621680966284"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966284"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621680966285"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966285"><span class="hs-identifier hs-var">proj</span></a></span></span><span> </span><span id="local-6989586621680966286"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966286"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1364"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966284"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1365"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680966287"><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680966287"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; (Ty2, Int) -&gt; TiM Exp1)
-&gt; Exp1 -&gt; [(Ty2, Int)] -&gt; TiM Exp1
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Control.Monad.html#foldM"><span class="hs-identifier hs-var">foldM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680966288"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966288"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966289"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966289"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966290"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680966290"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1366"></span><span>                   </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966289"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1367"></span><span>                     </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680966291"><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680966291"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1368"></span><span>                          </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680966292"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966292"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Var -&gt; TiM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Var -&gt; TiM Var)
-&gt; StateT InferState PassM Var -&gt; TiM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Var -&gt; StateT InferState PassM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Var -&gt; StateT InferState PassM Var)
-&gt; PassM Var -&gt; StateT InferState PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;proj&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1369"></span><span>                             </span><span id="local-6989586621680966294"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966294"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Exp1 -&gt; Exp1 -&gt; TiM Exp1
</span><a href="Gibbon.Passes.InferLocations.html#projTups"><span class="hs-identifier hs-var">projTups</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966289"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Exp1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Int -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-var">ProjE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680966290"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966285"><span class="hs-identifier hs-var">proj</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966288"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1370"></span><span>                             </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680966295"><span class="annot"><span class="annottext">ty :: Ty1
</span><a href="#local-6989586621680966295"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Ty1
forall a. UrTy a -&gt; Ty1
</span><a href="Gibbon.Language.html#stripTyLocs"><span class="hs-identifier hs-var">stripTyLocs</span></a></span><span> </span><span class="annot"><span class="annottext">(Ty2 -&gt; Ty1) -&gt; Ty2 -&gt; Ty1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2] -&gt; Ty2
forall loc. [UrTy loc] -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680966291"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-1371"></span><span>                             </span><span class="annot"><span class="annottext">Exp1 -&gt; TiM Exp1
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; TiM Exp1) -&gt; Exp1 -&gt; TiM Exp1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, [()], Ty1, Exp1) -&gt; Exp1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966292"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966295"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int -&gt; Exp1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Int -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-var">ProjE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680966290"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966285"><span class="hs-identifier hs-var">proj</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966294"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-1372"></span><span>                     </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span id="local-6989586621680966296"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680966296"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680966297"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966297"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1373"></span><span>                          </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680966298"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966298"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM Var -&gt; TiM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Var -&gt; TiM Var)
-&gt; StateT InferState PassM Var -&gt; TiM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Var -&gt; StateT InferState PassM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Var -&gt; StateT InferState PassM Var)
-&gt; PassM Var -&gt; StateT InferState PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;proj&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1374"></span><span>                             </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680966299"><span class="annot"><span class="annottext">ty :: Ty1
</span><a href="#local-6989586621680966299"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Ty1
forall a. UrTy a -&gt; Ty1
</span><a href="Gibbon.Language.html#stripTyLocs"><span class="hs-identifier hs-var">stripTyLocs</span></a></span><span> </span><span class="annot"><span class="annottext">(Ty2 -&gt; Ty1) -&gt; Ty2 -&gt; Ty1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Var -&gt; Ty2
forall loc. String -&gt; loc -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-var">PackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680966296"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966297"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-1375"></span><span>                             </span><span class="annot"><span class="annottext">Exp1 -&gt; TiM Exp1
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; TiM Exp1) -&gt; Exp1 -&gt; TiM Exp1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, [()], Ty1, Exp1) -&gt; Exp1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966298"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966299"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int -&gt; Exp1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Int -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-var">ProjE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680966290"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966285"><span class="hs-identifier hs-var">proj</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; Exp1) -&gt; Exp1 -&gt; Exp1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var Var -&gt; Var -&gt; Exp1 -&gt; Exp1 -&gt; Exp1
</span><a href="Gibbon.Passes.InferLocations.html#fixProj"><span class="hs-identifier hs-var">fixProj</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var Var
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966298"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Exp1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Int -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-var">ProjE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680966290"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966285"><span class="hs-identifier hs-var">proj</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966288"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1376"></span><span>                     </span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; TiM Exp1
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966288"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966286"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">([(Ty2, Int)] -&gt; TiM Exp1) -&gt; [(Ty2, Int)] -&gt; TiM Exp1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2] -&gt; [Int] -&gt; [(Ty2, Int)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680966287"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-1377"></span><span>      </span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; TiM Exp1
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966286"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1378"></span><span>
</span><span id="line-1379"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#fixProj"><span class="hs-identifier hs-type">fixProj</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">M.Map</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Exp1"><span class="hs-identifier hs-type">Exp1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Exp1"><span class="hs-identifier hs-type">Exp1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Exp1"><span class="hs-identifier hs-type">Exp1</span></a></span><span>
</span><span id="line-1380"></span><span id="fixProj"><span class="annot"><span class="annottext">fixProj :: Map Var Var -&gt; Var -&gt; Exp1 -&gt; Exp1 -&gt; Exp1
</span><a href="Gibbon.Passes.InferLocations.html#fixProj"><span class="hs-identifier hs-var hs-var">fixProj</span></a></span></span><span> </span><span id="local-6989586621680966318"><span class="annot"><span class="annottext">Map Var Var
</span><a href="#local-6989586621680966318"><span class="hs-identifier hs-var">renam</span></a></span></span><span> </span><span id="local-6989586621680966319"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966319"><span class="hs-identifier hs-var">pvar</span></a></span></span><span> </span><span id="local-6989586621680966320"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966320"><span class="hs-identifier hs-var">proj</span></a></span></span><span> </span><span id="local-6989586621680966321"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966321"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1381"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680966324"><span class="annot"><span class="annottext">eEq :: a -&gt; a -&gt; Bool
</span><a href="#local-6989586621680966324"><span class="hs-identifier hs-var hs-var">eEq</span></a></span></span><span> </span><span id="local-6989586621680966325"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680966325"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680966326"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680966326"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680966325"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680966326"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-1382"></span><span>    </span><span class="hs-keyword">in</span><span>
</span><span id="line-1383"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966321"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1384"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span id="local-6989586621680966327"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966327"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Map Var Var -&gt; Maybe Var
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966327"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var Var
</span><a href="#local-6989586621680966318"><span class="hs-identifier hs-var">renam</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1385"></span><span>                  </span><span class="annot"><span class="annottext">Maybe Var
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966327"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1386"></span><span>                  </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680966329"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966329"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966329"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-1387"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-type">LitE</span></a></span><span> </span><span id="local-6989586621680966330"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680966330"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec. Int -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-var">LitE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680966330"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1388"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CharE"><span class="hs-identifier hs-type">CharE</span></a></span><span> </span><span id="local-6989586621680966331"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680966331"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec. Char -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CharE"><span class="hs-identifier hs-var">CharE</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680966331"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1389"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-type">FloatE</span></a></span><span> </span><span id="local-6989586621680966332"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680966332"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec. Double -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-var">FloatE</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680966332"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1390"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-type">LitSymE</span></a></span><span> </span><span id="local-6989586621680966333"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966333"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-var">LitSymE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966333"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1391"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span id="local-6989586621680966334"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966334"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680966335"><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680966335"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621680966336"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680966336"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680966337"><span class="annot"><span class="annottext">es' :: [Exp1]
</span><a href="#local-6989586621680966337"><span class="hs-identifier hs-var hs-var">es'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; Exp1) -&gt; [Exp1] -&gt; [Exp1]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var Var -&gt; Var -&gt; Exp1 -&gt; Exp1 -&gt; Exp1
</span><a href="Gibbon.Passes.InferLocations.html#fixProj"><span class="hs-identifier hs-var">fixProj</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var Var
</span><a href="#local-6989586621680966318"><span class="hs-identifier hs-var">renam</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966319"><span class="hs-identifier hs-var">pvar</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966320"><span class="hs-identifier hs-var">proj</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680966336"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1392"></span><span>                      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [()] -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966334"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680966335"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680966337"><span class="hs-identifier hs-var">es'</span></a></span><span>
</span><span id="line-1393"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span id="local-6989586621680966338"><span class="annot"><span class="annottext">Prim Ty1
</span><a href="#local-6989586621680966338"><span class="hs-identifier hs-var">pr</span></a></span></span><span> </span><span id="local-6989586621680966339"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680966339"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680966340"><span class="annot"><span class="annottext">es' :: [Exp1]
</span><a href="#local-6989586621680966340"><span class="hs-identifier hs-var hs-var">es'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; Exp1) -&gt; [Exp1] -&gt; [Exp1]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var Var -&gt; Var -&gt; Exp1 -&gt; Exp1 -&gt; Exp1
</span><a href="Gibbon.Passes.InferLocations.html#fixProj"><span class="hs-identifier hs-var">fixProj</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var Var
</span><a href="#local-6989586621680966318"><span class="hs-identifier hs-var">renam</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966319"><span class="hs-identifier hs-var">pvar</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966320"><span class="hs-identifier hs-var">proj</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680966339"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1394"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Prim Ty1 -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="#local-6989586621680966338"><span class="hs-identifier hs-var">pr</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680966340"><span class="hs-identifier hs-var">es'</span></a></span><span>
</span><span id="line-1395"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966341"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966341"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966342"><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680966342"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966343"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966343"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966344"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966344"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680966345"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966345"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1396"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966344"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; Exp1 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="#local-6989586621680966324"><span class="hs-operator hs-var">`eEq`</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966320"><span class="hs-identifier hs-var">proj</span></a></span><span>
</span><span id="line-1397"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Map Var Var -&gt; Var -&gt; Exp1 -&gt; Exp1 -&gt; Exp1
</span><a href="Gibbon.Passes.InferLocations.html#fixProj"><span class="hs-identifier hs-var">fixProj</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Map Var Var -&gt; Map Var Var
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966341"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966319"><span class="hs-identifier hs-var">pvar</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var Var
</span><a href="#local-6989586621680966318"><span class="hs-identifier hs-var">renam</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966319"><span class="hs-identifier hs-var">pvar</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966320"><span class="hs-identifier hs-var">proj</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966345"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-1398"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680966346"><span class="annot"><span class="annottext">e1' :: Exp1
</span><a href="#local-6989586621680966346"><span class="hs-identifier hs-var hs-var">e1'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var Var -&gt; Var -&gt; Exp1 -&gt; Exp1 -&gt; Exp1
</span><a href="Gibbon.Passes.InferLocations.html#fixProj"><span class="hs-identifier hs-var">fixProj</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var Var
</span><a href="#local-6989586621680966318"><span class="hs-identifier hs-var">renam</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966319"><span class="hs-identifier hs-var">pvar</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966320"><span class="hs-identifier hs-var">proj</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966344"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-1399"></span><span>                   </span><span id="local-6989586621680966347"><span class="annot"><span class="annottext">e2' :: Exp1
</span><a href="#local-6989586621680966347"><span class="hs-identifier hs-var hs-var">e2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var Var -&gt; Var -&gt; Exp1 -&gt; Exp1 -&gt; Exp1
</span><a href="Gibbon.Passes.InferLocations.html#fixProj"><span class="hs-identifier hs-var">fixProj</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var Var
</span><a href="#local-6989586621680966318"><span class="hs-identifier hs-var">renam</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966319"><span class="hs-identifier hs-var">pvar</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966320"><span class="hs-identifier hs-var">proj</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966345"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-1400"></span><span>               </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Var, [()], Ty1, Exp1) -&gt; Exp1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966341"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680966342"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966343"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966346"><span class="hs-identifier hs-var">e1'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966347"><span class="hs-identifier hs-var">e2'</span></a></span><span>
</span><span id="line-1401"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-type">IfE</span></a></span><span> </span><span id="local-6989586621680966348"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966348"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680966349"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966349"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span id="local-6989586621680966350"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966350"><span class="hs-identifier hs-var">e3</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680966351"><span class="annot"><span class="annottext">e1' :: Exp1
</span><a href="#local-6989586621680966351"><span class="hs-identifier hs-var hs-var">e1'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var Var -&gt; Var -&gt; Exp1 -&gt; Exp1 -&gt; Exp1
</span><a href="Gibbon.Passes.InferLocations.html#fixProj"><span class="hs-identifier hs-var">fixProj</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var Var
</span><a href="#local-6989586621680966318"><span class="hs-identifier hs-var">renam</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966319"><span class="hs-identifier hs-var">pvar</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966320"><span class="hs-identifier hs-var">proj</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966348"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-1402"></span><span>                          </span><span id="local-6989586621680966352"><span class="annot"><span class="annottext">e2' :: Exp1
</span><a href="#local-6989586621680966352"><span class="hs-identifier hs-var hs-var">e2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var Var -&gt; Var -&gt; Exp1 -&gt; Exp1 -&gt; Exp1
</span><a href="Gibbon.Passes.InferLocations.html#fixProj"><span class="hs-identifier hs-var">fixProj</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var Var
</span><a href="#local-6989586621680966318"><span class="hs-identifier hs-var">renam</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966319"><span class="hs-identifier hs-var">pvar</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966320"><span class="hs-identifier hs-var">proj</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966349"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-1403"></span><span>                          </span><span id="local-6989586621680966353"><span class="annot"><span class="annottext">e3' :: Exp1
</span><a href="#local-6989586621680966353"><span class="hs-identifier hs-var hs-var">e3'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var Var -&gt; Var -&gt; Exp1 -&gt; Exp1 -&gt; Exp1
</span><a href="Gibbon.Passes.InferLocations.html#fixProj"><span class="hs-identifier hs-var">fixProj</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var Var
</span><a href="#local-6989586621680966318"><span class="hs-identifier hs-var">renam</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966319"><span class="hs-identifier hs-var">pvar</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966320"><span class="hs-identifier hs-var">proj</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966350"><span class="hs-identifier hs-var">e3</span></a></span><span>
</span><span id="line-1404"></span><span>                      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; Exp1 -&gt; Exp1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-var">IfE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966351"><span class="hs-identifier hs-var">e1'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966352"><span class="hs-identifier hs-var">e2'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966353"><span class="hs-identifier hs-var">e3'</span></a></span><span>
</span><span id="line-1405"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-type">MkProdE</span></a></span><span> </span><span id="local-6989586621680966354"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680966354"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680966355"><span class="annot"><span class="annottext">es' :: [Exp1]
</span><a href="#local-6989586621680966355"><span class="hs-identifier hs-var hs-var">es'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; Exp1) -&gt; [Exp1] -&gt; [Exp1]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var Var -&gt; Var -&gt; Exp1 -&gt; Exp1 -&gt; Exp1
</span><a href="Gibbon.Passes.InferLocations.html#fixProj"><span class="hs-identifier hs-var">fixProj</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var Var
</span><a href="#local-6989586621680966318"><span class="hs-identifier hs-var">renam</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966319"><span class="hs-identifier hs-var">pvar</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966320"><span class="hs-identifier hs-var">proj</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680966354"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1406"></span><span>                    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
[PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-var">MkProdE</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680966355"><span class="hs-identifier hs-var">es'</span></a></span><span>
</span><span id="line-1407"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-type">ProjE</span></a></span><span> </span><span id="local-6989586621680966356"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680966356"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680966357"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966357"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966321"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; Exp1 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="#local-6989586621680966324"><span class="hs-operator hs-var">`eEq`</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966320"><span class="hs-identifier hs-var">proj</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966319"><span class="hs-identifier hs-var">pvar</span></a></span><span> </span><span class="hs-keyword">else</span><span>
</span><span id="line-1408"></span><span>                        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680966358"><span class="annot"><span class="annottext">e1' :: Exp1
</span><a href="#local-6989586621680966358"><span class="hs-identifier hs-var hs-var">e1'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var Var -&gt; Var -&gt; Exp1 -&gt; Exp1 -&gt; Exp1
</span><a href="Gibbon.Passes.InferLocations.html#fixProj"><span class="hs-identifier hs-var">fixProj</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var Var
</span><a href="#local-6989586621680966318"><span class="hs-identifier hs-var">renam</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966319"><span class="hs-identifier hs-var">pvar</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966320"><span class="hs-identifier hs-var">proj</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966357"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-1409"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Exp1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Int -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-var">ProjE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680966356"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966358"><span class="hs-identifier hs-var">e1'</span></a></span><span>
</span><span id="line-1410"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-type">CaseE</span></a></span><span> </span><span id="local-6989586621680966359"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966359"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680966360"><span class="annot"><span class="annottext">[(String, [(Var, ())], Exp1)]
</span><a href="#local-6989586621680966360"><span class="hs-identifier hs-var">prs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680966361"><span class="annot"><span class="annottext">e1' :: Exp1
</span><a href="#local-6989586621680966361"><span class="hs-identifier hs-var hs-var">e1'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var Var -&gt; Var -&gt; Exp1 -&gt; Exp1 -&gt; Exp1
</span><a href="Gibbon.Passes.InferLocations.html#fixProj"><span class="hs-identifier hs-var">fixProj</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var Var
</span><a href="#local-6989586621680966318"><span class="hs-identifier hs-var">renam</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966319"><span class="hs-identifier hs-var">pvar</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966320"><span class="hs-identifier hs-var">proj</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966359"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-1411"></span><span>                          </span><span id="local-6989586621680966362"><span class="annot"><span class="annottext">prs' :: [(String, [(Var, ())], Exp1)]
</span><a href="#local-6989586621680966362"><span class="hs-identifier hs-var hs-var">prs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((String, [(Var, ())], Exp1) -&gt; (String, [(Var, ())], Exp1))
-&gt; [(String, [(Var, ())], Exp1)] -&gt; [(String, [(Var, ())], Exp1)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680966363"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680966363"><span class="hs-identifier hs-var">dc</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966364"><span class="annot"><span class="annottext">[(Var, ())]
</span><a href="#local-6989586621680966364"><span class="hs-identifier hs-var">lvs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966365"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966365"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1412"></span><span>                                          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680966363"><span class="hs-identifier hs-var">dc</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(Var, ())]
</span><a href="#local-6989586621680966364"><span class="hs-identifier hs-var">lvs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Map Var Var -&gt; Var -&gt; Exp1 -&gt; Exp1 -&gt; Exp1
</span><a href="Gibbon.Passes.InferLocations.html#fixProj"><span class="hs-identifier hs-var">fixProj</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var Var
</span><a href="#local-6989586621680966318"><span class="hs-identifier hs-var">renam</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966319"><span class="hs-identifier hs-var">pvar</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966320"><span class="hs-identifier hs-var">proj</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966365"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(String, [(Var, ())], Exp1)]
</span><a href="#local-6989586621680966360"><span class="hs-identifier hs-var">prs</span></a></span><span>
</span><span id="line-1413"></span><span>                      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; [(String, [(Var, ())], Exp1)] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; [(String, [(Var, loc)], PreExp ext loc dec)]
-&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-var">CaseE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966361"><span class="hs-identifier hs-var">e1'</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, [(Var, ())], Exp1)]
</span><a href="#local-6989586621680966362"><span class="hs-identifier hs-var">prs'</span></a></span><span>
</span><span id="line-1414"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-type">DataConE</span></a></span><span> </span><span id="local-6989586621680966366"><span class="annot"><span class="annottext">()
</span><a href="#local-6989586621680966366"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span id="local-6989586621680966367"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680966367"><span class="hs-identifier hs-var">dc</span></a></span></span><span> </span><span id="local-6989586621680966368"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680966368"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680966369"><span class="annot"><span class="annottext">es' :: [Exp1]
</span><a href="#local-6989586621680966369"><span class="hs-identifier hs-var hs-var">es'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; Exp1) -&gt; [Exp1] -&gt; [Exp1]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var Var -&gt; Var -&gt; Exp1 -&gt; Exp1 -&gt; Exp1
</span><a href="Gibbon.Passes.InferLocations.html#fixProj"><span class="hs-identifier hs-var">fixProj</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var Var
</span><a href="#local-6989586621680966318"><span class="hs-identifier hs-var">renam</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966319"><span class="hs-identifier hs-var">pvar</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966320"><span class="hs-identifier hs-var">proj</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680966368"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1415"></span><span>                           </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">() -&gt; String -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
loc -&gt; String -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-var">DataConE</span></a></span><span> </span><span class="annot"><span class="annottext">()
</span><a href="#local-6989586621680966366"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680966367"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680966369"><span class="hs-identifier hs-var">es'</span></a></span><span>
</span><span id="line-1416"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-type">TimeIt</span></a></span><span> </span><span id="local-6989586621680966370"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966370"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680966371"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966371"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621680966372"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680966372"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680966373"><span class="annot"><span class="annottext">e1' :: Exp1
</span><a href="#local-6989586621680966373"><span class="hs-identifier hs-var hs-var">e1'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var Var -&gt; Var -&gt; Exp1 -&gt; Exp1 -&gt; Exp1
</span><a href="Gibbon.Passes.InferLocations.html#fixProj"><span class="hs-identifier hs-var">fixProj</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var Var
</span><a href="#local-6989586621680966318"><span class="hs-identifier hs-var">renam</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966319"><span class="hs-identifier hs-var">pvar</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966320"><span class="hs-identifier hs-var">proj</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966370"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-1417"></span><span>                       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; Ty1 -&gt; Bool -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec -&gt; dec -&gt; Bool -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-var">TimeIt</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966373"><span class="hs-identifier hs-var">e1'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966371"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680966372"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1418"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-type">SpawnE</span></a></span><span> </span><span id="local-6989586621680966374"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966374"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680966375"><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680966375"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621680966376"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680966376"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680966377"><span class="annot"><span class="annottext">es' :: [Exp1]
</span><a href="#local-6989586621680966377"><span class="hs-identifier hs-var hs-var">es'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; Exp1) -&gt; [Exp1] -&gt; [Exp1]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var Var -&gt; Var -&gt; Exp1 -&gt; Exp1 -&gt; Exp1
</span><a href="Gibbon.Passes.InferLocations.html#fixProj"><span class="hs-identifier hs-var">fixProj</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var Var
</span><a href="#local-6989586621680966318"><span class="hs-identifier hs-var">renam</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966319"><span class="hs-identifier hs-var">pvar</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966320"><span class="hs-identifier hs-var">proj</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680966376"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-1419"></span><span>                        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [()] -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-var">SpawnE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966374"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680966375"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680966377"><span class="hs-identifier hs-var">es'</span></a></span><span>
</span><span id="line-1420"></span><span>      </span><span class="annot"><span class="annottext">Exp1
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec. PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span>
</span><span id="line-1421"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-type">WithArenaE</span></a></span><span> </span><span id="local-6989586621680966378"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966378"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680966379"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966379"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-var">WithArenaE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966378"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; Exp1) -&gt; Exp1 -&gt; Exp1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var Var -&gt; Var -&gt; Exp1 -&gt; Exp1 -&gt; Exp1
</span><a href="Gibbon.Passes.InferLocations.html#fixProj"><span class="hs-identifier hs-var">fixProj</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var Var
</span><a href="#local-6989586621680966318"><span class="hs-identifier hs-var">renam</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966319"><span class="hs-identifier hs-var">pvar</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966320"><span class="hs-identifier hs-var">proj</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966379"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1422"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L1.Syntax.html#AddFixed"><span class="hs-identifier hs-type">L1.AddFixed</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966321"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1423"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L1.Syntax.html#StartOfPkdCursor"><span class="hs-identifier hs-type">L1.StartOfPkdCursor</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680966321"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1424"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L1.Syntax.html#BenchE"><span class="hs-identifier hs-type">BenchE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Exp1
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span class="annot"><span class="annottext">(String -&gt; Exp1) -&gt; String -&gt; Exp1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;BenchE not supported&quot;</span></span><span>
</span><span id="line-1425"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MapE"><span class="hs-identifier hs-type">MapE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Exp1
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span class="annot"><span class="annottext">(String -&gt; Exp1) -&gt; String -&gt; Exp1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;MapE not supported&quot;</span></span><span>
</span><span id="line-1426"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FoldE"><span class="hs-identifier hs-type">FoldE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Exp1
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span class="annot"><span class="annottext">(String -&gt; Exp1) -&gt; String -&gt; Exp1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;FoldE not supported&quot;</span></span><span>
</span><span id="line-1427"></span><span>
</span><span id="line-1428"></span><span>
</span><span id="line-1429"></span><span class="hs-comment">-- Runs after projTups in the SpawnE case in inferExp.</span><span>
</span><span id="line-1430"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#moveProjsAfterSync"><span class="hs-identifier hs-type">moveProjsAfterSync</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">Exp2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">Exp2</span></a></span><span>
</span><span id="line-1431"></span><span id="moveProjsAfterSync"><span class="annot"><span class="annottext">moveProjsAfterSync :: Var -&gt; Exp2 -&gt; Exp2
</span><a href="Gibbon.Passes.InferLocations.html#moveProjsAfterSync"><span class="hs-identifier hs-var hs-var">moveProjsAfterSync</span></a></span></span><span> </span><span id="local-6989586621680966398"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966398"><span class="hs-identifier hs-var">sv</span></a></span></span><span> </span><span id="local-6989586621680966399"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966399"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Binds Exp2] -&gt; Set Var -&gt; Exp2 -&gt; Exp2
</span><a href="#local-6989586621680966400"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Set Var
forall a. a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#singleton"><span class="hs-identifier hs-var">S.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966398"><span class="hs-identifier hs-var">sv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966399"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1432"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1433"></span><span>    </span><span class="annot"><a href="#local-6989586621680966400"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Binds"><span class="hs-identifier hs-type">Binds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">Exp2</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">Exp2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">Exp2</span></a></span><span>
</span><span id="line-1434"></span><span>    </span><span id="local-6989586621680966400"><span class="annot"><span class="annottext">go :: [Binds Exp2] -&gt; Set Var -&gt; Exp2 -&gt; Exp2
</span><a href="#local-6989586621680966400"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680966401"><span class="annot"><span class="annottext">[Binds Exp2]
</span><a href="#local-6989586621680966401"><span class="hs-identifier hs-var">acc1</span></a></span></span><span> </span><span id="local-6989586621680966402"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966402"><span class="hs-identifier hs-var">pending</span></a></span></span><span> </span><span id="local-6989586621680966403"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966403"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1435"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966403"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1436"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966403"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1437"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-type">LitE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966403"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1438"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CharE"><span class="hs-identifier hs-type">CharE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966403"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1439"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-type">FloatE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966403"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1440"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-type">LitSymE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966403"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1441"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span id="local-6989586621680966404"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966404"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680966405"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680966405"><span class="hs-identifier hs-var">locs</span></a></span></span><span> </span><span id="local-6989586621680966406"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966406"><span class="hs-identifier hs-var">ls</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966403"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1442"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span id="local-6989586621680966407"><span class="annot"><span class="annottext">Prim Ty2
</span><a href="#local-6989586621680966407"><span class="hs-identifier hs-var">pr</span></a></span></span><span> </span><span id="local-6989586621680966408"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966408"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966403"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1443"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966409"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966409"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966410"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680966410"><span class="hs-identifier hs-var">locs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966411"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966411"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680966412"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966412"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1444"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680966413"><span class="annot"><span class="annottext">bod' :: Exp2
</span><a href="#local-6989586621680966413"><span class="hs-identifier hs-var hs-var">bod'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Binds Exp2] -&gt; Set Var -&gt; Exp2 -&gt; Exp2
</span><a href="#local-6989586621680966400"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Set Var
forall a. Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">S.empty</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966412"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-1445"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966409"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680966410"><span class="hs-identifier hs-var">locs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966411"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, [Var], Ty2, Exp2)] -&gt; Exp2 -&gt; Exp2
forall loc dec (ext :: * -&gt; * -&gt; *).
[(Var, [loc], dec, PreExp ext loc dec)]
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.html#mkLets"><span class="hs-identifier hs-var">mkLets</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Var], Ty2, Exp2)]
[Binds Exp2]
</span><a href="#local-6989586621680966401"><span class="hs-identifier hs-var">acc1</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966413"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1446"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966415"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966415"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966416"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680966416"><span class="hs-identifier hs-var">locs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966417"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966417"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966418"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966418"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680966419"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966419"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1447"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680966420"><span class="annot"><span class="annottext">vars :: Set Var
</span><a href="#local-6989586621680966420"><span class="hs-identifier hs-var hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; Set Var
</span><a href="Gibbon.L2.Syntax.html#allFreeVars"><span class="hs-identifier hs-var">allFreeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966418"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1448"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; Bool
forall a. Set a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#null"><span class="hs-identifier hs-var">S.null</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Var -&gt; Set Var -&gt; Set Var
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#intersection"><span class="hs-identifier hs-var">S.intersection</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966420"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966402"><span class="hs-identifier hs-var">pending</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1449"></span><span>             </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966415"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680966416"><span class="hs-identifier hs-var">locs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966417"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966418"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Binds Exp2] -&gt; Set Var -&gt; Exp2 -&gt; Exp2
</span><a href="#local-6989586621680966400"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Binds Exp2]
</span><a href="#local-6989586621680966401"><span class="hs-identifier hs-var">acc1</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966402"><span class="hs-identifier hs-var">pending</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966419"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1450"></span><span>             </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Binds Exp2] -&gt; Set Var -&gt; Exp2 -&gt; Exp2
</span><a href="#local-6989586621680966400"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966415"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680966416"><span class="hs-identifier hs-var">locs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966417"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966418"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2)
-&gt; [(Var, [Var], Ty2, Exp2)] -&gt; [(Var, [Var], Ty2, Exp2)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[(Var, [Var], Ty2, Exp2)]
[Binds Exp2]
</span><a href="#local-6989586621680966401"><span class="hs-identifier hs-var">acc1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Set Var -&gt; Set Var
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#insert"><span class="hs-identifier hs-var">S.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966415"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966402"><span class="hs-identifier hs-var">pending</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966419"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-1451"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-type">IfE</span></a></span><span> </span><span id="local-6989586621680966425"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966425"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680966426"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966426"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680966427"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966427"><span class="hs-identifier hs-var">c</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; Exp2 -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-var">IfE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Binds Exp2] -&gt; Set Var -&gt; Exp2 -&gt; Exp2
</span><a href="#local-6989586621680966400"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Binds Exp2]
</span><a href="#local-6989586621680966401"><span class="hs-identifier hs-var">acc1</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966402"><span class="hs-identifier hs-var">pending</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966425"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Binds Exp2] -&gt; Set Var -&gt; Exp2 -&gt; Exp2
</span><a href="#local-6989586621680966400"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Binds Exp2]
</span><a href="#local-6989586621680966401"><span class="hs-identifier hs-var">acc1</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966402"><span class="hs-identifier hs-var">pending</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966426"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Binds Exp2] -&gt; Set Var -&gt; Exp2 -&gt; Exp2
</span><a href="#local-6989586621680966400"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Binds Exp2]
</span><a href="#local-6989586621680966401"><span class="hs-identifier hs-var">acc1</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966402"><span class="hs-identifier hs-var">pending</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966427"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1452"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-type">MkProdE</span></a></span><span> </span><span id="local-6989586621680966428"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966428"><span class="hs-identifier hs-var">ls</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
[PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-var">MkProdE</span></a></span><span> </span><span class="annot"><span class="annottext">([Exp2] -&gt; Exp2) -&gt; [Exp2] -&gt; Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; Exp2) -&gt; [Exp2] -&gt; [Exp2]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">L.map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Binds Exp2] -&gt; Set Var -&gt; Exp2 -&gt; Exp2
</span><a href="#local-6989586621680966400"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Binds Exp2]
</span><a href="#local-6989586621680966401"><span class="hs-identifier hs-var">acc1</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966402"><span class="hs-identifier hs-var">pending</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966428"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1453"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-type">ProjE</span></a></span><span> </span><span id="local-6989586621680966429"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680966429"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680966430"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966430"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Int -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-var">ProjE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680966429"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; Exp2) -&gt; Exp2 -&gt; Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Binds Exp2] -&gt; Set Var -&gt; Exp2 -&gt; Exp2
</span><a href="#local-6989586621680966400"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Binds Exp2]
</span><a href="#local-6989586621680966401"><span class="hs-identifier hs-var">acc1</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966402"><span class="hs-identifier hs-var">pending</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966430"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-1454"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-type">CaseE</span></a></span><span> </span><span id="local-6989586621680966431"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966431"><span class="hs-identifier hs-var">scrt</span></a></span></span><span> </span><span id="local-6989586621680966432"><span class="annot"><span class="annottext">[(String, [(Var, Var)], Exp2)]
</span><a href="#local-6989586621680966432"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; [(String, [(Var, Var)], Exp2)] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; [(String, [(Var, loc)], PreExp ext loc dec)]
-&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-var">CaseE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Binds Exp2] -&gt; Set Var -&gt; Exp2 -&gt; Exp2
</span><a href="#local-6989586621680966400"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Binds Exp2]
</span><a href="#local-6989586621680966401"><span class="hs-identifier hs-var">acc1</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966402"><span class="hs-identifier hs-var">pending</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966431"><span class="hs-identifier hs-var">scrt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(String, [(Var, Var)], Exp2)] -&gt; Exp2)
-&gt; [(String, [(Var, Var)], Exp2)] -&gt; Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1455"></span><span>                           </span><span class="annot"><span class="annottext">((String, [(Var, Var)], Exp2) -&gt; (String, [(Var, Var)], Exp2))
-&gt; [(String, [(Var, Var)], Exp2)] -&gt; [(String, [(Var, Var)], Exp2)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">L.map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680966433"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680966433"><span class="hs-identifier hs-var">dcon</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966434"><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680966434"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966435"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966435"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680966433"><span class="hs-identifier hs-var">dcon</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680966434"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Binds Exp2] -&gt; Set Var -&gt; Exp2 -&gt; Exp2
</span><a href="#local-6989586621680966400"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Binds Exp2]
</span><a href="#local-6989586621680966401"><span class="hs-identifier hs-var">acc1</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966402"><span class="hs-identifier hs-var">pending</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966435"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(String, [(Var, Var)], Exp2)]
</span><a href="#local-6989586621680966432"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1456"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-type">DataConE</span></a></span><span> </span><span id="local-6989586621680966436"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966436"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621680966437"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680966437"><span class="hs-identifier hs-var">dcon</span></a></span></span><span> </span><span id="local-6989586621680966438"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966438"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; String -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
loc -&gt; String -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-var">DataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966436"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680966437"><span class="hs-identifier hs-var">dcon</span></a></span><span> </span><span class="annot"><span class="annottext">([Exp2] -&gt; Exp2) -&gt; [Exp2] -&gt; Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; Exp2) -&gt; [Exp2] -&gt; [Exp2]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">L.map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Binds Exp2] -&gt; Set Var -&gt; Exp2 -&gt; Exp2
</span><a href="#local-6989586621680966400"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Binds Exp2]
</span><a href="#local-6989586621680966401"><span class="hs-identifier hs-var">acc1</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966402"><span class="hs-identifier hs-var">pending</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966438"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1457"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-type">TimeIt</span></a></span><span> </span><span id="local-6989586621680966439"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966439"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621680966440"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966440"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680966441"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680966441"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; Ty2 -&gt; Bool -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec -&gt; dec -&gt; Bool -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-var">TimeIt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Binds Exp2] -&gt; Set Var -&gt; Exp2 -&gt; Exp2
</span><a href="#local-6989586621680966400"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Binds Exp2]
</span><a href="#local-6989586621680966401"><span class="hs-identifier hs-var">acc1</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966402"><span class="hs-identifier hs-var">pending</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966439"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966440"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680966441"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1458"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-type">WithArenaE</span></a></span><span> </span><span id="local-6989586621680966442"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966442"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680966443"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966443"><span class="hs-identifier hs-var">e</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-var">WithArenaE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966442"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; Exp2) -&gt; Exp2 -&gt; Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Binds Exp2] -&gt; Set Var -&gt; Exp2 -&gt; Exp2
</span><a href="#local-6989586621680966400"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Binds Exp2]
</span><a href="#local-6989586621680966401"><span class="hs-identifier hs-var">acc1</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966402"><span class="hs-identifier hs-var">pending</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966443"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1459"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-type">SpawnE</span></a></span><span> </span><span id="local-6989586621680966444"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966444"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621680966445"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680966445"><span class="hs-identifier hs-var">locs</span></a></span></span><span> </span><span id="local-6989586621680966446"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680966446"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Exp2
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;moveProjsAfterSync: unbound SpawnE&quot;</span></span><span>
</span><span id="line-1460"></span><span>        </span><span class="annot"><span class="annottext">Exp2
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Exp2
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;moveProjsAfterSync: unbound SyncE&quot;</span></span><span>
</span><span id="line-1461"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span id="local-6989586621680966447"><span class="annot"><span class="annottext">E2Ext Var Ty2
</span><a href="#local-6989586621680966447"><span class="hs-identifier hs-var">ext</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">E2Ext Var Ty2
</span><a href="#local-6989586621680966447"><span class="hs-identifier hs-var">ext</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1462"></span><span>                     </span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetRegionE"><span class="hs-identifier hs-type">LetRegionE</span></a></span><span> </span><span id="local-6989586621680966448"><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680966448"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680966449"><span class="annot"><span class="annottext">RegionSize
</span><a href="#local-6989586621680966449"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span id="local-6989586621680966450"><span class="annot"><span class="annottext">Maybe RegionType
</span><a href="#local-6989586621680966450"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680966451"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966451"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E2Ext Var Ty2 -&gt; Exp2) -&gt; E2Ext Var Ty2 -&gt; Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Region -&gt; RegionSize -&gt; Maybe RegionType -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec.
Region
-&gt; RegionSize -&gt; Maybe RegionType -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetRegionE"><span class="hs-identifier hs-var">LetRegionE</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680966448"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">RegionSize
</span><a href="#local-6989586621680966449"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RegionType
</span><a href="#local-6989586621680966450"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; E2Ext Var Ty2) -&gt; Exp2 -&gt; E2Ext Var Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Binds Exp2] -&gt; Set Var -&gt; Exp2 -&gt; Exp2
</span><a href="#local-6989586621680966400"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Binds Exp2]
</span><a href="#local-6989586621680966401"><span class="hs-identifier hs-var">acc1</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966402"><span class="hs-identifier hs-var">pending</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966451"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-1463"></span><span>                     </span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetParRegionE"><span class="hs-identifier hs-type">LetParRegionE</span></a></span><span> </span><span id="local-6989586621680966452"><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680966452"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680966453"><span class="annot"><span class="annottext">RegionSize
</span><a href="#local-6989586621680966453"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span id="local-6989586621680966454"><span class="annot"><span class="annottext">Maybe RegionType
</span><a href="#local-6989586621680966454"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680966455"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966455"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E2Ext Var Ty2 -&gt; Exp2) -&gt; E2Ext Var Ty2 -&gt; Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Region -&gt; RegionSize -&gt; Maybe RegionType -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec.
Region
-&gt; RegionSize -&gt; Maybe RegionType -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetParRegionE"><span class="hs-identifier hs-var">LetParRegionE</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680966452"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">RegionSize
</span><a href="#local-6989586621680966453"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RegionType
</span><a href="#local-6989586621680966454"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; E2Ext Var Ty2) -&gt; Exp2 -&gt; E2Ext Var Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Binds Exp2] -&gt; Set Var -&gt; Exp2 -&gt; Exp2
</span><a href="#local-6989586621680966400"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Binds Exp2]
</span><a href="#local-6989586621680966401"><span class="hs-identifier hs-var">acc1</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966402"><span class="hs-identifier hs-var">pending</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966455"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-1464"></span><span>                     </span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-type">LetLocE</span></a></span><span> </span><span id="local-6989586621680966456"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966456"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680966457"><span class="annot"><span class="annottext">PreLocExp Var
</span><a href="#local-6989586621680966457"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680966458"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966458"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E2Ext Var Ty2 -&gt; Exp2) -&gt; E2Ext Var Ty2 -&gt; Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; PreLocExp Var -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; PreLocExp loc -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-var">LetLocE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966456"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">PreLocExp Var
</span><a href="#local-6989586621680966457"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; E2Ext Var Ty2) -&gt; Exp2 -&gt; E2Ext Var Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Binds Exp2] -&gt; Set Var -&gt; Exp2 -&gt; Exp2
</span><a href="#local-6989586621680966400"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Binds Exp2]
</span><a href="#local-6989586621680966401"><span class="hs-identifier hs-var">acc1</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680966402"><span class="hs-identifier hs-var">pending</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966458"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-1465"></span><span>                     </span><span id="local-6989586621680966459"><span class="annot"><span class="annottext">E2Ext Var Ty2
</span><a href="#local-6989586621680966459"><span class="hs-identifier hs-var">oth</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Exp2
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Exp2) -&gt; String -&gt; Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;moveProjsAfterSync: extension not handled.&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">E2Ext Var Ty2
</span><a href="#local-6989586621680966459"><span class="hs-identifier hs-var">oth</span></a></span><span>
</span><span id="line-1466"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MapE"><span class="hs-identifier hs-type">MapE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Exp2
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;moveProjsAfterSync: todo MapE&quot;</span></span><span>
</span><span id="line-1467"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FoldE"><span class="hs-identifier hs-type">FoldE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Exp2
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;moveProjsAfterSync: todo FoldE&quot;</span></span><span>
</span><span id="line-1468"></span><span>
</span><span id="line-1469"></span><span>
</span><span id="line-1470"></span><span class="hs-comment">-- | Checks that there are no constraints specifying a location</span><span>
</span><span id="line-1471"></span><span class="hs-comment">-- after the location passed in.</span><span>
</span><span id="line-1472"></span><span class="hs-comment">-- TODO: refactor to only take one list of constraints.</span><span>
</span><span id="line-1473"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#noAfterLoc"><span class="hs-identifier hs-type">noAfterLoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-1474"></span><span id="noAfterLoc"><span class="annot"><span class="annottext">noAfterLoc :: Var -&gt; [Constraint] -&gt; [Constraint] -&gt; TiM Bool
</span><a href="Gibbon.Passes.InferLocations.html#noAfterLoc"><span class="hs-identifier hs-var hs-var">noAfterLoc</span></a></span></span><span> </span><span id="local-6989586621680966475"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966475"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span id="local-6989586621680966476"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680966476"><span class="hs-identifier hs-var">fcs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966477"><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680966477"><span class="hs-identifier hs-var">c</span></a></span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680966478"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680966478"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1475"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680966477"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1476"></span><span>      </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#AfterVariableL"><span class="hs-identifier hs-type">AfterVariableL</span></a></span><span> </span><span id="local-6989586621680966479"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966479"><span class="hs-identifier hs-var">lv1</span></a></span></span><span> </span><span id="local-6989586621680966480"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966480"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680966481"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966481"><span class="hs-identifier hs-var">lv2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1477"></span><span>          </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680966482"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966482"><span class="hs-identifier hs-var">lv2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966481"><span class="hs-identifier hs-var">lv2</span></a></span><span>
</span><span id="line-1478"></span><span>             </span><span id="local-6989586621680966483"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966483"><span class="hs-identifier hs-var">lv'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966475"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-1479"></span><span>             </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966483"><span class="hs-identifier hs-var">lv'</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966482"><span class="hs-identifier hs-var">lv2'</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TiM Bool
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Constraint] -&gt; [Constraint] -&gt; TiM Bool
</span><a href="Gibbon.Passes.InferLocations.html#noAfterLoc"><span class="hs-identifier hs-var">noAfterLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966475"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680966476"><span class="hs-identifier hs-var">fcs</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680966478"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-1480"></span><span>      </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#AfterTagL"><span class="hs-identifier hs-type">AfterTagL</span></a></span><span> </span><span id="local-6989586621680966484"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966484"><span class="hs-identifier hs-var">lv1</span></a></span></span><span> </span><span id="local-6989586621680966485"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966485"><span class="hs-identifier hs-var">lv2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1481"></span><span>          </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680966486"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966486"><span class="hs-identifier hs-var">lv2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966485"><span class="hs-identifier hs-var">lv2</span></a></span><span>
</span><span id="line-1482"></span><span>             </span><span id="local-6989586621680966487"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966487"><span class="hs-identifier hs-var">lv'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966475"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-1483"></span><span>             </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966487"><span class="hs-identifier hs-var">lv'</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966486"><span class="hs-identifier hs-var">lv2'</span></a></span><span>
</span><span id="line-1484"></span><span>             </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TiM Bool
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-1485"></span><span>                 </span><span class="hs-comment">-- do b1 &lt;- noAfterLoc lv fcs cs</span><span>
</span><span id="line-1486"></span><span>                 </span><span class="hs-comment">--    b2 &lt;- noAfterLoc lv1 fcs fcs</span><span>
</span><span id="line-1487"></span><span>                 </span><span class="hs-comment">--    return (b1 &amp;&amp; b2)</span><span>
</span><span id="line-1488"></span><span>             </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Constraint] -&gt; [Constraint] -&gt; TiM Bool
</span><a href="Gibbon.Passes.InferLocations.html#noAfterLoc"><span class="hs-identifier hs-var">noAfterLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966475"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680966476"><span class="hs-identifier hs-var">fcs</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680966478"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-1489"></span><span>      </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#AfterConstantL"><span class="hs-identifier hs-type">AfterConstantL</span></a></span><span> </span><span id="local-6989586621680966488"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966488"><span class="hs-identifier hs-var">lv1</span></a></span></span><span> </span><span id="local-6989586621680966489"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680966489"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680966490"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966490"><span class="hs-identifier hs-var">lv2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1490"></span><span>          </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680966491"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966491"><span class="hs-identifier hs-var">lv2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966490"><span class="hs-identifier hs-var">lv2</span></a></span><span>
</span><span id="line-1491"></span><span>             </span><span id="local-6989586621680966492"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966492"><span class="hs-identifier hs-var">lv'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966475"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-1492"></span><span>             </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966492"><span class="hs-identifier hs-var">lv'</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966491"><span class="hs-identifier hs-var">lv2'</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TiM Bool
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Constraint] -&gt; [Constraint] -&gt; TiM Bool
</span><a href="Gibbon.Passes.InferLocations.html#noAfterLoc"><span class="hs-identifier hs-var">noAfterLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966475"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680966476"><span class="hs-identifier hs-var">fcs</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680966478"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-1493"></span><span>      </span><span class="annot"><span class="annottext">Constraint
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Constraint] -&gt; [Constraint] -&gt; TiM Bool
</span><a href="Gibbon.Passes.InferLocations.html#noAfterLoc"><span class="hs-identifier hs-var">noAfterLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966475"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680966476"><span class="hs-identifier hs-var">fcs</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680966478"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-1494"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#noAfterLoc"><span class="hs-identifier hs-var">noAfterLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TiM Bool
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1495"></span><span>
</span><span id="line-1496"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#noBeforeLoc"><span class="hs-identifier hs-type">noBeforeLoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-1497"></span><span id="noBeforeLoc"><span class="annot"><span class="annottext">noBeforeLoc :: Var -&gt; [Constraint] -&gt; TiM Bool
</span><a href="Gibbon.Passes.InferLocations.html#noBeforeLoc"><span class="hs-identifier hs-var hs-var">noBeforeLoc</span></a></span></span><span> </span><span id="local-6989586621680966508"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966508"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966509"><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680966509"><span class="hs-identifier hs-var">c</span></a></span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680966510"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680966510"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1498"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680966509"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1499"></span><span>      </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#AfterVariableL"><span class="hs-identifier hs-type">AfterVariableL</span></a></span><span> </span><span id="local-6989586621680966511"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966511"><span class="hs-identifier hs-var">lv1</span></a></span></span><span> </span><span id="local-6989586621680966512"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966512"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680966513"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966513"><span class="hs-identifier hs-var">lv2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1500"></span><span>          </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680966514"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966514"><span class="hs-identifier hs-var">lv1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966511"><span class="hs-identifier hs-var">lv1</span></a></span><span>
</span><span id="line-1501"></span><span>             </span><span id="local-6989586621680966515"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966515"><span class="hs-identifier hs-var">lv'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966508"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-1502"></span><span>             </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966515"><span class="hs-identifier hs-var">lv'</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966514"><span class="hs-identifier hs-var">lv1'</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TiM Bool
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Constraint] -&gt; TiM Bool
</span><a href="Gibbon.Passes.InferLocations.html#noBeforeLoc"><span class="hs-identifier hs-var">noBeforeLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966508"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680966510"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-1503"></span><span>      </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#AfterConstantL"><span class="hs-identifier hs-type">AfterConstantL</span></a></span><span> </span><span id="local-6989586621680966516"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966516"><span class="hs-identifier hs-var">lv1</span></a></span></span><span> </span><span id="local-6989586621680966517"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680966517"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680966518"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966518"><span class="hs-identifier hs-var">lv2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1504"></span><span>          </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680966519"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966519"><span class="hs-identifier hs-var">lv1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966516"><span class="hs-identifier hs-var">lv1</span></a></span><span>
</span><span id="line-1505"></span><span>             </span><span id="local-6989586621680966520"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966520"><span class="hs-identifier hs-var">lv'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966508"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-1506"></span><span>             </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966520"><span class="hs-identifier hs-var">lv'</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966519"><span class="hs-identifier hs-var">lv1'</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TiM Bool
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Constraint] -&gt; TiM Bool
</span><a href="Gibbon.Passes.InferLocations.html#noBeforeLoc"><span class="hs-identifier hs-var">noBeforeLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966508"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680966510"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-1507"></span><span>      </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#AfterTagL"><span class="hs-identifier hs-type">AfterTagL</span></a></span><span> </span><span id="local-6989586621680966521"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966521"><span class="hs-identifier hs-var">lv1</span></a></span></span><span> </span><span id="local-6989586621680966522"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966522"><span class="hs-identifier hs-var">lv2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1508"></span><span>          </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680966523"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966523"><span class="hs-identifier hs-var">lv1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966521"><span class="hs-identifier hs-var">lv1</span></a></span><span>
</span><span id="line-1509"></span><span>             </span><span id="local-6989586621680966524"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966524"><span class="hs-identifier hs-var">lv'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var">finalLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966508"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-1510"></span><span>             </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966524"><span class="hs-identifier hs-var">lv'</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966523"><span class="hs-identifier hs-var">lv1'</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TiM Bool
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Constraint] -&gt; TiM Bool
</span><a href="Gibbon.Passes.InferLocations.html#noBeforeLoc"><span class="hs-identifier hs-var">noBeforeLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966508"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680966510"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-1511"></span><span>      </span><span class="annot"><span class="annottext">Constraint
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Constraint] -&gt; TiM Bool
</span><a href="Gibbon.Passes.InferLocations.html#noBeforeLoc"><span class="hs-identifier hs-var">noBeforeLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966508"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680966510"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-1512"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#noBeforeLoc"><span class="hs-identifier hs-var">noBeforeLoc</span></a></span><span> </span><span id="local-6989586621680966525"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966525"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TiM Bool
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1513"></span><span>
</span><span id="line-1514"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#noRegionStart"><span class="hs-identifier hs-type">noRegionStart</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-1515"></span><span id="noRegionStart"><span class="annot"><span class="annottext">noRegionStart :: Var -&gt; [Constraint] -&gt; TiM Bool
</span><a href="Gibbon.Passes.InferLocations.html#noRegionStart"><span class="hs-identifier hs-var hs-var">noRegionStart</span></a></span></span><span> </span><span id="local-6989586621680966533"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966533"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966534"><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680966534"><span class="hs-identifier hs-var">c</span></a></span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680966535"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680966535"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1516"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Constraint
</span><a href="#local-6989586621680966534"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1517"></span><span>      </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#StartRegionL"><span class="hs-identifier hs-type">StartRegionL</span></a></span><span> </span><span id="local-6989586621680966536"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966536"><span class="hs-identifier hs-var">lv2</span></a></span></span><span> </span><span id="local-6989586621680966537"><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680966537"><span class="hs-identifier hs-var">_r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966533"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966536"><span class="hs-identifier hs-var">lv2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; TiM Bool -&gt; TiM Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Constraint] -&gt; TiM Bool
</span><a href="Gibbon.Passes.InferLocations.html#noRegionStart"><span class="hs-identifier hs-var">noRegionStart</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966533"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680966535"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-1518"></span><span>      </span><span class="annot"><span class="annottext">Constraint
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Constraint] -&gt; TiM Bool
</span><a href="Gibbon.Passes.InferLocations.html#noRegionStart"><span class="hs-identifier hs-var">noRegionStart</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966533"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680966535"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-1519"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#noRegionStart"><span class="hs-identifier hs-var">noRegionStart</span></a></span><span> </span><span id="local-6989586621680966539"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966539"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TiM Bool
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1520"></span><span>
</span><span id="line-1521"></span><span class="hs-comment">-- | Unify is a conditional form that takes a &quot;success branch&quot; and</span><span>
</span><span id="line-1522"></span><span class="hs-comment">-- &quot;failure branch&quot;.  In the case of failure, it makes no change to</span><span>
</span><span id="line-1523"></span><span class="hs-comment">-- the store.  In the case of success, the new equalities are placed</span><span>
</span><span id="line-1524"></span><span class="hs-comment">-- in the store /before/ executing the success branch.</span><span>
</span><span id="line-1525"></span><span id="local-6989586621680963009"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#unify"><span class="hs-identifier hs-type">unify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680963009"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680963009"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680963009"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1526"></span><span id="unify"><span class="annot"><span class="annottext">unify :: forall a. Var -&gt; Var -&gt; TiM a -&gt; TiM a -&gt; TiM a
</span><a href="Gibbon.Passes.InferLocations.html#unify"><span class="hs-identifier hs-var hs-var">unify</span></a></span></span><span> </span><span id="local-6989586621680966548"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966548"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span id="local-6989586621680966549"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966549"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span id="local-6989586621680966550"><span class="annot"><span class="annottext">TiM a
</span><a href="#local-6989586621680966550"><span class="hs-identifier hs-var">successA</span></a></span></span><span> </span><span id="local-6989586621680966551"><span class="annot"><span class="annottext">TiM a
</span><a href="#local-6989586621680966551"><span class="hs-identifier hs-var">failA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1527"></span><span>  </span><span id="local-6989586621680966552"><span class="annot"><span class="annottext">UnifyLoc
</span><a href="#local-6989586621680966552"><span class="hs-identifier hs-var">ut1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM UnifyLoc
</span><a href="Gibbon.Passes.InferLocations.html#lookupUnifyLoc"><span class="hs-identifier hs-var">lookupUnifyLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966548"><span class="hs-identifier hs-var">v1</span></a></span><span>
</span><span id="line-1528"></span><span>  </span><span id="local-6989586621680966553"><span class="annot"><span class="annottext">UnifyLoc
</span><a href="#local-6989586621680966553"><span class="hs-identifier hs-var">ut2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM UnifyLoc
</span><a href="Gibbon.Passes.InferLocations.html#lookupUnifyLoc"><span class="hs-identifier hs-var">lookupUnifyLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966549"><span class="hs-identifier hs-var">v2</span></a></span><span>
</span><span id="line-1529"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnifyLoc
</span><a href="#local-6989586621680966552"><span class="hs-identifier hs-var">ut1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">UnifyLoc
</span><a href="#local-6989586621680966553"><span class="hs-identifier hs-var">ut2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1530"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FixedLoc"><span class="hs-identifier hs-type">FixedLoc</span></a></span><span> </span><span id="local-6989586621680966554"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966554"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FixedLoc"><span class="hs-identifier hs-type">FixedLoc</span></a></span><span> </span><span id="local-6989586621680966555"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966555"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1531"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966554"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966555"><span class="hs-identifier hs-var">l2</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">TiM a
</span><a href="#local-6989586621680966550"><span class="hs-identifier hs-var">successA</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">TiM a
</span><a href="#local-6989586621680966551"><span class="hs-identifier hs-var">failA</span></a></span><span>
</span><span id="line-1532"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FreshLoc"><span class="hs-identifier hs-type">FreshLoc</span></a></span><span> </span><span id="local-6989586621680966556"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966556"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FixedLoc"><span class="hs-identifier hs-type">FixedLoc</span></a></span><span> </span><span id="local-6989586621680966557"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966557"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1533"></span><span>        </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">Var -&gt; UnifyLoc -&gt; ExceptT Failure (StateT InferState PassM) ()
</span><a href="Gibbon.Passes.InferLocations.html#assocLoc"><span class="hs-identifier hs-var">assocLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966556"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; UnifyLoc
</span><a href="Gibbon.Passes.InferLocations.html#FixedLoc"><span class="hs-identifier hs-var">FixedLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966557"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1534"></span><span>           </span><span class="annot"><span class="annottext">TiM a
</span><a href="#local-6989586621680966550"><span class="hs-identifier hs-var">successA</span></a></span><span>
</span><span id="line-1535"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FixedLoc"><span class="hs-identifier hs-type">FixedLoc</span></a></span><span> </span><span id="local-6989586621680966558"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966558"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FreshLoc"><span class="hs-identifier hs-type">FreshLoc</span></a></span><span> </span><span id="local-6989586621680966559"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966559"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1536"></span><span>        </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">Var -&gt; UnifyLoc -&gt; ExceptT Failure (StateT InferState PassM) ()
</span><a href="Gibbon.Passes.InferLocations.html#assocLoc"><span class="hs-identifier hs-var">assocLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966559"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; UnifyLoc
</span><a href="Gibbon.Passes.InferLocations.html#FixedLoc"><span class="hs-identifier hs-var">FixedLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966558"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1537"></span><span>           </span><span class="annot"><span class="annottext">TiM a
</span><a href="#local-6989586621680966550"><span class="hs-identifier hs-var">successA</span></a></span><span>
</span><span id="line-1538"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FreshLoc"><span class="hs-identifier hs-type">FreshLoc</span></a></span><span> </span><span id="local-6989586621680966560"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966560"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FreshLoc"><span class="hs-identifier hs-type">FreshLoc</span></a></span><span> </span><span id="local-6989586621680966561"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966561"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1539"></span><span>        </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">Var -&gt; UnifyLoc -&gt; ExceptT Failure (StateT InferState PassM) ()
</span><a href="Gibbon.Passes.InferLocations.html#assocLoc"><span class="hs-identifier hs-var">assocLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966560"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; UnifyLoc
</span><a href="Gibbon.Passes.InferLocations.html#FreshLoc"><span class="hs-identifier hs-var">FreshLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966561"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1540"></span><span>           </span><span class="annot"><span class="annottext">TiM a
</span><a href="#local-6989586621680966550"><span class="hs-identifier hs-var">successA</span></a></span><span>
</span><span id="line-1541"></span><span>
</span><span id="line-1542"></span><span id="local-6989586621680963007"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#unifyAll"><span class="hs-identifier hs-type">unifyAll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Dest"><span class="hs-identifier hs-type">Dest</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680963007"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680963007"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680963007"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1543"></span><span id="unifyAll"><span class="annot"><span class="annottext">unifyAll :: forall a. [Dest] -&gt; [Ty2] -&gt; TiM a -&gt; TiM a -&gt; TiM a
</span><a href="Gibbon.Passes.InferLocations.html#unifyAll"><span class="hs-identifier hs-var hs-var">unifyAll</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966584"><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680966584"><span class="hs-identifier hs-var">d</span></a></span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680966585"><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680966585"><span class="hs-identifier hs-var">ds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966586"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966586"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680966587"><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680966587"><span class="hs-identifier hs-var">tys</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680966588"><span class="annot"><span class="annottext">TiM a
</span><a href="#local-6989586621680966588"><span class="hs-identifier hs-var">successA</span></a></span></span><span> </span><span id="local-6989586621680966589"><span class="annot"><span class="annottext">TiM a
</span><a href="#local-6989586621680966589"><span class="hs-identifier hs-var">failA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1544"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680966584"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966586"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1545"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#SingleDest"><span class="hs-identifier hs-type">SingleDest</span></a></span><span> </span><span id="local-6989586621680966590"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966590"><span class="hs-identifier hs-var">lv1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680966591"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966591"><span class="hs-identifier hs-var">lv2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; TiM a -&gt; TiM a -&gt; TiM a
forall a. Var -&gt; Var -&gt; TiM a -&gt; TiM a -&gt; TiM a
</span><a href="Gibbon.Passes.InferLocations.html#unify"><span class="hs-identifier hs-var">unify</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966590"><span class="hs-identifier hs-var">lv1</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966591"><span class="hs-identifier hs-var">lv2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Dest] -&gt; [Ty2] -&gt; TiM a -&gt; TiM a -&gt; TiM a
forall a. [Dest] -&gt; [Ty2] -&gt; TiM a -&gt; TiM a -&gt; TiM a
</span><a href="Gibbon.Passes.InferLocations.html#unifyAll"><span class="hs-identifier hs-var">unifyAll</span></a></span><span> </span><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680966585"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680966587"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">TiM a
</span><a href="#local-6989586621680966588"><span class="hs-identifier hs-var">successA</span></a></span><span> </span><span class="annot"><span class="annottext">TiM a
</span><a href="#local-6989586621680966589"><span class="hs-identifier hs-var">failA</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TiM a
</span><a href="#local-6989586621680966589"><span class="hs-identifier hs-var">failA</span></a></span><span>
</span><span id="line-1546"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TupleDest"><span class="hs-identifier hs-type">TupleDest</span></a></span><span> </span><span id="local-6989586621680966592"><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680966592"><span class="hs-identifier hs-var">ds'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span id="local-6989586621680966593"><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680966593"><span class="hs-identifier hs-var">tys'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Dest] -&gt; [Ty2] -&gt; TiM a -&gt; TiM a -&gt; TiM a
forall a. [Dest] -&gt; [Ty2] -&gt; TiM a -&gt; TiM a -&gt; TiM a
</span><a href="Gibbon.Passes.InferLocations.html#unifyAll"><span class="hs-identifier hs-var">unifyAll</span></a></span><span> </span><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680966592"><span class="hs-identifier hs-var">ds'</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680966593"><span class="hs-identifier hs-var">tys'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Dest] -&gt; [Ty2] -&gt; TiM a -&gt; TiM a -&gt; TiM a
forall a. [Dest] -&gt; [Ty2] -&gt; TiM a -&gt; TiM a -&gt; TiM a
</span><a href="Gibbon.Passes.InferLocations.html#unifyAll"><span class="hs-identifier hs-var">unifyAll</span></a></span><span> </span><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680966585"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680966587"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">TiM a
</span><a href="#local-6989586621680966588"><span class="hs-identifier hs-var">successA</span></a></span><span> </span><span class="annot"><span class="annottext">TiM a
</span><a href="#local-6989586621680966589"><span class="hs-identifier hs-var">failA</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TiM a
</span><a href="#local-6989586621680966589"><span class="hs-identifier hs-var">failA</span></a></span><span>
</span><span id="line-1547"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM a
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span class="annot"><span class="annottext">(String -&gt; TiM a) -&gt; String -&gt; TiM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected destination for packed type&quot;</span></span><span>
</span><span id="line-1548"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#SingleDest"><span class="hs-identifier hs-type">SingleDest</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProdTy"><span class="hs-identifier hs-type">ProdTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM a
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span class="annot"><span class="annottext">(String -&gt; TiM a) -&gt; String -&gt; TiM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected prod destination for prod type: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Dest, Ty2) -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680966584"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966586"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1549"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#SingleDest"><span class="hs-identifier hs-type">SingleDest</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Dest] -&gt; [Ty2] -&gt; TiM a -&gt; TiM a -&gt; TiM a
forall a. [Dest] -&gt; [Ty2] -&gt; TiM a -&gt; TiM a -&gt; TiM a
</span><a href="Gibbon.Passes.InferLocations.html#unifyAll"><span class="hs-identifier hs-var">unifyAll</span></a></span><span> </span><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680966585"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680966587"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">TiM a
</span><a href="#local-6989586621680966588"><span class="hs-identifier hs-var">successA</span></a></span><span> </span><span class="annot"><span class="annottext">TiM a
</span><a href="#local-6989586621680966589"><span class="hs-identifier hs-var">failA</span></a></span><span>
</span><span id="line-1550"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TupleDest"><span class="hs-identifier hs-type">TupleDest</span></a></span><span> </span><span class="annot"><span class="annottext">[Dest]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM a
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span class="annot"><span class="annottext">(String -&gt; TiM a) -&gt; String -&gt; TiM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected prod type for prod destination: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Dest, Ty2) -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dest
</span><a href="#local-6989586621680966584"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966586"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1551"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TupleDest"><span class="hs-identifier hs-type">TupleDest</span></a></span><span> </span><span class="annot"><span class="annottext">[Dest]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Dest] -&gt; [Ty2] -&gt; TiM a -&gt; TiM a -&gt; TiM a
forall a. [Dest] -&gt; [Ty2] -&gt; TiM a -&gt; TiM a -&gt; TiM a
</span><a href="Gibbon.Passes.InferLocations.html#unifyAll"><span class="hs-identifier hs-var">unifyAll</span></a></span><span> </span><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680966585"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680966587"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">TiM a
</span><a href="#local-6989586621680966588"><span class="hs-identifier hs-var">successA</span></a></span><span> </span><span class="annot"><span class="annottext">TiM a
</span><a href="#local-6989586621680966589"><span class="hs-identifier hs-var">failA</span></a></span><span>
</span><span id="line-1552"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dest
</span><a href="Gibbon.Passes.InferLocations.html#NoDest"><span class="hs-identifier hs-var">NoDest</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Dest] -&gt; [Ty2] -&gt; TiM a -&gt; TiM a -&gt; TiM a
forall a. [Dest] -&gt; [Ty2] -&gt; TiM a -&gt; TiM a -&gt; TiM a
</span><a href="Gibbon.Passes.InferLocations.html#unifyAll"><span class="hs-identifier hs-var">unifyAll</span></a></span><span> </span><span class="annot"><span class="annottext">[Dest]
</span><a href="#local-6989586621680966585"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680966587"><span class="hs-identifier hs-var">tys</span></a></span><span> </span><span class="annot"><span class="annottext">TiM a
</span><a href="#local-6989586621680966588"><span class="hs-identifier hs-var">successA</span></a></span><span> </span><span class="annot"><span class="annottext">TiM a
</span><a href="#local-6989586621680966589"><span class="hs-identifier hs-var">failA</span></a></span><span>
</span><span id="line-1553"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#unifyAll"><span class="hs-identifier hs-var">unifyAll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dest
</span><span class="hs-identifier">_</span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><span class="annottext">[Dest]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">TiM a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TiM a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM a
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span class="annot"><span class="annottext">(String -&gt; TiM a) -&gt; String -&gt; TiM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Mismatched destination and product type arity&quot;</span></span><span>
</span><span id="line-1554"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#unifyAll"><span class="hs-identifier hs-var">unifyAll</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><span class="annottext">[Ty2]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TiM a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TiM a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM a
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span class="annot"><span class="annottext">(String -&gt; TiM a) -&gt; String -&gt; TiM a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Mismatched destination and product type arity&quot;</span></span><span>
</span><span id="line-1555"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#unifyAll"><span class="hs-identifier hs-var">unifyAll</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621680966594"><span class="annot"><span class="annottext">TiM a
</span><a href="#local-6989586621680966594"><span class="hs-identifier hs-var">successA</span></a></span></span><span> </span><span class="annot"><span class="annottext">TiM a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TiM a
</span><a href="#local-6989586621680966594"><span class="hs-identifier hs-var">successA</span></a></span><span>
</span><span id="line-1556"></span><span>
</span><span id="line-1557"></span><span>
</span><span id="line-1558"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#isCpyCallExpr1"><span class="hs-identifier hs-type">isCpyCallExpr1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Exp1"><span class="hs-identifier hs-type">Exp1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span>
</span><span id="line-1559"></span><span id="isCpyCallExpr1"><span class="annot"><span class="annottext">isCpyCallExpr1 :: Exp1 -&gt; Bool
</span><a href="Gibbon.Passes.InferLocations.html#isCpyCallExpr1"><span class="hs-identifier hs-var hs-var">isCpyCallExpr1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span id="local-6989586621680966596"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966596"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">[()]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Bool
</span><a href="Gibbon.Passes.InferLocations.html#isCpyVar"><span class="hs-identifier hs-var">isCpyVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966596"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1560"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#isCpyCallExpr1"><span class="hs-identifier hs-var">isCpyCallExpr1</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-1561"></span><span>
</span><span id="line-1562"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#isCpyVar"><span class="hs-identifier hs-type">isCpyVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-1563"></span><span id="isCpyVar"><span class="annot"><span class="annottext">isCpyVar :: Var -&gt; Bool
</span><a href="Gibbon.Passes.InferLocations.html#isCpyVar"><span class="hs-identifier hs-var hs-var">isCpyVar</span></a></span></span><span> </span><span id="local-6989586621680966602"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966602"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.OldList.html#isInfixOf"><span class="hs-identifier hs-var">L.isInfixOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;copy&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; String
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966602"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1564"></span><span>
</span><span id="line-1565"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#isCpyCall"><span class="hs-identifier hs-type">isCpyCall</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">Exp2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-1566"></span><span id="isCpyCall"><span class="annot"><span class="annottext">isCpyCall :: Exp2 -&gt; Bool
</span><a href="Gibbon.Passes.InferLocations.html#isCpyCall"><span class="hs-identifier hs-var hs-var">isCpyCall</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span id="local-6989586621680966605"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966605"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-comment">-- TODO: check if it's a real copy call, to be safe</span><span>
</span><span id="line-1567"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#isCpyCall"><span class="hs-identifier hs-var">isCpyCall</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span>
</span><span id="line-1568"></span><span>
</span><span id="line-1569"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#freshLocVar"><span class="hs-identifier hs-type">freshLocVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span>
</span><span id="line-1570"></span><span id="freshLocVar"><span class="annot"><span class="annottext">freshLocVar :: String -&gt; PassM Var
</span><a href="Gibbon.Passes.InferLocations.html#freshLocVar"><span class="hs-identifier hs-var hs-var">freshLocVar</span></a></span></span><span> </span><span id="local-6989586621680966607"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680966607"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680966607"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1571"></span><span>
</span><span id="line-1572"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#freshRegVar"><span class="hs-identifier hs-type">freshRegVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Region"><span class="hs-identifier hs-type">Region</span></a></span><span>
</span><span id="line-1573"></span><span id="freshRegVar"><span class="annot"><span class="annottext">freshRegVar :: PassM Region
</span><a href="Gibbon.Passes.InferLocations.html#freshRegVar"><span class="hs-identifier hs-var hs-var">freshRegVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680966611"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966611"><span class="hs-identifier hs-var">rv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;r&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1574"></span><span>                 </span><span class="annot"><span class="annottext">Region -&gt; PassM Region
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Region -&gt; PassM Region) -&gt; Region -&gt; PassM Region
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Region
</span><a href="Gibbon.L2.Syntax.html#VarR"><span class="hs-identifier hs-var">VarR</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966611"><span class="hs-identifier hs-var">rv</span></a></span><span>
</span><span id="line-1575"></span><span>
</span><span id="line-1576"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#finalUnifyLoc"><span class="hs-identifier hs-type">finalUnifyLoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#UnifyLoc"><span class="hs-identifier hs-type">UnifyLoc</span></a></span><span>
</span><span id="line-1577"></span><span id="finalUnifyLoc"><span class="annot"><span class="annottext">finalUnifyLoc :: Var -&gt; TiM UnifyLoc
</span><a href="Gibbon.Passes.InferLocations.html#finalUnifyLoc"><span class="hs-identifier hs-var hs-var">finalUnifyLoc</span></a></span></span><span> </span><span id="local-6989586621680966621"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966621"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1578"></span><span>  </span><span id="local-6989586621680966622"><span class="annot"><span class="annottext">InferState
</span><a href="#local-6989586621680966622"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM InferState
-&gt; ExceptT Failure (StateT InferState PassM) InferState
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM InferState
 -&gt; ExceptT Failure (StateT InferState PassM) InferState)
-&gt; StateT InferState PassM InferState
-&gt; ExceptT Failure (StateT InferState PassM) InferState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM InferState
forall (m :: * -&gt; *) s. Monad m =&gt; StateT s m s
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Strict.html#get"><span class="hs-identifier hs-var">St.get</span></a></span><span>
</span><span id="line-1579"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Var -&gt; InferState -&gt; Maybe UnifyLoc
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966621"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">InferState
</span><a href="#local-6989586621680966622"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1580"></span><span>    </span><span class="annot"><span class="annottext">Maybe UnifyLoc
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnifyLoc -&gt; TiM UnifyLoc
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; UnifyLoc
</span><a href="Gibbon.Passes.InferLocations.html#FreshLoc"><span class="hs-identifier hs-var">FreshLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966621"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1581"></span><span>    </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FixedLoc"><span class="hs-identifier hs-type">FixedLoc</span></a></span><span> </span><span id="local-6989586621680966624"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966624"><span class="hs-identifier hs-var">v'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnifyLoc -&gt; TiM UnifyLoc
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; UnifyLoc
</span><a href="Gibbon.Passes.InferLocations.html#FixedLoc"><span class="hs-identifier hs-var">FixedLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966624"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1582"></span><span>    </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FreshLoc"><span class="hs-identifier hs-type">FreshLoc</span></a></span><span> </span><span id="local-6989586621680966625"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966625"><span class="hs-identifier hs-var">v'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM UnifyLoc
</span><a href="Gibbon.Passes.InferLocations.html#finalUnifyLoc"><span class="hs-identifier hs-var">finalUnifyLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966625"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-1583"></span><span>
</span><span id="line-1584"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#notFixedLoc"><span class="hs-identifier hs-type">notFixedLoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-1585"></span><span id="notFixedLoc"><span class="annot"><span class="annottext">notFixedLoc :: Var -&gt; TiM Bool
</span><a href="Gibbon.Passes.InferLocations.html#notFixedLoc"><span class="hs-identifier hs-var hs-var">notFixedLoc</span></a></span></span><span> </span><span id="local-6989586621680966631"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966631"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1586"></span><span>  </span><span id="local-6989586621680966632"><span class="annot"><span class="annottext">UnifyLoc
</span><a href="#local-6989586621680966632"><span class="hs-identifier hs-var">uv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM UnifyLoc
</span><a href="Gibbon.Passes.InferLocations.html#finalUnifyLoc"><span class="hs-identifier hs-var">finalUnifyLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966631"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-1587"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UnifyLoc
</span><a href="#local-6989586621680966632"><span class="hs-identifier hs-var">uv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1588"></span><span>    </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FixedLoc"><span class="hs-identifier hs-type">FixedLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TiM Bool
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-1589"></span><span>    </span><span class="annot"><span class="annottext">UnifyLoc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TiM Bool
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1590"></span><span>
</span><span id="line-1591"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-type">finalLocVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span>
</span><span id="line-1592"></span><span id="finalLocVar"><span class="annot"><span class="annottext">finalLocVar :: Var -&gt; TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#finalLocVar"><span class="hs-identifier hs-var hs-var">finalLocVar</span></a></span></span><span> </span><span id="local-6989586621680966638"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966638"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1593"></span><span>  </span><span id="local-6989586621680966639"><span class="annot"><span class="annottext">UnifyLoc
</span><a href="#local-6989586621680966639"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM UnifyLoc
</span><a href="Gibbon.Passes.InferLocations.html#finalUnifyLoc"><span class="hs-identifier hs-var">finalUnifyLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966638"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1594"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UnifyLoc
</span><a href="#local-6989586621680966639"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1595"></span><span>    </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FixedLoc"><span class="hs-identifier hs-type">FixedLoc</span></a></span><span> </span><span id="local-6989586621680966640"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966640"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966640"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-1596"></span><span>    </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FreshLoc"><span class="hs-identifier hs-type">FreshLoc</span></a></span><span> </span><span id="local-6989586621680966641"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966641"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM Var
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966641"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-1597"></span><span>
</span><span id="line-1598"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#fresh"><span class="hs-identifier hs-type">fresh</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span>
</span><span id="line-1599"></span><span id="fresh"><span class="annot"><span class="annottext">fresh :: TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#fresh"><span class="hs-identifier hs-var hs-var">fresh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1600"></span><span>  </span><span class="annot"><span class="annottext">StateT InferState PassM Var -&gt; TiM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM Var -&gt; TiM Var)
-&gt; StateT InferState PassM Var -&gt; TiM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Var -&gt; StateT InferState PassM Var
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT InferState m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(PassM Var -&gt; StateT InferState PassM Var)
-&gt; PassM Var -&gt; StateT InferState PassM Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; PassM Var
</span><a href="Gibbon.Passes.InferLocations.html#freshLocVar"><span class="hs-identifier hs-var">freshLocVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;loc&quot;</span></span><span>
</span><span id="line-1601"></span><span>
</span><span id="line-1602"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#freshUnifyLoc"><span class="hs-identifier hs-type">freshUnifyLoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#UnifyLoc"><span class="hs-identifier hs-type">UnifyLoc</span></a></span><span>
</span><span id="line-1603"></span><span id="freshUnifyLoc"><span class="annot"><span class="annottext">freshUnifyLoc :: TiM UnifyLoc
</span><a href="Gibbon.Passes.InferLocations.html#freshUnifyLoc"><span class="hs-identifier hs-var hs-var">freshUnifyLoc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1604"></span><span>  </span><span id="local-6989586621680966651"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966651"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#fresh"><span class="hs-identifier hs-var">fresh</span></a></span><span>
</span><span id="line-1605"></span><span>  </span><span class="annot"><span class="annottext">UnifyLoc -&gt; TiM UnifyLoc
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(UnifyLoc -&gt; TiM UnifyLoc) -&gt; UnifyLoc -&gt; TiM UnifyLoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; UnifyLoc
</span><a href="Gibbon.Passes.InferLocations.html#FreshLoc"><span class="hs-identifier hs-var">FreshLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966651"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-1606"></span><span>
</span><span id="line-1607"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#lookupUnifyLoc"><span class="hs-identifier hs-type">lookupUnifyLoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#UnifyLoc"><span class="hs-identifier hs-type">UnifyLoc</span></a></span><span>
</span><span id="line-1608"></span><span id="lookupUnifyLoc"><span class="annot"><span class="annottext">lookupUnifyLoc :: Var -&gt; TiM UnifyLoc
</span><a href="Gibbon.Passes.InferLocations.html#lookupUnifyLoc"><span class="hs-identifier hs-var hs-var">lookupUnifyLoc</span></a></span></span><span> </span><span id="local-6989586621680966667"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966667"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1609"></span><span>  </span><span id="local-6989586621680966668"><span class="annot"><span class="annottext">InferState
</span><a href="#local-6989586621680966668"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM InferState
-&gt; ExceptT Failure (StateT InferState PassM) InferState
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM InferState
 -&gt; ExceptT Failure (StateT InferState PassM) InferState)
-&gt; StateT InferState PassM InferState
-&gt; ExceptT Failure (StateT InferState PassM) InferState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM InferState
forall (m :: * -&gt; *) s. Monad m =&gt; StateT s m s
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Strict.html#get"><span class="hs-identifier hs-var">St.get</span></a></span><span>
</span><span id="line-1610"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Var -&gt; InferState -&gt; Maybe UnifyLoc
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966667"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="annot"><span class="annottext">InferState
</span><a href="#local-6989586621680966668"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1611"></span><span>    </span><span class="annot"><span class="annottext">Maybe UnifyLoc
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1612"></span><span>      </span><span id="local-6989586621680966669"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966669"><span class="hs-identifier hs-var">l'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TiM Var
</span><a href="Gibbon.Passes.InferLocations.html#fresh"><span class="hs-identifier hs-var">fresh</span></a></span><span>
</span><span id="line-1613"></span><span>      </span><span class="annot"><span class="annottext">StateT InferState PassM ()
-&gt; ExceptT Failure (StateT InferState PassM) ()
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM ()
 -&gt; ExceptT Failure (StateT InferState PassM) ())
-&gt; StateT InferState PassM ()
-&gt; ExceptT Failure (StateT InferState PassM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">InferState -&gt; StateT InferState PassM ()
forall (m :: * -&gt; *) s. Monad m =&gt; s -&gt; StateT s m ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Strict.html#put"><span class="hs-identifier hs-var">St.put</span></a></span><span> </span><span class="annot"><span class="annottext">(InferState -&gt; StateT InferState PassM ())
-&gt; InferState -&gt; StateT InferState PassM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; UnifyLoc -&gt; InferState -&gt; InferState
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966667"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; UnifyLoc
</span><a href="Gibbon.Passes.InferLocations.html#FreshLoc"><span class="hs-identifier hs-var">FreshLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966669"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InferState
</span><a href="#local-6989586621680966668"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1614"></span><span>      </span><span class="annot"><span class="annottext">UnifyLoc -&gt; TiM UnifyLoc
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(UnifyLoc -&gt; TiM UnifyLoc) -&gt; UnifyLoc -&gt; TiM UnifyLoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; UnifyLoc
</span><a href="Gibbon.Passes.InferLocations.html#FreshLoc"><span class="hs-identifier hs-var">FreshLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966669"><span class="hs-identifier hs-var">l'</span></a></span><span>
</span><span id="line-1615"></span><span>    </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FreshLoc"><span class="hs-identifier hs-type">FreshLoc</span></a></span><span> </span><span id="local-6989586621680966671"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966671"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; TiM UnifyLoc
</span><a href="Gibbon.Passes.InferLocations.html#finalUnifyLoc"><span class="hs-identifier hs-var">finalUnifyLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966671"><span class="hs-identifier hs-var">l'</span></a></span><span>
</span><span id="line-1616"></span><span>    </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FixedLoc"><span class="hs-identifier hs-type">FixedLoc</span></a></span><span> </span><span id="local-6989586621680966672"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966672"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UnifyLoc -&gt; TiM UnifyLoc
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(UnifyLoc -&gt; TiM UnifyLoc) -&gt; UnifyLoc -&gt; TiM UnifyLoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; UnifyLoc
</span><a href="Gibbon.Passes.InferLocations.html#FixedLoc"><span class="hs-identifier hs-var">FixedLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966672"><span class="hs-identifier hs-var">l'</span></a></span><span>
</span><span id="line-1617"></span><span>
</span><span id="line-1618"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#fixLoc"><span class="hs-identifier hs-type">fixLoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#UnifyLoc"><span class="hs-identifier hs-type">UnifyLoc</span></a></span><span>
</span><span id="line-1619"></span><span id="fixLoc"><span class="annot"><span class="annottext">fixLoc :: Var -&gt; TiM UnifyLoc
</span><a href="Gibbon.Passes.InferLocations.html#fixLoc"><span class="hs-identifier hs-var hs-var">fixLoc</span></a></span></span><span> </span><span id="local-6989586621680966685"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966685"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1620"></span><span>  </span><span class="hs-comment">-- l' &lt;- fresh</span><span>
</span><span id="line-1621"></span><span>  </span><span id="local-6989586621680966686"><span class="annot"><span class="annottext">InferState
</span><a href="#local-6989586621680966686"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM InferState
-&gt; ExceptT Failure (StateT InferState PassM) InferState
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM InferState
 -&gt; ExceptT Failure (StateT InferState PassM) InferState)
-&gt; StateT InferState PassM InferState
-&gt; ExceptT Failure (StateT InferState PassM) InferState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM InferState
forall (m :: * -&gt; *) s. Monad m =&gt; StateT s m s
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Strict.html#get"><span class="hs-identifier hs-var">St.get</span></a></span><span>
</span><span id="line-1622"></span><span>  </span><span class="annot"><span class="annottext">StateT InferState PassM ()
-&gt; ExceptT Failure (StateT InferState PassM) ()
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM ()
 -&gt; ExceptT Failure (StateT InferState PassM) ())
-&gt; StateT InferState PassM ()
-&gt; ExceptT Failure (StateT InferState PassM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">InferState -&gt; StateT InferState PassM ()
forall (m :: * -&gt; *) s. Monad m =&gt; s -&gt; StateT s m ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Strict.html#put"><span class="hs-identifier hs-var">St.put</span></a></span><span> </span><span class="annot"><span class="annottext">(InferState -&gt; StateT InferState PassM ())
-&gt; InferState -&gt; StateT InferState PassM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; UnifyLoc -&gt; InferState -&gt; InferState
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966685"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; UnifyLoc
</span><a href="Gibbon.Passes.InferLocations.html#FixedLoc"><span class="hs-identifier hs-var">FixedLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966685"><span class="hs-identifier hs-var">lv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">InferState
</span><a href="#local-6989586621680966686"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1623"></span><span>  </span><span class="annot"><span class="annottext">UnifyLoc -&gt; TiM UnifyLoc
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(UnifyLoc -&gt; TiM UnifyLoc) -&gt; UnifyLoc -&gt; TiM UnifyLoc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; UnifyLoc
</span><a href="Gibbon.Passes.InferLocations.html#FixedLoc"><span class="hs-identifier hs-var">FixedLoc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966685"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-1624"></span><span>
</span><span id="line-1625"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#assocLoc"><span class="hs-identifier hs-type">assocLoc</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#UnifyLoc"><span class="hs-identifier hs-type">UnifyLoc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1626"></span><span id="assocLoc"><span class="annot"><span class="annottext">assocLoc :: Var -&gt; UnifyLoc -&gt; ExceptT Failure (StateT InferState PassM) ()
</span><a href="Gibbon.Passes.InferLocations.html#assocLoc"><span class="hs-identifier hs-var hs-var">assocLoc</span></a></span></span><span> </span><span id="local-6989586621680966697"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966697"><span class="hs-identifier hs-var">lv</span></a></span></span><span> </span><span id="local-6989586621680966698"><span class="annot"><span class="annottext">UnifyLoc
</span><a href="#local-6989586621680966698"><span class="hs-identifier hs-var">ul</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1627"></span><span>  </span><span id="local-6989586621680966699"><span class="annot"><span class="annottext">InferState
</span><a href="#local-6989586621680966699"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM InferState
-&gt; ExceptT Failure (StateT InferState PassM) InferState
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM InferState
 -&gt; ExceptT Failure (StateT InferState PassM) InferState)
-&gt; StateT InferState PassM InferState
-&gt; ExceptT Failure (StateT InferState PassM) InferState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">StateT InferState PassM InferState
forall (m :: * -&gt; *) s. Monad m =&gt; StateT s m s
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Strict.html#get"><span class="hs-identifier hs-var">St.get</span></a></span><span>
</span><span id="line-1628"></span><span>  </span><span class="annot"><span class="annottext">StateT InferState PassM ()
-&gt; ExceptT Failure (StateT InferState PassM) ()
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT Failure m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT InferState PassM ()
 -&gt; ExceptT Failure (StateT InferState PassM) ())
-&gt; StateT InferState PassM ()
-&gt; ExceptT Failure (StateT InferState PassM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">InferState -&gt; StateT InferState PassM ()
forall (m :: * -&gt; *) s. Monad m =&gt; s -&gt; StateT s m ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Strict.html#put"><span class="hs-identifier hs-var">St.put</span></a></span><span> </span><span class="annot"><span class="annottext">(InferState -&gt; StateT InferState PassM ())
-&gt; InferState -&gt; StateT InferState PassM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; UnifyLoc -&gt; InferState -&gt; InferState
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966697"><span class="hs-identifier hs-var">lv</span></a></span><span> </span><span class="annot"><span class="annottext">UnifyLoc
</span><a href="#local-6989586621680966698"><span class="hs-identifier hs-var">ul</span></a></span><span> </span><span class="annot"><span class="annottext">InferState
</span><a href="#local-6989586621680966699"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1629"></span><span>
</span><span id="line-1630"></span><span class="annot"><span class="hs-comment">-- | The copy repair tactic:</span></span><span>
</span><span id="line-1631"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#copy"><span class="hs-identifier hs-type">copy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>
</span><span id="line-1632"></span><span class="hs-comment">-- CSK: If operating in Gibbon2 mode, can we add an IndirectionE here, and</span><span>
</span><span id="line-1633"></span><span class="hs-comment">-- get rid of RemoveCopies?</span><span>
</span><span id="line-1634"></span><span id="copy"><span class="annot"><span class="annottext">copy :: Result -&gt; Var -&gt; TiM Result
</span><a href="Gibbon.Passes.InferLocations.html#copy"><span class="hs-identifier hs-var hs-var">copy</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966709"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966709"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966710"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966710"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966711"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680966711"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680966712"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966712"><span class="hs-identifier hs-var">lv1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1635"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966710"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1636"></span><span>      </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span id="local-6989586621680966713"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680966713"><span class="hs-identifier hs-var">tc</span></a></span></span><span> </span><span id="local-6989586621680966714"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966714"><span class="hs-identifier hs-var">lv2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1637"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680966715"><span class="annot"><span class="annottext">copyName :: Var
</span><a href="#local-6989586621680966715"><span class="hs-identifier hs-var hs-var">copyName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Var
</span><a href="Gibbon.Language.Constants.html#mkCopyFunName"><span class="hs-identifier hs-var">mkCopyFunName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680966713"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="hs-comment">-- assume a copy function with this name</span><span>
</span><span id="line-1638"></span><span>              </span><span id="local-6989586621680966717"><span class="annot"><span class="annottext">eapp :: Exp2
</span><a href="#local-6989586621680966717"><span class="hs-identifier hs-var hs-var">eapp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966715"><span class="hs-identifier hs-var">copyName</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966714"><span class="hs-identifier hs-var">lv2</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966712"><span class="hs-identifier hs-var">lv1</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966709"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1639"></span><span>          </span><span class="annot"><span class="annottext">Result -&gt; TiM Result
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966717"><span class="hs-identifier hs-var">eapp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Var -&gt; Ty2
forall loc. String -&gt; loc -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-var">PackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680966713"><span class="hs-identifier hs-var">tc</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966712"><span class="hs-identifier hs-var">lv1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680966711"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1640"></span><span>      </span><span class="annot"><span class="annottext">Ty2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; TiM Result
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; TiM Result) -&gt; String -&gt; TiM Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Did not expect to need to copy non-packed type: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966710"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1641"></span><span>
</span><span id="line-1642"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#unNestLet"><span class="hs-identifier hs-type">unNestLet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>
</span><span id="line-1643"></span><span id="unNestLet"><span class="annot"><span class="annottext">unNestLet :: Result -&gt; Result
</span><a href="Gibbon.Passes.InferLocations.html#unNestLet"><span class="hs-identifier hs-var hs-var">unNestLet</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680966719"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966719"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621680966720"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966720"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966721"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680966721"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966719"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966720"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680966721"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1644"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#unNestLet"><span class="hs-identifier hs-var">unNestLet</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966722"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966722"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966723"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966723"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966724"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680966724"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966722"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966723"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680966724"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1645"></span><span>
</span><span id="line-1646"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#pullBnds"><span class="hs-identifier hs-type">pullBnds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">Exp2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1647"></span><span id="pullBnds"><span class="annot"><span class="annottext">pullBnds :: Result -&gt; Maybe (Var, [Var], Ty2, Exp2)
</span><a href="Gibbon.Passes.InferLocations.html#pullBnds"><span class="hs-identifier hs-var hs-var">pullBnds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span id="local-6989586621680966726"><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2)
</span><a href="#local-6989586621680966726"><span class="hs-identifier hs-var">bnd</span></a></span></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621680966727"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966727"><span class="hs-identifier hs-var">_ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966728"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680966728"><span class="hs-identifier hs-var">_cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Maybe (Var, [Var], Ty2, Exp2)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2)
</span><a href="#local-6989586621680966726"><span class="hs-identifier hs-var">bnd</span></a></span><span>
</span><span id="line-1648"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#pullBnds"><span class="hs-identifier hs-var">pullBnds</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966729"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966729"><span class="hs-identifier hs-var">_e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966730"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966730"><span class="hs-identifier hs-var">_ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966731"><span class="annot"><span class="annottext">[Constraint]
</span><a href="#local-6989586621680966731"><span class="hs-identifier hs-var">_cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Var, [Var], Ty2, Exp2)
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1649"></span><span>
</span><span id="line-1650"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#buildLets"><span class="hs-identifier hs-type">buildLets</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">Exp2</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">Exp2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">Exp2</span></a></span><span>
</span><span id="line-1651"></span><span id="buildLets"><span class="annot"><span class="annottext">buildLets :: [(Var, [Var], Ty2, Exp2)] -&gt; Exp2 -&gt; Exp2
</span><a href="Gibbon.Passes.InferLocations.html#buildLets"><span class="hs-identifier hs-var hs-var">buildLets</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966733"><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2)
</span><a href="#local-6989586621680966733"><span class="hs-identifier hs-var">bnd</span></a></span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680966734"><span class="annot"><span class="annottext">[(Var, [Var], Ty2, Exp2)]
</span><a href="#local-6989586621680966734"><span class="hs-identifier hs-var">bnds</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680966735"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966735"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1652"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680966736"><span class="annot"><span class="annottext">e' :: Exp2
</span><a href="#local-6989586621680966736"><span class="hs-identifier hs-var hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, [Var], Ty2, Exp2)] -&gt; Exp2 -&gt; Exp2
</span><a href="Gibbon.Passes.InferLocations.html#buildLets"><span class="hs-identifier hs-var">buildLets</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [Var], Ty2, Exp2)]
</span><a href="#local-6989586621680966734"><span class="hs-identifier hs-var">bnds</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966735"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1653"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2)
</span><a href="#local-6989586621680966733"><span class="hs-identifier hs-var">bnd</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966736"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-1654"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#buildLets"><span class="hs-identifier hs-var">buildLets</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621680966737"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966737"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680966737"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1655"></span><span>
</span><span id="line-1656"></span><span id="local-6989586621680963079"><span id="local-6989586621680963080"><span id="local-6989586621680963081"><span id="local-6989586621680963082"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#addCopyVarToEnv"><span class="hs-identifier hs-type">addCopyVarToEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#PreExp"><span class="hs-identifier hs-type">PreExp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680963079"><span class="hs-identifier hs-type">t2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680963080"><span class="hs-identifier hs-type">t1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680963081"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680963082"><span class="hs-identifier hs-type">t3</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FullEnv"><span class="hs-identifier hs-type">FullEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FullEnv"><span class="hs-identifier hs-type">FullEnv</span></a></span></span></span></span></span><span>
</span><span id="line-1657"></span><span id="addCopyVarToEnv"><span class="annot"><span class="annottext">addCopyVarToEnv :: forall (t2 :: * -&gt; * -&gt; *) t1 t t3.
[(PreExp t2 t1 t, Ty2, t3)] -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#addCopyVarToEnv"><span class="hs-identifier hs-var hs-var">addCopyVarToEnv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966739"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966739"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[t1]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PreExp t2 t1 t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PreExp t2 t1 t
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span id="local-6989586621680966740"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966740"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680966741"><span class="annot"><span class="annottext">t3
</span><a href="#local-6989586621680966741"><span class="hs-identifier hs-var">_cs</span></a></span></span><span class="hs-special">)</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680966742"><span class="annot"><span class="annottext">[(PreExp t2 t1 t, Ty2, t3)]
</span><a href="#local-6989586621680966742"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680966743"><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680966743"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1658"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680966744"><span class="annot"><span class="annottext">env' :: FullEnv
</span><a href="#local-6989586621680966744"><span class="hs-identifier hs-var hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966739"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966740"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680966743"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-1659"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[(PreExp t2 t1 t, Ty2, t3)] -&gt; FullEnv -&gt; FullEnv
forall (t2 :: * -&gt; * -&gt; *) t1 t t3.
[(PreExp t2 t1 t, Ty2, t3)] -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#addCopyVarToEnv"><span class="hs-identifier hs-var">addCopyVarToEnv</span></a></span><span> </span><span class="annot"><span class="annottext">[(PreExp t2 t1 t, Ty2, t3)]
</span><a href="#local-6989586621680966742"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680966744"><span class="hs-identifier hs-var">env'</span></a></span><span>
</span><span id="line-1660"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#addCopyVarToEnv"><span class="hs-identifier hs-var">addCopyVarToEnv</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680966745"><span class="annot"><span class="annottext">(PreExp t2 t1 t, Ty2, t3)
</span><a href="#local-6989586621680966745"><span class="hs-identifier hs-var">r</span></a></span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680966746"><span class="annot"><span class="annottext">[(PreExp t2 t1 t, Ty2, t3)]
</span><a href="#local-6989586621680966746"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680966747"><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680966747"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(PreExp t2 t1 t, Ty2, t3)] -&gt; FullEnv -&gt; FullEnv
forall (t2 :: * -&gt; * -&gt; *) t1 t t3.
[(PreExp t2 t1 t, Ty2, t3)] -&gt; FullEnv -&gt; FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#addCopyVarToEnv"><span class="hs-identifier hs-var">addCopyVarToEnv</span></a></span><span> </span><span class="annot"><span class="annottext">[(PreExp t2 t1 t, Ty2, t3)]
</span><a href="#local-6989586621680966746"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680966747"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-1661"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#addCopyVarToEnv"><span class="hs-identifier hs-var">addCopyVarToEnv</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621680966748"><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680966748"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FullEnv
</span><a href="#local-6989586621680966748"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-1662"></span><span>
</span><span id="line-1663"></span><span class="annot"><span class="hs-comment">-- | For a packed type, get its location.</span></span><span>
</span><span id="line-1664"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#locOfTy"><span class="hs-identifier hs-type">locOfTy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span>
</span><span id="line-1665"></span><span id="locOfTy"><span class="annot"><span class="annottext">locOfTy :: Ty2 -&gt; Var
</span><a href="Gibbon.Passes.InferLocations.html#locOfTy"><span class="hs-identifier hs-var hs-var">locOfTy</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680966755"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966755"><span class="hs-identifier hs-var">lv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680966755"><span class="hs-identifier hs-var">lv</span></a></span><span>
</span><span id="line-1666"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#locOfTy"><span class="hs-identifier hs-var">locOfTy</span></a></span><span> </span><span id="local-6989586621680966756"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966756"><span class="hs-identifier hs-var">ty2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Var
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Var) -&gt; String -&gt; Var
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected packed type, got &quot;</span></span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">Ty2 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966756"><span class="hs-identifier hs-var">ty2</span></a></span><span>
</span><span id="line-1667"></span><span>
</span><span id="line-1668"></span><span id="local-6989586621680962926"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-type">err</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680962926"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-1669"></span><span id="err"><span class="annot"><span class="annottext">err :: forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span id="local-6989586621680966762"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680966762"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; a
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; a) -&gt; String -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;InferLocations: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680966762"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-1670"></span><span>
</span><span id="line-1671"></span><span id="local-6989586621680963037"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#assumeEq"><span class="hs-identifier hs-type">assumeEq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680963037"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680963037"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680963037"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680963037"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#TiM"><span class="hs-identifier hs-type">TiM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-1672"></span><span id="assumeEq"><span class="annot"><span class="annottext">assumeEq :: forall a.
(Eq a, Show a) =&gt;
a -&gt; a -&gt; ExceptT Failure (StateT InferState PassM) ()
</span><a href="Gibbon.Passes.InferLocations.html#assumeEq"><span class="hs-identifier hs-var hs-var">assumeEq</span></a></span></span><span> </span><span id="local-6989586621680966776"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680966776"><span class="hs-identifier hs-var">a1</span></a></span></span><span> </span><span id="local-6989586621680966777"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680966777"><span class="hs-identifier hs-var">a2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1673"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680966776"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680966777"><span class="hs-identifier hs-var">a2</span></a></span><span>
</span><span id="line-1674"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; ExceptT Failure (StateT InferState PassM) ()
forall a. a -&gt; ExceptT Failure (StateT InferState PassM) a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1675"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; ExceptT Failure (StateT InferState PassM) ()
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ExceptT Failure (StateT InferState PassM) ())
-&gt; String -&gt; ExceptT Failure (StateT InferState PassM) ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected these to be equal: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680966776"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680966777"><span class="hs-identifier hs-var">a2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1676"></span><span>
</span><span id="line-1677"></span><span class="annot"><span class="hs-comment">-- | Convert a prim from L1 to L2</span></span><span>
</span><span id="line-1678"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#prim"><span class="hs-keyword hs-type">prim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Ty1"><span class="hs-identifier hs-type">Ty1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1679"></span><span id="prim"><span class="annot"><span class="annottext">prim :: Prim Ty1 -&gt; PassM (Prim Ty2)
</span><a href="Gibbon.Passes.InferLocations.html#prim"><span class="hs-keyword hs-var hs-var">prim</span></a></span></span><span> </span><span id="local-6989586621680966919"><span class="annot"><span class="annottext">Prim Ty1
</span><a href="#local-6989586621680966919"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="#local-6989586621680966919"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1680"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#AddP"><span class="hs-identifier hs-var">AddP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#AddP"><span class="hs-identifier hs-var">AddP</span></a></span><span>
</span><span id="line-1681"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#SubP"><span class="hs-identifier hs-var">SubP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#SubP"><span class="hs-identifier hs-var">SubP</span></a></span><span>
</span><span id="line-1682"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#MulP"><span class="hs-identifier hs-var">MulP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#MulP"><span class="hs-identifier hs-var">MulP</span></a></span><span>
</span><span id="line-1683"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#DivP"><span class="hs-identifier hs-var">DivP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#DivP"><span class="hs-identifier hs-var">DivP</span></a></span><span>
</span><span id="line-1684"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#ModP"><span class="hs-identifier hs-var">ModP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#ModP"><span class="hs-identifier hs-var">ModP</span></a></span><span>
</span><span id="line-1685"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#ExpP"><span class="hs-identifier hs-var">ExpP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#ExpP"><span class="hs-identifier hs-var">ExpP</span></a></span><span>
</span><span id="line-1686"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#FAddP"><span class="hs-identifier hs-var">FAddP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#FAddP"><span class="hs-identifier hs-var">FAddP</span></a></span><span>
</span><span id="line-1687"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#FSubP"><span class="hs-identifier hs-var">FSubP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#FSubP"><span class="hs-identifier hs-var">FSubP</span></a></span><span>
</span><span id="line-1688"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#FMulP"><span class="hs-identifier hs-var">FMulP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#FMulP"><span class="hs-identifier hs-var">FMulP</span></a></span><span>
</span><span id="line-1689"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#FDivP"><span class="hs-identifier hs-var">FDivP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#FDivP"><span class="hs-identifier hs-var">FDivP</span></a></span><span>
</span><span id="line-1690"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#FExpP"><span class="hs-identifier hs-var">FExpP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#FExpP"><span class="hs-identifier hs-var">FExpP</span></a></span><span>
</span><span id="line-1691"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#FSqrtP"><span class="hs-identifier hs-var">FSqrtP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#FSqrtP"><span class="hs-identifier hs-var">FSqrtP</span></a></span><span>
</span><span id="line-1692"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#FTanP"><span class="hs-identifier hs-var">FTanP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#FTanP"><span class="hs-identifier hs-var">FTanP</span></a></span><span>
</span><span id="line-1693"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#RandP"><span class="hs-identifier hs-var">RandP</span></a></span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#RandP"><span class="hs-identifier hs-var">RandP</span></a></span><span>
</span><span id="line-1694"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#FRandP"><span class="hs-identifier hs-var">FRandP</span></a></span><span class="hs-glyph">-&gt;</span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#FRandP"><span class="hs-identifier hs-var">FRandP</span></a></span><span>
</span><span id="line-1695"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#FloatToIntP"><span class="hs-identifier hs-var">FloatToIntP</span></a></span><span class="hs-glyph">-&gt;</span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#FloatToIntP"><span class="hs-identifier hs-var">FloatToIntP</span></a></span><span>
</span><span id="line-1696"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#IntToFloatP"><span class="hs-identifier hs-var">IntToFloatP</span></a></span><span class="hs-glyph">-&gt;</span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#IntToFloatP"><span class="hs-identifier hs-var">IntToFloatP</span></a></span><span>
</span><span id="line-1697"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#LtP"><span class="hs-identifier hs-var">LtP</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#LtP"><span class="hs-identifier hs-var">LtP</span></a></span><span>
</span><span id="line-1698"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#GtP"><span class="hs-identifier hs-var">GtP</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#GtP"><span class="hs-identifier hs-var">GtP</span></a></span><span>
</span><span id="line-1699"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#LtEqP"><span class="hs-identifier hs-var">LtEqP</span></a></span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#LtEqP"><span class="hs-identifier hs-var">LtEqP</span></a></span><span>
</span><span id="line-1700"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#GtEqP"><span class="hs-identifier hs-var">GtEqP</span></a></span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#GtEqP"><span class="hs-identifier hs-var">GtEqP</span></a></span><span>
</span><span id="line-1701"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#FLtP"><span class="hs-identifier hs-var">FLtP</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#FLtP"><span class="hs-identifier hs-var">FLtP</span></a></span><span>
</span><span id="line-1702"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#FGtP"><span class="hs-identifier hs-var">FGtP</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#FGtP"><span class="hs-identifier hs-var">FGtP</span></a></span><span>
</span><span id="line-1703"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#FLtEqP"><span class="hs-identifier hs-var">FLtEqP</span></a></span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#FLtEqP"><span class="hs-identifier hs-var">FLtEqP</span></a></span><span>
</span><span id="line-1704"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#FGtEqP"><span class="hs-identifier hs-var">FGtEqP</span></a></span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#FGtEqP"><span class="hs-identifier hs-var">FGtEqP</span></a></span><span>
</span><span id="line-1705"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#OrP"><span class="hs-identifier hs-var">OrP</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#OrP"><span class="hs-identifier hs-var">OrP</span></a></span><span>
</span><span id="line-1706"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#AndP"><span class="hs-identifier hs-var">AndP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#AndP"><span class="hs-identifier hs-var">AndP</span></a></span><span>
</span><span id="line-1707"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#EqSymP"><span class="hs-identifier hs-var">EqSymP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#EqSymP"><span class="hs-identifier hs-var">EqSymP</span></a></span><span>
</span><span id="line-1708"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#EqBenchProgP"><span class="hs-identifier hs-type">EqBenchProgP</span></a></span><span> </span><span id="local-6989586621680966949"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680966949"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Prim Ty2
forall ty. String -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#EqBenchProgP"><span class="hs-identifier hs-var">EqBenchProgP</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680966949"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1709"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#EqIntP"><span class="hs-identifier hs-var">EqIntP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#EqIntP"><span class="hs-identifier hs-var">EqIntP</span></a></span><span>
</span><span id="line-1710"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#EqFloatP"><span class="hs-identifier hs-var">EqFloatP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#EqFloatP"><span class="hs-identifier hs-var">EqFloatP</span></a></span><span>
</span><span id="line-1711"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#EqCharP"><span class="hs-identifier hs-var">EqCharP</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#EqCharP"><span class="hs-identifier hs-var">EqCharP</span></a></span><span>
</span><span id="line-1712"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#MkTrue"><span class="hs-identifier hs-var">MkTrue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#MkTrue"><span class="hs-identifier hs-var">MkTrue</span></a></span><span>
</span><span id="line-1713"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#MkFalse"><span class="hs-identifier hs-var">MkFalse</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#MkFalse"><span class="hs-identifier hs-var">MkFalse</span></a></span><span>
</span><span id="line-1714"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#Gensym"><span class="hs-identifier hs-var">Gensym</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#Gensym"><span class="hs-identifier hs-var">Gensym</span></a></span><span>
</span><span id="line-1715"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#SizeParam"><span class="hs-identifier hs-var">SizeParam</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#SizeParam"><span class="hs-identifier hs-var">SizeParam</span></a></span><span>
</span><span id="line-1716"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#IsBig"><span class="hs-identifier hs-var">IsBig</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#IsBig"><span class="hs-identifier hs-var">IsBig</span></a></span><span>
</span><span id="line-1717"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#PrintInt"><span class="hs-identifier hs-var">PrintInt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#PrintInt"><span class="hs-identifier hs-var">PrintInt</span></a></span><span>
</span><span id="line-1718"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#PrintChar"><span class="hs-identifier hs-var">PrintChar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#PrintChar"><span class="hs-identifier hs-var">PrintChar</span></a></span><span>
</span><span id="line-1719"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#PrintFloat"><span class="hs-identifier hs-var">PrintFloat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#PrintFloat"><span class="hs-identifier hs-var">PrintFloat</span></a></span><span>
</span><span id="line-1720"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#PrintBool"><span class="hs-identifier hs-var">PrintBool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#PrintBool"><span class="hs-identifier hs-var">PrintBool</span></a></span><span>
</span><span id="line-1721"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#PrintSym"><span class="hs-identifier hs-var">PrintSym</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#PrintSym"><span class="hs-identifier hs-var">PrintSym</span></a></span><span>
</span><span id="line-1722"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#ReadInt"><span class="hs-identifier hs-var">ReadInt</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#PrintInt"><span class="hs-identifier hs-var">PrintInt</span></a></span><span>
</span><span id="line-1723"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#RequestSizeOf"><span class="hs-identifier hs-var">RequestSizeOf</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#RequestSizeOf"><span class="hs-identifier hs-var">RequestSizeOf</span></a></span><span>
</span><span id="line-1724"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ErrorP"><span class="hs-identifier hs-type">ErrorP</span></a></span><span> </span><span id="local-6989586621680966959"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680966959"><span class="hs-identifier hs-var">sty</span></a></span></span><span> </span><span id="local-6989586621680966960"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966960"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966960"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680966961"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966961"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Ty2 -&gt; Prim Ty2
forall ty. String -&gt; ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#ErrorP"><span class="hs-identifier hs-var">ErrorP</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680966959"><span class="hs-identifier hs-var">sty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966961"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1725"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DictEmptyP"><span class="hs-identifier hs-type">DictEmptyP</span></a></span><span> </span><span id="local-6989586621680966962"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966962"><span class="hs-identifier hs-var">dty</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966962"><span class="hs-identifier hs-var">dty</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2))
-&gt; (Ty2 -&gt; Prim Ty2) -&gt; Ty2 -&gt; PassM (Prim Ty2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#DictEmptyP"><span class="hs-identifier hs-var">DictEmptyP</span></a></span><span>
</span><span id="line-1726"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DictInsertP"><span class="hs-identifier hs-type">DictInsertP</span></a></span><span> </span><span id="local-6989586621680966963"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966963"><span class="hs-identifier hs-var">dty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966963"><span class="hs-identifier hs-var">dty</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2))
-&gt; (Ty2 -&gt; Prim Ty2) -&gt; Ty2 -&gt; PassM (Prim Ty2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#DictInsertP"><span class="hs-identifier hs-var">DictInsertP</span></a></span><span>
</span><span id="line-1727"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DictLookupP"><span class="hs-identifier hs-type">DictLookupP</span></a></span><span> </span><span id="local-6989586621680966964"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966964"><span class="hs-identifier hs-var">dty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966964"><span class="hs-identifier hs-var">dty</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2))
-&gt; (Ty2 -&gt; Prim Ty2) -&gt; Ty2 -&gt; PassM (Prim Ty2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#DictLookupP"><span class="hs-identifier hs-var">DictLookupP</span></a></span><span>
</span><span id="line-1728"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DictHasKeyP"><span class="hs-identifier hs-type">DictHasKeyP</span></a></span><span> </span><span id="local-6989586621680966965"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966965"><span class="hs-identifier hs-var">dty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966965"><span class="hs-identifier hs-var">dty</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2))
-&gt; (Ty2 -&gt; Prim Ty2) -&gt; Ty2 -&gt; PassM (Prim Ty2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#DictHasKeyP"><span class="hs-identifier hs-var">DictHasKeyP</span></a></span><span>
</span><span id="line-1729"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VAllocP"><span class="hs-identifier hs-type">VAllocP</span></a></span><span> </span><span id="local-6989586621680966967"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966967"><span class="hs-identifier hs-var">elty</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966967"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2))
-&gt; (Ty2 -&gt; Prim Ty2) -&gt; Ty2 -&gt; PassM (Prim Ty2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#VAllocP"><span class="hs-identifier hs-var">VAllocP</span></a></span><span>
</span><span id="line-1730"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VFreeP"><span class="hs-identifier hs-type">VFreeP</span></a></span><span> </span><span id="local-6989586621680966969"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966969"><span class="hs-identifier hs-var">elty</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966969"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2))
-&gt; (Ty2 -&gt; Prim Ty2) -&gt; Ty2 -&gt; PassM (Prim Ty2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#VFreeP"><span class="hs-identifier hs-var">VFreeP</span></a></span><span>
</span><span id="line-1731"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VFree2P"><span class="hs-identifier hs-type">VFree2P</span></a></span><span> </span><span id="local-6989586621680966971"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966971"><span class="hs-identifier hs-var">elty</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966971"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2))
-&gt; (Ty2 -&gt; Prim Ty2) -&gt; Ty2 -&gt; PassM (Prim Ty2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#VFree2P"><span class="hs-identifier hs-var">VFree2P</span></a></span><span>
</span><span id="line-1732"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VLengthP"><span class="hs-identifier hs-type">VLengthP</span></a></span><span> </span><span id="local-6989586621680966973"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966973"><span class="hs-identifier hs-var">elty</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966973"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2))
-&gt; (Ty2 -&gt; Prim Ty2) -&gt; Ty2 -&gt; PassM (Prim Ty2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#VLengthP"><span class="hs-identifier hs-var">VLengthP</span></a></span><span>
</span><span id="line-1733"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VNthP"><span class="hs-identifier hs-type">VNthP</span></a></span><span> </span><span id="local-6989586621680966974"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966974"><span class="hs-identifier hs-var">elty</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966974"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2))
-&gt; (Ty2 -&gt; Prim Ty2) -&gt; Ty2 -&gt; PassM (Prim Ty2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#VNthP"><span class="hs-identifier hs-var">VNthP</span></a></span><span>
</span><span id="line-1734"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VSliceP"><span class="hs-identifier hs-type">VSliceP</span></a></span><span> </span><span id="local-6989586621680966976"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966976"><span class="hs-identifier hs-var">elty</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966976"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2))
-&gt; (Ty2 -&gt; Prim Ty2) -&gt; Ty2 -&gt; PassM (Prim Ty2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#VSliceP"><span class="hs-identifier hs-var">VSliceP</span></a></span><span>
</span><span id="line-1735"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#InplaceVUpdateP"><span class="hs-identifier hs-type">InplaceVUpdateP</span></a></span><span> </span><span id="local-6989586621680966978"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966978"><span class="hs-identifier hs-var">elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966978"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2))
-&gt; (Ty2 -&gt; Prim Ty2) -&gt; Ty2 -&gt; PassM (Prim Ty2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#InplaceVUpdateP"><span class="hs-identifier hs-var">InplaceVUpdateP</span></a></span><span>
</span><span id="line-1736"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VConcatP"><span class="hs-identifier hs-type">VConcatP</span></a></span><span> </span><span id="local-6989586621680966980"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966980"><span class="hs-identifier hs-var">elty</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966980"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2))
-&gt; (Ty2 -&gt; Prim Ty2) -&gt; Ty2 -&gt; PassM (Prim Ty2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#VConcatP"><span class="hs-identifier hs-var">VConcatP</span></a></span><span>
</span><span id="line-1737"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VSortP"><span class="hs-identifier hs-type">VSortP</span></a></span><span> </span><span id="local-6989586621680966981"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966981"><span class="hs-identifier hs-var">elty</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966981"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2))
-&gt; (Ty2 -&gt; Prim Ty2) -&gt; Ty2 -&gt; PassM (Prim Ty2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#VSortP"><span class="hs-identifier hs-var">VSortP</span></a></span><span>
</span><span id="line-1738"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VMergeP"><span class="hs-identifier hs-type">VMergeP</span></a></span><span> </span><span id="local-6989586621680966983"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966983"><span class="hs-identifier hs-var">elty</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966983"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2))
-&gt; (Ty2 -&gt; Prim Ty2) -&gt; Ty2 -&gt; PassM (Prim Ty2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#VMergeP"><span class="hs-identifier hs-var">VMergeP</span></a></span><span>
</span><span id="line-1739"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PDictAllocP"><span class="hs-identifier hs-type">PDictAllocP</span></a></span><span> </span><span id="local-6989586621680966985"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966985"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680966986"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966986"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966985"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680966987"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966987"><span class="hs-identifier hs-var">k'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966986"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680966988"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966988"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2)) -&gt; Prim Ty2 -&gt; PassM (Prim Ty2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#PDictAllocP"><span class="hs-identifier hs-var">PDictAllocP</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966987"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966988"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1740"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PDictInsertP"><span class="hs-identifier hs-type">PDictInsertP</span></a></span><span> </span><span id="local-6989586621680966990"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966990"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680966991"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966991"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966990"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680966992"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966992"><span class="hs-identifier hs-var">k'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966991"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680966993"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966993"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2)) -&gt; Prim Ty2 -&gt; PassM (Prim Ty2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#PDictInsertP"><span class="hs-identifier hs-var">PDictInsertP</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966992"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966993"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1741"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PDictLookupP"><span class="hs-identifier hs-type">PDictLookupP</span></a></span><span> </span><span id="local-6989586621680966995"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966995"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680966996"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966996"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966995"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680966997"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966997"><span class="hs-identifier hs-var">k'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680966996"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680966998"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966998"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2)) -&gt; Prim Ty2 -&gt; PassM (Prim Ty2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#PDictLookupP"><span class="hs-identifier hs-var">PDictLookupP</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966997"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680966998"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1742"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PDictHasKeyP"><span class="hs-identifier hs-type">PDictHasKeyP</span></a></span><span> </span><span id="local-6989586621680967000"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967000"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680967001"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967001"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967000"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680967002"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680967002"><span class="hs-identifier hs-var">k'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967001"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680967003"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680967003"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2)) -&gt; Prim Ty2 -&gt; PassM (Prim Ty2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#PDictHasKeyP"><span class="hs-identifier hs-var">PDictHasKeyP</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680967002"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680967003"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1743"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PDictForkP"><span class="hs-identifier hs-type">PDictForkP</span></a></span><span> </span><span id="local-6989586621680967005"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967005"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680967006"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967006"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967005"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680967007"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680967007"><span class="hs-identifier hs-var">k'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967006"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680967008"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680967008"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2)) -&gt; Prim Ty2 -&gt; PassM (Prim Ty2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#PDictForkP"><span class="hs-identifier hs-var">PDictForkP</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680967007"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680967008"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1744"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PDictJoinP"><span class="hs-identifier hs-type">PDictJoinP</span></a></span><span> </span><span id="local-6989586621680967010"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967010"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680967011"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967011"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967010"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680967012"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680967012"><span class="hs-identifier hs-var">k'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967011"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680967013"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680967013"><span class="hs-identifier hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2)) -&gt; Prim Ty2 -&gt; PassM (Prim Ty2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#PDictJoinP"><span class="hs-identifier hs-var">PDictJoinP</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680967012"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680967013"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1745"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LLAllocP"><span class="hs-identifier hs-type">LLAllocP</span></a></span><span> </span><span id="local-6989586621680967015"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967015"><span class="hs-identifier hs-var">elty</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967015"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2))
-&gt; (Ty2 -&gt; Prim Ty2) -&gt; Ty2 -&gt; PassM (Prim Ty2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#LLAllocP"><span class="hs-identifier hs-var">LLAllocP</span></a></span><span>
</span><span id="line-1746"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LLIsEmptyP"><span class="hs-identifier hs-type">LLIsEmptyP</span></a></span><span> </span><span id="local-6989586621680967017"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967017"><span class="hs-identifier hs-var">elty</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967017"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2))
-&gt; (Ty2 -&gt; Prim Ty2) -&gt; Ty2 -&gt; PassM (Prim Ty2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#LLIsEmptyP"><span class="hs-identifier hs-var">LLIsEmptyP</span></a></span><span>
</span><span id="line-1747"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LLConsP"><span class="hs-identifier hs-type">LLConsP</span></a></span><span> </span><span id="local-6989586621680967019"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967019"><span class="hs-identifier hs-var">elty</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967019"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2))
-&gt; (Ty2 -&gt; Prim Ty2) -&gt; Ty2 -&gt; PassM (Prim Ty2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#LLConsP"><span class="hs-identifier hs-var">LLConsP</span></a></span><span>
</span><span id="line-1748"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LLHeadP"><span class="hs-identifier hs-type">LLHeadP</span></a></span><span> </span><span id="local-6989586621680967021"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967021"><span class="hs-identifier hs-var">elty</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967021"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2))
-&gt; (Ty2 -&gt; Prim Ty2) -&gt; Ty2 -&gt; PassM (Prim Ty2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#LLHeadP"><span class="hs-identifier hs-var">LLHeadP</span></a></span><span>
</span><span id="line-1749"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LLTailP"><span class="hs-identifier hs-type">LLTailP</span></a></span><span> </span><span id="local-6989586621680967023"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967023"><span class="hs-identifier hs-var">elty</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967023"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2))
-&gt; (Ty2 -&gt; Prim Ty2) -&gt; Ty2 -&gt; PassM (Prim Ty2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#LLTailP"><span class="hs-identifier hs-var">LLTailP</span></a></span><span>
</span><span id="line-1750"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LLFreeP"><span class="hs-identifier hs-type">LLFreeP</span></a></span><span> </span><span id="local-6989586621680967025"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967025"><span class="hs-identifier hs-var">elty</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967025"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2))
-&gt; (Ty2 -&gt; Prim Ty2) -&gt; Ty2 -&gt; PassM (Prim Ty2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#LLFreeP"><span class="hs-identifier hs-var">LLFreeP</span></a></span><span>
</span><span id="line-1751"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LLFree2P"><span class="hs-identifier hs-type">LLFree2P</span></a></span><span> </span><span id="local-6989586621680967027"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967027"><span class="hs-identifier hs-var">elty</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967027"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2))
-&gt; (Ty2 -&gt; Prim Ty2) -&gt; Ty2 -&gt; PassM (Prim Ty2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#LLFree2P"><span class="hs-identifier hs-var">LLFree2P</span></a></span><span>
</span><span id="line-1752"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LLCopyP"><span class="hs-identifier hs-type">LLCopyP</span></a></span><span> </span><span id="local-6989586621680967029"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967029"><span class="hs-identifier hs-var">elty</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967029"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2))
-&gt; (Ty2 -&gt; Prim Ty2) -&gt; Ty2 -&gt; PassM (Prim Ty2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#LLCopyP"><span class="hs-identifier hs-var">LLCopyP</span></a></span><span>
</span><span id="line-1753"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#InplaceVSortP"><span class="hs-identifier hs-type">InplaceVSortP</span></a></span><span> </span><span id="local-6989586621680967031"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967031"><span class="hs-identifier hs-var">elty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967031"><span class="hs-identifier hs-var">elty</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2))
-&gt; (Ty2 -&gt; Prim Ty2) -&gt; Ty2 -&gt; PassM (Prim Ty2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Prim Ty2
forall ty. ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#InplaceVSortP"><span class="hs-identifier hs-var">InplaceVSortP</span></a></span><span>
</span><span id="line-1754"></span><span>           </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="Gibbon.Language.Syntax.html#GetNumProcessors"><span class="hs-identifier hs-var">GetNumProcessors</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#GetNumProcessors"><span class="hs-identifier hs-var">GetNumProcessors</span></a></span><span>
</span><span id="line-1755"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ReadPackedFile"><span class="hs-identifier hs-type">ReadPackedFile</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; PassM (Prim Ty2)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; PassM (Prim Ty2)) -&gt; String -&gt; PassM (Prim Ty2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Can't handle this primop yet in InferLocations:\n&quot;</span></span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">Prim Ty1 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="#local-6989586621680966919"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1756"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ReadArrayFile"><span class="hs-identifier hs-type">ReadArrayFile</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; PassM (Prim Ty2)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; PassM (Prim Ty2)) -&gt; String -&gt; PassM (Prim Ty2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Can't handle this primop yet in InferLocations:\n&quot;</span></span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">Prim Ty1 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="#local-6989586621680966919"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1757"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#WritePackedFile"><span class="hs-identifier hs-type">WritePackedFile</span></a></span><span> </span><span id="local-6989586621680967033"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680967033"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621680967034"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967034"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; PassM Ty2
</span><a href="Gibbon.Passes.InferLocations.html#convertTy"><span class="hs-identifier hs-var">convertTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967034"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Ty2 -&gt; (Ty2 -&gt; PassM (Prim Ty2)) -&gt; PassM (Prim Ty2)
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prim Ty2 -&gt; PassM (Prim Ty2))
-&gt; (Ty2 -&gt; Prim Ty2) -&gt; Ty2 -&gt; PassM (Prim Ty2)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Ty2 -&gt; Prim Ty2
forall ty. String -&gt; ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#WritePackedFile"><span class="hs-identifier hs-var">WritePackedFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680967033"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1758"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SymSetEmpty"><span class="hs-identifier hs-type">SymSetEmpty</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#SymSetEmpty"><span class="hs-identifier hs-var">SymSetEmpty</span></a></span><span>
</span><span id="line-1759"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SymSetInsert"><span class="hs-identifier hs-type">SymSetInsert</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#SymSetInsert"><span class="hs-identifier hs-var">SymSetInsert</span></a></span><span>
</span><span id="line-1760"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SymSetContains"><span class="hs-identifier hs-type">SymSetContains</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#SymSetContains"><span class="hs-identifier hs-var">SymSetContains</span></a></span><span>
</span><span id="line-1761"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SymHashEmpty"><span class="hs-identifier hs-type">SymHashEmpty</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#SymHashEmpty"><span class="hs-identifier hs-var">SymHashEmpty</span></a></span><span>
</span><span id="line-1762"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SymHashInsert"><span class="hs-identifier hs-type">SymHashInsert</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#SymHashInsert"><span class="hs-identifier hs-var">SymHashInsert</span></a></span><span>
</span><span id="line-1763"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SymHashLookup"><span class="hs-identifier hs-type">SymHashLookup</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#SymHashLookup"><span class="hs-identifier hs-var">SymHashLookup</span></a></span><span>
</span><span id="line-1764"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SymHashContains"><span class="hs-identifier hs-type">SymHashContains</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#SymHashContains"><span class="hs-identifier hs-var">SymHashContains</span></a></span><span>
</span><span id="line-1765"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#IntHashEmpty"><span class="hs-identifier hs-type">IntHashEmpty</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#IntHashEmpty"><span class="hs-identifier hs-var">IntHashEmpty</span></a></span><span>
</span><span id="line-1766"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#IntHashInsert"><span class="hs-identifier hs-type">IntHashInsert</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#IntHashInsert"><span class="hs-identifier hs-var">IntHashInsert</span></a></span><span>
</span><span id="line-1767"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#IntHashLookup"><span class="hs-identifier hs-type">IntHashLookup</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prim Ty2 -&gt; PassM (Prim Ty2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#IntHashLookup"><span class="hs-identifier hs-var">IntHashLookup</span></a></span><span>
</span><span id="line-1768"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Write3dPpmFile"><span class="hs-identifier hs-type">Write3dPpmFile</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; PassM (Prim Ty2)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; PassM (Prim Ty2)) -&gt; String -&gt; PassM (Prim Ty2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Write3dPpmFile not handled yet.&quot;</span></span><span>
</span><span id="line-1769"></span><span>           </span><span class="annot"><a href="Gibbon.Language.Syntax.html#RequestEndOf"><span class="hs-identifier hs-type">RequestEndOf</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; PassM (Prim Ty2)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="Gibbon.Passes.InferLocations.html#err"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; PassM (Prim Ty2)) -&gt; String -&gt; PassM (Prim Ty2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;RequestEndOf not handled yet.&quot;</span></span><span>
</span><span id="line-1770"></span><span>
</span><span id="line-1771"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#emptyEnv"><span class="hs-identifier hs-type">emptyEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FullEnv"><span class="hs-identifier hs-type">FullEnv</span></a></span><span>
</span><span id="line-1772"></span><span id="emptyEnv"><span class="annot"><span class="annottext">emptyEnv :: FullEnv
</span><a href="Gibbon.Passes.InferLocations.html#emptyEnv"><span class="hs-identifier hs-var hs-var">emptyEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#FullEnv"><span class="hs-identifier hs-type">FullEnv</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dataDefs :: DDefs Ty2
</span><a href="Gibbon.Passes.InferLocations.html#dataDefs"><span class="hs-identifier hs-var">dataDefs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DDefs Ty2
forall a. DDefs a
</span><a href="Gibbon.Language.Syntax.html#emptyDD"><span class="hs-identifier hs-var">emptyDD</span></a></span><span>
</span><span id="line-1773"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">valEnv :: TyEnv Ty2
</span><a href="Gibbon.Passes.InferLocations.html#valEnv"><span class="hs-identifier hs-var">valEnv</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyEnv Ty2
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span>
</span><span id="line-1774"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">funEnv :: TyEnv (ArrowTy Ty2)
</span><a href="Gibbon.Passes.InferLocations.html#funEnv"><span class="hs-identifier hs-var">funEnv</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyEnv (ArrowTy Ty2)
TyEnv (ArrowTy2 Ty2)
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1775"></span><span>
</span><span id="line-1776"></span><span>
</span><span id="line-1777"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-1778"></span><span>
</span><span id="line-1779"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#fixRANs"><span class="hs-identifier hs-type">fixRANs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Prog2"><span class="hs-identifier hs-type">Prog2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Prog2"><span class="hs-identifier hs-type">Prog2</span></a></span><span>
</span><span id="line-1780"></span><span id="fixRANs"><span class="annot"><span class="annottext">fixRANs :: Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.InferLocations.html#fixRANs"><span class="hs-identifier hs-var hs-var">fixRANs</span></a></span></span><span> </span><span id="local-6989586621680967154"><span class="annot"><span class="annottext">prg :: Prog2
</span><a href="#local-6989586621680967154"><span class="hs-identifier hs-var">prg</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span id="local-6989586621680967155"><span class="annot"><span class="annottext">DDefs (TyOf Exp2)
</span><a href="#local-6989586621680967155"><span class="hs-identifier hs-var">defs</span></a></span></span><span> </span><span id="local-6989586621680967156"><span class="annot"><span class="annottext">Map Var (FunDef Exp2)
</span><a href="#local-6989586621680967156"><span class="hs-identifier hs-var">funs</span></a></span></span><span> </span><span id="local-6989586621680967157"><span class="annot"><span class="annottext">Maybe (Exp2, TyOf Exp2)
</span><a href="#local-6989586621680967157"><span class="hs-identifier hs-var">main</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1781"></span><span>    </span><span id="local-6989586621680967158"><span class="annot"><span class="annottext">Maybe (Exp2, Ty2)
</span><a href="#local-6989586621680967158"><span class="hs-identifier hs-var">main'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-1782"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp2, TyOf Exp2)
</span><a href="#local-6989586621680967157"><span class="hs-identifier hs-var">main</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1783"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Exp2, TyOf Exp2)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp2, Ty2) -&gt; PassM (Maybe (Exp2, Ty2))
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Exp2, Ty2)
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1784"></span><span>        </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967159"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967159"><span class="hs-identifier hs-var">ex</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967160"><span class="annot"><span class="annottext">TyOf Exp2
</span><a href="#local-6989586621680967160"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1785"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680967161"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967161"><span class="hs-identifier hs-var">ex'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DDefs Ty2 -&gt; Env2 Ty2 -&gt; Exp2 -&gt; PassM ([(String, [Exp2])], Exp2)
</span><a href="#local-6989586621680967162"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp2)
DDefs Ty2
</span><a href="#local-6989586621680967155"><span class="hs-identifier hs-var">defs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 (TyOf Exp2)
Env2 Ty2
</span><a href="#local-6989586621680967163"><span class="hs-identifier hs-var">env20</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967159"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1786"></span><span>          </span><span class="annot"><span class="annottext">Maybe (Exp2, Ty2) -&gt; PassM (Maybe (Exp2, Ty2))
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Exp2, Ty2) -&gt; PassM (Maybe (Exp2, Ty2)))
-&gt; Maybe (Exp2, Ty2) -&gt; PassM (Maybe (Exp2, Ty2))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2, Ty2) -&gt; Maybe (Exp2, Ty2)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967161"><span class="hs-identifier hs-var">ex'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyOf Exp2
Ty2
</span><a href="#local-6989586621680967160"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1787"></span><span>    </span><span id="local-6989586621680967164"><span class="annot"><span class="annottext">Map Var (FunDef Exp2)
</span><a href="#local-6989586621680967164"><span class="hs-identifier hs-var">funs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map Var (FunDef Exp2) -&gt; PassM (Map Var (FunDef Exp2))
</span><a href="#local-6989586621680967165"><span class="hs-identifier hs-var">flattenFuns</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var (FunDef Exp2)
</span><a href="#local-6989586621680967156"><span class="hs-identifier hs-var">funs</span></a></span><span>
</span><span id="line-1788"></span><span>    </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prog2 -&gt; PassM Prog2) -&gt; Prog2 -&gt; PassM Prog2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp2)
-&gt; Map Var (FunDef Exp2) -&gt; Maybe (Exp2, TyOf Exp2) -&gt; Prog2
forall ex.
DDefs (TyOf ex) -&gt; FunDefs ex -&gt; Maybe (ex, TyOf ex) -&gt; Prog ex
</span><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-var">Prog</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp2)
</span><a href="#local-6989586621680967155"><span class="hs-identifier hs-var">defs</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var (FunDef Exp2)
</span><a href="#local-6989586621680967164"><span class="hs-identifier hs-var">funs'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Exp2, TyOf Exp2)
Maybe (Exp2, Ty2)
</span><a href="#local-6989586621680967158"><span class="hs-identifier hs-var">main'</span></a></span><span>
</span><span id="line-1789"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1790"></span><span>    </span><span id="local-6989586621680967165"><span class="annot"><span class="annottext">flattenFuns :: Map Var (FunDef Exp2) -&gt; PassM (Map Var (FunDef Exp2))
</span><a href="#local-6989586621680967165"><span class="hs-identifier hs-var hs-var">flattenFuns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FunDef Exp2 -&gt; PassM (FunDef Exp2))
-&gt; Map Var (FunDef Exp2) -&gt; PassM (Map Var (FunDef Exp2))
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; Map Var a -&gt; m (Map Var b)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef Exp2 -&gt; PassM (FunDef Exp2)
</span><a href="#local-6989586621680967166"><span class="hs-identifier hs-var">flattenFun</span></a></span><span>
</span><span id="line-1791"></span><span>    </span><span id="local-6989586621680967166"><span class="annot"><span class="annottext">flattenFun :: FunDef Exp2 -&gt; PassM (FunDef Exp2)
</span><a href="#local-6989586621680967166"><span class="hs-identifier hs-var hs-var">flattenFun</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span> </span><span id="local-6989586621680967167"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967167"><span class="hs-identifier hs-var">nam</span></a></span></span><span> </span><span id="local-6989586621680967168"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967168"><span class="hs-identifier hs-var">narg</span></a></span></span><span> </span><span id="local-6989586621680967169"><span class="annot"><span class="annottext">ArrowTy (TyOf Exp2)
</span><a href="#local-6989586621680967169"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680967170"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967170"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span id="local-6989586621680967171"><span class="annot"><span class="annottext">FunMeta
</span><a href="#local-6989586621680967171"><span class="hs-identifier hs-var">meta</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1792"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967172"><span class="annot"><span class="annottext">env2 :: Env2 Ty2
</span><a href="#local-6989586621680967172"><span class="hs-identifier hs-var hs-var">env2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyEnv Ty2 -&gt; TyEnv (ArrowTy Ty2) -&gt; Env2 Ty2
forall a. TyEnv a -&gt; TyEnv (ArrowTy a) -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#Env2"><span class="hs-identifier hs-var">Env2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, Ty2)] -&gt; TyEnv Ty2
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(Var, Ty2)] -&gt; TyEnv Ty2) -&gt; [(Var, Ty2)] -&gt; TyEnv Ty2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Ty2] -&gt; [(Var, Ty2)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967168"><span class="hs-identifier hs-var">narg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArrowTy2 Ty2 -&gt; [Ty2]
forall ty2. ArrowTy2 ty2 -&gt; [ty2]
</span><a href="Gibbon.L2.Syntax.html#arrIns"><span class="hs-identifier hs-var">arrIns</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy (TyOf Exp2)
ArrowTy2 Ty2
</span><a href="#local-6989586621680967169"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Env2 Ty2 -&gt; TyEnv (ArrowTy Ty2)
forall a. Env2 a -&gt; TyEnv (ArrowTy a)
</span><a href="Gibbon.Language.Syntax.html#fEnv"><span class="hs-identifier hs-var">fEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 (TyOf Exp2)
Env2 Ty2
</span><a href="#local-6989586621680967163"><span class="hs-identifier hs-var">env20</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1793"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967175"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967175"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DDefs Ty2 -&gt; Env2 Ty2 -&gt; Exp2 -&gt; PassM ([(String, [Exp2])], Exp2)
</span><a href="#local-6989586621680967162"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp2)
DDefs Ty2
</span><a href="#local-6989586621680967155"><span class="hs-identifier hs-var">defs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty2
</span><a href="#local-6989586621680967172"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967170"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-1794"></span><span>      </span><span class="annot"><span class="annottext">FunDef Exp2 -&gt; PassM (FunDef Exp2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(FunDef Exp2 -&gt; PassM (FunDef Exp2))
-&gt; FunDef Exp2 -&gt; PassM (FunDef Exp2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var
-&gt; [Var] -&gt; ArrowTy (TyOf Exp2) -&gt; Exp2 -&gt; FunMeta -&gt; FunDef Exp2
forall ex.
Var -&gt; [Var] -&gt; ArrowTy (TyOf ex) -&gt; ex -&gt; FunMeta -&gt; FunDef ex
</span><a href="Gibbon.Language.Syntax.html#FunDef"><span class="hs-identifier hs-var">FunDef</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967167"><span class="hs-identifier hs-var">nam</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967168"><span class="hs-identifier hs-var">narg</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy (TyOf Exp2)
</span><a href="#local-6989586621680967169"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967175"><span class="hs-identifier hs-var">bod'</span></a></span><span> </span><span class="annot"><span class="annottext">FunMeta
</span><a href="#local-6989586621680967171"><span class="hs-identifier hs-var">meta</span></a></span><span>
</span><span id="line-1795"></span><span>
</span><span id="line-1796"></span><span>    </span><span id="local-6989586621680967163"><span class="annot"><span class="annottext">env20 :: Env2 (TyOf Exp2)
</span><a href="#local-6989586621680967163"><span class="hs-identifier hs-var hs-var">env20</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prog2 -&gt; Env2 (TyOf Exp2)
forall a. Prog a -&gt; Env2 (TyOf a)
</span><a href="Gibbon.Language.Syntax.html#progToEnv"><span class="hs-identifier hs-var">progToEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680967154"><span class="hs-identifier hs-var">prg</span></a></span><span>
</span><span id="line-1797"></span><span>
</span><span id="line-1798"></span><span>    </span><span class="annot"><a href="#local-6989586621680967162"><span class="hs-identifier hs-type">exp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#DDefs2"><span class="hs-identifier hs-type">DDefs2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Env2"><span class="hs-identifier hs-type">Env2</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">Ty2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">Exp2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">Exp2</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">Exp2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1799"></span><span>    </span><span id="local-6989586621680967162"><span class="annot"><span class="annottext">exp :: DDefs Ty2 -&gt; Env2 Ty2 -&gt; Exp2 -&gt; PassM ([(String, [Exp2])], Exp2)
</span><a href="#local-6989586621680967162"><span class="hs-identifier hs-var hs-var">exp</span></a></span></span><span> </span><span id="local-6989586621680967178"><span class="annot"><span class="annottext">DDefs Ty2
</span><a href="#local-6989586621680967178"><span class="hs-identifier hs-var">ddfs</span></a></span></span><span> </span><span id="local-6989586621680967179"><span class="annot"><span class="annottext">Env2 Ty2
</span><a href="#local-6989586621680967179"><span class="hs-identifier hs-var">env2</span></a></span></span><span> </span><span id="local-6989586621680967180"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967180"><span class="hs-identifier hs-var">e0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1800"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621680967181"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">Exp2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">Exp2</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">Exp2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1801"></span><span>          </span><span id="local-6989586621680967181"><span class="annot"><span class="annottext">go :: Exp2 -&gt; PassM ([(String, [Exp2])], Exp2)
</span><a href="#local-6989586621680967181"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DDefs Ty2 -&gt; Env2 Ty2 -&gt; Exp2 -&gt; PassM ([(String, [Exp2])], Exp2)
</span><a href="#local-6989586621680967162"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs Ty2
</span><a href="#local-6989586621680967178"><span class="hs-identifier hs-var">ddfs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty2
</span><a href="#local-6989586621680967179"><span class="hs-identifier hs-var">env2</span></a></span><span>
</span><span id="line-1802"></span><span>
</span><span id="line-1803"></span><span>          </span><span id="local-6989586621680967188"><span class="annot"><span class="annottext">gols :: ([Exp2] -&gt; b) -&gt; [Exp2] -&gt; PassM ([(String, [Exp2])], b)
</span><a href="#local-6989586621680967188"><span class="hs-identifier hs-var hs-var">gols</span></a></span></span><span> </span><span id="local-6989586621680967189"><span class="annot"><span class="annottext">[Exp2] -&gt; b
</span><a href="#local-6989586621680967189"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680967190"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680967190"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967191"><span class="annot"><span class="annottext">[[(String, [Exp2])]]
</span><a href="#local-6989586621680967191"><span class="hs-identifier hs-var">bndss</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967192"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680967192"><span class="hs-identifier hs-var">ls'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[([(String, [Exp2])], Exp2)] -&gt; ([[(String, [Exp2])]], [Exp2])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">([([(String, [Exp2])], Exp2)] -&gt; ([[(String, [Exp2])]], [Exp2]))
-&gt; PassM [([(String, [Exp2])], Exp2)]
-&gt; PassM ([[(String, [Exp2])]], [Exp2])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; PassM ([(String, [Exp2])], Exp2))
-&gt; [Exp2] -&gt; PassM [([(String, [Exp2])], Exp2)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM ([(String, [Exp2])], Exp2)
</span><a href="#local-6989586621680967181"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680967190"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1804"></span><span>                         </span><span class="annot"><span class="annottext">([(String, [Exp2])], b) -&gt; PassM ([(String, [Exp2])], b)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[(String, [Exp2])]] -&gt; [(String, [Exp2])]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">[[(String, [Exp2])]]
</span><a href="#local-6989586621680967191"><span class="hs-identifier hs-var">bndss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Exp2] -&gt; b
</span><a href="#local-6989586621680967189"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680967192"><span class="hs-identifier hs-var">ls'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1805"></span><span>
</span><span id="line-1806"></span><span>      </span><span class="hs-keyword">in</span><span>
</span><span id="line-1807"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967180"><span class="hs-identifier hs-var">e0</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1808"></span><span>
</span><span id="line-1809"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-type">DataConE</span></a></span><span> </span><span id="local-6989586621680967193"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967193"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621680967194"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680967194"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680967195"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680967195"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2))
-&gt; ([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680967194"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680967195"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; String -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
loc -&gt; String -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-var">DataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967193"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680967194"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680967195"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1810"></span><span>
</span><span id="line-1811"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967196"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967196"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967197"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967197"><span class="hs-identifier hs-var">locs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967198"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680967198"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#StartOfPkdCursor"><span class="hs-identifier hs-type">L2.StartOfPkdCursor</span></a></span><span> </span><span id="local-6989586621680967199"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967199"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621680967200"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967200"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1812"></span><span>          </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967201"><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967201"><span class="hs-identifier hs-var">bnd2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967202"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967202"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DDefs Ty2 -&gt; Env2 Ty2 -&gt; Exp2 -&gt; PassM ([(String, [Exp2])], Exp2)
</span><a href="#local-6989586621680967162"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs Ty2
</span><a href="#local-6989586621680967178"><span class="hs-identifier hs-var">ddfs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; Env2 Ty2 -&gt; Env2 Ty2
forall a. Var -&gt; a -&gt; Env2 a -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#extendVEnv"><span class="hs-identifier hs-var">L1.extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967196"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680967198"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty2
</span><a href="#local-6989586621680967179"><span class="hs-identifier hs-var">env2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967200"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-1813"></span><span>             </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">((String, [Exp2]) -&gt; Bool)
-&gt; [(String, [Exp2])] -&gt; Maybe (String, [Exp2])
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#find"><span class="hs-identifier hs-var">L.find</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680967204"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680967204"><span class="hs-identifier hs-var">dcon</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967205"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680967205"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; [Exp2] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#elem"><span class="hs-identifier hs-var">L.elem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967196"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680967205"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967201"><span class="hs-identifier hs-var">bnd2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1814"></span><span>               </span><span class="annot"><span class="annottext">Maybe (String, [Exp2])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; PassM ([(String, [Exp2])], Exp2))
-&gt; String -&gt; PassM ([(String, [Exp2])], Exp2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967196"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; not found in any datacon args, &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, [Exp2])] -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967201"><span class="hs-identifier hs-var">bnd2</span></a></span><span>
</span><span id="line-1815"></span><span>               </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967206"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680967206"><span class="hs-identifier hs-var">dcon</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967207"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680967207"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1816"></span><span>                 </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967208"><span class="annot"><span class="annottext">tys :: [Ty2]
</span><a href="#local-6989586621680967208"><span class="hs-identifier hs-var hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DDefs Ty2 -&gt; String -&gt; [Ty2]
forall a. Out a =&gt; DDefs a -&gt; String -&gt; [a]
</span><a href="Gibbon.Language.Syntax.html#lookupDataCon"><span class="hs-identifier hs-var">lookupDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs Ty2
</span><a href="#local-6989586621680967178"><span class="hs-identifier hs-var">ddfs</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680967206"><span class="hs-identifier hs-var">dcon</span></a></span><span>
</span><span id="line-1817"></span><span>                     </span><span id="local-6989586621680967209"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621680967209"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Ty2] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680967210"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621680967210"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680967210"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680967208"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680967210"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2 -&gt; Ty2 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
forall loc. UrTy loc
</span><a href="Gibbon.Language.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-1818"></span><span>                     </span><span id="local-6989586621680967211"><span class="annot"><span class="annottext">rans :: [Exp2]
</span><a href="#local-6989586621680967211"><span class="hs-identifier hs-var hs-var">rans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Exp2] -&gt; [Exp2]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#take"><span class="hs-identifier hs-var">L.take</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680967209"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680967207"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1819"></span><span>                     </span><span id="local-6989586621680967213"><span class="annot"><span class="annottext">needRANsExp :: [Exp2]
</span><a href="#local-6989586621680967213"><span class="hs-identifier hs-var hs-var">needRANsExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Exp2] -&gt; [Exp2]
forall a. [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#reverse"><span class="hs-identifier hs-var">L.reverse</span></a></span><span> </span><span class="annot"><span class="annottext">([Exp2] -&gt; [Exp2]) -&gt; [Exp2] -&gt; [Exp2]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Exp2] -&gt; [Exp2]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#take"><span class="hs-identifier hs-var">L.take</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680967209"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Exp2] -&gt; [Exp2]
forall a. [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#reverse"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680967207"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1820"></span><span>                     </span><span id="local-6989586621680967215"><span class="annot"><span class="annottext">ran_pairs :: Map Exp2 Exp2
</span><a href="#local-6989586621680967215"><span class="hs-identifier hs-var hs-var">ran_pairs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Exp2, Exp2)] -&gt; Map Exp2 Exp2
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(Exp2, Exp2)] -&gt; Map Exp2 Exp2)
-&gt; [(Exp2, Exp2)] -&gt; Map Exp2 Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2] -&gt; [Exp2] -&gt; [(Exp2, Exp2)]
forall a b.
(Show a, Show b, HasCallStack) =&gt;
[a] -&gt; [b] -&gt; [(a, b)]
</span><a href="Gibbon.Common.html#fragileZip"><span class="hs-identifier hs-var">fragileZip</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680967211"><span class="hs-identifier hs-var">rans</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680967213"><span class="hs-identifier hs-var">needRANsExp</span></a></span><span>
</span><span id="line-1821"></span><span>                     </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span id="local-6989586621680967216"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967216"><span class="hs-identifier hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Exp2 Exp2
</span><a href="#local-6989586621680967215"><span class="hs-identifier hs-var">ran_pairs</span></a></span><span> </span><span class="annot"><span class="annottext">Map Exp2 Exp2 -&gt; Exp2 -&gt; Exp2
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#%21"><span class="hs-operator hs-var">M.!</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967196"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-1822"></span><span>                 </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967201"><span class="hs-identifier hs-var">bnd2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967196"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967197"><span class="hs-identifier hs-var">locs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680967198"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#StartOfPkdCursor"><span class="hs-identifier hs-var">L2.StartOfPkdCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967216"><span class="hs-identifier hs-var">w'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967202"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1823"></span><span>
</span><span id="line-1824"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967218"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967218"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967219"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967219"><span class="hs-identifier hs-var">locs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967220"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680967220"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967221"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967221"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680967222"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967222"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967223"><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967223"><span class="hs-identifier hs-var">bnd1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967224"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967224"><span class="hs-identifier hs-var">rhs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM ([(String, [Exp2])], Exp2)
</span><a href="#local-6989586621680967181"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967221"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1825"></span><span>                                      </span><span class="hs-special">(</span><span id="local-6989586621680967225"><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967225"><span class="hs-identifier hs-var">bnd2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967226"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967226"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DDefs Ty2 -&gt; Env2 Ty2 -&gt; Exp2 -&gt; PassM ([(String, [Exp2])], Exp2)
</span><a href="#local-6989586621680967162"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs Ty2
</span><a href="#local-6989586621680967178"><span class="hs-identifier hs-var">ddfs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty2 -&gt; Env2 Ty2 -&gt; Env2 Ty2
forall a. Var -&gt; a -&gt; Env2 a -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#extendVEnv"><span class="hs-identifier hs-var">L1.extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967218"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680967220"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty2
</span><a href="#local-6989586621680967179"><span class="hs-identifier hs-var">env2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967222"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-1826"></span><span>                                      </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967223"><span class="hs-identifier hs-var">bnd1</span></a></span><span class="annot"><span class="annottext">[(String, [Exp2])] -&gt; [(String, [Exp2])] -&gt; [(String, [Exp2])]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967225"><span class="hs-identifier hs-var">bnd2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Var, [Var], Ty2, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967218"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967219"><span class="hs-identifier hs-var">locs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680967220"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967224"><span class="hs-identifier hs-var">rhs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967226"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1827"></span><span>
</span><span id="line-1828"></span><span>        </span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-1829"></span><span>
</span><span id="line-1830"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span id="local-6989586621680967227"><span class="annot"><span class="annottext">E2Ext Var Ty2
</span><a href="#local-6989586621680967227"><span class="hs-identifier hs-var">ext</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">E2Ext Var Ty2
</span><a href="#local-6989586621680967227"><span class="hs-identifier hs-var">ext</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1831"></span><span>                     </span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetRegionE"><span class="hs-identifier hs-type">LetRegionE</span></a></span><span> </span><span id="local-6989586621680967228"><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680967228"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680967229"><span class="annot"><span class="annottext">RegionSize
</span><a href="#local-6989586621680967229"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span id="local-6989586621680967230"><span class="annot"><span class="annottext">Maybe RegionType
</span><a href="#local-6989586621680967230"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680967231"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967231"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1832"></span><span>                       </span><span class="hs-special">(</span><span id="local-6989586621680967232"><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967232"><span class="hs-identifier hs-var">bnds</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967233"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967233"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM ([(String, [Exp2])], Exp2)
</span><a href="#local-6989586621680967181"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967231"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-1833"></span><span>                       </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967232"><span class="hs-identifier hs-var">bnds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E2Ext Var Ty2 -&gt; Exp2) -&gt; E2Ext Var Ty2 -&gt; Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Region -&gt; RegionSize -&gt; Maybe RegionType -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec.
Region
-&gt; RegionSize -&gt; Maybe RegionType -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetRegionE"><span class="hs-identifier hs-var">LetRegionE</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680967228"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">RegionSize
</span><a href="#local-6989586621680967229"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RegionType
</span><a href="#local-6989586621680967230"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967233"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1834"></span><span>
</span><span id="line-1835"></span><span>                     </span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetParRegionE"><span class="hs-identifier hs-type">LetParRegionE</span></a></span><span> </span><span id="local-6989586621680967234"><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680967234"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621680967235"><span class="annot"><span class="annottext">RegionSize
</span><a href="#local-6989586621680967235"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span id="local-6989586621680967236"><span class="annot"><span class="annottext">Maybe RegionType
</span><a href="#local-6989586621680967236"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680967237"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967237"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1836"></span><span>                       </span><span class="hs-special">(</span><span id="local-6989586621680967238"><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967238"><span class="hs-identifier hs-var">bnds</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967239"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967239"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM ([(String, [Exp2])], Exp2)
</span><a href="#local-6989586621680967181"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967237"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-1837"></span><span>                       </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967238"><span class="hs-identifier hs-var">bnds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E2Ext Var Ty2 -&gt; Exp2) -&gt; E2Ext Var Ty2 -&gt; Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Region -&gt; RegionSize -&gt; Maybe RegionType -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec.
Region
-&gt; RegionSize -&gt; Maybe RegionType -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetParRegionE"><span class="hs-identifier hs-var">LetParRegionE</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680967234"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">RegionSize
</span><a href="#local-6989586621680967235"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RegionType
</span><a href="#local-6989586621680967236"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967239"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1838"></span><span>
</span><span id="line-1839"></span><span>                     </span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-type">LetLocE</span></a></span><span> </span><span id="local-6989586621680967240"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967240"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621680967241"><span class="annot"><span class="annottext">PreLocExp Var
</span><a href="#local-6989586621680967241"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span id="local-6989586621680967242"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967242"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1840"></span><span>                       </span><span class="hs-special">(</span><span id="local-6989586621680967243"><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967243"><span class="hs-identifier hs-var">bnds</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967244"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967244"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM ([(String, [Exp2])], Exp2)
</span><a href="#local-6989586621680967181"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967242"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-1841"></span><span>                       </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967243"><span class="hs-identifier hs-var">bnds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E2Ext Var Ty2 -&gt; Exp2) -&gt; E2Ext Var Ty2 -&gt; Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; PreLocExp Var -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec. Var -&gt; PreLocExp loc -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-var">LetLocE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967240"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">PreLocExp Var
</span><a href="#local-6989586621680967241"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967244"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1842"></span><span>
</span><span id="line-1843"></span><span>                     </span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetAvail"><span class="hs-identifier hs-type">LetAvail</span></a></span><span> </span><span id="local-6989586621680967245"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967245"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621680967246"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967246"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1844"></span><span>                       </span><span class="hs-special">(</span><span id="local-6989586621680967247"><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967247"><span class="hs-identifier hs-var">bnds</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967248"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967248"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM ([(String, [Exp2])], Exp2)
</span><a href="#local-6989586621680967181"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967246"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-1845"></span><span>                       </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967247"><span class="hs-identifier hs-var">bnds</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E2Ext Var Ty2 -&gt; Exp2) -&gt; E2Ext Var Ty2 -&gt; Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; Exp2 -&gt; E2Ext Var Ty2
forall loc dec. [Var] -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetAvail"><span class="hs-identifier hs-var">LetAvail</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967245"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967248"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1846"></span><span>
</span><span id="line-1847"></span><span>                     </span><span class="annot"><a href="Gibbon.L2.Syntax.html#RetE"><span class="hs-identifier hs-type">RetE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967180"><span class="hs-identifier hs-var">e0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1848"></span><span>                     </span><span class="annot"><a href="Gibbon.L2.Syntax.html#FromEndE"><span class="hs-identifier hs-type">FromEndE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967180"><span class="hs-identifier hs-var">e0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1849"></span><span>                     </span><span class="annot"><a href="Gibbon.L2.Syntax.html#AddFixed"><span class="hs-identifier hs-type">L2.AddFixed</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967180"><span class="hs-identifier hs-var">e0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1850"></span><span>                     </span><span class="annot"><a href="Gibbon.L2.Syntax.html#BoundsCheck"><span class="hs-identifier hs-type">BoundsCheck</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967180"><span class="hs-identifier hs-var">e0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1851"></span><span>                     </span><span class="annot"><a href="Gibbon.L2.Syntax.html#IndirectionE"><span class="hs-identifier hs-type">IndirectionE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967180"><span class="hs-identifier hs-var">e0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1852"></span><span>                     </span><span class="annot"><span class="annottext">E2Ext Var Ty2
</span><a href="Gibbon.L2.Syntax.html#GetCilkWorkerNum"><span class="hs-identifier hs-var">GetCilkWorkerNum</span></a></span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967180"><span class="hs-identifier hs-var">e0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1853"></span><span>                     </span><span class="annot"><a href="Gibbon.L2.Syntax.html#StartOfPkdCursor"><span class="hs-identifier hs-type">L2.StartOfPkdCursor</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; PassM ([(String, [Exp2])], Exp2))
-&gt; String -&gt; PassM ([(String, [Exp2])], Exp2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;uncaught RAN: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">E2Ext Var Ty2 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">E2Ext Var Ty2
</span><a href="#local-6989586621680967227"><span class="hs-identifier hs-var">ext</span></a></span><span>
</span><span id="line-1854"></span><span>                     </span><span class="annot"><a href="Gibbon.L2.Syntax.html#TagCursor"><span class="hs-identifier hs-type">L2.TagCursor</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967180"><span class="hs-identifier hs-var">e0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1855"></span><span>                     </span><span class="annot"><a href="Gibbon.L2.Syntax.html#AllocateTagHere"><span class="hs-identifier hs-type">AllocateTagHere</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967180"><span class="hs-identifier hs-var">e0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1856"></span><span>                     </span><span class="annot"><a href="Gibbon.L2.Syntax.html#AllocateScalarsHere"><span class="hs-identifier hs-type">AllocateScalarsHere</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967180"><span class="hs-identifier hs-var">e0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1857"></span><span>                     </span><span class="annot"><a href="Gibbon.L2.Syntax.html#SSPush"><span class="hs-identifier hs-type">SSPush</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967180"><span class="hs-identifier hs-var">e0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1858"></span><span>                     </span><span class="annot"><a href="Gibbon.L2.Syntax.html#SSPop"><span class="hs-identifier hs-type">SSPop</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967180"><span class="hs-identifier hs-var">e0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1859"></span><span>
</span><span id="line-1860"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-type">LitE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967180"><span class="hs-identifier hs-var">e0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1861"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CharE"><span class="hs-identifier hs-type">CharE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967180"><span class="hs-identifier hs-var">e0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1862"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-type">FloatE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967180"><span class="hs-identifier hs-var">e0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1863"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967180"><span class="hs-identifier hs-var">e0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1864"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-type">LitSymE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967180"><span class="hs-identifier hs-var">e0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1865"></span><span>
</span><span id="line-1866"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span id="local-6989586621680967249"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967249"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680967250"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967250"><span class="hs-identifier hs-var">lvs</span></a></span></span><span> </span><span id="local-6989586621680967251"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680967251"><span class="hs-identifier hs-var">ls</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([Exp2] -&gt; Exp2) -&gt; [Exp2] -&gt; PassM ([(String, [Exp2])], Exp2)
forall {b}.
([Exp2] -&gt; b) -&gt; [Exp2] -&gt; PassM ([(String, [Exp2])], b)
</span><a href="#local-6989586621680967188"><span class="hs-identifier hs-var">gols</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967249"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967250"><span class="hs-identifier hs-var">lvs</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680967251"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1867"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span id="local-6989586621680967252"><span class="annot"><span class="annottext">Prim Ty2
</span><a href="#local-6989586621680967252"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680967253"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680967253"><span class="hs-identifier hs-var">ls</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([Exp2] -&gt; Exp2) -&gt; [Exp2] -&gt; PassM ([(String, [Exp2])], Exp2)
forall {b}.
([Exp2] -&gt; b) -&gt; [Exp2] -&gt; PassM ([(String, [Exp2])], b)
</span><a href="#local-6989586621680967188"><span class="hs-identifier hs-var">gols</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prim Ty2 -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty2
</span><a href="#local-6989586621680967252"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680967253"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1868"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-type">MkProdE</span></a></span><span> </span><span id="local-6989586621680967254"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680967254"><span class="hs-identifier hs-var">ls</span></a></span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([Exp2] -&gt; Exp2) -&gt; [Exp2] -&gt; PassM ([(String, [Exp2])], Exp2)
forall {b}.
([Exp2] -&gt; b) -&gt; [Exp2] -&gt; PassM ([(String, [Exp2])], b)
</span><a href="#local-6989586621680967188"><span class="hs-identifier hs-var">gols</span></a></span><span>  </span><span class="annot"><span class="annottext">[Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
[PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-var">MkProdE</span></a></span><span>      </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680967254"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1869"></span><span>
</span><span id="line-1870"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-type">IfE</span></a></span><span> </span><span id="local-6989586621680967255"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967255"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680967256"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967256"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680967257"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967257"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967258"><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967258"><span class="hs-identifier hs-var">b1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967259"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967259"><span class="hs-identifier hs-var">a'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM ([(String, [Exp2])], Exp2)
</span><a href="#local-6989586621680967181"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967255"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1871"></span><span>                        </span><span class="hs-special">(</span><span id="local-6989586621680967260"><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967260"><span class="hs-identifier hs-var">b2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967261"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967261"><span class="hs-identifier hs-var">b'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM ([(String, [Exp2])], Exp2)
</span><a href="#local-6989586621680967181"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967256"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1872"></span><span>                        </span><span class="hs-special">(</span><span id="local-6989586621680967262"><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967262"><span class="hs-identifier hs-var">b3</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967263"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967263"><span class="hs-identifier hs-var">c'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM ([(String, [Exp2])], Exp2)
</span><a href="#local-6989586621680967181"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967257"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-1873"></span><span>                        </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967258"><span class="hs-identifier hs-var">b1</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, [Exp2])] -&gt; [(String, [Exp2])] -&gt; [(String, [Exp2])]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967260"><span class="hs-identifier hs-var">b2</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, [Exp2])] -&gt; [(String, [Exp2])] -&gt; [(String, [Exp2])]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967262"><span class="hs-identifier hs-var">b3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; Exp2 -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-var">IfE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967259"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967261"><span class="hs-identifier hs-var">b'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967263"><span class="hs-identifier hs-var">c'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1874"></span><span>
</span><span id="line-1875"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-type">ProjE</span></a></span><span> </span><span id="local-6989586621680967264"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680967264"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span id="local-6989586621680967265"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967265"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967266"><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967266"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967267"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967267"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM ([(String, [Exp2])], Exp2)
</span><a href="#local-6989586621680967181"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967265"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1876"></span><span>                         </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967266"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Int -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-var">ProjE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680967264"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967267"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1877"></span><span>
</span><span id="line-1878"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-type">CaseE</span></a></span><span> </span><span id="local-6989586621680967268"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967268"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680967269"><span class="annot"><span class="annottext">[(String, [(Var, Var)], Exp2)]
</span><a href="#local-6989586621680967269"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967270"><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967270"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967271"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967271"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM ([(String, [Exp2])], Exp2)
</span><a href="#local-6989586621680967181"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967268"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1879"></span><span>                         </span><span id="local-6989586621680967272"><span class="annot"><span class="annottext">[([(String, [Exp2])], (String, [(Var, Var)], Exp2))]
</span><a href="#local-6989586621680967272"><span class="hs-identifier hs-var">ls'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(String, [(Var, Var)], Exp2)]
-&gt; ((String, [(Var, Var)], Exp2)
    -&gt; PassM ([(String, [Exp2])], (String, [(Var, Var)], Exp2)))
-&gt; PassM [([(String, [Exp2])], (String, [(Var, Var)], Exp2))]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#forM"><span class="hs-identifier hs-var">forM</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, [(Var, Var)], Exp2)]
</span><a href="#local-6989586621680967269"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">(((String, [(Var, Var)], Exp2)
  -&gt; PassM ([(String, [Exp2])], (String, [(Var, Var)], Exp2)))
 -&gt; PassM [([(String, [Exp2])], (String, [(Var, Var)], Exp2))])
-&gt; ((String, [(Var, Var)], Exp2)
    -&gt; PassM ([(String, [Exp2])], (String, [(Var, Var)], Exp2)))
-&gt; PassM [([(String, [Exp2])], (String, [(Var, Var)], Exp2))]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967273"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680967273"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967274"><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680967274"><span class="hs-identifier hs-var">vrs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967275"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967275"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1880"></span><span>                                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967276"><span class="annot"><span class="annottext">tys :: [Ty2]
</span><a href="#local-6989586621680967276"><span class="hs-identifier hs-var hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DDefs Ty2 -&gt; String -&gt; [Ty2]
forall a. Out a =&gt; DDefs a -&gt; String -&gt; [a]
</span><a href="Gibbon.Language.Syntax.html#lookupDataCon"><span class="hs-identifier hs-var">lookupDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs Ty2
</span><a href="#local-6989586621680967178"><span class="hs-identifier hs-var">ddfs</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680967273"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-1881"></span><span>                                      </span><span id="local-6989586621680967277"><span class="annot"><span class="annottext">vrs' :: [Var]
</span><a href="#local-6989586621680967277"><span class="hs-identifier hs-var hs-var">vrs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Var, Var) -&gt; Var) -&gt; [(Var, Var)] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Var) -&gt; Var
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680967274"><span class="hs-identifier hs-var">vrs</span></a></span><span>
</span><span id="line-1882"></span><span>                                      </span><span id="local-6989586621680967278"><span class="annot"><span class="annottext">env2' :: Env2 Ty2
</span><a href="#local-6989586621680967278"><span class="hs-identifier hs-var hs-var">env2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyEnv Ty2 -&gt; Env2 Ty2 -&gt; Env2 Ty2
forall a. Map Var a -&gt; Env2 a -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#extendsVEnv"><span class="hs-identifier hs-var">L1.extendsVEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, Ty2)] -&gt; TyEnv Ty2
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; [Ty2] -&gt; [(Var, Ty2)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967277"><span class="hs-identifier hs-var">vrs'</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty2]
</span><a href="#local-6989586621680967276"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Env2 Ty2
</span><a href="#local-6989586621680967179"><span class="hs-identifier hs-var">env2</span></a></span><span>
</span><span id="line-1883"></span><span>                                  </span><span class="hs-special">(</span><span id="local-6989586621680967279"><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967279"><span class="hs-identifier hs-var">b2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967280"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967280"><span class="hs-identifier hs-var">rhs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DDefs Ty2 -&gt; Env2 Ty2 -&gt; Exp2 -&gt; PassM ([(String, [Exp2])], Exp2)
</span><a href="#local-6989586621680967162"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs Ty2
</span><a href="#local-6989586621680967178"><span class="hs-identifier hs-var">ddfs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty2
</span><a href="#local-6989586621680967278"><span class="hs-identifier hs-var">env2'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967275"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1884"></span><span>                                  </span><span class="annot"><span class="annottext">([(String, [Exp2])], (String, [(Var, Var)], Exp2))
-&gt; PassM ([(String, [Exp2])], (String, [(Var, Var)], Exp2))
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967279"><span class="hs-identifier hs-var">b2</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680967273"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680967274"><span class="hs-identifier hs-var">vrs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967280"><span class="hs-identifier hs-var">rhs'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1885"></span><span>                         </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967281"><span class="annot"><span class="annottext">[[(String, [Exp2])]]
</span><a href="#local-6989586621680967281"><span class="hs-identifier hs-var">bndss</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967282"><span class="annot"><span class="annottext">[(String, [(Var, Var)], Exp2)]
</span><a href="#local-6989586621680967282"><span class="hs-identifier hs-var">ls''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[([(String, [Exp2])], (String, [(Var, Var)], Exp2))]
-&gt; ([[(String, [Exp2])]], [(String, [(Var, Var)], Exp2)])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">[([(String, [Exp2])], (String, [(Var, Var)], Exp2))]
</span><a href="#local-6989586621680967272"><span class="hs-identifier hs-var">ls'</span></a></span><span>
</span><span id="line-1886"></span><span>                         </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967270"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, [Exp2])] -&gt; [(String, [Exp2])] -&gt; [(String, [Exp2])]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[[(String, [Exp2])]] -&gt; [(String, [Exp2])]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">[[(String, [Exp2])]]
</span><a href="#local-6989586621680967281"><span class="hs-identifier hs-var">bndss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; [(String, [(Var, Var)], Exp2)] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; [(String, [(Var, loc)], PreExp ext loc dec)]
-&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-var">CaseE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967271"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, [(Var, Var)], Exp2)]
</span><a href="#local-6989586621680967282"><span class="hs-identifier hs-var">ls''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1887"></span><span>
</span><span id="line-1888"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-type">TimeIt</span></a></span><span> </span><span id="local-6989586621680967283"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967283"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680967284"><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680967284"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621680967285"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680967285"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1889"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680967286"><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967286"><span class="hs-identifier hs-var">bnd</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967287"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967287"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM ([(String, [Exp2])], Exp2)
</span><a href="#local-6989586621680967181"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967283"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1890"></span><span>          </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967286"><span class="hs-identifier hs-var">bnd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; Ty2 -&gt; Bool -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec -&gt; dec -&gt; Bool -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-var">TimeIt</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967287"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty2
</span><a href="#local-6989586621680967284"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680967285"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1891"></span><span>
</span><span id="line-1892"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-type">SpawnE</span></a></span><span> </span><span id="local-6989586621680967288"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967288"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680967289"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967289"><span class="hs-identifier hs-var">lvs</span></a></span></span><span> </span><span id="local-6989586621680967290"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680967290"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([Exp2] -&gt; Exp2) -&gt; [Exp2] -&gt; PassM ([(String, [Exp2])], Exp2)
forall {b}.
([Exp2] -&gt; b) -&gt; [Exp2] -&gt; PassM ([(String, [Exp2])], b)
</span><a href="#local-6989586621680967188"><span class="hs-identifier hs-var">gols</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Exp2] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-var">SpawnE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967288"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967289"><span class="hs-identifier hs-var">lvs</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680967290"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1893"></span><span>        </span><span class="annot"><span class="annottext">Exp2
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec. PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1894"></span><span>
</span><span id="line-1895"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-type">WithArenaE</span></a></span><span> </span><span id="local-6989586621680967291"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967291"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680967292"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967292"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1896"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680967293"><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967293"><span class="hs-identifier hs-var">bnd</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967294"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967294"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM ([(String, [Exp2])], Exp2)
</span><a href="#local-6989586621680967181"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967292"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1897"></span><span>          </span><span class="annot"><span class="annottext">([(String, [Exp2])], Exp2) -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(String, [Exp2])]
</span><a href="#local-6989586621680967293"><span class="hs-identifier hs-var">bnd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-var">WithArenaE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967291"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680967294"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1898"></span><span>
</span><span id="line-1899"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MapE"><span class="hs-identifier hs-type">MapE</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty2, Exp2)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;FINISHLISTS&quot;</span></span><span>
</span><span id="line-1900"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FoldE"><span class="hs-identifier hs-type">FoldE</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty2, Exp2)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">(Var, Ty2, Exp2)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; PassM ([(String, [Exp2])], Exp2)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;FINISHLISTS&quot;</span></span><span>
</span><span id="line-1901"></span><span>
</span><span id="line-1902"></span><span>
</span><span id="line-1903"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-1904"></span><span>
</span><span id="line-1905"></span><span class="annot"><span class="hs-comment">-- | Adds 'copyPacked' calls in certain places that inferLocs is not able to.</span></span><span>
</span><span id="line-1906"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#copyOutOfOrderPacked"><span class="hs-identifier hs-type">copyOutOfOrderPacked</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Prog1"><span class="hs-identifier hs-type">Prog1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Prog1"><span class="hs-identifier hs-type">Prog1</span></a></span><span>
</span><span id="line-1907"></span><span id="copyOutOfOrderPacked"><span class="annot"><span class="annottext">copyOutOfOrderPacked :: Prog1 -&gt; PassM Prog1
</span><a href="Gibbon.Passes.InferLocations.html#copyOutOfOrderPacked"><span class="hs-identifier hs-var hs-var">copyOutOfOrderPacked</span></a></span></span><span> </span><span id="local-6989586621680967422"><span class="annot"><span class="annottext">prg :: Prog1
</span><a href="#local-6989586621680967422"><span class="hs-identifier hs-var">prg</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span id="local-6989586621680967423"><span class="annot"><span class="annottext">DDefs (TyOf Exp1)
</span><a href="#local-6989586621680967423"><span class="hs-identifier hs-var">ddfs</span></a></span></span><span> </span><span id="local-6989586621680967424"><span class="annot"><span class="annottext">FunDefs Exp1
</span><a href="#local-6989586621680967424"><span class="hs-identifier hs-var">fndefs</span></a></span></span><span> </span><span id="local-6989586621680967425"><span class="annot"><span class="annottext">Maybe (Exp1, TyOf Exp1)
</span><a href="#local-6989586621680967425"><span class="hs-identifier hs-var">mnExp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1908"></span><span>    </span><span id="local-6989586621680967426"><span class="annot"><span class="annottext">Maybe (Exp1, Ty1)
</span><a href="#local-6989586621680967426"><span class="hs-identifier hs-var">mnExp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp1, TyOf Exp1)
</span><a href="#local-6989586621680967425"><span class="hs-identifier hs-var">mnExp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1909"></span><span>                   </span><span class="annot"><span class="annottext">Maybe (Exp1, TyOf Exp1)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp1, Ty1) -&gt; PassM (Maybe (Exp1, Ty1))
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Exp1, Ty1)
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1910"></span><span>                   </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967427"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967427"><span class="hs-identifier hs-var">ex</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967428"><span class="annot"><span class="annottext">TyOf Exp1
</span><a href="#local-6989586621680967428"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967429"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967429"><span class="hs-identifier hs-var">ex'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
-&gt; Map Var [(Var, Var)]
-&gt; [Var]
-&gt; Exp1
-&gt; PassM (Map Var [(Var, Var)], Exp1)
</span><a href="#local-6989586621680967430"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 (TyOf Exp1)
Env2 Ty1
</span><a href="#local-6989586621680967431"><span class="hs-identifier hs-var">init_fun_env</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967427"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-1911"></span><span>                                      </span><span class="annot"><span class="annottext">Maybe (Exp1, Ty1) -&gt; PassM (Maybe (Exp1, Ty1))
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Exp1, Ty1) -&gt; PassM (Maybe (Exp1, Ty1)))
-&gt; Maybe (Exp1, Ty1) -&gt; PassM (Maybe (Exp1, Ty1))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp1, Ty1) -&gt; Maybe (Exp1, Ty1)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967429"><span class="hs-identifier hs-var">ex'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyOf Exp1
Ty1
</span><a href="#local-6989586621680967428"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1912"></span><span>    </span><span id="local-6989586621680967432"><span class="annot"><span class="annottext">FunDefs Exp1
</span><a href="#local-6989586621680967432"><span class="hs-identifier hs-var">fndefs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FunDef Exp1 -&gt; PassM (FunDef Exp1))
-&gt; FunDefs Exp1 -&gt; PassM (FunDefs Exp1)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; Map Var a -&gt; m (Map Var b)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef Exp1 -&gt; PassM (FunDef Exp1)
</span><a href="#local-6989586621680967433"><span class="hs-identifier hs-var">fd</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp1
</span><a href="#local-6989586621680967424"><span class="hs-identifier hs-var">fndefs</span></a></span><span>
</span><span id="line-1913"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967434"><span class="annot"><span class="annottext">prg' :: Prog1
</span><a href="#local-6989586621680967434"><span class="hs-identifier hs-var hs-var">prg'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp1)
-&gt; FunDefs Exp1 -&gt; Maybe (Exp1, TyOf Exp1) -&gt; Prog1
forall ex.
DDefs (TyOf ex) -&gt; FunDefs ex -&gt; Maybe (ex, TyOf ex) -&gt; Prog ex
</span><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-var">Prog</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp1)
</span><a href="#local-6989586621680967423"><span class="hs-identifier hs-var">ddfs</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp1
</span><a href="#local-6989586621680967432"><span class="hs-identifier hs-var">fndefs'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Exp1, TyOf Exp1)
Maybe (Exp1, Ty1)
</span><a href="#local-6989586621680967426"><span class="hs-identifier hs-var">mnExp'</span></a></span><span>
</span><span id="line-1914"></span><span>    </span><span id="local-6989586621680967435"><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680967435"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Prog1 -&gt; PassM Prog1
</span><a href="Gibbon.Passes.Flatten.html#flattenL1"><span class="hs-identifier hs-var">flattenL1</span></a></span><span> </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680967434"><span class="hs-identifier hs-var">prg'</span></a></span><span>
</span><span id="line-1915"></span><span>    </span><span class="annot"><span class="annottext">Prog1 -&gt; PassM Prog1
forall (e :: * -&gt; * -&gt; *) l d.
HasSimplifiable e l d =&gt;
Prog (PreExp e l d) -&gt; PassM (Prog (PreExp e l d))
</span><a href="Gibbon.Passes.InlineTriv.html#inlineTriv"><span class="hs-identifier hs-var">inlineTriv</span></a></span><span> </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680967435"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-1916"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1917"></span><span>    </span><span id="local-6989586621680967431"><span class="annot"><span class="annottext">init_fun_env :: Env2 (TyOf Exp1)
</span><a href="#local-6989586621680967431"><span class="hs-identifier hs-var hs-var">init_fun_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prog1 -&gt; Env2 (TyOf Exp1)
forall a. Prog a -&gt; Env2 (TyOf a)
</span><a href="Gibbon.Language.Syntax.html#progToEnv"><span class="hs-identifier hs-var">progToEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680967422"><span class="hs-identifier hs-var">prg</span></a></span><span>
</span><span id="line-1918"></span><span>
</span><span id="line-1919"></span><span>    </span><span class="annot"><a href="#local-6989586621680967433"><span class="hs-identifier hs-type">fd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#FunDef1"><span class="hs-identifier hs-type">FunDef1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#FunDef1"><span class="hs-identifier hs-type">FunDef1</span></a></span><span>
</span><span id="line-1920"></span><span>    </span><span id="local-6989586621680967433"><span class="annot"><span class="annottext">fd :: FunDef Exp1 -&gt; PassM (FunDef Exp1)
</span><a href="#local-6989586621680967433"><span class="hs-identifier hs-var hs-var">fd</span></a></span></span><span> </span><span id="local-6989586621680967437"><span class="annot"><span class="annottext">fn :: FunDef Exp1
</span><a href="#local-6989586621680967437"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span class="hs-special">{</span><span id="local-6989586621680967438"><span class="annot"><span class="annottext">[Var]
funArgs :: [Var]
funArgs :: forall ex. FunDef ex -&gt; [Var]
</span><a href="#local-6989586621680967438"><span class="hs-identifier hs-var hs-var">funArgs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967440"><span class="annot"><span class="annottext">Exp1
funBody :: Exp1
funBody :: forall ex. FunDef ex -&gt; ex
</span><a href="#local-6989586621680967440"><span class="hs-identifier hs-var hs-var">funBody</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967442"><span class="annot"><span class="annottext">ArrowTy (TyOf Exp1)
funTy :: ArrowTy (TyOf Exp1)
funTy :: forall ex. FunDef ex -&gt; ArrowTy (TyOf ex)
</span><a href="#local-6989586621680967442"><span class="hs-identifier hs-var hs-var">funTy</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1921"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967444"><span class="annot"><span class="annottext">env2 :: Env2 Ty1
</span><a href="#local-6989586621680967444"><span class="hs-identifier hs-var hs-var">env2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var Ty1 -&gt; Env2 Ty1 -&gt; Env2 Ty1
forall a. Map Var a -&gt; Env2 a -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#extendsVEnv"><span class="hs-identifier hs-var">L1.extendsVEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, Ty1)] -&gt; Map Var Ty1
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(Var, Ty1)] -&gt; Map Var Ty1) -&gt; [(Var, Ty1)] -&gt; Map Var Ty1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Ty1] -&gt; [(Var, Ty1)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967438"><span class="hs-identifier hs-var">funArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Ty1], Ty1) -&gt; [Ty1]
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">([Ty1], Ty1)
ArrowTy (TyOf Exp1)
</span><a href="#local-6989586621680967442"><span class="hs-identifier hs-var">funTy</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Env2 (TyOf Exp1)
Env2 Ty1
</span><a href="#local-6989586621680967431"><span class="hs-identifier hs-var">init_fun_env</span></a></span><span>
</span><span id="line-1922"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967445"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967445"><span class="hs-identifier hs-var">funBody'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
-&gt; Map Var [(Var, Var)]
-&gt; [Var]
-&gt; Exp1
-&gt; PassM (Map Var [(Var, Var)], Exp1)
</span><a href="#local-6989586621680967430"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
</span><a href="#local-6989586621680967444"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967438"><span class="hs-identifier hs-var">funArgs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967440"><span class="hs-identifier hs-var">funBody</span></a></span><span>
</span><span id="line-1923"></span><span>        </span><span class="annot"><span class="annottext">FunDef Exp1 -&gt; PassM (FunDef Exp1)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(FunDef Exp1 -&gt; PassM (FunDef Exp1))
-&gt; FunDef Exp1 -&gt; PassM (FunDef Exp1)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef Exp1
</span><a href="#local-6989586621680967437"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funBody :: Exp1
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967445"><span class="hs-identifier hs-var">funBody'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1924"></span><span>
</span><span id="line-1925"></span><span>    </span><span class="annot"><a href="#local-6989586621680967430"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Env2"><span class="hs-identifier hs-type">Env2</span></a></span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Ty1"><span class="hs-identifier hs-type">Ty1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">M.Map</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Exp1"><span class="hs-identifier hs-type">Exp1</span></a></span><span>
</span><span id="line-1926"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">M.Map</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Exp1"><span class="hs-identifier hs-type">Exp1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1927"></span><span>    </span><span id="local-6989586621680967430"><span class="annot"><span class="annottext">go :: Env2 Ty1
-&gt; Map Var [(Var, Var)]
-&gt; [Var]
-&gt; Exp1
-&gt; PassM (Map Var [(Var, Var)], Exp1)
</span><a href="#local-6989586621680967430"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680967446"><span class="annot"><span class="annottext">Env2 Ty1
</span><a href="#local-6989586621680967446"><span class="hs-identifier hs-var">env2</span></a></span></span><span> </span><span id="local-6989586621680967447"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967447"><span class="hs-identifier hs-var">cpy_env</span></a></span></span><span> </span><span id="local-6989586621680967448"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967448"><span class="hs-identifier hs-var">order</span></a></span></span><span> </span><span id="local-6989586621680967449"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967449"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1928"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967449"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1929"></span><span>
</span><span id="line-1930"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-type">DataConE</span></a></span><span> </span><span id="local-6989586621680967450"><span class="annot"><span class="annottext">()
</span><a href="#local-6989586621680967450"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621680967451"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680967451"><span class="hs-identifier hs-var">dcon</span></a></span></span><span> </span><span id="local-6989586621680967452"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967452"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1931"></span><span>          </span><span class="hs-comment">-- assumption: program is in ANF</span><span>
</span><span id="line-1932"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967453"><span class="annot"><span class="annottext">idxs :: [(Var, Int, Int)]
</span><a href="#local-6989586621680967453"><span class="hs-identifier hs-var hs-var">idxs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967454"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680967455"><span class="hs-identifier hs-var">want</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680967456"><span class="hs-identifier hs-var">have</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1933"></span><span>                     </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span id="local-6989586621680967454"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967454"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967455"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680967455"><span class="hs-identifier hs-var">want</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Exp1] -&gt; [Int] -&gt; [(Exp1, Int)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967452"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1934"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967457"><span class="annot"><span class="annottext">ty :: Ty1
</span><a href="#local-6989586621680967457"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Env2 Ty1 -&gt; Ty1
forall a. Out a =&gt; Var -&gt; Env2 a -&gt; a
</span><a href="Gibbon.Language.Syntax.html#lookupVEnv"><span class="hs-identifier hs-var">L1.lookupVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967454"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
</span><a href="#local-6989586621680967446"><span class="hs-identifier hs-var">env2</span></a></span><span>
</span><span id="line-1935"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967456"><span class="annot"><span class="annottext">have :: Int
</span><a href="#local-6989586621680967456"><span class="hs-identifier hs-var hs-var">have</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Int
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Maybe.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; Maybe Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Var -&gt; Bool) -&gt; [Var] -&gt; Maybe Int
forall a. (a -&gt; Bool) -&gt; [a] -&gt; Maybe Int
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.OldList.html#findIndex"><span class="hs-identifier hs-var">L.findIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967454"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967448"><span class="hs-identifier hs-var">order</span></a></span><span>
</span><span id="line-1936"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; Bool
forall a. UrTy a -&gt; Bool
</span><a href="Gibbon.Language.html#isPackedTy"><span class="hs-identifier hs-var">L1.isPackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967457"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-1937"></span><span>                     </span><span class="hs-special">]</span><span>
</span><span id="line-1938"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(Var, Int, Int)]
</span><a href="#local-6989586621680967453"><span class="hs-identifier hs-var">idxs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1939"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Map Var [(Var, Var)], Exp1) -&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">((Map Var [(Var, Var)], Exp1)
 -&gt; PassM (Map Var [(Var, Var)], Exp1))
-&gt; (Map Var [(Var, Var)], Exp1)
-&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967447"><span class="hs-identifier hs-var">cpy_env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">() -&gt; String -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
loc -&gt; String -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-var">DataConE</span></a></span><span> </span><span class="annot"><span class="annottext">()
</span><a href="#local-6989586621680967450"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680967451"><span class="hs-identifier hs-var">dcon</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967452"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1940"></span><span>            </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621680967460"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967460"><span class="hs-identifier hs-var">hv</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967461"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680967461"><span class="hs-identifier hs-var">_hw</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967462"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680967462"><span class="hs-identifier hs-var">hh</span></a></span></span><span class="hs-special">)</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680967463"><span class="annot"><span class="annottext">[(Var, Int, Int)]
</span><a href="#local-6989586621680967463"><span class="hs-identifier hs-var">rst_idxs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1941"></span><span>              </span><span class="hs-comment">-- let (vars,want,have) = unzip3 idxs</span><span>
</span><span id="line-1942"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967464"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967464"><span class="hs-identifier hs-var">hv</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967465"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680967465"><span class="hs-identifier hs-var">_hw</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967466"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680967466"><span class="hs-identifier hs-var">hh</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Int, Int)] -&gt; (Var, Int, Int)
forall a. HasCallStack =&gt; [a] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Int, Int)]
</span><a href="#local-6989586621680967453"><span class="hs-identifier hs-var">idxs</span></a></span><span>
</span><span id="line-1943"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967467"><span class="annot"><span class="annottext">copies :: [[(Int, Var)]]
</span><a href="#local-6989586621680967467"><span class="hs-identifier hs-var hs-var">copies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1944"></span><span>                        </span><span class="annot"><span class="annottext">((Int, Var) -&gt; (Int, Var) -&gt; Bool)
-&gt; [(Int, Var)] -&gt; [[(Int, Var)]]
forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [[a]]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.OldList.html#groupBy"><span class="hs-identifier hs-var">L.groupBy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680967469"><span class="annot"><span class="annottext">(Int, Var)
</span><a href="#local-6989586621680967469"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621680967470"><span class="annot"><span class="annottext">(Int, Var)
</span><a href="#local-6989586621680967470"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Int, Var) -&gt; Int
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Var)
</span><a href="#local-6989586621680967469"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Var) -&gt; Int
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Var)
</span><a href="#local-6989586621680967470"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Int, Var)] -&gt; [[(Int, Var)]]) -&gt; [(Int, Var)] -&gt; [[(Int, Var)]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1945"></span><span>                        </span><span class="annot"><span class="annottext">(Int, [(Int, Var)]) -&gt; [(Int, Var)]
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">((Int, [(Int, Var)]) -&gt; [(Int, Var)])
-&gt; (Int, [(Int, Var)]) -&gt; [(Int, Var)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1946"></span><span>                        </span><span class="annot"><span class="annottext">((Int, [(Int, Var)]) -&gt; (Var, Int, Int) -&gt; (Int, [(Int, Var)]))
-&gt; (Int, [(Int, Var)]) -&gt; [(Var, Int, Int)] -&gt; (Int, [(Int, Var)])
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldl%27"><span class="hs-identifier hs-var">F.foldl'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680967472"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680967472"><span class="hs-identifier hs-var">prev</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967473"><span class="annot"><span class="annottext">[(Int, Var)]
</span><a href="#local-6989586621680967473"><span class="hs-identifier hs-var">acc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967474"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967474"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967475"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680967475"><span class="hs-identifier hs-var">_w</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967476"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680967476"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1947"></span><span>                                     </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680967476"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680967472"><span class="hs-identifier hs-var">prev</span></a></span><span>
</span><span id="line-1948"></span><span>                                     </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680967476"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Int, Var)]
</span><a href="#local-6989586621680967473"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Var)] -&gt; [(Int, Var)] -&gt; [(Int, Var)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680967476"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967474"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1949"></span><span>                                     </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680967472"><span class="hs-identifier hs-var">prev</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Int, Var)]
</span><a href="#local-6989586621680967473"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Var)] -&gt; [(Int, Var)] -&gt; [(Int, Var)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680967472"><span class="hs-identifier hs-var">prev</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967474"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1950"></span><span>                               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680967466"><span class="hs-identifier hs-var">hh</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680967466"><span class="hs-identifier hs-var">hh</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967464"><span class="hs-identifier hs-var">hv</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1951"></span><span>                               </span><span class="annot"><span class="annottext">[(Var, Int, Int)]
</span><a href="#local-6989586621680967463"><span class="hs-identifier hs-var">rst_idxs</span></a></span><span>
</span><span id="line-1952"></span><span>              </span><span class="hs-special">(</span><span id="local-6989586621680967477"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967477"><span class="hs-identifier hs-var">args1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967478"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967478"><span class="hs-identifier hs-var">cpy_env1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([(Int, Var)]
 -&gt; ([Var], Map Var [(Var, Var)])
 -&gt; PassM ([Var], Map Var [(Var, Var)]))
-&gt; ([Var], Map Var [(Var, Var)])
-&gt; [[(Int, Var)]]
-&gt; PassM ([Var], Map Var [(Var, Var)])
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; b -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldrM"><span class="hs-identifier hs-var">F.foldrM</span></a></span><span>
</span><span id="line-1953"></span><span>                       </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680967480"><span class="annot"><span class="annottext">[(Int, Var)]
</span><a href="#local-6989586621680967480"><span class="hs-identifier hs-var">groups</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967481"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967481"><span class="hs-identifier hs-var">acc1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967482"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967482"><span class="hs-identifier hs-var">acc2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1954"></span><span>                           </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(Int, Var)]
</span><a href="#local-6989586621680967480"><span class="hs-identifier hs-var">groups</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1955"></span><span>                             </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; PassM ([Var], Map Var [(Var, Var)])
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;copyOutOfOrderPacked: empty groups&quot;</span></span><span>
</span><span id="line-1956"></span><span>                             </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680967483"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967483"><span class="hs-identifier hs-var">one</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([Var], Map Var [(Var, Var)])
-&gt; PassM ([Var], Map Var [(Var, Var)])
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967483"><span class="hs-identifier hs-var">one</span></a></span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Var]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967481"><span class="hs-identifier hs-var">acc1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967482"><span class="hs-identifier hs-var">acc2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1957"></span><span>                             </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680967484"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967484"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680967485"><span class="annot"><span class="annottext">[(Int, Var)]
</span><a href="#local-6989586621680967485"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1958"></span><span>                               </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967486"><span class="annot"><span class="annottext">vars :: [Var]
</span><a href="#local-6989586621680967486"><span class="hs-identifier hs-var hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, Var) -&gt; Var) -&gt; [(Int, Var)] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Var) -&gt; Var
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, Var)]
</span><a href="#local-6989586621680967485"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1959"></span><span>                               </span><span id="local-6989586621680967487"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967487"><span class="hs-identifier hs-var">vars'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; PassM Var) -&gt; [Var] -&gt; PassM [Var]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967486"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-1960"></span><span>                               </span><span class="annot"><span class="annottext">([Var], Map Var [(Var, Var)])
-&gt; PassM ([Var], Map Var [(Var, Var)])
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(([Var], Map Var [(Var, Var)])
 -&gt; PassM ([Var], Map Var [(Var, Var)]))
-&gt; ([Var], Map Var [(Var, Var)])
-&gt; PassM ([Var], Map Var [(Var, Var)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967484"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [Var]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967487"><span class="hs-identifier hs-var">vars'</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [Var]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967481"><span class="hs-identifier hs-var">acc1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [(Var, Var)] -&gt; Map Var [(Var, Var)] -&gt; Map Var [(Var, Var)]
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967484"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [(Var, Var)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967486"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967487"><span class="hs-identifier hs-var">vars'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967482"><span class="hs-identifier hs-var">acc2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1961"></span><span>                       </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1962"></span><span>                       </span><span class="annot"><span class="annottext">[[(Int, Var)]]
</span><a href="#local-6989586621680967467"><span class="hs-identifier hs-var">copies</span></a></span><span>
</span><span id="line-1963"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967488"><span class="annot"><span class="annottext">args2 :: [Exp1]
</span><a href="#local-6989586621680967488"><span class="hs-identifier hs-var hs-var">args2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Var], [Exp1]) -&gt; [Exp1]
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">(([Var], [Exp1]) -&gt; [Exp1]) -&gt; ([Var], [Exp1]) -&gt; [Exp1]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(([Var], [Exp1]) -&gt; Exp1 -&gt; ([Var], [Exp1]))
-&gt; ([Var], [Exp1]) -&gt; [Exp1] -&gt; ([Var], [Exp1])
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">foldl</span></a></span><span>
</span><span id="line-1964"></span><span>                            </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680967490"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967490"><span class="hs-identifier hs-var">args1'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967491"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967491"><span class="hs-identifier hs-var">acc</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680967492"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967492"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1965"></span><span>                               </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967492"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1966"></span><span>                                 </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span id="local-6989586621680967493"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967493"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Ty1 -&gt; Bool
forall a. UrTy a -&gt; Bool
</span><a href="Gibbon.Language.html#isPackedTy"><span class="hs-identifier hs-var">isPackedTy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Env2 Ty1 -&gt; Ty1
forall a. Out a =&gt; Var -&gt; Env2 a -&gt; a
</span><a href="Gibbon.Language.Syntax.html#lookupVEnv"><span class="hs-identifier hs-var">L1.lookupVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967493"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
</span><a href="#local-6989586621680967446"><span class="hs-identifier hs-var">env2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1967"></span><span>                                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; [Var]
forall a. HasCallStack =&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#tail"><span class="hs-identifier hs-var">tail</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967490"><span class="hs-identifier hs-var">args1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967491"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1] -&gt; [Exp1] -&gt; [Exp1]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; Var
forall a. HasCallStack =&gt; [a] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967490"><span class="hs-identifier hs-var">args1'</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1968"></span><span>                                 </span><span class="annot"><span class="annottext">Exp1
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967490"><span class="hs-identifier hs-var">args1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967491"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1] -&gt; [Exp1] -&gt; [Exp1]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967492"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1969"></span><span>                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967477"><span class="hs-identifier hs-var">args1</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1970"></span><span>                            </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967452"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-1971"></span><span>              </span><span class="annot"><span class="annottext">(Map Var [(Var, Var)], Exp1) -&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">((Map Var [(Var, Var)], Exp1)
 -&gt; PassM (Map Var [(Var, Var)], Exp1))
-&gt; (Map Var [(Var, Var)], Exp1)
-&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967478"><span class="hs-identifier hs-var">cpy_env1</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
-&gt; Map Var [(Var, Var)] -&gt; Map Var [(Var, Var)]
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967447"><span class="hs-identifier hs-var">cpy_env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">() -&gt; String -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
loc -&gt; String -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-var">DataConE</span></a></span><span> </span><span class="annot"><span class="annottext">()
</span><a href="#local-6989586621680967450"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680967451"><span class="hs-identifier hs-var">dcon</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967488"><span class="hs-identifier hs-var">args2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1972"></span><span>
</span><span id="line-1973"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967495"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967495"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967496"><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680967496"><span class="hs-identifier hs-var">locs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967497"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967497"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967498"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967498"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680967499"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967499"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1974"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680967500"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967500"><span class="hs-identifier hs-var">cpy_env1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967501"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967501"><span class="hs-identifier hs-var">rhs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
-&gt; Map Var [(Var, Var)]
-&gt; [Var]
-&gt; Exp1
-&gt; PassM (Map Var [(Var, Var)], Exp1)
</span><a href="#local-6989586621680967430"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
</span><a href="#local-6989586621680967446"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967447"><span class="hs-identifier hs-var">cpy_env</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967448"><span class="hs-identifier hs-var">order</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967498"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1975"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680967502"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967502"><span class="hs-identifier hs-var">cpy_env2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967503"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967503"><span class="hs-identifier hs-var">bod1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
-&gt; Map Var [(Var, Var)]
-&gt; [Var]
-&gt; Exp1
-&gt; PassM (Map Var [(Var, Var)], Exp1)
</span><a href="#local-6989586621680967430"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Ty1 -&gt; Env2 Ty1 -&gt; Env2 Ty1
forall a. Var -&gt; a -&gt; Env2 a -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#extendVEnv"><span class="hs-identifier hs-var">L1.extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967495"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967497"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
</span><a href="#local-6989586621680967446"><span class="hs-identifier hs-var">env2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967500"><span class="hs-identifier hs-var">cpy_env1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967448"><span class="hs-identifier hs-var">order</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [Var]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967495"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967499"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-1976"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Map Var [(Var, Var)] -&gt; Maybe [(Var, Var)]
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967495"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967502"><span class="hs-identifier hs-var">cpy_env2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1977"></span><span>            </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680967504"><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680967504"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967505"><span class="annot"><span class="annottext">binds :: [(Var, [()], Ty1, Exp1)]
</span><a href="#local-6989586621680967505"><span class="hs-identifier hs-var hs-var">binds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Var, Var) -&gt; (Var, [()], Ty1, Exp1))
-&gt; [(Var, Var)] -&gt; [(Var, [()], Ty1, Exp1)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680967506"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967506"><span class="hs-identifier hs-var">old</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967507"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967507"><span class="hs-identifier hs-var">new</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span id="local-6989586621680967508"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680967508"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Env2 Ty1 -&gt; Ty1
forall a. Out a =&gt; Var -&gt; Env2 a -&gt; a
</span><a href="Gibbon.Language.Syntax.html#lookupVEnv"><span class="hs-identifier hs-var">L1.lookupVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967506"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
</span><a href="#local-6989586621680967446"><span class="hs-identifier hs-var">env2</span></a></span><span>
</span><span id="line-1978"></span><span>                                                             </span><span id="local-6989586621680967509"><span class="annot"><span class="annottext">f :: Var
</span><a href="#local-6989586621680967509"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Var
</span><a href="Gibbon.Language.Constants.html#mkCopyFunName"><span class="hs-identifier hs-var">mkCopyFunName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680967508"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-1979"></span><span>                                                         </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967507"><span class="hs-identifier hs-var">new</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">String -&gt; () -&gt; Ty1
forall loc. String -&gt; loc -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-var">PackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680967508"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Var -&gt; [()] -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967509"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967506"><span class="hs-identifier hs-var">old</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1980"></span><span>                                          </span><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680967504"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-1981"></span><span>                              </span><span id="local-6989586621680967510"><span class="annot"><span class="annottext">binds1 :: [(Var, [()], Ty1, Exp1)]
</span><a href="#local-6989586621680967510"><span class="hs-identifier hs-var hs-var">binds1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967495"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680967496"><span class="hs-identifier hs-var">locs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967497"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967501"><span class="hs-identifier hs-var">rhs1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Var, [()], Ty1, Exp1)
-&gt; [(Var, [()], Ty1, Exp1)] -&gt; [(Var, [()], Ty1, Exp1)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [()], Ty1, Exp1)]
</span><a href="#local-6989586621680967505"><span class="hs-identifier hs-var">binds</span></a></span><span>
</span><span id="line-1982"></span><span>                          </span><span class="annot"><span class="annottext">(Map Var [(Var, Var)], Exp1) -&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">((Map Var [(Var, Var)], Exp1)
 -&gt; PassM (Map Var [(Var, Var)], Exp1))
-&gt; (Map Var [(Var, Var)], Exp1)
-&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967502"><span class="hs-identifier hs-var">cpy_env2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Var, [()], Ty1, Exp1)] -&gt; Exp1 -&gt; Exp1
forall loc dec (ext :: * -&gt; * -&gt; *).
[(Var, [loc], dec, PreExp ext loc dec)]
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.html#mkLets"><span class="hs-identifier hs-var">mkLets</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [()], Ty1, Exp1)]
</span><a href="#local-6989586621680967510"><span class="hs-identifier hs-var">binds1</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967503"><span class="hs-identifier hs-var">bod1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1983"></span><span>            </span><span class="annot"><span class="annottext">Maybe [(Var, Var)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Map Var [(Var, Var)], Exp1) -&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">((Map Var [(Var, Var)], Exp1)
 -&gt; PassM (Map Var [(Var, Var)], Exp1))
-&gt; (Map Var [(Var, Var)], Exp1)
-&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967502"><span class="hs-identifier hs-var">cpy_env2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Var, [()], Ty1, Exp1) -&gt; Exp1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967495"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680967496"><span class="hs-identifier hs-var">locs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967497"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967501"><span class="hs-identifier hs-var">rhs1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967503"><span class="hs-identifier hs-var">bod1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1984"></span><span>
</span><span id="line-1985"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-type">CaseE</span></a></span><span> </span><span id="local-6989586621680967511"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967511"><span class="hs-identifier hs-var">scrt</span></a></span></span><span> </span><span id="local-6989586621680967512"><span class="annot"><span class="annottext">[(String, [(Var, ())], Exp1)]
</span><a href="#local-6989586621680967512"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1986"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680967513"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967513"><span class="hs-identifier hs-var">cpy_env1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967514"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967514"><span class="hs-identifier hs-var">scrt1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
-&gt; Map Var [(Var, Var)]
-&gt; [Var]
-&gt; Exp1
-&gt; PassM (Map Var [(Var, Var)], Exp1)
</span><a href="#local-6989586621680967430"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
</span><a href="#local-6989586621680967446"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967447"><span class="hs-identifier hs-var">cpy_env</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967448"><span class="hs-identifier hs-var">order</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967511"><span class="hs-identifier hs-var">scrt</span></a></span><span>
</span><span id="line-1987"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967515"><span class="annot"><span class="annottext">doPat :: (String, [(Var, ())], Exp1)
-&gt; (Map Var [(Var, Var)], [(String, [(Var, ())], Exp1)])
-&gt; PassM (Map Var [(Var, Var)], [(String, [(Var, ())], Exp1)])
</span><a href="#local-6989586621680967515"><span class="hs-identifier hs-var hs-var">doPat</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967516"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680967516"><span class="hs-identifier hs-var">dcon</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967517"><span class="annot"><span class="annottext">[(Var, ())]
</span><a href="#local-6989586621680967517"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967518"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967518"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967519"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967519"><span class="hs-identifier hs-var">acc1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967520"><span class="annot"><span class="annottext">[(String, [(Var, ())], Exp1)]
</span><a href="#local-6989586621680967520"><span class="hs-identifier hs-var">acc2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1988"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967521"><span class="annot"><span class="annottext">vars :: [Var]
</span><a href="#local-6989586621680967521"><span class="hs-identifier hs-var hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Var, ()) -&gt; Var) -&gt; [(Var, ())] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, ()) -&gt; Var
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, ())]
</span><a href="#local-6989586621680967517"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-1989"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967522"><span class="annot"><span class="annottext">tys :: [Ty1]
</span><a href="#local-6989586621680967522"><span class="hs-identifier hs-var hs-var">tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DDefs Ty1 -&gt; String -&gt; [Ty1]
forall a. Out a =&gt; DDefs a -&gt; String -&gt; [a]
</span><a href="Gibbon.Language.Syntax.html#lookupDataCon"><span class="hs-identifier hs-var">lookupDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp1)
DDefs Ty1
</span><a href="#local-6989586621680967423"><span class="hs-identifier hs-var">ddfs</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680967516"><span class="hs-identifier hs-var">dcon</span></a></span><span>
</span><span id="line-1990"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967523"><span class="annot"><span class="annottext">env2' :: Env2 Ty1
</span><a href="#local-6989586621680967523"><span class="hs-identifier hs-var hs-var">env2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var Ty1 -&gt; Env2 Ty1 -&gt; Env2 Ty1
forall a. Map Var a -&gt; Env2 a -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#extendsVEnv"><span class="hs-identifier hs-var">L1.extendsVEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, Ty1)] -&gt; Map Var Ty1
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; [Ty1] -&gt; [(Var, Ty1)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967521"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">[Ty1]
</span><a href="#local-6989586621680967522"><span class="hs-identifier hs-var">tys</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
</span><a href="#local-6989586621680967446"><span class="hs-identifier hs-var">env2</span></a></span><span>
</span><span id="line-1991"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621680967524"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967524"><span class="hs-identifier hs-var">acc1'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967525"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967525"><span class="hs-identifier hs-var">rhs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
-&gt; Map Var [(Var, Var)]
-&gt; [Var]
-&gt; Exp1
-&gt; PassM (Map Var [(Var, Var)], Exp1)
</span><a href="#local-6989586621680967430"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
</span><a href="#local-6989586621680967523"><span class="hs-identifier hs-var">env2'</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967519"><span class="hs-identifier hs-var">acc1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967448"><span class="hs-identifier hs-var">order</span></a></span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [Var]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967521"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967518"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-1992"></span><span>                </span><span class="hs-comment">-- FIXME check</span><span>
</span><span id="line-1993"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967526"><span class="annot"><span class="annottext">rhs2 :: Exp1
</span><a href="#local-6989586621680967526"><span class="hs-identifier hs-var hs-var">rhs2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var -&gt; Exp1 -&gt; Exp1) -&gt; Exp1 -&gt; [Var] -&gt; Exp1
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680967527"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967527"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621680967528"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967528"><span class="hs-identifier hs-var">acc3</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Map Var [(Var, Var)] -&gt; Maybe [(Var, Var)]
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967527"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967524"><span class="hs-identifier hs-var">acc1'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1994"></span><span>                                               </span><span class="annot"><span class="annottext">Maybe [(Var, Var)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967528"><span class="hs-identifier hs-var">acc3</span></a></span><span>
</span><span id="line-1995"></span><span>                                               </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680967529"><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680967529"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1996"></span><span>                                                 </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967530"><span class="annot"><span class="annottext">binds :: [(Var, [()], Ty1, Exp1)]
</span><a href="#local-6989586621680967530"><span class="hs-identifier hs-var hs-var">binds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Var, Var) -&gt; (Var, [()], Ty1, Exp1))
-&gt; [(Var, Var)] -&gt; [(Var, [()], Ty1, Exp1)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680967531"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967531"><span class="hs-identifier hs-var">old</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967532"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967532"><span class="hs-identifier hs-var">new</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1997"></span><span>                                                                    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span id="local-6989586621680967533"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680967533"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Env2 Ty1 -&gt; Ty1
forall a. Out a =&gt; Var -&gt; Env2 a -&gt; a
</span><a href="Gibbon.Language.Syntax.html#lookupVEnv"><span class="hs-identifier hs-var">L1.lookupVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967531"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
</span><a href="#local-6989586621680967523"><span class="hs-identifier hs-var">env2'</span></a></span><span>
</span><span id="line-1998"></span><span>                                                                        </span><span id="local-6989586621680967534"><span class="annot"><span class="annottext">f :: Var
</span><a href="#local-6989586621680967534"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Var
</span><a href="Gibbon.Language.Constants.html#mkCopyFunName"><span class="hs-identifier hs-var">mkCopyFunName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680967533"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-1999"></span><span>                                                                    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967532"><span class="hs-identifier hs-var">new</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">String -&gt; () -&gt; Ty1
forall loc. String -&gt; loc -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-var">PackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680967533"><span class="hs-identifier hs-var">tycon</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Var -&gt; [()] -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967534"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967531"><span class="hs-identifier hs-var">old</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2000"></span><span>                                                             </span><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680967529"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-2001"></span><span>                                                 </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[(Var, [()], Ty1, Exp1)] -&gt; Exp1 -&gt; Exp1
forall loc dec (ext :: * -&gt; * -&gt; *).
[(Var, [loc], dec, PreExp ext loc dec)]
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.html#mkLets"><span class="hs-identifier hs-var">mkLets</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [()], Ty1, Exp1)]
</span><a href="#local-6989586621680967530"><span class="hs-identifier hs-var">binds</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967525"><span class="hs-identifier hs-var">rhs1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2002"></span><span>                                 </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967525"><span class="hs-identifier hs-var">rhs1</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967521"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-2003"></span><span>                </span><span class="annot"><span class="annottext">(Map Var [(Var, Var)], [(String, [(Var, ())], Exp1)])
-&gt; PassM (Map Var [(Var, Var)], [(String, [(Var, ())], Exp1)])
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967524"><span class="hs-identifier hs-var">acc1'</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
-&gt; Map Var [(Var, Var)] -&gt; Map Var [(Var, Var)]
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967513"><span class="hs-identifier hs-var">cpy_env1</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680967516"><span class="hs-identifier hs-var">dcon</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(Var, ())]
</span><a href="#local-6989586621680967517"><span class="hs-identifier hs-var">vs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967526"><span class="hs-identifier hs-var">rhs2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String, [(Var, ())], Exp1)
-&gt; [(String, [(Var, ())], Exp1)] -&gt; [(String, [(Var, ())], Exp1)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, [(Var, ())], Exp1)]
</span><a href="#local-6989586621680967520"><span class="hs-identifier hs-var">acc2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2004"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680967535"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967535"><span class="hs-identifier hs-var">cpy_env2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967536"><span class="annot"><span class="annottext">[(String, [(Var, ())], Exp1)]
</span><a href="#local-6989586621680967536"><span class="hs-identifier hs-var">ls1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((String, [(Var, ())], Exp1)
 -&gt; (Map Var [(Var, Var)], [(String, [(Var, ())], Exp1)])
 -&gt; PassM (Map Var [(Var, Var)], [(String, [(Var, ())], Exp1)]))
-&gt; (Map Var [(Var, Var)], [(String, [(Var, ())], Exp1)])
-&gt; [(String, [(Var, ())], Exp1)]
-&gt; PassM (Map Var [(Var, Var)], [(String, [(Var, ())], Exp1)])
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; b -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldrM"><span class="hs-identifier hs-var">F.foldrM</span></a></span><span> </span><span class="annot"><span class="annottext">(String, [(Var, ())], Exp1)
-&gt; (Map Var [(Var, Var)], [(String, [(Var, ())], Exp1)])
-&gt; PassM (Map Var [(Var, Var)], [(String, [(Var, ())], Exp1)])
</span><a href="#local-6989586621680967515"><span class="hs-identifier hs-var">doPat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967513"><span class="hs-identifier hs-var">cpy_env1</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(String, [(Var, ())], Exp1)]
</span><a href="#local-6989586621680967512"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-2005"></span><span>          </span><span class="annot"><span class="annottext">(Map Var [(Var, Var)], Exp1) -&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">((Map Var [(Var, Var)], Exp1)
 -&gt; PassM (Map Var [(Var, Var)], Exp1))
-&gt; (Map Var [(Var, Var)], Exp1)
-&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967535"><span class="hs-identifier hs-var">cpy_env2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; [(String, [(Var, ())], Exp1)] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; [(String, [(Var, loc)], PreExp ext loc dec)]
-&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-var">CaseE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967514"><span class="hs-identifier hs-var">scrt1</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, [(Var, ())], Exp1)]
</span><a href="#local-6989586621680967536"><span class="hs-identifier hs-var">ls1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2006"></span><span>
</span><span id="line-2007"></span><span>
</span><span id="line-2008"></span><span>        </span><span class="hs-comment">----------------------------------------</span><span>
</span><span id="line-2009"></span><span>
</span><span id="line-2010"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Map Var [(Var, Var)], Exp1) -&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967447"><span class="hs-identifier hs-var">cpy_env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967449"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2011"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-type">LitE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Map Var [(Var, Var)], Exp1) -&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967447"><span class="hs-identifier hs-var">cpy_env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967449"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2012"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CharE"><span class="hs-identifier hs-type">CharE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Map Var [(Var, Var)], Exp1) -&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967447"><span class="hs-identifier hs-var">cpy_env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967449"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2013"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-type">FloatE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Map Var [(Var, Var)], Exp1) -&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967447"><span class="hs-identifier hs-var">cpy_env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967449"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2014"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-type">LitSymE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Map Var [(Var, Var)], Exp1) -&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967447"><span class="hs-identifier hs-var">cpy_env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967449"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2015"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span id="local-6989586621680967537"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967537"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680967538"><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680967538"><span class="hs-identifier hs-var">locs</span></a></span></span><span> </span><span id="local-6989586621680967539"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967539"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2016"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680967540"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967540"><span class="hs-identifier hs-var">cpy_env1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967541"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967541"><span class="hs-identifier hs-var">ls1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp1
 -&gt; (Map Var [(Var, Var)], [Exp1])
 -&gt; PassM (Map Var [(Var, Var)], [Exp1]))
-&gt; (Map Var [(Var, Var)], [Exp1])
-&gt; [Exp1]
-&gt; PassM (Map Var [(Var, Var)], [Exp1])
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; b -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldrM"><span class="hs-identifier hs-var">F.foldrM</span></a></span><span>
</span><span id="line-2017"></span><span>                               </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680967542"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967542"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967543"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967543"><span class="hs-identifier hs-var">acc1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967544"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967544"><span class="hs-identifier hs-var">acc2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2018"></span><span>                                  </span><span class="hs-special">(</span><span id="local-6989586621680967545"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967545"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967546"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967546"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
-&gt; Map Var [(Var, Var)]
-&gt; [Var]
-&gt; Exp1
-&gt; PassM (Map Var [(Var, Var)], Exp1)
</span><a href="#local-6989586621680967430"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
</span><a href="#local-6989586621680967446"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967543"><span class="hs-identifier hs-var">acc1</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967448"><span class="hs-identifier hs-var">order</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967542"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-2019"></span><span>                                  </span><span class="annot"><span class="annottext">(Map Var [(Var, Var)], [Exp1])
-&gt; PassM (Map Var [(Var, Var)], [Exp1])
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967545"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
-&gt; Map Var [(Var, Var)] -&gt; Map Var [(Var, Var)]
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967543"><span class="hs-identifier hs-var">acc1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967546"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; [Exp1] -&gt; [Exp1]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967544"><span class="hs-identifier hs-var">acc2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2020"></span><span>                               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967447"><span class="hs-identifier hs-var">cpy_env</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2021"></span><span>                               </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967539"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-2022"></span><span>          </span><span class="annot"><span class="annottext">(Map Var [(Var, Var)], Exp1) -&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">((Map Var [(Var, Var)], Exp1)
 -&gt; PassM (Map Var [(Var, Var)], Exp1))
-&gt; (Map Var [(Var, Var)], Exp1)
-&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967540"><span class="hs-identifier hs-var">cpy_env1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [()] -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967537"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680967538"><span class="hs-identifier hs-var">locs</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967541"><span class="hs-identifier hs-var">ls1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2023"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span id="local-6989586621680967547"><span class="annot"><span class="annottext">Prim Ty1
</span><a href="#local-6989586621680967547"><span class="hs-identifier hs-var">pr</span></a></span></span><span> </span><span id="local-6989586621680967548"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967548"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2024"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680967549"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967549"><span class="hs-identifier hs-var">cpy_env1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967550"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967550"><span class="hs-identifier hs-var">ls1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp1
 -&gt; (Map Var [(Var, Var)], [Exp1])
 -&gt; PassM (Map Var [(Var, Var)], [Exp1]))
-&gt; (Map Var [(Var, Var)], [Exp1])
-&gt; [Exp1]
-&gt; PassM (Map Var [(Var, Var)], [Exp1])
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; b -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldrM"><span class="hs-identifier hs-var">F.foldrM</span></a></span><span>
</span><span id="line-2025"></span><span>                               </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680967551"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967551"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967552"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967552"><span class="hs-identifier hs-var">acc1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967553"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967553"><span class="hs-identifier hs-var">acc2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2026"></span><span>                                  </span><span class="hs-special">(</span><span id="local-6989586621680967554"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967554"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967555"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967555"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
-&gt; Map Var [(Var, Var)]
-&gt; [Var]
-&gt; Exp1
-&gt; PassM (Map Var [(Var, Var)], Exp1)
</span><a href="#local-6989586621680967430"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
</span><a href="#local-6989586621680967446"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967552"><span class="hs-identifier hs-var">acc1</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967448"><span class="hs-identifier hs-var">order</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967551"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-2027"></span><span>                                  </span><span class="annot"><span class="annottext">(Map Var [(Var, Var)], [Exp1])
-&gt; PassM (Map Var [(Var, Var)], [Exp1])
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967554"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
-&gt; Map Var [(Var, Var)] -&gt; Map Var [(Var, Var)]
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967552"><span class="hs-identifier hs-var">acc1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967555"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; [Exp1] -&gt; [Exp1]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967553"><span class="hs-identifier hs-var">acc2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2028"></span><span>                               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967447"><span class="hs-identifier hs-var">cpy_env</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2029"></span><span>                               </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967548"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-2030"></span><span>          </span><span class="annot"><span class="annottext">(Map Var [(Var, Var)], Exp1) -&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">((Map Var [(Var, Var)], Exp1)
 -&gt; PassM (Map Var [(Var, Var)], Exp1))
-&gt; (Map Var [(Var, Var)], Exp1)
-&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967549"><span class="hs-identifier hs-var">cpy_env1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Prim Ty1 -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="#local-6989586621680967547"><span class="hs-identifier hs-var">pr</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967550"><span class="hs-identifier hs-var">ls1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2031"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-type">IfE</span></a></span><span> </span><span id="local-6989586621680967556"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967556"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680967557"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967557"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680967558"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967558"><span class="hs-identifier hs-var">c</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2032"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680967559"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967559"><span class="hs-identifier hs-var">cpy_env1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967560"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967560"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
-&gt; Map Var [(Var, Var)]
-&gt; [Var]
-&gt; Exp1
-&gt; PassM (Map Var [(Var, Var)], Exp1)
</span><a href="#local-6989586621680967430"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
</span><a href="#local-6989586621680967446"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967447"><span class="hs-identifier hs-var">cpy_env</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967448"><span class="hs-identifier hs-var">order</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967556"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-2033"></span><span>          </span><span class="hs-comment">-- Here each branch should be given its the same env since we are assuming that the branchches unify with the destination and not with each other. </span><span>
</span><span id="line-2034"></span><span>          </span><span class="hs-comment">-- TODO : Confirm </span><span>
</span><span id="line-2035"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680967561"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967561"><span class="hs-identifier hs-var">cpy_env2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967562"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967562"><span class="hs-identifier hs-var">b1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
-&gt; Map Var [(Var, Var)]
-&gt; [Var]
-&gt; Exp1
-&gt; PassM (Map Var [(Var, Var)], Exp1)
</span><a href="#local-6989586621680967430"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
</span><a href="#local-6989586621680967446"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967559"><span class="hs-identifier hs-var">cpy_env1</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967448"><span class="hs-identifier hs-var">order</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967557"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-2036"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680967563"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967563"><span class="hs-identifier hs-var">cpy_env3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967564"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967564"><span class="hs-identifier hs-var">c1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
-&gt; Map Var [(Var, Var)]
-&gt; [Var]
-&gt; Exp1
-&gt; PassM (Map Var [(Var, Var)], Exp1)
</span><a href="#local-6989586621680967430"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
</span><a href="#local-6989586621680967446"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967559"><span class="hs-identifier hs-var">cpy_env1</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967448"><span class="hs-identifier hs-var">order</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967558"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-2037"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967565"><span class="annot"><span class="annottext">list_env2 :: [(Var, [(Var, Var)])]
</span><a href="#local-6989586621680967565"><span class="hs-identifier hs-var hs-var">list_env2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)] -&gt; [(Var, [(Var, Var)])]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#toList"><span class="hs-identifier hs-var">M.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967561"><span class="hs-identifier hs-var">cpy_env2</span></a></span><span>
</span><span id="line-2038"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967567"><span class="annot"><span class="annottext">list_env3 :: [(Var, [(Var, Var)])]
</span><a href="#local-6989586621680967567"><span class="hs-identifier hs-var hs-var">list_env3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)] -&gt; [(Var, [(Var, Var)])]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#toList"><span class="hs-identifier hs-var">M.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967563"><span class="hs-identifier hs-var">cpy_env3</span></a></span><span>
</span><span id="line-2039"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967568"><span class="annot"><span class="annottext">new_env :: [(Var, [(Var, Var)])]
</span><a href="#local-6989586621680967568"><span class="hs-identifier hs-var hs-var">new_env</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, [(Var, Var)])]
</span><a href="#local-6989586621680967565"><span class="hs-identifier hs-var">list_env2</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [(Var, Var)])]
-&gt; [(Var, [(Var, Var)])] -&gt; [(Var, [(Var, Var)])]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [(Var, Var)])]
</span><a href="#local-6989586621680967567"><span class="hs-identifier hs-var">list_env3</span></a></span><span>
</span><span id="line-2040"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967569"><span class="annot"><span class="annottext">map_new_env :: Map Var [(Var, Var)]
</span><a href="#local-6989586621680967569"><span class="hs-identifier hs-var hs-var">map_new_env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, [(Var, Var)])] -&gt; Map Var [(Var, Var)]
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(Var, [(Var, Var)])] -&gt; Map Var [(Var, Var)])
-&gt; [(Var, [(Var, Var)])] -&gt; Map Var [(Var, Var)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [(Var, Var)])] -&gt; [(Var, [(Var, Var)])]
</span><a href="Gibbon.Passes.InferLocations.html#updateCpyEnv"><span class="hs-identifier hs-var">updateCpyEnv</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [(Var, Var)])]
</span><a href="#local-6989586621680967568"><span class="hs-identifier hs-var">new_env</span></a></span><span>
</span><span id="line-2041"></span><span>          </span><span class="annot"><span class="annottext">(Map Var [(Var, Var)], Exp1) -&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">((Map Var [(Var, Var)], Exp1)
 -&gt; PassM (Map Var [(Var, Var)], Exp1))
-&gt; (Map Var [(Var, Var)], Exp1)
-&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967569"><span class="hs-identifier hs-var">map_new_env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; Exp1 -&gt; Exp1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-var">IfE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967560"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967562"><span class="hs-identifier hs-var">b1</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967564"><span class="hs-identifier hs-var">c1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2042"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-type">MkProdE</span></a></span><span> </span><span id="local-6989586621680967571"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967571"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2043"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680967572"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967572"><span class="hs-identifier hs-var">cpy_env1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967573"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967573"><span class="hs-identifier hs-var">ls1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp1
 -&gt; (Map Var [(Var, Var)], [Exp1])
 -&gt; PassM (Map Var [(Var, Var)], [Exp1]))
-&gt; (Map Var [(Var, Var)], [Exp1])
-&gt; [Exp1]
-&gt; PassM (Map Var [(Var, Var)], [Exp1])
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; b -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldrM"><span class="hs-identifier hs-var">F.foldrM</span></a></span><span>
</span><span id="line-2044"></span><span>                               </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680967574"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967574"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967575"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967575"><span class="hs-identifier hs-var">acc1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967576"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967576"><span class="hs-identifier hs-var">acc2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2045"></span><span>                                  </span><span class="hs-special">(</span><span id="local-6989586621680967577"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967577"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967578"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967578"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
-&gt; Map Var [(Var, Var)]
-&gt; [Var]
-&gt; Exp1
-&gt; PassM (Map Var [(Var, Var)], Exp1)
</span><a href="#local-6989586621680967430"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
</span><a href="#local-6989586621680967446"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967575"><span class="hs-identifier hs-var">acc1</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967448"><span class="hs-identifier hs-var">order</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967574"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-2046"></span><span>                                  </span><span class="annot"><span class="annottext">(Map Var [(Var, Var)], [Exp1])
-&gt; PassM (Map Var [(Var, Var)], [Exp1])
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967577"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
-&gt; Map Var [(Var, Var)] -&gt; Map Var [(Var, Var)]
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967575"><span class="hs-identifier hs-var">acc1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967578"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; [Exp1] -&gt; [Exp1]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967576"><span class="hs-identifier hs-var">acc2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2047"></span><span>                               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967447"><span class="hs-identifier hs-var">cpy_env</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2048"></span><span>                               </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967571"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-2049"></span><span>          </span><span class="annot"><span class="annottext">(Map Var [(Var, Var)], Exp1) -&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">((Map Var [(Var, Var)], Exp1)
 -&gt; PassM (Map Var [(Var, Var)], Exp1))
-&gt; (Map Var [(Var, Var)], Exp1)
-&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967572"><span class="hs-identifier hs-var">cpy_env1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
[PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-var">MkProdE</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967573"><span class="hs-identifier hs-var">ls1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2050"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-type">ProjE</span></a></span><span> </span><span id="local-6989586621680967579"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680967579"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680967580"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967580"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2051"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680967581"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967581"><span class="hs-identifier hs-var">cpy_env1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967582"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967582"><span class="hs-identifier hs-var">arg1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
-&gt; Map Var [(Var, Var)]
-&gt; [Var]
-&gt; Exp1
-&gt; PassM (Map Var [(Var, Var)], Exp1)
</span><a href="#local-6989586621680967430"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
</span><a href="#local-6989586621680967446"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967447"><span class="hs-identifier hs-var">cpy_env</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967448"><span class="hs-identifier hs-var">order</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967580"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-2052"></span><span>          </span><span class="annot"><span class="annottext">(Map Var [(Var, Var)], Exp1) -&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967581"><span class="hs-identifier hs-var">cpy_env1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Exp1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Int -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-var">ProjE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680967579"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967582"><span class="hs-identifier hs-var">arg1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2053"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-type">TimeIt</span></a></span><span> </span><span id="local-6989586621680967583"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967583"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621680967584"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967584"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680967585"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680967585"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2054"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680967586"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967586"><span class="hs-identifier hs-var">cpy_env1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967587"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967587"><span class="hs-identifier hs-var">arg1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
-&gt; Map Var [(Var, Var)]
-&gt; [Var]
-&gt; Exp1
-&gt; PassM (Map Var [(Var, Var)], Exp1)
</span><a href="#local-6989586621680967430"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
</span><a href="#local-6989586621680967446"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967447"><span class="hs-identifier hs-var">cpy_env</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967448"><span class="hs-identifier hs-var">order</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967583"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-2055"></span><span>          </span><span class="annot"><span class="annottext">(Map Var [(Var, Var)], Exp1) -&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">((Map Var [(Var, Var)], Exp1)
 -&gt; PassM (Map Var [(Var, Var)], Exp1))
-&gt; (Map Var [(Var, Var)], Exp1)
-&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967586"><span class="hs-identifier hs-var">cpy_env1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; Ty1 -&gt; Bool -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec -&gt; dec -&gt; Bool -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-var">TimeIt</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967587"><span class="hs-identifier hs-var">arg1</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967584"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680967585"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2056"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-type">WithArenaE</span></a></span><span> </span><span id="local-6989586621680967588"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967588"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680967589"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967589"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2057"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680967590"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967590"><span class="hs-identifier hs-var">cpy_env1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967591"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967591"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
-&gt; Map Var [(Var, Var)]
-&gt; [Var]
-&gt; Exp1
-&gt; PassM (Map Var [(Var, Var)], Exp1)
</span><a href="#local-6989586621680967430"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
</span><a href="#local-6989586621680967446"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967447"><span class="hs-identifier hs-var">cpy_env</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967448"><span class="hs-identifier hs-var">order</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967589"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-2058"></span><span>          </span><span class="annot"><span class="annottext">(Map Var [(Var, Var)], Exp1) -&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">((Map Var [(Var, Var)], Exp1)
 -&gt; PassM (Map Var [(Var, Var)], Exp1))
-&gt; (Map Var [(Var, Var)], Exp1)
-&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967590"><span class="hs-identifier hs-var">cpy_env1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-var">WithArenaE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967588"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967591"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2059"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-type">SpawnE</span></a></span><span> </span><span id="local-6989586621680967592"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967592"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680967593"><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680967593"><span class="hs-identifier hs-var">locs</span></a></span></span><span> </span><span id="local-6989586621680967594"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967594"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2060"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680967595"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967595"><span class="hs-identifier hs-var">cpy_env1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967596"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967596"><span class="hs-identifier hs-var">ls1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp1
 -&gt; (Map Var [(Var, Var)], [Exp1])
 -&gt; PassM (Map Var [(Var, Var)], [Exp1]))
-&gt; (Map Var [(Var, Var)], [Exp1])
-&gt; [Exp1]
-&gt; PassM (Map Var [(Var, Var)], [Exp1])
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; b -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldrM"><span class="hs-identifier hs-var">F.foldrM</span></a></span><span>
</span><span id="line-2061"></span><span>                               </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680967597"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967597"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967598"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967598"><span class="hs-identifier hs-var">acc1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967599"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967599"><span class="hs-identifier hs-var">acc2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2062"></span><span>                                  </span><span class="hs-special">(</span><span id="local-6989586621680967600"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967600"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967601"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967601"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
-&gt; Map Var [(Var, Var)]
-&gt; [Var]
-&gt; Exp1
-&gt; PassM (Map Var [(Var, Var)], Exp1)
</span><a href="#local-6989586621680967430"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
</span><a href="#local-6989586621680967446"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967598"><span class="hs-identifier hs-var">acc1</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967448"><span class="hs-identifier hs-var">order</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967597"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-2063"></span><span>                                  </span><span class="annot"><span class="annottext">(Map Var [(Var, Var)], [Exp1])
-&gt; PassM (Map Var [(Var, Var)], [Exp1])
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967600"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
-&gt; Map Var [(Var, Var)] -&gt; Map Var [(Var, Var)]
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967598"><span class="hs-identifier hs-var">acc1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967601"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; [Exp1] -&gt; [Exp1]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967599"><span class="hs-identifier hs-var">acc2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2064"></span><span>                               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967447"><span class="hs-identifier hs-var">cpy_env</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2065"></span><span>                               </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967594"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-2066"></span><span>          </span><span class="annot"><span class="annottext">(Map Var [(Var, Var)], Exp1) -&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">((Map Var [(Var, Var)], Exp1)
 -&gt; PassM (Map Var [(Var, Var)], Exp1))
-&gt; (Map Var [(Var, Var)], Exp1)
-&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967595"><span class="hs-identifier hs-var">cpy_env1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [()] -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-var">SpawnE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967592"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680967593"><span class="hs-identifier hs-var">locs</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967596"><span class="hs-identifier hs-var">ls1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2067"></span><span>        </span><span class="annot"><span class="annottext">Exp1
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Map Var [(Var, Var)], Exp1) -&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967447"><span class="hs-identifier hs-var">cpy_env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec. PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2068"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L1.Syntax.html#BenchE"><span class="hs-identifier hs-type">BenchE</span></a></span><span> </span><span id="local-6989586621680967602"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967602"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621680967603"><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680967603"><span class="hs-identifier hs-var">locs</span></a></span></span><span> </span><span id="local-6989586621680967604"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967604"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621680967605"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680967605"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2069"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621680967606"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967606"><span class="hs-identifier hs-var">cpy_env1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967607"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967607"><span class="hs-identifier hs-var">ls1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp1
 -&gt; (Map Var [(Var, Var)], [Exp1])
 -&gt; PassM (Map Var [(Var, Var)], [Exp1]))
-&gt; (Map Var [(Var, Var)], [Exp1])
-&gt; [Exp1]
-&gt; PassM (Map Var [(Var, Var)], [Exp1])
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; b -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldrM"><span class="hs-identifier hs-var">F.foldrM</span></a></span><span>
</span><span id="line-2070"></span><span>                               </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680967608"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967608"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967609"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967609"><span class="hs-identifier hs-var">acc1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967610"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967610"><span class="hs-identifier hs-var">acc2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2071"></span><span>                                  </span><span class="hs-special">(</span><span id="local-6989586621680967611"><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967611"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967612"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967612"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
-&gt; Map Var [(Var, Var)]
-&gt; [Var]
-&gt; Exp1
-&gt; PassM (Map Var [(Var, Var)], Exp1)
</span><a href="#local-6989586621680967430"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 Ty1
</span><a href="#local-6989586621680967446"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967609"><span class="hs-identifier hs-var">acc1</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967448"><span class="hs-identifier hs-var">order</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967608"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-2072"></span><span>                                  </span><span class="annot"><span class="annottext">(Map Var [(Var, Var)], [Exp1])
-&gt; PassM (Map Var [(Var, Var)], [Exp1])
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967611"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
-&gt; Map Var [(Var, Var)] -&gt; Map Var [(Var, Var)]
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967609"><span class="hs-identifier hs-var">acc1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967612"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; [Exp1] -&gt; [Exp1]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967610"><span class="hs-identifier hs-var">acc2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2073"></span><span>                               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967447"><span class="hs-identifier hs-var">cpy_env</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-2074"></span><span>                               </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967604"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-2075"></span><span>          </span><span class="annot"><span class="annottext">(Map Var [(Var, Var)], Exp1) -&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">((Map Var [(Var, Var)], Exp1)
 -&gt; PassM (Map Var [(Var, Var)], Exp1))
-&gt; (Map Var [(Var, Var)], Exp1)
-&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967606"><span class="hs-identifier hs-var">cpy_env1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">E1Ext () Ty1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [()] -&gt; [Exp1] -&gt; Bool -&gt; E1Ext () Ty1
forall loc dec.
Var -&gt; [loc] -&gt; [PreExp E1Ext loc dec] -&gt; Bool -&gt; E1Ext loc dec
</span><a href="Gibbon.L1.Syntax.html#BenchE"><span class="hs-identifier hs-var">BenchE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967602"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680967603"><span class="hs-identifier hs-var">locs</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967607"><span class="hs-identifier hs-var">ls1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680967605"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2076"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L1.Syntax.html#AddFixed"><span class="hs-identifier hs-type">L1.AddFixed</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Map Var [(Var, Var)], Exp1) -&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967447"><span class="hs-identifier hs-var">cpy_env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967449"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2077"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L1.Syntax.html#StartOfPkdCursor"><span class="hs-identifier hs-type">L1.StartOfPkdCursor</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Map Var [(Var, Var)], Exp1) -&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map Var [(Var, Var)]
</span><a href="#local-6989586621680967447"><span class="hs-identifier hs-var">cpy_env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967449"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2078"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MapE"><span class="hs-identifier hs-type">MapE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;copyOutOfOrderPacked: todo MapE&quot;</span></span><span>
</span><span id="line-2079"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FoldE"><span class="hs-identifier hs-type">FoldE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; PassM (Map Var [(Var, Var)], Exp1)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;copyOutOfOrderPacked: todo FoldE&quot;</span></span><span>
</span><span id="line-2080"></span><span>
</span><span id="line-2081"></span><span class="hs-comment">-- Updating environment correctly for some branches. </span><span>
</span><span id="line-2082"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#updateCpyEnv"><span class="hs-identifier hs-type">updateCpyEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2083"></span><span id="updateCpyEnv"><span class="annot"><span class="annottext">updateCpyEnv :: [(Var, [(Var, Var)])] -&gt; [(Var, [(Var, Var)])]
</span><a href="Gibbon.Passes.InferLocations.html#updateCpyEnv"><span class="hs-identifier hs-var hs-var">updateCpyEnv</span></a></span></span><span> </span><span id="local-6989586621680967619"><span class="annot"><span class="annottext">[(Var, [(Var, Var)])]
</span><a href="#local-6989586621680967619"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(Var, [(Var, Var)])]
</span><a href="#local-6989586621680967619"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span>
</span><span id="line-2084"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span>
</span><span id="line-2085"></span><span>      </span><span id="local-6989586621680967620"><span class="annot"><span class="annottext">(Var, [(Var, Var)])
</span><a href="#local-6989586621680967620"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680967621"><span class="annot"><span class="annottext">[(Var, [(Var, Var)])]
</span><a href="#local-6989586621680967621"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967622"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967622"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967623"><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680967623"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Var, [(Var, Var)])
</span><a href="#local-6989586621680967620"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span>
</span><span id="line-2086"></span><span>                  </span><span id="local-6989586621680967624"><span class="annot"><span class="annottext">commonKeys :: [(Var, [(Var, Var)])]
</span><a href="#local-6989586621680967624"><span class="hs-identifier hs-var hs-var">commonKeys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[(Var, [(Var, Var)])]] -&gt; [(Var, [(Var, Var)])]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">P.concat</span></a></span><span> </span><span class="annot"><span class="annottext">([[(Var, [(Var, Var)])]] -&gt; [(Var, [(Var, Var)])])
-&gt; [[(Var, [(Var, Var)])]] -&gt; [(Var, [(Var, Var)])]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((Var, [(Var, Var)]) -&gt; [(Var, [(Var, Var)])])
-&gt; [(Var, [(Var, Var)])] -&gt; [[(Var, [(Var, Var)])]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">P.map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680967625"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967625"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967626"><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680967626"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; String
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967625"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; String
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967622"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967625"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680967626"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-2087"></span><span>                                                            </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Var, [(Var, Var)])]
</span><a href="#local-6989586621680967621"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-2088"></span><span>                  </span><span id="local-6989586621680967627"><span class="annot"><span class="annottext">commonVals :: [(Var, Var)]
</span><a href="#local-6989586621680967627"><span class="hs-identifier hs-var hs-var">commonVals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[(Var, Var)]] -&gt; [(Var, Var)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">P.concat</span></a></span><span> </span><span class="annot"><span class="annottext">([[(Var, Var)]] -&gt; [(Var, Var)]) -&gt; [[(Var, Var)]] -&gt; [(Var, Var)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((Var, [(Var, Var)]) -&gt; [(Var, Var)])
-&gt; [(Var, [(Var, Var)])] -&gt; [[(Var, Var)]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">P.map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680967628"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967628"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967629"><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680967629"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680967629"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Var, [(Var, Var)])]
</span><a href="#local-6989586621680967624"><span class="hs-identifier hs-var">commonKeys</span></a></span><span>
</span><span id="line-2089"></span><span>                  </span><span id="local-6989586621680967630"><span class="annot"><span class="annottext">commonValNew :: [(Var, Var)]
</span><a href="#local-6989586621680967630"><span class="hs-identifier hs-var hs-var">commonValNew</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680967627"><span class="hs-identifier hs-var">commonVals</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Var)] -&gt; [(Var, Var)] -&gt; [(Var, Var)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680967623"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-2090"></span><span>                  </span><span id="local-6989586621680967631"><span class="annot"><span class="annottext">removedKeys :: [(Var, [(Var, Var)])]
</span><a href="#local-6989586621680967631"><span class="hs-identifier hs-var hs-var">removedKeys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[(Var, [(Var, Var)])]] -&gt; [(Var, [(Var, Var)])]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">P.concat</span></a></span><span> </span><span class="annot"><span class="annottext">([[(Var, [(Var, Var)])]] -&gt; [(Var, [(Var, Var)])])
-&gt; [[(Var, [(Var, Var)])]] -&gt; [(Var, [(Var, Var)])]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((Var, [(Var, Var)]) -&gt; [(Var, [(Var, Var)])])
-&gt; [(Var, [(Var, Var)])] -&gt; [[(Var, [(Var, Var)])]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">P.map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680967632"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967632"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967633"><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680967633"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; String
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967632"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; String
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967622"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2091"></span><span>                                                             </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967632"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680967633"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Var, [(Var, Var)])]
</span><a href="#local-6989586621680967621"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-2092"></span><span>                </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967622"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Var, Var)]
</span><a href="#local-6989586621680967630"><span class="hs-identifier hs-var">commonValNew</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(Var, [(Var, Var)])]
-&gt; [(Var, [(Var, Var)])] -&gt; [(Var, [(Var, Var)])]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Var, [(Var, Var)])] -&gt; [(Var, [(Var, Var)])]
</span><a href="Gibbon.Passes.InferLocations.html#updateCpyEnv"><span class="hs-identifier hs-var">updateCpyEnv</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, [(Var, Var)])]
</span><a href="#local-6989586621680967631"><span class="hs-identifier hs-var">removedKeys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2093"></span><span>          </span><span>
</span><span id="line-2094"></span><span>
</span><span id="line-2095"></span><span class="hs-comment">-- Alias analysis for copyPacked Calls </span><span>
</span><span id="line-2096"></span><span class="hs-comment">-- Data type for storing variables Expressions and aliases. </span><span>
</span><span id="line-2097"></span><span>
</span><span id="line-2098"></span><span class="hs-keyword">type</span><span> </span><span id="AliasEnv"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#AliasEnv"><span class="hs-identifier hs-var">AliasEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">M.Map</span></a></span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Exp1"><span class="hs-identifier hs-type">Exp1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2099"></span><span>
</span><span id="line-2100"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#removeAliasesForCopyCalls"><span class="hs-identifier hs-type">removeAliasesForCopyCalls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Prog1"><span class="hs-identifier hs-type">Prog1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Prog1"><span class="hs-identifier hs-type">Prog1</span></a></span><span>
</span><span id="line-2101"></span><span id="removeAliasesForCopyCalls"><span class="annot"><span class="annottext">removeAliasesForCopyCalls :: Prog1 -&gt; PassM Prog1
</span><a href="Gibbon.Passes.InferLocations.html#removeAliasesForCopyCalls"><span class="hs-identifier hs-var hs-var">removeAliasesForCopyCalls</span></a></span></span><span> </span><span id="local-6989586621680967730"><span class="annot"><span class="annottext">prg :: Prog1
</span><a href="#local-6989586621680967730"><span class="hs-identifier hs-var">prg</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span id="local-6989586621680967731"><span class="annot"><span class="annottext">DDefs (TyOf Exp1)
</span><a href="#local-6989586621680967731"><span class="hs-identifier hs-var">ddfs</span></a></span></span><span> </span><span id="local-6989586621680967732"><span class="annot"><span class="annottext">FunDefs Exp1
</span><a href="#local-6989586621680967732"><span class="hs-identifier hs-var">fndefs</span></a></span></span><span> </span><span id="local-6989586621680967733"><span class="annot"><span class="annottext">Maybe (Exp1, TyOf Exp1)
</span><a href="#local-6989586621680967733"><span class="hs-identifier hs-var">mnExp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2102"></span><span>    </span><span id="local-6989586621680967734"><span class="annot"><span class="annottext">Maybe (Exp1, Ty1)
</span><a href="#local-6989586621680967734"><span class="hs-identifier hs-var">mnExp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp1, TyOf Exp1)
</span><a href="#local-6989586621680967733"><span class="hs-identifier hs-var">mnExp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2103"></span><span>                   </span><span class="annot"><span class="annottext">Maybe (Exp1, TyOf Exp1)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp1, Ty1) -&gt; PassM (Maybe (Exp1, Ty1))
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Exp1, Ty1)
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2104"></span><span>                   </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967735"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967735"><span class="hs-identifier hs-var">ex</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967736"><span class="annot"><span class="annottext">TyOf Exp1
</span><a href="#local-6989586621680967736"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span>
</span><span id="line-2105"></span><span>                                      </span><span id="local-6989586621680967737"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967737"><span class="hs-identifier hs-var">ex'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; AliasEnv -&gt; PassM Exp1
</span><a href="#local-6989586621680967738"><span class="hs-identifier hs-var">removeAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967735"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AliasEnv
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2106"></span><span>                                      </span><span class="annot"><span class="annottext">Maybe (Exp1, Ty1) -&gt; PassM (Maybe (Exp1, Ty1))
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Exp1, Ty1) -&gt; PassM (Maybe (Exp1, Ty1)))
-&gt; Maybe (Exp1, Ty1) -&gt; PassM (Maybe (Exp1, Ty1))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp1, Ty1) -&gt; Maybe (Exp1, Ty1)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967737"><span class="hs-identifier hs-var">ex'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyOf Exp1
Ty1
</span><a href="#local-6989586621680967736"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2107"></span><span>    </span><span id="local-6989586621680967739"><span class="annot"><span class="annottext">FunDefs Exp1
</span><a href="#local-6989586621680967739"><span class="hs-identifier hs-var">fndefs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FunDef Exp1 -&gt; PassM (FunDef Exp1))
-&gt; FunDefs Exp1 -&gt; PassM (FunDefs Exp1)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; Map Var a -&gt; m (Map Var b)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef Exp1 -&gt; PassM (FunDef Exp1)
</span><a href="#local-6989586621680967740"><span class="hs-identifier hs-var">fd</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp1
</span><a href="#local-6989586621680967732"><span class="hs-identifier hs-var">fndefs</span></a></span><span>
</span><span id="line-2108"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967741"><span class="annot"><span class="annottext">prg' :: Prog1
</span><a href="#local-6989586621680967741"><span class="hs-identifier hs-var hs-var">prg'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp1)
-&gt; FunDefs Exp1 -&gt; Maybe (Exp1, TyOf Exp1) -&gt; Prog1
forall ex.
DDefs (TyOf ex) -&gt; FunDefs ex -&gt; Maybe (ex, TyOf ex) -&gt; Prog ex
</span><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-var">Prog</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp1)
</span><a href="#local-6989586621680967731"><span class="hs-identifier hs-var">ddfs</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp1
</span><a href="#local-6989586621680967739"><span class="hs-identifier hs-var">fndefs'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Exp1, TyOf Exp1)
Maybe (Exp1, Ty1)
</span><a href="#local-6989586621680967734"><span class="hs-identifier hs-var">mnExp'</span></a></span><span>
</span><span id="line-2109"></span><span>    </span><span id="local-6989586621680967742"><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680967742"><span class="hs-identifier hs-var">p0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Prog1 -&gt; PassM Prog1
</span><a href="Gibbon.Passes.Flatten.html#flattenL1"><span class="hs-identifier hs-var">flattenL1</span></a></span><span> </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680967741"><span class="hs-identifier hs-var">prg'</span></a></span><span>
</span><span id="line-2110"></span><span>    </span><span class="annot"><span class="annottext">Prog1 -&gt; PassM Prog1
forall (e :: * -&gt; * -&gt; *) l d.
HasSimplifiable e l d =&gt;
Prog (PreExp e l d) -&gt; PassM (Prog (PreExp e l d))
</span><a href="Gibbon.Passes.InlineTriv.html#inlineTriv"><span class="hs-identifier hs-var">inlineTriv</span></a></span><span> </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680967742"><span class="hs-identifier hs-var">p0</span></a></span><span>
</span><span id="line-2111"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-2112"></span><span>
</span><span id="line-2113"></span><span>      </span><span class="annot"><a href="#local-6989586621680967740"><span class="hs-identifier hs-type">fd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#FunDef1"><span class="hs-identifier hs-type">FunDef1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#FunDef1"><span class="hs-identifier hs-type">FunDef1</span></a></span><span>
</span><span id="line-2114"></span><span>      </span><span id="local-6989586621680967740"><span class="annot"><span class="annottext">fd :: FunDef Exp1 -&gt; PassM (FunDef Exp1)
</span><a href="#local-6989586621680967740"><span class="hs-identifier hs-var hs-var">fd</span></a></span></span><span> </span><span id="local-6989586621680967743"><span class="annot"><span class="annottext">fn :: FunDef Exp1
</span><a href="#local-6989586621680967743"><span class="hs-identifier hs-var">fn</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span class="hs-special">{</span><span id="local-6989586621680967744"><span class="annot"><span class="annottext">[Var]
funArgs :: forall ex. FunDef ex -&gt; [Var]
funArgs :: [Var]
</span><a href="Gibbon.Language.Syntax.html#funArgs"><span class="hs-identifier hs-var hs-var">funArgs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967745"><span class="annot"><span class="annottext">Exp1
funBody :: forall ex. FunDef ex -&gt; ex
funBody :: Exp1
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var hs-var">funBody</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967746"><span class="annot"><span class="annottext">ArrowTy (TyOf Exp1)
funTy :: forall ex. FunDef ex -&gt; ArrowTy (TyOf ex)
funTy :: ArrowTy (TyOf Exp1)
</span><a href="Gibbon.Language.Syntax.html#funTy"><span class="hs-identifier hs-var hs-var">funTy</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2115"></span><span>          </span><span id="local-6989586621680967747"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967747"><span class="hs-identifier hs-var">funBody'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; AliasEnv -&gt; PassM Exp1
</span><a href="#local-6989586621680967738"><span class="hs-identifier hs-var">removeAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967745"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AliasEnv
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span class="hs-special">)</span><span>  </span><span>
</span><span id="line-2116"></span><span>          </span><span class="annot"><span class="annottext">FunDef Exp1 -&gt; PassM (FunDef Exp1)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(FunDef Exp1 -&gt; PassM (FunDef Exp1))
-&gt; FunDef Exp1 -&gt; PassM (FunDef Exp1)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef Exp1
</span><a href="#local-6989586621680967743"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funBody :: Exp1
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967747"><span class="hs-identifier hs-var">funBody'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-2117"></span><span>
</span><span id="line-2118"></span><span>      </span><span class="annot"><a href="#local-6989586621680967748"><span class="hs-identifier hs-type">_unifyEnvs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#AliasEnv"><span class="hs-identifier hs-type">AliasEnv</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#AliasEnv"><span class="hs-identifier hs-type">AliasEnv</span></a></span><span>
</span><span id="line-2119"></span><span>      </span><span id="local-6989586621680967748"><span class="annot"><span class="annottext">_unifyEnvs :: [AliasEnv] -&gt; AliasEnv
</span><a href="#local-6989586621680967748"><span class="hs-identifier hs-var hs-var">_unifyEnvs</span></a></span></span><span> </span><span id="local-6989586621680967749"><span class="annot"><span class="annottext">[AliasEnv]
</span><a href="#local-6989586621680967749"><span class="hs-identifier hs-var">envList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Var, Set Var) -&gt; (Var, Set Var) -&gt; (Var, Set Var))
-&gt; [AliasEnv] -&gt; AliasEnv
forall (f :: * -&gt; *) k a.
(Foldable f, Ord k) =&gt;
(a -&gt; a -&gt; a) -&gt; f (Map k a) -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#unionsWith"><span class="hs-identifier hs-var">M.unionsWith</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Set Var) -&gt; (Var, Set Var) -&gt; (Var, Set Var)
</span><a href="#local-6989586621680967751"><span class="hs-identifier hs-var">_unifyVals</span></a></span><span> </span><span class="annot"><span class="annottext">[AliasEnv]
</span><a href="#local-6989586621680967749"><span class="hs-identifier hs-var">envList</span></a></span><span>
</span><span id="line-2120"></span><span>
</span><span id="line-2121"></span><span>      </span><span class="annot"><a href="#local-6989586621680967751"><span class="hs-identifier hs-type">_unifyVals</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2122"></span><span>      </span><span id="local-6989586621680967751"><span class="annot"><span class="annottext">_unifyVals :: (Var, Set Var) -&gt; (Var, Set Var) -&gt; (Var, Set Var)
</span><a href="#local-6989586621680967751"><span class="hs-identifier hs-var hs-var">_unifyVals</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967752"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967752"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967753"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680967753"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967754"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967754"><span class="hs-identifier hs-var">v'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967755"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680967755"><span class="hs-identifier hs-var">vs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967752"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967754"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967752"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680967753"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var -&gt; Set Var -&gt; Set Var
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-operator hs-var">`S.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680967755"><span class="hs-identifier hs-var">vs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2123"></span><span>                                     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Var, Set Var)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unifyVals: Variable should be same if key is same!&quot;</span></span><span>
</span><span id="line-2124"></span><span>
</span><span id="line-2125"></span><span>      </span><span id="local-6989586621680963135"><span class="annot"><a href="#local-6989586621680967756"><span class="hs-identifier hs-type">_myLookup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Exp1"><span class="hs-identifier hs-type">Exp1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L1.Syntax.html#Exp1"><span class="hs-identifier hs-type">Exp1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680963135"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680963135"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-2126"></span><span>      </span><span id="local-6989586621680967756"><span class="annot"><span class="annottext">_myLookup :: forall b. Exp1 -&gt; [((Exp1, Var), b)] -&gt; Maybe b
</span><a href="#local-6989586621680967756"><span class="hs-identifier hs-var hs-var">_myLookup</span></a></span></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe b
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-2127"></span><span>      </span><span class="annot"><a href="#local-6989586621680967756"><span class="hs-identifier hs-var">_myLookup</span></a></span><span> </span><span id="local-6989586621680967758"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967758"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621680967759"><span class="annot"><span class="annottext">(Exp1, Var)
</span><a href="#local-6989586621680967759"><span class="hs-identifier hs-var">thiskey</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967760"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680967760"><span class="hs-identifier hs-var">thisval</span></a></span></span><span class="hs-special">)</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680967761"><span class="annot"><span class="annottext">[((Exp1, Var), b)]
</span><a href="#local-6989586621680967761"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-2128"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967762"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967762"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967763"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967763"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp1, Var)
</span><a href="#local-6989586621680967759"><span class="hs-identifier hs-var">thiskey</span></a></span><span>
</span><span id="line-2129"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967762"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; Exp1 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967758"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-2130"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">b -&gt; Maybe b
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680967760"><span class="hs-identifier hs-var">thisval</span></a></span><span>
</span><span id="line-2131"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; [((Exp1, Var), b)] -&gt; Maybe b
forall b. Exp1 -&gt; [((Exp1, Var), b)] -&gt; Maybe b
</span><a href="#local-6989586621680967756"><span class="hs-identifier hs-var">_myLookup</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967758"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">[((Exp1, Var), b)]
</span><a href="#local-6989586621680967761"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-2132"></span><span>                                      </span><span>
</span><span id="line-2133"></span><span>      </span><span class="annot"><a href="#local-6989586621680967738"><span class="hs-identifier hs-type">removeAliases</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Exp1"><span class="hs-identifier hs-type">Exp1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#AliasEnv"><span class="hs-identifier hs-type">AliasEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Exp1"><span class="hs-identifier hs-type">Exp1</span></a></span><span>
</span><span id="line-2134"></span><span>      </span><span id="local-6989586621680967738"><span class="annot"><span class="annottext">removeAliases :: Exp1 -&gt; AliasEnv -&gt; PassM Exp1
</span><a href="#local-6989586621680967738"><span class="hs-identifier hs-var hs-var">removeAliases</span></a></span></span><span> </span><span id="local-6989586621680967764"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967764"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span id="local-6989586621680967765"><span class="annot"><span class="annottext">AliasEnv
</span><a href="#local-6989586621680967765"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967764"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span>
</span><span id="line-2135"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-type">DataConE</span></a></span><span> </span><span id="local-6989586621680967766"><span class="annot"><span class="annottext">()
</span><a href="#local-6989586621680967766"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621680967767"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680967767"><span class="hs-identifier hs-var">dcon</span></a></span></span><span> </span><span id="local-6989586621680967768"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967768"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2136"></span><span>                                  </span><span id="local-6989586621680967769"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967769"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; PassM Exp1) -&gt; [Exp1] -&gt; PassM [Exp1]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680967770"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967770"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; AliasEnv -&gt; PassM Exp1
</span><a href="#local-6989586621680967738"><span class="hs-identifier hs-var">removeAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967770"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">AliasEnv
</span><a href="#local-6989586621680967765"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967768"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-2137"></span><span>                                  </span><span class="annot"><span class="annottext">Exp1 -&gt; PassM Exp1
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; PassM Exp1) -&gt; Exp1 -&gt; PassM Exp1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; String -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
loc -&gt; String -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-var">DataConE</span></a></span><span> </span><span class="annot"><span class="annottext">()
</span><a href="#local-6989586621680967766"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680967767"><span class="hs-identifier hs-var">dcon</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967769"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-2138"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span id="local-6989586621680967771"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967771"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2139"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967772"><span class="annot"><span class="annottext">vals :: [(Var, Set Var)]
</span><a href="#local-6989586621680967772"><span class="hs-identifier hs-var hs-var">vals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AliasEnv -&gt; [(Var, Set Var)]
forall k a. Map k a -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#elems"><span class="hs-identifier hs-var">M.elems</span></a></span><span> </span><span class="annot"><span class="annottext">AliasEnv
</span><a href="#local-6989586621680967765"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-2140"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967774"><span class="annot"><span class="annottext">newVar :: [Var]
</span><a href="#local-6989586621680967774"><span class="hs-identifier hs-var hs-var">newVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Var, Set Var) -&gt; Var) -&gt; [(Var, Set Var)] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">P.map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680967775"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967775"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967776"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680967776"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Set Var -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#member"><span class="hs-identifier hs-var">S.member</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967771"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680967776"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967775"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-2141"></span><span>                                                 </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967771"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Var, Set Var)]
</span><a href="#local-6989586621680967772"><span class="hs-identifier hs-var">vals</span></a></span><span>
</span><span id="line-2142"></span><span>                  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; [Var]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="Gibbon.Passes.InferLocations.html#removeDuplicates"><span class="hs-identifier hs-var">removeDuplicates</span></a></span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967774"><span class="hs-identifier hs-var">newVar</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span>
</span><span id="line-2143"></span><span>                    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; PassM Exp1
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; PassM Exp1) -&gt; Exp1 -&gt; PassM Exp1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967771"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-2144"></span><span>                    </span><span class="hs-special">[</span><span id="local-6989586621680967777"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967777"><span class="hs-identifier hs-var">v'</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; PassM Exp1
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; PassM Exp1) -&gt; Exp1 -&gt; PassM Exp1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">VarE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967777"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-2145"></span><span>                    </span><span class="annot"><span class="annottext">[Var]
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; PassM Exp1
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;removeAliases: Did not expect more than one variable!&quot;</span></span><span>
</span><span id="line-2146"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-type">LitE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; PassM Exp1
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967764"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-2147"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CharE"><span class="hs-identifier hs-type">CharE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; PassM Exp1
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967764"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-2148"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-type">FloatE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; PassM Exp1
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967764"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-2149"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-type">LitSymE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; PassM Exp1
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967764"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-2150"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span id="local-6989586621680967778"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967778"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680967779"><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680967779"><span class="hs-identifier hs-var">locs</span></a></span></span><span> </span><span id="local-6989586621680967780"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967780"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2151"></span><span>                            </span><span id="local-6989586621680967781"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967781"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; PassM Exp1) -&gt; [Exp1] -&gt; PassM [Exp1]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680967782"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967782"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; AliasEnv -&gt; PassM Exp1
</span><a href="#local-6989586621680967738"><span class="hs-identifier hs-var">removeAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967782"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">AliasEnv
</span><a href="#local-6989586621680967765"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967780"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-2152"></span><span>                            </span><span class="annot"><span class="annottext">Exp1 -&gt; PassM Exp1
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; PassM Exp1) -&gt; Exp1 -&gt; PassM Exp1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [()] -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967778"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680967779"><span class="hs-identifier hs-var">locs</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967781"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-2153"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span id="local-6989586621680967783"><span class="annot"><span class="annottext">Prim Ty1
</span><a href="#local-6989586621680967783"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680967784"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967784"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span>
</span><span id="line-2154"></span><span>                           </span><span id="local-6989586621680967785"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967785"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; PassM Exp1) -&gt; [Exp1] -&gt; PassM [Exp1]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680967786"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967786"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; AliasEnv -&gt; PassM Exp1
</span><a href="#local-6989586621680967738"><span class="hs-identifier hs-var">removeAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967786"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">AliasEnv
</span><a href="#local-6989586621680967765"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967784"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-2155"></span><span>                           </span><span class="annot"><span class="annottext">Exp1 -&gt; PassM Exp1
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; PassM Exp1) -&gt; Exp1 -&gt; PassM Exp1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1 -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1
</span><a href="#local-6989586621680967783"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967785"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-2156"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967787"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967787"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967788"><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680967788"><span class="hs-identifier hs-var">loc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967789"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967789"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967790"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967790"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680967791"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967791"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2157"></span><span>                                      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967792"><span class="annot"><span class="annottext">isCpy :: Bool
</span><a href="#local-6989586621680967792"><span class="hs-identifier hs-var hs-var">isCpy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; Bool
</span><a href="Gibbon.Passes.InferLocations.html#isCpyCallExpr1"><span class="hs-identifier hs-var">isCpyCallExpr1</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967790"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span>
</span><span id="line-2158"></span><span>                                      </span><span id="local-6989586621680967793"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967793"><span class="hs-identifier hs-var">rhs'</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; AliasEnv -&gt; PassM Exp1
</span><a href="#local-6989586621680967738"><span class="hs-identifier hs-var">removeAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967790"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">AliasEnv
</span><a href="#local-6989586621680967765"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-2159"></span><span>                                      </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680967792"><span class="hs-identifier hs-var">isCpy</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2160"></span><span>                                          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967794"><span class="annot"><span class="annottext">val' :: Maybe (Var, Set Var)
</span><a href="#local-6989586621680967794"><span class="hs-identifier hs-var hs-var">val'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; AliasEnv -&gt; Maybe (Var, Set Var)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967790"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">AliasEnv
</span><a href="#local-6989586621680967765"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-2161"></span><span>                                          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Var, Set Var)
</span><a href="#local-6989586621680967794"><span class="hs-identifier hs-var">val'</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span>
</span><span id="line-2162"></span><span>                                            </span><span class="annot"><span class="annottext">Maybe (Var, Set Var)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span>
</span><span id="line-2163"></span><span>                                                       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967795"><span class="annot"><span class="annottext">newEnv :: AliasEnv
</span><a href="#local-6989586621680967795"><span class="hs-identifier hs-var hs-var">newEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp1 -&gt; (Var, Set Var) -&gt; AliasEnv -&gt; AliasEnv
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967790"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967787"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Var
forall a. Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">S.empty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AliasEnv
</span><a href="#local-6989586621680967765"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-2164"></span><span>                                                       </span><span class="annot"><span class="annottext">(Var, [()], Ty1, Exp1) -&gt; Exp1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967787"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680967788"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967789"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967793"><span class="hs-identifier hs-var">rhs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; Exp1) -&gt; PassM Exp1 -&gt; PassM Exp1
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; AliasEnv -&gt; PassM Exp1
</span><a href="#local-6989586621680967738"><span class="hs-identifier hs-var">removeAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967791"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">AliasEnv
</span><a href="#local-6989586621680967795"><span class="hs-identifier hs-var">newEnv</span></a></span><span>
</span><span id="line-2165"></span><span>                                            </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967796"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967796"><span class="hs-identifier hs-var">v'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967797"><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680967797"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2166"></span><span>                                             </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967798"><span class="annot"><span class="annottext">e'' :: Set Var
</span><a href="#local-6989586621680967798"><span class="hs-identifier hs-var hs-var">e''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Set Var -&gt; Set Var
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#insert"><span class="hs-identifier hs-var">S.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967787"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680967797"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span>
</span><span id="line-2167"></span><span>                                             </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680967799"><span class="annot"><span class="annottext">newEnv :: AliasEnv
</span><a href="#local-6989586621680967799"><span class="hs-identifier hs-var hs-var">newEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp1 -&gt; (Var, Set Var) -&gt; AliasEnv -&gt; AliasEnv
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967790"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967796"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set Var
</span><a href="#local-6989586621680967798"><span class="hs-identifier hs-var">e''</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AliasEnv
</span><a href="#local-6989586621680967765"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2168"></span><span>                                             </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967796"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Var -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967787"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(Var, [()], Ty1, Exp1) -&gt; Exp1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967787"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680967788"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967789"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967793"><span class="hs-identifier hs-var">rhs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; Exp1) -&gt; PassM Exp1 -&gt; PassM Exp1
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; AliasEnv -&gt; PassM Exp1
</span><a href="#local-6989586621680967738"><span class="hs-identifier hs-var">removeAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967791"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">AliasEnv
</span><a href="#local-6989586621680967799"><span class="hs-identifier hs-var">newEnv</span></a></span><span>
</span><span id="line-2169"></span><span>                                             </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; AliasEnv -&gt; PassM Exp1
</span><a href="#local-6989586621680967738"><span class="hs-identifier hs-var">removeAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967791"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">AliasEnv
</span><a href="#local-6989586621680967799"><span class="hs-identifier hs-var">newEnv</span></a></span><span>
</span><span id="line-2170"></span><span>                                      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(Var, [()], Ty1, Exp1) -&gt; Exp1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967787"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680967788"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967789"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967793"><span class="hs-identifier hs-var">rhs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; Exp1) -&gt; PassM Exp1 -&gt; PassM Exp1
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; AliasEnv -&gt; PassM Exp1
</span><a href="#local-6989586621680967738"><span class="hs-identifier hs-var">removeAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967791"><span class="hs-identifier hs-var">bod</span></a></span><span> </span><span class="annot"><span class="annottext">AliasEnv
</span><a href="#local-6989586621680967765"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-2171"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-type">CaseE</span></a></span><span> </span><span id="local-6989586621680967800"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967800"><span class="hs-identifier hs-var">scrt</span></a></span></span><span> </span><span id="local-6989586621680967801"><span class="annot"><span class="annottext">[(String, [(Var, ())], Exp1)]
</span><a href="#local-6989586621680967801"><span class="hs-identifier hs-var">mp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span>
</span><span id="line-2172"></span><span>          </span><span id="local-6989586621680967802"><span class="annot"><span class="annottext">[(String, [(Var, ())], Exp1)]
</span><a href="#local-6989586621680967802"><span class="hs-identifier hs-var">mp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((String, [(Var, ())], Exp1) -&gt; PassM (String, [(Var, ())], Exp1))
-&gt; [(String, [(Var, ())], Exp1)]
-&gt; PassM [(String, [(Var, ())], Exp1)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680967803"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680967803"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967804"><span class="annot"><span class="annottext">[(Var, ())]
</span><a href="#local-6989586621680967804"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967805"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967805"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span>
</span><span id="line-2173"></span><span>                                    </span><span id="local-6989586621680967806"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967806"><span class="hs-identifier hs-var">c'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; AliasEnv -&gt; PassM Exp1
</span><a href="#local-6989586621680967738"><span class="hs-identifier hs-var">removeAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967805"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">AliasEnv
</span><a href="#local-6989586621680967765"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-2174"></span><span>                                    </span><span class="annot"><span class="annottext">(String, [(Var, ())], Exp1) -&gt; PassM (String, [(Var, ())], Exp1)
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680967803"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(Var, ())]
</span><a href="#local-6989586621680967804"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967806"><span class="hs-identifier hs-var">c'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2175"></span><span>                                   </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(String, [(Var, ())], Exp1)]
</span><a href="#local-6989586621680967801"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-2176"></span><span>          </span><span class="annot"><span class="annottext">Exp1 -&gt; PassM Exp1
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; PassM Exp1) -&gt; Exp1 -&gt; PassM Exp1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; [(String, [(Var, ())], Exp1)] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; [(String, [(Var, loc)], PreExp ext loc dec)]
-&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-var">CaseE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967800"><span class="hs-identifier hs-var">scrt</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, [(Var, ())], Exp1)]
</span><a href="#local-6989586621680967802"><span class="hs-identifier hs-var">mp'</span></a></span><span>                 </span><span>
</span><span id="line-2177"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-type">IfE</span></a></span><span> </span><span id="local-6989586621680967807"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967807"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680967808"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967808"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680967809"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967809"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2178"></span><span>          </span><span id="local-6989586621680967810"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967810"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; AliasEnv -&gt; PassM Exp1
</span><a href="#local-6989586621680967738"><span class="hs-identifier hs-var">removeAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967807"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">AliasEnv
</span><a href="#local-6989586621680967765"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-2179"></span><span>          </span><span id="local-6989586621680967811"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967811"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; AliasEnv -&gt; PassM Exp1
</span><a href="#local-6989586621680967738"><span class="hs-identifier hs-var">removeAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967808"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">AliasEnv
</span><a href="#local-6989586621680967765"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-2180"></span><span>          </span><span id="local-6989586621680967812"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967812"><span class="hs-identifier hs-var">c'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; AliasEnv -&gt; PassM Exp1
</span><a href="#local-6989586621680967738"><span class="hs-identifier hs-var">removeAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967809"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">AliasEnv
</span><a href="#local-6989586621680967765"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-2181"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967811"><span class="hs-identifier hs-var">b'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; Exp1 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967812"><span class="hs-identifier hs-var">c'</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; PassM Exp1
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967811"><span class="hs-identifier hs-var">b'</span></a></span><span>
</span><span id="line-2182"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; PassM Exp1
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; PassM Exp1) -&gt; Exp1 -&gt; PassM Exp1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; Exp1 -&gt; Exp1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-var">IfE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967810"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967811"><span class="hs-identifier hs-var">b'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967812"><span class="hs-identifier hs-var">c'</span></a></span><span> </span><span>
</span><span id="line-2183"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-type">MkProdE</span></a></span><span> </span><span id="local-6989586621680967813"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967813"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span>
</span><span id="line-2184"></span><span>                      </span><span id="local-6989586621680967814"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967814"><span class="hs-identifier hs-var">xs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; PassM Exp1) -&gt; [Exp1] -&gt; PassM [Exp1]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680967815"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967815"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; AliasEnv -&gt; PassM Exp1
</span><a href="#local-6989586621680967738"><span class="hs-identifier hs-var">removeAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967815"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">AliasEnv
</span><a href="#local-6989586621680967765"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967813"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-2185"></span><span>                      </span><span class="annot"><span class="annottext">Exp1 -&gt; PassM Exp1
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; PassM Exp1) -&gt; Exp1 -&gt; PassM Exp1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
[PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-var">MkProdE</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967814"><span class="hs-identifier hs-var">xs'</span></a></span><span>
</span><span id="line-2186"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-type">ProjE</span></a></span><span> </span><span id="local-6989586621680967816"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680967816"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621680967817"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967817"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span>
</span><span id="line-2187"></span><span>                     </span><span id="local-6989586621680967818"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967818"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; AliasEnv -&gt; PassM Exp1
</span><a href="#local-6989586621680967738"><span class="hs-identifier hs-var">removeAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967817"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">AliasEnv
</span><a href="#local-6989586621680967765"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-2188"></span><span>                     </span><span class="annot"><span class="annottext">Exp1 -&gt; PassM Exp1
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; PassM Exp1) -&gt; Exp1 -&gt; PassM Exp1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Exp1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Int -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-var">ProjE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680967816"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967818"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-2189"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-type">TimeIt</span></a></span><span> </span><span id="local-6989586621680967819"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967819"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680967820"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967820"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680967821"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680967821"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span>
</span><span id="line-2190"></span><span>                         </span><span id="local-6989586621680967822"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967822"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; AliasEnv -&gt; PassM Exp1
</span><a href="#local-6989586621680967738"><span class="hs-identifier hs-var">removeAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967819"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">AliasEnv
</span><a href="#local-6989586621680967765"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-2191"></span><span>                         </span><span class="annot"><span class="annottext">Exp1 -&gt; PassM Exp1
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; PassM Exp1) -&gt; Exp1 -&gt; PassM Exp1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; Ty1 -&gt; Bool -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec -&gt; dec -&gt; Bool -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-var">TimeIt</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967822"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967820"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680967821"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-2192"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-type">WithArenaE</span></a></span><span> </span><span id="local-6989586621680967823"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967823"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680967824"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967824"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span>
</span><span id="line-2193"></span><span>                          </span><span id="local-6989586621680967825"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967825"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; AliasEnv -&gt; PassM Exp1
</span><a href="#local-6989586621680967738"><span class="hs-identifier hs-var">removeAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967824"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">AliasEnv
</span><a href="#local-6989586621680967765"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-2194"></span><span>                          </span><span class="annot"><span class="annottext">Exp1 -&gt; PassM Exp1
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; PassM Exp1) -&gt; Exp1 -&gt; PassM Exp1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-var">WithArenaE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967823"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967825"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-2195"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-type">SpawnE</span></a></span><span> </span><span id="local-6989586621680967826"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967826"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680967827"><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680967827"><span class="hs-identifier hs-var">locs</span></a></span></span><span> </span><span id="local-6989586621680967828"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967828"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-2196"></span><span>                              </span><span id="local-6989586621680967829"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967829"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; PassM Exp1) -&gt; [Exp1] -&gt; PassM [Exp1]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680967830"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967830"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; AliasEnv -&gt; PassM Exp1
</span><a href="#local-6989586621680967738"><span class="hs-identifier hs-var">removeAliases</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967830"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="annot"><span class="annottext">AliasEnv
</span><a href="#local-6989586621680967765"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967828"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-2197"></span><span>                              </span><span class="annot"><span class="annottext">Exp1 -&gt; PassM Exp1
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; PassM Exp1) -&gt; Exp1 -&gt; PassM Exp1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [()] -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-var">SpawnE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967826"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680967827"><span class="hs-identifier hs-var">locs</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967829"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-2198"></span><span>        </span><span class="annot"><span class="annottext">Exp1
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; PassM Exp1
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967764"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-2199"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">E1Ext () Ty1
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; PassM Exp1
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967764"><span class="hs-identifier hs-var">exp</span></a></span><span>
</span><span id="line-2200"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MapE"><span class="hs-identifier hs-type">MapE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="annottext">String -&gt; PassM Exp1
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;removeAliasesForCopyCalls: todo MapE&quot;</span></span><span>
</span><span id="line-2201"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FoldE"><span class="hs-identifier hs-type">FoldE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; PassM Exp1
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;removeAliasesForCopyCalls: todo FoldE&quot;</span></span><span>
</span><span id="line-2202"></span><span>
</span><span id="line-2203"></span><span>
</span><span id="line-2204"></span><span>
</span><span id="line-2205"></span><span>  </span><span>
</span><span id="line-2206"></span><span>
</span><span id="line-2207"></span><span class="hs-comment">{--

t0 :: ArrowTy Ty2
t0 = fst$ runPassM 0 $
     convertFunTy (snd (L1.funArg fd), L1.funRetTy fd)
   where fd = L1.fundefs L1.add1Prog M.! &quot;add1&quot;

tester1 :: L L1.Exp1 -&gt; Exp2
tester1 e = case fst $ fst $ runPassM 0 $ St.runStateT (runExceptT (inferExp emptyEnv e NoDest)) M.empty of
              Right a -&gt; (\(a,_,_)-&gt;a) a
              Left a -&gt; err $ show a

t1 :: Exp2
t1 = tester1 (LitE 3)

--  id  :: Tree -&gt; Tree
--  id' :: forall l1 in r1, l2 in r2 . Tree l1 -&gt; Tree l2

t2 :: Exp2
t2 = tester1 $
     LetE (&quot;x&quot;,[],IntTy,LitE 1) $
     LetE (&quot;y&quot;,[],IntTy,LitE 2) $
     LetE (&quot;z&quot;,[],IntTy,PrimAppE L1.AddP [VarE &quot;x&quot;, VarE &quot;y&quot;]) $
     VarE &quot;z&quot;

ddtree :: DDefs Ty2
ddtree = fromListDD [DDef (toVar &quot;Tree&quot;)
                      [ (&quot;Leaf&quot;,[(False,IntTy)])
                      , (&quot;Node&quot;,[ (False,PackedTy &quot;Tree&quot; &quot;l&quot;)
                                , (False,PackedTy &quot;Tree&quot; &quot;l&quot;)])
                      ]]

treeEnv :: FullEnv
treeEnv = FullEnv { dataDefs = ddtree
                  , valEnv   = M.empty
                  , funEnv   = M.empty }


tester2 :: L L1.Exp1 -&gt; Exp2
tester2 e = case fst $ fst $ runPassM 0 $ St.runStateT (runExceptT (inferExp' treeEnv e NoDest)) M.empty of
              Right a -&gt; fst a
              Left a -&gt; err $ show a

t3 :: Exp2
t3 = tester2 $
     LetE (&quot;x&quot;,[],IntTy,LitE 1) $
     LetE (&quot;y&quot;,[],IntTy,LitE 2) $
     LetE (&quot;z&quot;,[],PackedTy &quot;Tree&quot; (), DataConE () &quot;Leaf&quot; [VarE &quot;x&quot;, VarE &quot;y&quot;]) $
     LitE 0

t4 :: Exp2
t4 = tester2 $
     LetE (&quot;x1&quot;,[],IntTy,LitE 1) $
     LetE (&quot;y1&quot;,[],IntTy,LitE 2) $
     LetE (&quot;z1&quot;,[],PackedTy &quot;Tree&quot; (), DataConE () &quot;Leaf&quot; [VarE &quot;x1&quot;, VarE &quot;y1&quot;]) $
     LetE (&quot;x2&quot;,[],IntTy,LitE 3) $
     LetE (&quot;y2&quot;,[],IntTy,LitE 4) $
     LetE (&quot;z2&quot;,[],PackedTy &quot;Tree&quot; (), DataConE () &quot;Leaf&quot; [VarE &quot;x2&quot;, VarE &quot;y2&quot;]) $
     LitE 0

t5 :: Exp2
t5 = tester2 $
     LetE (&quot;x1&quot;,[],IntTy,LitE 1) $
     LetE (&quot;y1&quot;,[],IntTy,LitE 2) $
     LetE (&quot;z1&quot;,[],PackedTy &quot;Tree&quot; (), DataConE () &quot;Leaf&quot; [VarE &quot;x1&quot;, VarE &quot;y1&quot;]) $
     LetE (&quot;x2&quot;,[],IntTy,LitE 3) $
     LetE (&quot;y2&quot;,[],IntTy,LitE 4) $
     LetE (&quot;z2&quot;,[],PackedTy &quot;Tree&quot; (), DataConE () &quot;Leaf&quot; [VarE &quot;x2&quot;, VarE &quot;y2&quot;]) $
     LetE (&quot;z3&quot;,[],PackedTy &quot;Tree&quot; (), DataConE () &quot;Node&quot; [VarE &quot;z1&quot;, VarE &quot;z2&quot;]) $
     LitE 0

t6 :: Exp2
t6 = tester2 $
     LetE (&quot;x1&quot;,[],IntTy,LitE 1) $
     LetE (&quot;y1&quot;,[],IntTy,LitE 2) $
     LetE (&quot;z1&quot;,[],PackedTy &quot;Tree&quot; (), DataConE () &quot;Leaf&quot; [VarE &quot;x1&quot;, VarE &quot;y1&quot;]) $
     LetE (&quot;x2&quot;,[],IntTy,LitE 3) $
     LetE (&quot;y2&quot;,[],IntTy,LitE 4) $
     LetE (&quot;z2&quot;,[],PackedTy &quot;Tree&quot; (), DataConE () &quot;Leaf&quot; [VarE &quot;x2&quot;, VarE &quot;y2&quot;]) $
     LetE (&quot;z3&quot;,[],PackedTy &quot;Tree&quot; (), DataConE () &quot;Node&quot; [VarE &quot;z1&quot;, VarE &quot;z2&quot;]) $
     CaseE (VarE &quot;z3&quot;) [(&quot;Leaf&quot;, [(&quot;x&quot;,())], VarE &quot;x&quot;),
                              (&quot;Node&quot;, [(&quot;x&quot;,()),(&quot;y&quot;,())], LitE 1)]


exadd1Bod :: L L1.Exp1
exadd1Bod = l$
    CaseE (VarE &quot;tr&quot;) $
      [ (&quot;Leaf&quot;, [(&quot;n&quot;,())],
         LetE (&quot;leaf1&quot;,[],L1.Packed &quot;Tree&quot;, PrimAppE L1.AddP [VarE &quot;n&quot;, LitE 1])
           (DataConE () &quot;Leaf&quot;
             [VarE &quot;leaf1&quot;]))
      , (&quot;Node&quot;, [(&quot;x&quot;,()),(&quot;y&quot;,())],
         LetE (&quot;node1&quot;,[],L1.Packed &quot;Tree&quot;, (AppE &quot;add1&quot; [] (VarE &quot;x&quot;)))
          (LetE (&quot;node2&quot;,[],L1.Packed &quot;Tree&quot;, (AppE &quot;add1&quot; [] (VarE &quot;y&quot;)))
           (DataConE () &quot;Node&quot;
                [ VarE &quot;node1&quot;
                , VarE &quot;node2&quot;])))
      ]

treeTy :: Ty1
treeTy = L1.Packed &quot;Tree&quot;

treeDD :: DDefs (UrTy ())
treeDD = (fromListDD [L1.DDef &quot;Tree&quot;
                      [ (&quot;Leaf&quot;,[(False,IntTy)])
                      , (&quot;Node&quot;,[(False,L1.Packed &quot;Tree&quot;)
                                ,(False,L1.Packed &quot;Tree&quot;)])]])

mkAdd1Prog :: L L1.Exp1 -&gt; Maybe (L L1.Exp1) -&gt; L1.Prog
mkAdd1Prog bod mainExp = L1.Prog treeDD
                                 (M.fromList [(&quot;add1&quot;,mkAdd1Fun bod)])
                                 mainExp

mkAdd1Fun :: ex -&gt; L1.FunDef Ty1 ex
mkAdd1Fun bod = L1.FunDef &quot;add1&quot; (&quot;tr&quot;,treeTy) treeTy bod

exadd1 :: L1.Prog
exadd1 = mkAdd1Prog exadd1Bod Nothing

mkIdProg :: Maybe (L L1.Exp1) -&gt; L1.Prog
mkIdProg mainExp = L1.Prog treeDD
                           (M.fromList [(&quot;id&quot;,idFun)])
                           mainExp

idFun :: L1.FunDef Ty1 (L L1.Exp1)
idFun = L1.FunDef &quot;id&quot; (&quot;tr&quot;,treeTy) treeTy (VarE &quot;tr&quot;)

--}</span><span>
</span><span id="line-2335"></span><span>
</span><span id="line-2336"></span><span id="local-6989586621680967831"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#removeDuplicates"><span class="hs-identifier hs-type">removeDuplicates</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680967831"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680967831"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680967831"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-2337"></span><span id="removeDuplicates"><span class="annot"><span class="annottext">removeDuplicates :: forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="Gibbon.Passes.InferLocations.html#removeDuplicates"><span class="hs-identifier hs-var hs-var">removeDuplicates</span></a></span></span><span> </span><span id="local-6989586621680967835"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680967835"><span class="hs-identifier hs-var">list</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680967835"><span class="hs-identifier hs-var">list</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span>
</span><span id="line-2338"></span><span>                                </span><span class="hs-special">[</span><span class="hs-special">]</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2339"></span><span>                                </span><span id="local-6989586621680967836"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680967836"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680967837"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680967837"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680967836"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><a href="Gibbon.Passes.InferLocations.html#removeDuplicates"><span class="hs-identifier hs-var">removeDuplicates</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [a] -&gt; [a]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#filter"><span class="hs-identifier hs-var">P.filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680967836"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680967837"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2340"></span><span>
</span><span id="line-2341"></span><span class="hs-comment">-- https://www.reddit.com/r/haskell/comments/u841av/trying_to_remove_all_the_elements_that_occur_in/                                </span><span>
</span><span id="line-2342"></span><span id="local-6989586621680963141"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#deleteOne"><span class="hs-identifier hs-type">deleteOne</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680963141"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680963141"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680963141"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680963141"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-2343"></span><span id="deleteOne"><span class="annot"><span class="annottext">deleteOne :: forall a. Eq a =&gt; a -&gt; [a] -&gt; [a]
</span><a href="Gibbon.Passes.InferLocations.html#deleteOne"><span class="hs-identifier hs-var hs-var">deleteOne</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Nothing to delete</span><span>
</span><span id="line-2344"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#deleteOne"><span class="hs-identifier hs-var">deleteOne</span></a></span><span> </span><span id="local-6989586621680967842"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680967842"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967843"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680967843"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680967844"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680967844"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680967842"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680967843"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680967844"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="hs-comment">-- Drop exactly one matching item</span><span>
</span><span id="line-2345"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#deleteOne"><span class="hs-identifier hs-var">deleteOne</span></a></span><span> </span><span id="local-6989586621680967845"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680967845"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967846"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680967846"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680967847"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680967847"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680967846"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. Eq a =&gt; a -&gt; [a] -&gt; [a]
</span><a href="Gibbon.Passes.InferLocations.html#deleteOne"><span class="hs-identifier hs-var">deleteOne</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680967845"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680967847"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="hs-comment">-- Drop one, but not this one (doesn't match).</span><span>
</span><span id="line-2346"></span><span>                                </span><span>
</span><span id="line-2347"></span><span id="local-6989586621680963143"><span class="annot"><a href="Gibbon.Passes.InferLocations.html#deleteMany"><span class="hs-identifier hs-type">deleteMany</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680963143"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680963143"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680963143"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680963143"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-2348"></span><span id="deleteMany"><span class="annot"><span class="annottext">deleteMany :: forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Gibbon.Passes.InferLocations.html#deleteMany"><span class="hs-identifier hs-var hs-var">deleteMany</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-comment">-- Nothing to delete</span><span>
</span><span id="line-2349"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#deleteMany"><span class="hs-identifier hs-var">deleteMany</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967853"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680967853"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621680967854"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680967854"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Gibbon.Passes.InferLocations.html#deleteMany"><span class="hs-identifier hs-var">deleteMany</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621680967854"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; ([a] -&gt; [a]) -&gt; [a] -&gt; [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. Eq a =&gt; a -&gt; [a] -&gt; [a]
</span><a href="Gibbon.Passes.InferLocations.html#deleteOne"><span class="hs-identifier hs-var">deleteOne</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680967853"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-comment">-- Delete one, then the rest.</span><span>
</span><span id="line-2350"></span><span>
</span><span id="line-2351"></span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#orderOfVarsOutputDataConE"><span class="hs-identifier hs-type">orderOfVarsOutputDataConE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Exp1"><span class="hs-identifier hs-type">Exp1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2352"></span><span id="orderOfVarsOutputDataConE"><span class="annot"><span class="annottext">orderOfVarsOutputDataConE :: Exp1 -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#orderOfVarsOutputDataConE"><span class="hs-identifier hs-var hs-var">orderOfVarsOutputDataConE</span></a></span></span><span> </span><span id="local-6989586621680967868"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967868"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967868"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2353"></span><span>  </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span id="local-6989586621680967869"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967869"><span class="hs-identifier hs-var">v</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2354"></span><span>  </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-type">LitE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2355"></span><span>  </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CharE"><span class="hs-identifier hs-type">CharE</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2356"></span><span>  </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-type">FloatE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2357"></span><span>  </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-type">LitSymE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2358"></span><span>  </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-type">ProjE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680967870"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967870"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#orderOfVarsOutputDataConE"><span class="hs-identifier hs-var">orderOfVarsOutputDataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967870"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-2359"></span><span>  </span><span class="annot"><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-type">IfE</span></a></span><span> </span><span id="local-6989586621680967871"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967871"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680967872"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967872"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680967873"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967873"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp1 -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#orderOfVarsOutputDataConE"><span class="hs-identifier hs-var">orderOfVarsOutputDataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967871"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [Var]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp1 -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#orderOfVarsOutputDataConE"><span class="hs-identifier hs-var">orderOfVarsOutputDataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967872"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [Var]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp1 -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#orderOfVarsOutputDataConE"><span class="hs-identifier hs-var">orderOfVarsOutputDataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967873"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2360"></span><span>  </span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span> </span><span id="local-6989586621680967874"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967874"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">[()]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680967875"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967875"><span class="hs-identifier hs-var">ls</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Var]] -&gt; [Var]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">L.concat</span></a></span><span> </span><span class="annot"><span class="annottext">([[Var]] -&gt; [Var]) -&gt; [[Var]] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Exp1 -&gt; [Var]) -&gt; [Exp1] -&gt; [[Var]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">L.map</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#orderOfVarsOutputDataConE"><span class="hs-identifier hs-var">orderOfVarsOutputDataConE</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967875"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2361"></span><span>  </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680967876"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967876"><span class="hs-identifier hs-var">ls</span></a></span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[[Var]] -&gt; [Var]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">L.concat</span></a></span><span> </span><span class="annot"><span class="annottext">([[Var]] -&gt; [Var]) -&gt; [[Var]] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Exp1 -&gt; [Var]) -&gt; [Exp1] -&gt; [[Var]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">L.map</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#orderOfVarsOutputDataConE"><span class="hs-identifier hs-var">orderOfVarsOutputDataConE</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967876"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2362"></span><span>  </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967877"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967877"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[()]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Ty1
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680967878"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967878"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680967879"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967879"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp1 -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#orderOfVarsOutputDataConE"><span class="hs-identifier hs-var">orderOfVarsOutputDataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967878"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [Var]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Var]
forall a. Eq a =&gt; a -&gt; [a] -&gt; [a]
</span><a href="Gibbon.Passes.InferLocations.html#deleteOne"><span class="hs-identifier hs-var">deleteOne</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967877"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp1 -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#orderOfVarsOutputDataConE"><span class="hs-identifier hs-var">orderOfVarsOutputDataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967879"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2363"></span><span>  </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-type">CaseE</span></a></span><span> </span><span id="local-6989586621680967880"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967880"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680967881"><span class="annot"><span class="annottext">[(String, [(Var, ())], Exp1)]
</span><a href="#local-6989586621680967881"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp1 -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#orderOfVarsOutputDataConE"><span class="hs-identifier hs-var">orderOfVarsOutputDataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967880"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [Var]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Var]] -&gt; [Var]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">L.concat</span></a></span><span> </span><span class="annot"><span class="annottext">([[Var]] -&gt; [Var]) -&gt; [[Var]] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-2364"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((String, [(Var, ())], Exp1) -&gt; [Var])
-&gt; [(String, [(Var, ())], Exp1)] -&gt; [[Var]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">L.map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967882"><span class="annot"><span class="annottext">[(Var, ())]
</span><a href="#local-6989586621680967882"><span class="hs-identifier hs-var">vlocs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680967883"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967883"><span class="hs-identifier hs-var">ee</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2365"></span><span>                                       </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967884"><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967884"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[()]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, ())] -&gt; ([Var], [()])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, ())]
</span><a href="#local-6989586621680967882"><span class="hs-identifier hs-var">vlocs</span></a></span><span>
</span><span id="line-2366"></span><span>                                       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [Var]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Gibbon.Passes.InferLocations.html#deleteMany"><span class="hs-identifier hs-var">deleteMany</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp1 -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#orderOfVarsOutputDataConE"><span class="hs-identifier hs-var">orderOfVarsOutputDataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967883"><span class="hs-identifier hs-var">ee</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Var]
</span><a href="#local-6989586621680967884"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(String, [(Var, ())], Exp1)]
</span><a href="#local-6989586621680967881"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-2367"></span><span>  </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-type">MkProdE</span></a></span><span> </span><span id="local-6989586621680967885"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967885"><span class="hs-identifier hs-var">ls</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[[Var]] -&gt; [Var]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">L.concat</span></a></span><span> </span><span class="annot"><span class="annottext">([[Var]] -&gt; [Var]) -&gt; [[Var]] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; [Var]) -&gt; [Exp1] -&gt; [[Var]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">L.map</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#orderOfVarsOutputDataConE"><span class="hs-identifier hs-var">orderOfVarsOutputDataConE</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967885"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-2368"></span><span>  </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-type">DataConE</span></a></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680967886"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967886"><span class="hs-identifier hs-var">ls</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; [Var]) -&gt; [Exp1] -&gt; [Var]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">L.concatMap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680967887"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967887"><span class="hs-identifier hs-var">exp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967887"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span>
</span><span id="line-2369"></span><span>                                               </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span id="local-6989586621680967888"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967888"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967888"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2370"></span><span>                                               </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-type">LitSymE</span></a></span><span> </span><span id="local-6989586621680967889"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967889"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967889"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-2371"></span><span>                                               </span><span class="annot"><span class="annottext">Exp1
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>          </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967886"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-2372"></span><span>  </span><span class="annot"><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-type">TimeIt</span></a></span><span> </span><span id="local-6989586621680967890"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967890"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#orderOfVarsOutputDataConE"><span class="hs-identifier hs-var">orderOfVarsOutputDataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967890"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span>
</span><span id="line-2373"></span><span>  </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MapE"><span class="hs-identifier hs-type">MapE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967891"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967891"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967892"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967892"><span class="hs-identifier hs-var">_t</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967893"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967893"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680967894"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967894"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp1 -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#orderOfVarsOutputDataConE"><span class="hs-identifier hs-var">orderOfVarsOutputDataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967893"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [Var]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Var]
forall a. Eq a =&gt; a -&gt; [a] -&gt; [a]
</span><a href="Gibbon.Passes.InferLocations.html#deleteOne"><span class="hs-identifier hs-var">deleteOne</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967891"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp1 -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#orderOfVarsOutputDataConE"><span class="hs-identifier hs-var">orderOfVarsOutputDataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967894"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2374"></span><span>  </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FoldE"><span class="hs-identifier hs-type">FoldE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967895"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967895"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967896"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967896"><span class="hs-identifier hs-var">_t1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967897"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967897"><span class="hs-identifier hs-var">r1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680967898"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967898"><span class="hs-identifier hs-var">v2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967899"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680967899"><span class="hs-identifier hs-var">_t2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680967900"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967900"><span class="hs-identifier hs-var">r2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680967901"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967901"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2375"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp1 -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#orderOfVarsOutputDataConE"><span class="hs-identifier hs-var">orderOfVarsOutputDataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967897"><span class="hs-identifier hs-var">r1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [Var]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp1 -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#orderOfVarsOutputDataConE"><span class="hs-identifier hs-var">orderOfVarsOutputDataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967900"><span class="hs-identifier hs-var">r2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Var] -&gt; [Var] -&gt; [Var]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Var]
forall a. Eq a =&gt; a -&gt; [a] -&gt; [a]
</span><a href="Gibbon.Passes.InferLocations.html#deleteOne"><span class="hs-identifier hs-var">deleteOne</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967895"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">([Var] -&gt; [Var]) -&gt; [Var] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Var]
forall a. Eq a =&gt; a -&gt; [a] -&gt; [a]
</span><a href="Gibbon.Passes.InferLocations.html#deleteOne"><span class="hs-identifier hs-var">deleteOne</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967898"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="annot"><span class="annottext">([Var] -&gt; [Var]) -&gt; [Var] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#orderOfVarsOutputDataConE"><span class="hs-identifier hs-var">orderOfVarsOutputDataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967901"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2376"></span><span>
</span><span id="line-2377"></span><span>  </span><span class="annot"><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-type">WithArenaE</span></a></span><span> </span><span id="local-6989586621680967902"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967902"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680967903"><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967903"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Var -&gt; [Var] -&gt; [Var]
forall a. Eq a =&gt; a -&gt; [a] -&gt; [a]
</span><a href="Gibbon.Passes.InferLocations.html#deleteOne"><span class="hs-identifier hs-var">deleteOne</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967902"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">([Var] -&gt; [Var]) -&gt; [Var] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#orderOfVarsOutputDataConE"><span class="hs-identifier hs-var">orderOfVarsOutputDataConE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680967903"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-2378"></span><span>
</span><span id="line-2379"></span><span>  </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-type">SpawnE</span></a></span><span> </span><span id="local-6989586621680967904"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967904"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="annottext">[()]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680967905"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967905"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Var]] -&gt; [Var]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">L.concat</span></a></span><span> </span><span class="annot"><span class="annottext">([[Var]] -&gt; [Var]) -&gt; [[Var]] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp1 -&gt; [Var]) -&gt; [Exp1] -&gt; [[Var]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">L.map</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#orderOfVarsOutputDataConE"><span class="hs-identifier hs-var">orderOfVarsOutputDataConE</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967905"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-2380"></span><span>  </span><span class="annot"><span class="annottext">Exp1
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2381"></span><span>  </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span id="local-6989586621680967906"><span class="annot"><span class="annottext">E1Ext () Ty1
</span><a href="#local-6989586621680967906"><span class="hs-identifier hs-var">ext</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-2382"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">E1Ext () Ty1
</span><a href="#local-6989586621680967906"><span class="hs-identifier hs-var">ext</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-2383"></span><span>      </span><span class="annot"><a href="Gibbon.L1.Syntax.html#AddFixed"><span class="hs-identifier hs-type">L1.AddFixed</span></a></span><span> </span><span id="local-6989586621680967907"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967907"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680967908"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680967908"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2384"></span><span>      </span><span class="annot"><a href="Gibbon.L1.Syntax.html#StartOfPkdCursor"><span class="hs-identifier hs-type">L1.StartOfPkdCursor</span></a></span><span> </span><span id="local-6989586621680967909"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967909"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-2385"></span><span>      </span><span class="annot"><a href="Gibbon.L1.Syntax.html#BenchE"><span class="hs-identifier hs-type">L1.BenchE</span></a></span><span> </span><span id="local-6989586621680967910"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680967910"><span class="hs-identifier hs-var">_f</span></a></span></span><span> </span><span id="local-6989586621680967911"><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680967911"><span class="hs-identifier hs-var">_locs</span></a></span></span><span> </span><span id="local-6989586621680967912"><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967912"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621680967913"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680967913"><span class="hs-identifier hs-var">_b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Var]] -&gt; [Var]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concat"><span class="hs-identifier hs-var">L.concat</span></a></span><span> </span><span class="annot"><span class="annottext">([[Var]] -&gt; [Var]) -&gt; [[Var]] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Exp1 -&gt; [Var]) -&gt; [Exp1] -&gt; [[Var]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">L.map</span></a></span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; [Var]
</span><a href="Gibbon.Passes.InferLocations.html#orderOfVarsOutputDataConE"><span class="hs-identifier hs-var">orderOfVarsOutputDataConE</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp1]
</span><a href="#local-6989586621680967912"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-2386"></span></pre></body></html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-name-shadowing #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-unused-binds #-}</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="annot"><span class="hs-comment">-- | The compiler pipeline, assembled from several passes.</span></span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Gibbon.Compiler</span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Compiler entrypoints</span></span><span>
</span><span id="line-12"></span><span>      </span><span class="annot"><a href="Gibbon.Compiler.html#compile"><span class="hs-identifier">compile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Compiler.html#compileCmd"><span class="hs-identifier">compileCmd</span></a></span><span>
</span><span id="line-13"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Configuration options and parsing</span></span><span>
</span><span id="line-14"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Config"><span class="hs-identifier">Config</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Mode"><span class="hs-identifier">Mode</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Input"><span class="hs-identifier">Input</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Compiler.html#configParser"><span class="hs-identifier">configParser</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Compiler.html#configWithArgs"><span class="hs-identifier">configWithArgs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Common.html#defaultConfig"><span class="hs-identifier">defaultConfig</span></a></span><span>
</span><span id="line-16"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Some other helper fns</span></span><span>
</span><span id="line-17"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Compiler.html#compileAndRunExe"><span class="hs-identifier">compileAndRunExe</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html"><span class="hs-identifier">Data.Functor</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/deepseq-1.4.8.0/src/Control.DeepSeq.html"><span class="hs-identifier">Control.DeepSeq</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Control.Exception.html"><span class="hs-identifier">Control.Exception</span></a></span><span class="hs-cpp">
#if !MIN_VERSION_base(4,15,0)
</span><span class="hs-cpp">#endif
</span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Strict.html"><span class="hs-identifier">Control.Monad.State.Strict</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.Reader.html"><span class="hs-identifier">Control.Monad.Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.Reader.Class.html#ask"><span class="hs-identifier">ask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.html"><span class="hs-identifier">Options.Applicative</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/directory-1.3.7.1/src/System.Directory.html"><span class="hs-identifier">System.Directory</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/System.Environment.html"><span class="hs-identifier">System.Environment</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/System.Exit.html"><span class="hs-identifier">System.Exit</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/template-haskell-2.19.0.0/src/System.FilePath.html"><span class="hs-identifier">System.FilePath</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/System.IO.html"><span class="hs-identifier">System.IO</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/System.IO.Error.html"><span class="hs-identifier">System.IO.Error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/System.IO.Error.html#isDoesNotExistError"><span class="hs-identifier">isDoesNotExistError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/process-1.6.16.0/src/System.Process.html"><span class="hs-identifier">System.Process</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/GenericPretty-1.2.2-7277c36a966d41cd8e1371a7ee4c855b29a76e94dfe1d95510f68242766a5b82/share/doc/html/src/Text.PrettyPrint.GenericPretty.html"><span class="hs-identifier">Text.PrettyPrint.GenericPretty</span></a></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Common.html"><span class="hs-identifier">Gibbon.Common</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.DynFlags.html"><span class="hs-identifier">Gibbon.DynFlags</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Language.html"><span class="hs-identifier">Gibbon.Language</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Gibbon.HaskellFrontend.html"><span class="hs-identifier">Gibbon.HaskellFrontend</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HS</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html"><span class="hs-identifier">Gibbon.L0.Syntax</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L0</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html"><span class="hs-identifier">Gibbon.L1.Syntax</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L1</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html"><span class="hs-identifier">Gibbon.L2.Syntax</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L2</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html"><span class="hs-identifier">Gibbon.L4.Syntax</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L4</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Gibbon.SExpFrontend.html"><span class="hs-identifier">Gibbon.SExpFrontend</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SExp</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.L0.Interp.html"><span class="hs-identifier">Gibbon.L0.Interp</span></a></span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.L1.Interp.html"><span class="hs-identifier">Gibbon.L1.Interp</span></a></span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.L2.Interp.html"><span class="hs-identifier">Gibbon.L2.Interp</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Gibbon.L2.Interp.html#Store"><span class="hs-identifier">Store</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L2.Interp.html#emptyStore"><span class="hs-identifier">emptyStore</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- import           Gibbon.TargetInterp (Val (..), execProg)</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-comment">-- Compiler passes</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Gibbon.L0.Typecheck.html"><span class="hs-identifier">Gibbon.L0.Typecheck</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L0</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Gibbon.L0.Specialize2.html"><span class="hs-identifier">Gibbon.L0.Specialize2</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L0</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Gibbon.L0.ElimNewtype.html"><span class="hs-identifier">Gibbon.L0.ElimNewtype</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L0</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Gibbon.L1.Typecheck.html"><span class="hs-identifier">Gibbon.L1.Typecheck</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L1</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Gibbon.L2.Typecheck.html"><span class="hs-identifier">Gibbon.L2.Typecheck</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L2</span></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Gibbon.L3.Typecheck.html"><span class="hs-identifier">Gibbon.L3.Typecheck</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L3</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Passes.Freshen.html"><span class="hs-identifier">Gibbon.Passes.Freshen</span></a></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.Freshen.html#freshNames"><span class="hs-identifier">freshNames</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Passes.Flatten.html"><span class="hs-identifier">Gibbon.Passes.Flatten</span></a></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.Flatten.html#flattenL1"><span class="hs-identifier">flattenL1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.Flatten.html#flattenL2"><span class="hs-identifier">flattenL2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.Flatten.html#flattenL3"><span class="hs-identifier">flattenL3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Passes.InlineTriv.html"><span class="hs-identifier">Gibbon.Passes.InlineTriv</span></a></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.InlineTriv.html#inlineTriv"><span class="hs-identifier">inlineTriv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Passes.Simplifier.html"><span class="hs-identifier">Gibbon.Passes.Simplifier</span></a></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.Simplifier.html#simplifyL1"><span class="hs-identifier">simplifyL1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.Simplifier.html#lateInlineTriv"><span class="hs-identifier">lateInlineTriv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.Simplifier.html#simplifyLocBinds"><span class="hs-identifier">simplifyLocBinds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- import           Gibbon.Passes.Sequentialize  (sequentialize)</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Passes.DirectL3.html"><span class="hs-identifier">Gibbon.Passes.DirectL3</span></a></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.DirectL3.html#directL3"><span class="hs-identifier">directL3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html"><span class="hs-identifier">Gibbon.Passes.InferLocations</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#inferLocs"><span class="hs-identifier">inferLocs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#fixRANs"><span class="hs-identifier">fixRANs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.InferLocations.html#removeAliasesForCopyCalls"><span class="hs-identifier">removeAliasesForCopyCalls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- This is the custom pass reference to issue #133 that moves regionsInwards</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Passes.RegionsInwards.html"><span class="hs-identifier">Gibbon.Passes.RegionsInwards</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.RegionsInwards.html#regionsInwards"><span class="hs-identifier">regionsInwards</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- import           Gibbon.Passes.RepairProgram  (repairProgram)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Passes.AddRAN.html"><span class="hs-identifier">Gibbon.Passes.AddRAN</span></a></span><span>         </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.AddRAN.html#addRAN"><span class="hs-identifier">addRAN</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Gibbon.Passes.AddRAN.html#needsRAN"><span class="hs-identifier">needsRAN</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Passes.AddTraversals.html"><span class="hs-identifier">Gibbon.Passes.AddTraversals</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.AddTraversals.html#addTraversals"><span class="hs-identifier">addTraversals</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Passes.RemoveCopies.html"><span class="hs-identifier">Gibbon.Passes.RemoveCopies</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.RemoveCopies.html#removeCopies"><span class="hs-identifier">removeCopies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Passes.InferEffects.html"><span class="hs-identifier">Gibbon.Passes.InferEffects</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.InferEffects.html#inferEffects"><span class="hs-identifier">inferEffects</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Passes.ParAlloc.html"><span class="hs-identifier">Gibbon.Passes.ParAlloc</span></a></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.ParAlloc.html#parAlloc"><span class="hs-identifier">parAlloc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Passes.InferRegionScope.html"><span class="hs-identifier">Gibbon.Passes.InferRegionScope</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.InferRegionScope.html#inferRegScope"><span class="hs-identifier">inferRegScope</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Passes.RouteEnds.html"><span class="hs-identifier">Gibbon.Passes.RouteEnds</span></a></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.RouteEnds.html#routeEnds"><span class="hs-identifier">routeEnds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Passes.FollowPtrs.html"><span class="hs-identifier">Gibbon.Passes.FollowPtrs</span></a></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.FollowPtrs.html#followPtrs"><span class="hs-identifier">followPtrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.NewL2.FromOldL2.html"><span class="hs-identifier">Gibbon.NewL2.FromOldL2</span></a></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.NewL2.FromOldL2.html#fromOldL2"><span class="hs-identifier">fromOldL2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Passes.ThreadRegions.html"><span class="hs-identifier">Gibbon.Passes.ThreadRegions</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.ThreadRegions.html#threadRegions"><span class="hs-identifier">threadRegions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Passes.InferFunAllocs.html"><span class="hs-identifier">Gibbon.Passes.InferFunAllocs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.InferFunAllocs.html#inferFunAllocs"><span class="hs-identifier">inferFunAllocs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Passes.Cursorize.html"><span class="hs-identifier">Gibbon.Passes.Cursorize</span></a></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.Cursorize.html#cursorize"><span class="hs-identifier">cursorize</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Passes.FindWitnesses.html"><span class="hs-identifier">Gibbon.Passes.FindWitnesses</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.FindWitnesses.html#findWitnesses"><span class="hs-identifier">findWitnesses</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- -- import           Gibbon.Passes.ShakeTree      (shakeTree)</span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Passes.HoistNewBuf.html"><span class="hs-identifier">Gibbon.Passes.HoistNewBuf</span></a></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.HoistNewBuf.html#hoistNewBuf"><span class="hs-identifier">hoistNewBuf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html"><span class="hs-identifier">Gibbon.Passes.ReorderScalarWrites</span></a></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#reorderScalarWrites"><span class="hs-identifier">reorderScalarWrites</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#writeOrderMarkers"><span class="hs-identifier">writeOrderMarkers</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Passes.Unariser.html"><span class="hs-identifier">Gibbon.Passes.Unariser</span></a></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.Unariser.html#unariser"><span class="hs-identifier">unariser</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Passes.Lower.html"><span class="hs-identifier">Gibbon.Passes.Lower</span></a></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.Lower.html#lower"><span class="hs-identifier">lower</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Passes.RearrangeFree.html"><span class="hs-identifier">Gibbon.Passes.RearrangeFree</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.RearrangeFree.html#rearrangeFree"><span class="hs-identifier">rearrangeFree</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Passes.Codegen.html"><span class="hs-identifier">Gibbon.Passes.Codegen</span></a></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.Codegen.html#codegenProg"><span class="hs-identifier">codegenProg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Passes.Fusion2.html"><span class="hs-identifier">Gibbon.Passes.Fusion2</span></a></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.Fusion2.html#fusion2"><span class="hs-identifier">fusion2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Pretty.html"><span class="hs-identifier">Gibbon.Pretty</span></a></span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.L1.GenSML.html"><span class="hs-identifier">Gibbon.L1.GenSML</span></a></span><span>
</span><span id="line-97"></span><span class="hs-comment">-- Configuring and launching the compiler.</span><span>
</span><span id="line-98"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="annot"><a href="Gibbon.Compiler.html#suppress_warnings"><span class="hs-identifier hs-type">suppress_warnings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-101"></span><span class="hs-comment">-- suppress_warnings = &quot; -Wno-int-to-pointer-cast -Wno-switch-bool -Wno-return-type &quot;</span><span>
</span><span id="line-102"></span><span id="suppress_warnings"><span class="annot"><span class="annottext">suppress_warnings :: String
</span><a href="Gibbon.Compiler.html#suppress_warnings"><span class="hs-identifier hs-var hs-var">suppress_warnings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="annot"><a href="Gibbon.Compiler.html#configParser"><span class="hs-identifier hs-type">configParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Types.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span>
</span><span id="line-105"></span><span id="configParser"><span class="annot"><span class="annottext">configParser :: Parser Config
</span><a href="Gibbon.Compiler.html#configParser"><span class="hs-identifier hs-var hs-var">configParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Input
-&gt; Mode
-&gt; Maybe String
-&gt; Maybe String
-&gt; Int
-&gt; String
-&gt; String
-&gt; Maybe String
-&gt; Maybe String
-&gt; Backend
-&gt; DynFlags
-&gt; Maybe String
-&gt; Config
</span><a href="Gibbon.Common.html#Config"><span class="hs-identifier hs-var">Config</span></a></span><span> </span><span class="annot"><span class="annottext">(Input
 -&gt; Mode
 -&gt; Maybe String
 -&gt; Maybe String
 -&gt; Int
 -&gt; String
 -&gt; String
 -&gt; Maybe String
 -&gt; Maybe String
 -&gt; Backend
 -&gt; DynFlags
 -&gt; Maybe String
 -&gt; Config)
-&gt; Parser Input
-&gt; Parser
     (Mode
      -&gt; Maybe String
      -&gt; Maybe String
      -&gt; Int
      -&gt; String
      -&gt; String
      -&gt; Maybe String
      -&gt; Maybe String
      -&gt; Backend
      -&gt; DynFlags
      -&gt; Maybe String
      -&gt; Config)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Input
</span><a href="#local-6989586621680992078"><span class="hs-identifier hs-var">inputParser</span></a></span><span>
</span><span id="line-106"></span><span>                      </span><span class="annot"><span class="annottext">Parser
  (Mode
   -&gt; Maybe String
   -&gt; Maybe String
   -&gt; Int
   -&gt; String
   -&gt; String
   -&gt; Maybe String
   -&gt; Maybe String
   -&gt; Backend
   -&gt; DynFlags
   -&gt; Maybe String
   -&gt; Config)
-&gt; Parser Mode
-&gt; Parser
     (Maybe String
      -&gt; Maybe String
      -&gt; Int
      -&gt; String
      -&gt; String
      -&gt; Maybe String
      -&gt; Maybe String
      -&gt; Backend
      -&gt; DynFlags
      -&gt; Maybe String
      -&gt; Config)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Mode
</span><a href="#local-6989586621680992079"><span class="hs-identifier hs-var">modeParser</span></a></span><span>
</span><span id="line-107"></span><span>                      </span><span class="annot"><span class="annottext">Parser
  (Maybe String
   -&gt; Maybe String
   -&gt; Int
   -&gt; String
   -&gt; String
   -&gt; Maybe String
   -&gt; Maybe String
   -&gt; Backend
   -&gt; DynFlags
   -&gt; Maybe String
   -&gt; Config)
-&gt; Parser (Maybe String)
-&gt; Parser
     (Maybe String
      -&gt; Int
      -&gt; String
      -&gt; String
      -&gt; Maybe String
      -&gt; Maybe String
      -&gt; Backend
      -&gt; DynFlags
      -&gt; Maybe String
      -&gt; Config)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Parser String -&gt; Parser (Maybe String)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f (Maybe a)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Control.Applicative.html#optional"><span class="hs-identifier hs-var">optional</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mod OptionFields String -&gt; Parser String
forall s. IsString s =&gt; Mod OptionFields s -&gt; Parser s
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#strOption"><span class="hs-identifier hs-var">strOption</span></a></span><span> </span><span class="annot"><span class="annottext">(Mod OptionFields String -&gt; Parser String)
-&gt; Mod OptionFields String -&gt; Parser String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Mod OptionFields String] -&gt; Mod OptionFields String
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-108"></span><span>                        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod OptionFields String
forall (f :: * -&gt; *) a. HasName f =&gt; String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#long"><span class="hs-identifier hs-var">long</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;bench-input&quot;</span></span><span>
</span><span id="line-109"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod OptionFields String
forall (f :: * -&gt; *) a. HasMetavar f =&gt; String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#metavar"><span class="hs-identifier hs-var">metavar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;FILE&quot;</span></span><span>
</span><span id="line-110"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod OptionFields String
forall (f :: * -&gt; *) a. String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#help"><span class="hs-identifier hs-var">help</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Mod OptionFields String)
-&gt; String -&gt; Mod OptionFields String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-111"></span><span>                            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Hard-code the input file for --bench-fun, otherwise it&quot;</span></span><span>
</span><span id="line-112"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; becomes a command-line argument of the resulting binary.&quot;</span></span><span>
</span><span id="line-113"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; Also we RUN the benchmark right away if this is provided.&quot;</span></span><span>
</span><span id="line-114"></span><span>                            </span><span class="hs-special">]</span><span>
</span><span id="line-115"></span><span>                        </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>                      </span><span class="annot"><span class="annottext">Parser
  (Maybe String
   -&gt; Int
   -&gt; String
   -&gt; String
   -&gt; Maybe String
   -&gt; Maybe String
   -&gt; Backend
   -&gt; DynFlags
   -&gt; Maybe String
   -&gt; Config)
-&gt; Parser (Maybe String)
-&gt; Parser
     (Int
      -&gt; String
      -&gt; String
      -&gt; Maybe String
      -&gt; Maybe String
      -&gt; Backend
      -&gt; DynFlags
      -&gt; Maybe String
      -&gt; Config)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Parser String -&gt; Parser (Maybe String)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f (Maybe a)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Control.Applicative.html#optional"><span class="hs-identifier hs-var">optional</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mod OptionFields String -&gt; Parser String
forall s. IsString s =&gt; Mod OptionFields s -&gt; Parser s
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#strOption"><span class="hs-identifier hs-var">strOption</span></a></span><span> </span><span class="annot"><span class="annottext">(Mod OptionFields String -&gt; Parser String)
-&gt; Mod OptionFields String -&gt; Parser String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Mod OptionFields String] -&gt; Mod OptionFields String
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-117"></span><span>                        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod OptionFields String
forall (f :: * -&gt; *) a. HasName f =&gt; String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#long"><span class="hs-identifier hs-var">long</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;array-input&quot;</span></span><span>
</span><span id="line-118"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod OptionFields String
forall (f :: * -&gt; *) a. HasMetavar f =&gt; String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#metavar"><span class="hs-identifier hs-var">metavar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;FILE&quot;</span></span><span>
</span><span id="line-119"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod OptionFields String
forall (f :: * -&gt; *) a. String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#help"><span class="hs-identifier hs-var">help</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Mod OptionFields String)
-&gt; String -&gt; Mod OptionFields String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-120"></span><span>                          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Hard-code the input file for readArrayFile or it&quot;</span></span><span>
</span><span id="line-121"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; becomes a command-line argument of the resulting binary.&quot;</span></span><span>
</span><span id="line-122"></span><span>                          </span><span class="hs-special">]</span><span>
</span><span id="line-123"></span><span>                        </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>                      </span><span class="annot"><span class="annottext">Parser
  (Int
   -&gt; String
   -&gt; String
   -&gt; Maybe String
   -&gt; Maybe String
   -&gt; Backend
   -&gt; DynFlags
   -&gt; Maybe String
   -&gt; Config)
-&gt; Parser Int
-&gt; Parser
     (String
      -&gt; String
      -&gt; Maybe String
      -&gt; Maybe String
      -&gt; Backend
      -&gt; DynFlags
      -&gt; Maybe String
      -&gt; Config)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReadM Int -&gt; Mod OptionFields Int -&gt; Parser Int
forall a. ReadM a -&gt; Mod OptionFields a -&gt; Parser a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#option"><span class="hs-identifier hs-var">option</span></a></span><span> </span><span class="annot"><span class="annottext">ReadM Int
forall a. Read a =&gt; ReadM a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#auto"><span class="hs-identifier hs-var">auto</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Mod OptionFields Int] -&gt; Mod OptionFields Int
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-125"></span><span>                        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Mod OptionFields Int
forall (f :: * -&gt; *) a. HasName f =&gt; Char -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'v'</span></span><span>
</span><span id="line-126"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod OptionFields Int
forall (f :: * -&gt; *) a. HasName f =&gt; String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#long"><span class="hs-identifier hs-var">long</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;verbose&quot;</span></span><span>
</span><span id="line-127"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod OptionFields Int
forall (f :: * -&gt; *) a. String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#help"><span class="hs-identifier hs-var">help</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Set the debug output level, 1-5, mirrors DEBUG env var.&quot;</span></span><span>
</span><span id="line-128"></span><span>                        </span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Int -&gt; Parser Int -&gt; Parser Int
forall a. Parser a -&gt; Parser a -&gt; Parser a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser Int
forall a. a -&gt; Parser a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>                      </span><span class="annot"><span class="annottext">Parser
  (String
   -&gt; String
   -&gt; Maybe String
   -&gt; Maybe String
   -&gt; Backend
   -&gt; DynFlags
   -&gt; Maybe String
   -&gt; Config)
-&gt; Parser String
-&gt; Parser
     (String
      -&gt; Maybe String
      -&gt; Maybe String
      -&gt; Backend
      -&gt; DynFlags
      -&gt; Maybe String
      -&gt; Config)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mod OptionFields String -&gt; Parser String
forall s. IsString s =&gt; Mod OptionFields s -&gt; Parser s
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#strOption"><span class="hs-identifier hs-var">strOption</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Mod OptionFields String
forall (f :: * -&gt; *) a. HasName f =&gt; String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#long"><span class="hs-identifier hs-var">long</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cc&quot;</span></span><span> </span><span class="annot"><span class="annottext">Mod OptionFields String
-&gt; Mod OptionFields String -&gt; Mod OptionFields String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod OptionFields String
forall (f :: * -&gt; *) a. String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#help"><span class="hs-identifier hs-var">help</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Set C compiler, default 'gcc'&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>                           </span><span class="annot"><span class="annottext">Parser String -&gt; Parser String -&gt; Parser String
forall a. Parser a -&gt; Parser a -&gt; Parser a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser String
forall a. a -&gt; Parser a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Config -&gt; String
</span><a href="Gibbon.Common.html#cc"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="Gibbon.Common.html#defaultConfig"><span class="hs-identifier hs-var">defaultConfig</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>                      </span><span class="annot"><span class="annottext">Parser
  (String
   -&gt; Maybe String
   -&gt; Maybe String
   -&gt; Backend
   -&gt; DynFlags
   -&gt; Maybe String
   -&gt; Config)
-&gt; Parser String
-&gt; Parser
     (Maybe String
      -&gt; Maybe String -&gt; Backend -&gt; DynFlags -&gt; Maybe String -&gt; Config)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mod OptionFields String -&gt; Parser String
forall s. IsString s =&gt; Mod OptionFields s -&gt; Parser s
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#strOption"><span class="hs-identifier hs-var">strOption</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Mod OptionFields String
forall (f :: * -&gt; *) a. HasName f =&gt; String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#long"><span class="hs-identifier hs-var">long</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;optc&quot;</span></span><span> </span><span class="annot"><span class="annottext">Mod OptionFields String
-&gt; Mod OptionFields String -&gt; Mod OptionFields String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod OptionFields String
forall (f :: * -&gt; *) a. String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#help"><span class="hs-identifier hs-var">help</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Set C compiler options, default '-std=gnu11 -O3'&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>                           </span><span class="annot"><span class="annottext">Parser String -&gt; Parser String -&gt; Parser String
forall a. Parser a -&gt; Parser a -&gt; Parser a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser String
forall a. a -&gt; Parser a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Config -&gt; String
</span><a href="Gibbon.Common.html#optc"><span class="hs-identifier hs-var">optc</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="Gibbon.Common.html#defaultConfig"><span class="hs-identifier hs-var">defaultConfig</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>                      </span><span class="annot"><span class="annottext">Parser
  (Maybe String
   -&gt; Maybe String -&gt; Backend -&gt; DynFlags -&gt; Maybe String -&gt; Config)
-&gt; Parser (Maybe String)
-&gt; Parser
     (Maybe String -&gt; Backend -&gt; DynFlags -&gt; Maybe String -&gt; Config)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; Maybe String) -&gt; Parser String -&gt; Parser (Maybe String)
forall a b. (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mod OptionFields String -&gt; Parser String
forall s. IsString s =&gt; Mod OptionFields s -&gt; Parser s
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#strOption"><span class="hs-identifier hs-var">strOption</span></a></span><span> </span><span class="annot"><span class="annottext">(Mod OptionFields String -&gt; Parser String)
-&gt; Mod OptionFields String -&gt; Parser String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod OptionFields String
forall (f :: * -&gt; *) a. HasName f =&gt; String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#long"><span class="hs-identifier hs-var">long</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cfile&quot;</span></span><span> </span><span class="annot"><span class="annottext">Mod OptionFields String
-&gt; Mod OptionFields String -&gt; Mod OptionFields String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod OptionFields String
forall (f :: * -&gt; *) a. String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#help"><span class="hs-identifier hs-var">help</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Set the destination file for generated C code&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>                           </span><span class="annot"><span class="annottext">Parser (Maybe String)
-&gt; Parser (Maybe String) -&gt; Parser (Maybe String)
forall a. Parser a -&gt; Parser a -&gt; Parser a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; Parser (Maybe String)
forall a. a -&gt; Parser a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Config -&gt; Maybe String
</span><a href="Gibbon.Common.html#cfile"><span class="hs-identifier hs-var">cfile</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="Gibbon.Common.html#defaultConfig"><span class="hs-identifier hs-var">defaultConfig</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>                      </span><span class="annot"><span class="annottext">Parser
  (Maybe String -&gt; Backend -&gt; DynFlags -&gt; Maybe String -&gt; Config)
-&gt; Parser (Maybe String)
-&gt; Parser (Backend -&gt; DynFlags -&gt; Maybe String -&gt; Config)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; Maybe String) -&gt; Parser String -&gt; Parser (Maybe String)
forall a b. (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mod OptionFields String -&gt; Parser String
forall s. IsString s =&gt; Mod OptionFields s -&gt; Parser s
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#strOption"><span class="hs-identifier hs-var">strOption</span></a></span><span> </span><span class="annot"><span class="annottext">(Mod OptionFields String -&gt; Parser String)
-&gt; Mod OptionFields String -&gt; Parser String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Mod OptionFields String] -&gt; Mod OptionFields String
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-136"></span><span>                        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Mod OptionFields String
forall (f :: * -&gt; *) a. HasName f =&gt; Char -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'o'</span></span><span>
</span><span id="line-137"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod OptionFields String
forall (f :: * -&gt; *) a. HasName f =&gt; String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#long"><span class="hs-identifier hs-var">long</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;exefile&quot;</span></span><span>
</span><span id="line-138"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod OptionFields String
forall (f :: * -&gt; *) a. String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#help"><span class="hs-identifier hs-var">help</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Set the destination file for the executable&quot;</span></span><span>
</span><span id="line-139"></span><span>                        </span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser (Maybe String)
-&gt; Parser (Maybe String) -&gt; Parser (Maybe String)
forall a. Parser a -&gt; Parser a -&gt; Parser a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; Parser (Maybe String)
forall a. a -&gt; Parser a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Config -&gt; Maybe String
</span><a href="Gibbon.Common.html#exefile"><span class="hs-identifier hs-var">exefile</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="Gibbon.Common.html#defaultConfig"><span class="hs-identifier hs-var">defaultConfig</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>                      </span><span class="annot"><span class="annottext">Parser (Backend -&gt; DynFlags -&gt; Maybe String -&gt; Config)
-&gt; Parser Backend -&gt; Parser (DynFlags -&gt; Maybe String -&gt; Config)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Backend
</span><a href="#local-6989586621680992093"><span class="hs-identifier hs-var">backendParser</span></a></span><span>
</span><span id="line-141"></span><span>                      </span><span class="annot"><span class="annottext">Parser (DynFlags -&gt; Maybe String -&gt; Config)
-&gt; Parser DynFlags -&gt; Parser (Maybe String -&gt; Config)
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Parser DynFlags
</span><a href="Gibbon.DynFlags.html#dynflagsParser"><span class="hs-identifier hs-var">dynflagsParser</span></a></span><span>
</span><span id="line-142"></span><span>                      </span><span class="annot"><span class="annottext">Parser (Maybe String -&gt; Config)
-&gt; Parser (Maybe String) -&gt; Parser Config
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Parser String -&gt; Parser (Maybe String)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f (Maybe a)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Control.Applicative.html#optional"><span class="hs-identifier hs-var">optional</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mod OptionFields String -&gt; Parser String
forall s. IsString s =&gt; Mod OptionFields s -&gt; Parser s
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#strOption"><span class="hs-identifier hs-var">strOption</span></a></span><span> </span><span class="annot"><span class="annottext">Mod OptionFields String
forall (f :: * -&gt; *) a. Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#hidden"><span class="hs-identifier hs-var">hidden</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-144"></span><span>  </span><span class="annot"><a href="#local-6989586621680992078"><span class="hs-identifier hs-type">inputParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Types.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Input"><span class="hs-identifier hs-type">Input</span></a></span><span>
</span><span id="line-145"></span><span>                </span><span class="hs-comment">-- I'd like to display a separator and some more info.  How?</span><span>
</span><span id="line-146"></span><span>  </span><span id="local-6989586621680992078"><span class="annot"><span class="annottext">inputParser :: Parser Input
</span><a href="#local-6989586621680992078"><span class="hs-identifier hs-var hs-var">inputParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- infoOption &quot;foo&quot; (help &quot;bar&quot;) &lt;*&gt;</span><span>
</span><span id="line-147"></span><span>                </span><span class="annot"><span class="annottext">Input -&gt; Mod FlagFields Input -&gt; Parser Input
forall a. a -&gt; Mod FlagFields a -&gt; Parser a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#flag%27"><span class="hs-identifier hs-var">flag'</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="Gibbon.Common.html#Haskell"><span class="hs-identifier hs-var">Haskell</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Mod FlagFields Input
forall (f :: * -&gt; *) a. HasName f =&gt; String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#long"><span class="hs-identifier hs-var">long</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hs&quot;</span></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">Parser Input -&gt; Parser Input -&gt; Parser Input
forall a. Parser a -&gt; Parser a -&gt; Parser a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span>
</span><span id="line-148"></span><span>                </span><span class="annot"><span class="annottext">Input -&gt; Input -&gt; Mod FlagFields Input -&gt; Parser Input
forall a. a -&gt; a -&gt; Mod FlagFields a -&gt; Parser a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#flag"><span class="hs-identifier hs-var">flag</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="Gibbon.Common.html#Unspecified"><span class="hs-identifier hs-var">Unspecified</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="Gibbon.Common.html#SExpr"><span class="hs-identifier hs-var">SExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Mod FlagFields Input
forall (f :: * -&gt; *) a. HasName f =&gt; String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#long"><span class="hs-identifier hs-var">long</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;gib&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span>  </span><span id="local-6989586621680992079"><span class="annot"><span class="annottext">modeParser :: Parser Mode
</span><a href="#local-6989586621680992079"><span class="hs-identifier hs-var hs-var">modeParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- infoOption &quot;foo&quot; (help &quot;bar&quot;) &lt;*&gt;</span><span>
</span><span id="line-151"></span><span>               </span><span class="annot"><span class="annottext">Mode -&gt; Mod FlagFields Mode -&gt; Parser Mode
forall a. a -&gt; Mod FlagFields a -&gt; Parser a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#flag%27"><span class="hs-identifier hs-var">flag'</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="Gibbon.Common.html#ToParse"><span class="hs-identifier hs-var">ToParse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Mod FlagFields Mode
forall (f :: * -&gt; *) a. HasName f =&gt; String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#long"><span class="hs-identifier hs-var">long</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;parse&quot;</span></span><span> </span><span class="annot"><span class="annottext">Mod FlagFields Mode -&gt; Mod FlagFields Mode -&gt; Mod FlagFields Mode
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod FlagFields Mode
forall (f :: * -&gt; *) a. String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#help"><span class="hs-identifier hs-var">help</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Only parse, then print &amp; stop&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Mode -&gt; Parser Mode -&gt; Parser Mode
forall a. Parser a -&gt; Parser a -&gt; Parser a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span>
</span><span id="line-152"></span><span>               </span><span class="annot"><span class="annottext">Mode -&gt; Mod FlagFields Mode -&gt; Parser Mode
forall a. a -&gt; Mod FlagFields a -&gt; Parser a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#flag%27"><span class="hs-identifier hs-var">flag'</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="Gibbon.Common.html#ToC"><span class="hs-identifier hs-var">ToC</span></a></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Mod FlagFields Mode
forall (f :: * -&gt; *) a. HasName f =&gt; String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#long"><span class="hs-identifier hs-var">long</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;toC&quot;</span></span><span> </span><span class="annot"><span class="annottext">Mod FlagFields Mode -&gt; Mod FlagFields Mode -&gt; Mod FlagFields Mode
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod FlagFields Mode
forall (f :: * -&gt; *) a. String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#help"><span class="hs-identifier hs-var">help</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Compile to a C file, named after the input&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Mode -&gt; Parser Mode -&gt; Parser Mode
forall a. Parser a -&gt; Parser a -&gt; Parser a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span>               </span><span class="annot"><span class="annottext">Mode -&gt; Mod FlagFields Mode -&gt; Parser Mode
forall a. a -&gt; Mod FlagFields a -&gt; Parser a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#flag%27"><span class="hs-identifier hs-var">flag'</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="Gibbon.Common.html#ToExe"><span class="hs-identifier hs-var">ToExe</span></a></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Mod FlagFields Mode
forall (f :: * -&gt; *) a. HasName f =&gt; String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#long"><span class="hs-identifier hs-var">long</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;to-exe&quot;</span></span><span> </span><span class="annot"><span class="annottext">Mod FlagFields Mode -&gt; Mod FlagFields Mode -&gt; Mod FlagFields Mode
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod FlagFields Mode
forall (f :: * -&gt; *) a. String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#help"><span class="hs-identifier hs-var">help</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Compile to a C file, named after the input&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Mode -&gt; Parser Mode -&gt; Parser Mode
forall a. Parser a -&gt; Parser a -&gt; Parser a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span>
</span><span id="line-157"></span><span>               </span><span class="annot"><span class="annottext">Mode -&gt; Mod FlagFields Mode -&gt; Parser Mode
forall a. a -&gt; Mod FlagFields a -&gt; Parser a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#flag%27"><span class="hs-identifier hs-var">flag'</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="Gibbon.Common.html#Interp1"><span class="hs-identifier hs-var">Interp1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Mod FlagFields Mode
forall (f :: * -&gt; *) a. HasName f =&gt; String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#long"><span class="hs-identifier hs-var">long</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;interp1&quot;</span></span><span> </span><span class="annot"><span class="annottext">Mod FlagFields Mode -&gt; Mod FlagFields Mode -&gt; Mod FlagFields Mode
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod FlagFields Mode
forall (f :: * -&gt; *) a. String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#help"><span class="hs-identifier hs-var">help</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;run through the interpreter early, right after parsing&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Mode -&gt; Parser Mode -&gt; Parser Mode
forall a. Parser a -&gt; Parser a -&gt; Parser a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span>
</span><span id="line-158"></span><span>               </span><span class="annot"><span class="annottext">Mode -&gt; Mod FlagFields Mode -&gt; Parser Mode
forall a. a -&gt; Mod FlagFields a -&gt; Parser a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#flag%27"><span class="hs-identifier hs-var">flag'</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="Gibbon.Common.html#Interp2"><span class="hs-identifier hs-var">Interp2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Mod FlagFields Mode
forall (f :: * -&gt; *) a. HasName f =&gt; Char -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'i'</span></span><span> </span><span class="annot"><span class="annottext">Mod FlagFields Mode -&gt; Mod FlagFields Mode -&gt; Mod FlagFields Mode
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod FlagFields Mode
forall (f :: * -&gt; *) a. HasName f =&gt; String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#long"><span class="hs-identifier hs-var">long</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;interp2&quot;</span></span><span> </span><span class="annot"><span class="annottext">Mod FlagFields Mode -&gt; Mod FlagFields Mode -&gt; Mod FlagFields Mode
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span>
</span><span id="line-159"></span><span>                              </span><span class="annot"><span class="annottext">String -&gt; Mod FlagFields Mode
forall (f :: * -&gt; *) a. String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#help"><span class="hs-identifier hs-var">help</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Run through the interpreter after cursor insertion&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Mode -&gt; Parser Mode -&gt; Parser Mode
forall a. Parser a -&gt; Parser a -&gt; Parser a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span>
</span><span id="line-160"></span><span>               </span><span class="annot"><span class="annottext">Mode -&gt; Mod FlagFields Mode -&gt; Parser Mode
forall a. a -&gt; Mod FlagFields a -&gt; Parser a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#flag%27"><span class="hs-identifier hs-var">flag'</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="Gibbon.Common.html#RunExe"><span class="hs-identifier hs-var">RunExe</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Mod FlagFields Mode
forall (f :: * -&gt; *) a. HasName f =&gt; Char -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'r'</span></span><span> </span><span class="annot"><span class="annottext">Mod FlagFields Mode -&gt; Mod FlagFields Mode -&gt; Mod FlagFields Mode
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod FlagFields Mode
forall (f :: * -&gt; *) a. HasName f =&gt; String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#long"><span class="hs-identifier hs-var">long</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;run&quot;</span></span><span> </span><span class="annot"><span class="annottext">Mod FlagFields Mode -&gt; Mod FlagFields Mode -&gt; Mod FlagFields Mode
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod FlagFields Mode
forall (f :: * -&gt; *) a. String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#help"><span class="hs-identifier hs-var">help</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Compile and then run executable&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Mode -&gt; Parser Mode -&gt; Parser Mode
forall a. Parser a -&gt; Parser a -&gt; Parser a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span>
</span><span id="line-161"></span><span>               </span><span class="annot"><span class="annottext">Mode -&gt; Mod FlagFields Mode -&gt; Parser Mode
forall a. a -&gt; Mod FlagFields a -&gt; Parser a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#flag%27"><span class="hs-identifier hs-var">flag'</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="Gibbon.Common.html#ToMPL"><span class="hs-identifier hs-var">ToMPL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Mod FlagFields Mode
forall (f :: * -&gt; *) a. HasName f =&gt; String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#long"><span class="hs-identifier hs-var">long</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mpl&quot;</span></span><span> </span><span class="annot"><span class="annottext">Mod FlagFields Mode -&gt; Mod FlagFields Mode -&gt; Mod FlagFields Mode
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod FlagFields Mode
forall (f :: * -&gt; *) a. String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#help"><span class="hs-identifier hs-var">help</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Emit MPL sources&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Mode -&gt; Parser Mode -&gt; Parser Mode
forall a. Parser a -&gt; Parser a -&gt; Parser a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span>
</span><span id="line-162"></span><span>               </span><span class="annot"><span class="annottext">Mode -&gt; Mod FlagFields Mode -&gt; Parser Mode
forall a. a -&gt; Mod FlagFields a -&gt; Parser a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#flag%27"><span class="hs-identifier hs-var">flag'</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="Gibbon.Common.html#ToMPLExe"><span class="hs-identifier hs-var">ToMPLExe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Mod FlagFields Mode
forall (f :: * -&gt; *) a. HasName f =&gt; String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#long"><span class="hs-identifier hs-var">long</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mpl-exe&quot;</span></span><span> </span><span class="annot"><span class="annottext">Mod FlagFields Mode -&gt; Mod FlagFields Mode -&gt; Mod FlagFields Mode
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod FlagFields Mode
forall (f :: * -&gt; *) a. String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#help"><span class="hs-identifier hs-var">help</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Emit SML and compile with MPL&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Mode -&gt; Parser Mode -&gt; Parser Mode
forall a. Parser a -&gt; Parser a -&gt; Parser a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span>
</span><span id="line-163"></span><span>               </span><span class="annot"><span class="annottext">Mode -&gt; Mod FlagFields Mode -&gt; Parser Mode
forall a. a -&gt; Mod FlagFields a -&gt; Parser a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#flag%27"><span class="hs-identifier hs-var">flag'</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="Gibbon.Common.html#RunMPL"><span class="hs-identifier hs-var">RunMPL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Mod FlagFields Mode
forall (f :: * -&gt; *) a. HasName f =&gt; String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#long"><span class="hs-identifier hs-var">long</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mpl-run&quot;</span></span><span> </span><span class="annot"><span class="annottext">Mod FlagFields Mode -&gt; Mod FlagFields Mode -&gt; Mod FlagFields Mode
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod FlagFields Mode
forall (f :: * -&gt; *) a. String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#help"><span class="hs-identifier hs-var">help</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Emit SML, compile with MPL, and run&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Mode -&gt; Parser Mode -&gt; Parser Mode
forall a. Parser a -&gt; Parser a -&gt; Parser a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span>
</span><span id="line-164"></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Mode
</span><a href="Gibbon.Common.html#Bench"><span class="hs-identifier hs-var">Bench</span></a></span><span> </span><span class="annot"><span class="annottext">(Var -&gt; Mode) -&gt; (String -&gt; Var) -&gt; String -&gt; Mode
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Mode) -&gt; Parser String -&gt; Parser Mode
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Mod OptionFields String -&gt; Parser String
forall s. IsString s =&gt; Mod OptionFields s -&gt; Parser s
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#strOption"><span class="hs-identifier hs-var">strOption</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Mod OptionFields String
forall (f :: * -&gt; *) a. HasName f =&gt; Char -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#short"><span class="hs-identifier hs-var">short</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'b'</span></span><span> </span><span class="annot"><span class="annottext">Mod OptionFields String
-&gt; Mod OptionFields String -&gt; Mod OptionFields String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod OptionFields String
forall (f :: * -&gt; *) a. HasName f =&gt; String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#long"><span class="hs-identifier hs-var">long</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;bench-fun&quot;</span></span><span> </span><span class="annot"><span class="annottext">Mod OptionFields String
-&gt; Mod OptionFields String -&gt; Mod OptionFields String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod OptionFields String
forall (f :: * -&gt; *) a. HasMetavar f =&gt; String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#metavar"><span class="hs-identifier hs-var">metavar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;FUN&quot;</span></span><span> </span><span class="annot"><span class="annottext">Mod OptionFields String
-&gt; Mod OptionFields String -&gt; Mod OptionFields String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span>
</span><span id="line-165"></span><span>                                     </span><span class="annot"><span class="annottext">String -&gt; Mod OptionFields String
forall (f :: * -&gt; *) a. String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#help"><span class="hs-identifier hs-var">help</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Generate code to benchmark a 1-argument FUN against a input packed file.&quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-166"></span><span>                                           </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  If --bench-input is provided, then the benchmark is run as well.&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-comment">-- use C as the default backend</span><span>
</span><span id="line-169"></span><span>  </span><span class="annot"><a href="#local-6989586621680992093"><span class="hs-identifier hs-type">backendParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Types.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span>
</span><span id="line-170"></span><span>  </span><span id="local-6989586621680992093"><span class="annot"><span class="annottext">backendParser :: Parser Backend
</span><a href="#local-6989586621680992093"><span class="hs-identifier hs-var hs-var">backendParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Backend -&gt; Backend -&gt; Mod FlagFields Backend -&gt; Parser Backend
forall a. a -&gt; a -&gt; Mod FlagFields a -&gt; Parser a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#flag"><span class="hs-identifier hs-var">flag</span></a></span><span> </span><span class="annot"><span class="annottext">Backend
</span><a href="Gibbon.Common.html#C"><span class="hs-identifier hs-var">C</span></a></span><span> </span><span class="annot"><span class="annottext">Backend
</span><a href="Gibbon.Common.html#LLVM"><span class="hs-identifier hs-var">LLVM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Mod FlagFields Backend
forall (f :: * -&gt; *) a. HasName f =&gt; String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#long"><span class="hs-identifier hs-var">long</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;llvm&quot;</span></span><span> </span><span class="annot"><span class="annottext">Mod FlagFields Backend
-&gt; Mod FlagFields Backend -&gt; Mod FlagFields Backend
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod FlagFields Backend
forall (f :: * -&gt; *) a. String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#help"><span class="hs-identifier hs-var">help</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;use the llvm backend for compilation&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="annot"><span class="hs-comment">-- | Parse configuration as well as file arguments.</span></span><span>
</span><span id="line-174"></span><span class="annot"><a href="Gibbon.Compiler.html#configWithArgs"><span class="hs-identifier hs-type">configWithArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Types.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span id="configWithArgs"><span class="annot"><span class="annottext">configWithArgs :: Parser (Config, [String])
</span><a href="Gibbon.Compiler.html#configWithArgs"><span class="hs-identifier hs-var hs-var">configWithArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Config -&gt; [String] -&gt; (Config, [String]))
-&gt; Parser Config -&gt; Parser ([String] -&gt; (Config, [String]))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Config
</span><a href="Gibbon.Compiler.html#configParser"><span class="hs-identifier hs-var">configParser</span></a></span><span>
</span><span id="line-176"></span><span>                     </span><span class="annot"><span class="annottext">Parser ([String] -&gt; (Config, [String]))
-&gt; Parser [String] -&gt; Parser (Config, [String])
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Parser String -&gt; Parser [String]
forall a. Parser a -&gt; Parser [a]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#some"><span class="hs-identifier hs-var">some</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReadM String -&gt; Mod ArgumentFields String -&gt; Parser String
forall a. ReadM a -&gt; Mod ArgumentFields a -&gt; Parser a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#argument"><span class="hs-identifier hs-var">argument</span></a></span><span> </span><span class="annot"><span class="annottext">ReadM String
forall s. IsString s =&gt; ReadM s
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#str"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Mod ArgumentFields String
forall (f :: * -&gt; *) a. HasMetavar f =&gt; String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#metavar"><span class="hs-identifier hs-var">metavar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;FILES...&quot;</span></span><span> </span><span class="annot"><span class="annottext">Mod ArgumentFields String
-&gt; Mod ArgumentFields String -&gt; Mod ArgumentFields String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Mod ArgumentFields String
forall (f :: * -&gt; *) a. String -&gt; Mod f a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#help"><span class="hs-identifier hs-var">help</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Files to compile.&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-comment">-- | Command line version of the compiler entrypoint.  Parses command</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- line arguments given as string inputs.  This also allows us to run</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- conveniently from within GHCI.  For example:</span><span>
</span><span id="line-183"></span><span class="hs-comment">--</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- &gt;  compileCmd $ words $ &quot; -r -p -v5 examples/test11c_funrec.gib &quot;</span><span>
</span><span id="line-185"></span><span class="hs-comment">--</span><span>
</span><span id="line-186"></span><span class="annot"><a href="Gibbon.Compiler.html#compileCmd"><span class="hs-identifier hs-type">compileCmd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span id="compileCmd"><span class="annot"><span class="annottext">compileCmd :: [String] -&gt; IO ()
</span><a href="Gibbon.Compiler.html#compileCmd"><span class="hs-identifier hs-var hs-var">compileCmd</span></a></span></span><span> </span><span id="local-6989586621680992182"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680992182"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; IO () -&gt; IO ()
forall a. [String] -&gt; IO a -&gt; IO a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/System.Environment.html#withArgs"><span class="hs-identifier hs-var">withArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680992182"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680992184"><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680992184"><span class="hs-identifier hs-var">cfg</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680992185"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680992185"><span class="hs-identifier hs-var">files</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ParserInfo (Config, [String]) -&gt; IO (Config, [String])
forall a. ParserInfo a -&gt; IO a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Extra.html#execParser"><span class="hs-identifier hs-var">execParser</span></a></span><span> </span><span class="annot"><span class="annottext">ParserInfo (Config, [String])
</span><a href="#local-6989586621680992187"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-189"></span><span>       </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680992185"><span class="hs-identifier hs-var">files</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-190"></span><span>         </span><span class="hs-special">[</span><span id="local-6989586621680992188"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992188"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Config -&gt; String -&gt; IO ()
</span><a href="Gibbon.Compiler.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680992184"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992188"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-191"></span><span>         </span><span class="annot"><span class="annottext">[String]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; IO ()
</span><a href="Gibbon.Common.html#dbgPrintLn"><span class="hs-identifier hs-var">dbgPrintLn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Compiling multiple files:  &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680992185"><span class="hs-identifier hs-var">files</span></a></span><span>
</span><span id="line-192"></span><span>                 </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; [String] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#mapM_"><span class="hs-identifier hs-var">mapM_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Config -&gt; String -&gt; IO ()
</span><a href="Gibbon.Compiler.html#compile"><span class="hs-identifier hs-var">compile</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680992184"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621680992185"><span class="hs-identifier hs-var">files</span></a></span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-194"></span><span>    </span><span id="local-6989586621680992187"><span class="annot"><span class="annottext">opts :: ParserInfo (Config, [String])
</span><a href="#local-6989586621680992187"><span class="hs-identifier hs-var hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser (Config, [String])
-&gt; InfoMod (Config, [String]) -&gt; ParserInfo (Config, [String])
forall a. Parser a -&gt; InfoMod a -&gt; ParserInfo a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#info"><span class="hs-identifier hs-var">info</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser ((Config, [String]) -&gt; (Config, [String]))
forall a. Parser (a -&gt; a)
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Extra.html#helper"><span class="hs-identifier hs-var">helper</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ((Config, [String]) -&gt; (Config, [String]))
-&gt; Parser (Config, [String]) -&gt; Parser (Config, [String])
forall a b. Parser (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Parser (Config, [String])
</span><a href="Gibbon.Compiler.html#configWithArgs"><span class="hs-identifier hs-var">configWithArgs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(InfoMod (Config, [String]) -&gt; ParserInfo (Config, [String]))
-&gt; InfoMod (Config, [String]) -&gt; ParserInfo (Config, [String])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[InfoMod (Config, [String])] -&gt; InfoMod (Config, [String])
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-195"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">InfoMod (Config, [String])
forall a. InfoMod a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#fullDesc"><span class="hs-identifier hs-var">fullDesc</span></a></span><span>
</span><span id="line-196"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; InfoMod (Config, [String])
forall a. String -&gt; InfoMod a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#progDesc"><span class="hs-identifier hs-var">progDesc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Compile FILES according to the below options.&quot;</span></span><span>
</span><span id="line-197"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; InfoMod (Config, [String])
forall a. String -&gt; InfoMod a
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/optparse-applicative-0.18.1.0-36dc9e43b8a3db49175fc962b7dfa56a67ac33477ef9737e64065ca99ccad20e/share/doc/html/src/Options.Applicative.Builder.html#header"><span class="hs-identifier hs-var">header</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;A compiler for a minature tree traversal language&quot;</span></span><span>
</span><span id="line-198"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="annot"><a href="Gibbon.Compiler.html#sepline"><span class="hs-identifier hs-type">sepline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-202"></span><span id="sepline"><span class="annot"><span class="annottext">sepline :: String
</span><a href="Gibbon.Compiler.html#sepline"><span class="hs-identifier hs-var hs-var">sepline</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">80</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-keyword">data</span><span> </span><span id="CompileState"><span class="annot"><a href="Gibbon.Compiler.html#CompileState"><span class="hs-identifier hs-var">CompileState</span></a></span></span><span> </span><span id="local-6989586621680991656"><span class="annot"><a href="#local-6989586621680991656"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CompileState"><span class="annot"><a href="Gibbon.Compiler.html#CompileState"><span class="hs-identifier hs-var">CompileState</span></a></span></span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="cnt"><span class="annot"><span class="annottext">forall a. CompileState a -&gt; Int
</span><a href="Gibbon.Compiler.html#cnt"><span class="hs-identifier hs-var hs-var">cnt</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Gensym counter</span></span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="result"><span class="annot"><span class="annottext">forall a. CompileState a -&gt; Maybe (Value a)
</span><a href="Gibbon.Compiler.html#result"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991656"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Result of evaluating output of prior pass, if available.</span></span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-comment">-- | Compiler entrypoint, given a full configuration and a list of</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- files to process, do the thing.</span><span>
</span><span id="line-212"></span><span class="annot"><a href="Gibbon.Compiler.html#compile"><span class="hs-identifier hs-type">compile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span id="compile"><span class="annot"><span class="annottext">compile :: Config -&gt; String -&gt; IO ()
</span><a href="Gibbon.Compiler.html#compile"><span class="hs-identifier hs-var hs-var">compile</span></a></span></span><span> </span><span id="local-6989586621680992316"><span class="annot"><span class="annottext">config :: Config
</span><a href="#local-6989586621680992316"><span class="hs-identifier hs-var">config</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Common.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span class="hs-special">{</span><span id="local-6989586621680992317"><span class="annot"><span class="annottext">Mode
mode :: Mode
mode :: Config -&gt; Mode
</span><a href="#local-6989586621680992317"><span class="hs-identifier hs-var hs-var">mode</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680992319"><span class="annot"><span class="annottext">Input
input :: Input
input :: Config -&gt; Input
</span><a href="#local-6989586621680992319"><span class="hs-identifier hs-var hs-var">input</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680992321"><span class="annot"><span class="annottext">Int
verbosity :: Int
verbosity :: Config -&gt; Int
</span><a href="#local-6989586621680992321"><span class="hs-identifier hs-var hs-var">verbosity</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680992323"><span class="annot"><span class="annottext">Backend
backend :: Backend
backend :: Config -&gt; Backend
</span><a href="#local-6989586621680992323"><span class="hs-identifier hs-var hs-var">backend</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680992325"><span class="annot"><span class="annottext">Maybe String
cfile :: Config -&gt; Maybe String
cfile :: Maybe String
</span><a href="Gibbon.Common.html#cfile"><span class="hs-identifier hs-var hs-var">cfile</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621680992326"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992326"><span class="hs-identifier hs-var">fp0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-comment">-- set the env var DEBUG, to verbosity, when &gt; 1</span><span>
</span><span id="line-215"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; IO ()
</span><a href="Gibbon.Compiler.html#setDebugEnvVar"><span class="hs-identifier hs-var">setDebugEnvVar</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680992321"><span class="hs-identifier hs-var">verbosity</span></a></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-comment">-- Use absolute path</span><span>
</span><span id="line-218"></span><span>  </span><span id="local-6989586621680992328"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992328"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/directory-1.3.7.1/src/System.Directory.html#getCurrentDirectory"><span class="hs-identifier hs-var">getCurrentDirectory</span></a></span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680992330"><span class="annot"><span class="annottext">fp1 :: String
</span><a href="#local-6989586621680992330"><span class="hs-identifier hs-var hs-var">fp1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992328"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/filepath-1.4.2.2/src/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992326"><span class="hs-identifier hs-var">fp0</span></a></span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-comment">-- Parse the input file</span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621680992332"><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680992332"><span class="hs-identifier hs-var">l0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680992333"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680992333"><span class="hs-identifier hs-var">cnt0</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621680992334"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992334"><span class="hs-identifier hs-var">fp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Config -&gt; Input -&gt; String -&gt; IO ((Prog0, Int), String)
</span><a href="Gibbon.Compiler.html#parseInput"><span class="hs-identifier hs-var">parseInput</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680992316"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621680992319"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992330"><span class="hs-identifier hs-var">fp1</span></a></span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680992336"><span class="annot"><span class="annottext">config' :: Config
</span><a href="#local-6989586621680992336"><span class="hs-identifier hs-var hs-var">config'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680992316"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">srcFile :: Maybe String
</span><a href="Gibbon.Common.html#srcFile"><span class="hs-identifier hs-var">srcFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992334"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621680992338"><span class="hs-identifier hs-type">initTypeChecked</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Prog0"><span class="hs-identifier hs-type">L0.Prog0</span></a></span><span>
</span><span id="line-225"></span><span>      </span><span id="local-6989586621680992338"><span class="annot"><span class="annottext">initTypeChecked :: Prog0
</span><a href="#local-6989586621680992338"><span class="hs-identifier hs-var hs-var">initTypeChecked</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-226"></span><span>        </span><span class="hs-comment">-- We typecheck first to turn the appropriate VarE's into FunRefE's.</span><span>
</span><span id="line-227"></span><span>        </span><span class="annot"><span class="annottext">(Prog0, Int) -&gt; Prog0
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((Prog0, Int) -&gt; Prog0) -&gt; (Prog0, Int) -&gt; Prog0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Config -&gt; Int -&gt; PassM Prog0 -&gt; (Prog0, Int)
forall a. Config -&gt; Int -&gt; PassM a -&gt; (a, Int)
</span><a href="Gibbon.Common.html#runPassM"><span class="hs-identifier hs-var">runPassM</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="Gibbon.Common.html#defaultConfig"><span class="hs-identifier hs-var">defaultConfig</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680992333"><span class="hs-identifier hs-var">cnt0</span></a></span><span>
</span><span id="line-228"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog0 -&gt; PassM Prog0
</span><a href="Gibbon.Passes.Freshen.html#freshNames"><span class="hs-identifier hs-var">freshNames</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680992332"><span class="hs-identifier hs-var">l0</span></a></span><span> </span><span class="annot"><span class="annottext">PassM Prog0 -&gt; (Prog0 -&gt; PassM Prog0) -&gt; PassM Prog0
forall a b. PassM a -&gt; (a -&gt; PassM b) -&gt; PassM b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span>
</span><span id="line-229"></span><span>                 </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680992341"><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680992341"><span class="hs-identifier hs-var">fresh</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; PassM Prog0 -&gt; PassM Prog0
forall a. Int -&gt; String -&gt; a -&gt; a
</span><a href="Gibbon.Common.html#dbgTrace"><span class="hs-identifier hs-var">dbgTrace</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\nFreshen:\n&quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">String
</span><a href="Gibbon.Compiler.html#sepline"><span class="hs-identifier hs-var">sepline</span></a></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">Prog0 -&gt; String
forall e. Pretty e =&gt; e -&gt; String
</span><a href="Gibbon.Pretty.html#pprender"><span class="hs-identifier hs-var">pprender</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680992341"><span class="hs-identifier hs-var">fresh</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog0 -&gt; PassM Prog0
</span><a href="Gibbon.L0.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L0.tcProg</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680992341"><span class="hs-identifier hs-var">fresh</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621680992317"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-232"></span><span>    </span><span class="annot"><span class="annottext">Mode
</span><a href="Gibbon.Common.html#Interp1"><span class="hs-identifier hs-var">Interp1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-233"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; IO () -&gt; IO ()
forall a. Int -&gt; String -&gt; a -&gt; a
</span><a href="Gibbon.Common.html#dbgTrace"><span class="hs-identifier hs-var">dbgTrace</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Gibbon.Compiler.html#passChatterLvl"><span class="hs-identifier hs-var">passChatterLvl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\nParsed:\n&quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">String
</span><a href="Gibbon.Compiler.html#sepline"><span class="hs-identifier hs-var">sepline</span></a></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680992332"><span class="hs-identifier hs-var">l0</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; IO () -&gt; IO ()
forall a. Int -&gt; String -&gt; a -&gt; a
</span><a href="Gibbon.Common.html#dbgTrace"><span class="hs-identifier hs-var">dbgTrace</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Gibbon.Compiler.html#passChatterLvl"><span class="hs-identifier hs-var">passChatterLvl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\nTypechecked:\n&quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">String
</span><a href="Gibbon.Compiler.html#sepline"><span class="hs-identifier hs-var">sepline</span></a></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0 -&gt; String
forall e. Pretty e =&gt; e -&gt; String
</span><a href="Gibbon.Pretty.html#pprender"><span class="hs-identifier hs-var">pprender</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680992338"><span class="hs-identifier hs-var">initTypeChecked</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>        </span><span id="local-6989586621680992347"><span class="annot"><span class="annottext">RunConfig
</span><a href="#local-6989586621680992347"><span class="hs-identifier hs-var">runConf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; IO RunConfig
</span><a href="Gibbon.Common.html#getRunConfig"><span class="hs-identifier hs-var">getRunConfig</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-236"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621680992349"><span class="annot"><span class="annottext">()
</span><a href="#local-6989586621680992349"><span class="hs-identifier hs-var">_s1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680992350"><span class="annot"><span class="annottext">Value Exp0
</span><a href="#local-6989586621680992350"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680992351"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680992351"><span class="hs-identifier hs-var">_stdout</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">() -&gt; RunConfig -&gt; Prog0 -&gt; IO ((), Value Exp0, ByteString)
forall s e.
InterpProg s e =&gt;
s -&gt; RunConfig -&gt; Prog e -&gt; IO (s, Value e, ByteString)
</span><a href="Gibbon.Language.Syntax.html#gInterpProg"><span class="hs-identifier hs-var">gInterpProg</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RunConfig
</span><a href="#local-6989586621680992347"><span class="hs-identifier hs-var">runConf</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680992338"><span class="hs-identifier hs-var">initTypeChecked</span></a></span><span>
</span><span id="line-237"></span><span>        </span><span class="annot"><span class="annottext">Value Exp0 -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/System.IO.html#print"><span class="hs-identifier hs-var">print</span></a></span><span> </span><span class="annot"><span class="annottext">Value Exp0
</span><a href="#local-6989586621680992350"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span>    </span><span class="annot"><span class="annottext">Mode
</span><a href="Gibbon.Common.html#ToParse"><span class="hs-identifier hs-var">ToParse</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; IO ()
</span><a href="Gibbon.Common.html#dbgPrintLn"><span class="hs-identifier hs-var">dbgPrintLn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0 -&gt; String
forall e. Pretty e =&gt; e -&gt; String
</span><a href="Gibbon.Pretty.html#pprender"><span class="hs-identifier hs-var">pprender</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680992332"><span class="hs-identifier hs-var">l0</span></a></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span>    </span><span class="annot"><span class="annottext">Mode
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-243"></span><span>      </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; IO ()
</span><a href="Gibbon.Common.html#dbgPrintLn"><span class="hs-identifier hs-var">dbgPrintLn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Gibbon.Compiler.html#passChatterLvl"><span class="hs-identifier hs-var">passChatterLvl</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-244"></span><span>          </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; [compiler] pipeline starting, parsed program: &quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-245"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Gibbon.Common.html#dbgLvl"><span class="hs-identifier hs-var">dbgLvl</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Gibbon.Compiler.html#passChatterLvl"><span class="hs-identifier hs-var">passChatterLvl</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-246"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">String
</span><a href="Gibbon.Compiler.html#sepline"><span class="hs-identifier hs-var">sepline</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680992332"><span class="hs-identifier hs-var">l0</span></a></span><span>
</span><span id="line-247"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog0 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680992332"><span class="hs-identifier hs-var">l0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; characters.&quot;</span></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span>      </span><span class="hs-comment">-- (Stage 1) Run the program through the interpreter</span><span>
</span><span id="line-250"></span><span>      </span><span id="local-6989586621680992356"><span class="annot"><span class="annottext">Maybe (Value Exp0)
</span><a href="#local-6989586621680992356"><span class="hs-identifier hs-var">initResult</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Prog0 -&gt; IO (Maybe (Value Exp0))
</span><a href="Gibbon.Compiler.html#withPrintInterpProg"><span class="hs-identifier hs-var">withPrintInterpProg</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680992338"><span class="hs-identifier hs-var">initTypeChecked</span></a></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span>      </span><span class="hs-comment">-- (Stage 2) C/LLVM codegen</span><span>
</span><span id="line-253"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680992358"><span class="annot"><span class="annottext">outfile :: String
</span><a href="#local-6989586621680992358"><span class="hs-identifier hs-var hs-var">outfile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Backend -&gt; String -&gt; Maybe String -&gt; String
</span><a href="Gibbon.Compiler.html#getOutfile"><span class="hs-identifier hs-var">getOutfile</span></a></span><span> </span><span class="annot"><span class="annottext">Backend
</span><a href="#local-6989586621680992323"><span class="hs-identifier hs-var">backend</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992334"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621680992325"><span class="hs-identifier hs-var">cfile</span></a></span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span>      </span><span class="hs-comment">-- run the initial program through the compiler pipeline</span><span>
</span><span id="line-256"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680992360"><span class="annot"><span class="annottext">stM :: StateT (CompileState Exp0) IO Prog
</span><a href="#local-6989586621680992360"><span class="hs-identifier hs-var hs-var">stM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Config -&gt; Prog0 -&gt; StateT (CompileState Exp0) IO Prog
forall v.
Show v =&gt;
Config -&gt; Prog0 -&gt; StateT (CompileState v) IO Prog
</span><a href="Gibbon.Compiler.html#passes"><span class="hs-identifier hs-var">passes</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680992336"><span class="hs-identifier hs-var">config'</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680992332"><span class="hs-identifier hs-var">l0</span></a></span><span>
</span><span id="line-257"></span><span>      </span><span id="local-6989586621680992362"><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621680992362"><span class="hs-identifier hs-var">l4</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT (CompileState Exp0) IO Prog -&gt; CompileState Exp0 -&gt; IO Prog
forall (m :: * -&gt; *) s a. Monad m =&gt; StateT s m a -&gt; s -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Strict.html#evalStateT"><span class="hs-identifier hs-var">evalStateT</span></a></span><span> </span><span class="annot"><span class="annottext">StateT (CompileState Exp0) IO Prog
</span><a href="#local-6989586621680992360"><span class="hs-identifier hs-var">stM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Compiler.html#CompileState"><span class="hs-identifier hs-type">CompileState</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">cnt :: Int
</span><a href="Gibbon.Compiler.html#cnt"><span class="hs-identifier hs-var">cnt</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680992333"><span class="hs-identifier hs-var">cnt0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">result :: Maybe (Value Exp0)
</span><a href="Gibbon.Compiler.html#result"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">Maybe (Value Exp0)
</span><a href="#local-6989586621680992356"><span class="hs-identifier hs-var">initResult</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621680992317"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-260"></span><span>        </span><span class="annot"><span class="annottext">Mode
</span><a href="Gibbon.Common.html#Interp2"><span class="hs-identifier hs-var">Interp2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-261"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TODO: Interp2&quot;</span></span><span>
</span><span id="line-262"></span><span>          </span><span class="hs-comment">-- l4res &lt;- execProg l4</span><span>
</span><span id="line-263"></span><span>          </span><span class="hs-comment">-- mapM_ (\(IntVal v) -&gt; liftIO $ print v) l4res</span><span>
</span><span id="line-264"></span><span>          </span><span class="hs-comment">-- exitSuccess</span><span>
</span><span id="line-265"></span><span>        </span><span>
</span><span id="line-266"></span><span>        </span><span class="annot"><span class="annottext">Mode
</span><a href="Gibbon.Common.html#ToMPL"><span class="hs-identifier hs-var">ToMPL</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>        </span><span class="annot"><span class="annottext">Mode
</span><a href="Gibbon.Common.html#ToMPLExe"><span class="hs-identifier hs-var">ToMPLExe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>        </span><span class="annot"><span class="annottext">Mode
</span><a href="Gibbon.Common.html#RunMPL"><span class="hs-identifier hs-var">RunMPL</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span>        </span><span class="annot"><span class="annottext">Mode
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-271"></span><span>          </span><span id="local-6989586621680992365"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992365"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Backend
</span><a href="#local-6989586621680992323"><span class="hs-identifier hs-var">backend</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-272"></span><span>                  </span><span class="annot"><span class="annottext">Backend
</span><a href="Gibbon.Common.html#C"><span class="hs-identifier hs-var">C</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Config -&gt; Prog -&gt; IO String
</span><a href="Gibbon.Passes.Codegen.html#codegenProg"><span class="hs-identifier hs-var">codegenProg</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680992336"><span class="hs-identifier hs-var">config'</span></a></span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621680992362"><span class="hs-identifier hs-var">l4</span></a></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span>                  </span><span class="annot"><span class="annottext">Backend
</span><a href="Gibbon.Common.html#LLVM"><span class="hs-identifier hs-var">LLVM</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO String) -&gt; String -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot execute through the LLVM backend. To build Gibbon with LLVM: &quot;</span></span><span>
</span><span id="line-277"></span><span>                          </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;stack build --flag gibbon:llvm_enabled&quot;</span></span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span>          </span><span class="hs-comment">-- The C code is long, so put this at a higher verbosity level.</span><span>
</span><span id="line-280"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; IO ()
</span><a href="Gibbon.Common.html#dbgPrint"><span class="hs-identifier hs-var">dbgPrint</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Gibbon.Compiler.html#passChatterLvl"><span class="hs-identifier hs-var">passChatterLvl</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; [compiler] Final C codegen: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992365"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; characters.&quot;</span></span><span>
</span><span id="line-281"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; IO ()
</span><a href="Gibbon.Common.html#dbgPrintLn"><span class="hs-identifier hs-var">dbgPrintLn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Gibbon.Compiler.html#sepline"><span class="hs-identifier hs-var">sepline</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992365"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="Gibbon.Compiler.html#clearFile"><span class="hs-identifier hs-var">clearFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992358"><span class="hs-identifier hs-var">outfile</span></a></span><span>
</span><span id="line-284"></span><span>          </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/System.IO.html#writeFile"><span class="hs-identifier hs-var">writeFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992358"><span class="hs-identifier hs-var">outfile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992365"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span>          </span><span class="hs-comment">-- (Stage 3) Code written, now compile if warranted.</span><span>
</span><span id="line-287"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621680992317"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Mode -&gt; Mode -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="Gibbon.Common.html#ToExe"><span class="hs-identifier hs-var">ToExe</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621680992317"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Mode -&gt; Mode -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="Gibbon.Common.html#RunExe"><span class="hs-identifier hs-var">RunExe</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Mode -&gt; Bool
</span><a href="Gibbon.Compiler.html#isBench"><span class="hs-identifier hs-var">isBench</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621680992317"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-288"></span><span>            </span><span class="annot"><span class="annottext">Config -&gt; String -&gt; IO String
</span><a href="Gibbon.Compiler.html#compileAndRunExe"><span class="hs-identifier hs-var">compileAndRunExe</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680992316"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992334"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; IO ()) -&gt; IO ()
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/System.IO.html#putStr"><span class="hs-identifier hs-var">putStr</span></a></span><span>
</span><span id="line-289"></span><span>            </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="annot"><a href="Gibbon.Compiler.html#runL0"><span class="hs-identifier hs-type">runL0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Prog0"><span class="hs-identifier hs-type">L0.Prog0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span id="runL0"><span class="annot"><span class="annottext">runL0 :: Prog0 -&gt; IO ()
</span><a href="Gibbon.Compiler.html#runL0"><span class="hs-identifier hs-var hs-var">runL0</span></a></span></span><span> </span><span id="local-6989586621680992390"><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680992390"><span class="hs-identifier hs-var">l0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-comment">-- FIXME: no command line option atm.  Just env vars.</span><span>
</span><span id="line-294"></span><span>    </span><span id="local-6989586621680992391"><span class="annot"><span class="annottext">RunConfig
</span><a href="#local-6989586621680992391"><span class="hs-identifier hs-var">runConf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; IO RunConfig
</span><a href="Gibbon.Common.html#getRunConfig"><span class="hs-identifier hs-var">getRunConfig</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-295"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; IO ()
</span><a href="Gibbon.Common.html#dbgPrintLn"><span class="hs-identifier hs-var">dbgPrintLn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Running the following through L0.Interp:\n &quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">String
</span><a href="Gibbon.Compiler.html#sepline"><span class="hs-identifier hs-var">sepline</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680992390"><span class="hs-identifier hs-var">l0</span></a></span><span>
</span><span id="line-296"></span><span>    </span><span class="annot"><span class="annottext">() -&gt; RunConfig -&gt; Prog0 -&gt; IO ()
forall s ex. InterpProg s ex =&gt; s -&gt; RunConfig -&gt; Prog ex -&gt; IO ()
</span><a href="Gibbon.Language.Syntax.html#execAndPrint"><span class="hs-identifier hs-var">execAndPrint</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RunConfig
</span><a href="#local-6989586621680992391"><span class="hs-identifier hs-var">runConf</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680992390"><span class="hs-identifier hs-var">l0</span></a></span><span>
</span><span id="line-297"></span><span>    </span><span class="annot"><span class="annottext">IO ()
forall a. IO a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/System.Exit.html#exitSuccess"><span class="hs-identifier hs-var">exitSuccess</span></a></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="annot"><span class="hs-comment">-- | The compiler's policy for running/printing L1 programs.</span></span><span>
</span><span id="line-300"></span><span class="annot"><a href="Gibbon.Compiler.html#runL1"><span class="hs-identifier hs-type">runL1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Prog1"><span class="hs-identifier hs-type">L1.Prog1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span id="runL1"><span class="annot"><span class="annottext">runL1 :: Prog1 -&gt; IO ()
</span><a href="Gibbon.Compiler.html#runL1"><span class="hs-identifier hs-var hs-var">runL1</span></a></span></span><span> </span><span id="local-6989586621680992421"><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680992421"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-302"></span><span>    </span><span class="hs-comment">-- FIXME: no command line option atm.  Just env vars.</span><span>
</span><span id="line-303"></span><span>    </span><span id="local-6989586621680992422"><span class="annot"><span class="annottext">RunConfig
</span><a href="#local-6989586621680992422"><span class="hs-identifier hs-var">runConf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; IO RunConfig
</span><a href="Gibbon.Common.html#getRunConfig"><span class="hs-identifier hs-var">getRunConfig</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-304"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; IO ()
</span><a href="Gibbon.Common.html#dbgPrintLn"><span class="hs-identifier hs-var">dbgPrintLn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Running the following through L1.Interp:\n &quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">String
</span><a href="Gibbon.Compiler.html#sepline"><span class="hs-identifier hs-var">sepline</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Prog1 -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680992421"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-305"></span><span>    </span><span class="annot"><span class="annottext">() -&gt; RunConfig -&gt; Prog1 -&gt; IO ()
forall s ex. InterpProg s ex =&gt; s -&gt; RunConfig -&gt; Prog ex -&gt; IO ()
</span><a href="Gibbon.Language.Syntax.html#execAndPrint"><span class="hs-identifier hs-var">execAndPrint</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RunConfig
</span><a href="#local-6989586621680992422"><span class="hs-identifier hs-var">runConf</span></a></span><span> </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680992421"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><span class="annottext">IO ()
forall a. IO a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/System.Exit.html#exitSuccess"><span class="hs-identifier hs-var">exitSuccess</span></a></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="annot"><span class="hs-comment">-- | The compiler's policy for running/printing L2 programs.</span></span><span>
</span><span id="line-309"></span><span class="annot"><a href="Gibbon.Compiler.html#runL2"><span class="hs-identifier hs-type">runL2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Prog2"><span class="hs-identifier hs-type">L2.Prog2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span id="runL2"><span class="annot"><span class="annottext">runL2 :: Prog2 -&gt; IO ()
</span><a href="Gibbon.Compiler.html#runL2"><span class="hs-identifier hs-var hs-var">runL2</span></a></span></span><span> </span><span id="local-6989586621680992424"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680992424"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prog1 -&gt; IO ()
</span><a href="Gibbon.Compiler.html#runL1"><span class="hs-identifier hs-var">runL1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog2 -&gt; Prog1
</span><a href="Gibbon.L2.Syntax.html#revertToL1"><span class="hs-identifier hs-var">L2.revertToL1</span></a></span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680992424"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span class="hs-comment">-- | Set the env var DEBUG, to verbosity, when &gt; 1</span><span>
</span><span id="line-313"></span><span class="hs-comment">-- TERRIBLE HACK!!</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- This verbosity value is global, &quot;pure&quot; and can be read anywhere</span><span>
</span><span id="line-315"></span><span class="hs-comment">--</span><span>
</span><span id="line-316"></span><span class="annot"><a href="Gibbon.Compiler.html#setDebugEnvVar"><span class="hs-identifier hs-type">setDebugEnvVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span id="setDebugEnvVar"><span class="annot"><span class="annottext">setDebugEnvVar :: Int -&gt; IO ()
</span><a href="Gibbon.Compiler.html#setDebugEnvVar"><span class="hs-identifier hs-var hs-var">setDebugEnvVar</span></a></span></span><span> </span><span id="local-6989586621680992435"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680992435"><span class="hs-identifier hs-var">verbosity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-318"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680992435"><span class="hs-identifier hs-var">verbosity</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-319"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/System.Environment.html#setEnv"><span class="hs-identifier hs-var">setEnv</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GIBBON_DEBUG&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680992435"><span class="hs-identifier hs-var">verbosity</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>    </span><span id="local-6989586621680992438"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680992438"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO Int
forall a. a -&gt; IO a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.html#evaluate"><span class="hs-identifier hs-var">evaluate</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Gibbon.Common.html#dbgLvl"><span class="hs-identifier hs-var">dbgLvl</span></a></span><span>
</span><span id="line-321"></span><span>    </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.Handle.Text.html#hPutStrLn"><span class="hs-identifier hs-var">hPutStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.StdHandles.html#stderr"><span class="hs-identifier hs-var">stderr</span></a></span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; ! We set DEBUG based on command-line verbose arg: &quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680992438"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span class="annot"><a href="Gibbon.Compiler.html#parseInput"><span class="hs-identifier hs-type">parseInput</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Input"><span class="hs-identifier hs-type">Input</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L0.Syntax.html#Prog0"><span class="hs-identifier hs-type">L0.Prog0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span id="parseInput"><span class="annot"><span class="annottext">parseInput :: Config -&gt; Input -&gt; String -&gt; IO ((Prog0, Int), String)
</span><a href="Gibbon.Compiler.html#parseInput"><span class="hs-identifier hs-var hs-var">parseInput</span></a></span></span><span> </span><span id="local-6989586621680992482"><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680992482"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span id="local-6989586621680992483"><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621680992483"><span class="hs-identifier hs-var">ip</span></a></span></span><span> </span><span id="local-6989586621680992484"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992484"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621680992485"><span class="annot"><span class="annottext">PassM Prog0
</span><a href="#local-6989586621680992485"><span class="hs-identifier hs-var">l0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680992486"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992486"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-327"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Input
</span><a href="#local-6989586621680992483"><span class="hs-identifier hs-var">ip</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-328"></span><span>      </span><span class="annot"><span class="annottext">Input
</span><a href="Gibbon.Common.html#Haskell"><span class="hs-identifier hs-var">Haskell</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992484"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PassM Prog0 -&gt; (PassM Prog0, String))
-&gt; IO (PassM Prog0) -&gt; IO (PassM Prog0, String)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Config -&gt; String -&gt; IO (PassM Prog0)
</span><a href="Gibbon.HaskellFrontend.html#parseFile"><span class="hs-identifier hs-var">HS.parseFile</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680992482"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992484"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-329"></span><span>      </span><span class="annot"><span class="annottext">Input
</span><a href="Gibbon.Common.html#SExpr"><span class="hs-identifier hs-var">SExpr</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992484"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PassM Prog0 -&gt; (PassM Prog0, String))
-&gt; IO (PassM Prog0) -&gt; IO (PassM Prog0, String)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (PassM Prog0)
</span><a href="Gibbon.SExpFrontend.html#parseFile"><span class="hs-identifier hs-var">SExp.parseFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992484"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-330"></span><span>      </span><span class="annot"><span class="annottext">Input
</span><a href="Gibbon.Common.html#Unspecified"><span class="hs-identifier hs-var">Unspecified</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-331"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/filepath-1.4.2.2/src/System.FilePath.Posix.html#takeExtension"><span class="hs-identifier hs-var">takeExtension</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992484"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-332"></span><span>          </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.hs&quot;</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992484"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PassM Prog0 -&gt; (PassM Prog0, String))
-&gt; IO (PassM Prog0) -&gt; IO (PassM Prog0, String)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Config -&gt; String -&gt; IO (PassM Prog0)
</span><a href="Gibbon.HaskellFrontend.html#parseFile"><span class="hs-identifier hs-var">HS.parseFile</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680992482"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992484"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-333"></span><span>          </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.sexp&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992484"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PassM Prog0 -&gt; (PassM Prog0, String))
-&gt; IO (PassM Prog0) -&gt; IO (PassM Prog0, String)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (PassM Prog0)
</span><a href="Gibbon.SExpFrontend.html#parseFile"><span class="hs-identifier hs-var">SExp.parseFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992484"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-334"></span><span>          </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.rkt&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992484"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PassM Prog0 -&gt; (PassM Prog0, String))
-&gt; IO (PassM Prog0) -&gt; IO (PassM Prog0, String)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (PassM Prog0)
</span><a href="Gibbon.SExpFrontend.html#parseFile"><span class="hs-identifier hs-var">SExp.parseFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992484"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-335"></span><span>          </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.gib&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992484"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PassM Prog0 -&gt; (PassM Prog0, String))
-&gt; IO (PassM Prog0) -&gt; IO (PassM Prog0, String)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (PassM Prog0)
</span><a href="Gibbon.SExpFrontend.html#parseFile"><span class="hs-identifier hs-var">SExp.parseFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992484"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-336"></span><span>          </span><span id="local-6989586621680992490"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992490"><span class="hs-identifier hs-var">oth</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-337"></span><span>            </span><span class="hs-comment">-- A silly hack just out of sheer laziness vis-a-vis tab completion:</span><span>
</span><span id="line-338"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680992491"><span class="annot"><span class="annottext">f1 :: String
</span><a href="#local-6989586621680992491"><span class="hs-identifier hs-var hs-var">f1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992484"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.gib&quot;</span></span><span>
</span><span id="line-339"></span><span>                </span><span id="local-6989586621680992492"><span class="annot"><span class="annottext">f2 :: String
</span><a href="#local-6989586621680992492"><span class="hs-identifier hs-var hs-var">f2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992484"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;gib&quot;</span></span><span>
</span><span id="line-340"></span><span>            </span><span id="local-6989586621680992493"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680992493"><span class="hs-identifier hs-var">f1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/directory-1.3.7.1/src/System.Directory.html#doesFileExist"><span class="hs-identifier hs-var">doesFileExist</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992491"><span class="hs-identifier hs-var">f1</span></a></span><span>
</span><span id="line-341"></span><span>            </span><span id="local-6989586621680992495"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680992495"><span class="hs-identifier hs-var">f2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/directory-1.3.7.1/src/System.Directory.html#doesFileExist"><span class="hs-identifier hs-var">doesFileExist</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992492"><span class="hs-identifier hs-var">f2</span></a></span><span>
</span><span id="line-342"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680992493"><span class="hs-identifier hs-var">f1'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992490"><span class="hs-identifier hs-var">oth</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680992495"><span class="hs-identifier hs-var">f2'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992490"><span class="hs-identifier hs-var">oth</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992492"><span class="hs-identifier hs-var">f2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(PassM Prog0 -&gt; (PassM Prog0, String))
-&gt; IO (PassM Prog0) -&gt; IO (PassM Prog0, String)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (PassM Prog0)
</span><a href="Gibbon.SExpFrontend.html#parseFile"><span class="hs-identifier hs-var">SExp.parseFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992491"><span class="hs-identifier hs-var">f1</span></a></span><span>
</span><span id="line-344"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (PassM Prog0, String)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO (PassM Prog0, String))
-&gt; String -&gt; IO (PassM Prog0, String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-345"></span><span>              </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;compile: unrecognized file extension: &quot;</span></span><span>
</span><span id="line-346"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992490"><span class="hs-identifier hs-var">oth</span></a></span><span>
</span><span id="line-347"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;  Please specify compile input format.&quot;</span></span><span>
</span><span id="line-348"></span><span>              </span><span class="hs-special">]</span><span>
</span><span id="line-349"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680992497"><span class="annot"><span class="annottext">l0' :: PassM Prog0
</span><a href="#local-6989586621680992497"><span class="hs-identifier hs-var hs-var">l0'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680992498"><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680992498"><span class="hs-identifier hs-var">parsed</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PassM Prog0
</span><a href="#local-6989586621680992485"><span class="hs-identifier hs-var">l0</span></a></span><span>
</span><span id="line-350"></span><span>               </span><span class="hs-comment">-- dbgTraceIt (sdoc parsed) (pure ())</span><span>
</span><span id="line-351"></span><span>               </span><span class="annot"><span class="annottext">Prog0 -&gt; PassM Prog0
</span><a href="Gibbon.HaskellFrontend.html#desugarLinearExts"><span class="hs-identifier hs-var">HS.desugarLinearExts</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680992498"><span class="hs-identifier hs-var">parsed</span></a></span><span>
</span><span id="line-352"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621680992500"><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680992500"><span class="hs-identifier hs-var">l0''</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680992501"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680992501"><span class="hs-identifier hs-var">cnt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Prog0, Int) -&gt; IO (Prog0, Int)
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">((Prog0, Int) -&gt; IO (Prog0, Int))
-&gt; (Prog0, Int) -&gt; IO (Prog0, Int)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Config -&gt; Int -&gt; PassM Prog0 -&gt; (Prog0, Int)
forall a. Config -&gt; Int -&gt; PassM a -&gt; (a, Int)
</span><a href="Gibbon.Common.html#runPassM"><span class="hs-identifier hs-var">runPassM</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="Gibbon.Common.html#defaultConfig"><span class="hs-identifier hs-var">defaultConfig</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">PassM Prog0
</span><a href="#local-6989586621680992497"><span class="hs-identifier hs-var">l0'</span></a></span><span>
</span><span id="line-353"></span><span>  </span><span class="annot"><span class="annottext">((Prog0, Int), String) -&gt; IO ((Prog0, Int), String)
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680992500"><span class="hs-identifier hs-var">l0''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680992501"><span class="hs-identifier hs-var">cnt</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992486"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span class="annot"><span class="hs-comment">-- |</span></span><span>
</span><span id="line-357"></span><span class="annot"><a href="Gibbon.Compiler.html#withPrintInterpProg"><span class="hs-identifier hs-type">withPrintInterpProg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Prog0"><span class="hs-identifier hs-type">L0.Prog0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Exp0"><span class="hs-identifier hs-type">L0.Exp0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span id="withPrintInterpProg"><span class="annot"><span class="annottext">withPrintInterpProg :: Prog0 -&gt; IO (Maybe (Value Exp0))
</span><a href="Gibbon.Compiler.html#withPrintInterpProg"><span class="hs-identifier hs-var hs-var">withPrintInterpProg</span></a></span></span><span> </span><span id="local-6989586621680992516"><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680992516"><span class="hs-identifier hs-var">l0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-359"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Gibbon.Common.html#dbgLvl"><span class="hs-identifier hs-var">dbgLvl</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Gibbon.Compiler.html#interpDbgLevel"><span class="hs-identifier hs-var">interpDbgLevel</span></a></span><span>
</span><span id="line-360"></span><span>  </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-361"></span><span>    </span><span class="hs-comment">-- FIXME: no command line option atm.  Just env vars.</span><span>
</span><span id="line-362"></span><span>    </span><span id="local-6989586621680992518"><span class="annot"><span class="annottext">RunConfig
</span><a href="#local-6989586621680992518"><span class="hs-identifier hs-var">runConf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; IO RunConfig
</span><a href="Gibbon.Common.html#getRunConfig"><span class="hs-identifier hs-var">getRunConfig</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-363"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680992519"><span class="annot"><span class="annottext">()
</span><a href="#local-6989586621680992519"><span class="hs-identifier hs-var">_s1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680992520"><span class="annot"><span class="annottext">Value Exp0
</span><a href="#local-6989586621680992520"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680992521"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621680992521"><span class="hs-identifier hs-var">_stdout</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">() -&gt; RunConfig -&gt; Prog0 -&gt; IO ((), Value Exp0, ByteString)
forall s e.
InterpProg s e =&gt;
s -&gt; RunConfig -&gt; Prog e -&gt; IO (s, Value e, ByteString)
</span><a href="Gibbon.Language.Syntax.html#gInterpProg"><span class="hs-identifier hs-var">gInterpProg</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RunConfig
</span><a href="#local-6989586621680992518"><span class="hs-identifier hs-var">runConf</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680992516"><span class="hs-identifier hs-var">l0</span></a></span><span>
</span><span id="line-364"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; IO ()
</span><a href="Gibbon.Common.html#dbgPrintLn"><span class="hs-identifier hs-var">dbgPrintLn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Gibbon.Compiler.html#interpDbgLevel"><span class="hs-identifier hs-var">interpDbgLevel</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; [eval] Init prog evaluated to: &quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">Value Exp0 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Value Exp0
</span><a href="#local-6989586621680992520"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-365"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Value Exp0) -&gt; IO (Maybe (Value Exp0))
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Value Exp0) -&gt; IO (Maybe (Value Exp0)))
-&gt; Maybe (Value Exp0) -&gt; IO (Maybe (Value Exp0))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Value Exp0 -&gt; Maybe (Value Exp0)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Value Exp0
</span><a href="#local-6989586621680992520"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-366"></span><span>  </span><span class="hs-keyword">else</span><span>
</span><span id="line-367"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Value Exp0) -&gt; IO (Maybe (Value Exp0))
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Value Exp0)
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span class="annot"><a href="Gibbon.Compiler.html#compileRTS"><span class="hs-identifier hs-type">compileRTS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span id="compileRTS"><span class="annot"><span class="annottext">compileRTS :: Config -&gt; IO ()
</span><a href="Gibbon.Compiler.html#compileRTS"><span class="hs-identifier hs-var hs-var">compileRTS</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span class="hs-special">{</span><span id="local-6989586621680992545"><span class="annot"><span class="annottext">Int
verbosity :: Config -&gt; Int
verbosity :: Int
</span><a href="Gibbon.Common.html#verbosity"><span class="hs-identifier hs-var hs-var">verbosity</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680992546"><span class="annot"><span class="annottext">String
optc :: Config -&gt; String
optc :: String
</span><a href="Gibbon.Common.html#optc"><span class="hs-identifier hs-var hs-var">optc</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680992547"><span class="annot"><span class="annottext">DynFlags
dynflags :: DynFlags
dynflags :: Config -&gt; DynFlags
</span><a href="#local-6989586621680992547"><span class="hs-identifier hs-var hs-var">dynflags</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-371"></span><span>  </span><span id="local-6989586621680992549"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992549"><span class="hs-identifier hs-var">gibbon_dir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="Gibbon.Compiler.html#getGibbonDir"><span class="hs-identifier hs-var">getGibbonDir</span></a></span><span>
</span><span id="line-372"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680992551"><span class="annot"><span class="annottext">rtsmk :: String
</span><a href="#local-6989586621680992551"><span class="hs-identifier hs-var hs-var">rtsmk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992549"><span class="hs-identifier hs-var">gibbon_dir</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/filepath-1.4.2.2/src/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;gibbon-rts/Makefile&quot;</span></span><span>
</span><span id="line-373"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680992552"><span class="annot"><span class="annottext">rtsmkcmd :: String
</span><a href="#local-6989586621680992552"><span class="hs-identifier hs-var hs-var">rtsmkcmd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;make -f &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992551"><span class="hs-identifier hs-var">rtsmk</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-374"></span><span>                 </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680992553"><span class="hs-identifier hs-var">rts_debug</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; MODE=debug &quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; MODE=release &quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>                 </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680992553"><span class="hs-identifier hs-var">rts_debug</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680992554"><span class="hs-identifier hs-var">pointer</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -DGC_DEBUG &quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>                 </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680992556"><span class="hs-identifier hs-var">genGC</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; GC=nongen &quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; GC=gen &quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>                 </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680992557"><span class="hs-identifier hs-var">print_gc_stats</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; GCSTATS=1 &quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>                 </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680992554"><span class="hs-identifier hs-var">pointer</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; POINTER=1 &quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>                 </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680992558"><span class="hs-identifier hs-var">parallel</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; PARALLEL=1 &quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>                 </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680992559"><span class="hs-identifier hs-var">bumpAlloc</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; BUMPALLOC=1 &quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>                 </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; USER_CFLAGS=\&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992546"><span class="hs-identifier hs-var">optc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span>                 </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; VERBOSITY=&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680992545"><span class="hs-identifier hs-var">verbosity</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>  </span><span class="annot"><span class="annottext">Maybe String -&gt; String -&gt; String -&gt; String -&gt; IO ()
</span><a href="Gibbon.Compiler.html#execCmd"><span class="hs-identifier hs-var">execCmd</span></a></span><span>
</span><span id="line-384"></span><span>    </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-385"></span><span>    </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992552"><span class="hs-identifier hs-var">rtsmkcmd</span></a></span><span>
</span><span id="line-386"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Compiling RTS\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~&quot;</span></span><span>
</span><span id="line-387"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;codegen: C RTS could not be compiled: &quot;</span></span><span>
</span><span id="line-388"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-389"></span><span>    </span><span id="local-6989586621680992559"><span class="annot"><span class="annottext">bumpAlloc :: Bool
</span><a href="#local-6989586621680992559"><span class="hs-identifier hs-var hs-var">bumpAlloc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_BumpAlloc"><span class="hs-identifier hs-var">Opt_BumpAlloc</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680992547"><span class="hs-identifier hs-var">dynflags</span></a></span><span>
</span><span id="line-390"></span><span>    </span><span id="local-6989586621680992554"><span class="annot"><span class="annottext">pointer :: Bool
</span><a href="#local-6989586621680992554"><span class="hs-identifier hs-var hs-var">pointer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_Pointer"><span class="hs-identifier hs-var">Opt_Pointer</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680992547"><span class="hs-identifier hs-var">dynflags</span></a></span><span>
</span><span id="line-391"></span><span>    </span><span id="local-6989586621680992564"><span class="annot"><span class="annottext">warnc :: Bool
</span><a href="#local-6989586621680992564"><span class="hs-identifier hs-var hs-var">warnc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_Warnc"><span class="hs-identifier hs-var">Opt_Warnc</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680992547"><span class="hs-identifier hs-var">dynflags</span></a></span><span>
</span><span id="line-392"></span><span>    </span><span id="local-6989586621680992558"><span class="annot"><span class="annottext">parallel :: Bool
</span><a href="#local-6989586621680992558"><span class="hs-identifier hs-var hs-var">parallel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_Parallel"><span class="hs-identifier hs-var">Opt_Parallel</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680992547"><span class="hs-identifier hs-var">dynflags</span></a></span><span>
</span><span id="line-393"></span><span>    </span><span id="local-6989586621680992553"><span class="annot"><span class="annottext">rts_debug :: Bool
</span><a href="#local-6989586621680992553"><span class="hs-identifier hs-var hs-var">rts_debug</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_RtsDebug"><span class="hs-identifier hs-var">Opt_RtsDebug</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680992547"><span class="hs-identifier hs-var">dynflags</span></a></span><span>
</span><span id="line-394"></span><span>    </span><span id="local-6989586621680992557"><span class="annot"><span class="annottext">print_gc_stats :: Bool
</span><a href="#local-6989586621680992557"><span class="hs-identifier hs-var hs-var">print_gc_stats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_PrintGcStats"><span class="hs-identifier hs-var">Opt_PrintGcStats</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680992547"><span class="hs-identifier hs-var">dynflags</span></a></span><span>
</span><span id="line-395"></span><span>    </span><span id="local-6989586621680992556"><span class="annot"><span class="annottext">genGC :: Bool
</span><a href="#local-6989586621680992556"><span class="hs-identifier hs-var hs-var">genGC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_GenGc"><span class="hs-identifier hs-var">Opt_GenGc</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680992547"><span class="hs-identifier hs-var">dynflags</span></a></span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="hs-comment">-- | Compile and run the generated code if appropriate</span><span>
</span><span id="line-399"></span><span class="hs-comment">--</span><span>
</span><span id="line-400"></span><span class="annot"><a href="Gibbon.Compiler.html#compileAndRunExe"><span class="hs-identifier hs-type">compileAndRunExe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-401"></span><span id="compileAndRunExe"><span class="annot"><span class="annottext">compileAndRunExe :: Config -&gt; String -&gt; IO String
</span><a href="Gibbon.Compiler.html#compileAndRunExe"><span class="hs-identifier hs-var hs-var">compileAndRunExe</span></a></span></span><span> </span><span id="local-6989586621680992615"><span class="annot"><span class="annottext">cfg :: Config
</span><a href="#local-6989586621680992615"><span class="hs-identifier hs-var">cfg</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Common.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span class="hs-special">{</span><span id="local-6989586621680992616"><span class="annot"><span class="annottext">Backend
backend :: Config -&gt; Backend
backend :: Backend
</span><a href="Gibbon.Common.html#backend"><span class="hs-identifier hs-var hs-var">backend</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680992617"><span class="annot"><span class="annottext">Maybe String
arrayInput :: Maybe String
arrayInput :: Config -&gt; Maybe String
</span><a href="#local-6989586621680992617"><span class="hs-identifier hs-var hs-var">arrayInput</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680992619"><span class="annot"><span class="annottext">Maybe String
benchInput :: Maybe String
benchInput :: Config -&gt; Maybe String
</span><a href="#local-6989586621680992619"><span class="hs-identifier hs-var hs-var">benchInput</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680992621"><span class="annot"><span class="annottext">Mode
mode :: Config -&gt; Mode
mode :: Mode
</span><a href="Gibbon.Common.html#mode"><span class="hs-identifier hs-var hs-var">mode</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680992622"><span class="annot"><span class="annottext">Maybe String
cfile :: Config -&gt; Maybe String
cfile :: Maybe String
</span><a href="Gibbon.Common.html#cfile"><span class="hs-identifier hs-var hs-var">cfile</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680992623"><span class="annot"><span class="annottext">Maybe String
exefile :: Config -&gt; Maybe String
exefile :: Maybe String
</span><a href="Gibbon.Common.html#exefile"><span class="hs-identifier hs-var hs-var">exefile</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621680992624"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992624"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-402"></span><span>  </span><span id="local-6989586621680992625"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992625"><span class="hs-identifier hs-var">exepath</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/directory-1.3.7.1/src/System.Directory.html#makeAbsolute"><span class="hs-identifier hs-var">makeAbsolute</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992627"><span class="hs-identifier hs-var">exe</span></a></span><span>
</span><span id="line-403"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="Gibbon.Compiler.html#clearFile"><span class="hs-identifier hs-var">clearFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992625"><span class="hs-identifier hs-var">exepath</span></a></span><span>
</span><span id="line-404"></span><span>  </span><span class="hs-comment">-- (Stage 4) Codegen finished, generate a binary</span><span>
</span><span id="line-405"></span><span>  </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621680992628"><span class="hs-identifier hs-var">compile_program</span></a></span><span>
</span><span id="line-406"></span><span>  </span><span class="hs-comment">-- (Stage 5) Binary compiled, run if appropriate</span><span>
</span><span id="line-407"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680992629"><span class="annot"><span class="annottext">runExe :: String -&gt; IO String
</span><a href="#local-6989586621680992629"><span class="hs-identifier hs-var hs-var">runExe</span></a></span></span><span> </span><span id="local-6989586621680992630"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992630"><span class="hs-identifier hs-var">extra</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-408"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Handle
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680992631"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621680992631"><span class="hs-identifier hs-var">hout</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe Handle
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680992632"><span class="annot"><span class="annottext">ProcessHandle
</span><a href="#local-6989586621680992632"><span class="hs-identifier hs-var">phandle</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CreateProcess
-&gt; IO (Maybe Handle, Maybe Handle, Maybe Handle, ProcessHandle)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/process-1.6.16.0/src/System.Process.html#createProcess"><span class="hs-identifier hs-var">createProcess</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; CreateProcess
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/process-1.6.16.0/src/System.Process.html#shell"><span class="hs-identifier hs-var">shell</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992625"><span class="hs-identifier hs-var">exepath</span></a></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992630"><span class="hs-identifier hs-var">extra</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>                                      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">std_out :: StdStream
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/process-1.6.16.0/src/System.Process.Common.html#std_out"><span class="hs-identifier hs-var">std_out</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StdStream
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/process-1.6.16.0/src/System.Process.Common.html#CreatePipe"><span class="hs-identifier hs-var">CreatePipe</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-410"></span><span>        </span><span id="local-6989586621680992637"><span class="annot"><span class="annottext">ExitCode
</span><a href="#local-6989586621680992637"><span class="hs-identifier hs-var">exitCode</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ProcessHandle -&gt; IO ExitCode
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/process-1.6.16.0/src/System.Process.html#waitForProcess"><span class="hs-identifier hs-var">waitForProcess</span></a></span><span> </span><span class="annot"><span class="annottext">ProcessHandle
</span><a href="#local-6989586621680992632"><span class="hs-identifier hs-var">phandle</span></a></span><span>
</span><span id="line-411"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ExitCode
</span><a href="#local-6989586621680992637"><span class="hs-identifier hs-var">exitCode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-412"></span><span>            </span><span class="annot"><span class="annottext">ExitCode
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.Exception.html#ExitSuccess"><span class="hs-identifier hs-var">ExitSuccess</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.Handle.Text.html#hGetContents"><span class="hs-identifier hs-var">hGetContents</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621680992631"><span class="hs-identifier hs-var">hout</span></a></span><span>
</span><span id="line-413"></span><span>            </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.Exception.html#ExitFailure"><span class="hs-identifier hs-type">ExitFailure</span></a></span><span> </span><span id="local-6989586621680992642"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680992642"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
forall a. String -&gt; IO a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/System.Exit.html#die"><span class="hs-identifier hs-var">die</span></a></span><span class="annot"><span class="annottext">(String -&gt; IO String) -&gt; String -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Treelang program exited with error code  &quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680992642"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-414"></span><span>  </span><span id="local-6989586621680992644"><span class="annot"><span class="annottext">RunConfig
</span><a href="#local-6989586621680992644"><span class="hs-identifier hs-var">runConf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; IO RunConfig
</span><a href="Gibbon.Common.html#getRunConfig"><span class="hs-identifier hs-var">getRunConfig</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- FIXME: no command line option atm.  Just env vars.</span><span>
</span><span id="line-415"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621680992619"><span class="hs-identifier hs-var">benchInput</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-416"></span><span>    </span><span class="hs-comment">-- CONVENTION: In benchmark mode we expect the generated executable to take 2 extra params:</span><span>
</span><span id="line-417"></span><span>    </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Mode -&gt; Bool
</span><a href="Gibbon.Compiler.html#isBench"><span class="hs-identifier hs-var">isBench</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621680992621"><span class="hs-identifier hs-var">mode</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621680992617"><span class="hs-identifier hs-var">arrayInput</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-418"></span><span>                                 </span><span class="annot"><span class="annottext">Maybe String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
</span><a href="#local-6989586621680992629"><span class="hs-identifier hs-var">runExe</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO String) -&gt; String -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RunConfig -&gt; Int
</span><a href="Gibbon.Common.html#rcSize"><span class="hs-identifier hs-var">rcSize</span></a></span><span> </span><span class="annot"><span class="annottext">RunConfig
</span><a href="#local-6989586621680992644"><span class="hs-identifier hs-var">runConf</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RunConfig -&gt; Word64
</span><a href="Gibbon.Common.html#rcIters"><span class="hs-identifier hs-var">rcIters</span></a></span><span> </span><span class="annot"><span class="annottext">RunConfig
</span><a href="#local-6989586621680992644"><span class="hs-identifier hs-var">runConf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span>                                 </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680992647"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992647"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
</span><a href="#local-6989586621680992629"><span class="hs-identifier hs-var">runExe</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO String) -&gt; String -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;--array-input &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992647"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span>  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RunConfig -&gt; Int
</span><a href="Gibbon.Common.html#rcSize"><span class="hs-identifier hs-var">rcSize</span></a></span><span> </span><span class="annot"><span class="annottext">RunConfig
</span><a href="#local-6989586621680992644"><span class="hs-identifier hs-var">runConf</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RunConfig -&gt; Word64
</span><a href="Gibbon.Common.html#rcIters"><span class="hs-identifier hs-var">rcIters</span></a></span><span> </span><span class="annot"><span class="annottext">RunConfig
</span><a href="#local-6989586621680992644"><span class="hs-identifier hs-var">runConf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span>    </span><span class="annot"><span class="annottext">Maybe String
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621680992621"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Mode -&gt; Mode -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="Gibbon.Common.html#RunExe"><span class="hs-identifier hs-var">RunExe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621680992617"><span class="hs-identifier hs-var">arrayInput</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-421"></span><span>                                 </span><span class="annot"><span class="annottext">Maybe String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
</span><a href="#local-6989586621680992629"><span class="hs-identifier hs-var">runExe</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-422"></span><span>                                 </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680992648"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992648"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
</span><a href="#local-6989586621680992629"><span class="hs-identifier hs-var">runExe</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO String) -&gt; String -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;--array-input &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992648"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-423"></span><span>    </span><span class="annot"><span class="annottext">Maybe String
</span><span class="hs-identifier">_</span></span><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-424"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680992649"><span class="annot"><span class="annottext">outfile :: String
</span><a href="#local-6989586621680992649"><span class="hs-identifier hs-var hs-var">outfile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Backend -&gt; String -&gt; Maybe String -&gt; String
</span><a href="Gibbon.Compiler.html#getOutfile"><span class="hs-identifier hs-var">getOutfile</span></a></span><span> </span><span class="annot"><span class="annottext">Backend
</span><a href="#local-6989586621680992616"><span class="hs-identifier hs-var">backend</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992624"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621680992622"><span class="hs-identifier hs-var">cfile</span></a></span><span>
</span><span id="line-425"></span><span>        </span><span id="local-6989586621680992627"><span class="annot"><span class="annottext">exe :: String
</span><a href="#local-6989586621680992627"><span class="hs-identifier hs-var hs-var">exe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Backend -&gt; String -&gt; Maybe String -&gt; String
</span><a href="Gibbon.Compiler.html#getExeFile"><span class="hs-identifier hs-var">getExeFile</span></a></span><span> </span><span class="annot"><span class="annottext">Backend
</span><a href="#local-6989586621680992616"><span class="hs-identifier hs-var">backend</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992624"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621680992623"><span class="hs-identifier hs-var">exefile</span></a></span><span>
</span><span id="line-426"></span><span>        </span><span id="local-6989586621680992651"><span class="annot"><span class="annottext">pointer :: Bool
</span><a href="#local-6989586621680992651"><span class="hs-identifier hs-var hs-var">pointer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_Pointer"><span class="hs-identifier hs-var">Opt_Pointer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Config -&gt; DynFlags
</span><a href="Gibbon.Common.html#dynflags"><span class="hs-identifier hs-var">dynflags</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680992615"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>        </span><span id="local-6989586621680992652"><span class="annot"><span class="annottext">links :: String
</span><a href="#local-6989586621680992652"><span class="hs-identifier hs-var hs-var">links</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680992651"><span class="hs-identifier hs-var">pointer</span></a></span><span>
</span><span id="line-428"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -lgc -lm &quot;</span></span><span>
</span><span id="line-429"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -lm &quot;</span></span><span>
</span><span id="line-430"></span><span>        </span><span id="local-6989586621680992628"><span class="annot"><span class="annottext">compile_program :: IO ()
</span><a href="#local-6989586621680992628"><span class="hs-identifier hs-var hs-var">compile_program</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-431"></span><span>            </span><span class="annot"><span class="annottext">Config -&gt; IO ()
</span><a href="Gibbon.Compiler.html#compileRTS"><span class="hs-identifier hs-var">compileRTS</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680992615"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-432"></span><span>            </span><span id="local-6989586621680992653"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992653"><span class="hs-identifier hs-var">lib_dir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="Gibbon.Compiler.html#getRTSBuildDir"><span class="hs-identifier hs-var">getRTSBuildDir</span></a></span><span>
</span><span id="line-433"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680992655"><span class="annot"><span class="annottext">rts_o_path :: String
</span><a href="#local-6989586621680992655"><span class="hs-identifier hs-var hs-var">rts_o_path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992653"><span class="hs-identifier hs-var">lib_dir</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/filepath-1.4.2.2/src/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;gibbon_rts.o&quot;</span></span><span>
</span><span id="line-434"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680992656"><span class="annot"><span class="annottext">compile_prog_cmd :: String
</span><a href="#local-6989586621680992656"><span class="hs-identifier hs-var hs-var">compile_prog_cmd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Backend -&gt; Config -&gt; String
</span><a href="Gibbon.Compiler.html#compilationCmd"><span class="hs-identifier hs-var">compilationCmd</span></a></span><span> </span><span class="annot"><span class="annottext">Backend
</span><a href="#local-6989586621680992616"><span class="hs-identifier hs-var">backend</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680992615"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-435"></span><span>                                   </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -o &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992627"><span class="hs-identifier hs-var">exe</span></a></span><span>
</span><span id="line-436"></span><span>                                   </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -I&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992653"><span class="hs-identifier hs-var">lib_dir</span></a></span><span>
</span><span id="line-437"></span><span>                                   </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -L&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992653"><span class="hs-identifier hs-var">lib_dir</span></a></span><span>
</span><span id="line-438"></span><span>                                   </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -Wl,-rpath=&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992653"><span class="hs-identifier hs-var">lib_dir</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-439"></span><span>                                   </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992649"><span class="hs-identifier hs-var">outfile</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992655"><span class="hs-identifier hs-var">rts_o_path</span></a></span><span>
</span><span id="line-440"></span><span>                                   </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992652"><span class="hs-identifier hs-var">links</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -lgibbon_rts_ng&quot;</span></span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span>            </span><span class="annot"><span class="annottext">Maybe String -&gt; String -&gt; String -&gt; String -&gt; IO ()
</span><a href="Gibbon.Compiler.html#execCmd"><span class="hs-identifier hs-var">execCmd</span></a></span><span>
</span><span id="line-443"></span><span>              </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-444"></span><span>              </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992656"><span class="hs-identifier hs-var">compile_prog_cmd</span></a></span><span>
</span><span id="line-445"></span><span>              </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Compiling the program\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~&quot;</span></span><span>
</span><span id="line-446"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Backend -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Backend
</span><a href="#local-6989586621680992616"><span class="hs-identifier hs-var">backend</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; compiler failed! &quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-447"></span><span>            </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-448"></span><span>
</span><span id="line-449"></span><span class="annot"><a href="Gibbon.Compiler.html#getGibbonDir"><span class="hs-identifier hs-type">getGibbonDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-450"></span><span id="getGibbonDir"><span class="annot"><span class="annottext">getGibbonDir :: IO String
</span><a href="Gibbon.Compiler.html#getGibbonDir"><span class="hs-identifier hs-var hs-var">getGibbonDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-451"></span><span>  </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680992663"><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621680992663"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [(String, String)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/System.Environment.html#getEnvironment"><span class="hs-identifier hs-var">getEnvironment</span></a></span><span>
</span><span id="line-452"></span><span>     </span><span class="annot"><span class="annottext">String -&gt; IO String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/directory-1.3.7.1/src/System.Directory.html#makeAbsolute"><span class="hs-identifier hs-var">makeAbsolute</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO String) -&gt; String -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; [(String, String)] -&gt; Maybe String
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#lookup"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;GIBBONDIR&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621680992663"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-453"></span><span>       </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680992666"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992666"><span class="hs-identifier hs-var">p</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992666"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-454"></span><span>       </span><span class="hs-comment">-- Otherwise, assume we're running from the compiler dir!</span><span>
</span><span id="line-455"></span><span>       </span><span class="annot"><span class="annottext">Maybe String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;./&quot;</span></span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span class="annot"><a href="Gibbon.Compiler.html#getRTSBuildDir"><span class="hs-identifier hs-type">getRTSBuildDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-458"></span><span id="getRTSBuildDir"><span class="annot"><span class="annottext">getRTSBuildDir :: IO String
</span><a href="Gibbon.Compiler.html#getRTSBuildDir"><span class="hs-identifier hs-var hs-var">getRTSBuildDir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-459"></span><span>  </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680992674"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992674"><span class="hs-identifier hs-var">gibbon_dir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="Gibbon.Compiler.html#getGibbonDir"><span class="hs-identifier hs-var">getGibbonDir</span></a></span><span>
</span><span id="line-460"></span><span>     </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680992675"><span class="annot"><span class="annottext">build_dir :: String
</span><a href="#local-6989586621680992675"><span class="hs-identifier hs-var hs-var">build_dir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992674"><span class="hs-identifier hs-var">gibbon_dir</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/filepath-1.4.2.2/src/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;gibbon-rts/build&quot;</span></span><span>
</span><span id="line-461"></span><span>     </span><span id="local-6989586621680992676"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680992676"><span class="hs-identifier hs-var">exists</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/directory-1.3.7.1/src/System.Directory.html#doesDirectoryExist"><span class="hs-identifier hs-var">doesDirectoryExist</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992675"><span class="hs-identifier hs-var">build_dir</span></a></span><span>
</span><span id="line-462"></span><span>     </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680992676"><span class="hs-identifier hs-var">exists</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;RTS build not found.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>     </span><span class="annot"><span class="annottext">String -&gt; IO String
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992675"><span class="hs-identifier hs-var">build_dir</span></a></span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span>
</span><span id="line-466"></span><span class="annot"><a href="Gibbon.Compiler.html#execCmd"><span class="hs-identifier hs-type">execCmd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span id="execCmd"><span class="annot"><span class="annottext">execCmd :: Maybe String -&gt; String -&gt; String -&gt; String -&gt; IO ()
</span><a href="Gibbon.Compiler.html#execCmd"><span class="hs-identifier hs-var hs-var">execCmd</span></a></span></span><span> </span><span id="local-6989586621680992693"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621680992693"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span id="local-6989586621680992694"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992694"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span id="local-6989586621680992695"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992695"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621680992696"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992696"><span class="hs-identifier hs-var">errmsg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-468"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; IO ()
</span><a href="Gibbon.Common.html#dbgPrintLn"><span class="hs-identifier hs-var">dbgPrintLn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992695"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-469"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; IO ()
</span><a href="Gibbon.Common.html#dbgPrintLn"><span class="hs-identifier hs-var">dbgPrintLn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992694"><span class="hs-identifier hs-var">cmd</span></a></span><span>
</span><span id="line-470"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Handle
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680992697"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621680992697"><span class="hs-identifier hs-var">hout</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680992698"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621680992698"><span class="hs-identifier hs-var">herr</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680992699"><span class="annot"><span class="annottext">ProcessHandle
</span><a href="#local-6989586621680992699"><span class="hs-identifier hs-var">phandle</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-471"></span><span>        </span><span class="annot"><span class="annottext">CreateProcess
-&gt; IO (Maybe Handle, Maybe Handle, Maybe Handle, ProcessHandle)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/process-1.6.16.0/src/System.Process.html#createProcess"><span class="hs-identifier hs-var">createProcess</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; CreateProcess
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/process-1.6.16.0/src/System.Process.html#shell"><span class="hs-identifier hs-var">shell</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992694"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">std_out :: StdStream
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/process-1.6.16.0/src/System.Process.Common.html#std_out"><span class="hs-identifier hs-var">std_out</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StdStream
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/process-1.6.16.0/src/System.Process.Common.html#CreatePipe"><span class="hs-identifier hs-var">CreatePipe</span></a></span><span>
</span><span id="line-473"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">std_err :: StdStream
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/process-1.6.16.0/src/System.Process.Common.html#std_err"><span class="hs-identifier hs-var">std_err</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StdStream
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/process-1.6.16.0/src/System.Process.Common.html#CreatePipe"><span class="hs-identifier hs-var">CreatePipe</span></a></span><span>
</span><span id="line-474"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cwd :: Maybe String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/process-1.6.16.0/src/System.Process.Common.html#cwd"><span class="hs-identifier hs-var">cwd</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621680992693"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-475"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-476"></span><span>    </span><span id="local-6989586621680992702"><span class="annot"><span class="annottext">ExitCode
</span><a href="#local-6989586621680992702"><span class="hs-identifier hs-var">exit_code</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ProcessHandle -&gt; IO ExitCode
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/process-1.6.16.0/src/System.Process.html#waitForProcess"><span class="hs-identifier hs-var">waitForProcess</span></a></span><span> </span><span class="annot"><span class="annottext">ProcessHandle
</span><a href="#local-6989586621680992699"><span class="hs-identifier hs-var">phandle</span></a></span><span>
</span><span id="line-477"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ExitCode
</span><a href="#local-6989586621680992702"><span class="hs-identifier hs-var">exit_code</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-478"></span><span>        </span><span class="annot"><span class="annottext">ExitCode
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.Exception.html#ExitSuccess"><span class="hs-identifier hs-var">ExitSuccess</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680992703"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992703"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.Handle.Text.html#hGetContents"><span class="hs-identifier hs-var">hGetContents</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621680992697"><span class="hs-identifier hs-var">hout</span></a></span><span>
</span><span id="line-479"></span><span>                          </span><span id="local-6989586621680992704"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992704"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.Handle.Text.html#hGetContents"><span class="hs-identifier hs-var">hGetContents</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621680992698"><span class="hs-identifier hs-var">herr</span></a></span><span>
</span><span id="line-480"></span><span>                          </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; IO ()
</span><a href="Gibbon.Common.html#dbgPrintLn"><span class="hs-identifier hs-var">dbgPrintLn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992703"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-481"></span><span>                          </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; IO ()
</span><a href="Gibbon.Common.html#dbgPrintLn"><span class="hs-identifier hs-var">dbgPrintLn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992704"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-482"></span><span>        </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.Exception.html#ExitFailure"><span class="hs-identifier hs-type">ExitFailure</span></a></span><span> </span><span id="local-6989586621680992705"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680992705"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680992706"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992706"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.Handle.Text.html#hGetContents"><span class="hs-identifier hs-var">hGetContents</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621680992697"><span class="hs-identifier hs-var">hout</span></a></span><span>
</span><span id="line-483"></span><span>                            </span><span id="local-6989586621680992707"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992707"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.Handle.Text.html#hGetContents"><span class="hs-identifier hs-var">hGetContents</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621680992698"><span class="hs-identifier hs-var">herr</span></a></span><span>
</span><span id="line-484"></span><span>                            </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. String -&gt; IO a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/System.Exit.html#die"><span class="hs-identifier hs-var">die</span></a></span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992696"><span class="hs-identifier hs-var">errmsg</span></a></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992706"><span class="hs-identifier hs-var">out</span></a></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992707"><span class="hs-identifier hs-var">err</span></a></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\nCode: &quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680992705"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span>
</span><span id="line-487"></span><span>
</span><span id="line-488"></span><span class="hs-comment">-- | Return the correct filename to store the generated code,</span><span>
</span><span id="line-489"></span><span class="hs-comment">-- based on the backend used, and override options specified</span><span>
</span><span id="line-490"></span><span class="hs-comment">--</span><span>
</span><span id="line-491"></span><span class="annot"><a href="Gibbon.Compiler.html#getOutfile"><span class="hs-identifier hs-type">getOutfile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-492"></span><span id="getOutfile"><span class="annot"><span class="annottext">getOutfile :: Backend -&gt; String -&gt; Maybe String -&gt; String
</span><a href="Gibbon.Compiler.html#getOutfile"><span class="hs-identifier hs-var hs-var">getOutfile</span></a></span></span><span> </span><span class="annot"><span class="annottext">Backend
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680992708"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992708"><span class="hs-identifier hs-var">override</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992708"><span class="hs-identifier hs-var">override</span></a></span><span>
</span><span id="line-493"></span><span class="annot"><a href="Gibbon.Compiler.html#getOutfile"><span class="hs-identifier hs-var">getOutfile</span></a></span><span> </span><span id="local-6989586621680992709"><span class="annot"><span class="annottext">Backend
</span><a href="#local-6989586621680992709"><span class="hs-identifier hs-var">backend</span></a></span></span><span> </span><span id="local-6989586621680992710"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992710"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-494"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/filepath-1.4.2.2/src/System.FilePath.Posix.html#replaceExtension"><span class="hs-identifier hs-var">replaceExtension</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992710"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-495"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Backend
</span><a href="#local-6989586621680992709"><span class="hs-identifier hs-var">backend</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-496"></span><span>      </span><span class="annot"><span class="annottext">Backend
</span><a href="Gibbon.Common.html#C"><span class="hs-identifier hs-var">C</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.c&quot;</span></span><span>
</span><span id="line-497"></span><span>      </span><span class="annot"><span class="annottext">Backend
</span><a href="Gibbon.Common.html#LLVM"><span class="hs-identifier hs-var">LLVM</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.ll&quot;</span></span><span>
</span><span id="line-498"></span><span>
</span><span id="line-499"></span><span class="hs-comment">-- | Return the correct filename for the generated exe,</span><span>
</span><span id="line-500"></span><span class="hs-comment">-- based on the backend used, and override options specified</span><span>
</span><span id="line-501"></span><span class="hs-comment">--</span><span>
</span><span id="line-502"></span><span class="annot"><a href="Gibbon.Compiler.html#getExeFile"><span class="hs-identifier hs-type">getExeFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-503"></span><span id="getExeFile"><span class="annot"><span class="annottext">getExeFile :: Backend -&gt; String -&gt; Maybe String -&gt; String
</span><a href="Gibbon.Compiler.html#getExeFile"><span class="hs-identifier hs-var hs-var">getExeFile</span></a></span></span><span> </span><span class="annot"><span class="annottext">Backend
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680992714"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992714"><span class="hs-identifier hs-var">override</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992714"><span class="hs-identifier hs-var">override</span></a></span><span>
</span><span id="line-504"></span><span class="annot"><a href="Gibbon.Compiler.html#getExeFile"><span class="hs-identifier hs-var">getExeFile</span></a></span><span> </span><span id="local-6989586621680992715"><span class="annot"><span class="annottext">Backend
</span><a href="#local-6989586621680992715"><span class="hs-identifier hs-var">backend</span></a></span></span><span> </span><span id="local-6989586621680992716"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992716"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-505"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680992717"><span class="annot"><span class="annottext">fp' :: String
</span><a href="#local-6989586621680992717"><span class="hs-identifier hs-var hs-var">fp'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Backend
</span><a href="#local-6989586621680992715"><span class="hs-identifier hs-var">backend</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-506"></span><span>               </span><span class="annot"><span class="annottext">Backend
</span><a href="Gibbon.Common.html#C"><span class="hs-identifier hs-var">C</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992716"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-507"></span><span>               </span><span class="annot"><span class="annottext">Backend
</span><a href="Gibbon.Common.html#LLVM"><span class="hs-identifier hs-var">LLVM</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/filepath-1.4.2.2/src/System.FilePath.Posix.html#replaceFileName"><span class="hs-identifier hs-var">replaceFileName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992716"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/filepath-1.4.2.2/src/System.FilePath.Posix.html#takeBaseName"><span class="hs-identifier hs-var">takeBaseName</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992716"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_llvm&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/filepath-1.4.2.2/src/System.FilePath.Posix.html#replaceExtension"><span class="hs-identifier hs-var">replaceExtension</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992717"><span class="hs-identifier hs-var">fp'</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.exe&quot;</span></span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span class="hs-comment">-- | Compilation command</span><span>
</span><span id="line-511"></span><span class="hs-comment">--</span><span>
</span><span id="line-512"></span><span class="annot"><a href="Gibbon.Compiler.html#compilationCmd"><span class="hs-identifier hs-type">compilationCmd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Backend"><span class="hs-identifier hs-type">Backend</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-513"></span><span id="compilationCmd"><span class="annot"><span class="annottext">compilationCmd :: Backend -&gt; Config -&gt; String
</span><a href="Gibbon.Compiler.html#compilationCmd"><span class="hs-identifier hs-var hs-var">compilationCmd</span></a></span></span><span> </span><span class="annot"><span class="annottext">Backend
</span><a href="Gibbon.Common.html#LLVM"><span class="hs-identifier hs-var">LLVM</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;clang-5.0 lib.o &quot;</span></span><span>
</span><span id="line-514"></span><span class="annot"><a href="Gibbon.Compiler.html#compilationCmd"><span class="hs-identifier hs-var">compilationCmd</span></a></span><span> </span><span class="annot"><span class="annottext">Backend
</span><a href="Gibbon.Common.html#C"><span class="hs-identifier hs-var">C</span></a></span><span> </span><span id="local-6989586621680992741"><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680992741"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Config -&gt; String
</span><a href="Gibbon.Common.html#cc"><span class="hs-identifier hs-var">cc</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680992741"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -std=gnu11 &quot;</span></span><span>
</span><span id="line-515"></span><span>                          </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680992742"><span class="hs-identifier hs-var">bumpAlloc</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -D_GIBBON_BUMPALLOC_LISTS -D_GIBBON_BUMPALLOC_HEAP &quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-516"></span><span>                          </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680992743"><span class="hs-identifier hs-var">pointer</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -D_GIBBON_POINTER &quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span>                          </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680992744"><span class="hs-identifier hs-var">parallel</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -fcilkplus -D_GIBBON_PARALLEL &quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-518"></span><span>                          </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680992745"><span class="hs-identifier hs-var">warnc</span></a></span><span>
</span><span id="line-519"></span><span>                             </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -Wno-unused-variable -Wno-unused-label -Wall -Wextra -Wpedantic &quot;</span></span><span>
</span><span id="line-520"></span><span>                             </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Gibbon.Compiler.html#suppress_warnings"><span class="hs-identifier hs-var">suppress_warnings</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-521"></span><span>                          </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Config -&gt; String
</span><a href="Gibbon.Common.html#optc"><span class="hs-identifier hs-var">optc</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680992741"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-522"></span><span>                          </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680992746"><span class="hs-identifier hs-var">rts_debug</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -D_GIBBON_DEBUG -D_GIBBON_VERBOSITY=3 -O0 -g&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-523"></span><span>                          </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680992746"><span class="hs-identifier hs-var">rts_debug</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680992743"><span class="hs-identifier hs-var">pointer</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -DGC_DEBUG &quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-524"></span><span>                          </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680992747"><span class="hs-identifier hs-var">print_gc_stats</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -D_GIBBON_GCSTATS &quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-525"></span><span>                          </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680992748"><span class="hs-identifier hs-var">genGC</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -D_GIBBON_GENGC=0 &quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -D_GIBBON_GENGC=1 &quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-526"></span><span>                          </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680992749"><span class="hs-identifier hs-var">simpleWriteBarrier</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -D_GIBBON_SIMPLE_WRITE_BARRIER=1 &quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -D_GIBBON_SIMPLE_WRITE_BARRIER=0 &quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-527"></span><span>                          </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680992750"><span class="hs-identifier hs-var">lazyPromote</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -D_GIBBON_EAGER_PROMOTION=0 &quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -D_GIBBON_EAGER_PROMOTION=1 &quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-528"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621680992751"><span class="annot"><span class="annottext">dflags :: DynFlags
</span><a href="#local-6989586621680992751"><span class="hs-identifier hs-var hs-var">dflags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Config -&gt; DynFlags
</span><a href="Gibbon.Common.html#dynflags"><span class="hs-identifier hs-var">dynflags</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680992741"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-529"></span><span>        </span><span id="local-6989586621680992742"><span class="annot"><span class="annottext">bumpAlloc :: Bool
</span><a href="#local-6989586621680992742"><span class="hs-identifier hs-var hs-var">bumpAlloc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_BumpAlloc"><span class="hs-identifier hs-var">Opt_BumpAlloc</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680992751"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-530"></span><span>        </span><span id="local-6989586621680992743"><span class="annot"><span class="annottext">pointer :: Bool
</span><a href="#local-6989586621680992743"><span class="hs-identifier hs-var hs-var">pointer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_Pointer"><span class="hs-identifier hs-var">Opt_Pointer</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680992751"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-531"></span><span>        </span><span id="local-6989586621680992745"><span class="annot"><span class="annottext">warnc :: Bool
</span><a href="#local-6989586621680992745"><span class="hs-identifier hs-var hs-var">warnc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_Warnc"><span class="hs-identifier hs-var">Opt_Warnc</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680992751"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-532"></span><span>        </span><span id="local-6989586621680992744"><span class="annot"><span class="annottext">parallel :: Bool
</span><a href="#local-6989586621680992744"><span class="hs-identifier hs-var hs-var">parallel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_Parallel"><span class="hs-identifier hs-var">Opt_Parallel</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680992751"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-533"></span><span>        </span><span id="local-6989586621680992746"><span class="annot"><span class="annottext">rts_debug :: Bool
</span><a href="#local-6989586621680992746"><span class="hs-identifier hs-var hs-var">rts_debug</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_RtsDebug"><span class="hs-identifier hs-var">Opt_RtsDebug</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680992751"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-534"></span><span>        </span><span id="local-6989586621680992747"><span class="annot"><span class="annottext">print_gc_stats :: Bool
</span><a href="#local-6989586621680992747"><span class="hs-identifier hs-var hs-var">print_gc_stats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_PrintGcStats"><span class="hs-identifier hs-var">Opt_PrintGcStats</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680992751"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-535"></span><span>        </span><span id="local-6989586621680992748"><span class="annot"><span class="annottext">genGC :: Bool
</span><a href="#local-6989586621680992748"><span class="hs-identifier hs-var hs-var">genGC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_GenGc"><span class="hs-identifier hs-var">Opt_GenGc</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680992751"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-536"></span><span>        </span><span id="local-6989586621680992749"><span class="annot"><span class="annottext">simpleWriteBarrier :: Bool
</span><a href="#local-6989586621680992749"><span class="hs-identifier hs-var hs-var">simpleWriteBarrier</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_SimpleWriteBarrier"><span class="hs-identifier hs-var">Opt_SimpleWriteBarrier</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680992751"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-537"></span><span>        </span><span id="local-6989586621680992750"><span class="annot"><span class="annottext">lazyPromote :: Bool
</span><a href="#local-6989586621680992750"><span class="hs-identifier hs-var hs-var">lazyPromote</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_NoEagerPromote"><span class="hs-identifier hs-var">Opt_NoEagerPromote</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680992751"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-538"></span><span>
</span><span id="line-539"></span><span class="annot"><span class="hs-comment">-- |</span></span><span>
</span><span id="line-540"></span><span class="annot"><a href="Gibbon.Compiler.html#isBench"><span class="hs-identifier hs-type">isBench</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-541"></span><span id="isBench"><span class="annot"><span class="annottext">isBench :: Mode -&gt; Bool
</span><a href="Gibbon.Compiler.html#isBench"><span class="hs-identifier hs-var hs-var">isBench</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Bench"><span class="hs-identifier hs-type">Bench</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-542"></span><span class="annot"><a href="Gibbon.Compiler.html#isBench"><span class="hs-identifier hs-var">isBench</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-543"></span><span>
</span><span id="line-544"></span><span class="annot"><span class="hs-comment">-- | The debug level at which we start to call the interpreter on the program during compilation.</span></span><span>
</span><span id="line-545"></span><span class="annot"><a href="Gibbon.Compiler.html#interpDbgLevel"><span class="hs-identifier hs-type">interpDbgLevel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-546"></span><span id="interpDbgLevel"><span class="annot"><span class="annottext">interpDbgLevel :: Int
</span><a href="Gibbon.Compiler.html#interpDbgLevel"><span class="hs-identifier hs-var hs-var">interpDbgLevel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span class="annot"><span class="hs-comment">-- |</span></span><span>
</span><span id="line-549"></span><span class="annot"><a href="Gibbon.Compiler.html#clearFile"><span class="hs-identifier hs-type">clearFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-550"></span><span id="clearFile"><span class="annot"><span class="annottext">clearFile :: String -&gt; IO ()
</span><a href="Gibbon.Compiler.html#clearFile"><span class="hs-identifier hs-var hs-var">clearFile</span></a></span></span><span> </span><span id="local-6989586621680992756"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992756"><span class="hs-identifier hs-var">fileName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/directory-1.3.7.1/src/System.Directory.html#removeFile"><span class="hs-identifier hs-var">removeFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992756"><span class="hs-identifier hs-var">fileName</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; (IOError -&gt; IO ()) -&gt; IO ()
forall e a. Exception e =&gt; IO a -&gt; (e -&gt; IO a) -&gt; IO a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.html#catch"><span class="hs-operator hs-var">`catch`</span></a></span><span> </span><span class="annot"><span class="annottext">IOError -&gt; IO ()
</span><a href="#local-6989586621680992759"><span class="hs-identifier hs-var">handleErr</span></a></span><span>
</span><span id="line-551"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-552"></span><span>   </span><span id="local-6989586621680992759"><span class="annot"><span class="annottext">handleErr :: IOError -&gt; IO ()
</span><a href="#local-6989586621680992759"><span class="hs-identifier hs-var hs-var">handleErr</span></a></span></span><span> </span><span id="local-6989586621680992762"><span class="annot"><span class="annottext">IOError
</span><a href="#local-6989586621680992762"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">IOError -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/System.IO.Error.html#isDoesNotExistError"><span class="hs-identifier hs-var">isDoesNotExistError</span></a></span><span> </span><span class="annot"><span class="annottext">IOError
</span><a href="#local-6989586621680992762"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-553"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IOError -&gt; IO ()
forall e a. Exception e =&gt; e -&gt; IO a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.html#throwIO"><span class="hs-identifier hs-var">throwIO</span></a></span><span> </span><span class="annot"><span class="annottext">IOError
</span><a href="#local-6989586621680992762"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-554"></span><span>
</span><span id="line-555"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-556"></span><span>
</span><span id="line-557"></span><span class="annot"><span class="hs-comment">-- | SML Codegen</span></span><span>
</span><span id="line-558"></span><span>
</span><span id="line-559"></span><span class="annot"><a href="Gibbon.Compiler.html#mplCompiler"><span class="hs-identifier hs-type">mplCompiler</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-560"></span><span id="mplCompiler"><span class="annot"><span class="annottext">mplCompiler :: String
</span><a href="Gibbon.Compiler.html#mplCompiler"><span class="hs-identifier hs-var hs-var">mplCompiler</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mlton&quot;</span></span><span>  </span><span class="hs-comment">-- temporary until mpl is installed</span><span>
</span><span id="line-561"></span><span>
</span><span id="line-562"></span><span id="local-6989586621680991756"><span id="local-6989586621680991757"><span id="local-6989586621680991758"><span id="local-6989586621680991759"><span class="annot"><a href="Gibbon.Compiler.html#goIO"><span class="hs-identifier hs-type">goIO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991756"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680991757"><span class="hs-identifier hs-type">a1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680991756"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991758"><span class="hs-identifier hs-type">a2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Strict.html#StateT"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991759"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991756"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991757"><span class="hs-identifier hs-type">a1</span></a></span></span></span></span></span><span>
</span><span id="line-563"></span><span id="goIO"><span class="annot"><span class="annottext">goIO :: forall (m :: * -&gt; *) a1 a2 b.
Functor m =&gt;
a1 -&gt; m a2 -&gt; StateT b m a1
</span><a href="Gibbon.Compiler.html#goIO"><span class="hs-identifier hs-var hs-var">goIO</span></a></span></span><span> </span><span id="local-6989586621680992768"><span class="annot"><span class="annottext">a1
</span><a href="#local-6989586621680992768"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span id="local-6989586621680992769"><span class="annot"><span class="annottext">m a2
</span><a href="#local-6989586621680992769"><span class="hs-identifier hs-var">io</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(b -&gt; m (a1, b)) -&gt; StateT b m a1
forall s (m :: * -&gt; *) a. (s -&gt; m (a, s)) -&gt; StateT s m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Strict.html#StateT"><span class="hs-identifier hs-var">StateT</span></a></span><span> </span><span class="annot"><span class="annottext">((b -&gt; m (a1, b)) -&gt; StateT b m a1)
-&gt; (b -&gt; m (a1, b)) -&gt; StateT b m a1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680992771"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680992771"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m a2
</span><a href="#local-6989586621680992769"><span class="hs-identifier hs-var">io</span></a></span><span> </span><span class="annot"><span class="annottext">m a2 -&gt; (a1, b) -&gt; m (a1, b)
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%24%3E"><span class="hs-operator hs-var">$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a1
</span><a href="#local-6989586621680992768"><span class="hs-identifier hs-var">prog</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680992771"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-564"></span><span>
</span><span id="line-565"></span><span class="annot"><a href="Gibbon.Compiler.html#smlExt"><span class="hs-identifier hs-type">smlExt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-566"></span><span id="smlExt"><span class="annot"><span class="annottext">smlExt :: String -&gt; String
</span><a href="Gibbon.Compiler.html#smlExt"><span class="hs-identifier hs-var hs-var">smlExt</span></a></span></span><span> </span><span id="local-6989586621680992774"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992774"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/filepath-1.4.2.2/src/System.FilePath.Posix.html#dropExtension"><span class="hs-identifier hs-var">dropExtension</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992774"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/filepath-1.4.2.2/src/System.FilePath.Posix.html#%3C.%3E"><span class="hs-operator hs-var">&lt;.&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sml&quot;</span></span><span>
</span><span id="line-567"></span><span>
</span><span id="line-568"></span><span class="annot"><a href="Gibbon.Compiler.html#toSML"><span class="hs-identifier hs-type">toSML</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Prog1"><span class="hs-identifier hs-type">L1.Prog1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-569"></span><span id="toSML"><span class="annot"><span class="annottext">toSML :: String -&gt; Prog1 -&gt; IO ()
</span><a href="Gibbon.Compiler.html#toSML"><span class="hs-identifier hs-var hs-var">toSML</span></a></span></span><span> </span><span id="local-6989586621680992778"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992778"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621680992779"><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680992779"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/System.IO.html#writeFile"><span class="hs-identifier hs-var">writeFile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="Gibbon.Compiler.html#smlExt"><span class="hs-identifier hs-var">smlExt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992778"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Doc -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/pretty-1.1.3.6/src/Text.PrettyPrint.HughesPJ.html#render"><span class="hs-identifier hs-var">render</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; String) -&gt; Doc -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Prog1 -&gt; Doc
</span><a href="Gibbon.L1.GenSML.html#ppProgram"><span class="hs-identifier hs-var">ppProgram</span></a></span><span> </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680992779"><span class="hs-identifier hs-var">prog</span></a></span><span>
</span><span id="line-570"></span><span>
</span><span id="line-571"></span><span class="annot"><a href="Gibbon.Compiler.html#compileMPL"><span class="hs-identifier hs-type">compileMPL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-572"></span><span id="compileMPL"><span class="annot"><span class="annottext">compileMPL :: String -&gt; IO ()
</span><a href="Gibbon.Compiler.html#compileMPL"><span class="hs-identifier hs-var hs-var">compileMPL</span></a></span></span><span> </span><span id="local-6989586621680992795"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992795"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-573"></span><span>  </span><span id="local-6989586621680992796"><span class="annot"><span class="annottext">ExitCode
</span><a href="#local-6989586621680992796"><span class="hs-identifier hs-var">cd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ExitCode
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/process-1.6.16.0/src/System.Process.html#system"><span class="hs-identifier hs-var">system</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ExitCode) -&gt; String -&gt; IO ExitCode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Gibbon.Compiler.html#mplCompiler"><span class="hs-identifier hs-var">mplCompiler</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="Gibbon.Compiler.html#smlExt"><span class="hs-identifier hs-var">smlExt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992795"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-574"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ExitCode
</span><a href="#local-6989586621680992796"><span class="hs-identifier hs-var">cd</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-575"></span><span>    </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.Exception.html#ExitFailure"><span class="hs-identifier hs-type">ExitFailure</span></a></span><span> </span><span id="local-6989586621680992798"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680992798"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SML compiler failed with code &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680992798"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-576"></span><span>    </span><span class="annot"><span class="annottext">ExitCode
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.Exception.html#ExitSuccess"><span class="hs-identifier hs-var">ExitSuccess</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-577"></span><span>
</span><span id="line-578"></span><span class="annot"><a href="Gibbon.Compiler.html#runMPL"><span class="hs-identifier hs-type">runMPL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-579"></span><span id="runMPL"><span class="annot"><span class="annottext">runMPL :: String -&gt; IO ()
</span><a href="Gibbon.Compiler.html#runMPL"><span class="hs-identifier hs-var hs-var">runMPL</span></a></span></span><span> </span><span id="local-6989586621680992814"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992814"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-580"></span><span>  </span><span id="local-6989586621680992815"><span class="annot"><span class="annottext">ExitCode
</span><a href="#local-6989586621680992815"><span class="hs-identifier hs-var">cd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ExitCode
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/process-1.6.16.0/src/System.Process.html#system"><span class="hs-identifier hs-var">system</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ExitCode) -&gt; String -&gt; IO ExitCode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992816"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/filepath-1.4.2.2/src/System.FilePath.Posix.html#dropExtension"><span class="hs-identifier hs-var">dropExtension</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992814"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-581"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ExitCode
</span><a href="#local-6989586621680992815"><span class="hs-identifier hs-var">cd</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-582"></span><span>    </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.Exception.html#ExitFailure"><span class="hs-identifier hs-type">ExitFailure</span></a></span><span> </span><span id="local-6989586621680992817"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680992817"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SML executable failed with code &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680992817"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-583"></span><span>    </span><span class="annot"><span class="annottext">ExitCode
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.Exception.html#ExitSuccess"><span class="hs-identifier hs-var">ExitSuccess</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-584"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-585"></span><span>    </span><span id="local-6989586621680992816"><span class="annot"><span class="annottext">prefix :: String
</span><a href="#local-6989586621680992816"><span class="hs-identifier hs-var hs-var">prefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/filepath-1.4.2.2/src/System.FilePath.Posix.html#takeDirectory"><span class="hs-identifier hs-var">takeDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992814"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-586"></span><span>      </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;./&quot;</span></span><span>
</span><span id="line-587"></span><span>      </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-588"></span><span>
</span><span id="line-589"></span><span id="local-6989586621680991772"><span id="local-6989586621680991773"><span class="annot"><a href="Gibbon.Compiler.html#goSML"><span class="hs-identifier hs-type">goSML</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Prog1"><span class="hs-identifier hs-type">L1.Prog1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991772"><span class="hs-identifier hs-type">a2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Strict.html#StateT"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991773"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Prog1"><span class="hs-identifier hs-type">L1.Prog1</span></a></span></span></span><span>
</span><span id="line-590"></span><span id="goSML"><span class="annot"><span class="annottext">goSML :: forall a2 b.
Config -&gt; Prog1 -&gt; (String -&gt; IO a2) -&gt; StateT b IO Prog1
</span><a href="Gibbon.Compiler.html#goSML"><span class="hs-identifier hs-var hs-var">goSML</span></a></span></span><span> </span><span id="local-6989586621680992822"><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680992822"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621680992823"><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680992823"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span id="local-6989586621680992824"><span class="annot"><span class="annottext">String -&gt; IO a2
</span><a href="#local-6989586621680992824"><span class="hs-identifier hs-var">acts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-591"></span><span>  </span><span class="annot"><span class="annottext">Prog1 -&gt; IO a2 -&gt; StateT b IO Prog1
forall (m :: * -&gt; *) a1 a2 b.
Functor m =&gt;
a1 -&gt; m a2 -&gt; StateT b m a1
</span><a href="Gibbon.Compiler.html#goIO"><span class="hs-identifier hs-var">goIO</span></a></span><span> </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680992823"><span class="hs-identifier hs-var">prog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Prog1 -&gt; IO ()
</span><a href="Gibbon.Compiler.html#toSML"><span class="hs-identifier hs-var">toSML</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992825"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680992823"><span class="hs-identifier hs-var">prog</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO a2 -&gt; IO a2
forall a b. IO a -&gt; IO b -&gt; IO b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2A%3E"><span class="hs-operator hs-var">*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO a2
</span><a href="#local-6989586621680992824"><span class="hs-identifier hs-var">acts</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992825"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-592"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680992825"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992825"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Config -&gt; Maybe String
</span><a href="Gibbon.Common.html#srcFile"><span class="hs-identifier hs-var">srcFile</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680992822"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-593"></span><span>
</span><span id="line-594"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span class="hs-comment">-- | Replace the main function with benchmark code</span><span>
</span><span id="line-597"></span><span class="hs-comment">--</span><span>
</span><span id="line-598"></span><span class="annot"><a href="Gibbon.Compiler.html#benchMainExp"><span class="hs-identifier hs-type">benchMainExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Prog1"><span class="hs-identifier hs-type">L1.Prog1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L1.Syntax.html#Prog1"><span class="hs-identifier hs-type">L1.Prog1</span></a></span><span>
</span><span id="line-599"></span><span id="benchMainExp"><span class="annot"><span class="annottext">benchMainExp :: Prog1 -&gt; PassM Prog1
</span><a href="Gibbon.Compiler.html#benchMainExp"><span class="hs-identifier hs-var hs-var">benchMainExp</span></a></span></span><span> </span><span id="local-6989586621680992832"><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680992832"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-600"></span><span>  </span><span class="annot"><a href="Gibbon.Common.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span class="hs-special">{</span><span id="local-6989586621680992833"><span class="annot"><span class="annottext">Maybe String
benchInput :: Config -&gt; Maybe String
benchInput :: Maybe String
</span><a href="Gibbon.Common.html#benchInput"><span class="hs-identifier hs-var hs-var">benchInput</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680992834"><span class="annot"><span class="annottext">DynFlags
dynflags :: Config -&gt; DynFlags
dynflags :: DynFlags
</span><a href="Gibbon.Common.html#dynflags"><span class="hs-identifier hs-var hs-var">dynflags</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680992835"><span class="annot"><span class="annottext">Mode
mode :: Config -&gt; Mode
mode :: Mode
</span><a href="Gibbon.Common.html#mode"><span class="hs-identifier hs-var hs-var">mode</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PassM Config
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.Reader.Class.html#ask"><span class="hs-identifier hs-var">ask</span></a></span><span>
</span><span id="line-601"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621680992835"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-602"></span><span>    </span><span class="annot"><a href="Gibbon.Common.html#Bench"><span class="hs-identifier hs-type">Bench</span></a></span><span> </span><span id="local-6989586621680992836"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680992836"><span class="hs-identifier hs-var">fnname</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-603"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680992839"><span class="annot"><span class="annottext">tmp :: String
</span><a href="#local-6989586621680992839"><span class="hs-identifier hs-var hs-var">tmp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;bnch&quot;</span></span><span>
</span><span id="line-604"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">[</span><span id="local-6989586621680992840"><span class="annot"><span class="annottext">arg :: Ty1
</span><a href="#local-6989586621680992840"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-type">L1.PackedTy</span></a></span><span> </span><span id="local-6989586621680992842"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992842"><span class="hs-identifier hs-var">tyc</span></a></span></span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621680992843"><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680992843"><span class="hs-identifier hs-var">ret</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Prog1 -&gt; ArrowTy (TyOf Exp1)
forall ex. Var -&gt; Prog ex -&gt; ArrowTy (TyOf ex)
</span><a href="Gibbon.Language.Syntax.html#getFunTy"><span class="hs-identifier hs-var">L1.getFunTy</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680992836"><span class="hs-identifier hs-var">fnname</span></a></span><span> </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680992832"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-605"></span><span>          </span><span class="hs-comment">-- At L1, we assume ReadPackedFile has a single return value:</span><span>
</span><span id="line-606"></span><span>          </span><span id="local-6989586621680992845"><span class="annot"><span class="annottext">newExp :: Exp1
</span><a href="#local-6989586621680992845"><span class="hs-identifier hs-var hs-var">newExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp1 -&gt; Ty1 -&gt; Bool -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec -&gt; dec -&gt; Bool -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-var">L1.TimeIt</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-607"></span><span>                        </span><span class="annot"><span class="annottext">(Var, [()], Ty1, Exp1) -&gt; Exp1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">L1.LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992839"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-608"></span><span>                                 </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680992840"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-609"></span><span>                                 </span><span class="annot"><span class="annottext">Prim Ty1 -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">L1.PrimAppE</span></a></span><span>
</span><span id="line-610"></span><span>                                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe String -&gt; String -&gt; Maybe Var -&gt; Ty1 -&gt; Prim Ty1
forall ty. Maybe String -&gt; String -&gt; Maybe Var -&gt; ty -&gt; Prim ty
</span><a href="Gibbon.Language.Syntax.html#ReadPackedFile"><span class="hs-identifier hs-var">L1.ReadPackedFile</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621680992833"><span class="hs-identifier hs-var">benchInput</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992842"><span class="hs-identifier hs-var">tyc</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Var
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680992840"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-611"></span><span>                        </span><span class="annot"><span class="annottext">(Exp1 -&gt; Exp1) -&gt; Exp1 -&gt; Exp1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, [()], Ty1, Exp1) -&gt; Exp1 -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
(Var, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">L1.LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;benchres&quot;</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-612"></span><span>                                      </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680992843"><span class="hs-identifier hs-var">ret</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-613"></span><span>                                      </span><span class="annot"><span class="annottext">Var -&gt; [()] -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Var -&gt; [loc] -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-var">L1.AppE</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680992836"><span class="hs-identifier hs-var">fnname</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Var -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">L1.VarE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992839"><span class="hs-identifier hs-var">tmp</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-614"></span><span>                        </span><span class="hs-comment">-- FIXME: should actually return the result,</span><span>
</span><span id="line-615"></span><span>                        </span><span class="hs-comment">-- as soon as we are able to print it.</span><span>
</span><span id="line-616"></span><span>                        </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_BenchPrint"><span class="hs-identifier hs-var">Opt_BenchPrint</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680992834"><span class="hs-identifier hs-var">dynflags</span></a></span><span>
</span><span id="line-617"></span><span>                         </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Var -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec. Var -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-var">L1.VarE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;benchres&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-618"></span><span>                         </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Prim Ty1 -&gt; [Exp1] -&gt; Exp1
forall (ext :: * -&gt; * -&gt; *) loc dec.
Prim dec -&gt; [PreExp ext loc dec] -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-var">L1.PrimAppE</span></a></span><span> </span><span class="annot"><span class="annottext">Prim Ty1
forall ty. Prim ty
</span><a href="Gibbon.Language.Syntax.html#MkTrue"><span class="hs-identifier hs-var">L1.MkTrue</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-619"></span><span>                   </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ty1
</span><a href="#local-6989586621680992843"><span class="hs-identifier hs-var">ret</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-620"></span><span>      </span><span class="hs-comment">-- Initialize the main expression with a void type. The typechecker will fix it later.</span><span>
</span><span id="line-621"></span><span>      </span><span class="annot"><span class="annottext">Prog1 -&gt; PassM Prog1
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prog1 -&gt; PassM Prog1) -&gt; Prog1 -&gt; PassM Prog1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680992832"><span class="hs-identifier hs-var">l1</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mainExp :: Maybe (Exp1, TyOf Exp1)
</span><a href="Gibbon.Language.Syntax.html#mainExp"><span class="hs-identifier hs-var">L1.mainExp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp1, Ty1) -&gt; Maybe (Exp1, Ty1)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp1
</span><a href="#local-6989586621680992845"><span class="hs-identifier hs-var">newExp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ty1
forall a. UrTy a
</span><a href="Gibbon.Language.html#voidTy"><span class="hs-identifier hs-var">L1.voidTy</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-622"></span><span>    </span><span class="annot"><span class="annottext">Mode
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prog1 -&gt; PassM Prog1
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680992832"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-623"></span><span>
</span><span id="line-624"></span><span class="annot"><a href="Gibbon.Compiler.html#addRedirectionCon"><span class="hs-identifier hs-type">addRedirectionCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Prog2"><span class="hs-identifier hs-type">L2.Prog2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Prog2"><span class="hs-identifier hs-type">L2.Prog2</span></a></span><span>
</span><span id="line-625"></span><span id="addRedirectionCon"><span class="annot"><span class="annottext">addRedirectionCon :: Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Compiler.html#addRedirectionCon"><span class="hs-identifier hs-var hs-var">addRedirectionCon</span></a></span></span><span> </span><span id="local-6989586621680992868"><span class="annot"><span class="annottext">p :: Prog2
</span><a href="#local-6989586621680992868"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span class="hs-special">{</span><span id="local-6989586621680992870"><span class="annot"><span class="annottext">DDefs (TyOf Exp2)
ddefs :: DDefs (TyOf Exp2)
ddefs :: forall ex. Prog ex -&gt; DDefs (TyOf ex)
</span><a href="#local-6989586621680992870"><span class="hs-identifier hs-var hs-var">ddefs</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-626"></span><span>  </span><span id="local-6989586621680992872"><span class="annot"><span class="annottext">Map Var (DDef (UrTy Var))
</span><a href="#local-6989586621680992872"><span class="hs-identifier hs-var">ddefs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(DDef (UrTy Var) -&gt; PassM (DDef (UrTy Var)))
-&gt; Map Var (DDef (UrTy Var)) -&gt; PassM (Map Var (DDef (UrTy Var)))
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; Map Var a -&gt; m (Map Var b)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680992874"><span class="annot"><span class="annottext">ddf :: DDef (UrTy Var)
</span><a href="#local-6989586621680992874"><span class="hs-identifier hs-var">ddf</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Language.Syntax.html#DDef"><span class="hs-identifier hs-type">DDef</span></a></span><span class="hs-special">{</span><span id="local-6989586621680992876"><span class="annot"><span class="annottext">[(String, [(Bool, UrTy Var)])]
dataCons :: [(String, [(Bool, UrTy Var)])]
dataCons :: forall a. DDef a -&gt; [(String, [(Bool, a)])]
</span><a href="#local-6989586621680992876"><span class="hs-identifier hs-var hs-var">dataCons</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-627"></span><span>                    </span><span id="local-6989586621680992878"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992878"><span class="hs-identifier hs-var">dcon</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Var -&gt; String
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">(Var -&gt; String) -&gt; PassM Var -&gt; PassM String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; PassM Var
forall (m :: * -&gt; *). MonadState Int m =&gt; Var -&gt; m Var
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Var
</span><a href="Gibbon.Common.html#toVar"><span class="hs-identifier hs-var">toVar</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Gibbon.Language.Constants.html#redirectionTag"><span class="hs-identifier hs-var">redirectionTag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-628"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680992882"><span class="annot"><span class="annottext">datacons :: [(String, [(Bool, UrTy Var)])]
</span><a href="#local-6989586621680992882"><span class="hs-identifier hs-var hs-var">datacons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((String, [(Bool, UrTy Var)]) -&gt; Bool)
-&gt; [(String, [(Bool, UrTy Var)])] -&gt; [(String, [(Bool, UrTy Var)])]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool)
-&gt; ((String, [(Bool, UrTy Var)]) -&gt; Bool)
-&gt; (String, [(Bool, UrTy Var)])
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="Gibbon.Language.Constants.html#isRedirectionTag"><span class="hs-identifier hs-var">isRedirectionTag</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Bool)
-&gt; ((String, [(Bool, UrTy Var)]) -&gt; String)
-&gt; (String, [(Bool, UrTy Var)])
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(String, [(Bool, UrTy Var)]) -&gt; String
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(String, [(Bool, UrTy Var)])]
</span><a href="#local-6989586621680992876"><span class="hs-identifier hs-var">dataCons</span></a></span><span>
</span><span id="line-629"></span><span>                    </span><span class="annot"><span class="annottext">DDef (UrTy Var) -&gt; PassM (DDef (UrTy Var))
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">DDef (UrTy Var)
</span><a href="#local-6989586621680992874"><span class="hs-identifier hs-var">ddf</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">dataCons :: [(String, [(Bool, UrTy Var)])]
</span><a href="Gibbon.Language.Syntax.html#dataCons"><span class="hs-identifier hs-var">dataCons</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(String, [(Bool, UrTy Var)])]
</span><a href="#local-6989586621680992882"><span class="hs-identifier hs-var">datacons</span></a></span><span> </span><span class="annot"><span class="annottext">[(String, [(Bool, UrTy Var)])]
-&gt; [(String, [(Bool, UrTy Var)])] -&gt; [(String, [(Bool, UrTy Var)])]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680992878"><span class="hs-identifier hs-var">dcon</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UrTy Var
forall a. UrTy a
</span><a href="Gibbon.Language.Syntax.html#CursorTy"><span class="hs-identifier hs-var">CursorTy</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-630"></span><span>            </span><span class="annot"><span class="annottext">DDefs (TyOf Exp2)
Map Var (DDef (UrTy Var))
</span><a href="#local-6989586621680992870"><span class="hs-identifier hs-var">ddefs</span></a></span><span>
</span><span id="line-631"></span><span>  </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
forall a. a -&gt; PassM a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Prog2 -&gt; PassM Prog2) -&gt; Prog2 -&gt; PassM Prog2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680992868"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ddefs :: DDefs (TyOf Exp2)
</span><a href="Gibbon.Language.Syntax.html#ddefs"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp2)
Map Var (DDef (UrTy Var))
</span><a href="#local-6989586621680992872"><span class="hs-identifier hs-var">ddefs'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-632"></span><span>
</span><span id="line-633"></span><span class="annot"><span class="hs-comment">-- | The main compiler pipeline</span></span><span>
</span><span id="line-634"></span><span id="local-6989586621680991715"><span class="annot"><a href="Gibbon.Compiler.html#passes"><span class="hs-identifier hs-type">passes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991715"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L0.Syntax.html#Prog0"><span class="hs-identifier hs-type">L0.Prog0</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Strict.html#StateT"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Compiler.html#CompileState"><span class="hs-identifier hs-type">CompileState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991715"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Prog"><span class="hs-identifier hs-type">L4.Prog</span></a></span></span><span>
</span><span id="line-635"></span><span id="passes"><span class="annot"><span class="annottext">passes :: forall v.
Show v =&gt;
Config -&gt; Prog0 -&gt; StateT (CompileState v) IO Prog
</span><a href="Gibbon.Compiler.html#passes"><span class="hs-identifier hs-var hs-var">passes</span></a></span></span><span> </span><span id="local-6989586621680993884"><span class="annot"><span class="annottext">config :: Config
</span><a href="#local-6989586621680993884"><span class="hs-identifier hs-var">config</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Common.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span class="hs-special">{</span><span id="local-6989586621680993885"><span class="annot"><span class="annottext">DynFlags
dynflags :: Config -&gt; DynFlags
dynflags :: DynFlags
</span><a href="Gibbon.Common.html#dynflags"><span class="hs-identifier hs-var hs-var">dynflags</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621680993886"><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680993886"><span class="hs-identifier hs-var">l0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-636"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680993887"><span class="annot"><span class="annottext">isPacked :: Bool
</span><a href="#local-6989586621680993887"><span class="hs-identifier hs-var hs-var">isPacked</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_Packed"><span class="hs-identifier hs-var">Opt_Packed</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680993885"><span class="hs-identifier hs-var">dynflags</span></a></span><span>
</span><span id="line-637"></span><span>          </span><span id="local-6989586621680993889"><span class="annot"><span class="annottext">biginf :: Bool
</span><a href="#local-6989586621680993889"><span class="hs-identifier hs-var hs-var">biginf</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_BigInfiniteRegions"><span class="hs-identifier hs-var">Opt_BigInfiniteRegions</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680993885"><span class="hs-identifier hs-var">dynflags</span></a></span><span>
</span><span id="line-638"></span><span>          </span><span id="local-6989586621680993891"><span class="annot"><span class="annottext">gibbon1 :: Bool
</span><a href="#local-6989586621680993891"><span class="hs-identifier hs-var hs-var">gibbon1</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_Gibbon1"><span class="hs-identifier hs-var">Opt_Gibbon1</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680993885"><span class="hs-identifier hs-var">dynflags</span></a></span><span>
</span><span id="line-639"></span><span>          </span><span id="local-6989586621680993893"><span class="annot"><span class="annottext">no_rcopies :: Bool
</span><a href="#local-6989586621680993893"><span class="hs-identifier hs-var hs-var">no_rcopies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_No_RemoveCopies"><span class="hs-identifier hs-var">Opt_No_RemoveCopies</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680993885"><span class="hs-identifier hs-var">dynflags</span></a></span><span>
</span><span id="line-640"></span><span>          </span><span id="local-6989586621680993895"><span class="annot"><span class="annottext">parallel :: Bool
</span><a href="#local-6989586621680993895"><span class="hs-identifier hs-var hs-var">parallel</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_Parallel"><span class="hs-identifier hs-var">Opt_Parallel</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680993885"><span class="hs-identifier hs-var">dynflags</span></a></span><span>
</span><span id="line-641"></span><span>          </span><span id="local-6989586621680993896"><span class="annot"><span class="annottext">should_fuse :: Bool
</span><a href="#local-6989586621680993896"><span class="hs-identifier hs-var hs-var">should_fuse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="Gibbon.DynFlags.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="Gibbon.DynFlags.html#Opt_Fusion"><span class="hs-identifier hs-var">Opt_Fusion</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621680993885"><span class="hs-identifier hs-var">dynflags</span></a></span><span>
</span><span id="line-642"></span><span>          </span><span id="local-6989586621680993898"><span class="annot"><span class="annottext">tcProg3 :: Prog3 -&gt; PassM Prog3
</span><a href="#local-6989586621680993898"><span class="hs-identifier hs-var hs-var">tcProg3</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Prog3 -&gt; PassM Prog3
</span><a href="Gibbon.L3.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L3.tcProg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680993887"><span class="hs-identifier hs-var">isPacked</span></a></span><span>
</span><span id="line-643"></span><span>      </span><span id="local-6989586621680993900"><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680993900"><span class="hs-identifier hs-var">l0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog0 -&gt; PassM Prog0)
-&gt; Prog0
-&gt; StateT (CompileState v) IO Prog0
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;freshen&quot;</span></span><span>         </span><span class="annot"><span class="annottext">Prog0 -&gt; PassM Prog0
</span><a href="Gibbon.Passes.Freshen.html#freshNames"><span class="hs-identifier hs-var">freshNames</span></a></span><span>            </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680993886"><span class="hs-identifier hs-var">l0</span></a></span><span>
</span><span id="line-644"></span><span>      </span><span id="local-6989586621680993902"><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680993902"><span class="hs-identifier hs-var">l0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog0 -&gt; PassM Prog0)
-&gt; Prog0
-&gt; StateT (CompileState v) IO Prog0
forall b v a.
(InterpProg () b, Show v) =&gt;
InterpPassRunner a b () v
</span><a href="#local-6989586621680993903"><span class="hs-identifier hs-var">goE0</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;typecheck&quot;</span></span><span>       </span><span class="annot"><span class="annottext">Prog0 -&gt; PassM Prog0
</span><a href="Gibbon.L0.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L0.tcProg</span></a></span><span>             </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680993900"><span class="hs-identifier hs-var">l0</span></a></span><span>
</span><span id="line-645"></span><span>      </span><span id="local-6989586621680993904"><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680993904"><span class="hs-identifier hs-var">l0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog0 -&gt; PassM Prog0)
-&gt; Prog0
-&gt; StateT (CompileState v) IO Prog0
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;elimNewtypes&quot;</span></span><span>     </span><span class="annot"><span class="annottext">Prog0 -&gt; PassM Prog0
forall (m :: * -&gt; *). Monad m =&gt; Prog0 -&gt; m Prog0
</span><a href="Gibbon.L0.ElimNewtype.html#elimNewtypes"><span class="hs-identifier hs-var">L0.elimNewtypes</span></a></span><span>            </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680993902"><span class="hs-identifier hs-var">l0</span></a></span><span>
</span><span id="line-646"></span><span>      </span><span id="local-6989586621680993906"><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680993906"><span class="hs-identifier hs-var">l0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog0 -&gt; PassM Prog0)
-&gt; Prog0
-&gt; StateT (CompileState v) IO Prog0
forall b v a.
(InterpProg () b, Show v) =&gt;
InterpPassRunner a b () v
</span><a href="#local-6989586621680993903"><span class="hs-identifier hs-var">goE0</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;typecheck&quot;</span></span><span>       </span><span class="annot"><span class="annottext">Prog0 -&gt; PassM Prog0
</span><a href="Gibbon.L0.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L0.tcProg</span></a></span><span>             </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680993904"><span class="hs-identifier hs-var">l0</span></a></span><span>
</span><span id="line-647"></span><span>      </span><span id="local-6989586621680993907"><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680993907"><span class="hs-identifier hs-var">l0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog0 -&gt; PassM Prog0)
-&gt; Prog0
-&gt; StateT (CompileState v) IO Prog0
forall b v a.
(InterpProg () b, Show v) =&gt;
InterpPassRunner a b () v
</span><a href="#local-6989586621680993903"><span class="hs-identifier hs-var">goE0</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;bindLambdas&quot;</span></span><span>     </span><span class="annot"><span class="annottext">Prog0 -&gt; PassM Prog0
</span><a href="Gibbon.L0.Specialize2.html#bindLambdas"><span class="hs-identifier hs-var">L0.bindLambdas</span></a></span><span>       </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680993906"><span class="hs-identifier hs-var">l0</span></a></span><span>
</span><span id="line-648"></span><span>      </span><span id="local-6989586621680993909"><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680993909"><span class="hs-identifier hs-var">l0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog0 -&gt; PassM Prog0)
-&gt; Prog0
-&gt; StateT (CompileState v) IO Prog0
forall b v a.
(InterpProg () b, Show v) =&gt;
InterpPassRunner a b () v
</span><a href="#local-6989586621680993903"><span class="hs-identifier hs-var">goE0</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;monomorphize&quot;</span></span><span>    </span><span class="annot"><span class="annottext">Prog0 -&gt; PassM Prog0
</span><a href="Gibbon.L0.Specialize2.html#monomorphize"><span class="hs-identifier hs-var">L0.monomorphize</span></a></span><span>      </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680993907"><span class="hs-identifier hs-var">l0</span></a></span><span>
</span><span id="line-649"></span><span>      </span><span class="hs-comment">-- l0 &lt;- goE0 &quot;closureConvert&quot;  L0.closureConvert    l0</span><span>
</span><span id="line-650"></span><span>      </span><span id="local-6989586621680993911"><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680993911"><span class="hs-identifier hs-var">l0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog0 -&gt; PassM Prog0)
-&gt; Prog0
-&gt; StateT (CompileState v) IO Prog0
forall b v a.
(InterpProg () b, Show v) =&gt;
InterpPassRunner a b () v
</span><a href="#local-6989586621680993903"><span class="hs-identifier hs-var">goE0</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;specLambdas&quot;</span></span><span>     </span><span class="annot"><span class="annottext">Prog0 -&gt; PassM Prog0
</span><a href="Gibbon.L0.Specialize2.html#specLambdas"><span class="hs-identifier hs-var">L0.specLambdas</span></a></span><span>       </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680993909"><span class="hs-identifier hs-var">l0</span></a></span><span>
</span><span id="line-651"></span><span>      </span><span id="local-6989586621680993913"><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680993913"><span class="hs-identifier hs-var">l0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog0 -&gt; PassM Prog0)
-&gt; Prog0
-&gt; StateT (CompileState v) IO Prog0
forall b v a.
(InterpProg () b, Show v) =&gt;
InterpPassRunner a b () v
</span><a href="#local-6989586621680993903"><span class="hs-identifier hs-var">goE0</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;desugarL0&quot;</span></span><span>       </span><span class="annot"><span class="annottext">Prog0 -&gt; PassM Prog0
</span><a href="Gibbon.L0.Specialize2.html#desugarL0"><span class="hs-identifier hs-var">L0.desugarL0</span></a></span><span>         </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680993911"><span class="hs-identifier hs-var">l0</span></a></span><span>
</span><span id="line-652"></span><span>      </span><span id="local-6989586621680993915"><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680993915"><span class="hs-identifier hs-var">l0</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog0 -&gt; PassM Prog0)
-&gt; Prog0
-&gt; StateT (CompileState v) IO Prog0
forall b v a.
(InterpProg () b, Show v) =&gt;
InterpPassRunner a b () v
</span><a href="#local-6989586621680993903"><span class="hs-identifier hs-var">goE0</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;floatOutCase&quot;</span></span><span>    </span><span class="annot"><span class="annottext">Prog0 -&gt; PassM Prog0
</span><a href="Gibbon.L0.Specialize2.html#floatOutCase"><span class="hs-identifier hs-var">L0.floatOutCase</span></a></span><span>      </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680993913"><span class="hs-identifier hs-var">l0</span></a></span><span>
</span><span id="line-653"></span><span>      </span><span class="hs-comment">-- Note: L0 -&gt; L1</span><span>
</span><span id="line-654"></span><span>      </span><span id="local-6989586621680993917"><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993917"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog0 -&gt; PassM Prog1)
-&gt; Prog0
-&gt; StateT (CompileState v) IO Prog1
forall b v a.
(InterpProg () b, Show v) =&gt;
InterpPassRunner a b () v
</span><a href="#local-6989586621680993903"><span class="hs-identifier hs-var">goE0</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;toL1&quot;</span></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog1 -&gt; PassM Prog1
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Prog1 -&gt; PassM Prog1) -&gt; (Prog0 -&gt; Prog1) -&gt; Prog0 -&gt; PassM Prog1
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Prog0 -&gt; Prog1
</span><a href="Gibbon.L0.Specialize2.html#toL1"><span class="hs-identifier hs-var">L0.toL1</span></a></span><span class="hs-special">)</span><span>     </span><span class="annot"><span class="annottext">Prog0
</span><a href="#local-6989586621680993915"><span class="hs-identifier hs-var">l0</span></a></span><span>
</span><span id="line-655"></span><span>
</span><span id="line-656"></span><span>      </span><span id="local-6989586621680993919"><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993919"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog1 -&gt; PassM Prog1)
-&gt; Prog1
-&gt; StateT (CompileState v) IO Prog1
forall b v a.
(InterpProg () b, Show v) =&gt;
InterpPassRunner a b () v
</span><a href="#local-6989586621680993920"><span class="hs-identifier hs-var">goE1</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;typecheck&quot;</span></span><span>     </span><span class="annot"><span class="annottext">Prog1 -&gt; PassM Prog1
</span><a href="Gibbon.L1.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L1.tcProg</span></a></span><span>              </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993917"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-657"></span><span>      </span><span class="hs-comment">-- If we are executing a benchmark, then we</span><span>
</span><span id="line-658"></span><span>      </span><span class="hs-comment">-- replace the main function with benchmark code:</span><span>
</span><span id="line-659"></span><span>      </span><span id="local-6989586621680993922"><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993922"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog1 -&gt; PassM Prog1)
-&gt; Prog1
-&gt; StateT (CompileState v) IO Prog1
forall b v a.
(InterpProg () b, Show v) =&gt;
InterpPassRunner a b () v
</span><a href="#local-6989586621680993920"><span class="hs-identifier hs-var">goE1</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;benchMainExp&quot;</span></span><span>  </span><span class="annot"><span class="annottext">Prog1 -&gt; PassM Prog1
</span><a href="Gibbon.Compiler.html#benchMainExp"><span class="hs-identifier hs-var">benchMainExp</span></a></span><span>           </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993919"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-660"></span><span>      </span><span id="local-6989586621680993923"><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993923"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog1 -&gt; PassM Prog1)
-&gt; Prog1
-&gt; StateT (CompileState v) IO Prog1
forall b v a.
(InterpProg () b, Show v) =&gt;
InterpPassRunner a b () v
</span><a href="#local-6989586621680993920"><span class="hs-identifier hs-var">goE1</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;typecheck&quot;</span></span><span>     </span><span class="annot"><span class="annottext">Prog1 -&gt; PassM Prog1
</span><a href="Gibbon.L1.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L1.tcProg</span></a></span><span>              </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993922"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-661"></span><span>      </span><span id="local-6989586621680993924"><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993924"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog1 -&gt; PassM Prog1)
-&gt; Prog1
-&gt; StateT (CompileState v) IO Prog1
forall b v a.
(InterpProg () b, Show v) =&gt;
InterpPassRunner a b () v
</span><a href="#local-6989586621680993920"><span class="hs-identifier hs-var">goE1</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;simplify&quot;</span></span><span>      </span><span class="annot"><span class="annottext">Prog1 -&gt; PassM Prog1
</span><a href="Gibbon.Passes.Simplifier.html#simplifyL1"><span class="hs-identifier hs-var">simplifyL1</span></a></span><span>             </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993923"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-662"></span><span>      </span><span id="local-6989586621680993925"><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993925"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog1 -&gt; PassM Prog1)
-&gt; Prog1
-&gt; StateT (CompileState v) IO Prog1
forall b v a.
(InterpProg () b, Show v) =&gt;
InterpPassRunner a b () v
</span><a href="#local-6989586621680993920"><span class="hs-identifier hs-var">goE1</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;typecheck&quot;</span></span><span>     </span><span class="annot"><span class="annottext">Prog1 -&gt; PassM Prog1
</span><a href="Gibbon.L1.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L1.tcProg</span></a></span><span>              </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993924"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-663"></span><span>      </span><span class="hs-comment">-- Check this after eliminating all dead functions.</span><span>
</span><span id="line-664"></span><span>      </span><span class="annot"><span class="annottext">Bool
-&gt; StateT (CompileState v) IO () -&gt; StateT (CompileState v) IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog1 -&gt; Bool
forall (e :: * -&gt; * -&gt; *) l d. Prog (PreExp e l d) -&gt; Bool
</span><a href="Gibbon.Language.html#hasSpawnsProg"><span class="hs-identifier hs-var">hasSpawnsProg</span></a></span><span> </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993925"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680993895"><span class="hs-identifier hs-var">parallel</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(StateT (CompileState v) IO () -&gt; StateT (CompileState v) IO ())
-&gt; StateT (CompileState v) IO () -&gt; StateT (CompileState v) IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-665"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; StateT (CompileState v) IO ()
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;To compile a program with parallelism, use --parallel.&quot;</span></span><span>
</span><span id="line-666"></span><span>      </span><span id="local-6989586621680993927"><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993927"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog1 -&gt; PassM Prog1)
-&gt; Prog1
-&gt; StateT (CompileState v) IO Prog1
forall b v a.
(InterpProg () b, Show v) =&gt;
InterpPassRunner a b () v
</span><a href="#local-6989586621680993920"><span class="hs-identifier hs-var">goE1</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;flatten&quot;</span></span><span>       </span><span class="annot"><span class="annottext">Prog1 -&gt; PassM Prog1
</span><a href="Gibbon.Passes.Flatten.html#flattenL1"><span class="hs-identifier hs-var">flattenL1</span></a></span><span>              </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993925"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-667"></span><span>      </span><span id="local-6989586621680993928"><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993928"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog1 -&gt; PassM Prog1)
-&gt; Prog1
-&gt; StateT (CompileState v) IO Prog1
forall b v a.
(InterpProg () b, Show v) =&gt;
InterpPassRunner a b () v
</span><a href="#local-6989586621680993920"><span class="hs-identifier hs-var">goE1</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;simplify&quot;</span></span><span>      </span><span class="annot"><span class="annottext">Prog1 -&gt; PassM Prog1
</span><a href="Gibbon.Passes.Simplifier.html#simplifyL1"><span class="hs-identifier hs-var">simplifyL1</span></a></span><span>             </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993927"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-668"></span><span>      </span><span id="local-6989586621680993929"><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993929"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog1 -&gt; PassM Prog1)
-&gt; Prog1
-&gt; StateT (CompileState v) IO Prog1
forall b v a.
(InterpProg () b, Show v) =&gt;
InterpPassRunner a b () v
</span><a href="#local-6989586621680993920"><span class="hs-identifier hs-var">goE1</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;inlineTriv&quot;</span></span><span>    </span><span class="annot"><span class="annottext">Prog1 -&gt; PassM Prog1
forall (e :: * -&gt; * -&gt; *) l d.
HasSimplifiable e l d =&gt;
Prog (PreExp e l d) -&gt; PassM (Prog (PreExp e l d))
</span><a href="Gibbon.Passes.InlineTriv.html#inlineTriv"><span class="hs-identifier hs-var">inlineTriv</span></a></span><span>             </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993928"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-669"></span><span>      </span><span id="local-6989586621680993930"><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993930"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog1 -&gt; PassM Prog1)
-&gt; Prog1
-&gt; StateT (CompileState v) IO Prog1
forall b v a.
(InterpProg () b, Show v) =&gt;
InterpPassRunner a b () v
</span><a href="#local-6989586621680993920"><span class="hs-identifier hs-var">goE1</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;typecheck&quot;</span></span><span>     </span><span class="annot"><span class="annottext">Prog1 -&gt; PassM Prog1
</span><a href="Gibbon.L1.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L1.tcProg</span></a></span><span>              </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993929"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-670"></span><span>      </span><span id="local-6989586621680993931"><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993931"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680993896"><span class="hs-identifier hs-var">should_fuse</span></a></span><span>
</span><span id="line-671"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog1 -&gt; PassM Prog1)
-&gt; Prog1
-&gt; StateT (CompileState v) IO Prog1
forall b v a.
(InterpProg () b, Show v) =&gt;
InterpPassRunner a b () v
</span><a href="#local-6989586621680993920"><span class="hs-identifier hs-var">goE1</span></a></span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;fusion2&quot;</span></span><span>   </span><span class="annot"><span class="annottext">Prog1 -&gt; PassM Prog1
</span><a href="Gibbon.Passes.Fusion2.html#fusion2"><span class="hs-identifier hs-var">fusion2</span></a></span><span>                </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993930"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-672"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Prog1 -&gt; StateT (CompileState v) IO Prog1
forall a. a -&gt; StateT (CompileState v) IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993930"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-673"></span><span>      </span><span id="local-6989586621680993932"><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993932"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog1 -&gt; PassM Prog1)
-&gt; Prog1
-&gt; StateT (CompileState v) IO Prog1
forall b v a.
(InterpProg () b, Show v) =&gt;
InterpPassRunner a b () v
</span><a href="#local-6989586621680993903"><span class="hs-identifier hs-var">goE0</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;typecheck&quot;</span></span><span>     </span><span class="annot"><span class="annottext">Prog1 -&gt; PassM Prog1
</span><a href="Gibbon.L1.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L1.tcProg</span></a></span><span>              </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993931"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-674"></span><span>
</span><span id="line-675"></span><span>      </span><span class="hs-comment">-- Minimal haskell &quot;backend&quot;.</span><span>
</span><span id="line-676"></span><span>      </span><span class="annot"><span class="annottext">IO () -&gt; StateT (CompileState v) IO ()
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; StateT (CompileState v) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT (CompileState v) IO ())
-&gt; IO () -&gt; StateT (CompileState v) IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Config -&gt; DebugFlag -&gt; String -&gt; IO ()
</span><a href="Gibbon.Common.html#dumpIfSet"><span class="hs-identifier hs-var">dumpIfSet</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680993884"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">DebugFlag
</span><a href="Gibbon.DynFlags.html#Opt_D_Dump_Hs"><span class="hs-identifier hs-var">Opt_D_Dump_Hs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/pretty-1.1.3.6/src/Text.PrettyPrint.HughesPJ.html#render"><span class="hs-identifier hs-var">render</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc -&gt; String) -&gt; Doc -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Prog1 -&gt; Doc
</span><a href="Gibbon.Pretty.html#pprintHsWithEnv"><span class="hs-identifier hs-var">pprintHsWithEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993932"><span class="hs-identifier hs-var">l1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-677"></span><span>
</span><span id="line-678"></span><span>      </span><span id="local-6989586621680993937"><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993937"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Config -&gt; Mode
</span><a href="Gibbon.Common.html#mode"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680993884"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-679"></span><span>        </span><span class="annot"><span class="annottext">Mode
</span><a href="Gibbon.Common.html#ToMPL"><span class="hs-identifier hs-var">ToMPL</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Config
-&gt; Prog1 -&gt; (String -&gt; IO ()) -&gt; StateT (CompileState v) IO Prog1
forall a2 b.
Config -&gt; Prog1 -&gt; (String -&gt; IO a2) -&gt; StateT b IO Prog1
</span><a href="Gibbon.Compiler.html#goSML"><span class="hs-identifier hs-var">goSML</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680993884"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993932"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO () -&gt; String -&gt; IO ()
forall a b. a -&gt; b -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; String -&gt; IO ()) -&gt; IO () -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-680"></span><span>        </span><span class="annot"><span class="annottext">Mode
</span><a href="Gibbon.Common.html#ToMPLExe"><span class="hs-identifier hs-var">ToMPLExe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Config
-&gt; Prog1 -&gt; (String -&gt; IO ()) -&gt; StateT (CompileState v) IO Prog1
forall a2 b.
Config -&gt; Prog1 -&gt; (String -&gt; IO a2) -&gt; StateT b IO Prog1
</span><a href="Gibbon.Compiler.html#goSML"><span class="hs-identifier hs-var">goSML</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680993884"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993932"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="Gibbon.Compiler.html#compileMPL"><span class="hs-identifier hs-var">compileMPL</span></a></span><span>
</span><span id="line-681"></span><span>        </span><span class="annot"><span class="annottext">Mode
</span><a href="Gibbon.Common.html#RunMPL"><span class="hs-identifier hs-var">RunMPL</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Config
-&gt; Prog1 -&gt; (String -&gt; IO ()) -&gt; StateT (CompileState v) IO Prog1
forall a2 b.
Config -&gt; Prog1 -&gt; (String -&gt; IO a2) -&gt; StateT b IO Prog1
</span><a href="Gibbon.Compiler.html#goSML"><span class="hs-identifier hs-var">goSML</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680993884"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993932"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680993939"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680993939"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="Gibbon.Compiler.html#compileMPL"><span class="hs-identifier hs-var">compileMPL</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680993939"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO () -&gt; IO ()
forall a b. IO a -&gt; IO b -&gt; IO b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2A%3E"><span class="hs-operator hs-var">*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="Gibbon.Compiler.html#runMPL"><span class="hs-identifier hs-var">runMPL</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680993939"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-682"></span><span>        </span><span class="annot"><span class="annottext">Mode
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Prog1 -&gt; StateT (CompileState v) IO Prog1
forall a. a -&gt; StateT (CompileState v) IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993932"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-683"></span><span>
</span><span id="line-684"></span><span>      </span><span class="hs-comment">-- -- TODO: Write interpreters for L2 and L3</span><span>
</span><span id="line-685"></span><span>      </span><span id="local-6989586621680993940"><span class="annot"><span class="annottext">Prog3
</span><a href="#local-6989586621680993940"><span class="hs-identifier hs-var">l3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680993887"><span class="hs-identifier hs-var">isPacked</span></a></span><span>
</span><span id="line-686"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-687"></span><span>              </span><span class="hs-comment">-- TODO: push data contstructors under conditional</span><span>
</span><span id="line-688"></span><span>              </span><span class="hs-comment">-- branches before InferLocations.</span><span>
</span><span id="line-689"></span><span>
</span><span id="line-690"></span><span>              </span><span class="hs-comment">-- Note: L1 -&gt; L2</span><span>
</span><span id="line-691"></span><span>              </span><span class="hs-comment">-- l1 &lt;- goE1 &quot;copyOutOfOrderPacked&quot; copyOutOfOrderPacked l1</span><span>
</span><span id="line-692"></span><span>              </span><span id="local-6989586621680993941"><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993941"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog1 -&gt; PassM Prog1)
-&gt; Prog1
-&gt; StateT (CompileState v) IO Prog1
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L1.typecheck&quot;</span></span><span>    </span><span class="annot"><span class="annottext">Prog1 -&gt; PassM Prog1
</span><a href="Gibbon.L1.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L1.tcProg</span></a></span><span>     </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993937"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-693"></span><span>              </span><span id="local-6989586621680993942"><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993942"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog1 -&gt; PassM Prog1)
-&gt; Prog1
-&gt; StateT (CompileState v) IO Prog1
forall b v a.
(InterpProg () b, Show v) =&gt;
InterpPassRunner a b () v
</span><a href="#local-6989586621680993920"><span class="hs-identifier hs-var">goE1</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;removeCopyAliases&quot;</span></span><span> </span><span class="annot"><span class="annottext">Prog1 -&gt; PassM Prog1
</span><a href="Gibbon.Passes.InferLocations.html#removeAliasesForCopyCalls"><span class="hs-identifier hs-var">removeAliasesForCopyCalls</span></a></span><span> </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993941"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-694"></span><span>              </span><span id="local-6989586621680993943"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993943"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog1 -&gt; PassM Prog2)
-&gt; Prog1
-&gt; StateT (CompileState v) IO Prog2
forall b v a.
(InterpProg Store b, Show v) =&gt;
InterpPassRunner a b Store v
</span><a href="#local-6989586621680993944"><span class="hs-identifier hs-var">goE2</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;inferLocations&quot;</span></span><span>  </span><span class="annot"><span class="annottext">Prog1 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.InferLocations.html#inferLocs"><span class="hs-identifier hs-var">inferLocs</span></a></span><span>    </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993942"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-695"></span><span>              </span><span id="local-6989586621680993945"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993945"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall b v a.
(InterpProg Store b, Show v) =&gt;
InterpPassRunner a b Store v
</span><a href="#local-6989586621680993944"><span class="hs-identifier hs-var">goE2</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;simplifyLocBinds_a&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.Simplifier.html#simplifyLocBinds"><span class="hs-identifier hs-var">simplifyLocBinds</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993943"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-696"></span><span>              </span><span id="local-6989586621680993946"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993946"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span>   </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L2.typecheck&quot;</span></span><span>    </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.L2.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L2.tcProg</span></a></span><span>    </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993945"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-697"></span><span>              </span><span id="local-6989586621680993948"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993948"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;regionsInwards&quot;</span></span><span>    </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.RegionsInwards.html#regionsInwards"><span class="hs-identifier hs-var">regionsInwards</span></a></span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993946"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-698"></span><span>              </span><span id="local-6989586621680993949"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993949"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span>   </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L2.typecheck&quot;</span></span><span>    </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.L2.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L2.tcProg</span></a></span><span>    </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993948"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-699"></span><span>              </span><span id="local-6989586621680993950"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993950"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall b v a.
(InterpProg Store b, Show v) =&gt;
InterpPassRunner a b Store v
</span><a href="#local-6989586621680993944"><span class="hs-identifier hs-var">goE2</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;simplifyLocBinds&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.Simplifier.html#simplifyLocBinds"><span class="hs-identifier hs-var">simplifyLocBinds</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993949"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-700"></span><span>              </span><span id="local-6989586621680993951"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993951"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span>   </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;fixRANs&quot;</span></span><span>         </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.InferLocations.html#fixRANs"><span class="hs-identifier hs-var">fixRANs</span></a></span><span>      </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993950"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-701"></span><span>              </span><span id="local-6989586621680993952"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993952"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span>   </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L2.typecheck&quot;</span></span><span>    </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.L2.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L2.tcProg</span></a></span><span>    </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993951"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-702"></span><span>              </span><span id="local-6989586621680993953"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993953"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall b v a.
(InterpProg Store b, Show v) =&gt;
InterpPassRunner a b Store v
</span><a href="#local-6989586621680993944"><span class="hs-identifier hs-var">goE2</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L2.flatten&quot;</span></span><span>      </span><span class="annot"><span class="annottext">Flattenable (E2Ext Var (UrTy Var)) =&gt; Prog2 -&gt; PassM Prog2
Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.Flatten.html#flattenL2"><span class="hs-identifier hs-var">flattenL2</span></a></span><span>    </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993952"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-703"></span><span>              </span><span id="local-6989586621680993954"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993954"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span>   </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L2.typecheck&quot;</span></span><span>    </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.L2.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L2.tcProg</span></a></span><span>    </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993953"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-704"></span><span>              </span><span id="local-6989586621680993955"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993955"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680993891"><span class="hs-identifier hs-var">gibbon1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680993893"><span class="hs-identifier hs-var">no_rcopies</span></a></span><span>
</span><span id="line-705"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Prog2 -&gt; StateT (CompileState v) IO Prog2
forall a. a -&gt; StateT (CompileState v) IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993954"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-706"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621680993956"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993956"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;removeCopies&quot;</span></span><span> </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.RemoveCopies.html#removeCopies"><span class="hs-identifier hs-var">removeCopies</span></a></span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993954"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-707"></span><span>                            </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L2.typecheck&quot;</span></span><span>       </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.L2.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L2.tcProg</span></a></span><span>    </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993956"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-708"></span><span>              </span><span id="local-6989586621680993957"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993957"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall b v a.
(InterpProg Store b, Show v) =&gt;
InterpPassRunner a b Store v
</span><a href="#local-6989586621680993944"><span class="hs-identifier hs-var">goE2</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;inferEffects&quot;</span></span><span> </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.InferEffects.html#inferEffects"><span class="hs-identifier hs-var">inferEffects</span></a></span><span>  </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993955"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-709"></span><span>
</span><span id="line-710"></span><span class="hs-comment">{- Note [Repairing programs]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~

We need a program analysis that decides whether a L2 program needs to be repaired.
Why ? Because, when we pattern match on a packed value, L2 assumes that *every*
variable in that pattern is accessible. However, this is not always true.
Consider the rightmost fn (which does not traverse it's input):

   (Node [(x, loc_x), (y, loc_y)] BODY)

Here, since the input is not traversed, we won't have an end-witness for x. And we
cannot access y without it. We need to fix such programs. Effectively, what we're
looking for in this analyis is if we can unpack all the pattern matched variables
in case expressions occurring in the program. For functions, it means that either
the function should traverse it's input, or the un-reachable elements in the pattern
match must remain unused (eg. 'leftmost'). On the other hand, we always have to
repair a broken main expression (since the &quot;unused&quot; case won't apply).

The compiler has access to 2 program repair strategies -- dummy traversals or
random access nodes. If we're operating in gibbon1 mode, it uses the former. However,
this changes the asymptotic complexity of the functions. In gibbon2 mode, we compile
such programs to store RAN's instead. This basically allows O(1) access to any element
of a data constructor.

Also see Note [Adding dummy traversals] and Note [Adding random access nodes].

-}</span><span>
</span><span id="line-737"></span><span>              </span><span id="local-6989586621680993958"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993958"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-738"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680993891"><span class="hs-identifier hs-var">gibbon1</span></a></span><span>
</span><span id="line-739"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-740"></span><span>                  </span><span id="local-6989586621680993959"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993959"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall b v a.
(InterpProg Store b, Show v) =&gt;
InterpPassRunner a b Store v
</span><a href="#local-6989586621680993944"><span class="hs-identifier hs-var">goE2</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;addTraversals&quot;</span></span><span> </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.AddTraversals.html#addTraversals"><span class="hs-identifier hs-var">addTraversals</span></a></span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993957"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-741"></span><span>                  </span><span id="local-6989586621680993960"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993960"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L2.typecheck&quot;</span></span><span>    </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.L2.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L2.tcProg</span></a></span><span>     </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993959"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-742"></span><span>                  </span><span id="local-6989586621680993961"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993961"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall b v a.
(InterpProg Store b, Show v) =&gt;
InterpPassRunner a b Store v
</span><a href="#local-6989586621680993944"><span class="hs-identifier hs-var">goE2</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;inferEffects2&quot;</span></span><span>  </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.InferEffects.html#inferEffects"><span class="hs-identifier hs-var">inferEffects</span></a></span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993960"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-743"></span><span>                  </span><span id="local-6989586621680993962"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993962"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L2.typecheck&quot;</span></span><span>    </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.L2.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L2.tcProg</span></a></span><span>     </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993961"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-744"></span><span>                  </span><span id="local-6989586621680993963"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993963"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall b v a.
(InterpProg Store b, Show v) =&gt;
InterpPassRunner a b Store v
</span><a href="#local-6989586621680993944"><span class="hs-identifier hs-var">goE2</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;repairProgram&quot;</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Prog2 -&gt; PassM Prog2) -&gt; (Prog2 -&gt; Prog2) -&gt; Prog2 -&gt; PassM Prog2
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Prog2 -&gt; Prog2
forall a. a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993962"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-745"></span><span>                  </span><span class="annot"><span class="annottext">Prog2 -&gt; StateT (CompileState v) IO Prog2
forall a. a -&gt; StateT (CompileState v) IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993963"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-746"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-747"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680993965"><span class="annot"><span class="annottext">need :: Set String
</span><a href="#local-6989586621680993965"><span class="hs-identifier hs-var hs-var">need</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prog2 -&gt; Set String
</span><a href="Gibbon.Passes.AddRAN.html#needsRAN"><span class="hs-identifier hs-var">needsRAN</span></a></span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993957"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-748"></span><span>                  </span><span id="local-6989586621680993966"><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993966"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog1 -&gt; PassM Prog1)
-&gt; Prog1
-&gt; StateT (CompileState v) IO Prog1
forall b v a.
(InterpProg () b, Show v) =&gt;
InterpPassRunner a b () v
</span><a href="#local-6989586621680993920"><span class="hs-identifier hs-var">goE1</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;addRAN&quot;</span></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set String -&gt; Prog1 -&gt; PassM Prog1
</span><a href="Gibbon.Passes.AddRAN.html#addRAN"><span class="hs-identifier hs-var">addRAN</span></a></span><span> </span><span class="annot"><span class="annottext">Set String
</span><a href="#local-6989586621680993965"><span class="hs-identifier hs-var">need</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993942"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-749"></span><span>                  </span><span id="local-6989586621680993967"><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993967"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog1 -&gt; PassM Prog1)
-&gt; Prog1
-&gt; StateT (CompileState v) IO Prog1
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L1.typecheck&quot;</span></span><span>    </span><span class="annot"><span class="annottext">Prog1 -&gt; PassM Prog1
</span><a href="Gibbon.L1.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L1.tcProg</span></a></span><span>     </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993966"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-750"></span><span>                  </span><span class="hs-comment">-- NOTE: Calling copyOutOfOrderPacked here seems redundant since all the copy calls seem be exists in the correct place.</span><span>
</span><span id="line-751"></span><span>                  </span><span class="hs-comment">-- In addititon, calling it here gives a compile time error.</span><span>
</span><span id="line-752"></span><span>                  </span><span class="hs-comment">-- l1 &lt;- goE1 &quot;copyOutOfOrderPacked&quot; copyOutOfOrderPacked l1</span><span>
</span><span id="line-753"></span><span>                  </span><span class="hs-comment">-- l1 &lt;- go &quot;L1.typecheck&quot;    L1.tcProg     l1</span><span>
</span><span id="line-754"></span><span>                  </span><span id="local-6989586621680993968"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993968"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog1 -&gt; PassM Prog2)
-&gt; Prog1
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;inferLocations2&quot;</span></span><span> </span><span class="annot"><span class="annottext">Prog1 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.InferLocations.html#inferLocs"><span class="hs-identifier hs-var">inferLocs</span></a></span><span>     </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993967"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-755"></span><span>                  </span><span id="local-6989586621680993969"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993969"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;simplifyLocBinds&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.Simplifier.html#simplifyLocBinds"><span class="hs-identifier hs-var">simplifyLocBinds</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993968"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-756"></span><span>                  </span><span id="local-6989586621680993970"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993970"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;fixRANs&quot;</span></span><span>         </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.InferLocations.html#fixRANs"><span class="hs-identifier hs-var">fixRANs</span></a></span><span>       </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993969"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-757"></span><span>                  </span><span id="local-6989586621680993971"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993971"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span>   </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L2.typecheck&quot;</span></span><span>  </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.L2.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L2.tcProg</span></a></span><span>     </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993970"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-758"></span><span>                  </span><span id="local-6989586621680993972"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993972"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;regionsInwards&quot;</span></span><span> </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.RegionsInwards.html#regionsInwards"><span class="hs-identifier hs-var">regionsInwards</span></a></span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993971"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-759"></span><span>                  </span><span id="local-6989586621680993973"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993973"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span>   </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L2.typecheck&quot;</span></span><span>  </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.L2.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L2.tcProg</span></a></span><span>     </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993972"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-760"></span><span>                  </span><span id="local-6989586621680993974"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993974"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L2.flatten&quot;</span></span><span>      </span><span class="annot"><span class="annottext">Flattenable (E2Ext Var (UrTy Var)) =&gt; Prog2 -&gt; PassM Prog2
Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.Flatten.html#flattenL2"><span class="hs-identifier hs-var">flattenL2</span></a></span><span>     </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993973"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-761"></span><span>                  </span><span id="local-6989586621680993975"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993975"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;findWitnesses&quot;</span></span><span> </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.FindWitnesses.html#findWitnesses"><span class="hs-identifier hs-var">findWitnesses</span></a></span><span>   </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993974"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-762"></span><span>                  </span><span id="local-6989586621680993976"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993976"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L2.typecheck&quot;</span></span><span>    </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.L2.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L2.tcProg</span></a></span><span>     </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993975"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-763"></span><span>                  </span><span id="local-6989586621680993977"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993977"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall b v a.
(InterpProg Store b, Show v) =&gt;
InterpPassRunner a b Store v
</span><a href="#local-6989586621680993944"><span class="hs-identifier hs-var">goE2</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L2.flatten&quot;</span></span><span>    </span><span class="annot"><span class="annottext">Flattenable (E2Ext Var (UrTy Var)) =&gt; Prog2 -&gt; PassM Prog2
Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.Flatten.html#flattenL2"><span class="hs-identifier hs-var">flattenL2</span></a></span><span>     </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993976"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-764"></span><span>                  </span><span id="local-6989586621680993978"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993978"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L2.typecheck&quot;</span></span><span>    </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.L2.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L2.tcProg</span></a></span><span>     </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993977"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-765"></span><span>                  </span><span id="local-6989586621680993979"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993979"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall b v a.
(InterpProg Store b, Show v) =&gt;
InterpPassRunner a b Store v
</span><a href="#local-6989586621680993944"><span class="hs-identifier hs-var">goE2</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;removeCopies&quot;</span></span><span>  </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.RemoveCopies.html#removeCopies"><span class="hs-identifier hs-var">removeCopies</span></a></span><span>  </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993978"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-766"></span><span>                  </span><span id="local-6989586621680993980"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993980"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L2.typecheck&quot;</span></span><span>    </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.L2.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L2.tcProg</span></a></span><span>     </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993979"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-767"></span><span>                  </span><span id="local-6989586621680993981"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993981"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall b v a.
(InterpProg Store b, Show v) =&gt;
InterpPassRunner a b Store v
</span><a href="#local-6989586621680993944"><span class="hs-identifier hs-var">goE2</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;inferEffects2&quot;</span></span><span> </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.InferEffects.html#inferEffects"><span class="hs-identifier hs-var">inferEffects</span></a></span><span>  </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993980"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-768"></span><span>                  </span><span id="local-6989586621680993982"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993982"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L2.typecheck&quot;</span></span><span>    </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.L2.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L2.tcProg</span></a></span><span>     </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993981"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-769"></span><span>                  </span><span id="local-6989586621680993983"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993983"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall b v a.
(InterpProg Store b, Show v) =&gt;
InterpPassRunner a b Store v
</span><a href="#local-6989586621680993944"><span class="hs-identifier hs-var">goE2</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;addTraversals&quot;</span></span><span> </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.AddTraversals.html#addTraversals"><span class="hs-identifier hs-var">addTraversals</span></a></span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993982"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-770"></span><span>                  </span><span id="local-6989586621680993984"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993984"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L2.typecheck&quot;</span></span><span>    </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.L2.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L2.tcProg</span></a></span><span>     </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993983"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-771"></span><span>                  </span><span id="local-6989586621680993985"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993985"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall b v a.
(InterpProg Store b, Show v) =&gt;
InterpPassRunner a b Store v
</span><a href="#local-6989586621680993944"><span class="hs-identifier hs-var">goE2</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;repairProgram&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Prog2 -&gt; PassM Prog2) -&gt; (Prog2 -&gt; Prog2) -&gt; Prog2 -&gt; PassM Prog2
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Prog2 -&gt; Prog2
forall a. a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span>   </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993984"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-772"></span><span>                  </span><span class="annot"><span class="annottext">Prog2 -&gt; StateT (CompileState v) IO Prog2
forall a. a -&gt; StateT (CompileState v) IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993985"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-773"></span><span>
</span><span id="line-774"></span><span>              </span><span class="annot"><span class="annottext">IO () -&gt; StateT (CompileState v) IO ()
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; StateT (CompileState v) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT (CompileState v) IO ())
-&gt; IO () -&gt; StateT (CompileState v) IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Config -&gt; DebugFlag -&gt; String -&gt; IO ()
</span><a href="Gibbon.Common.html#dumpIfSet"><span class="hs-identifier hs-var">dumpIfSet</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680993884"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">DebugFlag
</span><a href="Gibbon.DynFlags.html#Opt_D_Dump_Repair"><span class="hs-identifier hs-var">Opt_D_Dump_Repair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog2 -&gt; String
forall e. Pretty e =&gt; e -&gt; String
</span><a href="Gibbon.Pretty.html#pprender"><span class="hs-identifier hs-var">pprender</span></a></span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993958"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-775"></span><span>              </span><span id="local-6989586621680993987"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993987"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L2.typecheck&quot;</span></span><span>     </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.L2.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L2.tcProg</span></a></span><span>     </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993958"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-776"></span><span>              </span><span id="local-6989586621680993988"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993988"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall b v a.
(InterpProg Store b, Show v) =&gt;
InterpPassRunner a b Store v
</span><a href="#local-6989586621680993944"><span class="hs-identifier hs-var">goE2</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;parAlloc&quot;</span></span><span>   </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.ParAlloc.html#parAlloc"><span class="hs-identifier hs-var">parAlloc</span></a></span><span>  </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993987"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-777"></span><span>              </span><span class="annot"><span class="annottext">IO () -&gt; StateT (CompileState v) IO ()
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; StateT (CompileState v) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT (CompileState v) IO ())
-&gt; IO () -&gt; StateT (CompileState v) IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Config -&gt; DebugFlag -&gt; String -&gt; IO ()
</span><a href="Gibbon.Common.html#dumpIfSet"><span class="hs-identifier hs-var">dumpIfSet</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680993884"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">DebugFlag
</span><a href="Gibbon.DynFlags.html#Opt_D_Dump_ParAlloc"><span class="hs-identifier hs-var">Opt_D_Dump_ParAlloc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prog2 -&gt; String
forall e. Pretty e =&gt; e -&gt; String
</span><a href="Gibbon.Pretty.html#pprender"><span class="hs-identifier hs-var">pprender</span></a></span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993988"><span class="hs-identifier hs-var">l2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-778"></span><span>              </span><span id="local-6989586621680993990"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993990"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L2.typecheck&quot;</span></span><span> </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.L2.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L2.tcProg</span></a></span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993988"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-779"></span><span>              </span><span id="local-6989586621680993991"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993991"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall b v a.
(InterpProg Store b, Show v) =&gt;
InterpPassRunner a b Store v
</span><a href="#local-6989586621680993944"><span class="hs-identifier hs-var">goE2</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;inferRegScope&quot;</span></span><span>  </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.InferRegionScope.html#inferRegScope"><span class="hs-identifier hs-var">inferRegScope</span></a></span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993990"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-780"></span><span>              </span><span id="local-6989586621680993992"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993992"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L2.typecheck&quot;</span></span><span>     </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.L2.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L2.tcProg</span></a></span><span>     </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993991"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-781"></span><span>              </span><span id="local-6989586621680993993"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993993"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall b v a.
(InterpProg Store b, Show v) =&gt;
InterpPassRunner a b Store v
</span><a href="#local-6989586621680993944"><span class="hs-identifier hs-var">goE2</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;simplifyLocBinds&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.Simplifier.html#simplifyLocBinds"><span class="hs-identifier hs-var">simplifyLocBinds</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993992"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-782"></span><span>              </span><span id="local-6989586621680993994"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993994"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L2.typecheck&quot;</span></span><span>     </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.L2.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L2.tcProg</span></a></span><span>     </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993993"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-783"></span><span>              </span><span id="local-6989586621680993995"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993995"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;writeOrderMarkers&quot;</span></span><span> </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.ReorderScalarWrites.html#writeOrderMarkers"><span class="hs-identifier hs-var">writeOrderMarkers</span></a></span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993994"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-784"></span><span>              </span><span id="local-6989586621680993996"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993996"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L2.typecheck&quot;</span></span><span>     </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.L2.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L2.tcProg</span></a></span><span>     </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993995"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-785"></span><span>              </span><span id="local-6989586621680993997"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993997"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall b v a.
(InterpProg Store b, Show v) =&gt;
InterpPassRunner a b Store v
</span><a href="#local-6989586621680993944"><span class="hs-identifier hs-var">goE2</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;routeEnds&quot;</span></span><span>      </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.RouteEnds.html#routeEnds"><span class="hs-identifier hs-var">routeEnds</span></a></span><span>     </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993996"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-786"></span><span>              </span><span id="local-6989586621680993998"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993998"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L2.typecheck&quot;</span></span><span>     </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.L2.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L2.tcProg</span></a></span><span>     </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993997"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-787"></span><span>              </span><span id="local-6989586621680993999"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993999"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;inferFunAllocs&quot;</span></span><span>   </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.InferFunAllocs.html#inferFunAllocs"><span class="hs-identifier hs-var">inferFunAllocs</span></a></span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993998"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-788"></span><span>              </span><span id="local-6989586621680994000"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680994000"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L2.typecheck&quot;</span></span><span>     </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.L2.Typecheck.html#tcProg"><span class="hs-identifier hs-var">L2.tcProg</span></a></span><span>     </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680993999"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-789"></span><span>              </span><span class="hs-comment">-- L2 program no longer typechecks while these next passes run</span><span>
</span><span id="line-790"></span><span>              </span><span id="local-6989586621680994001"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680994001"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall b v a.
(InterpProg Store b, Show v) =&gt;
InterpPassRunner a b Store v
</span><a href="#local-6989586621680993944"><span class="hs-identifier hs-var">goE2</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;simplifyLocBinds&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.Simplifier.html#simplifyLocBinds"><span class="hs-identifier hs-var">simplifyLocBinds</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680994000"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-791"></span><span>              </span><span id="local-6989586621680994002"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680994002"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;addRedirectionCon&quot;</span></span><span> </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Compiler.html#addRedirectionCon"><span class="hs-identifier hs-var">addRedirectionCon</span></a></span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680994001"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-792"></span><span>              </span><span class="hs-comment">-- l2 &lt;- if gibbon1</span><span>
</span><span id="line-793"></span><span>              </span><span class="hs-comment">--       then pure l2</span><span>
</span><span id="line-794"></span><span>              </span><span class="hs-comment">--       else go &quot;inferRegSize&quot; inferRegSize l2</span><span>
</span><span id="line-795"></span><span>              </span><span id="local-6989586621680994003"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680994003"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680993891"><span class="hs-identifier hs-var">gibbon1</span></a></span><span>
</span><span id="line-796"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Prog2 -&gt; StateT (CompileState v) IO Prog2
forall a. a -&gt; StateT (CompileState v) IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680994002"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-797"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;followPtrs&quot;</span></span><span> </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.FollowPtrs.html#followPtrs"><span class="hs-identifier hs-var">followPtrs</span></a></span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680994002"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-798"></span><span>              </span><span id="local-6989586621680994004"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680994004"><span class="hs-identifier hs-var">l2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;fromOldL2&quot;</span></span><span> </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.NewL2.FromOldL2.html#fromOldL2"><span class="hs-identifier hs-var">fromOldL2</span></a></span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680994003"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-799"></span><span>
</span><span id="line-800"></span><span>              </span><span class="hs-comment">-- N.B ThreadRegions doesn't produce a type-correct L2 program --</span><span>
</span><span id="line-801"></span><span>              </span><span class="hs-comment">-- it adds regions to 'locs' in AppE and LetE which the</span><span>
</span><span id="line-802"></span><span>              </span><span class="hs-comment">-- typechecker doesn't know how to handle.</span><span>
</span><span id="line-803"></span><span>              </span><span id="local-6989586621680994005"><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680994005"><span class="hs-identifier hs-var">l2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog2)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog2
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;threadRegions&quot;</span></span><span>    </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.ThreadRegions.html#threadRegions"><span class="hs-identifier hs-var">threadRegions</span></a></span><span> </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680994004"><span class="hs-identifier hs-var">l2'</span></a></span><span>
</span><span id="line-804"></span><span>
</span><span id="line-805"></span><span>              </span><span class="hs-comment">-- L2 -&gt; L3</span><span>
</span><span id="line-806"></span><span>              </span><span class="hs-comment">-- TODO: Compose L3.TcM with (ReaderT Config)</span><span>
</span><span id="line-807"></span><span>              </span><span id="local-6989586621680994006"><span class="annot"><span class="annottext">Prog3
</span><a href="#local-6989586621680994006"><span class="hs-identifier hs-var">l3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog2 -&gt; PassM Prog3)
-&gt; Prog2
-&gt; StateT (CompileState v) IO Prog3
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cursorize&quot;</span></span><span>        </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog3
</span><a href="Gibbon.Passes.Cursorize.html#cursorize"><span class="hs-identifier hs-var">cursorize</span></a></span><span>     </span><span class="annot"><span class="annottext">Prog2
</span><a href="#local-6989586621680994005"><span class="hs-identifier hs-var">l2'</span></a></span><span>
</span><span id="line-808"></span><span>              </span><span id="local-6989586621680994007"><span class="annot"><span class="annottext">Prog3
</span><a href="#local-6989586621680994007"><span class="hs-identifier hs-var">l3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog3 -&gt; PassM Prog3)
-&gt; Prog3
-&gt; StateT (CompileState v) IO Prog3
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;reorderScalarWrites&quot;</span></span><span> </span><span class="annot"><span class="annottext">Prog3 -&gt; PassM Prog3
</span><a href="Gibbon.Passes.ReorderScalarWrites.html#reorderScalarWrites"><span class="hs-identifier hs-var">reorderScalarWrites</span></a></span><span>  </span><span class="annot"><span class="annottext">Prog3
</span><a href="#local-6989586621680994006"><span class="hs-identifier hs-var">l3</span></a></span><span>
</span><span id="line-809"></span><span>              </span><span class="hs-comment">-- _ &lt;- lift $ putStrLn (pprender l3)</span><span>
</span><span id="line-810"></span><span>              </span><span id="local-6989586621680994008"><span class="annot"><span class="annottext">Prog3
</span><a href="#local-6989586621680994008"><span class="hs-identifier hs-var">l3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog3 -&gt; PassM Prog3)
-&gt; Prog3
-&gt; StateT (CompileState v) IO Prog3
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L3.flatten&quot;</span></span><span>       </span><span class="annot"><span class="annottext">Prog3 -&gt; PassM Prog3
</span><a href="Gibbon.Passes.Flatten.html#flattenL3"><span class="hs-identifier hs-var">flattenL3</span></a></span><span>     </span><span class="annot"><span class="annottext">Prog3
</span><a href="#local-6989586621680994007"><span class="hs-identifier hs-var">l3</span></a></span><span>
</span><span id="line-811"></span><span>              </span><span id="local-6989586621680994009"><span class="annot"><span class="annottext">Prog3
</span><a href="#local-6989586621680994009"><span class="hs-identifier hs-var">l3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog3 -&gt; PassM Prog3)
-&gt; Prog3
-&gt; StateT (CompileState v) IO Prog3
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L3.typecheck&quot;</span></span><span>     </span><span class="annot"><span class="annottext">Prog3 -&gt; PassM Prog3
</span><a href="#local-6989586621680993898"><span class="hs-identifier hs-var">tcProg3</span></a></span><span>       </span><span class="annot"><span class="annottext">Prog3
</span><a href="#local-6989586621680994008"><span class="hs-identifier hs-var">l3</span></a></span><span>
</span><span id="line-812"></span><span>              </span><span id="local-6989586621680994010"><span class="annot"><span class="annottext">Prog3
</span><a href="#local-6989586621680994010"><span class="hs-identifier hs-var">l3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog3 -&gt; PassM Prog3)
-&gt; Prog3
-&gt; StateT (CompileState v) IO Prog3
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hoistNewBuf&quot;</span></span><span>      </span><span class="annot"><span class="annottext">Prog3 -&gt; PassM Prog3
</span><a href="Gibbon.Passes.HoistNewBuf.html#hoistNewBuf"><span class="hs-identifier hs-var">hoistNewBuf</span></a></span><span>   </span><span class="annot"><span class="annottext">Prog3
</span><a href="#local-6989586621680994009"><span class="hs-identifier hs-var">l3</span></a></span><span>
</span><span id="line-813"></span><span>              </span><span id="local-6989586621680994011"><span class="annot"><span class="annottext">Prog3
</span><a href="#local-6989586621680994011"><span class="hs-identifier hs-var">l3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog3 -&gt; PassM Prog3)
-&gt; Prog3
-&gt; StateT (CompileState v) IO Prog3
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L3.typecheck&quot;</span></span><span>     </span><span class="annot"><span class="annottext">Prog3 -&gt; PassM Prog3
</span><a href="#local-6989586621680993898"><span class="hs-identifier hs-var">tcProg3</span></a></span><span>       </span><span class="annot"><span class="annottext">Prog3
</span><a href="#local-6989586621680994010"><span class="hs-identifier hs-var">l3</span></a></span><span>
</span><span id="line-814"></span><span>              </span><span class="annot"><span class="annottext">Prog3 -&gt; StateT (CompileState v) IO Prog3
forall a. a -&gt; StateT (CompileState v) IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prog3
</span><a href="#local-6989586621680994011"><span class="hs-identifier hs-var">l3</span></a></span><span>
</span><span id="line-815"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-816"></span><span>              </span><span id="local-6989586621680994012"><span class="annot"><span class="annottext">Prog3
</span><a href="#local-6989586621680994012"><span class="hs-identifier hs-var">l3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog1 -&gt; PassM Prog3)
-&gt; Prog1
-&gt; StateT (CompileState v) IO Prog3
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;directL3&quot;</span></span><span>         </span><span class="annot"><span class="annottext">Prog1 -&gt; PassM Prog3
</span><a href="Gibbon.Passes.DirectL3.html#directL3"><span class="hs-identifier hs-var">directL3</span></a></span><span>      </span><span class="annot"><span class="annottext">Prog1
</span><a href="#local-6989586621680993937"><span class="hs-identifier hs-var">l1</span></a></span><span>
</span><span id="line-817"></span><span>              </span><span id="local-6989586621680994013"><span class="annot"><span class="annottext">Prog3
</span><a href="#local-6989586621680994013"><span class="hs-identifier hs-var">l3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog3 -&gt; PassM Prog3)
-&gt; Prog3
-&gt; StateT (CompileState v) IO Prog3
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L3.typecheck&quot;</span></span><span>     </span><span class="annot"><span class="annottext">Prog3 -&gt; PassM Prog3
</span><a href="#local-6989586621680993898"><span class="hs-identifier hs-var">tcProg3</span></a></span><span>       </span><span class="annot"><span class="annottext">Prog3
</span><a href="#local-6989586621680994012"><span class="hs-identifier hs-var">l3</span></a></span><span>
</span><span id="line-818"></span><span>              </span><span class="annot"><span class="annottext">Prog3 -&gt; StateT (CompileState v) IO Prog3
forall a. a -&gt; StateT (CompileState v) IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prog3
</span><a href="#local-6989586621680994013"><span class="hs-identifier hs-var">l3</span></a></span><span>
</span><span id="line-819"></span><span>
</span><span id="line-820"></span><span>      </span><span id="local-6989586621680994014"><span class="annot"><span class="annottext">Prog3
</span><a href="#local-6989586621680994014"><span class="hs-identifier hs-var">l3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog3 -&gt; PassM Prog3)
-&gt; Prog3
-&gt; StateT (CompileState v) IO Prog3
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unariser&quot;</span></span><span>       </span><span class="annot"><span class="annottext">Prog3 -&gt; PassM Prog3
</span><a href="Gibbon.Passes.Unariser.html#unariser"><span class="hs-identifier hs-var">unariser</span></a></span><span>                </span><span class="annot"><span class="annottext">Prog3
</span><a href="#local-6989586621680993940"><span class="hs-identifier hs-var">l3</span></a></span><span>
</span><span id="line-821"></span><span>      </span><span id="local-6989586621680994015"><span class="annot"><span class="annottext">Prog3
</span><a href="#local-6989586621680994015"><span class="hs-identifier hs-var">l3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog3 -&gt; PassM Prog3)
-&gt; Prog3
-&gt; StateT (CompileState v) IO Prog3
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L3.typecheck&quot;</span></span><span>   </span><span class="annot"><span class="annottext">Prog3 -&gt; PassM Prog3
</span><a href="#local-6989586621680993898"><span class="hs-identifier hs-var">tcProg3</span></a></span><span>                 </span><span class="annot"><span class="annottext">Prog3
</span><a href="#local-6989586621680994014"><span class="hs-identifier hs-var">l3</span></a></span><span>
</span><span id="line-822"></span><span>      </span><span id="local-6989586621680994016"><span class="annot"><span class="annottext">Prog3
</span><a href="#local-6989586621680994016"><span class="hs-identifier hs-var">l3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog3 -&gt; PassM Prog3)
-&gt; Prog3
-&gt; StateT (CompileState v) IO Prog3
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L3.flatten&quot;</span></span><span>     </span><span class="annot"><span class="annottext">Prog3 -&gt; PassM Prog3
</span><a href="Gibbon.Passes.Flatten.html#flattenL3"><span class="hs-identifier hs-var">flattenL3</span></a></span><span>               </span><span class="annot"><span class="annottext">Prog3
</span><a href="#local-6989586621680994015"><span class="hs-identifier hs-var">l3</span></a></span><span>
</span><span id="line-823"></span><span>      </span><span id="local-6989586621680994017"><span class="annot"><span class="annottext">Prog3
</span><a href="#local-6989586621680994017"><span class="hs-identifier hs-var">l3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog3 -&gt; PassM Prog3)
-&gt; Prog3
-&gt; StateT (CompileState v) IO Prog3
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;L3.typecheck&quot;</span></span><span>   </span><span class="annot"><span class="annottext">Prog3 -&gt; PassM Prog3
</span><a href="#local-6989586621680993898"><span class="hs-identifier hs-var">tcProg3</span></a></span><span>                 </span><span class="annot"><span class="annottext">Prog3
</span><a href="#local-6989586621680994016"><span class="hs-identifier hs-var">l3</span></a></span><span>
</span><span id="line-824"></span><span>
</span><span id="line-825"></span><span>      </span><span class="hs-comment">-- Note: L3 -&gt; L4</span><span>
</span><span id="line-826"></span><span>      </span><span id="local-6989586621680994018"><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621680994018"><span class="hs-identifier hs-var">l4</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog3 -&gt; PassM Prog)
-&gt; Prog3
-&gt; StateT (CompileState v) IO Prog
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;lower&quot;</span></span><span>          </span><span class="annot"><span class="annottext">Prog3 -&gt; PassM Prog
</span><a href="Gibbon.Passes.Lower.html#lower"><span class="hs-identifier hs-var">lower</span></a></span><span>                   </span><span class="annot"><span class="annottext">Prog3
</span><a href="#local-6989586621680994017"><span class="hs-identifier hs-var">l3</span></a></span><span>
</span><span id="line-827"></span><span>      </span><span id="local-6989586621680994019"><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621680994019"><span class="hs-identifier hs-var">l4</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog -&gt; PassM Prog) -&gt; Prog -&gt; StateT (CompileState v) IO Prog
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;lateInlineTriv&quot;</span></span><span> </span><span class="annot"><span class="annottext">Prog -&gt; PassM Prog
</span><a href="Gibbon.Passes.Simplifier.html#lateInlineTriv"><span class="hs-identifier hs-var">lateInlineTriv</span></a></span><span>          </span><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621680994018"><span class="hs-identifier hs-var">l4</span></a></span><span>
</span><span id="line-828"></span><span>      </span><span id="local-6989586621680994020"><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621680994020"><span class="hs-identifier hs-var">l4</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680993891"><span class="hs-identifier hs-var">gibbon1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680993887"><span class="hs-identifier hs-var">isPacked</span></a></span><span>
</span><span id="line-829"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-830"></span><span>              </span><span id="local-6989586621680994021"><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621680994021"><span class="hs-identifier hs-var">l4</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog -&gt; PassM Prog) -&gt; Prog -&gt; StateT (CompileState v) IO Prog
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rearrangeFree&quot;</span></span><span>  </span><span class="annot"><span class="annottext">Prog -&gt; PassM Prog
</span><a href="Gibbon.Passes.RearrangeFree.html#rearrangeFree"><span class="hs-identifier hs-var">rearrangeFree</span></a></span><span>   </span><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621680994019"><span class="hs-identifier hs-var">l4</span></a></span><span>
</span><span id="line-831"></span><span>              </span><span class="annot"><span class="annottext">Prog -&gt; StateT (CompileState v) IO Prog
forall a. a -&gt; StateT (CompileState v) IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621680994021"><span class="hs-identifier hs-var">l4</span></a></span><span>
</span><span id="line-832"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-833"></span><span>              </span><span id="local-6989586621680994022"><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621680994022"><span class="hs-identifier hs-var">l4</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog -&gt; PassM Prog) -&gt; Prog -&gt; StateT (CompileState v) IO Prog
forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;rearrangeFree&quot;</span></span><span>   </span><span class="annot"><span class="annottext">Prog -&gt; PassM Prog
</span><a href="Gibbon.Passes.RearrangeFree.html#rearrangeFree"><span class="hs-identifier hs-var">rearrangeFree</span></a></span><span>   </span><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621680994019"><span class="hs-identifier hs-var">l4</span></a></span><span>
</span><span id="line-834"></span><span>              </span><span class="hs-comment">-- l4 &lt;- go &quot;inlineTrivL4&quot;    (pure . L4.inlineTrivL4) l4</span><span>
</span><span id="line-835"></span><span>              </span><span class="annot"><span class="annottext">Prog -&gt; StateT (CompileState v) IO Prog
forall a. a -&gt; StateT (CompileState v) IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621680994022"><span class="hs-identifier hs-var">l4</span></a></span><span>
</span><span id="line-836"></span><span>      </span><span class="annot"><span class="annottext">Prog -&gt; StateT (CompileState v) IO Prog
forall a. a -&gt; StateT (CompileState v) IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prog
</span><a href="#local-6989586621680994020"><span class="hs-identifier hs-var">l4</span></a></span><span>
</span><span id="line-837"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-838"></span><span>      </span><span id="local-6989586621680991881"><span id="local-6989586621680991882"><span id="local-6989586621680991883"><span class="annot"><a href="#local-6989586621680993901"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Compiler.html#PassRunner"><span class="hs-identifier hs-type">PassRunner</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991881"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991882"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991883"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-839"></span><span>      </span><span id="local-6989586621680993901"><span class="annot"><span class="annottext">go :: forall a b v. PassRunner a b v
</span><a href="#local-6989586621680993901"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Config -&gt; PassRunner a b v
forall a b v. Config -&gt; PassRunner a b v
</span><a href="Gibbon.Compiler.html#pass"><span class="hs-identifier hs-var">pass</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680993884"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-840"></span><span>
</span><span id="line-841"></span><span>      </span><span id="local-6989586621680991902"><span id="local-6989586621680991903"><span id="local-6989586621680991904"><span class="annot"><a href="#local-6989586621680993944"><span class="hs-identifier hs-type">goE2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#InterpProg"><span class="hs-identifier hs-type">InterpProg</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Interp.html#Store"><span class="hs-identifier hs-type">Store</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991902"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991903"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Gibbon.Compiler.html#InterpPassRunner"><span class="hs-identifier hs-type">InterpPassRunner</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991904"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991902"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Interp.html#Store"><span class="hs-identifier hs-type">Store</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991903"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-842"></span><span>      </span><span id="local-6989586621680993944"><span class="annot"><span class="annottext">goE2 :: forall b v a.
(InterpProg Store b, Show v) =&gt;
InterpPassRunner a b Store v
</span><a href="#local-6989586621680993944"><span class="hs-identifier hs-var hs-var">goE2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Store -&gt; Config -&gt; InterpPassRunner a b Store v
forall s p2 v p1.
(InterpProg s p2, Show v) =&gt;
s -&gt; Config -&gt; InterpPassRunner p1 p2 s v
</span><a href="Gibbon.Compiler.html#passE"><span class="hs-identifier hs-var">passE</span></a></span><span> </span><span class="annot"><span class="annottext">Store
</span><a href="Gibbon.L2.Interp.html#emptyStore"><span class="hs-identifier hs-var">emptyStore</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680993884"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-843"></span><span>
</span><span id="line-844"></span><span>      </span><span id="local-6989586621680991885"><span id="local-6989586621680991886"><span id="local-6989586621680991887"><span class="annot"><a href="#local-6989586621680993903"><span class="hs-identifier hs-type">goE0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#InterpProg"><span class="hs-identifier hs-type">InterpProg</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680991885"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991886"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Gibbon.Compiler.html#InterpPassRunner"><span class="hs-identifier hs-type">InterpPassRunner</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991887"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991885"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680991886"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-845"></span><span>      </span><span id="local-6989586621680993903"><span class="annot"><span class="annottext">goE0 :: forall b v a.
(InterpProg () b, Show v) =&gt;
InterpPassRunner a b () v
</span><a href="#local-6989586621680993903"><span class="hs-identifier hs-var hs-var">goE0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Config -&gt; InterpPassRunner a b () v
forall s p2 v p1.
(InterpProg s p2, Show v) =&gt;
s -&gt; Config -&gt; InterpPassRunner p1 p2 s v
</span><a href="Gibbon.Compiler.html#passE"><span class="hs-identifier hs-var">passE</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680993884"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-846"></span><span>
</span><span id="line-847"></span><span>      </span><span id="local-6989586621680994073"><span id="local-6989586621680994074"><span id="local-6989586621680994075"><span class="annot"><a href="#local-6989586621680993920"><span class="hs-identifier hs-type">goE1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#InterpProg"><span class="hs-identifier hs-type">InterpProg</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680994073"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680994074"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Gibbon.Compiler.html#InterpPassRunner"><span class="hs-identifier hs-type">InterpPassRunner</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680994075"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680994073"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680994074"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-848"></span><span>      </span><span id="local-6989586621680993920"><span class="annot"><span class="annottext">goE1 :: forall b v a.
(InterpProg () b, Show v) =&gt;
InterpPassRunner a b () v
</span><a href="#local-6989586621680993920"><span class="hs-identifier hs-var hs-var">goE1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Config -&gt; InterpPassRunner a b () v
forall s p2 v p1.
(InterpProg s p2, Show v) =&gt;
s -&gt; Config -&gt; InterpPassRunner p1 p2 s v
</span><a href="Gibbon.Compiler.html#passE"><span class="hs-identifier hs-var">passE</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680993884"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-849"></span><span>
</span><span id="line-850"></span><span class="hs-keyword">type</span><span> </span><span id="PassRunner"><span class="annot"><a href="Gibbon.Compiler.html#PassRunner"><span class="hs-identifier hs-var">PassRunner</span></a></span></span><span> </span><span id="local-6989586621680994096"><span class="annot"><a href="#local-6989586621680994096"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621680994097"><span class="annot"><a href="#local-6989586621680994097"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621680994098"><span class="annot"><a href="#local-6989586621680994098"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Pretty.html#Pretty"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680994097"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/GenericPretty-1.2.2-7277c36a966d41cd8e1371a7ee4c855b29a76e94dfe1d95510f68242766a5b82/share/doc/html/src/Text.PrettyPrint.GenericPretty.html#Out"><span class="hs-identifier hs-type">Out</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680994097"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/deepseq-1.4.8.0/src/Control.DeepSeq.html#NFData"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680994096"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/deepseq-1.4.8.0/src/Control.DeepSeq.html#NFData"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680994097"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-851"></span><span>                         </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680994096"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680994097"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680994096"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Strict.html#StateT"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Compiler.html#CompileState"><span class="hs-identifier hs-type">CompileState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680994098"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680994097"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-852"></span><span>
</span><span id="line-853"></span><span class="hs-keyword">type</span><span> </span><span id="InterpPassRunner"><span class="annot"><a href="Gibbon.Compiler.html#InterpPassRunner"><span class="hs-identifier hs-var">InterpPassRunner</span></a></span></span><span> </span><span id="local-6989586621680994099"><span class="annot"><a href="#local-6989586621680994099"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621680994100"><span class="annot"><a href="#local-6989586621680994100"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621680994101"><span class="annot"><a href="#local-6989586621680994101"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621680994102"><span class="annot"><a href="#local-6989586621680994102"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Pretty.html#HasPretty"><span class="hs-identifier hs-type">HasPretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680994099"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Pretty.html#HasPretty"><span class="hs-identifier hs-type">HasPretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680994100"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#HasOut"><span class="hs-identifier hs-type">HasOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680994099"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#HasOut"><span class="hs-identifier hs-type">HasOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680994100"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-854"></span><span>                                </span><span class="annot"><a href="Gibbon.Language.Syntax.html#HasGeneric"><span class="hs-identifier hs-type">HasGeneric</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680994099"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#HasGeneric"><span class="hs-identifier hs-type">HasGeneric</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680994100"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#HasNFData"><span class="hs-identifier hs-type">HasNFData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680994099"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#HasNFData"><span class="hs-identifier hs-type">HasNFData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680994100"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-855"></span><span>                                </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680994099"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680994100"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680994099"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Strict.html#StateT"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Compiler.html#CompileState"><span class="hs-identifier hs-type">CompileState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680994102"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680994100"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-856"></span><span>
</span><span id="line-857"></span><span class="hs-comment">-- | Run a pass and return the result</span><span>
</span><span id="line-858"></span><span class="hs-comment">--</span><span>
</span><span id="line-859"></span><span id="local-6989586621680991910"><span id="local-6989586621680991911"><span id="local-6989586621680991912"><span class="annot"><a href="Gibbon.Compiler.html#pass"><span class="hs-identifier hs-type">pass</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Compiler.html#PassRunner"><span class="hs-identifier hs-type">PassRunner</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991910"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991911"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991912"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-860"></span><span id="pass"><span class="annot"><span class="annottext">pass :: forall a b v. Config -&gt; PassRunner a b v
</span><a href="Gibbon.Compiler.html#pass"><span class="hs-identifier hs-var hs-var">pass</span></a></span></span><span> </span><span id="local-6989586621680994150"><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680994150"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621680994151"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680994151"><span class="hs-identifier hs-var">who</span></a></span></span><span> </span><span id="local-6989586621680994152"><span class="annot"><span class="annottext">a -&gt; PassM b
</span><a href="#local-6989586621680994152"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621680994153"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680994153"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-861"></span><span>  </span><span id="local-6989586621680994154"><span class="annot"><span class="annottext">cs :: CompileState v
</span><a href="#local-6989586621680994154"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Compiler.html#CompileState"><span class="hs-identifier hs-type">CompileState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680994155"><span class="annot"><span class="annottext">Int
cnt :: forall a. CompileState a -&gt; Int
cnt :: Int
</span><a href="Gibbon.Compiler.html#cnt"><span class="hs-identifier hs-var hs-var">cnt</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT (CompileState v) IO (CompileState v)
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-862"></span><span>  </span><span id="local-6989586621680994157"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680994157"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Gibbon.Common.html#dbgLvl"><span class="hs-identifier hs-var">dbgLvl</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Gibbon.Compiler.html#passChatterLvl"><span class="hs-identifier hs-var">passChatterLvl</span></a></span><span>
</span><span id="line-863"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">IO a -&gt; StateT (CompileState v) IO a
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; StateT (CompileState v) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(IO a -&gt; StateT (CompileState v) IO a)
-&gt; IO a -&gt; StateT (CompileState v) IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; IO a
forall a. a -&gt; IO a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.html#evaluate"><span class="hs-identifier hs-var">evaluate</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; IO a) -&gt; a -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. NFData a =&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/deepseq-1.4.8.0/src/Control.DeepSeq.html#force"><span class="hs-identifier hs-var">force</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680994153"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-864"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a -&gt; StateT (CompileState v) IO a
forall a. a -&gt; StateT (CompileState v) IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680994153"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-865"></span><span>  </span><span class="annot"><span class="annottext">IO () -&gt; StateT (CompileState v) IO ()
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; StateT (CompileState v) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span class="annot"><span class="annottext">(IO () -&gt; StateT (CompileState v) IO ())
-&gt; IO () -&gt; StateT (CompileState v) IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; IO ()
</span><a href="Gibbon.Common.html#dbgPrint"><span class="hs-identifier hs-var">dbgPrint</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Gibbon.Compiler.html#passChatterLvl"><span class="hs-identifier hs-var">passChatterLvl</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; [compiler] Running pass, &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680994151"><span class="hs-identifier hs-var">who</span></a></span><span>
</span><span id="line-866"></span><span>
</span><span id="line-867"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680994159"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680994159"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680994160"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680994160"><span class="hs-identifier hs-var">cnt'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Config -&gt; Int -&gt; PassM b -&gt; (b, Int)
forall a. Config -&gt; Int -&gt; PassM a -&gt; (a, Int)
</span><a href="Gibbon.Common.html#runPassM"><span class="hs-identifier hs-var">runPassM</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680994150"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680994155"><span class="hs-identifier hs-var">cnt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; PassM b
</span><a href="#local-6989586621680994152"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680994157"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-868"></span><span>  </span><span class="annot"><span class="annottext">CompileState v -&gt; StateT (CompileState v) IO ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">CompileState v
</span><a href="#local-6989586621680994154"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">cnt :: Int
</span><a href="Gibbon.Compiler.html#cnt"><span class="hs-identifier hs-var">cnt</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680994160"><span class="hs-identifier hs-var">cnt'</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-869"></span><span>  </span><span id="local-6989586621680994162"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680994162"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Gibbon.Common.html#dbgLvl"><span class="hs-identifier hs-var">dbgLvl</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Gibbon.Compiler.html#passChatterLvl"><span class="hs-identifier hs-var">passChatterLvl</span></a></span><span>
</span><span id="line-870"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">IO b -&gt; StateT (CompileState v) IO b
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; StateT (CompileState v) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(IO b -&gt; StateT (CompileState v) IO b)
-&gt; IO b -&gt; StateT (CompileState v) IO b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; IO b
forall a. a -&gt; IO a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.html#evaluate"><span class="hs-identifier hs-var">evaluate</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; IO b) -&gt; b -&gt; IO b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b
forall a. NFData a =&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/deepseq-1.4.8.0/src/Control.DeepSeq.html#force"><span class="hs-identifier hs-var">force</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680994159"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-871"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">b -&gt; StateT (CompileState v) IO b
forall a. a -&gt; StateT (CompileState v) IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680994159"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-872"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Gibbon.Common.html#dbgLvl"><span class="hs-identifier hs-var">dbgLvl</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Gibbon.Compiler.html#passChatterLvl"><span class="hs-identifier hs-var">passChatterLvl</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-873"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; StateT (CompileState v) IO ()
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; StateT (CompileState v) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span class="annot"><span class="annottext">(IO () -&gt; StateT (CompileState v) IO ())
-&gt; IO () -&gt; StateT (CompileState v) IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; IO ()
</span><a href="Gibbon.Common.html#dbgPrintLn"><span class="hs-identifier hs-var">dbgPrintLn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="Gibbon.Compiler.html#passChatterLvl"><span class="hs-identifier hs-var">passChatterLvl</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Pass output:\n&quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">String
</span><a href="Gibbon.Compiler.html#sepline"><span class="hs-identifier hs-var">sepline</span></a></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; String
forall e. Pretty e =&gt; e -&gt; String
</span><a href="Gibbon.Pretty.html#pprender"><span class="hs-identifier hs-var">pprender</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680994162"><span class="hs-identifier hs-var">y'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-874"></span><span>     </span><span class="hs-comment">-- TODO: Switch to a node-count for size output (add to GenericOps):</span><span>
</span><span id="line-875"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; StateT (CompileState v) IO ()
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; StateT (CompileState v) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span class="annot"><span class="annottext">(IO () -&gt; StateT (CompileState v) IO ())
-&gt; IO () -&gt; StateT (CompileState v) IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; IO ()
</span><a href="Gibbon.Common.html#dbgPrintLn"><span class="hs-identifier hs-var">dbgPrintLn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Gibbon.Compiler.html#passChatterLvl"><span class="hs-identifier hs-var">passChatterLvl</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;   =&gt; &quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; String
forall a. Out a =&gt; a -&gt; String
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680994162"><span class="hs-identifier hs-var">y'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; characters output.&quot;</span></span><span>
</span><span id="line-876"></span><span>  </span><span class="annot"><span class="annottext">b -&gt; StateT (CompileState v) IO b
forall a. a -&gt; StateT (CompileState v) IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621680994162"><span class="hs-identifier hs-var">y'</span></a></span><span>
</span><span id="line-877"></span><span>
</span><span id="line-878"></span><span>
</span><span id="line-879"></span><span class="annot"><a href="Gibbon.Compiler.html#passChatterLvl"><span class="hs-identifier hs-type">passChatterLvl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-880"></span><span id="passChatterLvl"><span class="annot"><span class="annottext">passChatterLvl :: Int
</span><a href="Gibbon.Compiler.html#passChatterLvl"><span class="hs-identifier hs-var hs-var">passChatterLvl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-881"></span><span>
</span><span id="line-882"></span><span>
</span><span id="line-883"></span><span class="hs-comment">-- | Like 'pass', but also evaluates and checks the result.</span><span>
</span><span id="line-884"></span><span class="hs-comment">--</span><span>
</span><span id="line-885"></span><span id="local-6989586621680991916"><span id="local-6989586621680991917"><span id="local-6989586621680991918"><span id="local-6989586621680991919"><span class="annot"><a href="Gibbon.Compiler.html#passE"><span class="hs-identifier hs-type">passE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#InterpProg"><span class="hs-identifier hs-type">InterpProg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991916"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991917"><span class="hs-identifier hs-type">p2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991918"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680991916"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Compiler.html#InterpPassRunner"><span class="hs-identifier hs-type">InterpPassRunner</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991919"><span class="hs-identifier hs-type">p1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991917"><span class="hs-identifier hs-type">p2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991916"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991918"><span class="hs-identifier hs-type">v</span></a></span></span></span></span></span><span>
</span><span id="line-886"></span><span id="passE"><span class="annot"><span class="annottext">passE :: forall s p2 v p1.
(InterpProg s p2, Show v) =&gt;
s -&gt; Config -&gt; InterpPassRunner p1 p2 s v
</span><a href="Gibbon.Compiler.html#passE"><span class="hs-identifier hs-var hs-var">passE</span></a></span></span><span> </span><span id="local-6989586621680994196"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621680994196"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621680994197"><span class="annot"><span class="annottext">config :: Config
</span><a href="#local-6989586621680994197"><span class="hs-identifier hs-var">config</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Common.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span class="hs-special">{</span><span id="local-6989586621680994198"><span class="annot"><span class="annottext">Mode
mode :: Config -&gt; Mode
mode :: Mode
</span><a href="Gibbon.Common.html#mode"><span class="hs-identifier hs-var hs-var">mode</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s
-&gt; Mode -&gt; InterpPassRunner p1 p2 s v -&gt; InterpPassRunner p1 p2 s v
forall s b v a.
(InterpProg s b, Show v) =&gt;
s -&gt; Mode -&gt; InterpPassRunner a b s v -&gt; InterpPassRunner a b s v
</span><a href="Gibbon.Compiler.html#wrapInterp"><span class="hs-identifier hs-var">wrapInterp</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621680994196"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621680994198"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Config -&gt; PassRunner (Prog p1) (Prog p2) v
forall a b v. Config -&gt; PassRunner a b v
</span><a href="Gibbon.Compiler.html#pass"><span class="hs-identifier hs-var">pass</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621680994197"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-887"></span><span>
</span><span id="line-888"></span><span>
</span><span id="line-889"></span><span class="hs-comment">-- | An alternative version that allows FAILURE while running</span><span>
</span><span id="line-890"></span><span class="hs-comment">-- the interpreter part.</span><span>
</span><span id="line-891"></span><span class="hs-comment">-- FINISHME! For now not interpreting.</span><span>
</span><span id="line-892"></span><span class="hs-comment">--</span><span>
</span><span id="line-893"></span><span id="local-6989586621680994212"><span id="local-6989586621680994213"><span id="local-6989586621680994214"><span class="annot"><a href="Gibbon.Compiler.html#passF"><span class="hs-identifier hs-type">passF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Compiler.html#PassRunner"><span class="hs-identifier hs-type">PassRunner</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680994212"><span class="hs-identifier hs-type">p1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680994213"><span class="hs-identifier hs-type">p2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680994214"><span class="hs-identifier hs-type">v</span></a></span></span></span></span><span>
</span><span id="line-894"></span><span id="passF"><span class="annot"><span class="annottext">passF :: forall a b v. Config -&gt; PassRunner a b v
</span><a href="Gibbon.Compiler.html#passF"><span class="hs-identifier hs-var hs-var">passF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Config
-&gt; String
-&gt; (p1 -&gt; PassM p2)
-&gt; p1
-&gt; StateT (CompileState v) IO p2
Config -&gt; PassRunner p1 p2 v
forall a b v. Config -&gt; PassRunner a b v
</span><a href="Gibbon.Compiler.html#pass"><span class="hs-identifier hs-var">pass</span></a></span><span>
</span><span id="line-895"></span><span>
</span><span id="line-896"></span><span>
</span><span id="line-897"></span><span class="hs-comment">-- | Wrapper to enable running a pass AND interpreting the result.</span><span>
</span><span id="line-898"></span><span class="hs-comment">--</span><span>
</span><span id="line-899"></span><span id="local-6989586621680991939"><span id="local-6989586621680991940"><span id="local-6989586621680991941"><span id="local-6989586621680991942"><span class="annot"><a href="Gibbon.Compiler.html#wrapInterp"><span class="hs-identifier hs-type">wrapInterp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#InterpProg"><span class="hs-identifier hs-type">InterpProg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991939"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991940"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991941"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-900"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621680991939"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Compiler.html#InterpPassRunner"><span class="hs-identifier hs-type">InterpPassRunner</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991942"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991940"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991939"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991941"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Compiler.html#InterpPassRunner"><span class="hs-identifier hs-type">InterpPassRunner</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991942"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991940"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991939"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680991941"><span class="hs-identifier hs-type">v</span></a></span></span></span></span></span><span>
</span><span id="line-901"></span><span id="wrapInterp"><span class="annot"><span class="annottext">wrapInterp :: forall s b v a.
(InterpProg s b, Show v) =&gt;
s -&gt; Mode -&gt; InterpPassRunner a b s v -&gt; InterpPassRunner a b s v
</span><a href="Gibbon.Compiler.html#wrapInterp"><span class="hs-identifier hs-var hs-var">wrapInterp</span></a></span></span><span> </span><span id="local-6989586621680994298"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621680994298"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621680994299"><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621680994299"><span class="hs-identifier hs-var">mode</span></a></span></span><span> </span><span id="local-6989586621680994300"><span class="annot"><span class="annottext">InterpPassRunner a b s v
</span><a href="#local-6989586621680994300"><span class="hs-identifier hs-var">pass</span></a></span></span><span> </span><span id="local-6989586621680994301"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680994301"><span class="hs-identifier hs-var">who</span></a></span></span><span> </span><span id="local-6989586621680994302"><span class="annot"><span class="annottext">Prog a -&gt; PassM (Prog b)
</span><a href="#local-6989586621680994302"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621680994303"><span class="annot"><span class="annottext">Prog a
</span><a href="#local-6989586621680994303"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-902"></span><span>  </span><span class="hs-keyword">do</span><span> </span><span class="annot"><a href="Gibbon.Compiler.html#CompileState"><span class="hs-identifier hs-type">CompileState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680994304"><span class="annot"><span class="annottext">Maybe (Value v)
result :: forall a. CompileState a -&gt; Maybe (Value a)
result :: Maybe (Value v)
</span><a href="Gibbon.Compiler.html#result"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT (CompileState v) IO (CompileState v)
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span>
</span><span id="line-903"></span><span>     </span><span id="local-6989586621680994305"><span class="annot"><span class="annottext">Prog b
</span><a href="#local-6989586621680994305"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Prog a -&gt; PassM (Prog b))
-&gt; Prog a
-&gt; StateT (CompileState v) IO (Prog b)
InterpPassRunner a b s v
</span><a href="#local-6989586621680994300"><span class="hs-identifier hs-var">pass</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680994301"><span class="hs-identifier hs-var">who</span></a></span><span> </span><span class="annot"><span class="annottext">Prog a -&gt; PassM (Prog b)
</span><a href="#local-6989586621680994302"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Prog a
</span><a href="#local-6989586621680994303"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-904"></span><span>     </span><span class="hs-comment">-- In benchmark mode we simply turn OFF the interpreter.</span><span>
</span><span id="line-905"></span><span>     </span><span class="hs-comment">-- This decision should be finer grained.</span><span>
</span><span id="line-906"></span><span>     </span><span class="annot"><span class="annottext">Bool
-&gt; StateT (CompileState v) IO () -&gt; StateT (CompileState v) IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="Gibbon.Common.html#dbgLvl"><span class="hs-identifier hs-var">dbgLvl</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Gibbon.Compiler.html#interpDbgLevel"><span class="hs-identifier hs-var">interpDbgLevel</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mode -&gt; Bool
</span><a href="Gibbon.Compiler.html#isBench"><span class="hs-identifier hs-var">isBench</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621680994299"><span class="hs-identifier hs-var">mode</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(StateT (CompileState v) IO () -&gt; StateT (CompileState v) IO ())
-&gt; StateT (CompileState v) IO () -&gt; StateT (CompileState v) IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; StateT (CompileState v) IO ()
forall (m :: * -&gt; *) a.
Monad m =&gt;
m a -&gt; StateT (CompileState v) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift"><span class="hs-identifier hs-var">lift</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; StateT (CompileState v) IO ())
-&gt; IO () -&gt; StateT (CompileState v) IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-907"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680994306"><span class="annot"><span class="annottext">Value v
</span><a href="#local-6989586621680994306"><span class="hs-identifier hs-var">res1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Value v)
</span><a href="#local-6989586621680994304"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-908"></span><span>       </span><span class="hs-comment">-- FIXME: no command line option atm.  Just env vars.</span><span>
</span><span id="line-909"></span><span>       </span><span id="local-6989586621680994307"><span class="annot"><span class="annottext">RunConfig
</span><a href="#local-6989586621680994307"><span class="hs-identifier hs-var">runConf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; IO RunConfig
</span><a href="Gibbon.Common.html#getRunConfig"><span class="hs-identifier hs-var">getRunConfig</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-910"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680994308"><span class="annot"><span class="annottext">res2 :: String
</span><a href="#local-6989586621680994308"><span class="hs-identifier hs-var hs-var">res2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s -&gt; RunConfig -&gt; Prog b -&gt; String
forall s e. InterpProg s e =&gt; s -&gt; RunConfig -&gt; Prog e -&gt; String
</span><a href="Gibbon.Language.Syntax.html#gInterpNoLogs"><span class="hs-identifier hs-var">gInterpNoLogs</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621680994298"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">RunConfig
</span><a href="#local-6989586621680994307"><span class="hs-identifier hs-var">runConf</span></a></span><span> </span><span class="annot"><span class="annottext">Prog b
</span><a href="#local-6989586621680994305"><span class="hs-identifier hs-var">p2</span></a></span><span>
</span><span id="line-911"></span><span>       </span><span id="local-6989586621680994310"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680994310"><span class="hs-identifier hs-var">res2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (SomeException -&gt; IO String) -&gt; IO String
forall e a. Exception e =&gt; IO a -&gt; (e -&gt; IO a) -&gt; IO a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.html#catch"><span class="hs-identifier hs-var">catch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IO String
forall a. a -&gt; IO a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.IO.html#evaluate"><span class="hs-identifier hs-var">evaluate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
forall a. NFData a =&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/deepseq-1.4.8.0/src/Control.DeepSeq.html#force"><span class="hs-identifier hs-var">force</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680994308"><span class="hs-identifier hs-var">res2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-912"></span><span>                </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680994311"><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621680994311"><span class="hs-identifier hs-var">exn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO String) -&gt; String -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-913"></span><span>                  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Exception while running interpreter on pass result:\n&quot;</span></span><span>
</span><span id="line-914"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Gibbon.Compiler.html#sepline"><span class="hs-identifier hs-var">sepline</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-915"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621680994311"><span class="hs-identifier hs-var">exn</span></a></span><span class="hs-glyph">::</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Exception.Type.html#SomeException"><span class="hs-identifier hs-type">SomeException</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-916"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Gibbon.Compiler.html#sepline"><span class="hs-identifier hs-var">sepline</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-917"></span><span>                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Program was: &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Prog b -&gt; String
forall a. Out a =&gt; Int -&gt; a -&gt; String
</span><a href="Gibbon.Common.html#abbrv"><span class="hs-identifier hs-var">abbrv</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">300</span></span><span> </span><span class="annot"><span class="annottext">Prog b
</span><a href="#local-6989586621680994305"><span class="hs-identifier hs-var">p2</span></a></span><span>
</span><span id="line-918"></span><span>                  </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-919"></span><span>       </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Control.Monad.html#unless"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Value v
</span><a href="#local-6989586621680994306"><span class="hs-identifier hs-var">res1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680994310"><span class="hs-identifier hs-var">res2'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-920"></span><span>         </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-921"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;After pass &quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680994301"><span class="hs-identifier hs-var">who</span></a></span><span>
</span><span id="line-922"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, evaluating the program yielded the wrong answer.\nReceived:  &quot;</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680994310"><span class="hs-identifier hs-var">res2'</span></a></span><span>
</span><span id="line-923"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\nExpected:  &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Value v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Value v
</span><a href="#local-6989586621680994306"><span class="hs-identifier hs-var">res1</span></a></span><span>
</span><span id="line-924"></span><span>          </span><span class="hs-special">]</span><span>
</span><span id="line-925"></span><span>       </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; IO ()
</span><a href="Gibbon.Common.html#dbgPrintLn"><span class="hs-identifier hs-var">dbgPrintLn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Gibbon.Compiler.html#interpDbgLevel"><span class="hs-identifier hs-var">interpDbgLevel</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#mconcat"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-926"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; [interp] answer after &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680994301"><span class="hs-identifier hs-var">who</span></a></span><span>
</span><span id="line-927"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; was: &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680994310"><span class="hs-identifier hs-var">res2'</span></a></span><span>
</span><span id="line-928"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-929"></span><span>     </span><span class="annot"><span class="annottext">Prog b -&gt; StateT (CompileState v) IO (Prog b)
forall a. a -&gt; StateT (CompileState v) IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Prog b
</span><a href="#local-6989586621680994305"><span class="hs-identifier hs-var">p2</span></a></span><span>
</span><span id="line-930"></span></pre></body></html>
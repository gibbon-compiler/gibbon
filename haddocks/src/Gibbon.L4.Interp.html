<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="annot"><span class="hs-comment">-- | Interpreter for the target language (L4)</span></span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-orphans #-}</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Gibbon.L4.Interp</span><span>
</span><span id="line-9"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Gibbon.L4.Interp.html#Val"><span class="hs-identifier">Val</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L4.Interp.html#applyPrim"><span class="hs-identifier">applyPrim</span></a></span><span>
</span><span id="line-10"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L4.Interp.html#execProg"><span class="hs-identifier">execProg</span></a></span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Strict.html"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Maybe.html#listToMaybe"><span class="hs-identifier">listToMaybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Sequence.html"><span class="hs-identifier">Data.Sequence</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#Seq"><span class="hs-identifier">Seq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#ViewL"><span class="hs-identifier">ViewL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#%3A%3C"><span class="hs-operator">(:&lt;)</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#%7C%3E"><span class="hs-operator">(|&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Sequence.html"><span class="hs-identifier">Data.Sequence</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Seq</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html"><span class="hs-identifier">Gibbon.L4.Syntax</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Gibbon.Common.html"><span class="hs-identifier">Gibbon.Common</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier">fromVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Generics.html"><span class="hs-identifier">GHC.Generics</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/deepseq-1.4.8.0/src/Control.DeepSeq.html"><span class="hs-identifier">Control.DeepSeq</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/GenericPretty-1.2.2-7277c36a966d41cd8e1371a7ee4c855b29a76e94dfe1d95510f68242766a5b82/share/doc/html/src/Text.PrettyPrint.GenericPretty.html"><span class="hs-identifier">Text.PrettyPrint.GenericPretty</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/pretty-1.1.3.6/src/Text.PrettyPrint.html"><span class="hs-identifier">Text.PrettyPrint</span></a></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-comment">-- import Data.Time.Clock</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/clock-0.8.4-e74b45a1c99d0dbcdb2c4c619c1a606f25f547f2444c2c9d41c64f44496bfb39/share/doc/html/src/System.Clock.html"><span class="hs-identifier">System.Clock</span></a></span><span>
</span><span id="line-30"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-keyword">data</span><span> </span><span id="Val"><span class="annot"><a href="Gibbon.L4.Interp.html#Val"><span class="hs-identifier hs-var">Val</span></a></span></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="FunVal"><span class="annot"><a href="Gibbon.L4.Interp.html#FunVal"><span class="hs-identifier hs-var">FunVal</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#FunDecl"><span class="hs-identifier hs-type">FunDecl</span></a></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="IntVal"><span class="annot"><a href="Gibbon.L4.Interp.html#IntVal"><span class="hs-identifier hs-var">IntVal</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ These also serve as Bools</span></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="CharVal"><span class="annot"><a href="Gibbon.L4.Interp.html#CharVal"><span class="hs-identifier hs-var">CharVal</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="FloatVal"><span class="annot"><a href="Gibbon.L4.Interp.html#FloatVal"><span class="hs-identifier hs-var">FloatVal</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ These also serve as Bools</span></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="TagVal"><span class="annot"><a href="Gibbon.L4.Interp.html#TagVal"><span class="hs-identifier hs-var">TagVal</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Tag"><span class="hs-identifier hs-type">Tag</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="BufVal"><span class="annot"><a href="Gibbon.L4.Interp.html#BufVal"><span class="hs-identifier hs-var">BufVal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ Tags are also written as integers.</span></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680947339"><span id="local-6989586621680947353"><span class="annot"><span class="annottext">Val -&gt; Val -&gt; Bool
(Val -&gt; Val -&gt; Bool) -&gt; (Val -&gt; Val -&gt; Bool) -&gt; Eq Val
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Val -&gt; Val -&gt; Bool
== :: Val -&gt; Val -&gt; Bool
$c/= :: Val -&gt; Val -&gt; Bool
/= :: Val -&gt; Val -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680947358"><span id="local-6989586621680947379"><span id="local-6989586621680947383"><span class="annot"><span class="annottext">Int -&gt; Val -&gt; ShowS
[Val] -&gt; ShowS
Val -&gt; String
(Int -&gt; Val -&gt; ShowS)
-&gt; (Val -&gt; String) -&gt; ([Val] -&gt; ShowS) -&gt; Show Val
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Val -&gt; ShowS
showsPrec :: Int -&gt; Val -&gt; ShowS
$cshow :: Val -&gt; String
show :: Val -&gt; String
$cshowList :: [Val] -&gt; ShowS
showList :: [Val] -&gt; ShowS
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680947387"><span id="local-6989586621680947389"><span class="annot"><span class="annottext">(forall x. Val -&gt; Rep Val x)
-&gt; (forall x. Rep Val x -&gt; Val) -&gt; Generic Val
forall x. Rep Val x -&gt; Val
forall x. Val -&gt; Rep Val x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. Val -&gt; Rep Val x
from :: forall x. Val -&gt; Rep Val x
$cto :: forall x. Rep Val x -&gt; Val
to :: forall x. Rep Val x -&gt; Val
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Generics.html#Generic"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680947393"><span class="annot"><span class="annottext">Val -&gt; ()
(Val -&gt; ()) -&gt; NFData Val
forall a. (a -&gt; ()) -&gt; NFData a
$crnf :: Val -&gt; ()
rnf :: Val -&gt; ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/deepseq-1.4.8.0/src/Control.DeepSeq.html#NFData"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/deepseq-1.4.8.0/src/Control.DeepSeq.html#NFData"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/clock-0.8.4-e74b45a1c99d0dbcdb2c4c619c1a606f25f547f2444c2c9d41c64f44496bfb39/share/doc/html/src/System.Clock.html#TimeSpec"><span class="hs-identifier hs-type">TimeSpec</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-43"></span><span>  </span><span id="local-6989586621680947440"><span class="annot"><span class="annottext">rnf :: TimeSpec -&gt; ()
</span><a href="#local-6989586621680947440"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/clock-0.8.4-e74b45a1c99d0dbcdb2c4c619c1a606f25f547f2444c2c9d41c64f44496bfb39/share/doc/html/src/System.Clock.html#TimeSpec"><span class="hs-identifier hs-type">TimeSpec</span></a></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="annottext">Int64
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="annottext">Int64
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-comment">{-
instance Out UTCTime where
    doc s = text (show s)
    docPrec n s = text (show s)
-}</span><span>
</span><span id="line-50"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680947446"><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/GenericPretty-1.2.2-7277c36a966d41cd8e1371a7ee4c855b29a76e94dfe1d95510f68242766a5b82/share/doc/html/src/Text.PrettyPrint.GenericPretty.html#Out"><span class="hs-identifier hs-type">Out</span></a></span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/clock-0.8.4-e74b45a1c99d0dbcdb2c4c619c1a606f25f547f2444c2c9d41c64f44496bfb39/share/doc/html/src/System.Clock.html#TimeSpec"><span class="hs-identifier hs-type">TimeSpec</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-51"></span><span>    </span><span id="local-6989586621680947452"><span class="annot"><span class="annottext">doc :: TimeSpec -&gt; Doc
</span><a href="#local-6989586621680947452"><span class="hs-identifier hs-var hs-var hs-var hs-var">doc</span></a></span></span><span> </span><span id="local-6989586621680947454"><span class="annot"><span class="annottext">TimeSpec
</span><a href="#local-6989586621680947454"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/pretty-1.1.3.6/src/Text.PrettyPrint.HughesPJ.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TimeSpec -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">TimeSpec
</span><a href="#local-6989586621680947454"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>    </span><span id="local-6989586621680947458"><span class="annot"><span class="annottext">docPrec :: Int -&gt; TimeSpec -&gt; Doc
</span><a href="#local-6989586621680947458"><span class="hs-identifier hs-var hs-var hs-var hs-var">docPrec</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680947460"><span class="annot"><span class="annottext">TimeSpec
</span><a href="#local-6989586621680947460"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/pretty-1.1.3.6/src/Text.PrettyPrint.HughesPJ.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TimeSpec -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">TimeSpec
</span><a href="#local-6989586621680947460"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680947462"><span id="local-6989586621680947469"><span id="local-6989586621680947475"><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/GenericPretty-1.2.2-7277c36a966d41cd8e1371a7ee4c855b29a76e94dfe1d95510f68242766a5b82/share/doc/html/src/Text.PrettyPrint.GenericPretty.html#Out"><span class="hs-identifier hs-type">Out</span></a></span><span> </span><span class="annot"><a href="Gibbon.L4.Interp.html#Val"><span class="hs-identifier hs-type">Val</span></a></span></span></span></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680947604"><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/GenericPretty-1.2.2-7277c36a966d41cd8e1371a7ee4c855b29a76e94dfe1d95510f68242766a5b82/share/doc/html/src/Text.PrettyPrint.GenericPretty.html#Out"><span class="hs-identifier hs-type">Out</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a></span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-57"></span><span>    </span><span id="local-6989586621680947608"><span class="annot"><span class="annottext">doc :: Seq Int -&gt; Doc
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/GenericPretty-1.2.2-7277c36a966d41cd8e1371a7ee4c855b29a76e94dfe1d95510f68242766a5b82/share/doc/html/src/Text.PrettyPrint.GenericPretty.html#doc"><span class="hs-identifier hs-var hs-var hs-var hs-var">doc</span></a></span></span><span> </span><span id="local-6989586621680947609"><span class="annot"><span class="annottext">Seq Int
</span><a href="#local-6989586621680947609"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/pretty-1.1.3.6/src/Text.PrettyPrint.HughesPJ.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Int
</span><a href="#local-6989586621680947609"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>    </span><span id="local-6989586621680947612"><span class="annot"><span class="annottext">docPrec :: Int -&gt; Seq Int -&gt; Doc
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/GenericPretty-1.2.2-7277c36a966d41cd8e1371a7ee4c855b29a76e94dfe1d95510f68242766a5b82/share/doc/html/src/Text.PrettyPrint.GenericPretty.html#docPrec"><span class="hs-identifier hs-var hs-var hs-var hs-var">docPrec</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680947613"><span class="annot"><span class="annottext">Seq Int
</span><a href="#local-6989586621680947613"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/pretty-1.1.3.6/src/Text.PrettyPrint.HughesPJ.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Int
</span><a href="#local-6989586621680947613"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="annot"><a href="Gibbon.L4.Interp.html#execProg"><span class="hs-identifier hs-type">execProg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Interp.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-61"></span><span id="execProg"><span class="annot"><span class="annottext">execProg :: Prog -&gt; IO [Val]
</span><a href="Gibbon.L4.Interp.html#execProg"><span class="hs-identifier hs-var hs-var">execProg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span class="annot"><span class="annottext">InfoTable
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SymTable
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[FunDecl]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe MainExp
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO [Val]
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Can't evaluate program: No expression given&quot;</span></span><span>
</span><span id="line-62"></span><span class="annot"><a href="Gibbon.L4.Interp.html#execProg"><span class="hs-identifier hs-var">execProg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span class="annot"><span class="annottext">InfoTable
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SymTable
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680947620"><span class="annot"><span class="annottext">[FunDecl]
</span><a href="#local-6989586621680947620"><span class="hs-identifier hs-var">funs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#PrintExp"><span class="hs-identifier hs-type">PrintExp</span></a></span><span> </span><span id="local-6989586621680947622"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947622"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Env -&gt; Tail -&gt; IO [Val]
</span><a href="Gibbon.L4.Interp.html#exec"><span class="hs-identifier hs-var">exec</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947624"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947622"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-64"></span><span>    </span><span id="local-6989586621680947624"><span class="annot"><span class="annottext">env :: Env
</span><a href="#local-6989586621680947624"><span class="hs-identifier hs-var hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Var, Val)] -&gt; Env
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Strict.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FunDecl -&gt; (Var, Val)) -&gt; [FunDecl] -&gt; [(Var, Val)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680947626"><span class="annot"><span class="annottext">FunDecl
</span><a href="#local-6989586621680947626"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunDecl -&gt; Var
</span><a href="Gibbon.L4.Syntax.html#funName"><span class="hs-identifier hs-var">funName</span></a></span><span> </span><span class="annot"><span class="annottext">FunDecl
</span><a href="#local-6989586621680947626"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FunDecl -&gt; Val
</span><a href="Gibbon.L4.Interp.html#FunVal"><span class="hs-identifier hs-var">FunVal</span></a></span><span> </span><span class="annot"><span class="annottext">FunDecl
</span><a href="#local-6989586621680947626"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FunDecl]
</span><a href="#local-6989586621680947620"><span class="hs-identifier hs-var">funs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-keyword">type</span><span> </span><span id="Env"><span class="annot"><a href="Gibbon.L4.Interp.html#Env"><span class="hs-identifier hs-var">Env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">M.Map</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="Gibbon.L4.Interp.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="annot"><a href="Gibbon.L4.Interp.html#clk"><span class="hs-identifier hs-type">clk</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/clock-0.8.4-e74b45a1c99d0dbcdb2c4c619c1a606f25f547f2444c2c9d41c64f44496bfb39/share/doc/html/src/System.Clock.html#Clock"><span class="hs-identifier hs-type">Clock</span></a></span><span>
</span><span id="line-70"></span><span id="clk"><span class="annot"><span class="annottext">clk :: Clock
</span><a href="Gibbon.L4.Interp.html#clk"><span class="hs-identifier hs-var hs-var">clk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Clock
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/clock-0.8.4-e74b45a1c99d0dbcdb2c4c619c1a606f25f547f2444c2c9d41c64f44496bfb39/share/doc/html/src/System.Clock.html#Monotonic"><span class="hs-identifier hs-var">Monotonic</span></a></span><span>
</span><span id="line-71"></span><span class="hs-comment">-- Linux specific:</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- clk = MonotonicRaw</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="annot"><a href="Gibbon.L4.Interp.html#eval"><span class="hs-identifier hs-type">eval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L4.Interp.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Triv"><span class="hs-identifier hs-type">Triv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L4.Interp.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span>
</span><span id="line-76"></span><span id="eval"><span class="annot"><span class="annottext">eval :: Env -&gt; Triv -&gt; Val
</span><a href="Gibbon.L4.Interp.html#eval"><span class="hs-identifier hs-var hs-var">eval</span></a></span></span><span> </span><span id="local-6989586621680947649"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947649"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-type">VarTriv</span></a></span><span> </span><span id="local-6989586621680947651"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680947651"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Val -&gt; Var -&gt; Env -&gt; Val
forall k a. Ord k =&gt; a -&gt; k -&gt; Map k a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Strict.Internal.html#findWithDefault"><span class="hs-identifier hs-var">M.findWithDefault</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Val
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unbound var: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; String
</span><a href="Gibbon.Common.html#fromVar"><span class="hs-identifier hs-var">fromVar</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680947651"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680947651"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947649"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-77"></span><span class="annot"><a href="Gibbon.L4.Interp.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#IntTriv"><span class="hs-identifier hs-type">IntTriv</span></a></span><span> </span><span id="local-6989586621680947654"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621680947654"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Val
</span><a href="Gibbon.L4.Interp.html#IntVal"><span class="hs-identifier hs-var">IntVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621680947654"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- TODO: Change L1 to Int64 too.</span><span>
</span><span id="line-78"></span><span class="annot"><a href="Gibbon.L4.Interp.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#CharTriv"><span class="hs-identifier hs-type">CharTriv</span></a></span><span> </span><span id="local-6989586621680947656"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680947656"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Val
</span><a href="Gibbon.L4.Interp.html#CharVal"><span class="hs-identifier hs-var">CharVal</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680947656"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-79"></span><span class="annot"><a href="Gibbon.L4.Interp.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#FloatTriv"><span class="hs-identifier hs-type">FloatTriv</span></a></span><span> </span><span id="local-6989586621680947658"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680947658"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Val
</span><a href="Gibbon.L4.Interp.html#FloatVal"><span class="hs-identifier hs-var">FloatVal</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680947658"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-comment">-- TODO: Change L1 to Int64 too.</span><span>
</span><span id="line-80"></span><span class="annot"><a href="Gibbon.L4.Interp.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#TagTriv"><span class="hs-identifier hs-type">TagTriv</span></a></span><span> </span><span id="local-6989586621680947660"><span class="annot"><span class="annottext">Tag
</span><a href="#local-6989586621680947660"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tag -&gt; Val
</span><a href="Gibbon.L4.Interp.html#TagVal"><span class="hs-identifier hs-var">TagVal</span></a></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="#local-6989586621680947660"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-81"></span><span class="annot"><a href="Gibbon.L4.Interp.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#SymTriv"><span class="hs-identifier hs-type">SymTriv</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Val
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;eval: SymTriv not handled&quot;</span></span><span>
</span><span id="line-82"></span><span class="annot"><a href="Gibbon.L4.Interp.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#ProdTriv"><span class="hs-identifier hs-type">ProdTriv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Val
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;eval: ProdTriv not handled&quot;</span></span><span>
</span><span id="line-83"></span><span class="annot"><a href="Gibbon.L4.Interp.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#ProjTriv"><span class="hs-identifier hs-type">ProjTriv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Val
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;eval: ProjTriv not handled&quot;</span></span><span>
</span><span id="line-84"></span><span class="annot"><a href="Gibbon.L4.Interp.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#BoolTriv"><span class="hs-identifier hs-type">BoolTriv</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Val
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;eval: BoolTriv not handled&quot;</span></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="annot"><a href="Gibbon.L4.Interp.html#exec"><span class="hs-identifier hs-type">exec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L4.Interp.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Tail"><span class="hs-identifier hs-type">Tail</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Interp.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span id="exec"><span class="annot"><span class="annottext">exec :: Env -&gt; Tail -&gt; IO [Val]
</span><a href="Gibbon.L4.Interp.html#exec"><span class="hs-identifier hs-var hs-var">exec</span></a></span></span><span> </span><span id="local-6989586621680947746"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947746"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#RetValsT"><span class="hs-identifier hs-type">RetValsT</span></a></span><span> </span><span id="local-6989586621680947748"><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680947748"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Val] -&gt; IO [Val]
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([Val] -&gt; IO [Val]) -&gt; [Val] -&gt; IO [Val]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">(Triv -&gt; Val) -&gt; [Triv] -&gt; [Val]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Env -&gt; Triv -&gt; Val
</span><a href="Gibbon.L4.Interp.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947746"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680947748"><span class="hs-identifier hs-var">ts</span></a></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="annot"><a href="Gibbon.L4.Interp.html#exec"><span class="hs-identifier hs-var">exec</span></a></span><span> </span><span id="local-6989586621680947750"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947750"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetTrivT"><span class="hs-identifier hs-type">LetTrivT</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680947752"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680947752"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680947753"><span class="annot"><span class="annottext">Ty
</span><a href="#local-6989586621680947753"><span class="hs-identifier hs-var">_t</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680947754"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680947754"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680947755"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947755"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><span class="annottext">Env -&gt; Tail -&gt; IO [Val]
</span><a href="Gibbon.L4.Interp.html#exec"><span class="hs-identifier hs-var">exec</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947756"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947755"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-94"></span><span>    </span><span id="local-6989586621680947756"><span class="annot"><span class="annottext">env' :: Env
</span><a href="#local-6989586621680947756"><span class="hs-identifier hs-var hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Env -&gt; [(Var, Val)] -&gt; Env
</span><a href="Gibbon.L4.Interp.html#extendEnv"><span class="hs-identifier hs-var">extendEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947750"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680947752"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Val
</span><a href="#local-6989586621680947758"><span class="hs-identifier hs-var">rhs'</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-95"></span><span>    </span><span id="local-6989586621680947758"><span class="annot"><span class="annottext">rhs' :: Val
</span><a href="#local-6989586621680947758"><span class="hs-identifier hs-var hs-var">rhs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Env -&gt; Triv -&gt; Val
</span><a href="Gibbon.L4.Interp.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947750"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680947754"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="annot"><a href="Gibbon.L4.Interp.html#exec"><span class="hs-identifier hs-var">exec</span></a></span><span> </span><span id="local-6989586621680947759"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947759"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetCallT"><span class="hs-identifier hs-type">LetCallT</span></a></span><span> </span><span id="local-6989586621680947761"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680947761"><span class="hs-identifier hs-var">_async</span></a></span></span><span> </span><span id="local-6989586621680947762"><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680947762"><span class="hs-identifier hs-var">binds</span></a></span></span><span> </span><span id="local-6989586621680947763"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680947763"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621680947764"><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680947764"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621680947765"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947765"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-98"></span><span>    </span><span id="local-6989586621680947766"><span class="annot"><span class="annottext">[Val]
</span><a href="#local-6989586621680947766"><span class="hs-identifier hs-var">rets</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Env -&gt; Val -&gt; [Val] -&gt; IO [Val]
</span><a href="Gibbon.L4.Interp.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947759"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Env -&gt; Triv -&gt; Val
</span><a href="Gibbon.L4.Interp.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947759"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Triv
</span><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-var">VarTriv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680947763"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Triv -&gt; Val) -&gt; [Triv] -&gt; [Val]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Env -&gt; Triv -&gt; Val
</span><a href="Gibbon.L4.Interp.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947759"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680947764"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680947768"><span class="annot"><span class="annottext">env' :: Env
</span><a href="#local-6989586621680947768"><span class="hs-identifier hs-var hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Env -&gt; [(Var, Val)] -&gt; Env
</span><a href="Gibbon.L4.Interp.html#extendEnv"><span class="hs-identifier hs-var">extendEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947759"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; [Val] -&gt; [(Var, Val)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Var, Ty) -&gt; Var) -&gt; [(Var, Ty)] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty) -&gt; Var
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680947762"><span class="hs-identifier hs-var">binds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Val]
</span><a href="#local-6989586621680947766"><span class="hs-identifier hs-var">rets</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><span class="annottext">Env -&gt; Tail -&gt; IO [Val]
</span><a href="Gibbon.L4.Interp.html#exec"><span class="hs-identifier hs-var">exec</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947768"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947765"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="annot"><a href="Gibbon.L4.Interp.html#exec"><span class="hs-identifier hs-var">exec</span></a></span><span> </span><span id="local-6989586621680947770"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947770"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetPrimCallT"><span class="hs-identifier hs-type">LetPrimCallT</span></a></span><span> </span><span id="local-6989586621680947772"><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680947772"><span class="hs-identifier hs-var">binds</span></a></span></span><span> </span><span id="local-6989586621680947773"><span class="annot"><span class="annottext">Prim
</span><a href="#local-6989586621680947773"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621680947774"><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680947774"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621680947775"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947775"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-103"></span><span>    </span><span id="local-6989586621680947776"><span class="annot"><span class="annottext">[Val]
</span><a href="#local-6989586621680947776"><span class="hs-identifier hs-var">rets</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Prim -&gt; [Val] -&gt; IO [Val]
</span><a href="Gibbon.L4.Interp.html#applyPrim"><span class="hs-identifier hs-var">applyPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="#local-6989586621680947773"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Triv -&gt; Val) -&gt; [Triv] -&gt; [Val]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Env -&gt; Triv -&gt; Val
</span><a href="Gibbon.L4.Interp.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947770"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680947774"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680947777"><span class="annot"><span class="annottext">env' :: Env
</span><a href="#local-6989586621680947777"><span class="hs-identifier hs-var hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Env -&gt; [(Var, Val)] -&gt; Env
</span><a href="Gibbon.L4.Interp.html#extendEnv"><span class="hs-identifier hs-var">extendEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947770"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; [Val] -&gt; [(Var, Val)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Var, Ty) -&gt; Var) -&gt; [(Var, Ty)] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty) -&gt; Var
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680947772"><span class="hs-identifier hs-var">binds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Val]
</span><a href="#local-6989586621680947776"><span class="hs-identifier hs-var">rets</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><span class="annottext">Env -&gt; Tail -&gt; IO [Val]
</span><a href="Gibbon.L4.Interp.html#exec"><span class="hs-identifier hs-var">exec</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947777"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947775"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="annot"><a href="Gibbon.L4.Interp.html#exec"><span class="hs-identifier hs-var">exec</span></a></span><span> </span><span id="local-6989586621680947778"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947778"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetIfT"><span class="hs-identifier hs-type">LetIfT</span></a></span><span> </span><span id="local-6989586621680947780"><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680947780"><span class="hs-identifier hs-var">bnds</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680947781"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680947781"><span class="hs-identifier hs-var">tst</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680947782"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947782"><span class="hs-identifier hs-var">thn</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680947783"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947783"><span class="hs-identifier hs-var">els</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680947784"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947784"><span class="hs-identifier hs-var">bod</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680947785"><span class="annot"><span class="annottext">scrut :: Val
</span><a href="#local-6989586621680947785"><span class="hs-identifier hs-var hs-var">scrut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Env -&gt; Triv -&gt; Val
</span><a href="Gibbon.L4.Interp.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947778"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680947781"><span class="hs-identifier hs-var">tst</span></a></span><span>
</span><span id="line-109"></span><span>     </span><span id="local-6989586621680947786"><span class="annot"><span class="annottext">[Val]
</span><a href="#local-6989586621680947786"><span class="hs-identifier hs-var">vals</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Val
</span><a href="#local-6989586621680947785"><span class="hs-identifier hs-var">scrut</span></a></span><span> </span><span class="annot"><span class="annottext">Val -&gt; Val -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Val
</span><a href="Gibbon.L4.Interp.html#IntVal"><span class="hs-identifier hs-var">IntVal</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-110"></span><span>             </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Env -&gt; Tail -&gt; IO [Val]
</span><a href="Gibbon.L4.Interp.html#exec"><span class="hs-identifier hs-var">exec</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947778"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947782"><span class="hs-identifier hs-var">thn</span></a></span><span>
</span><span id="line-111"></span><span>             </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Env -&gt; Tail -&gt; IO [Val]
</span><a href="Gibbon.L4.Interp.html#exec"><span class="hs-identifier hs-var">exec</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947778"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947783"><span class="hs-identifier hs-var">els</span></a></span><span>
</span><span id="line-112"></span><span>     </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680947787"><span class="annot"><span class="annottext">env' :: Env
</span><a href="#local-6989586621680947787"><span class="hs-identifier hs-var hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Env -&gt; [(Var, Val)] -&gt; Env
</span><a href="Gibbon.L4.Interp.html#extendEnv"><span class="hs-identifier hs-var">extendEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947778"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; [Val] -&gt; [(Var, Val)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Var, Ty) -&gt; Var) -&gt; [(Var, Ty)] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty) -&gt; Var
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680947780"><span class="hs-identifier hs-var">bnds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Val]
</span><a href="#local-6989586621680947786"><span class="hs-identifier hs-var">vals</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>     </span><span class="annot"><span class="annottext">Env -&gt; Tail -&gt; IO [Val]
</span><a href="Gibbon.L4.Interp.html#exec"><span class="hs-identifier hs-var">exec</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947787"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947784"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="annot"><a href="Gibbon.L4.Interp.html#exec"><span class="hs-identifier hs-var">exec</span></a></span><span> </span><span id="local-6989586621680947788"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947788"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#IfT"><span class="hs-identifier hs-type">IfT</span></a></span><span> </span><span id="local-6989586621680947790"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680947790"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span id="local-6989586621680947791"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947791"><span class="hs-identifier hs-var">then_</span></a></span></span><span> </span><span id="local-6989586621680947792"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947792"><span class="hs-identifier hs-var">else_</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Val
</span><a href="#local-6989586621680947793"><span class="hs-identifier hs-var">v1'</span></a></span><span> </span><span class="annot"><span class="annottext">Val -&gt; Val -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Val
</span><a href="Gibbon.L4.Interp.html#IntVal"><span class="hs-identifier hs-var">IntVal</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Env -&gt; Tail -&gt; IO [Val]
</span><a href="Gibbon.L4.Interp.html#exec"><span class="hs-identifier hs-var">exec</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947788"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947791"><span class="hs-identifier hs-var">then_</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Env -&gt; Tail -&gt; IO [Val]
</span><a href="Gibbon.L4.Interp.html#exec"><span class="hs-identifier hs-var">exec</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947788"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947792"><span class="hs-identifier hs-var">else_</span></a></span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span>    </span><span id="local-6989586621680947793"><span class="annot"><span class="annottext">v1' :: Val
</span><a href="#local-6989586621680947793"><span class="hs-identifier hs-var hs-var">v1'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Env -&gt; Triv -&gt; Val
</span><a href="Gibbon.L4.Interp.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947788"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680947790"><span class="hs-identifier hs-var">v1</span></a></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="annot"><a href="Gibbon.L4.Interp.html#exec"><span class="hs-identifier hs-var">exec</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#ErrT"><span class="hs-identifier hs-type">ErrT</span></a></span><span> </span><span id="local-6989586621680947795"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680947795"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO [Val]
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO [Val]) -&gt; String -&gt; IO [Val]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ErrT: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680947795"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="annot"><a href="Gibbon.L4.Interp.html#exec"><span class="hs-identifier hs-var">exec</span></a></span><span> </span><span id="local-6989586621680947796"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947796"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#LetTimedT"><span class="hs-identifier hs-type">LetTimedT</span></a></span><span> </span><span id="local-6989586621680947798"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680947798"><span class="hs-identifier hs-var">flg</span></a></span></span><span> </span><span id="local-6989586621680947799"><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680947799"><span class="hs-identifier hs-var">bnds</span></a></span></span><span> </span><span id="local-6989586621680947800"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947800"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span id="local-6989586621680947801"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947801"><span class="hs-identifier hs-var">bod</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680947802"><span class="annot"><span class="annottext">iters :: Int
</span><a href="#local-6989586621680947802"><span class="hs-identifier hs-var hs-var">iters</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680947798"><span class="hs-identifier hs-var">flg</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Int
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Implement timed iteration inside the interpreter...&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-glyph">!</span><span class="annot"><span class="annottext">Env
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Env -&gt; IO Env
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Env -&gt; IO Env) -&gt; Env -&gt; IO Env
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24%21"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">Env -&gt; Env
forall a. NFData a =&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/deepseq-1.4.8.0/src/Control.DeepSeq.html#force"><span class="hs-identifier hs-var">force</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947796"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-127"></span><span>    </span><span id="local-6989586621680947804"><span class="annot"><span class="annottext">TimeSpec
</span><a href="#local-6989586621680947804"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Clock -&gt; IO TimeSpec
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/clock-0.8.4-e74b45a1c99d0dbcdb2c4c619c1a606f25f547f2444c2c9d41c64f44496bfb39/share/doc/html/src/System.Clock.html#getTime"><span class="hs-identifier hs-var">getTime</span></a></span><span> </span><span class="annot"><span class="annottext">Clock
</span><a href="Gibbon.L4.Interp.html#clk"><span class="hs-identifier hs-var">clk</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span id="local-6989586621680947806"><span class="annot"><span class="annottext">[Val]
</span><a href="#local-6989586621680947806"><span class="hs-identifier hs-var">vals</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([Val] -&gt; Int -&gt; IO [Val]) -&gt; [Val] -&gt; [Int] -&gt; IO [Val]
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Control.Monad.html#foldM"><span class="hs-identifier hs-var">foldM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="annot"><span class="annottext">[Val]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680947808"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947808"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Env -&gt; Tail -&gt; IO [Val]
</span><a href="Gibbon.L4.Interp.html#execWrapper"><span class="hs-identifier hs-var">execWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947808"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947796"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947800"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [Val]
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Internal error: this should be unused.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>               </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947802"><span class="hs-identifier hs-var">iters</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-131"></span><span>    </span><span id="local-6989586621680947810"><span class="annot"><span class="annottext">TimeSpec
</span><a href="#local-6989586621680947810"><span class="hs-identifier hs-var">en</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Clock -&gt; IO TimeSpec
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/clock-0.8.4-e74b45a1c99d0dbcdb2c4c619c1a606f25f547f2444c2c9d41c64f44496bfb39/share/doc/html/src/System.Clock.html#getTime"><span class="hs-identifier hs-var">getTime</span></a></span><span> </span><span class="annot"><span class="annottext">Clock
</span><a href="Gibbon.L4.Interp.html#clk"><span class="hs-identifier hs-var">clk</span></a></span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680947811"><span class="annot"><span class="annottext">env' :: Env
</span><a href="#local-6989586621680947811"><span class="hs-identifier hs-var hs-var">env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Env -&gt; [(Var, Val)] -&gt; Env
</span><a href="Gibbon.L4.Interp.html#extendEnv"><span class="hs-identifier hs-var">extendEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947796"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; [Val] -&gt; [(Var, Val)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Var, Ty) -&gt; Var) -&gt; [(Var, Ty)] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty) -&gt; Var
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680947799"><span class="hs-identifier hs-var">bnds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Val]
</span><a href="#local-6989586621680947806"><span class="hs-identifier hs-var">vals</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680947812"><span class="annot"><span class="annottext">tm :: Double
</span><a href="#local-6989586621680947812"><span class="hs-identifier hs-var hs-var">tm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TimeSpec -&gt; Integer
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/clock-0.8.4-e74b45a1c99d0dbcdb2c4c619c1a606f25f547f2444c2c9d41c64f44496bfb39/share/doc/html/src/System.Clock.html#toNanoSecs"><span class="hs-identifier hs-var">toNanoSecs</span></a></span><span> </span><span class="annot"><span class="annottext">(TimeSpec -&gt; Integer) -&gt; TimeSpec -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TimeSpec -&gt; TimeSpec -&gt; TimeSpec
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/clock-0.8.4-e74b45a1c99d0dbcdb2c4c619c1a606f25f547f2444c2c9d41c64f44496bfb39/share/doc/html/src/System.Clock.html#diffTimeSpec"><span class="hs-identifier hs-var">diffTimeSpec</span></a></span><span> </span><span class="annot"><span class="annottext">TimeSpec
</span><a href="#local-6989586621680947810"><span class="hs-identifier hs-var">en</span></a></span><span> </span><span class="annot"><span class="annottext">TimeSpec
</span><a href="#local-6989586621680947804"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>              </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Real.html#%2F"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10e9</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680947798"><span class="hs-identifier hs-var">flg</span></a></span><span>
</span><span id="line-136"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/System.IO.html#putStrLn"><span class="hs-identifier hs-var">putStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ITERS: &quot;</span></span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947802"><span class="hs-identifier hs-var">iters</span></a></span><span>
</span><span id="line-137"></span><span>             </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/System.IO.html#putStrLn"><span class="hs-identifier hs-var">putStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SIZE: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Int
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;FINISHME: get size param&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>             </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/System.IO.html#putStrLn"><span class="hs-identifier hs-var">putStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;BATCHTIME: &quot;</span></span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">Double -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680947812"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-139"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/System.IO.html#putStrLn"><span class="hs-identifier hs-var">putStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SELFTIMED: &quot;</span></span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">Double -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680947812"><span class="hs-identifier hs-var">tm</span></a></span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><span class="annottext">Env -&gt; Tail -&gt; IO [Val]
</span><a href="Gibbon.L4.Interp.html#exec"><span class="hs-identifier hs-var">exec</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947811"><span class="hs-identifier hs-var">env'</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947801"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="annot"><a href="Gibbon.L4.Interp.html#exec"><span class="hs-identifier hs-var">exec</span></a></span><span> </span><span id="local-6989586621680947817"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947817"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#Switch"><span class="hs-identifier hs-type">Switch</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680947819"><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680947819"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621680947820"><span class="annot"><span class="annottext">Alts
</span><a href="#local-6989586621680947820"><span class="hs-identifier hs-var">alts</span></a></span></span><span> </span><span id="local-6989586621680947821"><span class="annot"><span class="annottext">Maybe Tail
</span><a href="#local-6989586621680947821"><span class="hs-identifier hs-var">def</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Tail
</span><a href="#local-6989586621680947822"><span class="hs-identifier hs-var">final_alt</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-144"></span><span>      </span><span class="annot"><span class="annottext">Maybe Tail
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO [Val]
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Switch: No branch to choose.&quot;</span></span><span>
</span><span id="line-145"></span><span>      </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680947823"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947823"><span class="hs-identifier hs-var">br</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Env -&gt; Tail -&gt; IO [Val]
</span><a href="Gibbon.L4.Interp.html#exec"><span class="hs-identifier hs-var">exec</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947817"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947823"><span class="hs-identifier hs-var">br</span></a></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-147"></span><span>    </span><span id="local-6989586621680947824"><span class="annot"><span class="annottext">tr' :: Val
</span><a href="#local-6989586621680947824"><span class="hs-identifier hs-var hs-var">tr'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Env -&gt; Triv -&gt; Val
</span><a href="Gibbon.L4.Interp.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947817"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Triv
</span><a href="#local-6989586621680947819"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span>    </span><span id="local-6989586621680947825"><span class="annot"><span class="annottext">intAlts :: [(Int64, Tail)]
</span><a href="#local-6989586621680947825"><span class="hs-identifier hs-var hs-var">intAlts</span></a></span></span><span>
</span><span id="line-150"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#IntAlts"><span class="hs-identifier hs-type">IntAlts</span></a></span><span> </span><span id="local-6989586621680947827"><span class="annot"><span class="annottext">[(Int64, Tail)]
</span><a href="#local-6989586621680947827"><span class="hs-identifier hs-var">alts'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Alts
</span><a href="#local-6989586621680947820"><span class="hs-identifier hs-var">alts</span></a></span><span>
</span><span id="line-151"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Int64, Tail)]
</span><a href="#local-6989586621680947827"><span class="hs-identifier hs-var">alts'</span></a></span><span>
</span><span id="line-152"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-153"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [(Int64, Tail)]
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;intAlts: Found TagAlts&quot;</span></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span>    </span><span id="local-6989586621680947828"><span class="annot"><span class="annottext">tagAlts :: [(Tag, Tail)]
</span><a href="#local-6989586621680947828"><span class="hs-identifier hs-var hs-var">tagAlts</span></a></span></span><span>
</span><span id="line-156"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#TagAlts"><span class="hs-identifier hs-type">TagAlts</span></a></span><span> </span><span id="local-6989586621680947830"><span class="annot"><span class="annottext">[(Tag, Tail)]
</span><a href="#local-6989586621680947830"><span class="hs-identifier hs-var">alts'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Alts
</span><a href="#local-6989586621680947820"><span class="hs-identifier hs-var">alts</span></a></span><span>
</span><span id="line-157"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Tag, Tail)]
</span><a href="#local-6989586621680947830"><span class="hs-identifier hs-var">alts'</span></a></span><span>
</span><span id="line-158"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-159"></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [(Tag, Tail)]
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tagAlts: Found IntAlts&quot;</span></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span>    </span><span id="local-6989586621680947831"><span class="annot"><span class="annottext">chooseIntAlt :: Int64 -&gt; Maybe Tail
</span><a href="#local-6989586621680947831"><span class="hs-identifier hs-var hs-var">chooseIntAlt</span></a></span></span><span> </span><span id="local-6989586621680947832"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621680947832"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int64, Tail) -&gt; Tail
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">((Int64, Tail) -&gt; Tail) -&gt; Maybe (Int64, Tail) -&gt; Maybe Tail
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int64, Tail)] -&gt; Maybe (Int64, Tail)
forall a. [a] -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Maybe.html#listToMaybe"><span class="hs-identifier hs-var">listToMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Int64, Tail) -&gt; Bool) -&gt; [(Int64, Tail)] -&gt; [(Int64, Tail)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621680947832"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int64 -&gt; Bool)
-&gt; ((Int64, Tail) -&gt; Int64) -&gt; (Int64, Tail) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Int64, Tail) -&gt; Int64
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Int64, Tail)]
</span><a href="#local-6989586621680947825"><span class="hs-identifier hs-var">intAlts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>    </span><span id="local-6989586621680947836"><span class="annot"><span class="annottext">chooseTagAlt :: Tag -&gt; Maybe Tail
</span><a href="#local-6989586621680947836"><span class="hs-identifier hs-var hs-var">chooseTagAlt</span></a></span></span><span> </span><span id="local-6989586621680947837"><span class="annot"><span class="annottext">Tag
</span><a href="#local-6989586621680947837"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Tag, Tail) -&gt; Tail
forall a b. (a, b) -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">((Tag, Tail) -&gt; Tail) -&gt; Maybe (Tag, Tail) -&gt; Maybe Tail
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[(Tag, Tail)] -&gt; Maybe (Tag, Tail)
forall a. [a] -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Maybe.html#listToMaybe"><span class="hs-identifier hs-var">listToMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Tag, Tail) -&gt; Bool) -&gt; [(Tag, Tail)] -&gt; [(Tag, Tail)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tag
</span><a href="#local-6989586621680947837"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Tag -&gt; Tag -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Tag -&gt; Bool) -&gt; ((Tag, Tail) -&gt; Tag) -&gt; (Tag, Tail) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Tag, Tail) -&gt; Tag
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Tag, Tail)]
</span><a href="#local-6989586621680947828"><span class="hs-identifier hs-var">tagAlts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span>    </span><span id="local-6989586621680947822"><span class="annot"><span class="annottext">final_alt :: Maybe Tail
</span><a href="#local-6989586621680947822"><span class="hs-identifier hs-var hs-var">final_alt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-165"></span><span>      </span><span class="annot"><span class="annottext">Maybe Tail -&gt; (Tail -&gt; Maybe Tail) -&gt; Maybe Tail -&gt; Maybe Tail
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Tail
</span><a href="#local-6989586621680947821"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">Tail -&gt; Maybe Tail
forall a. a -&gt; Maybe a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Tail -&gt; Maybe Tail) -&gt; Maybe Tail -&gt; Maybe Tail
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-166"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Val
</span><a href="#local-6989586621680947824"><span class="hs-identifier hs-var">tr'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-167"></span><span>          </span><span class="annot"><a href="Gibbon.L4.Interp.html#IntVal"><span class="hs-identifier hs-type">IntVal</span></a></span><span> </span><span id="local-6989586621680947839"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947839"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Maybe Tail
</span><a href="#local-6989586621680947831"><span class="hs-identifier hs-var">chooseIntAlt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947839"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>          </span><span class="annot"><a href="Gibbon.L4.Interp.html#TagVal"><span class="hs-identifier hs-type">TagVal</span></a></span><span> </span><span id="local-6989586621680947840"><span class="annot"><span class="annottext">Tag
</span><a href="#local-6989586621680947840"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Tag -&gt; Maybe Tail
</span><a href="#local-6989586621680947836"><span class="hs-identifier hs-var">chooseTagAlt</span></a></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="#local-6989586621680947840"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-169"></span><span>          </span><span class="annot"><span class="annottext">Val
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Tail
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Switch: invalid value in scrutinee position: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Val -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Val
</span><a href="#local-6989586621680947824"><span class="hs-identifier hs-var">tr'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="annot"><a href="Gibbon.L4.Interp.html#exec"><span class="hs-identifier hs-var">exec</span></a></span><span> </span><span id="local-6989586621680947841"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947841"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#TailCall"><span class="hs-identifier hs-type">TailCall</span></a></span><span> </span><span id="local-6989586621680947843"><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680947843"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span id="local-6989586621680947844"><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680947844"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-172"></span><span>    </span><span class="annot"><span class="annottext">Env -&gt; Val -&gt; [Val] -&gt; IO [Val]
</span><a href="Gibbon.L4.Interp.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947841"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Val
</span><a href="#local-6989586621680947845"><span class="hs-identifier hs-var">fn'</span></a></span><span> </span><span class="annot"><span class="annottext">[Val]
</span><a href="#local-6989586621680947846"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-174"></span><span>    </span><span id="local-6989586621680947845"><span class="annot"><span class="annottext">fn' :: Val
</span><a href="#local-6989586621680947845"><span class="hs-identifier hs-var hs-var">fn'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Env -&gt; Triv -&gt; Val
</span><a href="Gibbon.L4.Interp.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947841"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Var -&gt; Triv
</span><a href="Gibbon.L4.Syntax.html#VarTriv"><span class="hs-identifier hs-var">VarTriv</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><a href="#local-6989586621680947843"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>    </span><span id="local-6989586621680947846"><span class="annot"><span class="annottext">args' :: [Val]
</span><a href="#local-6989586621680947846"><span class="hs-identifier hs-var hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Triv -&gt; Val) -&gt; [Triv] -&gt; [Val]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Env -&gt; Triv -&gt; Val
</span><a href="Gibbon.L4.Interp.html#eval"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947841"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Triv]
</span><a href="#local-6989586621680947844"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="annot"><a href="Gibbon.L4.Interp.html#exec"><span class="hs-identifier hs-var">exec</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680947847"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947847"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO [Val]
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span class="annot"><span class="annottext">(String -&gt; IO [Val]) -&gt; String -&gt; IO [Val]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Interpreter/exec, unhandled expression:\n  &quot;</span></span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">Doc -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tail -&gt; Doc
forall a. Out a =&gt; a -&gt; Doc
</span><a href="file:///home/artem/.cabal/store/ghc-9.4.5/GenericPretty-1.2.2-7277c36a966d41cd8e1371a7ee4c855b29a76e94dfe1d95510f68242766a5b82/share/doc/html/src/Text.PrettyPrint.GenericPretty.html#doc"><span class="hs-identifier hs-var">doc</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947847"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-pragma">{-# NOINLINE</span><span> </span><span class="annot"><a href="Gibbon.L4.Interp.html#execWrapper"><span class="hs-pragma hs-type">execWrapper</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-180"></span><span class="annot"><a href="Gibbon.L4.Interp.html#execWrapper"><span class="hs-identifier hs-type">execWrapper</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L4.Interp.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Tail"><span class="hs-identifier hs-type">Tail</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Interp.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-181"></span><span id="execWrapper"><span class="annot"><span class="annottext">execWrapper :: Int -&gt; Env -&gt; Tail -&gt; IO [Val]
</span><a href="Gibbon.L4.Interp.html#execWrapper"><span class="hs-identifier hs-var hs-var">execWrapper</span></a></span></span><span> </span><span id="local-6989586621680947853"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947853"><span class="hs-identifier hs-var">_i</span></a></span></span><span> </span><span id="local-6989586621680947854"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947854"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span id="local-6989586621680947855"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947855"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Val] -&gt; [Val]) -&gt; IO [Val] -&gt; IO [Val]
forall a b. (a -&gt; b) -&gt; IO a -&gt; IO b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">[Val] -&gt; [Val]
forall a. NFData a =&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/deepseq-1.4.8.0/src/Control.DeepSeq.html#force"><span class="hs-identifier hs-var">force</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [Val] -&gt; IO [Val]) -&gt; IO [Val] -&gt; IO [Val]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Env -&gt; Tail -&gt; IO [Val]
</span><a href="Gibbon.L4.Interp.html#exec"><span class="hs-identifier hs-var">exec</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947854"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947855"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="annot"><a href="Gibbon.L4.Interp.html#extendEnv"><span class="hs-identifier hs-type">extendEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L4.Interp.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L4.Interp.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L4.Interp.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span>
</span><span id="line-184"></span><span id="extendEnv"><span class="annot"><span class="annottext">extendEnv :: Env -&gt; [(Var, Val)] -&gt; Env
</span><a href="Gibbon.L4.Interp.html#extendEnv"><span class="hs-identifier hs-var hs-var">extendEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Var, Val) -&gt; Env -&gt; Env) -&gt; Env -&gt; [(Var, Val)] -&gt; Env
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Var -&gt; Val -&gt; Env -&gt; Env) -&gt; (Var, Val) -&gt; Env -&gt; Env
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#uncurry"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">Var -&gt; Val -&gt; Env -&gt; Env
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Strict.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="annot"><a href="Gibbon.L4.Interp.html#apply"><span class="hs-identifier hs-type">apply</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L4.Interp.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L4.Interp.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Interp.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Interp.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span id="apply"><span class="annot"><span class="annottext">apply :: Env -&gt; Val -&gt; [Val] -&gt; IO [Val]
</span><a href="Gibbon.L4.Interp.html#apply"><span class="hs-identifier hs-var hs-var">apply</span></a></span></span><span> </span><span id="local-6989586621680947866"><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947866"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Interp.html#FunVal"><span class="hs-identifier hs-type">FunVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#FunDecl"><span class="hs-identifier hs-type">FunDecl</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680947868"><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680947868"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="annot"><span class="annottext">Ty
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680947869"><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947869"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621680947870"><span class="annot"><span class="annottext">[Val]
</span><a href="#local-6989586621680947870"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><span class="annottext">Env -&gt; Tail -&gt; IO [Val]
</span><a href="Gibbon.L4.Interp.html#exec"><span class="hs-identifier hs-var">exec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Env -&gt; [(Var, Val)] -&gt; Env
</span><a href="Gibbon.L4.Interp.html#extendEnv"><span class="hs-identifier hs-var">extendEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621680947866"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Var] -&gt; [Val] -&gt; [(Var, Val)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Var, Ty) -&gt; Var) -&gt; [(Var, Ty)] -&gt; [Var]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Var, Ty) -&gt; Var
forall a b. (a, b) -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Tuple.html#fst"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[(Var, Ty)]
</span><a href="#local-6989586621680947868"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Val]
</span><a href="#local-6989586621680947870"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tail
</span><a href="#local-6989586621680947869"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="annot"><a href="Gibbon.L4.Interp.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">Env
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680947871"><span class="annot"><span class="annottext">Val
</span><a href="#local-6989586621680947871"><span class="hs-identifier hs-var">notFun</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Val]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO [Val]
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;apply to a non-function: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Val -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Val
</span><a href="#local-6989586621680947871"><span class="hs-identifier hs-var">notFun</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="annot"><a href="Gibbon.L4.Interp.html#applyPrim"><span class="hs-identifier hs-type">applyPrim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#Prim"><span class="hs-identifier hs-type">Prim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Interp.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Interp.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span id="applyPrim"><span class="annot"><span class="annottext">applyPrim :: Prim -&gt; [Val] -&gt; IO [Val]
</span><a href="Gibbon.L4.Interp.html#applyPrim"><span class="hs-identifier hs-var hs-var">applyPrim</span></a></span></span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#AddP"><span class="hs-identifier hs-var">AddP</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Interp.html#IntVal"><span class="hs-identifier hs-type">IntVal</span></a></span><span> </span><span id="local-6989586621680947925"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947925"><span class="hs-identifier hs-var">i1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L4.Interp.html#IntVal"><span class="hs-identifier hs-type">IntVal</span></a></span><span> </span><span id="local-6989586621680947926"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947926"><span class="hs-identifier hs-var">i2</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Val] -&gt; IO [Val]
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Val
</span><a href="Gibbon.L4.Interp.html#IntVal"><span class="hs-identifier hs-var">IntVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947925"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947926"><span class="hs-identifier hs-var">i2</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-199"></span><span class="annot"><a href="Gibbon.L4.Interp.html#applyPrim"><span class="hs-identifier hs-var">applyPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#SubP"><span class="hs-identifier hs-var">SubP</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Interp.html#IntVal"><span class="hs-identifier hs-type">IntVal</span></a></span><span> </span><span id="local-6989586621680947929"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947929"><span class="hs-identifier hs-var">i1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L4.Interp.html#IntVal"><span class="hs-identifier hs-type">IntVal</span></a></span><span> </span><span id="local-6989586621680947930"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947930"><span class="hs-identifier hs-var">i2</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Val] -&gt; IO [Val]
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Val
</span><a href="Gibbon.L4.Interp.html#IntVal"><span class="hs-identifier hs-var">IntVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947929"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Num.html#-"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947930"><span class="hs-identifier hs-var">i2</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-200"></span><span class="annot"><a href="Gibbon.L4.Interp.html#applyPrim"><span class="hs-identifier hs-var">applyPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#MulP"><span class="hs-identifier hs-var">MulP</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Interp.html#IntVal"><span class="hs-identifier hs-type">IntVal</span></a></span><span> </span><span id="local-6989586621680947932"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947932"><span class="hs-identifier hs-var">i1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L4.Interp.html#IntVal"><span class="hs-identifier hs-type">IntVal</span></a></span><span> </span><span id="local-6989586621680947933"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947933"><span class="hs-identifier hs-var">i2</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Val] -&gt; IO [Val]
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Val
</span><a href="Gibbon.L4.Interp.html#IntVal"><span class="hs-identifier hs-var">IntVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947932"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947933"><span class="hs-identifier hs-var">i2</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="annot"><a href="Gibbon.L4.Interp.html#applyPrim"><span class="hs-identifier hs-var">applyPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#EqP"><span class="hs-identifier hs-var">EqP</span></a></span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Interp.html#IntVal"><span class="hs-identifier hs-type">IntVal</span></a></span><span> </span><span id="local-6989586621680947936"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947936"><span class="hs-identifier hs-var">i1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L4.Interp.html#IntVal"><span class="hs-identifier hs-type">IntVal</span></a></span><span> </span><span id="local-6989586621680947937"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947937"><span class="hs-identifier hs-var">i2</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Val] -&gt; IO [Val]
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Val
</span><a href="Gibbon.L4.Interp.html#IntVal"><span class="hs-identifier hs-var">IntVal</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947936"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947937"><span class="hs-identifier hs-var">i2</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="annot"><a href="Gibbon.L4.Interp.html#applyPrim"><span class="hs-identifier hs-var">applyPrim</span></a></span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#NewBuffer"><span class="hs-identifier hs-type">NewBuffer</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Val] -&gt; IO [Val]
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Seq Int -&gt; Val
</span><a href="Gibbon.L4.Interp.html#BufVal"><span class="hs-identifier hs-var">BufVal</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Int
forall a. Seq a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#empty"><span class="hs-identifier hs-var">Seq.empty</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="annot"><a href="Gibbon.L4.Interp.html#applyPrim"><span class="hs-identifier hs-var">applyPrim</span></a></span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#NewParBuffer"><span class="hs-identifier hs-type">NewParBuffer</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Val] -&gt; IO [Val]
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Seq Int -&gt; Val
</span><a href="Gibbon.L4.Interp.html#BufVal"><span class="hs-identifier hs-var">BufVal</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Int
forall a. Seq a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#empty"><span class="hs-identifier hs-var">Seq.empty</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="annot"><a href="Gibbon.L4.Interp.html#applyPrim"><span class="hs-identifier hs-var">applyPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#WriteTag"><span class="hs-identifier hs-var">WriteTag</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Interp.html#TagVal"><span class="hs-identifier hs-type">TagVal</span></a></span><span> </span><span id="local-6989586621680947942"><span class="annot"><span class="annottext">Tag
</span><a href="#local-6989586621680947942"><span class="hs-identifier hs-var">tag</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L4.Interp.html#BufVal"><span class="hs-identifier hs-type">BufVal</span></a></span><span> </span><span id="local-6989586621680947943"><span class="annot"><span class="annottext">Seq Int
</span><a href="#local-6989586621680947943"><span class="hs-identifier hs-var">is</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Val] -&gt; IO [Val]
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Seq Int -&gt; Val
</span><a href="Gibbon.L4.Interp.html#BufVal"><span class="hs-identifier hs-var">BufVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq Int
</span><a href="#local-6989586621680947943"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Int -&gt; Int -&gt; Seq Int
forall a. Seq a -&gt; a -&gt; Seq a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#%7C%3E"><span class="hs-operator hs-var">|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Tag -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="#local-6989586621680947942"><span class="hs-identifier hs-var">tag</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="annot"><a href="Gibbon.L4.Interp.html#applyPrim"><span class="hs-identifier hs-var">applyPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#ReadTag"><span class="hs-identifier hs-var">ReadTag</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Interp.html#BufVal"><span class="hs-identifier hs-type">BufVal</span></a></span><span> </span><span id="local-6989586621680947945"><span class="annot"><span class="annottext">Seq Int
</span><a href="#local-6989586621680947945"><span class="hs-identifier hs-var">is</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Seq Int -&gt; ViewL Int
forall a. Seq a -&gt; ViewL a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#viewl"><span class="hs-identifier hs-var">Seq.viewl</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Int
</span><a href="#local-6989586621680947945"><span class="hs-identifier hs-var">is</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-211"></span><span>                                </span><span class="annot"><span class="annottext">ViewL Int
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#EmptyL"><span class="hs-identifier hs-var">Seq.EmptyL</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO [Val]
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ReadTag: Empty buffer&quot;</span></span><span>
</span><span id="line-212"></span><span>                                </span><span id="local-6989586621680947948"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947948"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#%3A%3C"><span class="hs-operator hs-type">:&lt;</span></a></span><span> </span><span id="local-6989586621680947949"><span class="annot"><span class="annottext">Seq Int
</span><a href="#local-6989586621680947949"><span class="hs-identifier hs-var">is'</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Val] -&gt; IO [Val]
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Tag -&gt; Val
</span><a href="Gibbon.L4.Interp.html#TagVal"><span class="hs-identifier hs-var">TagVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Tag
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947948"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Seq Int -&gt; Val
</span><a href="Gibbon.L4.Interp.html#BufVal"><span class="hs-identifier hs-var">BufVal</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Int
</span><a href="#local-6989586621680947949"><span class="hs-identifier hs-var">is'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-comment">-- [2019.06.10] CSK: Implement this later.</span><span>
</span><span id="line-215"></span><span class="hs-comment">-- applyPrim (WriteScalar s) [IntVal i, BufVal is] = pure [BufVal (is |&gt; i)]</span><span>
</span><span id="line-216"></span><span class="hs-comment">-- applyPrim (ReadScalar s) [BufVal is] = case Seq.viewl is of</span><span>
</span><span id="line-217"></span><span class="hs-comment">--                                          Seq.EmptyL -&gt; error &quot;ReadInt: Empty buffer&quot;</span><span>
</span><span id="line-218"></span><span class="hs-comment">--                                          i :&lt; is'   -&gt; pure  [IntVal i, BufVal is']</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="annot"><a href="Gibbon.L4.Interp.html#applyPrim"><span class="hs-identifier hs-var">applyPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#PrintInt"><span class="hs-identifier hs-var">PrintInt</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.L4.Interp.html#IntVal"><span class="hs-identifier hs-type">IntVal</span></a></span><span> </span><span id="local-6989586621680947951"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947951"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/System.IO.html#print"><span class="hs-identifier hs-var">print</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680947951"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">[Val] -&gt; IO [Val]
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-221"></span><span class="annot"><a href="Gibbon.L4.Interp.html#applyPrim"><span class="hs-identifier hs-var">applyPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#PrintString"><span class="hs-identifier hs-type">PrintString</span></a></span><span> </span><span id="local-6989586621680947953"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680947953"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/System.IO.html#putStrLn"><span class="hs-identifier hs-var">putStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621680947953"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">[Val] -&gt; IO [Val]
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="annot"><a href="Gibbon.L4.Interp.html#applyPrim"><span class="hs-identifier hs-var">applyPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#SizeParam"><span class="hs-identifier hs-var">SizeParam</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO [Val]
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TargetInterp/applyPrim: finish SizeParam&quot;</span></span><span>
</span><span id="line-224"></span><span class="annot"><a href="Gibbon.L4.Interp.html#applyPrim"><span class="hs-identifier hs-var">applyPrim</span></a></span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#ScopedBuffer"><span class="hs-identifier hs-type">ScopedBuffer</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO [Val]
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TargetInterp/applyPrim: finish ScopedBuf&quot;</span></span><span>
</span><span id="line-225"></span><span class="annot"><a href="Gibbon.L4.Interp.html#applyPrim"><span class="hs-identifier hs-var">applyPrim</span></a></span><span> </span><span class="annot"><a href="Gibbon.L4.Syntax.html#ScopedParBuffer"><span class="hs-identifier hs-type">ScopedParBuffer</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO [Val]
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TargetInterp/applyPrim: finish ScopedBuf&quot;</span></span><span>
</span><span id="line-226"></span><span class="annot"><a href="Gibbon.L4.Interp.html#applyPrim"><span class="hs-identifier hs-var">applyPrim</span></a></span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="Gibbon.L4.Syntax.html#GetFirstWord"><span class="hs-identifier hs-var">GetFirstWord</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO [Val]
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TargetInterp/applyPrim: finish GetFirstWord&quot;</span></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="annot"><a href="Gibbon.L4.Interp.html#applyPrim"><span class="hs-identifier hs-var">applyPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#DictInsertP"><span class="hs-identifier hs-type">DictInsertP</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO [Val]
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TargetInterp/applyPrim: finish DictInsertP&quot;</span></span><span>
</span><span id="line-229"></span><span class="annot"><a href="Gibbon.L4.Interp.html#applyPrim"><span class="hs-identifier hs-var">applyPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#DictLookupP"><span class="hs-identifier hs-type">DictLookupP</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO [Val]
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO [Val]) -&gt; String -&gt; IO [Val]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TargetInterp/applyPrim: finish DictLookupP&quot;</span></span><span>
</span><span id="line-230"></span><span class="annot"><a href="Gibbon.L4.Interp.html#applyPrim"><span class="hs-identifier hs-var">applyPrim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L4.Syntax.html#DictEmptyP"><span class="hs-identifier hs-type">DictEmptyP</span></a></span><span> </span><span class="annot"><span class="annottext">Ty
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO [Val]
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO [Val]) -&gt; String -&gt; IO [Val]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TargetInterp/applyPrim: finish DictEmptyP&quot;</span></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="annot"><a href="Gibbon.L4.Interp.html#applyPrim"><span class="hs-identifier hs-var">applyPrim</span></a></span><span> </span><span id="local-6989586621680947961"><span class="annot"><span class="annottext">Prim
</span><a href="#local-6989586621680947961"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621680947962"><span class="annot"><span class="annottext">[Val]
</span><a href="#local-6989586621680947962"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO [Val]
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;applyPrim: Unsupported form or bad arguments: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Prim -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Prim
</span><a href="#local-6989586621680947961"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Val] -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">[Val]
</span><a href="#local-6989586621680947962"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span></pre></body></html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Gibbon.Passes.ReorderScalarWrites</span><span>
</span><span id="line-4"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#reorderScalarWrites"><span class="hs-identifier">reorderScalarWrites</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#writeOrderMarkers"><span class="hs-identifier">writeOrderMarkers</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-5"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.html"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Graph.html"><span class="hs-identifier">Data.Graph</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">G</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Maybe.html#fromJust"><span class="hs-identifier">fromJust</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/GenericPretty-1.2.2-7277c36a966d41cd8e1371a7ee4c855b29a76e94dfe1d95510f68242766a5b82/share/doc/html/src/Text.PrettyPrint.GenericPretty.html"><span class="hs-identifier">Text.PrettyPrint.GenericPretty</span></a></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/pretty-1.1.3.6/src/Text.PrettyPrint.html"><span class="hs-identifier">Text.PrettyPrint</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/pretty-1.1.3.6/src/Text.PrettyPrint.HughesPJ.html#text"><span class="hs-identifier">text</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Common.html"><span class="hs-identifier">Gibbon.Common</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Mode"><span class="hs-identifier">Mode</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Gibbon.Language.html"><span class="hs-identifier">Gibbon.Language</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html"><span class="hs-identifier">Gibbon.L2.Syntax</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L2</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Gibbon.L3.Syntax.html"><span class="hs-identifier">Gibbon.L3.Syntax</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L3</span></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-comment">-- | Inserts markers which tells subsequent a compiler pass where to</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- move the tag and scalar field allocations so that they happen</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- before any of the subsequent packed fields.</span><span>
</span><span id="line-25"></span><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#writeOrderMarkers"><span class="hs-identifier hs-type">writeOrderMarkers</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Prog2"><span class="hs-identifier hs-type">L2.Prog2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Prog2"><span class="hs-identifier hs-type">L2.Prog2</span></a></span><span>
</span><span id="line-26"></span><span id="writeOrderMarkers"><span class="annot"><span class="annottext">writeOrderMarkers :: Prog2 -&gt; PassM Prog2
</span><a href="Gibbon.Passes.ReorderScalarWrites.html#writeOrderMarkers"><span class="hs-identifier hs-var hs-var">writeOrderMarkers</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span id="local-6989586621680974943"><span class="annot"><span class="annottext">DDefs (TyOf Exp2)
</span><a href="#local-6989586621680974943"><span class="hs-identifier hs-var">ddefs</span></a></span></span><span> </span><span id="local-6989586621680974944"><span class="annot"><span class="annottext">FunDefs Exp2
</span><a href="#local-6989586621680974944"><span class="hs-identifier hs-var">fundefs</span></a></span></span><span> </span><span id="local-6989586621680974945"><span class="annot"><span class="annottext">Maybe (Exp2, TyOf Exp2)
</span><a href="#local-6989586621680974945"><span class="hs-identifier hs-var">mainExp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-27"></span><span>    </span><span id="local-6989586621680974946"><span class="annot"><span class="annottext">[FunDef Exp2]
</span><a href="#local-6989586621680974946"><span class="hs-identifier hs-var">fds'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(FunDef Exp2 -&gt; PassM (FunDef Exp2))
-&gt; [FunDef Exp2] -&gt; PassM [FunDef Exp2]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef Exp2 -&gt; PassM (FunDef Exp2)
</span><a href="#local-6989586621680974948"><span class="hs-identifier hs-var">gofun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunDefs Exp2 -&gt; [FunDef Exp2]
forall k a. Map k a -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#elems"><span class="hs-identifier hs-var">M.elems</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp2
</span><a href="#local-6989586621680974944"><span class="hs-identifier hs-var">fundefs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680974950"><span class="annot"><span class="annottext">fundefs' :: FunDefs Exp2
</span><a href="#local-6989586621680974950"><span class="hs-identifier hs-var hs-var">fundefs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(LocVar, FunDef Exp2)] -&gt; FunDefs Exp2
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(LocVar, FunDef Exp2)] -&gt; FunDefs Exp2)
-&gt; [(LocVar, FunDef Exp2)] -&gt; FunDefs Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(FunDef Exp2 -&gt; (LocVar, FunDef Exp2))
-&gt; [FunDef Exp2] -&gt; [(LocVar, FunDef Exp2)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680974952"><span class="annot"><span class="annottext">FunDef Exp2
</span><a href="#local-6989586621680974952"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunDef Exp2 -&gt; LocVar
forall ex. FunDef ex -&gt; LocVar
</span><a href="Gibbon.Language.Syntax.html#funName"><span class="hs-identifier hs-var">funName</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef Exp2
</span><a href="#local-6989586621680974952"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">FunDef Exp2
</span><a href="#local-6989586621680974952"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FunDef Exp2]
</span><a href="#local-6989586621680974946"><span class="hs-identifier hs-var">fds'</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span id="local-6989586621680974954"><span class="annot"><span class="annottext">Maybe (Exp2, UrTy LocVar)
</span><a href="#local-6989586621680974954"><span class="hs-identifier hs-var">mainExp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp2, TyOf Exp2)
</span><a href="#local-6989586621680974945"><span class="hs-identifier hs-var">mainExp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-30"></span><span>                    </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680974955"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974955"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680974956"><span class="annot"><span class="annottext">TyOf Exp2
</span><a href="#local-6989586621680974956"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680974957"><span class="annot"><span class="annottext">env2 :: Env2 (UrTy LocVar)
</span><a href="#local-6989586621680974957"><span class="hs-identifier hs-var hs-var">env2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyEnv (UrTy LocVar)
-&gt; TyEnv (ArrowTy (UrTy LocVar)) -&gt; Env2 (UrTy LocVar)
forall a. TyEnv a -&gt; TyEnv (ArrowTy a) -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#Env2"><span class="hs-identifier hs-var">Env2</span></a></span><span> </span><span class="annot"><span class="annottext">TyEnv (UrTy LocVar)
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunDefs Exp2 -&gt; TyEnv (ArrowTy (TyOf Exp2))
forall a. FunDefs a -&gt; TyEnv (ArrowTy (TyOf a))
</span><a href="Gibbon.Language.Syntax.html#initFunEnv"><span class="hs-identifier hs-var">initFunEnv</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp2
</span><a href="#local-6989586621680974944"><span class="hs-identifier hs-var">fundefs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>                                      </span><span id="local-6989586621680974961"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974961"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RegEnv
-&gt; AllocEnv -&gt; StoreEnv -&gt; Env2 (UrTy LocVar) -&gt; Exp2 -&gt; PassM Exp2
</span><a href="#local-6989586621680974962"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RegEnv
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span> </span><span class="annot"><span class="annottext">AllocEnv
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span> </span><span class="annot"><span class="annottext">StoreEnv
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 (UrTy LocVar)
</span><a href="#local-6989586621680974957"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974955"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-32"></span><span>                                      </span><span class="annot"><span class="annottext">Maybe (Exp2, UrTy LocVar) -&gt; PassM (Maybe (Exp2, UrTy LocVar))
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Exp2, UrTy LocVar) -&gt; PassM (Maybe (Exp2, UrTy LocVar)))
-&gt; Maybe (Exp2, UrTy LocVar) -&gt; PassM (Maybe (Exp2, UrTy LocVar))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2, UrTy LocVar) -&gt; Maybe (Exp2, UrTy LocVar)
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974961"><span class="hs-identifier hs-var">e'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyOf Exp2
UrTy LocVar
</span><a href="#local-6989586621680974956"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span>                    </span><span class="annot"><span class="annottext">Maybe (Exp2, TyOf Exp2)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp2, UrTy LocVar) -&gt; PassM (Maybe (Exp2, UrTy LocVar))
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Exp2, UrTy LocVar)
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><span class="annottext">Prog2 -&gt; PassM Prog2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Prog2 -&gt; PassM Prog2) -&gt; Prog2 -&gt; PassM Prog2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp2)
-&gt; FunDefs Exp2 -&gt; Maybe (Exp2, TyOf Exp2) -&gt; Prog2
forall ex.
DDefs (TyOf ex) -&gt; FunDefs ex -&gt; Maybe (ex, TyOf ex) -&gt; Prog ex
</span><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-var">Prog</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp2)
</span><a href="#local-6989586621680974943"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp2
</span><a href="#local-6989586621680974950"><span class="hs-identifier hs-var">fundefs'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Exp2, TyOf Exp2)
Maybe (Exp2, UrTy LocVar)
</span><a href="#local-6989586621680974954"><span class="hs-identifier hs-var">mainExp'</span></a></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-37"></span><span>    </span><span id="local-6989586621680974948"><span class="annot"><span class="annottext">gofun :: FunDef Exp2 -&gt; PassM (FunDef Exp2)
</span><a href="#local-6989586621680974948"><span class="hs-identifier hs-var hs-var">gofun</span></a></span></span><span> </span><span id="local-6989586621680974963"><span class="annot"><span class="annottext">f :: FunDef Exp2
</span><a href="#local-6989586621680974963"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span class="hs-special">{</span><span id="local-6989586621680974965"><span class="annot"><span class="annottext">[LocVar]
funArgs :: [LocVar]
funArgs :: forall ex. FunDef ex -&gt; [LocVar]
</span><a href="#local-6989586621680974965"><span class="hs-identifier hs-var hs-var">funArgs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680974967"><span class="annot"><span class="annottext">Exp2
funBody :: Exp2
funBody :: forall ex. FunDef ex -&gt; ex
</span><a href="#local-6989586621680974967"><span class="hs-identifier hs-var hs-var">funBody</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680974969"><span class="annot"><span class="annottext">ArrowTy (TyOf Exp2)
funTy :: ArrowTy (TyOf Exp2)
funTy :: forall ex. FunDef ex -&gt; ArrowTy (TyOf ex)
</span><a href="#local-6989586621680974969"><span class="hs-identifier hs-var hs-var">funTy</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-38"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680974971"><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680974971"><span class="hs-identifier hs-var">reg_env</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680974972"><span class="annot"><span class="annottext">AllocEnv
</span><a href="#local-6989586621680974972"><span class="hs-identifier hs-var">alloc_env</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-39"></span><span>              </span><span class="annot"><span class="annottext">(LRM -&gt; (RegEnv, AllocEnv) -&gt; (RegEnv, AllocEnv))
-&gt; (RegEnv, AllocEnv) -&gt; [LRM] -&gt; (RegEnv, AllocEnv)
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L2.Syntax.html#LRM"><span class="hs-identifier hs-type">L2.LRM</span></a></span><span> </span><span id="local-6989586621680974975"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680974975"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621680974976"><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680974976"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621680974977"><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621680974977"><span class="hs-identifier hs-var">mode</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680974978"><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680974978"><span class="hs-identifier hs-var">renv</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680974979"><span class="annot"><span class="annottext">AllocEnv
</span><a href="#local-6989586621680974979"><span class="hs-identifier hs-var">aenv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-40"></span><span>                       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680974980"><span class="annot"><span class="annottext">renv' :: RegEnv
</span><a href="#local-6989586621680974980"><span class="hs-identifier hs-var hs-var">renv'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; Region -&gt; RegEnv -&gt; RegEnv
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680974975"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680974976"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680974978"><span class="hs-identifier hs-var">renv</span></a></span><span>
</span><span id="line-41"></span><span>                           </span><span id="local-6989586621680974982"><span class="annot"><span class="annottext">aenv' :: AllocEnv
</span><a href="#local-6989586621680974982"><span class="hs-identifier hs-var hs-var">aenv'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Modality
</span><a href="#local-6989586621680974977"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-42"></span><span>                                     </span><span class="annot"><span class="annottext">Modality
</span><a href="Gibbon.L2.Syntax.html#Output"><span class="hs-identifier hs-var">L2.Output</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-43"></span><span>                                       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680974984"><span class="annot"><span class="annottext">reg_locs :: RegionLocs
</span><a href="#local-6989586621680974984"><span class="hs-identifier hs-var hs-var">reg_locs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LocVar] -&gt; Set LocVar -&gt; RegionLocs
</span><a href="Gibbon.Passes.ReorderScalarWrites.html#RegionLocs"><span class="hs-identifier hs-var">RegionLocs</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680974975"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Set LocVar
forall a. Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">S.empty</span></a></span><span>
</span><span id="line-44"></span><span>                                       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Region -&gt; RegionLocs -&gt; AllocEnv -&gt; AllocEnv
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680974976"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">RegionLocs
</span><a href="#local-6989586621680974984"><span class="hs-identifier hs-var">reg_locs</span></a></span><span> </span><span class="annot"><span class="annottext">AllocEnv
</span><a href="#local-6989586621680974979"><span class="hs-identifier hs-var">aenv</span></a></span><span>
</span><span id="line-45"></span><span>                                     </span><span class="annot"><span class="annottext">Modality
</span><a href="Gibbon.L2.Syntax.html#Input"><span class="hs-identifier hs-var">L2.Input</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AllocEnv
</span><a href="#local-6989586621680974979"><span class="hs-identifier hs-var">aenv</span></a></span><span>
</span><span id="line-46"></span><span>                       </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680974980"><span class="hs-identifier hs-var">renv'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">AllocEnv
</span><a href="#local-6989586621680974982"><span class="hs-identifier hs-var">aenv'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RegEnv
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">AllocEnv
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArrowTy2 (UrTy LocVar) -&gt; [LRM]
forall ty2. ArrowTy2 ty2 -&gt; [LRM]
</span><a href="Gibbon.L2.Syntax.html#locVars"><span class="hs-identifier hs-var">L2.locVars</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy (TyOf Exp2)
ArrowTy2 (UrTy LocVar)
</span><a href="#local-6989586621680974969"><span class="hs-identifier hs-var">funTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>            </span><span id="local-6989586621680974989"><span class="annot"><span class="annottext">init_ty_env :: TyEnv (UrTy LocVar)
</span><a href="#local-6989586621680974989"><span class="hs-identifier hs-var hs-var">init_ty_env</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(LocVar, UrTy LocVar)] -&gt; TyEnv (UrTy LocVar)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(LocVar, UrTy LocVar)] -&gt; TyEnv (UrTy LocVar))
-&gt; [(LocVar, UrTy LocVar)] -&gt; TyEnv (UrTy LocVar)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[LocVar] -&gt; [UrTy LocVar] -&gt; [(LocVar, UrTy LocVar)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680974965"><span class="hs-identifier hs-var">funArgs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArrowTy2 (UrTy LocVar) -&gt; [UrTy LocVar]
forall ty2. ArrowTy2 ty2 -&gt; [ty2]
</span><a href="Gibbon.L2.Syntax.html#arrIns"><span class="hs-identifier hs-var">L2.arrIns</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowTy (TyOf Exp2)
ArrowTy2 (UrTy LocVar)
</span><a href="#local-6989586621680974969"><span class="hs-identifier hs-var">funTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>            </span><span id="local-6989586621680974991"><span class="annot"><span class="annottext">env2 :: Env2 (UrTy LocVar)
</span><a href="#local-6989586621680974991"><span class="hs-identifier hs-var hs-var">env2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyEnv (UrTy LocVar)
-&gt; TyEnv (ArrowTy (UrTy LocVar)) -&gt; Env2 (UrTy LocVar)
forall a. TyEnv a -&gt; TyEnv (ArrowTy a) -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#Env2"><span class="hs-identifier hs-var">Env2</span></a></span><span> </span><span class="annot"><span class="annottext">TyEnv (UrTy LocVar)
</span><a href="#local-6989586621680974989"><span class="hs-identifier hs-var">init_ty_env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunDefs Exp2 -&gt; TyEnv (ArrowTy (TyOf Exp2))
forall a. FunDefs a -&gt; TyEnv (ArrowTy (TyOf a))
</span><a href="Gibbon.Language.Syntax.html#initFunEnv"><span class="hs-identifier hs-var">initFunEnv</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp2
</span><a href="#local-6989586621680974944"><span class="hs-identifier hs-var">fundefs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>        </span><span id="local-6989586621680974992"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974992"><span class="hs-identifier hs-var">funBody'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RegEnv
-&gt; AllocEnv -&gt; StoreEnv -&gt; Env2 (UrTy LocVar) -&gt; Exp2 -&gt; PassM Exp2
</span><a href="#local-6989586621680974962"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680974971"><span class="hs-identifier hs-var">reg_env</span></a></span><span> </span><span class="annot"><span class="annottext">AllocEnv
</span><a href="#local-6989586621680974972"><span class="hs-identifier hs-var">alloc_env</span></a></span><span> </span><span class="annot"><span class="annottext">StoreEnv
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 (UrTy LocVar)
</span><a href="#local-6989586621680974991"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974967"><span class="hs-identifier hs-var">funBody</span></a></span><span>
</span><span id="line-52"></span><span>        </span><span class="annot"><span class="annottext">FunDef Exp2 -&gt; PassM (FunDef Exp2)
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(FunDef Exp2 -&gt; PassM (FunDef Exp2))
-&gt; FunDef Exp2 -&gt; PassM (FunDef Exp2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef Exp2
</span><a href="#local-6989586621680974963"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funBody :: Exp2
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974992"><span class="hs-identifier hs-var">funBody'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><a href="#local-6989586621680974962"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#RegEnv"><span class="hs-identifier hs-type">RegEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#AllocEnv"><span class="hs-identifier hs-type">AllocEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#StoreEnv"><span class="hs-identifier hs-type">StoreEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Env2"><span class="hs-identifier hs-type">Env2</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Ty2"><span class="hs-identifier hs-type">L2.Ty2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">L2.Exp2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">L2.Exp2</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span id="local-6989586621680974962"><span class="annot"><span class="annottext">go :: RegEnv
-&gt; AllocEnv -&gt; StoreEnv -&gt; Env2 (UrTy LocVar) -&gt; Exp2 -&gt; PassM Exp2
</span><a href="#local-6989586621680974962"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680974994"><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680974994"><span class="hs-identifier hs-var">reg_env</span></a></span></span><span> </span><span id="local-6989586621680974995"><span class="annot"><span class="annottext">AllocEnv
</span><a href="#local-6989586621680974995"><span class="hs-identifier hs-var">alloc_env</span></a></span></span><span> </span><span id="local-6989586621680974996"><span class="annot"><span class="annottext">StoreEnv
</span><a href="#local-6989586621680974996"><span class="hs-identifier hs-var">store_env</span></a></span></span><span> </span><span id="local-6989586621680974997"><span class="annot"><span class="annottext">Env2 (UrTy LocVar)
</span><a href="#local-6989586621680974997"><span class="hs-identifier hs-var">env2</span></a></span></span><span> </span><span id="local-6989586621680974998"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-56"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-57"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975000"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975000"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975001"><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975001"><span class="hs-identifier hs-var">locs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975002"><span class="annot"><span class="annottext">UrTy LocVar
</span><a href="#local-6989586621680975002"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975003"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975003"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680975004"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975004"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-58"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680975005"><span class="annot"><span class="annottext">env2' :: Env2 (UrTy LocVar)
</span><a href="#local-6989586621680975005"><span class="hs-identifier hs-var hs-var">env2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; UrTy LocVar -&gt; Env2 (UrTy LocVar) -&gt; Env2 (UrTy LocVar)
forall a. LocVar -&gt; a -&gt; Env2 a -&gt; Env2 a
</span><a href="Gibbon.Language.Syntax.html#extendVEnv"><span class="hs-identifier hs-var">extendVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975000"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">UrTy LocVar
</span><a href="#local-6989586621680975002"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 (UrTy LocVar)
</span><a href="#local-6989586621680974997"><span class="hs-identifier hs-var">env2</span></a></span><span>
</span><span id="line-59"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UrTy LocVar -&gt; [LocVar]
</span><a href="Gibbon.L2.Syntax.html#locsInTy"><span class="hs-identifier hs-var">L2.locsInTy</span></a></span><span> </span><span class="annot"><span class="annottext">UrTy LocVar
</span><a href="#local-6989586621680975002"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-60"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LocVar, [LocVar], UrTy LocVar, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(LocVar, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975000"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975001"><span class="hs-identifier hs-var">locs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">UrTy LocVar
</span><a href="#local-6989586621680975002"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975003"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; Exp2) -&gt; PassM Exp2 -&gt; PassM Exp2
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RegEnv
-&gt; AllocEnv -&gt; StoreEnv -&gt; Env2 (UrTy LocVar) -&gt; Exp2 -&gt; PassM Exp2
</span><a href="#local-6989586621680974962"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680974994"><span class="hs-identifier hs-var">reg_env</span></a></span><span> </span><span class="annot"><span class="annottext">AllocEnv
</span><a href="#local-6989586621680974995"><span class="hs-identifier hs-var">alloc_env</span></a></span><span> </span><span class="annot"><span class="annottext">StoreEnv
</span><a href="#local-6989586621680974996"><span class="hs-identifier hs-var">store_env</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 (UrTy LocVar)
</span><a href="#local-6989586621680975005"><span class="hs-identifier hs-var">env2'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975004"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>            </span><span class="hs-special">[</span><span id="local-6989586621680975009"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975009"><span class="hs-identifier hs-var">one</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975010"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975010"><span class="hs-identifier hs-var">is_ok</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680975011"><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975011"><span class="hs-identifier hs-var">locs_before</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680975012"><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680975012"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#RegionLocs"><span class="hs-identifier hs-type">RegionLocs</span></a></span><span> </span><span id="local-6989586621680975013"><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975013"><span class="hs-identifier hs-var">rlocs</span></a></span></span><span> </span><span id="local-6989586621680975014"><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975014"><span class="hs-identifier hs-var">allocated</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; Exp2 -&gt; Exp2 -&gt; (Bool, [LocVar], Region, RegionLocs)
</span><a href="#local-6989586621680975015"><span class="hs-identifier hs-var">isAllocationOk</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975009"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975003"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975004"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-62"></span><span>                         </span><span id="local-6989586621680975016"><span class="annot"><span class="annottext">reg_env' :: RegEnv
</span><a href="#local-6989586621680975016"><span class="hs-identifier hs-var hs-var">reg_env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LocVar -&gt; RegEnv -&gt; RegEnv) -&gt; RegEnv -&gt; [LocVar] -&gt; RegEnv
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680975017"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975017"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621680975018"><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680975018"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; Region -&gt; RegEnv -&gt; RegEnv
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975017"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680975012"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680975018"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680974994"><span class="hs-identifier hs-var">reg_env</span></a></span><span> </span><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975001"><span class="hs-identifier hs-var">locs</span></a></span><span>
</span><span id="line-63"></span><span>                         </span><span id="local-6989586621680975019"><span class="annot"><span class="annottext">alloc_env' :: AllocEnv
</span><a href="#local-6989586621680975019"><span class="hs-identifier hs-var hs-var">alloc_env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-64"></span><span>                           </span><span class="annot"><span class="annottext">Region -&gt; RegionLocs -&gt; AllocEnv -&gt; AllocEnv
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680975012"><span class="hs-identifier hs-var">reg</span></a></span><span>
</span><span id="line-65"></span><span>                             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LocVar] -&gt; Set LocVar -&gt; RegionLocs
</span><a href="Gibbon.Passes.ReorderScalarWrites.html#RegionLocs"><span class="hs-identifier hs-var">RegionLocs</span></a></span><span> </span><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975013"><span class="hs-identifier hs-var">rlocs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar -&gt; Set LocVar -&gt; Set LocVar
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#insert"><span class="hs-identifier hs-var">S.insert</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975009"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LocVar] -&gt; Set LocVar
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">S.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975011"><span class="hs-identifier hs-var">locs_before</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar -&gt; Set LocVar -&gt; Set LocVar
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-operator hs-var">`S.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975014"><span class="hs-identifier hs-var">allocated</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>                             </span><span class="annot"><span class="annottext">AllocEnv
</span><a href="#local-6989586621680974995"><span class="hs-identifier hs-var">alloc_env</span></a></span><span>
</span><span id="line-67"></span><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975010"><span class="hs-identifier hs-var">is_ok</span></a></span><span>
</span><span id="line-68"></span><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LocVar, [LocVar], UrTy LocVar, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(LocVar, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975000"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975001"><span class="hs-identifier hs-var">locs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">UrTy LocVar
</span><a href="#local-6989586621680975002"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975003"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; Exp2) -&gt; PassM Exp2 -&gt; PassM Exp2
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RegEnv
-&gt; AllocEnv -&gt; StoreEnv -&gt; Env2 (UrTy LocVar) -&gt; Exp2 -&gt; PassM Exp2
</span><a href="#local-6989586621680974962"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680975016"><span class="hs-identifier hs-var">reg_env'</span></a></span><span> </span><span class="annot"><span class="annottext">AllocEnv
</span><a href="#local-6989586621680975019"><span class="hs-identifier hs-var">alloc_env'</span></a></span><span> </span><span class="annot"><span class="annottext">StoreEnv
</span><a href="#local-6989586621680974996"><span class="hs-identifier hs-var">store_env</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 (UrTy LocVar)
</span><a href="#local-6989586621680975005"><span class="hs-identifier hs-var">env2'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975004"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-70"></span><span>                          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680975023"><span class="annot"><span class="annottext">tag_loc :: LocVar
</span><a href="#local-6989586621680975023"><span class="hs-identifier hs-var hs-var">tag_loc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LocVar] -&gt; LocVar
forall a. HasCallStack =&gt; [a] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975011"><span class="hs-identifier hs-var">locs_before</span></a></span><span>
</span><span id="line-71"></span><span>                          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680975025"><span class="annot"><span class="annottext">tag_tycon :: [Char]
</span><a href="#local-6989586621680975025"><span class="hs-identifier hs-var hs-var">tag_tycon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; Exp2 -&gt; [Char]
</span><a href="#local-6989586621680975026"><span class="hs-identifier hs-var">findTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975023"><span class="hs-identifier hs-var">tag_loc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975004"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-72"></span><span>                          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680975027"><span class="annot"><span class="annottext">in_scope :: Set LocVar
</span><a href="#local-6989586621680975027"><span class="hs-identifier hs-var hs-var">in_scope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TyEnv (UrTy LocVar) -&gt; Set LocVar
forall k a. Map k a -&gt; Set k
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#keysSet"><span class="hs-identifier hs-var">M.keysSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Env2 (UrTy LocVar) -&gt; TyEnv (UrTy LocVar)
forall a. Env2 a -&gt; TyEnv a
</span><a href="Gibbon.Language.Syntax.html#vEnv"><span class="hs-identifier hs-var">vEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 (UrTy LocVar)
</span><a href="#local-6989586621680974997"><span class="hs-identifier hs-var">env2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set LocVar -&gt; Set LocVar -&gt; Set LocVar
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-operator hs-var">`S.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar (ArrowTy2 (UrTy LocVar)) -&gt; Set LocVar
forall k a. Map k a -&gt; Set k
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#keysSet"><span class="hs-identifier hs-var">M.keysSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Env2 (UrTy LocVar) -&gt; TyEnv (ArrowTy (UrTy LocVar))
forall a. Env2 a -&gt; TyEnv (ArrowTy a)
</span><a href="Gibbon.Language.Syntax.html#fEnv"><span class="hs-identifier hs-var">fEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 (UrTy LocVar)
</span><a href="#local-6989586621680974997"><span class="hs-identifier hs-var">env2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>                              </span><span class="hs-special">(</span><span id="local-6989586621680975031"><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975031"><span class="hs-identifier hs-var">move_set</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975032"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975032"><span class="hs-identifier hs-var">move_scalars</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DDefs2 -&gt; Set LocVar -&gt; LocVar -&gt; Exp2 -&gt; (Set LocVar, Bool)
</span><a href="Gibbon.Passes.ReorderScalarWrites.html#checkScalarDeps"><span class="hs-identifier hs-var">checkScalarDeps</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp2)
DDefs2
</span><a href="#local-6989586621680974943"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975027"><span class="hs-identifier hs-var">in_scope</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975023"><span class="hs-identifier hs-var">tag_loc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-74"></span><span>                              </span><span id="local-6989586621680975034"><span class="annot"><span class="annottext">move_scalars_easy :: Bool
</span><a href="#local-6989586621680975034"><span class="hs-identifier hs-var hs-var">move_scalars_easy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975032"><span class="hs-identifier hs-var">move_scalars</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar -&gt; Bool
forall a. Set a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#null"><span class="hs-identifier hs-var">S.null</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975031"><span class="hs-identifier hs-var">move_set</span></a></span><span>
</span><span id="line-75"></span><span>                              </span><span id="local-6989586621680975037"><span class="annot"><span class="annottext">store_env' :: StoreEnv
</span><a href="#local-6989586621680975037"><span class="hs-identifier hs-var hs-var">store_env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LocVar -&gt; StoreEnv -&gt; StoreEnv)
-&gt; StoreEnv -&gt; [LocVar] -&gt; StoreEnv
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680975038"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975038"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621680975039"><span class="annot"><span class="annottext">StoreEnv
</span><a href="#local-6989586621680975039"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; LocVar -&gt; StoreEnv -&gt; StoreEnv
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975038"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975023"><span class="hs-identifier hs-var">tag_loc</span></a></span><span> </span><span class="annot"><span class="annottext">StoreEnv
</span><a href="#local-6989586621680975039"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StoreEnv
</span><a href="#local-6989586621680974996"><span class="hs-identifier hs-var">store_env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set LocVar -&gt; [LocVar]
forall a. Set a -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#toList"><span class="hs-identifier hs-var">S.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975031"><span class="hs-identifier hs-var">move_set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>                          </span><span id="local-6989586621680975041"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975041"><span class="hs-identifier hs-var">alloc_tag_here</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; PassM LocVar
forall (m :: * -&gt; *). MonadState Int m =&gt; LocVar -&gt; m LocVar
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><span class="hs-string">&quot;alloc_tag_here&quot;</span></span><span>
</span><span id="line-77"></span><span>                          </span><span id="local-6989586621680975043"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975043"><span class="hs-identifier hs-var">alloc_scalars_here</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; PassM LocVar
forall (m :: * -&gt; *). MonadState Int m =&gt; LocVar -&gt; m LocVar
</span><a href="Gibbon.Common.html#gensym"><span class="hs-identifier hs-var">gensym</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><span class="hs-string">&quot;alloc_scalars_here&quot;</span></span><span>
</span><span id="line-78"></span><span>                          </span><span class="annot"><span class="annottext">(LocVar, [LocVar], UrTy LocVar, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(LocVar, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975041"><span class="hs-identifier hs-var">alloc_tag_here</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">[UrTy LocVar] -&gt; UrTy LocVar
forall loc. [UrTy loc] -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">E2Ext LocVar (UrTy LocVar) -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E2Ext LocVar (UrTy LocVar) -&gt; Exp2)
-&gt; E2Ext LocVar (UrTy LocVar) -&gt; Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; [Char] -&gt; E2Ext LocVar (UrTy LocVar)
forall loc dec. LocVar -&gt; [Char] -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#AllocateTagHere"><span class="hs-identifier hs-var">L2.AllocateTagHere</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975023"><span class="hs-identifier hs-var">tag_loc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680975025"><span class="hs-identifier hs-var">tag_tycon</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; Exp2) -&gt; PassM Exp2 -&gt; PassM Exp2
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span>
</span><span id="line-79"></span><span>                            </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975034"><span class="hs-identifier hs-var">move_scalars_easy</span></a></span><span>
</span><span id="line-80"></span><span>                             </span><span class="hs-keyword">then</span><span>
</span><span id="line-81"></span><span>                               </span><span class="annot"><span class="annottext">(LocVar, [LocVar], UrTy LocVar, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(LocVar, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975043"><span class="hs-identifier hs-var">alloc_scalars_here</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">[UrTy LocVar] -&gt; UrTy LocVar
forall loc. [UrTy loc] -&gt; UrTy loc
</span><a href="Gibbon.Language.Syntax.html#ProdTy"><span class="hs-identifier hs-var">ProdTy</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">E2Ext LocVar (UrTy LocVar) -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E2Ext LocVar (UrTy LocVar) -&gt; Exp2)
-&gt; E2Ext LocVar (UrTy LocVar) -&gt; Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; E2Ext LocVar (UrTy LocVar)
forall loc dec. LocVar -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#AllocateScalarsHere"><span class="hs-identifier hs-var">L2.AllocateScalarsHere</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975023"><span class="hs-identifier hs-var">tag_loc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; Exp2) -&gt; (Exp2 -&gt; Exp2) -&gt; Exp2 -&gt; Exp2
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span>
</span><span id="line-82"></span><span>                               </span><span class="annot"><span class="annottext">(LocVar, [LocVar], UrTy LocVar, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(LocVar, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975000"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975001"><span class="hs-identifier hs-var">locs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">UrTy LocVar
</span><a href="#local-6989586621680975002"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975003"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; Exp2) -&gt; PassM Exp2 -&gt; PassM Exp2
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span>
</span><span id="line-83"></span><span>                                 </span><span class="annot"><span class="annottext">RegEnv
-&gt; AllocEnv -&gt; StoreEnv -&gt; Env2 (UrTy LocVar) -&gt; Exp2 -&gt; PassM Exp2
</span><a href="#local-6989586621680974962"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680975016"><span class="hs-identifier hs-var">reg_env'</span></a></span><span> </span><span class="annot"><span class="annottext">AllocEnv
</span><a href="#local-6989586621680975019"><span class="hs-identifier hs-var">alloc_env'</span></a></span><span> </span><span class="annot"><span class="annottext">StoreEnv
</span><a href="#local-6989586621680975037"><span class="hs-identifier hs-var">store_env'</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 (UrTy LocVar)
</span><a href="#local-6989586621680975005"><span class="hs-identifier hs-var">env2'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975004"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-84"></span><span>                             </span><span class="hs-keyword">else</span><span>
</span><span id="line-85"></span><span>                               </span><span class="annot"><span class="annottext">(LocVar, [LocVar], UrTy LocVar, Exp2) -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
(LocVar, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975000"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975001"><span class="hs-identifier hs-var">locs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">UrTy LocVar
</span><a href="#local-6989586621680975002"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975003"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; Exp2) -&gt; PassM Exp2 -&gt; PassM Exp2
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span>
</span><span id="line-86"></span><span>                                 </span><span class="annot"><span class="annottext">RegEnv
-&gt; AllocEnv -&gt; StoreEnv -&gt; Env2 (UrTy LocVar) -&gt; Exp2 -&gt; PassM Exp2
</span><a href="#local-6989586621680974962"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680975016"><span class="hs-identifier hs-var">reg_env'</span></a></span><span> </span><span class="annot"><span class="annottext">AllocEnv
</span><a href="#local-6989586621680975019"><span class="hs-identifier hs-var">alloc_env'</span></a></span><span> </span><span class="annot"><span class="annottext">StoreEnv
</span><a href="#local-6989586621680975037"><span class="hs-identifier hs-var">store_env'</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 (UrTy LocVar)
</span><a href="#local-6989586621680975005"><span class="hs-identifier hs-var">env2'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975004"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span>            </span><span id="local-6989586621680975048"><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975048"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; PassM Exp2
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; PassM Exp2) -&gt; [Char] -&gt; PassM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;writeOrderMarkers: encountered allocation to more&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span>
</span><span id="line-89"></span><span>                          </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; than one output location; &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[LocVar] -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975048"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; in &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span id="local-6989586621680975051"><span class="annot"><span class="annottext">E2Ext LocVar (UrTy LocVar)
</span><a href="#local-6989586621680975051"><span class="hs-identifier hs-var">ext</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-92"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">E2Ext LocVar (UrTy LocVar)
</span><a href="#local-6989586621680975051"><span class="hs-identifier hs-var">ext</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-93"></span><span>            </span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetRegionE"><span class="hs-identifier hs-type">L2.LetRegionE</span></a></span><span> </span><span id="local-6989586621680975053"><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680975053"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621680975054"><span class="annot"><span class="annottext">RegionSize
</span><a href="#local-6989586621680975054"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span id="local-6989586621680975055"><span class="annot"><span class="annottext">Maybe RegionType
</span><a href="#local-6989586621680975055"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680975056"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975056"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-94"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680975057"><span class="annot"><span class="annottext">alloc_env' :: AllocEnv
</span><a href="#local-6989586621680975057"><span class="hs-identifier hs-var hs-var">alloc_env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Region -&gt; RegionLocs -&gt; AllocEnv -&gt; AllocEnv
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680975053"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LocVar] -&gt; Set LocVar -&gt; RegionLocs
</span><a href="Gibbon.Passes.ReorderScalarWrites.html#RegionLocs"><span class="hs-identifier hs-var">RegionLocs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Set LocVar
forall a. Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">S.empty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AllocEnv
</span><a href="#local-6989586621680974995"><span class="hs-identifier hs-var">alloc_env</span></a></span><span>
</span><span id="line-95"></span><span>              </span><span class="annot"><span class="annottext">E2Ext LocVar (UrTy LocVar) -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E2Ext LocVar (UrTy LocVar) -&gt; Exp2)
-&gt; (Exp2 -&gt; E2Ext LocVar (UrTy LocVar)) -&gt; Exp2 -&gt; Exp2
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Region
-&gt; RegionSize
-&gt; Maybe RegionType
-&gt; Exp2
-&gt; E2Ext LocVar (UrTy LocVar)
forall loc dec.
Region
-&gt; RegionSize -&gt; Maybe RegionType -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetRegionE"><span class="hs-identifier hs-var">L2.LetRegionE</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680975053"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">RegionSize
</span><a href="#local-6989586621680975054"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RegionType
</span><a href="#local-6989586621680975055"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; Exp2) -&gt; PassM Exp2 -&gt; PassM Exp2
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">RegEnv
-&gt; AllocEnv -&gt; StoreEnv -&gt; Env2 (UrTy LocVar) -&gt; Exp2 -&gt; PassM Exp2
</span><a href="#local-6989586621680974962"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680974994"><span class="hs-identifier hs-var">reg_env</span></a></span><span> </span><span class="annot"><span class="annottext">AllocEnv
</span><a href="#local-6989586621680975057"><span class="hs-identifier hs-var">alloc_env'</span></a></span><span> </span><span class="annot"><span class="annottext">StoreEnv
</span><a href="#local-6989586621680974996"><span class="hs-identifier hs-var">store_env</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 (UrTy LocVar)
</span><a href="#local-6989586621680974997"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975056"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-96"></span><span>            </span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetParRegionE"><span class="hs-identifier hs-type">L2.LetParRegionE</span></a></span><span> </span><span id="local-6989586621680975059"><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680975059"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span id="local-6989586621680975060"><span class="annot"><span class="annottext">RegionSize
</span><a href="#local-6989586621680975060"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span id="local-6989586621680975061"><span class="annot"><span class="annottext">Maybe RegionType
</span><a href="#local-6989586621680975061"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680975062"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975062"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-97"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680975063"><span class="annot"><span class="annottext">alloc_env' :: AllocEnv
</span><a href="#local-6989586621680975063"><span class="hs-identifier hs-var hs-var">alloc_env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Region -&gt; RegionLocs -&gt; AllocEnv -&gt; AllocEnv
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680975059"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LocVar] -&gt; Set LocVar -&gt; RegionLocs
</span><a href="Gibbon.Passes.ReorderScalarWrites.html#RegionLocs"><span class="hs-identifier hs-var">RegionLocs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Set LocVar
forall a. Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">S.empty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AllocEnv
</span><a href="#local-6989586621680974995"><span class="hs-identifier hs-var">alloc_env</span></a></span><span>
</span><span id="line-98"></span><span>              </span><span class="annot"><span class="annottext">E2Ext LocVar (UrTy LocVar) -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E2Ext LocVar (UrTy LocVar) -&gt; Exp2)
-&gt; (Exp2 -&gt; E2Ext LocVar (UrTy LocVar)) -&gt; Exp2 -&gt; Exp2
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Region
-&gt; RegionSize
-&gt; Maybe RegionType
-&gt; Exp2
-&gt; E2Ext LocVar (UrTy LocVar)
forall loc dec.
Region
-&gt; RegionSize -&gt; Maybe RegionType -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetParRegionE"><span class="hs-identifier hs-var">L2.LetParRegionE</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680975059"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">RegionSize
</span><a href="#local-6989586621680975060"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RegionType
</span><a href="#local-6989586621680975061"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; Exp2) -&gt; PassM Exp2 -&gt; PassM Exp2
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">RegEnv
-&gt; AllocEnv -&gt; StoreEnv -&gt; Env2 (UrTy LocVar) -&gt; Exp2 -&gt; PassM Exp2
</span><a href="#local-6989586621680974962"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680974994"><span class="hs-identifier hs-var">reg_env</span></a></span><span> </span><span class="annot"><span class="annottext">AllocEnv
</span><a href="#local-6989586621680975063"><span class="hs-identifier hs-var">alloc_env'</span></a></span><span> </span><span class="annot"><span class="annottext">StoreEnv
</span><a href="#local-6989586621680974996"><span class="hs-identifier hs-var">store_env</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 (UrTy LocVar)
</span><a href="#local-6989586621680974997"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975062"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-99"></span><span>            </span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-type">L2.LetLocE</span></a></span><span> </span><span id="local-6989586621680975065"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975065"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="annot"><span class="annottext">PreLocExp LocVar
</span><a href="Gibbon.L2.Syntax.html#FreeLE"><span class="hs-identifier hs-var">L2.FreeLE</span></a></span><span> </span><span id="local-6989586621680975067"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975067"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-100"></span><span>              </span><span class="annot"><span class="annottext">E2Ext LocVar (UrTy LocVar) -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E2Ext LocVar (UrTy LocVar) -&gt; Exp2)
-&gt; (Exp2 -&gt; E2Ext LocVar (UrTy LocVar)) -&gt; Exp2 -&gt; Exp2
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar -&gt; PreLocExp LocVar -&gt; Exp2 -&gt; E2Ext LocVar (UrTy LocVar)
forall loc dec.
LocVar -&gt; PreLocExp loc -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-var">L2.LetLocE</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975065"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">PreLocExp LocVar
forall loc. PreLocExp loc
</span><a href="Gibbon.L2.Syntax.html#FreeLE"><span class="hs-identifier hs-var">L2.FreeLE</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; Exp2) -&gt; PassM Exp2 -&gt; PassM Exp2
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RegEnv
-&gt; AllocEnv -&gt; StoreEnv -&gt; Env2 (UrTy LocVar) -&gt; Exp2 -&gt; PassM Exp2
</span><a href="#local-6989586621680974962"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680974994"><span class="hs-identifier hs-var">reg_env</span></a></span><span> </span><span class="annot"><span class="annottext">AllocEnv
</span><a href="#local-6989586621680974995"><span class="hs-identifier hs-var">alloc_env</span></a></span><span> </span><span class="annot"><span class="annottext">StoreEnv
</span><a href="#local-6989586621680974996"><span class="hs-identifier hs-var">store_env</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 (UrTy LocVar)
</span><a href="#local-6989586621680974997"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975067"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>            </span><span class="annot"><a href="Gibbon.L2.Syntax.html#StartOfPkdCursor"><span class="hs-identifier hs-type">L2.StartOfPkdCursor</span></a></span><span> </span><span id="local-6989586621680975069"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975069"><span class="hs-identifier hs-var">cur</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; PassM Exp2) -&gt; Exp2 -&gt; PassM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">E2Ext LocVar (UrTy LocVar) -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E2Ext LocVar (UrTy LocVar) -&gt; Exp2)
-&gt; E2Ext LocVar (UrTy LocVar) -&gt; Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; E2Ext LocVar (UrTy LocVar)
forall loc dec. LocVar -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#StartOfPkdCursor"><span class="hs-identifier hs-var">L2.StartOfPkdCursor</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975069"><span class="hs-identifier hs-var">cur</span></a></span><span>
</span><span id="line-102"></span><span>            </span><span class="annot"><a href="Gibbon.L2.Syntax.html#TagCursor"><span class="hs-identifier hs-type">L2.TagCursor</span></a></span><span> </span><span id="local-6989586621680975071"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975071"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680975072"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975072"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; PassM Exp2) -&gt; Exp2 -&gt; PassM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">E2Ext LocVar (UrTy LocVar) -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E2Ext LocVar (UrTy LocVar) -&gt; Exp2)
-&gt; E2Ext LocVar (UrTy LocVar) -&gt; Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; LocVar -&gt; E2Ext LocVar (UrTy LocVar)
forall loc dec. LocVar -&gt; LocVar -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#TagCursor"><span class="hs-identifier hs-var">L2.TagCursor</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975071"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975072"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-103"></span><span>            </span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-type">L2.LetLocE</span></a></span><span> </span><span id="local-6989586621680975073"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975073"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621680975074"><span class="annot"><span class="annottext">PreLocExp LocVar
</span><a href="#local-6989586621680975074"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span id="local-6989586621680975075"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975075"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-104"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680975076"><span class="annot"><span class="annottext">reg :: Region
</span><a href="#local-6989586621680975076"><span class="hs-identifier hs-var hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PreLocExp LocVar
</span><a href="#local-6989586621680975074"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-105"></span><span>                      </span><span class="annot"><a href="Gibbon.L2.Syntax.html#StartOfRegionLE"><span class="hs-identifier hs-type">L2.StartOfRegionLE</span></a></span><span> </span><span id="local-6989586621680975078"><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680975078"><span class="hs-identifier hs-var">r</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680975078"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-106"></span><span>                      </span><span class="annot"><a href="Gibbon.L2.Syntax.html#InRegionLE"><span class="hs-identifier hs-type">L2.InRegionLE</span></a></span><span> </span><span id="local-6989586621680975080"><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680975080"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680975080"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-107"></span><span>                      </span><span class="annot"><a href="Gibbon.L2.Syntax.html#AfterConstantLE"><span class="hs-identifier hs-type">L2.AfterConstantLE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680975082"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975082"><span class="hs-identifier hs-var">lc</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680974994"><span class="hs-identifier hs-var">reg_env</span></a></span><span> </span><span class="annot"><span class="annottext">RegEnv -&gt; LocVar -&gt; Region
forall a b.
(Ord a, Out a, Out b, Show a, HasCallStack) =&gt;
Map a b -&gt; a -&gt; b
</span><a href="Gibbon.Common.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975082"><span class="hs-identifier hs-var">lc</span></a></span><span>
</span><span id="line-108"></span><span>                      </span><span class="annot"><a href="Gibbon.L2.Syntax.html#AfterVariableLE"><span class="hs-identifier hs-type">L2.AfterVariableLE</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680975085"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975085"><span class="hs-identifier hs-var">lc</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680974994"><span class="hs-identifier hs-var">reg_env</span></a></span><span> </span><span class="annot"><span class="annottext">RegEnv -&gt; LocVar -&gt; Region
forall a b.
(Ord a, Out a, Out b, Show a, HasCallStack) =&gt;
Map a b -&gt; a -&gt; b
</span><a href="Gibbon.Common.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975085"><span class="hs-identifier hs-var">lc</span></a></span><span>
</span><span id="line-109"></span><span>                      </span><span class="annot"><a href="Gibbon.L2.Syntax.html#FromEndLE"><span class="hs-identifier hs-type">L2.FromEndLE</span></a></span><span> </span><span id="local-6989586621680975087"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975087"><span class="hs-identifier hs-var">lc</span></a></span></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680974994"><span class="hs-identifier hs-var">reg_env</span></a></span><span> </span><span class="annot"><span class="annottext">RegEnv -&gt; LocVar -&gt; Region
forall a b.
(Ord a, Out a, Out b, Show a, HasCallStack) =&gt;
Map a b -&gt; a -&gt; b
</span><a href="Gibbon.Common.html#%23"><span class="hs-operator hs-var">#</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975087"><span class="hs-identifier hs-var">lc</span></a></span><span>
</span><span id="line-110"></span><span>                  </span><span id="local-6989586621680975088"><span class="annot"><span class="annottext">reg_env' :: RegEnv
</span><a href="#local-6989586621680975088"><span class="hs-identifier hs-var hs-var">reg_env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; Region -&gt; RegEnv -&gt; RegEnv
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975073"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680975076"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680974994"><span class="hs-identifier hs-var">reg_env</span></a></span><span>
</span><span id="line-111"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Region -&gt; AllocEnv -&gt; Maybe RegionLocs
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680975076"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">AllocEnv
</span><a href="#local-6989586621680974995"><span class="hs-identifier hs-var">alloc_env</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-112"></span><span>                </span><span class="annot"><span class="annottext">Maybe RegionLocs
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-113"></span><span>                  </span><span class="annot"><span class="annottext">E2Ext LocVar (UrTy LocVar) -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E2Ext LocVar (UrTy LocVar) -&gt; Exp2)
-&gt; (Exp2 -&gt; E2Ext LocVar (UrTy LocVar)) -&gt; Exp2 -&gt; Exp2
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar -&gt; PreLocExp LocVar -&gt; Exp2 -&gt; E2Ext LocVar (UrTy LocVar)
forall loc dec.
LocVar -&gt; PreLocExp loc -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-var">L2.LetLocE</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975073"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">PreLocExp LocVar
</span><a href="#local-6989586621680975074"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; Exp2) -&gt; PassM Exp2 -&gt; PassM Exp2
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RegEnv
-&gt; AllocEnv -&gt; StoreEnv -&gt; Env2 (UrTy LocVar) -&gt; Exp2 -&gt; PassM Exp2
</span><a href="#local-6989586621680974962"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680975088"><span class="hs-identifier hs-var">reg_env'</span></a></span><span> </span><span class="annot"><span class="annottext">AllocEnv
</span><a href="#local-6989586621680974995"><span class="hs-identifier hs-var">alloc_env</span></a></span><span> </span><span class="annot"><span class="annottext">StoreEnv
</span><a href="#local-6989586621680974996"><span class="hs-identifier hs-var">store_env</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 (UrTy LocVar)
</span><a href="#local-6989586621680974997"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975075"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>                </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#RegionLocs"><span class="hs-identifier hs-type">RegionLocs</span></a></span><span> </span><span id="local-6989586621680975090"><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975090"><span class="hs-identifier hs-var">locs</span></a></span></span><span> </span><span id="local-6989586621680975091"><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975091"><span class="hs-identifier hs-var">allocated</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-115"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680975092"><span class="annot"><span class="annottext">reg_locs :: RegionLocs
</span><a href="#local-6989586621680975092"><span class="hs-identifier hs-var hs-var">reg_locs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[LocVar] -&gt; Set LocVar -&gt; RegionLocs
</span><a href="Gibbon.Passes.ReorderScalarWrites.html#RegionLocs"><span class="hs-identifier hs-var">RegionLocs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975090"><span class="hs-identifier hs-var">locs</span></a></span><span> </span><span class="annot"><span class="annottext">[LocVar] -&gt; [LocVar] -&gt; [LocVar]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975073"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975091"><span class="hs-identifier hs-var">allocated</span></a></span><span>
</span><span id="line-116"></span><span>                      </span><span id="local-6989586621680975093"><span class="annot"><span class="annottext">alloc_env' :: AllocEnv
</span><a href="#local-6989586621680975093"><span class="hs-identifier hs-var hs-var">alloc_env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Region -&gt; RegionLocs -&gt; AllocEnv -&gt; AllocEnv
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680975076"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">RegionLocs
</span><a href="#local-6989586621680975092"><span class="hs-identifier hs-var">reg_locs</span></a></span><span> </span><span class="annot"><span class="annottext">AllocEnv
</span><a href="#local-6989586621680974995"><span class="hs-identifier hs-var">alloc_env</span></a></span><span>
</span><span id="line-117"></span><span>                  </span><span class="annot"><span class="annottext">E2Ext LocVar (UrTy LocVar) -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E2Ext LocVar (UrTy LocVar) -&gt; Exp2)
-&gt; (Exp2 -&gt; E2Ext LocVar (UrTy LocVar)) -&gt; Exp2 -&gt; Exp2
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar -&gt; PreLocExp LocVar -&gt; Exp2 -&gt; E2Ext LocVar (UrTy LocVar)
forall loc dec.
LocVar -&gt; PreLocExp loc -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-var">L2.LetLocE</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975073"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">PreLocExp LocVar
</span><a href="#local-6989586621680975074"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; Exp2) -&gt; PassM Exp2 -&gt; PassM Exp2
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RegEnv
-&gt; AllocEnv -&gt; StoreEnv -&gt; Env2 (UrTy LocVar) -&gt; Exp2 -&gt; PassM Exp2
</span><a href="#local-6989586621680974962"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680975088"><span class="hs-identifier hs-var">reg_env'</span></a></span><span> </span><span class="annot"><span class="annottext">AllocEnv
</span><a href="#local-6989586621680975093"><span class="hs-identifier hs-var">alloc_env'</span></a></span><span> </span><span class="annot"><span class="annottext">StoreEnv
</span><a href="#local-6989586621680974996"><span class="hs-identifier hs-var">store_env</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 (UrTy LocVar)
</span><a href="#local-6989586621680974997"><span class="hs-identifier hs-var">env2</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975075"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>            </span><span class="annot"><a href="Gibbon.L2.Syntax.html#RetE"><span class="hs-identifier hs-type">L2.RetE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-119"></span><span>            </span><span class="annot"><a href="Gibbon.L2.Syntax.html#FromEndE"><span class="hs-identifier hs-type">L2.FromEndE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-120"></span><span>            </span><span class="annot"><a href="Gibbon.L2.Syntax.html#BoundsCheck"><span class="hs-identifier hs-type">L2.BoundsCheck</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-121"></span><span>            </span><span class="annot"><a href="Gibbon.L2.Syntax.html#AddFixed"><span class="hs-identifier hs-type">L2.AddFixed</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-122"></span><span>            </span><span class="annot"><a href="Gibbon.L2.Syntax.html#IndirectionE"><span class="hs-identifier hs-type">L2.IndirectionE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-123"></span><span>            </span><span class="annot"><a href="Gibbon.L2.Syntax.html#GetCilkWorkerNum"><span class="hs-identifier hs-type">L2.GetCilkWorkerNum</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-124"></span><span>            </span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetAvail"><span class="hs-identifier hs-type">L2.LetAvail</span></a></span><span> </span><span id="local-6989586621680975101"><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975101"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621680975102"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975102"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">E2Ext LocVar (UrTy LocVar) -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="annot"><span class="annottext">(E2Ext LocVar (UrTy LocVar) -&gt; Exp2)
-&gt; (Exp2 -&gt; E2Ext LocVar (UrTy LocVar)) -&gt; Exp2 -&gt; Exp2
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LocVar] -&gt; Exp2 -&gt; E2Ext LocVar (UrTy LocVar)
forall loc dec. [LocVar] -&gt; E2 loc dec -&gt; E2Ext loc dec
</span><a href="Gibbon.L2.Syntax.html#LetAvail"><span class="hs-identifier hs-var">L2.LetAvail</span></a></span><span> </span><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975101"><span class="hs-identifier hs-var">vars</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; Exp2) -&gt; PassM Exp2 -&gt; PassM Exp2
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
</span><a href="#local-6989586621680975103"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975102"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-125"></span><span>            </span><span class="annot"><a href="Gibbon.L2.Syntax.html#AllocateTagHere"><span class="hs-identifier hs-type">L2.AllocateTagHere</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-126"></span><span>            </span><span class="annot"><a href="Gibbon.L2.Syntax.html#AllocateScalarsHere"><span class="hs-identifier hs-type">L2.AllocateScalarsHere</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-127"></span><span>            </span><span class="annot"><a href="Gibbon.L2.Syntax.html#SSPush"><span class="hs-identifier hs-type">L2.SSPush</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-128"></span><span>            </span><span class="annot"><a href="Gibbon.L2.Syntax.html#SSPop"><span class="hs-identifier hs-type">L2.SSPop</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span>        </span><span class="hs-comment">-- straightforward recursion (assumption: a-normal form)</span><span>
</span><span id="line-131"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-132"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-type">LitE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-133"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CharE"><span class="hs-identifier hs-type">CharE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-134"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-type">FloatE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-135"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-type">LitSymE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-136"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-137"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-138"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-type">IfE</span></a></span><span> </span><span id="local-6989586621680975114"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975114"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680975115"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975115"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680975116"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975116"><span class="hs-identifier hs-var">c</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; Exp2 -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-var">IfE</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; Exp2 -&gt; Exp2 -&gt; Exp2)
-&gt; PassM Exp2 -&gt; PassM (Exp2 -&gt; Exp2 -&gt; Exp2)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
</span><a href="#local-6989586621680975103"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975114"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">PassM (Exp2 -&gt; Exp2 -&gt; Exp2) -&gt; PassM Exp2 -&gt; PassM (Exp2 -&gt; Exp2)
forall a b. PassM (a -&gt; b) -&gt; PassM a -&gt; PassM b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
</span><a href="#local-6989586621680975103"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975115"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">PassM (Exp2 -&gt; Exp2) -&gt; PassM Exp2 -&gt; PassM Exp2
forall a b. PassM (a -&gt; b) -&gt; PassM a -&gt; PassM b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
</span><a href="#local-6989586621680975103"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975116"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-139"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-type">MkProdE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-140"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-type">ProjE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-141"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-type">CaseE</span></a></span><span> </span><span id="local-6989586621680975120"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975120"><span class="hs-identifier hs-var">scrt</span></a></span></span><span> </span><span id="local-6989586621680975121"><span class="annot"><span class="annottext">[([Char], [(LocVar, LocVar)], Exp2)]
</span><a href="#local-6989586621680975121"><span class="hs-identifier hs-var">brs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-142"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span id="local-6989586621680975122"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975122"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975120"><span class="hs-identifier hs-var">scrt</span></a></span><span>
</span><span id="line-143"></span><span>              </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680975124"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975124"><span class="hs-identifier hs-var">tyloc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; Env2 (UrTy LocVar) -&gt; UrTy LocVar
forall a. Out a =&gt; LocVar -&gt; Env2 a -&gt; a
</span><a href="Gibbon.Language.Syntax.html#lookupVEnv"><span class="hs-identifier hs-var">lookupVEnv</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975122"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 (UrTy LocVar)
</span><a href="#local-6989586621680974997"><span class="hs-identifier hs-var">env2</span></a></span><span>
</span><span id="line-144"></span><span>              </span><span id="local-6989586621680975126"><span class="annot"><span class="annottext">reg :: Region
</span><a href="#local-6989586621680975126"><span class="hs-identifier hs-var hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680974994"><span class="hs-identifier hs-var">reg_env</span></a></span><span> </span><span class="annot"><span class="annottext">RegEnv -&gt; LocVar -&gt; Region
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#%21"><span class="hs-operator hs-var">M.!</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975124"><span class="hs-identifier hs-var">tyloc</span></a></span><span>
</span><span id="line-145"></span><span>          </span><span id="local-6989586621680975128"><span class="annot"><span class="annottext">[([Char], [(LocVar, LocVar)], Exp2)]
</span><a href="#local-6989586621680975128"><span class="hs-identifier hs-var">brs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(([Char], [(LocVar, LocVar)], Exp2)
 -&gt; PassM ([Char], [(LocVar, LocVar)], Exp2))
-&gt; [([Char], [(LocVar, LocVar)], Exp2)]
-&gt; PassM [([Char], [(LocVar, LocVar)], Exp2)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680975129"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680975129"><span class="hs-identifier hs-var">dcon</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975130"><span class="annot"><span class="annottext">[(LocVar, LocVar)]
</span><a href="#local-6989586621680975130"><span class="hs-identifier hs-var">vlocs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975131"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975131"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-146"></span><span>                           </span><span class="hs-comment">-- Update the envs with bindings for pattern matched variables and locations.</span><span>
</span><span id="line-147"></span><span>                           </span><span class="hs-comment">-- The locations point to the same region as the scrutinee.</span><span>
</span><span id="line-148"></span><span>                           </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975132"><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975132"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975133"><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975133"><span class="hs-identifier hs-var">locs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(LocVar, LocVar)] -&gt; ([LocVar], [LocVar])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">[(LocVar, LocVar)]
</span><a href="#local-6989586621680975130"><span class="hs-identifier hs-var">vlocs</span></a></span><span>
</span><span id="line-149"></span><span>                               </span><span id="local-6989586621680975135"><span class="annot"><span class="annottext">reg_env' :: RegEnv
</span><a href="#local-6989586621680975135"><span class="hs-identifier hs-var hs-var">reg_env'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LocVar -&gt; RegEnv -&gt; RegEnv) -&gt; RegEnv -&gt; [LocVar] -&gt; RegEnv
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680975136"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975136"><span class="hs-identifier hs-var">lc</span></a></span></span><span> </span><span id="local-6989586621680975137"><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680975137"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; Region -&gt; RegEnv -&gt; RegEnv
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975136"><span class="hs-identifier hs-var">lc</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680975126"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680975137"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680974994"><span class="hs-identifier hs-var">reg_env</span></a></span><span> </span><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975133"><span class="hs-identifier hs-var">locs</span></a></span><span>
</span><span id="line-150"></span><span>                               </span><span id="local-6989586621680975138"><span class="annot"><span class="annottext">env2' :: Env2 (UrTy LocVar)
</span><a href="#local-6989586621680975138"><span class="hs-identifier hs-var hs-var">env2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasCallStack =&gt;
[Char]
-&gt; DDefs2
-&gt; [LocVar]
-&gt; [LocVar]
-&gt; Env2 (UrTy LocVar)
-&gt; Env2 (UrTy LocVar)
[Char]
-&gt; DDefs2
-&gt; [LocVar]
-&gt; [LocVar]
-&gt; Env2 (UrTy LocVar)
-&gt; Env2 (UrTy LocVar)
</span><a href="Gibbon.L2.Syntax.html#extendPatternMatchEnv"><span class="hs-identifier hs-var">L2.extendPatternMatchEnv</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680975129"><span class="hs-identifier hs-var">dcon</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp2)
DDefs2
</span><a href="#local-6989586621680974943"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975132"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975133"><span class="hs-identifier hs-var">locs</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 (UrTy LocVar)
</span><a href="#local-6989586621680974997"><span class="hs-identifier hs-var">env2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>                           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680975129"><span class="hs-identifier hs-var">dcon</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(LocVar, LocVar)]
</span><a href="#local-6989586621680975130"><span class="hs-identifier hs-var">vlocs</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; ([Char], [(LocVar, LocVar)], Exp2))
-&gt; PassM Exp2 -&gt; PassM ([Char], [(LocVar, LocVar)], Exp2)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">RegEnv
-&gt; AllocEnv -&gt; StoreEnv -&gt; Env2 (UrTy LocVar) -&gt; Exp2 -&gt; PassM Exp2
</span><a href="#local-6989586621680974962"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680975135"><span class="hs-identifier hs-var">reg_env'</span></a></span><span> </span><span class="annot"><span class="annottext">AllocEnv
</span><a href="#local-6989586621680974995"><span class="hs-identifier hs-var">alloc_env</span></a></span><span> </span><span class="annot"><span class="annottext">StoreEnv
</span><a href="#local-6989586621680974996"><span class="hs-identifier hs-var">store_env</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 (UrTy LocVar)
</span><a href="#local-6989586621680975138"><span class="hs-identifier hs-var">env2'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975131"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>                       </span><span class="annot"><span class="annottext">[([Char], [(LocVar, LocVar)], Exp2)]
</span><a href="#local-6989586621680975121"><span class="hs-identifier hs-var">brs</span></a></span><span>
</span><span id="line-153"></span><span>          </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; PassM Exp2) -&gt; Exp2 -&gt; PassM Exp2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; [([Char], [(LocVar, LocVar)], Exp2)] -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; [([Char], [(LocVar, loc)], PreExp ext loc dec)]
-&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-var">CaseE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975120"><span class="hs-identifier hs-var">scrt</span></a></span><span> </span><span class="annot"><span class="annottext">[([Char], [(LocVar, LocVar)], Exp2)]
</span><a href="#local-6989586621680975128"><span class="hs-identifier hs-var">brs'</span></a></span><span>
</span><span id="line-154"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-type">DataConE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-155"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-type">TimeIt</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-156"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-type">WithArenaE</span></a></span><span> </span><span id="local-6989586621680975143"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975143"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680975144"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975144"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar -&gt; Exp2 -&gt; Exp2
forall (ext :: * -&gt; * -&gt; *) loc dec.
LocVar -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-var">WithArenaE</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975143"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Exp2 -&gt; Exp2) -&gt; PassM Exp2 -&gt; PassM Exp2
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
</span><a href="#local-6989586621680975103"><span class="hs-identifier hs-var">recur</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975144"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-157"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-type">SpawnE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-158"></span><span>        </span><span class="annot"><span class="annottext">Exp2
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-159"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MapE"><span class="hs-identifier hs-type">MapE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-160"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FoldE"><span class="hs-identifier hs-type">FoldE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; PassM Exp2
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680974998"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-161"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-162"></span><span>        </span><span id="local-6989586621680975103"><span class="annot"><span class="annottext">recur :: Exp2 -&gt; PassM Exp2
</span><a href="#local-6989586621680975103"><span class="hs-identifier hs-var hs-var">recur</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RegEnv
-&gt; AllocEnv -&gt; StoreEnv -&gt; Env2 (UrTy LocVar) -&gt; Exp2 -&gt; PassM Exp2
</span><a href="#local-6989586621680974962"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680974994"><span class="hs-identifier hs-var">reg_env</span></a></span><span> </span><span class="annot"><span class="annottext">AllocEnv
</span><a href="#local-6989586621680974995"><span class="hs-identifier hs-var">alloc_env</span></a></span><span> </span><span class="annot"><span class="annottext">StoreEnv
</span><a href="#local-6989586621680974996"><span class="hs-identifier hs-var">store_env</span></a></span><span> </span><span class="annot"><span class="annottext">Env2 (UrTy LocVar)
</span><a href="#local-6989586621680974997"><span class="hs-identifier hs-var">env2</span></a></span><span>
</span><span id="line-163"></span><span>        </span><span id="local-6989586621680975015"><span class="annot"><span class="annottext">isAllocationOk :: LocVar -&gt; Exp2 -&gt; Exp2 -&gt; (Bool, [LocVar], Region, RegionLocs)
</span><a href="#local-6989586621680975015"><span class="hs-identifier hs-var hs-var">isAllocationOk</span></a></span></span><span> </span><span id="local-6989586621680975149"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975149"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621680975150"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975150"><span class="hs-identifier hs-var">rhs</span></a></span></span><span> </span><span id="local-6989586621680975151"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975151"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-164"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; RegEnv -&gt; Maybe Region
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975149"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">RegEnv
</span><a href="#local-6989586621680974994"><span class="hs-identifier hs-var">reg_env</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-165"></span><span>            </span><span class="annot"><span class="annottext">Maybe Region
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; (Bool, [LocVar], Region, RegionLocs)
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; (Bool, [LocVar], Region, RegionLocs))
-&gt; [Char] -&gt; (Bool, [LocVar], Region, RegionLocs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;writeOrderMarkers: free location &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975149"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-166"></span><span>            </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680975152"><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680975152"><span class="hs-identifier hs-var">reg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Region -&gt; AllocEnv -&gt; Maybe RegionLocs
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">M.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680975152"><span class="hs-identifier hs-var">reg</span></a></span><span> </span><span class="annot"><span class="annottext">AllocEnv
</span><a href="#local-6989586621680974995"><span class="hs-identifier hs-var">alloc_env</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-167"></span><span>                          </span><span class="annot"><span class="annottext">Maybe RegionLocs
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; (Bool, [LocVar], Region, RegionLocs)
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; (Bool, [LocVar], Region, RegionLocs))
-&gt; [Char] -&gt; (Bool, [LocVar], Region, RegionLocs)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;writeOrderMarkers: free region &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Region -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680975152"><span class="hs-identifier hs-var">reg</span></a></span><span>
</span><span id="line-168"></span><span>                          </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680975153"><span class="annot"><span class="annottext">rloc :: RegionLocs
</span><a href="#local-6989586621680975153"><span class="hs-identifier hs-var">rloc</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#RegionLocs"><span class="hs-identifier hs-type">RegionLocs</span></a></span><span> </span><span id="local-6989586621680975154"><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975154"><span class="hs-identifier hs-var">locs</span></a></span></span><span> </span><span id="local-6989586621680975155"><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975155"><span class="hs-identifier hs-var">allocated_to</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-169"></span><span>                            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680975156"><span class="annot"><span class="annottext">locs_before :: [LocVar]
</span><a href="#local-6989586621680975156"><span class="hs-identifier hs-var hs-var">locs_before</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LocVar -&gt; Bool) -&gt; [LocVar] -&gt; [LocVar]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#takeWhile"><span class="hs-identifier hs-var">takeWhile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar -&gt; LocVar -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975149"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975154"><span class="hs-identifier hs-var">locs</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-170"></span><span>                              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975156"><span class="hs-identifier hs-var">locs_before</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-171"></span><span>                                </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975156"><span class="hs-identifier hs-var">locs_before</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680975152"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RegionLocs
</span><a href="#local-6989586621680975153"><span class="hs-identifier hs-var">rloc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>                                </span><span class="annot"><span class="annottext">[LocVar]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-173"></span><span>                                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680975159"><span class="annot"><span class="annottext">freev :: Set LocVar
</span><a href="#local-6989586621680975159"><span class="hs-identifier hs-var hs-var">freev</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; Set LocVar
</span><a href="Gibbon.L2.Syntax.html#allFreeVars"><span class="hs-identifier hs-var">L2.allFreeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975150"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar -&gt; Set LocVar -&gt; Set LocVar
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-operator hs-var">`S.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; Set LocVar
</span><a href="Gibbon.L2.Syntax.html#allFreeVars"><span class="hs-identifier hs-var">L2.allFreeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975151"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-174"></span><span>                                      </span><span id="local-6989586621680975161"><span class="annot"><span class="annottext">locs_before' :: [LocVar]
</span><a href="#local-6989586621680975161"><span class="hs-identifier hs-var hs-var">locs_before'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LocVar -&gt; Bool) -&gt; [LocVar] -&gt; [LocVar]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680975162"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975162"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; Set LocVar -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#member"><span class="hs-identifier hs-var">S.member</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975162"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975159"><span class="hs-identifier hs-var">freev</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975156"><span class="hs-identifier hs-var">locs_before</span></a></span><span>
</span><span id="line-175"></span><span>                                  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set LocVar -&gt; Set LocVar -&gt; Bool
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#isProperSubsetOf"><span class="hs-identifier hs-var">S.isProperSubsetOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LocVar] -&gt; Set LocVar
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">S.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975161"><span class="hs-identifier hs-var">locs_before'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975155"><span class="hs-identifier hs-var">allocated_to</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975161"><span class="hs-identifier hs-var">locs_before'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Region
</span><a href="#local-6989586621680975152"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RegionLocs
</span><a href="#local-6989586621680975153"><span class="hs-identifier hs-var">rloc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span>        </span><span class="annot"><a href="#local-6989586621680975026"><span class="hs-identifier hs-type">findTyCon</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">L2.Exp2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Language.Syntax.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span>
</span><span id="line-178"></span><span>        </span><span id="local-6989586621680975026"><span class="annot"><span class="annottext">findTyCon :: LocVar -&gt; Exp2 -&gt; [Char]
</span><a href="#local-6989586621680975026"><span class="hs-identifier hs-var hs-var">findTyCon</span></a></span></span><span> </span><span id="local-6989586621680975166"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975166"><span class="hs-identifier hs-var">want</span></a></span></span><span> </span><span id="local-6989586621680975167"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975167"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-179"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975167"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-180"></span><span>            </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-type">DataConE</span></a></span><span> </span><span id="local-6989586621680975168"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975168"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621680975169"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680975169"><span class="hs-identifier hs-var">dcon</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975166"><span class="hs-identifier hs-var">want</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; LocVar -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975168"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DDefs2 -&gt; [Char] -&gt; [Char]
forall a. Out a =&gt; DDefs a -&gt; [Char] -&gt; [Char]
</span><a href="Gibbon.Language.Syntax.html#getTyOfDataCon"><span class="hs-identifier hs-var">getTyOfDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp2)
DDefs2
</span><a href="#local-6989586621680974943"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680975169"><span class="hs-identifier hs-var">dcon</span></a></span><span>
</span><span id="line-181"></span><span>                                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char]) -&gt; [Char] -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;findTyCon: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975166"><span class="hs-identifier hs-var">want</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; not found. &quot;</span></span><span>  </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">(LocVar, Exp2) -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975166"><span class="hs-identifier hs-var">want</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975167"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>            </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975172"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975172"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975173"><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975173"><span class="hs-identifier hs-var">_locs</span></a></span></span><span class="hs-special">,</span><span class="annot"><a href="Gibbon.Language.Syntax.html#PackedTy"><span class="hs-identifier hs-type">PackedTy</span></a></span><span> </span><span id="local-6989586621680975174"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680975174"><span class="hs-identifier hs-var">tycon</span></a></span></span><span> </span><span id="local-6989586621680975175"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975175"><span class="hs-identifier hs-var">loc</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975176"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975176"><span class="hs-identifier hs-var">_rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680975177"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975177"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975166"><span class="hs-identifier hs-var">want</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; LocVar -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975175"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680975174"><span class="hs-identifier hs-var">tycon</span></a></span><span>
</span><span id="line-183"></span><span>                                                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; Exp2 -&gt; [Char]
</span><a href="#local-6989586621680975026"><span class="hs-identifier hs-var">findTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975166"><span class="hs-identifier hs-var">want</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975177"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-184"></span><span>            </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975178"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975178"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975179"><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975179"><span class="hs-identifier hs-var">_locs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975180"><span class="annot"><span class="annottext">UrTy LocVar
</span><a href="#local-6989586621680975180"><span class="hs-identifier hs-var">_ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975181"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975181"><span class="hs-identifier hs-var">_rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680975182"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975182"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; Exp2 -&gt; [Char]
</span><a href="#local-6989586621680975026"><span class="hs-identifier hs-var">findTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975166"><span class="hs-identifier hs-var">want</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975182"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-185"></span><span>            </span><span class="annot"><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-type">IfE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680975183"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975183"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680975184"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975184"><span class="hs-identifier hs-var">c</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680975185"><span class="annot"><span class="annottext">tycon_b :: [Char]
</span><a href="#local-6989586621680975185"><span class="hs-identifier hs-var hs-var">tycon_b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar -&gt; Exp2 -&gt; [Char]
</span><a href="#local-6989586621680975026"><span class="hs-identifier hs-var">findTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975166"><span class="hs-identifier hs-var">want</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975183"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>                              </span><span id="local-6989586621680975186"><span class="annot"><span class="annottext">tycon_c :: [Char]
</span><a href="#local-6989586621680975186"><span class="hs-identifier hs-var hs-var">tycon_c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar -&gt; Exp2 -&gt; [Char]
</span><a href="#local-6989586621680975026"><span class="hs-identifier hs-var">findTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975166"><span class="hs-identifier hs-var">want</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975184"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>                          </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680975185"><span class="hs-identifier hs-var">tycon_b</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680975186"><span class="hs-identifier hs-var">tycon_c</span></a></span><span>
</span><span id="line-188"></span><span>                             </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680975185"><span class="hs-identifier hs-var">tycon_b</span></a></span><span>
</span><span id="line-189"></span><span>                             </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char]) -&gt; [Char] -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;findTyCon want: types don't match&quot;</span></span><span>
</span><span id="line-190"></span><span>            </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-type">CaseE</span></a></span><span> </span><span id="local-6989586621680975187"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975187"><span class="hs-identifier hs-var">_scrt</span></a></span></span><span> </span><span id="local-6989586621680975188"><span class="annot"><span class="annottext">[([Char], [(LocVar, LocVar)], Exp2)]
</span><a href="#local-6989586621680975188"><span class="hs-identifier hs-var">brs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680975189"><span class="annot"><span class="annottext">tycons :: [[Char]]
</span><a href="#local-6989586621680975189"><span class="hs-identifier hs-var hs-var">tycons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([Char], [(LocVar, LocVar)], Exp2) -&gt; [[Char]] -&gt; [[Char]])
-&gt; [[Char]] -&gt; [([Char], [(LocVar, LocVar)], Exp2)] -&gt; [[Char]]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680975190"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680975190"><span class="hs-identifier hs-var">_a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975191"><span class="annot"><span class="annottext">[(LocVar, LocVar)]
</span><a href="#local-6989586621680975191"><span class="hs-identifier hs-var">_b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975192"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975192"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680975193"><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621680975193"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; Exp2 -&gt; [Char]
</span><a href="#local-6989586621680975026"><span class="hs-identifier hs-var">findTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975166"><span class="hs-identifier hs-var">want</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975192"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; [[Char]]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621680975193"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[([Char], [(LocVar, LocVar)], Exp2)]
</span><a href="#local-6989586621680975188"><span class="hs-identifier hs-var">brs</span></a></span><span>
</span><span id="line-191"></span><span>                               </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Bool) -&gt; [[Char]] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#all"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall a. HasCallStack =&gt; [a] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621680975189"><span class="hs-identifier hs-var">tycons</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621680975189"><span class="hs-identifier hs-var">tycons</span></a></span><span>
</span><span id="line-192"></span><span>                                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[[Char]] -&gt; [Char]
forall a. HasCallStack =&gt; [a] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#head"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="annot"><span class="annottext">[[Char]]
</span><a href="#local-6989586621680975189"><span class="hs-identifier hs-var">tycons</span></a></span><span>
</span><span id="line-193"></span><span>                                  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char]) -&gt; [Char] -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;findTyCon want: types don't match&quot;</span></span><span>
</span><span id="line-194"></span><span>            </span><span class="annot"><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-type">WithArenaE</span></a></span><span> </span><span id="local-6989586621680975195"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975195"><span class="hs-identifier hs-var">_ar</span></a></span></span><span> </span><span id="local-6989586621680975196"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975196"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar -&gt; Exp2 -&gt; [Char]
</span><a href="#local-6989586621680975026"><span class="hs-identifier hs-var">findTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975166"><span class="hs-identifier hs-var">want</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975196"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>            </span><span class="annot"><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-type">TimeIt</span></a></span><span> </span><span id="local-6989586621680975197"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975197"><span class="hs-identifier hs-var">e0</span></a></span></span><span> </span><span id="local-6989586621680975198"><span class="annot"><span class="annottext">UrTy LocVar
</span><a href="#local-6989586621680975198"><span class="hs-identifier hs-var">_ty</span></a></span></span><span> </span><span id="local-6989586621680975199"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975199"><span class="hs-identifier hs-var">_b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar -&gt; Exp2 -&gt; [Char]
</span><a href="#local-6989586621680975026"><span class="hs-identifier hs-var">findTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975166"><span class="hs-identifier hs-var">want</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975197"><span class="hs-identifier hs-var">e0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>            </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span id="local-6989586621680975200"><span class="annot"><span class="annottext">E2Ext LocVar (UrTy LocVar)
</span><a href="#local-6989586621680975200"><span class="hs-identifier hs-var">ext</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-197"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">E2Ext LocVar (UrTy LocVar)
</span><a href="#local-6989586621680975200"><span class="hs-identifier hs-var">ext</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-198"></span><span>                </span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetRegionE"><span class="hs-identifier hs-type">L2.LetRegionE</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RegionSize
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe RegionType
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680975201"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975201"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar -&gt; Exp2 -&gt; [Char]
</span><a href="#local-6989586621680975026"><span class="hs-identifier hs-var">findTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975166"><span class="hs-identifier hs-var">want</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975201"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>                </span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetParRegionE"><span class="hs-identifier hs-type">L2.LetParRegionE</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RegionSize
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe RegionType
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680975202"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975202"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar -&gt; Exp2 -&gt; [Char]
</span><a href="#local-6989586621680975026"><span class="hs-identifier hs-var">findTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975166"><span class="hs-identifier hs-var">want</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975202"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>                </span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-type">L2.LetLocE</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">PreLocExp LocVar
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680975203"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975203"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar -&gt; Exp2 -&gt; [Char]
</span><a href="#local-6989586621680975026"><span class="hs-identifier hs-var">findTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975166"><span class="hs-identifier hs-var">want</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975203"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>                </span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetAvail"><span class="hs-identifier hs-type">L2.LetAvail</span></a></span><span> </span><span class="annot"><span class="annottext">[LocVar]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680975204"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975204"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar -&gt; Exp2 -&gt; [Char]
</span><a href="#local-6989586621680975026"><span class="hs-identifier hs-var">findTyCon</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975166"><span class="hs-identifier hs-var">want</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975204"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>                </span><span class="annot"><span class="annottext">E2Ext LocVar (UrTy LocVar)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char]) -&gt; [Char] -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;findTyCon: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975166"><span class="hs-identifier hs-var">want</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; not found. &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">(LocVar, Exp2) -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975166"><span class="hs-identifier hs-var">want</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975167"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>            </span><span class="annot"><span class="annottext">Exp2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char]) -&gt; [Char] -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;findTyCon: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975166"><span class="hs-identifier hs-var">want</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; not found. &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">(LocVar, Exp2) -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975166"><span class="hs-identifier hs-var">want</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975167"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-comment">-- | Do the values of scalar fields depend on the packed fields?</span><span>
</span><span id="line-207"></span><span class="hs-comment">--   If they do the scalar allocations cannot be moved up.</span><span>
</span><span id="line-208"></span><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#checkScalarDeps"><span class="hs-identifier hs-type">checkScalarDeps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#DDefs2"><span class="hs-identifier hs-type">L2.DDefs2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">L2.Exp2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span id="checkScalarDeps"><span class="annot"><span class="annottext">checkScalarDeps :: DDefs2 -&gt; Set LocVar -&gt; LocVar -&gt; Exp2 -&gt; (Set LocVar, Bool)
</span><a href="Gibbon.Passes.ReorderScalarWrites.html#checkScalarDeps"><span class="hs-identifier hs-var hs-var">checkScalarDeps</span></a></span></span><span> </span><span id="local-6989586621680975263"><span class="annot"><span class="annottext">DDefs2
</span><a href="#local-6989586621680975263"><span class="hs-identifier hs-var">ddefs</span></a></span></span><span> </span><span id="local-6989586621680975264"><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975264"><span class="hs-identifier hs-var">in_scope</span></a></span></span><span> </span><span id="local-6989586621680975265"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975265"><span class="hs-identifier hs-var">tag_loc</span></a></span></span><span> </span><span id="local-6989586621680975266"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975266"><span class="hs-identifier hs-var">ex0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975267"><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975267"><span class="hs-identifier hs-var">_a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975268"><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975268"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975269"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975269"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
-&gt; Set LocVar
-&gt; Bool
-&gt; Exp2
-&gt; (Map LocVar [LocVar], Set LocVar, Bool)
</span><a href="#local-6989586621680975270"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LocVar -&gt; Map LocVar [LocVar] -&gt; Map LocVar [LocVar])
-&gt; Map LocVar [LocVar] -&gt; [LocVar] -&gt; Map LocVar [LocVar]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680975271"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975271"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621680975272"><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975272"><span class="hs-identifier hs-var">move</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; [LocVar] -&gt; Map LocVar [LocVar] -&gt; Map LocVar [LocVar]
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insert"><span class="hs-identifier hs-var">M.insert</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975271"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975271"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975272"><span class="hs-identifier hs-var">move</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
forall k a. Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#empty"><span class="hs-identifier hs-var">M.empty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set LocVar -&gt; [LocVar]
forall a. Set a -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#toList"><span class="hs-identifier hs-var">S.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975264"><span class="hs-identifier hs-var">in_scope</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set LocVar
forall a. Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">S.empty</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975266"><span class="hs-identifier hs-var">ex0</span></a></span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975268"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar -&gt; Set LocVar -&gt; Set LocVar
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#difference"><span class="hs-operator hs-var">`S.difference`</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975264"><span class="hs-identifier hs-var">in_scope</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975269"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-213"></span><span>    </span><span class="annot"><a href="#local-6989586621680975270"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">M.Map</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Exp2"><span class="hs-identifier hs-type">L2.Exp2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">M.Map</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>    </span><span id="local-6989586621680975270"><span class="annot"><span class="annottext">go :: Map LocVar [LocVar]
-&gt; Set LocVar
-&gt; Bool
-&gt; Exp2
-&gt; (Map LocVar [LocVar], Set LocVar, Bool)
</span><a href="#local-6989586621680975270"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680975274"><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span></span><span> </span><span id="local-6989586621680975275"><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span></span><span> </span><span id="local-6989586621680975276"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span></span><span> </span><span id="local-6989586621680975277"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975277"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-215"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975277"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-216"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitE"><span class="hs-identifier hs-type">LitE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CharE"><span class="hs-identifier hs-type">CharE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FloatE"><span class="hs-identifier hs-type">FloatE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LitSymE"><span class="hs-identifier hs-type">LitSymE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#AppE"><span class="hs-identifier hs-type">AppE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#PrimAppE"><span class="hs-identifier hs-type">PrimAppE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>        </span><span class="hs-comment">--  -&gt; do_dcon dep_env move loc dcon args</span><span>
</span><span id="line-224"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975278"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975278"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[LocVar]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">UrTy LocVar
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680975279"><span class="annot"><span class="annottext">rhs :: Exp2
</span><a href="#local-6989586621680975279"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-type">DataConE</span></a></span><span> </span><span id="local-6989586621680975280"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975280"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621680975281"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680975281"><span class="hs-identifier hs-var">dcon</span></a></span></span><span> </span><span id="local-6989586621680975282"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680975282"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621680975283"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975283"><span class="hs-identifier hs-var">bod</span></a></span></span><span>
</span><span id="line-225"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975280"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; LocVar -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975265"><span class="hs-identifier hs-var">tag_loc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
-&gt; Set LocVar
-&gt; Bool
-&gt; LocVar
-&gt; [Char]
-&gt; [Exp2]
-&gt; (Map LocVar [LocVar], Set LocVar, Bool)
</span><a href="#local-6989586621680975284"><span class="hs-identifier hs-var">do_dcon</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975280"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680975281"><span class="hs-identifier hs-var">dcon</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680975282"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-226"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-227"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680975285"><span class="annot"><span class="annottext">free_vars :: [LocVar]
</span><a href="#local-6989586621680975285"><span class="hs-identifier hs-var hs-var">free_vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set LocVar -&gt; [LocVar]
forall a. Set a -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#toList"><span class="hs-identifier hs-var">S.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(Set LocVar -&gt; [LocVar]) -&gt; Set LocVar -&gt; [LocVar]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; Set LocVar
forall a. FreeVars a =&gt; a -&gt; Set LocVar
</span><a href="Gibbon.Language.Syntax.html#gFreeVars"><span class="hs-identifier hs-var">gFreeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975279"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar -&gt; Set LocVar -&gt; Set LocVar
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#difference"><span class="hs-operator hs-var">`S.difference`</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975264"><span class="hs-identifier hs-var">in_scope</span></a></span><span>
</span><span id="line-228"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621680975287"><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975287"><span class="hs-identifier hs-var">dep_env'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975288"><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975288"><span class="hs-identifier hs-var">move_set'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975289"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975289"><span class="hs-identifier hs-var">move'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
-&gt; Set LocVar
-&gt; Bool
-&gt; Exp2
-&gt; (Map LocVar [LocVar], Set LocVar, Bool)
</span><a href="#local-6989586621680975270"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([LocVar] -&gt; [LocVar] -&gt; [LocVar])
-&gt; LocVar -&gt; [LocVar] -&gt; Map LocVar [LocVar] -&gt; Map LocVar [LocVar]
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insertWith"><span class="hs-identifier hs-var">M.insertWith</span></a></span><span> </span><span class="annot"><span class="annottext">[LocVar] -&gt; [LocVar] -&gt; [LocVar]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">(++)</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975278"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975285"><span class="hs-identifier hs-var">free_vars</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975283"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-229"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar] -&gt; Map LocVar [LocVar] -&gt; Map LocVar [LocVar]
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975287"><span class="hs-identifier hs-var">dep_env'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar -&gt; Set LocVar -&gt; Set LocVar
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-operator hs-var">`S.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975288"><span class="hs-identifier hs-var">move_set'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975289"><span class="hs-identifier hs-var">move'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975292"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975292"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975293"><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975293"><span class="hs-identifier hs-var">_locs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975294"><span class="annot"><span class="annottext">UrTy LocVar
</span><a href="#local-6989586621680975294"><span class="hs-identifier hs-var">_ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975295"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975295"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680975296"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975296"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-231"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680975297"><span class="annot"><span class="annottext">free_vars :: [LocVar]
</span><a href="#local-6989586621680975297"><span class="hs-identifier hs-var hs-var">free_vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set LocVar -&gt; [LocVar]
forall a. Set a -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#toList"><span class="hs-identifier hs-var">S.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(Set LocVar -&gt; [LocVar]) -&gt; Set LocVar -&gt; [LocVar]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2 -&gt; Set LocVar
forall a. FreeVars a =&gt; a -&gt; Set LocVar
</span><a href="Gibbon.Language.Syntax.html#gFreeVars"><span class="hs-identifier hs-var">gFreeVars</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975295"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar -&gt; Set LocVar -&gt; Set LocVar
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#difference"><span class="hs-operator hs-var">`S.difference`</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975264"><span class="hs-identifier hs-var">in_scope</span></a></span><span>
</span><span id="line-232"></span><span>              </span><span class="hs-special">(</span><span id="local-6989586621680975298"><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975298"><span class="hs-identifier hs-var">dep_env'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975299"><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975299"><span class="hs-identifier hs-var">move_set'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975300"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975300"><span class="hs-identifier hs-var">move'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
-&gt; Set LocVar
-&gt; Bool
-&gt; Exp2
-&gt; (Map LocVar [LocVar], Set LocVar, Bool)
</span><a href="#local-6989586621680975270"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([LocVar] -&gt; [LocVar] -&gt; [LocVar])
-&gt; LocVar -&gt; [LocVar] -&gt; Map LocVar [LocVar] -&gt; Map LocVar [LocVar]
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insertWith"><span class="hs-identifier hs-var">M.insertWith</span></a></span><span> </span><span class="annot"><span class="annottext">[LocVar] -&gt; [LocVar] -&gt; [LocVar]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">(++)</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975292"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975297"><span class="hs-identifier hs-var">free_vars</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975296"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-233"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar] -&gt; Map LocVar [LocVar] -&gt; Map LocVar [LocVar]
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975298"><span class="hs-identifier hs-var">dep_env'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar -&gt; Set LocVar -&gt; Set LocVar
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-operator hs-var">`S.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975299"><span class="hs-identifier hs-var">move_set'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975300"><span class="hs-identifier hs-var">move'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-type">IfE</span></a></span><span> </span><span id="local-6989586621680975301"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975301"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680975302"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975302"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680975303"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975303"><span class="hs-identifier hs-var">c</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-235"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975304"><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975304"><span class="hs-identifier hs-var">dep_env1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975305"><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975305"><span class="hs-identifier hs-var">move_set1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975306"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975306"><span class="hs-identifier hs-var">move1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
-&gt; Set LocVar
-&gt; Bool
-&gt; Exp2
-&gt; (Map LocVar [LocVar], Set LocVar, Bool)
</span><a href="#local-6989586621680975270"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975301"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-236"></span><span>              </span><span class="hs-special">(</span><span id="local-6989586621680975307"><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975307"><span class="hs-identifier hs-var">dep_env2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975308"><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975308"><span class="hs-identifier hs-var">move_set2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975309"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975309"><span class="hs-identifier hs-var">move2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
-&gt; Set LocVar
-&gt; Bool
-&gt; Exp2
-&gt; (Map LocVar [LocVar], Set LocVar, Bool)
</span><a href="#local-6989586621680975270"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975302"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-237"></span><span>              </span><span class="hs-special">(</span><span id="local-6989586621680975310"><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975310"><span class="hs-identifier hs-var">dep_env3</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975311"><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975311"><span class="hs-identifier hs-var">move_set3</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975312"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975312"><span class="hs-identifier hs-var">move3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
-&gt; Set LocVar
-&gt; Bool
-&gt; Exp2
-&gt; (Map LocVar [LocVar], Set LocVar, Bool)
</span><a href="#local-6989586621680975270"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975303"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-238"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar] -&gt; Map LocVar [LocVar] -&gt; Map LocVar [LocVar]
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975304"><span class="hs-identifier hs-var">dep_env1</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar] -&gt; Map LocVar [LocVar] -&gt; Map LocVar [LocVar]
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975307"><span class="hs-identifier hs-var">dep_env2</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar] -&gt; Map LocVar [LocVar] -&gt; Map LocVar [LocVar]
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975310"><span class="hs-identifier hs-var">dep_env3</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-239"></span><span>              </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar -&gt; Set LocVar -&gt; Set LocVar
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-operator hs-var">`S.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975305"><span class="hs-identifier hs-var">move_set1</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar -&gt; Set LocVar -&gt; Set LocVar
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-operator hs-var">`S.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975308"><span class="hs-identifier hs-var">move_set2</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar -&gt; Set LocVar -&gt; Set LocVar
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-operator hs-var">`S.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975311"><span class="hs-identifier hs-var">move_set3</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-240"></span><span>              </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975306"><span class="hs-identifier hs-var">move1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975309"><span class="hs-identifier hs-var">move2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975312"><span class="hs-identifier hs-var">move3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MkProdE"><span class="hs-identifier hs-type">MkProdE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#ProjE"><span class="hs-identifier hs-type">ProjE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-type">CaseE</span></a></span><span> </span><span id="local-6989586621680975313"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975313"><span class="hs-identifier hs-var">scrt</span></a></span></span><span> </span><span id="local-6989586621680975314"><span class="annot"><span class="annottext">[([Char], [(LocVar, LocVar)], Exp2)]
</span><a href="#local-6989586621680975314"><span class="hs-identifier hs-var">brs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-244"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span id="local-6989586621680975315"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975315"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975313"><span class="hs-identifier hs-var">scrt</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-245"></span><span>            </span><span class="annot"><span class="annottext">(([Char], [(LocVar, LocVar)], Exp2)
 -&gt; (Map LocVar [LocVar], Set LocVar, Bool)
 -&gt; (Map LocVar [LocVar], Set LocVar, Bool))
-&gt; (Map LocVar [LocVar], Set LocVar, Bool)
-&gt; [([Char], [(LocVar, LocVar)], Exp2)]
-&gt; (Map LocVar [LocVar], Set LocVar, Bool)
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621680975316"><span class="annot"><span class="annottext">[(LocVar, LocVar)]
</span><a href="#local-6989586621680975316"><span class="hs-identifier hs-var">vlocs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975317"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975317"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975318"><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975318"><span class="hs-identifier hs-var">dep_env'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975319"><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975319"><span class="hs-identifier hs-var">move_set'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975320"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975320"><span class="hs-identifier hs-var">move'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-246"></span><span>                     </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975321"><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975321"><span class="hs-identifier hs-var">vars</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975322"><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975322"><span class="hs-identifier hs-var">_locs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(LocVar, LocVar)] -&gt; ([LocVar], [LocVar])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#unzip"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">[(LocVar, LocVar)]
</span><a href="#local-6989586621680975316"><span class="hs-identifier hs-var">vlocs</span></a></span><span>
</span><span id="line-247"></span><span>                         </span><span id="local-6989586621680975323"><span class="annot"><span class="annottext">dep_env'' :: Map LocVar [LocVar]
</span><a href="#local-6989586621680975323"><span class="hs-identifier hs-var hs-var">dep_env''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([LocVar] -&gt; [LocVar] -&gt; [LocVar])
-&gt; LocVar -&gt; [LocVar] -&gt; Map LocVar [LocVar] -&gt; Map LocVar [LocVar]
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#insertWith"><span class="hs-identifier hs-var">M.insertWith</span></a></span><span> </span><span class="annot"><span class="annottext">[LocVar] -&gt; [LocVar] -&gt; [LocVar]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">(++)</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975315"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975321"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975318"><span class="hs-identifier hs-var">dep_env'</span></a></span><span>
</span><span id="line-248"></span><span>                         </span><span class="hs-special">(</span><span id="local-6989586621680975324"><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975324"><span class="hs-identifier hs-var">dep_env'''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975325"><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975325"><span class="hs-identifier hs-var">move_set''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975326"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975326"><span class="hs-identifier hs-var">move''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
-&gt; Set LocVar
-&gt; Bool
-&gt; Exp2
-&gt; (Map LocVar [LocVar], Set LocVar, Bool)
</span><a href="#local-6989586621680975270"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975318"><span class="hs-identifier hs-var">dep_env'</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975320"><span class="hs-identifier hs-var">move'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975317"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-249"></span><span>                     </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975323"><span class="hs-identifier hs-var">dep_env''</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar] -&gt; Map LocVar [LocVar] -&gt; Map LocVar [LocVar]
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975324"><span class="hs-identifier hs-var">dep_env'''</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-250"></span><span>                         </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975319"><span class="hs-identifier hs-var">move_set'</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar -&gt; Set LocVar -&gt; Set LocVar
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-operator hs-var">`S.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975325"><span class="hs-identifier hs-var">move_set''</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-251"></span><span>                         </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975320"><span class="hs-identifier hs-var">move'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975326"><span class="hs-identifier hs-var">move''</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>                  </span><span class="annot"><span class="annottext">[([Char], [(LocVar, LocVar)], Exp2)]
</span><a href="#local-6989586621680975314"><span class="hs-identifier hs-var">brs</span></a></span><span>
</span><span id="line-254"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#DataConE"><span class="hs-identifier hs-type">DataConE</span></a></span><span> </span><span id="local-6989586621680975327"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975327"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621680975328"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680975328"><span class="hs-identifier hs-var">dcon</span></a></span></span><span> </span><span id="local-6989586621680975329"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680975329"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
-&gt; Set LocVar
-&gt; Bool
-&gt; LocVar
-&gt; [Char]
-&gt; [Exp2]
-&gt; (Map LocVar [LocVar], Set LocVar, Bool)
</span><a href="#local-6989586621680975284"><span class="hs-identifier hs-var">do_dcon</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975327"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680975328"><span class="hs-identifier hs-var">dcon</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680975329"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-255"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-type">TimeIt</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-type">WithArenaE</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680975330"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975330"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-257"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975331"><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975331"><span class="hs-identifier hs-var">dep_env'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975332"><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975332"><span class="hs-identifier hs-var">move_set'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975333"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975333"><span class="hs-identifier hs-var">move'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
-&gt; Set LocVar
-&gt; Bool
-&gt; Exp2
-&gt; (Map LocVar [LocVar], Set LocVar, Bool)
</span><a href="#local-6989586621680975270"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975330"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-258"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975331"><span class="hs-identifier hs-var">dep_env'</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar] -&gt; Map LocVar [LocVar] -&gt; Map LocVar [LocVar]
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar -&gt; Set LocVar -&gt; Set LocVar
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-operator hs-var">`S.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975332"><span class="hs-identifier hs-var">move_set'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975333"><span class="hs-identifier hs-var">move'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#SpawnE"><span class="hs-identifier hs-type">SpawnE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>        </span><span class="annot"><span class="annottext">Exp2
</span><a href="Gibbon.Language.Syntax.html#SyncE"><span class="hs-identifier hs-var">SyncE</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#MapE"><span class="hs-identifier hs-type">MapE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#FoldE"><span class="hs-identifier hs-type">FoldE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span id="local-6989586621680975334"><span class="annot"><span class="annottext">E2Ext LocVar (UrTy LocVar)
</span><a href="#local-6989586621680975334"><span class="hs-identifier hs-var">ext</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-264"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">E2Ext LocVar (UrTy LocVar)
</span><a href="#local-6989586621680975334"><span class="hs-identifier hs-var">ext</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-265"></span><span>            </span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetRegionE"><span class="hs-identifier hs-type">L2.LetRegionE</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RegionSize
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe RegionType
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680975335"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975335"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-266"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975336"><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975336"><span class="hs-identifier hs-var">dep_env'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975337"><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975337"><span class="hs-identifier hs-var">move_set'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975338"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975338"><span class="hs-identifier hs-var">move'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
-&gt; Set LocVar
-&gt; Bool
-&gt; Exp2
-&gt; (Map LocVar [LocVar], Set LocVar, Bool)
</span><a href="#local-6989586621680975270"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975335"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-267"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975336"><span class="hs-identifier hs-var">dep_env'</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar] -&gt; Map LocVar [LocVar] -&gt; Map LocVar [LocVar]
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar -&gt; Set LocVar -&gt; Set LocVar
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-operator hs-var">`S.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975337"><span class="hs-identifier hs-var">move_set'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975338"><span class="hs-identifier hs-var">move'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>            </span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetParRegionE"><span class="hs-identifier hs-type">L2.LetParRegionE</span></a></span><span> </span><span class="annot"><span class="annottext">Region
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">RegionSize
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe RegionType
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680975339"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975339"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-269"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975340"><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975340"><span class="hs-identifier hs-var">dep_env'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975341"><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975341"><span class="hs-identifier hs-var">move_set'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975342"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975342"><span class="hs-identifier hs-var">move'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
-&gt; Set LocVar
-&gt; Bool
-&gt; Exp2
-&gt; (Map LocVar [LocVar], Set LocVar, Bool)
</span><a href="#local-6989586621680975270"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975339"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-270"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975340"><span class="hs-identifier hs-var">dep_env'</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar] -&gt; Map LocVar [LocVar] -&gt; Map LocVar [LocVar]
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar -&gt; Set LocVar -&gt; Set LocVar
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-operator hs-var">`S.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975341"><span class="hs-identifier hs-var">move_set'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975342"><span class="hs-identifier hs-var">move'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>            </span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetLocE"><span class="hs-identifier hs-type">L2.LetLocE</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">PreLocExp LocVar
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680975343"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975343"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-272"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975344"><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975344"><span class="hs-identifier hs-var">dep_env'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975345"><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975345"><span class="hs-identifier hs-var">move_set'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975346"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975346"><span class="hs-identifier hs-var">move'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
-&gt; Set LocVar
-&gt; Bool
-&gt; Exp2
-&gt; (Map LocVar [LocVar], Set LocVar, Bool)
</span><a href="#local-6989586621680975270"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975343"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-273"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975344"><span class="hs-identifier hs-var">dep_env'</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar] -&gt; Map LocVar [LocVar] -&gt; Map LocVar [LocVar]
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar -&gt; Set LocVar -&gt; Set LocVar
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-operator hs-var">`S.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975345"><span class="hs-identifier hs-var">move_set'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975346"><span class="hs-identifier hs-var">move'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>            </span><span class="annot"><a href="Gibbon.L2.Syntax.html#LetAvail"><span class="hs-identifier hs-type">L2.LetAvail</span></a></span><span> </span><span class="annot"><span class="annottext">[LocVar]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680975347"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975347"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-275"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975348"><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975348"><span class="hs-identifier hs-var">dep_env'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975349"><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975349"><span class="hs-identifier hs-var">move_set'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975350"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975350"><span class="hs-identifier hs-var">move'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
-&gt; Set LocVar
-&gt; Bool
-&gt; Exp2
-&gt; (Map LocVar [LocVar], Set LocVar, Bool)
</span><a href="#local-6989586621680975270"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975347"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-276"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975348"><span class="hs-identifier hs-var">dep_env'</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar] -&gt; Map LocVar [LocVar] -&gt; Map LocVar [LocVar]
forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#union"><span class="hs-operator hs-var">`M.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar -&gt; Set LocVar -&gt; Set LocVar
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-operator hs-var">`S.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975349"><span class="hs-identifier hs-var">move_set'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975350"><span class="hs-identifier hs-var">move'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>            </span><span class="annot"><span class="annottext">E2Ext LocVar (UrTy LocVar)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975274"><span class="hs-identifier hs-var">dep_env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975275"><span class="hs-identifier hs-var">move_set</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975276"><span class="hs-identifier hs-var">move</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span>    </span><span id="local-6989586621680975366"><span class="annot"><span class="annottext">to_vertex :: (LocVar -&gt; Maybe a) -&gt; PreExp ext loc dec -&gt; a
</span><a href="#local-6989586621680975366"><span class="hs-identifier hs-var hs-var">to_vertex</span></a></span></span><span> </span><span id="local-6989586621680975367"><span class="annot"><span class="annottext">LocVar -&gt; Maybe a
</span><a href="#local-6989586621680975367"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span> </span><span id="local-6989586621680975368"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975368"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-280"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; Maybe a
</span><a href="#local-6989586621680975367"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975368"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-281"></span><span>        </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621680975369"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680975369"><span class="hs-identifier hs-var">x</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621680975369"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-282"></span><span>        </span><span class="annot"><span class="annottext">Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; a
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; a) -&gt; [Char] -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;checkScalarDeps: No vertex for:&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975368"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-283"></span><span>    </span><span class="annot"><a href="#local-6989586621680975366"><span class="hs-identifier hs-var">to_vertex</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; Maybe a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680975370"><span class="annot"><span class="annottext">PreExp ext loc dec
</span><a href="#local-6989586621680975370"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; a
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; a) -&gt; [Char] -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;checkScalarDeps: not in ANF &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">PreExp ext loc dec -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">PreExp ext loc dec
</span><a href="#local-6989586621680975370"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span>    </span><span id="local-6989586621680975284"><span class="annot"><span class="annottext">do_dcon :: Map LocVar [LocVar]
-&gt; Set LocVar
-&gt; Bool
-&gt; LocVar
-&gt; [Char]
-&gt; [Exp2]
-&gt; (Map LocVar [LocVar], Set LocVar, Bool)
</span><a href="#local-6989586621680975284"><span class="hs-identifier hs-var hs-var">do_dcon</span></a></span></span><span> </span><span id="local-6989586621680975371"><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975371"><span class="hs-identifier hs-var">dep_env</span></a></span></span><span> </span><span id="local-6989586621680975372"><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975372"><span class="hs-identifier hs-var">move_set</span></a></span></span><span> </span><span id="local-6989586621680975373"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975373"><span class="hs-identifier hs-var">move</span></a></span></span><span> </span><span id="local-6989586621680975374"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975374"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621680975375"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680975375"><span class="hs-identifier hs-var">dcon</span></a></span></span><span> </span><span id="local-6989586621680975376"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680975376"><span class="hs-identifier hs-var">args</span></a></span></span><span>
</span><span id="line-286"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975374"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; LocVar -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975265"><span class="hs-identifier hs-var">tag_loc</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-287"></span><span>            </span><span class="hs-comment">-- graphFromEdges :: Ord key =&gt; [(node, key, [key])]</span><span>
</span><span id="line-288"></span><span>            </span><span class="hs-comment">--                -&gt; (Graph, Vertex -&gt; (node, key, [key]), key -&gt; Maybe Vertex)</span><span>
</span><span id="line-289"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680975377"><span class="annot"><span class="annottext">edges :: [(LocVar, LocVar, [LocVar])]
</span><a href="#local-6989586621680975377"><span class="hs-identifier hs-var hs-var">edges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((LocVar, [LocVar]) -&gt; (LocVar, LocVar, [LocVar]))
-&gt; [(LocVar, [LocVar])] -&gt; [(LocVar, LocVar, [LocVar])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">L.map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680975378"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975378"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975379"><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975379"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975378"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975378"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975379"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(LocVar, [LocVar])] -&gt; [(LocVar, LocVar, [LocVar])])
-&gt; [(LocVar, [LocVar])] -&gt; [(LocVar, LocVar, [LocVar])]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar] -&gt; [(LocVar, [LocVar])]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#toList"><span class="hs-identifier hs-var">M.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975371"><span class="hs-identifier hs-var">dep_env</span></a></span><span>
</span><span id="line-290"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621680975381"><span class="annot"><span class="annottext">Graph
</span><a href="#local-6989586621680975381"><span class="hs-identifier hs-var">graph</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975382"><span class="annot"><span class="annottext">Int -&gt; (LocVar, LocVar, [LocVar])
</span><a href="#local-6989586621680975382"><span class="hs-identifier hs-var">keyFn</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975383"><span class="annot"><span class="annottext">LocVar -&gt; Maybe Int
</span><a href="#local-6989586621680975383"><span class="hs-identifier hs-var">vtxFn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(LocVar, LocVar, [LocVar])]
-&gt; (Graph, Int -&gt; (LocVar, LocVar, [LocVar]), LocVar -&gt; Maybe Int)
forall key node.
Ord key =&gt;
[(node, key, [key])]
-&gt; (Graph, Int -&gt; (node, key, [key]), key -&gt; Maybe Int)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Graph.html#graphFromEdges"><span class="hs-identifier hs-var">G.graphFromEdges</span></a></span><span> </span><span class="annot"><span class="annottext">[(LocVar, LocVar, [LocVar])]
</span><a href="#local-6989586621680975377"><span class="hs-identifier hs-var">edges</span></a></span><span>
</span><span id="line-291"></span><span>                </span><span id="local-6989586621680975385"><span class="annot"><span class="annottext">arg_tys :: [UrTy LocVar]
</span><a href="#local-6989586621680975385"><span class="hs-identifier hs-var hs-var">arg_tys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DDefs2 -&gt; [Char] -&gt; [UrTy LocVar]
forall a. Out a =&gt; DDefs a -&gt; [Char] -&gt; [a]
</span><a href="Gibbon.Language.Syntax.html#lookupDataCon"><span class="hs-identifier hs-var">lookupDataCon</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs2
</span><a href="#local-6989586621680975263"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680975375"><span class="hs-identifier hs-var">dcon</span></a></span><span>
</span><span id="line-292"></span><span>                </span><span id="local-6989586621680975387"><span class="annot"><span class="annottext">first_packed :: Int
</span><a href="#local-6989586621680975387"><span class="hs-identifier hs-var hs-var">first_packed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Int
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Maybe.html#fromJust"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; Maybe Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(UrTy LocVar -&gt; Bool) -&gt; [UrTy LocVar] -&gt; Maybe Int
forall a. (a -&gt; Bool) -&gt; [a] -&gt; Maybe Int
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.OldList.html#findIndex"><span class="hs-identifier hs-var">L.findIndex</span></a></span><span> </span><span class="annot"><span class="annottext">UrTy LocVar -&gt; Bool
forall a. UrTy a -&gt; Bool
</span><a href="Gibbon.Language.html#isPackedTy"><span class="hs-identifier hs-var">isPackedTy</span></a></span><span> </span><span class="annot"><span class="annottext">[UrTy LocVar]
</span><a href="#local-6989586621680975385"><span class="hs-identifier hs-var">arg_tys</span></a></span><span>
</span><span id="line-293"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621680975390"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680975390"><span class="hs-identifier hs-var">scalars</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975391"><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680975391"><span class="hs-identifier hs-var">packed</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Exp2] -&gt; ([Exp2], [Exp2])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.List.html#splitAt"><span class="hs-identifier hs-var">splitAt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680975387"><span class="hs-identifier hs-var">first_packed</span></a></span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680975376"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-294"></span><span>                </span><span id="local-6989586621680975393"><span class="annot"><span class="annottext">packed_reachable :: Set Int
</span><a href="#local-6989586621680975393"><span class="hs-identifier hs-var hs-var">packed_reachable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Set Int
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">S.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Set Int) -&gt; [Int] -&gt; Set Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-295"></span><span>                                   </span><span class="annot"><span class="annottext">(Int -&gt; [Int]) -&gt; [Int] -&gt; [Int]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Graph -&gt; Int -&gt; [Int]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Graph.html#reachable"><span class="hs-identifier hs-var">G.reachable</span></a></span><span> </span><span class="annot"><span class="annottext">Graph
</span><a href="#local-6989586621680975381"><span class="hs-identifier hs-var">graph</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; [Int]) -&gt; [Int] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-296"></span><span>                                   </span><span class="annot"><span class="annottext">(Exp2 -&gt; Int) -&gt; [Exp2] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LocVar -&gt; Maybe Int) -&gt; Exp2 -&gt; Int
forall {loc} {dec} {ext :: * -&gt; * -&gt; *} {a}.
(Out loc, Out dec, Out (ext loc dec)) =&gt;
(LocVar -&gt; Maybe a) -&gt; PreExp ext loc dec -&gt; a
</span><a href="#local-6989586621680975366"><span class="hs-identifier hs-var">to_vertex</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; Maybe Int
</span><a href="#local-6989586621680975383"><span class="hs-identifier hs-var">vtxFn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680975391"><span class="hs-identifier hs-var">packed</span></a></span><span>
</span><span id="line-297"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680975390"><span class="hs-identifier hs-var">scalars</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-298"></span><span>                 </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975371"><span class="hs-identifier hs-var">dep_env</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975372"><span class="hs-identifier hs-var">move_set</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>                 </span><span class="annot"><span class="annottext">[Exp2]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-300"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975396"><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975396"><span class="hs-identifier hs-var">move_set0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680975397"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975397"><span class="hs-identifier hs-var">move0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-301"></span><span>                         </span><span class="annot"><span class="annottext">(Exp2 -&gt; (Set LocVar, Bool) -&gt; (Set LocVar, Bool))
-&gt; (Set LocVar, Bool) -&gt; [Exp2] -&gt; (Set LocVar, Bool)
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680975398"><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975398"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975399"><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975399"><span class="hs-identifier hs-var">move_set'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680975400"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975400"><span class="hs-identifier hs-var">move'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-302"></span><span>                             </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975398"><span class="hs-identifier hs-var">sc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-303"></span><span>                               </span><span class="annot"><a href="Gibbon.Language.Syntax.html#VarE"><span class="hs-identifier hs-type">VarE</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-304"></span><span>                                 </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680975401"><span class="annot"><span class="annottext">sc_vertex :: Int
</span><a href="#local-6989586621680975401"><span class="hs-identifier hs-var hs-var">sc_vertex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(LocVar -&gt; Maybe Int) -&gt; Exp2 -&gt; Int
forall {loc} {dec} {ext :: * -&gt; * -&gt; *} {a}.
(Out loc, Out dec, Out (ext loc dec)) =&gt;
(LocVar -&gt; Maybe a) -&gt; PreExp ext loc dec -&gt; a
</span><a href="#local-6989586621680975366"><span class="hs-identifier hs-var">to_vertex</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; Maybe Int
</span><a href="#local-6989586621680975383"><span class="hs-identifier hs-var">vtxFn</span></a></span><span> </span><span class="annot"><span class="annottext">Exp2
</span><a href="#local-6989586621680975398"><span class="hs-identifier hs-var">sc</span></a></span><span>
</span><span id="line-305"></span><span>                                     </span><span id="local-6989586621680975402"><span class="annot"><span class="annottext">sc_reachable :: Set Int
</span><a href="#local-6989586621680975402"><span class="hs-identifier hs-var hs-var">sc_reachable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Set Int
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">S.fromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Graph -&gt; Int -&gt; [Int]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Graph.html#reachable"><span class="hs-identifier hs-var">G.reachable</span></a></span><span> </span><span class="annot"><span class="annottext">Graph
</span><a href="#local-6989586621680975381"><span class="hs-identifier hs-var">graph</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680975401"><span class="hs-identifier hs-var">sc_vertex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>                                     </span><span id="local-6989586621680975403"><span class="annot"><span class="annottext">move'' :: Bool
</span><a href="#local-6989586621680975403"><span class="hs-identifier hs-var hs-var">move''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975400"><span class="hs-identifier hs-var">move'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621680975393"><span class="hs-identifier hs-var">packed_reachable</span></a></span><span> </span><span class="annot"><span class="annottext">Set Int -&gt; Set Int -&gt; Bool
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#disjoint"><span class="hs-operator hs-var">`S.disjoint`</span></a></span><span> </span><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621680975402"><span class="hs-identifier hs-var">sc_reachable</span></a></span><span>
</span><span id="line-307"></span><span>                                 </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975403"><span class="hs-identifier hs-var">move''</span></a></span><span>
</span><span id="line-308"></span><span>                                    </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; LocVar) -&gt; Set Int -&gt; Set LocVar
forall b a. Ord b =&gt; (a -&gt; b) -&gt; Set a -&gt; Set b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#map"><span class="hs-identifier hs-var">S.map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LocVar, LocVar, [LocVar]) -&gt; LocVar
forall a b c. (a, b, c) -&gt; a
</span><a href="Gibbon.Common.html#fst3"><span class="hs-identifier hs-var">fst3</span></a></span><span> </span><span class="annot"><span class="annottext">((LocVar, LocVar, [LocVar]) -&gt; LocVar)
-&gt; (Int -&gt; (LocVar, LocVar, [LocVar])) -&gt; Int -&gt; LocVar
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; (LocVar, LocVar, [LocVar])
</span><a href="#local-6989586621680975382"><span class="hs-identifier hs-var">keyFn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621680975402"><span class="hs-identifier hs-var">sc_reachable</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set LocVar -&gt; Set LocVar -&gt; Set LocVar
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#union"><span class="hs-operator hs-var">`S.union`</span></a></span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975399"><span class="hs-identifier hs-var">move_set'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-309"></span><span>                                          </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975403"><span class="hs-identifier hs-var">move''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>                                    </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975399"><span class="hs-identifier hs-var">move_set'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975403"><span class="hs-identifier hs-var">move''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>                               </span><span class="annot"><span class="annottext">Exp2
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975399"><span class="hs-identifier hs-var">move_set'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975400"><span class="hs-identifier hs-var">move'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>                          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975372"><span class="hs-identifier hs-var">move_set</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975373"><span class="hs-identifier hs-var">move</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>                          </span><span class="annot"><span class="annottext">[Exp2]
</span><a href="#local-6989586621680975390"><span class="hs-identifier hs-var">scalars</span></a></span><span>
</span><span id="line-314"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975371"><span class="hs-identifier hs-var">dep_env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975396"><span class="hs-identifier hs-var">move_set0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975397"><span class="hs-identifier hs-var">move0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map LocVar [LocVar]
</span><a href="#local-6989586621680975371"><span class="hs-identifier hs-var">dep_env</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Set LocVar
</span><a href="#local-6989586621680975372"><span class="hs-identifier hs-var">move_set</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975373"><span class="hs-identifier hs-var">move</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span class="hs-keyword">type</span><span> </span><span id="StoreEnv"><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#StoreEnv"><span class="hs-identifier hs-var">StoreEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">M.Map</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span>
</span><span id="line-318"></span><span class="hs-keyword">type</span><span> </span><span id="RegEnv"><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#RegEnv"><span class="hs-identifier hs-var">RegEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">M.Map</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Region"><span class="hs-identifier hs-type">L2.Region</span></a></span><span>
</span><span id="line-319"></span><span class="hs-keyword">type</span><span> </span><span id="AllocEnv"><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#AllocEnv"><span class="hs-identifier hs-var">AllocEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">M.Map</span></a></span><span> </span><span class="annot"><a href="Gibbon.L2.Syntax.html#Region"><span class="hs-identifier hs-type">L2.Region</span></a></span><span> </span><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#RegionLocs"><span class="hs-identifier hs-type">RegionLocs</span></a></span><span>
</span><span id="line-320"></span><span class="hs-keyword">data</span><span> </span><span id="RegionLocs"><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#RegionLocs"><span class="hs-identifier hs-var">RegionLocs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RegionLocs"><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#RegionLocs"><span class="hs-identifier hs-var">RegionLocs</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="locs"><span class="annot"><span class="annottext">RegionLocs -&gt; [LocVar]
</span><a href="Gibbon.Passes.ReorderScalarWrites.html#locs"><span class="hs-identifier hs-var hs-var">locs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="allocated_to"><span class="annot"><span class="annottext">RegionLocs -&gt; Set LocVar
</span><a href="Gibbon.Passes.ReorderScalarWrites.html#allocated_to"><span class="hs-identifier hs-var hs-var">allocated_to</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">S.Set</span></a></span><span> </span><span class="annot"><a href="Gibbon.Common.html#LocVar"><span class="hs-identifier hs-type">LocVar</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-321"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621680975411"><span id="local-6989586621680975419"><span id="local-6989586621680975423"><span class="annot"><span class="annottext">Int -&gt; RegionLocs -&gt; [Char] -&gt; [Char]
[RegionLocs] -&gt; [Char] -&gt; [Char]
RegionLocs -&gt; [Char]
(Int -&gt; RegionLocs -&gt; [Char] -&gt; [Char])
-&gt; (RegionLocs -&gt; [Char])
-&gt; ([RegionLocs] -&gt; [Char] -&gt; [Char])
-&gt; Show RegionLocs
forall a.
(Int -&gt; a -&gt; [Char] -&gt; [Char])
-&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; [Char] -&gt; [Char]) -&gt; Show a
$cshowsPrec :: Int -&gt; RegionLocs -&gt; [Char] -&gt; [Char]
showsPrec :: Int -&gt; RegionLocs -&gt; [Char] -&gt; [Char]
$cshow :: RegionLocs -&gt; [Char]
show :: RegionLocs -&gt; [Char]
$cshowList :: [RegionLocs] -&gt; [Char] -&gt; [Char]
showList :: [RegionLocs] -&gt; [Char] -&gt; [Char]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#reorderScalarWrites"><span class="hs-identifier hs-type">reorderScalarWrites</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L3.Syntax.html#Prog3"><span class="hs-identifier hs-type">L3.Prog3</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#PassM"><span class="hs-identifier hs-type">PassM</span></a></span><span> </span><span class="annot"><a href="Gibbon.L3.Syntax.html#Prog3"><span class="hs-identifier hs-type">L3.Prog3</span></a></span><span>
</span><span id="line-326"></span><span id="reorderScalarWrites"><span class="annot"><span class="annottext">reorderScalarWrites :: Prog3 -&gt; PassM Prog3
</span><a href="Gibbon.Passes.ReorderScalarWrites.html#reorderScalarWrites"><span class="hs-identifier hs-var hs-var">reorderScalarWrites</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-type">Prog</span></a></span><span> </span><span id="local-6989586621680975428"><span class="annot"><span class="annottext">DDefs (TyOf Exp3)
</span><a href="#local-6989586621680975428"><span class="hs-identifier hs-var">ddefs</span></a></span></span><span> </span><span id="local-6989586621680975429"><span class="annot"><span class="annottext">FunDefs Exp3
</span><a href="#local-6989586621680975429"><span class="hs-identifier hs-var">fundefs</span></a></span></span><span> </span><span id="local-6989586621680975430"><span class="annot"><span class="annottext">Maybe (Exp3, TyOf Exp3)
</span><a href="#local-6989586621680975430"><span class="hs-identifier hs-var">mainExp</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-327"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680975431"><span class="annot"><span class="annottext">fds' :: [FunDef Exp3]
</span><a href="#local-6989586621680975431"><span class="hs-identifier hs-var hs-var">fds'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FunDef Exp3 -&gt; FunDef Exp3) -&gt; [FunDef Exp3] -&gt; [FunDef Exp3]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef Exp3 -&gt; FunDef Exp3
</span><a href="#local-6989586621680975432"><span class="hs-identifier hs-var">gofun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunDefs Exp3 -&gt; [FunDef Exp3]
forall k a. Map k a -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#elems"><span class="hs-identifier hs-var">M.elems</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp3
</span><a href="#local-6989586621680975429"><span class="hs-identifier hs-var">fundefs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>        </span><span id="local-6989586621680975433"><span class="annot"><span class="annottext">fundefs' :: FunDefs Exp3
</span><a href="#local-6989586621680975433"><span class="hs-identifier hs-var hs-var">fundefs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(LocVar, FunDef Exp3)] -&gt; FunDefs Exp3
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#fromList"><span class="hs-identifier hs-var">M.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(LocVar, FunDef Exp3)] -&gt; FunDefs Exp3)
-&gt; [(LocVar, FunDef Exp3)] -&gt; FunDefs Exp3
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(FunDef Exp3 -&gt; (LocVar, FunDef Exp3))
-&gt; [FunDef Exp3] -&gt; [(LocVar, FunDef Exp3)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680975434"><span class="annot"><span class="annottext">FunDef Exp3
</span><a href="#local-6989586621680975434"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FunDef Exp3 -&gt; LocVar
forall ex. FunDef ex -&gt; LocVar
</span><a href="Gibbon.Language.Syntax.html#funName"><span class="hs-identifier hs-var">funName</span></a></span><span> </span><span class="annot"><span class="annottext">FunDef Exp3
</span><a href="#local-6989586621680975434"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">FunDef Exp3
</span><a href="#local-6989586621680975434"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FunDef Exp3]
</span><a href="#local-6989586621680975431"><span class="hs-identifier hs-var">fds'</span></a></span><span>
</span><span id="line-329"></span><span>        </span><span id="local-6989586621680975435"><span class="annot"><span class="annottext">mainExp' :: Maybe (Exp3, UrTy ())
</span><a href="#local-6989586621680975435"><span class="hs-identifier hs-var hs-var">mainExp'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp3, TyOf Exp3)
</span><a href="#local-6989586621680975430"><span class="hs-identifier hs-var">mainExp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-330"></span><span>                    </span><span class="annot"><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975436"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975436"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975437"><span class="annot"><span class="annottext">TyOf Exp3
</span><a href="#local-6989586621680975437"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Exp3, UrTy ()) -&gt; Maybe (Exp3, UrTy ())
forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp3 -&gt; Exp3
</span><a href="#local-6989586621680975438"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975436"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TyOf Exp3
UrTy ()
</span><a href="#local-6989586621680975437"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>                    </span><span class="annot"><span class="annottext">Maybe (Exp3, TyOf Exp3)
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Exp3, UrTy ())
forall a. Maybe a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-332"></span><span>    </span><span class="annot"><span class="annottext">Prog3 -&gt; PassM Prog3
forall a. a -&gt; PassM a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Prog3 -&gt; PassM Prog3) -&gt; Prog3 -&gt; PassM Prog3
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp3)
-&gt; FunDefs Exp3 -&gt; Maybe (Exp3, TyOf Exp3) -&gt; Prog3
forall ex.
DDefs (TyOf ex) -&gt; FunDefs ex -&gt; Maybe (ex, TyOf ex) -&gt; Prog ex
</span><a href="Gibbon.Language.Syntax.html#Prog"><span class="hs-identifier hs-var">Prog</span></a></span><span> </span><span class="annot"><span class="annottext">DDefs (TyOf Exp3)
</span><a href="#local-6989586621680975428"><span class="hs-identifier hs-var">ddefs</span></a></span><span> </span><span class="annot"><span class="annottext">FunDefs Exp3
</span><a href="#local-6989586621680975433"><span class="hs-identifier hs-var">fundefs'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Exp3, TyOf Exp3)
Maybe (Exp3, UrTy ())
</span><a href="#local-6989586621680975435"><span class="hs-identifier hs-var">mainExp'</span></a></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-335"></span><span>    </span><span id="local-6989586621680975432"><span class="annot"><span class="annottext">gofun :: FunDef Exp3 -&gt; FunDef Exp3
</span><a href="#local-6989586621680975432"><span class="hs-identifier hs-var hs-var">gofun</span></a></span></span><span> </span><span id="local-6989586621680975439"><span class="annot"><span class="annottext">f :: FunDef Exp3
</span><a href="#local-6989586621680975439"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Gibbon.Language.Syntax.html#FunDef"><span class="hs-identifier hs-type">FunDef</span></a></span><span class="hs-special">{</span><span id="local-6989586621680975440"><span class="annot"><span class="annottext">Exp3
funBody :: forall ex. FunDef ex -&gt; ex
funBody :: Exp3
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var hs-var">funBody</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-336"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680975441"><span class="annot"><span class="annottext">funBody' :: Exp3
</span><a href="#local-6989586621680975441"><span class="hs-identifier hs-var hs-var">funBody'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp3 -&gt; Exp3
</span><a href="#local-6989586621680975438"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975440"><span class="hs-identifier hs-var">funBody</span></a></span><span>
</span><span id="line-337"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">FunDef Exp3
</span><a href="#local-6989586621680975439"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">funBody :: Exp3
</span><a href="Gibbon.Language.Syntax.html#funBody"><span class="hs-identifier hs-var">funBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975441"><span class="hs-identifier hs-var">funBody'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span>    </span><span class="annot"><a href="#local-6989586621680975438"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.L3.Syntax.html#Exp3"><span class="hs-identifier hs-type">L3.Exp3</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L3.Syntax.html#Exp3"><span class="hs-identifier hs-type">L3.Exp3</span></a></span><span>
</span><span id="line-340"></span><span>    </span><span id="local-6989586621680975438"><span class="annot"><span class="annottext">go :: Exp3 -&gt; Exp3
</span><a href="#local-6989586621680975438"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680975442"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975442"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-341"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975442"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-342"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975443"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975443"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975444"><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680975444"><span class="hs-identifier hs-var">locs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975445"><span class="annot"><span class="annottext">UrTy ()
</span><a href="#local-6989586621680975445"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975446"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975446"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680975447"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975447"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-343"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975446"><span class="hs-identifier hs-var">rhs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-344"></span><span>            </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L3.Syntax.html#AllocateTagHere"><span class="hs-identifier hs-type">L3.AllocateTagHere</span></a></span><span> </span><span id="local-6989586621680975449"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975449"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-345"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975450"><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975450"><span class="hs-identifier hs-var">binds</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975451"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975451"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collect
-&gt; LocVar -&gt; Exp3 -&gt; ([(LocVar, [()], UrTy (), Exp3)], Exp3)
</span><a href="Gibbon.Passes.ReorderScalarWrites.html#collectBinds"><span class="hs-identifier hs-var">collectBinds</span></a></span><span> </span><span class="annot"><span class="annottext">Collect
</span><a href="Gibbon.Passes.ReorderScalarWrites.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975449"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975447"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-346"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)] -&gt; Exp3 -&gt; Exp3
forall loc dec (ext :: * -&gt; * -&gt; *).
[(LocVar, [loc], dec, PreExp ext loc dec)]
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.html#mkLets"><span class="hs-identifier hs-var">mkLets</span></a></span><span> </span><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975450"><span class="hs-identifier hs-var">binds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp3 -&gt; Exp3
</span><a href="#local-6989586621680975438"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975451"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>            </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L3.Syntax.html#AllocateScalarsHere"><span class="hs-identifier hs-type">L3.AllocateScalarsHere</span></a></span><span> </span><span id="local-6989586621680975456"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975456"><span class="hs-identifier hs-var">loc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-348"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975457"><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975457"><span class="hs-identifier hs-var">binds</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975458"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975458"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collect
-&gt; LocVar -&gt; Exp3 -&gt; ([(LocVar, [()], UrTy (), Exp3)], Exp3)
</span><a href="Gibbon.Passes.ReorderScalarWrites.html#collectBinds"><span class="hs-identifier hs-var">collectBinds</span></a></span><span> </span><span class="annot"><span class="annottext">Collect
</span><a href="Gibbon.Passes.ReorderScalarWrites.html#Scalars"><span class="hs-identifier hs-var">Scalars</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975456"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975447"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-349"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)] -&gt; Exp3 -&gt; Exp3
forall loc dec (ext :: * -&gt; * -&gt; *).
[(LocVar, [loc], dec, PreExp ext loc dec)]
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.html#mkLets"><span class="hs-identifier hs-var">mkLets</span></a></span><span> </span><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975457"><span class="hs-identifier hs-var">binds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp3 -&gt; Exp3
</span><a href="#local-6989586621680975438"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975458"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>            </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L3.Syntax.html#StartTagAllocation"><span class="hs-identifier hs-type">L3.StartTagAllocation</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp3 -&gt; Exp3
</span><a href="#local-6989586621680975438"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975447"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-351"></span><span>            </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L3.Syntax.html#EndTagAllocation"><span class="hs-identifier hs-type">L3.EndTagAllocation</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp3 -&gt; Exp3
</span><a href="#local-6989586621680975438"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975447"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-352"></span><span>            </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L3.Syntax.html#StartScalarsAllocation"><span class="hs-identifier hs-type">L3.StartScalarsAllocation</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp3 -&gt; Exp3
</span><a href="#local-6989586621680975438"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975447"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-353"></span><span>            </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L3.Syntax.html#EndScalarsAllocation"><span class="hs-identifier hs-type">L3.EndScalarsAllocation</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp3 -&gt; Exp3
</span><a href="#local-6989586621680975438"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975447"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-354"></span><span>            </span><span class="annot"><span class="annottext">Exp3
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(LocVar, [()], UrTy (), Exp3) -&gt; Exp3 -&gt; Exp3
forall (ext :: * -&gt; * -&gt; *) loc dec.
(LocVar, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975443"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680975444"><span class="hs-identifier hs-var">locs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">UrTy ()
</span><a href="#local-6989586621680975445"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp3 -&gt; Exp3
</span><a href="#local-6989586621680975438"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975446"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp3 -&gt; Exp3
</span><a href="#local-6989586621680975438"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975447"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-type">IfE</span></a></span><span> </span><span id="local-6989586621680975464"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975464"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680975465"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975465"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680975466"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975466"><span class="hs-identifier hs-var">c</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp3 -&gt; Exp3 -&gt; Exp3 -&gt; Exp3
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-var">IfE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp3 -&gt; Exp3
</span><a href="#local-6989586621680975438"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975464"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp3 -&gt; Exp3
</span><a href="#local-6989586621680975438"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975465"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp3 -&gt; Exp3
</span><a href="#local-6989586621680975438"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975466"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-type">CaseE</span></a></span><span> </span><span id="local-6989586621680975467"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975467"><span class="hs-identifier hs-var">scrt</span></a></span></span><span> </span><span id="local-6989586621680975468"><span class="annot"><span class="annottext">[([Char], [(LocVar, ())], Exp3)]
</span><a href="#local-6989586621680975468"><span class="hs-identifier hs-var">brs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp3 -&gt; [([Char], [(LocVar, ())], Exp3)] -&gt; Exp3
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; [([Char], [(LocVar, loc)], PreExp ext loc dec)]
-&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-var">CaseE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp3 -&gt; Exp3
</span><a href="#local-6989586621680975438"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975467"><span class="hs-identifier hs-var">scrt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(([Char], [(LocVar, ())], Exp3) -&gt; ([Char], [(LocVar, ())], Exp3))
-&gt; [([Char], [(LocVar, ())], Exp3)]
-&gt; [([Char], [(LocVar, ())], Exp3)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680975469"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680975469"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975470"><span class="annot"><span class="annottext">[(LocVar, ())]
</span><a href="#local-6989586621680975470"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975471"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975471"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680975469"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(LocVar, ())]
</span><a href="#local-6989586621680975470"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp3 -&gt; Exp3
</span><a href="#local-6989586621680975438"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975471"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[([Char], [(LocVar, ())], Exp3)]
</span><a href="#local-6989586621680975468"><span class="hs-identifier hs-var">brs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-type">WithArenaE</span></a></span><span> </span><span id="local-6989586621680975472"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975472"><span class="hs-identifier hs-var">ar</span></a></span></span><span> </span><span id="local-6989586621680975473"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975473"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; Exp3 -&gt; Exp3
forall (ext :: * -&gt; * -&gt; *) loc dec.
LocVar -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-var">WithArenaE</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975472"><span class="hs-identifier hs-var">ar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp3 -&gt; Exp3
</span><a href="#local-6989586621680975438"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975473"><span class="hs-identifier hs-var">bod</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-type">TimeIt</span></a></span><span> </span><span id="local-6989586621680975474"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975474"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680975475"><span class="annot"><span class="annottext">UrTy ()
</span><a href="#local-6989586621680975475"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680975476"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975476"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp3 -&gt; UrTy () -&gt; Bool -&gt; Exp3
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec -&gt; dec -&gt; Bool -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-var">TimeIt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp3 -&gt; Exp3
</span><a href="#local-6989586621680975438"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975474"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UrTy ()
</span><a href="#local-6989586621680975475"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975476"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-359"></span><span>        </span><span class="annot"><span class="annottext">Exp3
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975442"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="hs-keyword">data</span><span> </span><span id="Collect"><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Tag"><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Scalars"><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#Scalars"><span class="hs-identifier hs-var">Scalars</span></a></span></span><span>
</span><span id="line-362"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621680975478"><span id="local-6989586621680975480"><span class="annot"><span class="annottext">Collect -&gt; Collect -&gt; Bool
(Collect -&gt; Collect -&gt; Bool)
-&gt; (Collect -&gt; Collect -&gt; Bool) -&gt; Eq Collect
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Collect -&gt; Collect -&gt; Bool
== :: Collect -&gt; Collect -&gt; Bool
$c/= :: Collect -&gt; Collect -&gt; Bool
/= :: Collect -&gt; Collect -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span class="hs-keyword">data</span><span> </span><span id="Mode"><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#Mode"><span class="hs-identifier hs-var">Mode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Search"><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#Search"><span class="hs-identifier hs-var">Search</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.L3.Syntax.html#Exp3"><span class="hs-identifier hs-type">L3.Exp3</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="SearchAndStore"><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#SearchAndStore"><span class="hs-identifier hs-var">SearchAndStore</span></a></span></span><span> </span><span class="annot"><a href="Gibbon.L3.Syntax.html#Exp3"><span class="hs-identifier hs-type">L3.Exp3</span></a></span><span>
</span><span id="line-365"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975487"><span id="local-6989586621680975495"><span class="annot"><span class="annottext">Mode -&gt; Mode -&gt; Bool
(Mode -&gt; Mode -&gt; Bool) -&gt; (Mode -&gt; Mode -&gt; Bool) -&gt; Eq Mode
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Mode -&gt; Mode -&gt; Bool
== :: Mode -&gt; Mode -&gt; Bool
$c/= :: Mode -&gt; Mode -&gt; Bool
/= :: Mode -&gt; Mode -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680975502"><span id="local-6989586621680975512"><span id="local-6989586621680975516"><span class="annot"><span class="annottext">Int -&gt; Mode -&gt; [Char] -&gt; [Char]
[Mode] -&gt; [Char] -&gt; [Char]
Mode -&gt; [Char]
(Int -&gt; Mode -&gt; [Char] -&gt; [Char])
-&gt; (Mode -&gt; [Char]) -&gt; ([Mode] -&gt; [Char] -&gt; [Char]) -&gt; Show Mode
forall a.
(Int -&gt; a -&gt; [Char] -&gt; [Char])
-&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; [Char] -&gt; [Char]) -&gt; Show a
$cshowsPrec :: Int -&gt; Mode -&gt; [Char] -&gt; [Char]
showsPrec :: Int -&gt; Mode -&gt; [Char] -&gt; [Char]
$cshow :: Mode -&gt; [Char]
show :: Mode -&gt; [Char]
$cshowList :: [Mode] -&gt; [Char] -&gt; [Char]
showList :: [Mode] -&gt; [Char] -&gt; [Char]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680975522"><span id="local-6989586621680975524"><span class="annot"><span class="annottext">(forall x. Mode -&gt; Rep Mode x)
-&gt; (forall x. Rep Mode x -&gt; Mode) -&gt; Generic Mode
forall x. Rep Mode x -&gt; Mode
forall x. Mode -&gt; Rep Mode x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. Mode -&gt; Rep Mode x
from :: forall x. Mode -&gt; Rep Mode x
$cto :: forall x. Rep Mode x -&gt; Mode
to :: forall x. Rep Mode x -&gt; Mode
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Generics.html#Generic"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680975528"><span id="local-6989586621680975536"><span class="annot"><a href="file:///home/artem/.cabal/store/ghc-9.4.5/GenericPretty-1.2.2-7277c36a966d41cd8e1371a7ee4c855b29a76e94dfe1d95510f68242766a5b82/share/doc/html/src/Text.PrettyPrint.GenericPretty.html#Out"><span class="hs-identifier hs-type">Out</span></a></span><span> </span><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-368"></span><span>  </span><span id="local-6989586621680975580"><span class="annot"><span class="annottext">doc :: Mode -&gt; Doc
</span><a href="#local-6989586621680975580"><span class="hs-identifier hs-var hs-var hs-var hs-var">doc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Doc
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/pretty-1.1.3.6/src/Text.PrettyPrint.HughesPJ.html#text"><span class="hs-identifier hs-var">text</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Doc) -&gt; (Mode -&gt; [Char]) -&gt; Mode -&gt; Doc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Mode -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span>
</span><span id="line-369"></span><span>
</span><span id="line-370"></span><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#collectBinds"><span class="hs-identifier hs-type">collectBinds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L3.Syntax.html#Exp3"><span class="hs-identifier hs-type">L3.Exp3</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><a href="Gibbon.L3.Syntax.html#Ty3"><span class="hs-identifier hs-type">L3.Ty3</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Gibbon.L3.Syntax.html#Exp3"><span class="hs-identifier hs-type">L3.Exp3</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L3.Syntax.html#Exp3"><span class="hs-identifier hs-type">L3.Exp3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span id="collectBinds"><span class="annot"><span class="annottext">collectBinds :: Collect
-&gt; LocVar -&gt; Exp3 -&gt; ([(LocVar, [()], UrTy (), Exp3)], Exp3)
</span><a href="Gibbon.Passes.ReorderScalarWrites.html#collectBinds"><span class="hs-identifier hs-var hs-var">collectBinds</span></a></span></span><span> </span><span id="local-6989586621680975591"><span class="annot"><span class="annottext">Collect
</span><a href="#local-6989586621680975591"><span class="hs-identifier hs-var">collect</span></a></span></span><span> </span><span id="local-6989586621680975592"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975592"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621680975593"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975593"><span class="hs-identifier hs-var">ex0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-372"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Collect
</span><a href="#local-6989586621680975591"><span class="hs-identifier hs-var">collect</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-373"></span><span>    </span><span class="annot"><span class="annottext">Collect
</span><a href="Gibbon.Passes.ReorderScalarWrites.html#Tag"><span class="hs-identifier hs-var">Tag</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Mode
-&gt; [(LocVar, [()], UrTy (), Exp3)]
-&gt; Exp3
-&gt; ([(LocVar, [()], UrTy (), Exp3)], Exp3)
</span><a href="#local-6989586621680975594"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp3 -&gt; Mode
</span><a href="Gibbon.Passes.ReorderScalarWrites.html#Search"><span class="hs-identifier hs-var">Search</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">E3Ext () (UrTy ()) -&gt; Exp3
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar -&gt; E3Ext () (UrTy ())
forall loc dec. LocVar -&gt; E3Ext loc dec
</span><a href="Gibbon.L3.Syntax.html#StartTagAllocation"><span class="hs-identifier hs-var">L3.StartTagAllocation</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975592"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975593"><span class="hs-identifier hs-var">ex0</span></a></span><span>
</span><span id="line-374"></span><span>    </span><span class="annot"><span class="annottext">Collect
</span><a href="Gibbon.Passes.ReorderScalarWrites.html#Scalars"><span class="hs-identifier hs-var">Scalars</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Mode
-&gt; [(LocVar, [()], UrTy (), Exp3)]
-&gt; Exp3
-&gt; ([(LocVar, [()], UrTy (), Exp3)], Exp3)
</span><a href="#local-6989586621680975594"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp3 -&gt; Mode
</span><a href="Gibbon.Passes.ReorderScalarWrites.html#Search"><span class="hs-identifier hs-var">Search</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">E3Ext () (UrTy ()) -&gt; Exp3
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar -&gt; E3Ext () (UrTy ())
forall loc dec. LocVar -&gt; E3Ext loc dec
</span><a href="Gibbon.L3.Syntax.html#StartScalarsAllocation"><span class="hs-identifier hs-var">L3.StartScalarsAllocation</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975592"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975593"><span class="hs-identifier hs-var">ex0</span></a></span><span>
</span><span id="line-375"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-376"></span><span>    </span><span id="local-6989586621680975605"><span class="annot"><span class="annottext">invert :: PreExp E3Ext loc dec -&gt; PreExp E3Ext loc dec
</span><a href="#local-6989586621680975605"><span class="hs-identifier hs-var hs-var">invert</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L3.Syntax.html#StartTagAllocation"><span class="hs-identifier hs-type">L3.StartTagAllocation</span></a></span><span> </span><span id="local-6989586621680975606"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975606"><span class="hs-identifier hs-var">loc2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">E3Ext loc dec -&gt; PreExp E3Ext loc dec
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar -&gt; E3Ext loc dec
forall loc dec. LocVar -&gt; E3Ext loc dec
</span><a href="Gibbon.L3.Syntax.html#EndTagAllocation"><span class="hs-identifier hs-var">L3.EndTagAllocation</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975606"><span class="hs-identifier hs-var">loc2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>    </span><span class="annot"><a href="#local-6989586621680975605"><span class="hs-identifier hs-var">invert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L3.Syntax.html#StartScalarsAllocation"><span class="hs-identifier hs-type">L3.StartScalarsAllocation</span></a></span><span> </span><span id="local-6989586621680975607"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975607"><span class="hs-identifier hs-var">loc2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">E3Ext loc dec -&gt; PreExp E3Ext loc dec
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar -&gt; E3Ext loc dec
forall loc dec. LocVar -&gt; E3Ext loc dec
</span><a href="Gibbon.L3.Syntax.html#EndScalarsAllocation"><span class="hs-identifier hs-var">L3.EndScalarsAllocation</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975607"><span class="hs-identifier hs-var">loc2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>    </span><span class="annot"><a href="#local-6989586621680975605"><span class="hs-identifier hs-var">invert</span></a></span><span> </span><span id="local-6989586621680975608"><span class="annot"><span class="annottext">PreExp E3Ext loc dec
</span><a href="#local-6989586621680975608"><span class="hs-identifier hs-var">oth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; PreExp E3Ext loc dec
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; PreExp E3Ext loc dec) -&gt; [Char] -&gt; PreExp E3Ext loc dec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;collectBinds: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">PreExp E3Ext loc dec -&gt; [Char]
forall a. Out a =&gt; a -&gt; [Char]
</span><a href="Gibbon.Common.html#sdoc"><span class="hs-identifier hs-var">sdoc</span></a></span><span> </span><span class="annot"><span class="annottext">PreExp E3Ext loc dec
</span><a href="#local-6989586621680975608"><span class="hs-identifier hs-var">oth</span></a></span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span>    </span><span class="annot"><a href="#local-6989586621680975594"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><a href="Gibbon.L3.Syntax.html#Ty3"><span class="hs-identifier hs-type">L3.Ty3</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Gibbon.L3.Syntax.html#Exp3"><span class="hs-identifier hs-type">L3.Exp3</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Gibbon.L3.Syntax.html#Exp3"><span class="hs-identifier hs-type">L3.Exp3</span></a></span><span>
</span><span id="line-381"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.Common.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><a href="Gibbon.L3.Syntax.html#Ty3"><span class="hs-identifier hs-type">L3.Ty3</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Gibbon.L3.Syntax.html#Exp3"><span class="hs-identifier hs-type">L3.Exp3</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Gibbon.L3.Syntax.html#Exp3"><span class="hs-identifier hs-type">L3.Exp3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span>    </span><span id="local-6989586621680975594"><span class="annot"><span class="annottext">go :: Mode
-&gt; [(LocVar, [()], UrTy (), Exp3)]
-&gt; Exp3
-&gt; ([(LocVar, [()], UrTy (), Exp3)], Exp3)
</span><a href="#local-6989586621680975594"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621680975609"><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621680975609"><span class="hs-identifier hs-var">mode</span></a></span></span><span> </span><span id="local-6989586621680975610"><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975610"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621680975611"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975611"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-383"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975611"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-384"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-type">LetE</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975612"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975612"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975613"><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680975613"><span class="hs-identifier hs-var">locs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975614"><span class="annot"><span class="annottext">UrTy ()
</span><a href="#local-6989586621680975614"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975615"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975615"><span class="hs-identifier hs-var">rhs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680975616"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975616"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-385"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621680975609"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-386"></span><span>            </span><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#Search"><span class="hs-identifier hs-type">Search</span></a></span><span> </span><span id="local-6989586621680975617"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975617"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-387"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975617"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3 -&gt; Exp3 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975615"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-388"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Mode
-&gt; [(LocVar, [()], UrTy (), Exp3)]
-&gt; Exp3
-&gt; ([(LocVar, [()], UrTy (), Exp3)], Exp3)
</span><a href="#local-6989586621680975594"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp3 -&gt; Mode
</span><a href="Gibbon.Passes.ReorderScalarWrites.html#SearchAndStore"><span class="hs-identifier hs-var">SearchAndStore</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp3 -&gt; Exp3
forall {loc} {dec} {loc} {dec}.
(Out loc, Out dec) =&gt;
PreExp E3Ext loc dec -&gt; PreExp E3Ext loc dec
</span><a href="#local-6989586621680975605"><span class="hs-identifier hs-var">invert</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975617"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975610"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975616"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-389"></span><span>              </span><span class="hs-keyword">else</span><span>
</span><span id="line-390"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975618"><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975618"><span class="hs-identifier hs-var">acc1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975619"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975619"><span class="hs-identifier hs-var">rhs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Mode
-&gt; [(LocVar, [()], UrTy (), Exp3)]
-&gt; Exp3
-&gt; ([(LocVar, [()], UrTy (), Exp3)], Exp3)
</span><a href="#local-6989586621680975594"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621680975609"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975610"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975615"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-391"></span><span>                    </span><span class="hs-special">(</span><span id="local-6989586621680975620"><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975620"><span class="hs-identifier hs-var">acc2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975621"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975621"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Mode
-&gt; [(LocVar, [()], UrTy (), Exp3)]
-&gt; Exp3
-&gt; ([(LocVar, [()], UrTy (), Exp3)], Exp3)
</span><a href="#local-6989586621680975594"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621680975609"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975618"><span class="hs-identifier hs-var">acc1</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975616"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-392"></span><span>                </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975620"><span class="hs-identifier hs-var">acc2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(LocVar, [()], UrTy (), Exp3) -&gt; Exp3 -&gt; Exp3
forall (ext :: * -&gt; * -&gt; *) loc dec.
(LocVar, [loc], dec, PreExp ext loc dec)
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#LetE"><span class="hs-identifier hs-var">LetE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975612"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680975613"><span class="hs-identifier hs-var">locs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">UrTy ()
</span><a href="#local-6989586621680975614"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975619"><span class="hs-identifier hs-var">rhs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975621"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>            </span><span class="annot"><a href="Gibbon.Passes.ReorderScalarWrites.html#SearchAndStore"><span class="hs-identifier hs-type">SearchAndStore</span></a></span><span> </span><span id="local-6989586621680975622"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975622"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-394"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975622"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3 -&gt; Exp3 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975615"><span class="hs-identifier hs-var">rhs</span></a></span><span>
</span><span id="line-395"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975610"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975611"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>              </span><span class="hs-keyword">else</span><span>
</span><span id="line-397"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975623"><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975623"><span class="hs-identifier hs-var">acc1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975624"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975624"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Mode
-&gt; [(LocVar, [()], UrTy (), Exp3)]
-&gt; Exp3
-&gt; ([(LocVar, [()], UrTy (), Exp3)], Exp3)
</span><a href="#local-6989586621680975594"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621680975609"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975610"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975616"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-398"></span><span>                </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975612"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[()]
</span><a href="#local-6989586621680975613"><span class="hs-identifier hs-var">locs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">UrTy ()
</span><a href="#local-6989586621680975614"><span class="hs-identifier hs-var">ty</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975615"><span class="hs-identifier hs-var">rhs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(LocVar, [()], UrTy (), Exp3)
-&gt; [(LocVar, [()], UrTy (), Exp3)]
-&gt; [(LocVar, [()], UrTy (), Exp3)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975623"><span class="hs-identifier hs-var">acc1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975624"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-type">IfE</span></a></span><span> </span><span id="local-6989586621680975625"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975625"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680975626"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975626"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680975627"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975627"><span class="hs-identifier hs-var">c</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-400"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975628"><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975628"><span class="hs-identifier hs-var">acc1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975629"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975629"><span class="hs-identifier hs-var">a'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Mode
-&gt; [(LocVar, [()], UrTy (), Exp3)]
-&gt; Exp3
-&gt; ([(LocVar, [()], UrTy (), Exp3)], Exp3)
</span><a href="#local-6989586621680975594"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621680975609"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975610"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975625"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-401"></span><span>              </span><span class="hs-special">(</span><span id="local-6989586621680975630"><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975630"><span class="hs-identifier hs-var">acc2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975631"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975631"><span class="hs-identifier hs-var">b'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Mode
-&gt; [(LocVar, [()], UrTy (), Exp3)]
-&gt; Exp3
-&gt; ([(LocVar, [()], UrTy (), Exp3)], Exp3)
</span><a href="#local-6989586621680975594"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621680975609"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975628"><span class="hs-identifier hs-var">acc1</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975626"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-402"></span><span>              </span><span class="hs-special">(</span><span id="local-6989586621680975632"><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975632"><span class="hs-identifier hs-var">acc3</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975633"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975633"><span class="hs-identifier hs-var">c'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Mode
-&gt; [(LocVar, [()], UrTy (), Exp3)]
-&gt; Exp3
-&gt; ([(LocVar, [()], UrTy (), Exp3)], Exp3)
</span><a href="#local-6989586621680975594"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621680975609"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975628"><span class="hs-identifier hs-var">acc1</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975627"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-403"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975630"><span class="hs-identifier hs-var">acc2</span></a></span><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
-&gt; [(LocVar, [()], UrTy (), Exp3)]
-&gt; [(LocVar, [()], UrTy (), Exp3)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975632"><span class="hs-identifier hs-var">acc3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp3 -&gt; Exp3 -&gt; Exp3 -&gt; Exp3
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; PreExp ext loc dec -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#IfE"><span class="hs-identifier hs-var">IfE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975629"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975631"><span class="hs-identifier hs-var">b'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975633"><span class="hs-identifier hs-var">c'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-type">CaseE</span></a></span><span> </span><span id="local-6989586621680975634"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975634"><span class="hs-identifier hs-var">scrt</span></a></span></span><span> </span><span id="local-6989586621680975635"><span class="annot"><span class="annottext">[([Char], [(LocVar, ())], Exp3)]
</span><a href="#local-6989586621680975635"><span class="hs-identifier hs-var">brs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-405"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975636"><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975636"><span class="hs-identifier hs-var">acc0</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975637"><span class="annot"><span class="annottext">[([Char], [(LocVar, ())], Exp3)]
</span><a href="#local-6989586621680975637"><span class="hs-identifier hs-var">brs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-406"></span><span>                </span><span class="annot"><span class="annottext">(([Char], [(LocVar, ())], Exp3)
 -&gt; ([(LocVar, [()], UrTy (), Exp3)],
     [([Char], [(LocVar, ())], Exp3)])
 -&gt; ([(LocVar, [()], UrTy (), Exp3)],
     [([Char], [(LocVar, ())], Exp3)]))
-&gt; ([(LocVar, [()], UrTy (), Exp3)],
    [([Char], [(LocVar, ())], Exp3)])
-&gt; [([Char], [(LocVar, ())], Exp3)]
-&gt; ([(LocVar, [()], UrTy (), Exp3)],
    [([Char], [(LocVar, ())], Exp3)])
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/base-4.17.1.0/src/Data.Foldable.html#foldr"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680975638"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680975638"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975639"><span class="annot"><span class="annottext">[(LocVar, ())]
</span><a href="#local-6989586621680975639"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975640"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975640"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975641"><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975641"><span class="hs-identifier hs-var">acc'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975642"><span class="annot"><span class="annottext">[([Char], [(LocVar, ())], Exp3)]
</span><a href="#local-6989586621680975642"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-407"></span><span>                         </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975643"><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975643"><span class="hs-identifier hs-var">acc''</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975644"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975644"><span class="hs-identifier hs-var">c'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Mode
-&gt; [(LocVar, [()], UrTy (), Exp3)]
-&gt; Exp3
-&gt; ([(LocVar, [()], UrTy (), Exp3)], Exp3)
</span><a href="#local-6989586621680975594"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621680975609"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975641"><span class="hs-identifier hs-var">acc'</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975640"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-408"></span><span>                         </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975643"><span class="hs-identifier hs-var">acc''</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621680975638"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[(LocVar, ())]
</span><a href="#local-6989586621680975639"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975644"><span class="hs-identifier hs-var">c'</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">([Char], [(LocVar, ())], Exp3)
-&gt; [([Char], [(LocVar, ())], Exp3)]
-&gt; [([Char], [(LocVar, ())], Exp3)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="file:///nix/store/8l12vmymy3adw2m02pf73xq5xjf6mfwp-ghc-9.4.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.9.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[([Char], [(LocVar, ())], Exp3)]
</span><a href="#local-6989586621680975642"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975610"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>                      </span><span class="annot"><span class="annottext">[([Char], [(LocVar, ())], Exp3)]
</span><a href="#local-6989586621680975635"><span class="hs-identifier hs-var">brs</span></a></span><span>
</span><span id="line-411"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975636"><span class="hs-identifier hs-var">acc0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp3 -&gt; [([Char], [(LocVar, ())], Exp3)] -&gt; Exp3
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec
-&gt; [([Char], [(LocVar, loc)], PreExp ext loc dec)]
-&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#CaseE"><span class="hs-identifier hs-var">CaseE</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975634"><span class="hs-identifier hs-var">scrt</span></a></span><span> </span><span class="annot"><span class="annottext">[([Char], [(LocVar, ())], Exp3)]
</span><a href="#local-6989586621680975637"><span class="hs-identifier hs-var">brs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-type">WithArenaE</span></a></span><span> </span><span id="local-6989586621680975645"><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975645"><span class="hs-identifier hs-var">ar</span></a></span></span><span> </span><span id="local-6989586621680975646"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975646"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-413"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975647"><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975647"><span class="hs-identifier hs-var">acc'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975648"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975648"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Mode
-&gt; [(LocVar, [()], UrTy (), Exp3)]
-&gt; Exp3
-&gt; ([(LocVar, [()], UrTy (), Exp3)], Exp3)
</span><a href="#local-6989586621680975594"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621680975609"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975610"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975646"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-414"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975647"><span class="hs-identifier hs-var">acc'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LocVar -&gt; Exp3 -&gt; Exp3
forall (ext :: * -&gt; * -&gt; *) loc dec.
LocVar -&gt; PreExp ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#WithArenaE"><span class="hs-identifier hs-var">WithArenaE</span></a></span><span> </span><span class="annot"><span class="annottext">LocVar
</span><a href="#local-6989586621680975645"><span class="hs-identifier hs-var">ar</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975648"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-type">TimeIt</span></a></span><span> </span><span id="local-6989586621680975649"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975649"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680975650"><span class="annot"><span class="annottext">UrTy ()
</span><a href="#local-6989586621680975650"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680975651"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975651"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-416"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975652"><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975652"><span class="hs-identifier hs-var">acc'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680975653"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975653"><span class="hs-identifier hs-var">e'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Mode
-&gt; [(LocVar, [()], UrTy (), Exp3)]
-&gt; Exp3
-&gt; ([(LocVar, [()], UrTy (), Exp3)], Exp3)
</span><a href="#local-6989586621680975594"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621680975609"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975610"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975649"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-417"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975652"><span class="hs-identifier hs-var">acc'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp3 -&gt; UrTy () -&gt; Bool -&gt; Exp3
forall (ext :: * -&gt; * -&gt; *) loc dec.
PreExp ext loc dec -&gt; dec -&gt; Bool -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#TimeIt"><span class="hs-identifier hs-var">TimeIt</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975653"><span class="hs-identifier hs-var">e'</span></a></span><span> </span><span class="annot"><span class="annottext">UrTy ()
</span><a href="#local-6989586621680975650"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680975651"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span>        </span><span class="annot"><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-type">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Gibbon.L3.Syntax.html#LetAvail"><span class="hs-identifier hs-type">L3.LetAvail</span></a></span><span> </span><span id="local-6989586621680975655"><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975655"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621680975656"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975656"><span class="hs-identifier hs-var">bod</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-419"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680975657"><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975657"><span class="hs-identifier hs-var">acc'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621680975658"><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975658"><span class="hs-identifier hs-var">bod'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Mode
-&gt; [(LocVar, [()], UrTy (), Exp3)]
-&gt; Exp3
-&gt; ([(LocVar, [()], UrTy (), Exp3)], Exp3)
</span><a href="#local-6989586621680975594"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621680975609"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975610"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975656"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-420"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975657"><span class="hs-identifier hs-var">acc'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">E3Ext () (UrTy ()) -&gt; Exp3
forall (ext :: * -&gt; * -&gt; *) loc dec.
ext loc dec -&gt; PreExp ext loc dec
</span><a href="Gibbon.Language.Syntax.html#Ext"><span class="hs-identifier hs-var">Ext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LocVar] -&gt; Exp3 -&gt; E3Ext () (UrTy ())
forall loc dec. [LocVar] -&gt; PreExp E3Ext loc dec -&gt; E3Ext loc dec
</span><a href="Gibbon.L3.Syntax.html#LetAvail"><span class="hs-identifier hs-var">L3.LetAvail</span></a></span><span> </span><span class="annot"><span class="annottext">[LocVar]
</span><a href="#local-6989586621680975655"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975658"><span class="hs-identifier hs-var">bod'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>        </span><span class="annot"><span class="annottext">Exp3
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(LocVar, [()], UrTy (), Exp3)]
</span><a href="#local-6989586621680975610"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Exp3
</span><a href="#local-6989586621680975611"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-425"></span></pre></body></html>